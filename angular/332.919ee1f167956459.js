(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[332],{11096:(at,ue,w)=>{"use strict";w.d(ue,{S:()=>F});var O=w(39621),u=w(65879),g=w(96814),h=w(89188),_=w(11964);function m(E,R){if(1&E&&(u.TgZ(0,"div",4)(1,"b",5),u._uU(2),u.qZA(),u._UZ(3,"div",6),u.ALo(4,"safeContentQuestion"),u.ALo(5,"async"),u.ALo(6,"mathJaxContent"),u.qZA()),2&E){const A=R.$implicit,fe=u.oxw(3);let L;u.xp6(2),u.hij("",null!==(L=A.alpha)&&void 0!==L?L:A.key,"."),u.xp6(1),u.Q6J("innerHtml",u.lcZ(4,2,u.lcZ(5,4,u.xi3(6,6,A.content,fe.renderConfigObj.configRenderService))),u.oJD)}}function B(E,R){if(1&E&&(u.TgZ(0,"div",2),u.YNc(1,m,7,9,"div",3),u.qZA()),2&E){const A=u.oxw(2);u.Q6J("answerSizeManager",0),u.xp6(1),u.Q6J("ngForOf",A.questionObj.answers)}}function W(E,R){if(1&E&&(u.ynx(0),u.YNc(1,B,2,2,"div",1),u.BQk()),2&E){const A=u.oxw();u.xp6(1),u.Q6J("ngIf",1==A.questionObj.answerType&&A.questionObj.answers&&A.questionObj.answers.length>0)}}let F=(()=>{class E extends O.Q{}return E.\u0275fac=function(){let R;return function(fe){return(R||(R=u.n5z(E)))(fe||E)}}(),E.\u0275cmp=u.Xpm({type:E,selectors:[["azt-question-answer-view-content-box"]],inputs:{examObj:"examObj",questionObj:"questionObj",renderConfigObj:"renderConfigObj"},features:[u.qOj],decls:2,vars:3,consts:[[4,"ngIf"],["class","row answers",3,"answerSizeManager",4,"ngIf"],[1,"row","answers",3,"answerSizeManager"],["class","answer col-sm-12 col-md-6",4,"ngFor","ngForOf"],[1,"answer","col-sm-12","col-md-6"],[1,"answer-label"],[1,"answer-content",3,"innerHtml"]],template:function(A,fe){1&A&&(u.YNc(0,W,2,1,"ng-container",0),u.ALo(1,"isOfflineExam")),2&A&&u.Q6J("ngIf",!u.lcZ(1,1,fe.examObj))},dependencies:[g.sg,g.O5,h.s,g.Ov,_.Pc,_.ES,_.OJ],styles:['.pr-7[_ngcontent-%COMP%]{padding-right:28px}.w-38px[_ngcontent-%COMP%]{width:38px}.remove-grid[_ngcontent-%COMP%]{display:block!important}.question-standalone-loader-box[_ngcontent-%COMP%]{min-height:50px}  .skeleton-box-loading{width:100%;height:30px;max-width:100%;margin-bottom:5px;display:inline-block}  .skeleton-box-loading:after{position:absolute;inset:0;transform:translate(-100%);animation:_ngcontent-%COMP%_shimmer 2s infinite;content:""}.question-standalone-box[_ngcontent-%COMP%]{margin-bottom:30px;display:block;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-ring-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-shadow);border-radius:.375rem}.question-standalone-container[_ngcontent-%COMP%]{padding:15px}.question-standalone-for-test-finder[_ngcontent-%COMP%]{border:none;margin-bottom:0;padding:0}.question-standalone-for-test-finder[_ngcontent-%COMP%]   .question-standalone-main-content[_ngcontent-%COMP%]{padding:15px;border:1px solid rgb(228,228,228)}.group-of-question-standalone-for-test-finder[_ngcontent-%COMP%]{padding:15px!important;border:1px solid rgb(228,228,228)!important}.question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid #2262AE!important;outline:3px solid rgba(125,160,201,.65)!important}.group-of-question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid green!important;outline:3px solid rgba(0,193,0,.321)!important}.question-standalone-container[_ngcontent-%COMP%]:hover   .prev_question_btn[_ngcontent-%COMP%], .question-standalone-container[_ngcontent-%COMP%]:hover   .next_question_btn[_ngcontent-%COMP%]{visibility:visible}.question-standalone-label[_ngcontent-%COMP%]{font-weight:700}.question-standalone-content-box[_ngcontent-%COMP%]{position:relative}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]{color:#f44336;position:relative;padding-left:20px;display:flex;align-items:center}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]:before{content:"!";position:absolute;left:0;color:#fff;background:#f44336;width:15px;height:15px;text-align:center;border-radius:50%;font-size:smaller;display:flex;justify-content:center;align-items:center}.question-standalone-step-container-box[_ngcontent-%COMP%]{margin-bottom:50px}.group-content-of-question-standalone[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.answer[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-label[_ngcontent-%COMP%]{width:20px;height:30px;min-width:20px;min-height:30px;display:flex;align-items:center;justify-content:flex-start;border-radius:50%;border-width:2px;border-style:solid;border-color:transparent}.answer-box[_ngcontent-%COMP%]{border-radius:0 0 3px 3px;padding:8px 20px;justify-content:space-between;align-items:center}.selected-answer[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff}.answer-content-front[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap;width:calc(100% - 30px)}.explainTxt[_ngcontent-%COMP%]{width:125px;font-weight:500;display:flex;align-items:center}#examHeader[_ngcontent-%COMP%]{display:block;border:1px solid #e7e7e7;border-radius:3px;overflow:hidden}.next_question_btn[_ngcontent-%COMP%]{position:absolute;right:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]{position:absolute;left:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]:hover, .next_question_btn[_ngcontent-%COMP%]:hover{visibility:visible}.arrow_btn[_ngcontent-%COMP%]{font-size:20px;vertical-align:middle;width:20px;height:20px;color:#fff;margin-left:auto!important;margin-right:auto!important;-webkit-user-select:none;user-select:none}.bottom_action[_ngcontent-%COMP%]{position:fixed;padding:15px;bottom:0;left:0;background:#312e2e;color:#fff;width:100%}.bottom_action[_ngcontent-%COMP%]   .collapse[_ngcontent-%COMP%]{display:block}.btn-ans-result[_ngcontent-%COMP%]{color:#fff;background-color:#f39c12}.show-list[_ngcontent-%COMP%]{max-width:200px}.show-list[_ngcontent-%COMP%]   .show-sheet[_ngcontent-%COMP%]   .listli[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:27px;height:27px;border-radius:50%;border:1px solid #347da5;display:flex;align-items:center;color:#fff;justify-content:center;font-size:12px;cursor:pointer;-webkit-user-select:none;user-select:none}.top_action[_ngcontent-%COMP%]{position:fixed;padding:10px;top:0;left:0;background:#312e2e;color:#fff;width:100%}.scrollSheetMobile[_ngcontent-%COMP%]{max-height:200px;overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.scrollSheetMobile[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}.notify-badge[_ngcontent-%COMP%]{position:absolute;right:3px;top:3px;text-align:center;color:#afafaf;padding:0;font-size:20px;cursor:pointer}.attach-container[_ngcontent-%COMP%]{background:#fff;padding:10px 0 0;border-radius:5px;width:83.33%;border:1px solid #e8e8e8}.answer-review[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid rgb(52,125,165);display:flex;align-items:center;color:#fff;justify-content:center;font-size:15px;-webkit-user-select:none;user-select:none}.border-none[_ngcontent-%COMP%]{border:none!important}.bg-question[_ngcontent-%COMP%]{margin-top:15px;padding:15px 10px;background:#fff}.question-pending-part[_ngcontent-%COMP%]{width:100%;height:50px}.pencil-edit[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:30px;height:30px;border-radius:50%;text-align:center;background:darkgrey;z-index:9999}.pencil-edit[_ngcontent-%COMP%]   .lucide[_ngcontent-%COMP%]{color:#fff;stroke-width:2.5px;height:29px}.margin-question-bar[_ngcontent-%COMP%]{margin-top:calc(3rem + 40px)!important}.sheet-screen[_ngcontent-%COMP%]{max-height:calc(100vh - 140px);overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.sheet-screen[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}  .layout{display:grid;margin:20px 0;grid-row-gap:20px}  .layout-4{grid-template-columns:1fr 1fr 1fr 1fr}  .layout-2{grid-template-columns:1fr 1fr}  .layout-1{grid-template-columns:1fr}  .question-standalone-content-box{max-width:100%;overflow-x:auto;overflow-y:hidden}  #boxContentQuestion .question-standalone-container{max-width:800px}@keyframes _ngcontent-%COMP%_shimmer{to{transform:translate(100%)}}@media (max-width: 768px){.answer-content-front[_ngcontent-%COMP%]{justify-content:center}.btn-ans-result[_ngcontent-%COMP%]{margin-right:auto!important}}@media (max-width: 800px){  #boxContentQuestion .question-standalone-container{max-width:calc(90vw - 16px)!important}}']}),E})()},81002:(at,ue,w)=>{"use strict";w.d(ue,{R:()=>h});var O=w(65879),u=w(39621),g=w(66131);let h=(()=>{class _ extends u.Q{constructor(){super(...arguments),this.questionRenderService=(0,O.f3M)(g.h),this.isDestroyed=!1,this.isInitData=!1}startRenderQuestion(B){this.renderConfigObj.disableRender?this.emitHaveRended(void 0):B&&!this.renderConfigObj.isFirstRender||(B&&this.renderConfigObj.isFirstRender&&(this.renderConfigObj.isFirstRender=!1,this.followerRender.doneItemPartQuest()),this.baseQuestionObj&&this.questionRenderService.parseRenderQuestion(this.baseQuestionObj,this.renderConfigObj.configRenderService).then(()=>{this.emitHaveRended(void 0)}).catch(W=>{this.emitHaveRended(W.message)}))}emitHaveRended(B){this.isDestroyed||!B||this.showErrorSnack(B)}initData(B,W,F){this.renderConfigObj=B,this.followerRender=W,this.baseQuestionObj=F,this.isInitData=!0}reRenderContent(){this.isInitData&&this.startRenderQuestion(!1)}ngDoCheck(){if(!this.isInitData||this.renderConfigObj.isRenderElement)return;let B=document.getElementById("question_render_element_"+this.baseQuestionObj.id);if(!B)return;let W=B.getAttribute("start_loading");(this.renderConfigObj.disableLazy||W&&"true"==W)&&(this.renderConfigObj.isRenderElement||(this.startRenderQuestion(!0),this.renderConfigObj.isRenderElement=!0))}ngOnDestroy(){this.isDestroyed=!0,super.ngOnDestroy()}}return _.\u0275fac=function(){let m;return function(W){return(m||(m=O.n5z(_)))(W||_)}}(),_.\u0275cmp=O.Xpm({type:_,selectors:[["ng-component"]],features:[O.qOj],decls:0,vars:0,template:function(B,W){},encapsulation:2}),_})()},79775:(at,ue,w)=>{"use strict";w.d(ue,{m:()=>u});var O=w(8720);class u{constructor(h,_,m){this.mathJaxImage=!1,this.disableLazy=!1,this.disableRender=!1,this.isFirstRender=!0,this.isRenderElement=!1,this.configRenderService=new O.v,this.disableLazy=h,this.disableRender=_,this.mathJaxImage=m,this.mathJaxImage&&this.configRenderService.setMaxJaxRenderMode("svg")}}},20787:(at,ue,w)=>{"use strict";w.d(ue,{A:()=>qe});var O=w(81002),u=w(79775),g=w(56443),h=w(65879),_=w(96814),m=w(11343),B=w(35852),W=w(41030),F=w(11096),E=w(57394),R=w(25797),A=w(39621),fe=w(11964);function L(Me,pt){if(1&Me&&(h.TgZ(0,"h2",2),h._uU(1),h.ALo(2,"mytranslate"),h.qZA()),2&Me){const Fe=h.oxw();h.xp6(1),h.AsE(" ",h.lcZ(2,2,"lang_auto_dap_an"),": ",Fe.questionObj.answerResult.length?Fe.questionObj.answerResult.join(" | "):"","\n")}}function U(Me,pt){1&Me&&(h.TgZ(0,"h2",2),h._uU(1),h.ALo(2,"mytranslate"),h.qZA()),2&Me&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"lang_auto_tu_luan")," "))}let Z=(()=>{class Me extends A.Q{}return Me.\u0275fac=function(){let pt;return function(ht){return(pt||(pt=h.n5z(Me)))(ht||Me)}}(),Me.\u0275cmp=h.Xpm({type:Me,selectors:[["azt-question-answer-view-with-simple-result-box-for-teacher"]],inputs:{questionObj:"questionObj"},features:[h.qOj],decls:4,vars:4,consts:[["class","font-medium text-md text-left text-success mt-3",4,"ngIf","ngIfElse"],["essayAnswer",""],[1,"font-medium","text-md","text-left","text-success","mt-3"]],template:function(Fe,ht){if(1&Fe&&(h.YNc(0,L,3,4,"h2",0),h.ALo(1,"isEssayAnswer"),h.YNc(2,U,3,3,"ng-template",null,1,h.W1O)),2&Fe){const we=h.MAs(3);h.Q6J("ngIf",ht.questionObj.answerResult&&!h.lcZ(1,2,ht.questionObj))("ngIfElse",we)}},dependencies:[_.O5,fe.JV,fe.eH],styles:['.pr-7[_ngcontent-%COMP%]{padding-right:28px}.w-38px[_ngcontent-%COMP%]{width:38px}.remove-grid[_ngcontent-%COMP%]{display:block!important}.question-standalone-loader-box[_ngcontent-%COMP%]{min-height:50px}  .skeleton-box-loading{width:100%;height:30px;max-width:100%;margin-bottom:5px;display:inline-block}  .skeleton-box-loading:after{position:absolute;inset:0;transform:translate(-100%);animation:_ngcontent-%COMP%_shimmer 2s infinite;content:""}.question-standalone-box[_ngcontent-%COMP%]{margin-bottom:30px;display:block;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-ring-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-shadow);border-radius:.375rem}.question-standalone-container[_ngcontent-%COMP%]{padding:15px}.question-standalone-for-test-finder[_ngcontent-%COMP%]{border:none;margin-bottom:0;padding:0}.question-standalone-for-test-finder[_ngcontent-%COMP%]   .question-standalone-main-content[_ngcontent-%COMP%]{padding:15px;border:1px solid rgb(228,228,228)}.group-of-question-standalone-for-test-finder[_ngcontent-%COMP%]{padding:15px!important;border:1px solid rgb(228,228,228)!important}.question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid #2262AE!important;outline:3px solid rgba(125,160,201,.65)!important}.group-of-question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid green!important;outline:3px solid rgba(0,193,0,.321)!important}.question-standalone-container[_ngcontent-%COMP%]:hover   .prev_question_btn[_ngcontent-%COMP%], .question-standalone-container[_ngcontent-%COMP%]:hover   .next_question_btn[_ngcontent-%COMP%]{visibility:visible}.question-standalone-label[_ngcontent-%COMP%]{font-weight:700}.question-standalone-content-box[_ngcontent-%COMP%]{position:relative}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]{color:#f44336;position:relative;padding-left:20px;display:flex;align-items:center}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]:before{content:"!";position:absolute;left:0;color:#fff;background:#f44336;width:15px;height:15px;text-align:center;border-radius:50%;font-size:smaller;display:flex;justify-content:center;align-items:center}.question-standalone-step-container-box[_ngcontent-%COMP%]{margin-bottom:50px}.group-content-of-question-standalone[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.answer[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-label[_ngcontent-%COMP%]{width:20px;height:30px;min-width:20px;min-height:30px;display:flex;align-items:center;justify-content:flex-start;border-radius:50%;border-width:2px;border-style:solid;border-color:transparent}.answer-box[_ngcontent-%COMP%]{border-radius:0 0 3px 3px;padding:8px 20px;justify-content:space-between;align-items:center}.selected-answer[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff}.answer-content-front[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap;width:calc(100% - 30px)}.explainTxt[_ngcontent-%COMP%]{width:125px;font-weight:500;display:flex;align-items:center}#examHeader[_ngcontent-%COMP%]{display:block;border:1px solid #e7e7e7;border-radius:3px;overflow:hidden}.next_question_btn[_ngcontent-%COMP%]{position:absolute;right:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]{position:absolute;left:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]:hover, .next_question_btn[_ngcontent-%COMP%]:hover{visibility:visible}.arrow_btn[_ngcontent-%COMP%]{font-size:20px;vertical-align:middle;width:20px;height:20px;color:#fff;margin-left:auto!important;margin-right:auto!important;-webkit-user-select:none;user-select:none}.bottom_action[_ngcontent-%COMP%]{position:fixed;padding:15px;bottom:0;left:0;background:#312e2e;color:#fff;width:100%}.bottom_action[_ngcontent-%COMP%]   .collapse[_ngcontent-%COMP%]{display:block}.btn-ans-result[_ngcontent-%COMP%]{color:#fff;background-color:#f39c12}.show-list[_ngcontent-%COMP%]{max-width:200px}.show-list[_ngcontent-%COMP%]   .show-sheet[_ngcontent-%COMP%]   .listli[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:27px;height:27px;border-radius:50%;border:1px solid #347da5;display:flex;align-items:center;color:#fff;justify-content:center;font-size:12px;cursor:pointer;-webkit-user-select:none;user-select:none}.top_action[_ngcontent-%COMP%]{position:fixed;padding:10px;top:0;left:0;background:#312e2e;color:#fff;width:100%}.scrollSheetMobile[_ngcontent-%COMP%]{max-height:200px;overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.scrollSheetMobile[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}.notify-badge[_ngcontent-%COMP%]{position:absolute;right:3px;top:3px;text-align:center;color:#afafaf;padding:0;font-size:20px;cursor:pointer}.attach-container[_ngcontent-%COMP%]{background:#fff;padding:10px 0 0;border-radius:5px;width:83.33%;border:1px solid #e8e8e8}.answer-review[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid rgb(52,125,165);display:flex;align-items:center;color:#fff;justify-content:center;font-size:15px;-webkit-user-select:none;user-select:none}.border-none[_ngcontent-%COMP%]{border:none!important}.bg-question[_ngcontent-%COMP%]{margin-top:15px;padding:15px 10px;background:#fff}.question-pending-part[_ngcontent-%COMP%]{width:100%;height:50px}.pencil-edit[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:30px;height:30px;border-radius:50%;text-align:center;background:darkgrey;z-index:9999}.pencil-edit[_ngcontent-%COMP%]   .lucide[_ngcontent-%COMP%]{color:#fff;stroke-width:2.5px;height:29px}.margin-question-bar[_ngcontent-%COMP%]{margin-top:calc(3rem + 40px)!important}.sheet-screen[_ngcontent-%COMP%]{max-height:calc(100vh - 140px);overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.sheet-screen[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}  .layout{display:grid;margin:20px 0;grid-row-gap:20px}  .layout-4{grid-template-columns:1fr 1fr 1fr 1fr}  .layout-2{grid-template-columns:1fr 1fr}  .layout-1{grid-template-columns:1fr}  .question-standalone-content-box{max-width:100%;overflow-x:auto;overflow-y:hidden}  #boxContentQuestion .question-standalone-container{max-width:800px}@keyframes _ngcontent-%COMP%_shimmer{to{transform:translate(100%)}}@media (max-width: 768px){.answer-content-front[_ngcontent-%COMP%]{justify-content:center}.btn-ans-result[_ngcontent-%COMP%]{margin-right:auto!important}}@media (max-width: 800px){  #boxContentQuestion .question-standalone-container{max-width:calc(90vw - 16px)!important}}']}),Me})();const le=function(Me){return{"skeleton-box-loading":Me}};function P(Me,pt){if(1&Me&&h._UZ(0,"div",3),2&Me){const Fe=h.oxw();h.Q6J("ngClass",h.VKq(1,le,Fe.renderConfigObj.isFirstRender))}}function H(Me,pt){if(1&Me&&h._UZ(0,"azt-test-audio-ui",12),2&Me){const Fe=h.oxw(2);h.Q6J("questionObj",Fe.questionObj)("isShowList",!0)}}function ce(Me,pt){if(1&Me&&h._UZ(0,"azt-question-label-box",13),2&Me){const Fe=h.oxw(2);h.Q6J("examObj",Fe.examObj)("questionObj",Fe.questionObj)("renderConfigObj",Fe.renderConfigObj)("curQuestionIndex",Fe.curQuestionIndex)}}const ge=function(Me){return{"pb-2":Me}};function Oe(Me,pt){if(1&Me&&(h.TgZ(0,"div",4)(1,"div",5),h._UZ(2,"azt-question-group-content-box",6),h.TgZ(3,"div",7),h.YNc(4,H,1,2,"azt-test-audio-ui",8),h.TgZ(5,"div",9),h.YNc(6,ce,1,4,"azt-question-label-box",10),h.qZA(),h._UZ(7,"azt-question-content-box",6)(8,"azt-question-answer-view-content-box",6)(9,"azt-question-answer-view-with-simple-result-box-for-teacher",11),h.qZA()()()),2&Me){const Fe=h.oxw();h.xp6(1),h.Udp("font-size","1em")("line-height","1.7"),h.Q6J("id","question_render_container_"+Fe.questionObj.id)("ngClass",h.VKq(18,ge,Fe.questionObj.attachments.length>0)),h.xp6(1),h.Q6J("examObj",Fe.examObj)("questionObj",Fe.questionObj)("renderConfigObj",Fe.renderConfigObj),h.xp6(2),h.Q6J("ngIf",Fe.questionObj.attachments.length>0),h.xp6(2),h.Q6J("ngIf",!Fe.hideQuestionLabel),h.xp6(1),h.Q6J("examObj",Fe.examObj)("questionObj",Fe.questionObj)("renderConfigObj",Fe.renderConfigObj),h.xp6(1),h.Q6J("examObj",Fe.examObj)("questionObj",Fe.questionObj)("renderConfigObj",Fe.renderConfigObj),h.xp6(1),h.Q6J("questionObj",Fe.questionObj)}}let qe=(()=>{class Me extends O.R{ngOnInit(){super.ngOnInit();let Fe=new u.m(!1,!1,!1);super.initData(Fe,this.follower,this.questionObj)}constructor(){super(),this.follower=new g.p,this.curQuestionIndex=0,this.hideQuestionLabel=!1}}return Me.\u0275fac=function(Fe){return new(Fe||Me)},Me.\u0275cmp=h.Xpm({type:Me,selectors:[["azt-question-standalone-for-preview"]],inputs:{examObj:"examObj",questionObj:"questionObj",follower:"follower",curQuestionIndex:"curQuestionIndex",hideQuestionLabel:"hideQuestionLabel"},features:[h.qOj],decls:4,vars:3,consts:[["load_effect_lazy","",1,"question-standalone-box",3,"id"],["class","question-standalone-loader-box",3,"ngClass",4,"ngIf","ngIfElse"],["elementRended",""],[1,"question-standalone-loader-box",3,"ngClass"],[1,"question-standalone-content-box"],[1,"question-standalone-container","box","border-none",3,"id","ngClass"],[3,"examObj","questionObj","renderConfigObj"],[1,"question-standalone-main-content"],[3,"questionObj","isShowList",4,"ngIf"],[1,"flex","items-center","justify-between"],[3,"examObj","questionObj","renderConfigObj","curQuestionIndex",4,"ngIf"],[3,"questionObj"],[3,"questionObj","isShowList"],[3,"examObj","questionObj","renderConfigObj","curQuestionIndex"]],template:function(Fe,ht){if(1&Fe&&(h.TgZ(0,"div",0),h.YNc(1,P,1,3,"div",1),h.YNc(2,Oe,10,20,"ng-template",null,2,h.W1O),h.qZA()),2&Fe){const we=h.MAs(3);h.Q6J("id","question_render_element_"+ht.questionObj.id),h.xp6(1),h.Q6J("ngIf",!ht.renderConfigObj.isRenderElement)("ngIfElse",we)}},dependencies:[_.mk,_.O5,m.C,B.T,W.J,F.S,E.L,R.w,Z],styles:['.pr-7[_ngcontent-%COMP%]{padding-right:28px}.w-38px[_ngcontent-%COMP%]{width:38px}.remove-grid[_ngcontent-%COMP%]{display:block!important}.question-standalone-loader-box[_ngcontent-%COMP%]{min-height:50px}  .skeleton-box-loading{width:100%;height:30px;max-width:100%;margin-bottom:5px;display:inline-block}  .skeleton-box-loading:after{position:absolute;inset:0;transform:translate(-100%);animation:_ngcontent-%COMP%_shimmer 2s infinite;content:""}.question-standalone-box[_ngcontent-%COMP%]{margin-bottom:30px;display:block;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-ring-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-shadow);border-radius:.375rem}.question-standalone-container[_ngcontent-%COMP%]{padding:15px}.question-standalone-for-test-finder[_ngcontent-%COMP%]{border:none;margin-bottom:0;padding:0}.question-standalone-for-test-finder[_ngcontent-%COMP%]   .question-standalone-main-content[_ngcontent-%COMP%]{padding:15px;border:1px solid rgb(228,228,228)}.group-of-question-standalone-for-test-finder[_ngcontent-%COMP%]{padding:15px!important;border:1px solid rgb(228,228,228)!important}.question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid #2262AE!important;outline:3px solid rgba(125,160,201,.65)!important}.group-of-question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid green!important;outline:3px solid rgba(0,193,0,.321)!important}.question-standalone-container[_ngcontent-%COMP%]:hover   .prev_question_btn[_ngcontent-%COMP%], .question-standalone-container[_ngcontent-%COMP%]:hover   .next_question_btn[_ngcontent-%COMP%]{visibility:visible}.question-standalone-label[_ngcontent-%COMP%]{font-weight:700}.question-standalone-content-box[_ngcontent-%COMP%]{position:relative}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]{color:#f44336;position:relative;padding-left:20px;display:flex;align-items:center}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]:before{content:"!";position:absolute;left:0;color:#fff;background:#f44336;width:15px;height:15px;text-align:center;border-radius:50%;font-size:smaller;display:flex;justify-content:center;align-items:center}.question-standalone-step-container-box[_ngcontent-%COMP%]{margin-bottom:50px}.group-content-of-question-standalone[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.answer[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-label[_ngcontent-%COMP%]{width:20px;height:30px;min-width:20px;min-height:30px;display:flex;align-items:center;justify-content:flex-start;border-radius:50%;border-width:2px;border-style:solid;border-color:transparent}.answer-box[_ngcontent-%COMP%]{border-radius:0 0 3px 3px;padding:8px 20px;justify-content:space-between;align-items:center}.selected-answer[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff}.answer-content-front[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap;width:calc(100% - 30px)}.explainTxt[_ngcontent-%COMP%]{width:125px;font-weight:500;display:flex;align-items:center}#examHeader[_ngcontent-%COMP%]{display:block;border:1px solid #e7e7e7;border-radius:3px;overflow:hidden}.next_question_btn[_ngcontent-%COMP%]{position:absolute;right:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]{position:absolute;left:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]:hover, .next_question_btn[_ngcontent-%COMP%]:hover{visibility:visible}.arrow_btn[_ngcontent-%COMP%]{font-size:20px;vertical-align:middle;width:20px;height:20px;color:#fff;margin-left:auto!important;margin-right:auto!important;-webkit-user-select:none;user-select:none}.bottom_action[_ngcontent-%COMP%]{position:fixed;padding:15px;bottom:0;left:0;background:#312e2e;color:#fff;width:100%}.bottom_action[_ngcontent-%COMP%]   .collapse[_ngcontent-%COMP%]{display:block}.btn-ans-result[_ngcontent-%COMP%]{color:#fff;background-color:#f39c12}.show-list[_ngcontent-%COMP%]{max-width:200px}.show-list[_ngcontent-%COMP%]   .show-sheet[_ngcontent-%COMP%]   .listli[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:27px;height:27px;border-radius:50%;border:1px solid #347da5;display:flex;align-items:center;color:#fff;justify-content:center;font-size:12px;cursor:pointer;-webkit-user-select:none;user-select:none}.top_action[_ngcontent-%COMP%]{position:fixed;padding:10px;top:0;left:0;background:#312e2e;color:#fff;width:100%}.scrollSheetMobile[_ngcontent-%COMP%]{max-height:200px;overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.scrollSheetMobile[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}.notify-badge[_ngcontent-%COMP%]{position:absolute;right:3px;top:3px;text-align:center;color:#afafaf;padding:0;font-size:20px;cursor:pointer}.attach-container[_ngcontent-%COMP%]{background:#fff;padding:10px 0 0;border-radius:5px;width:83.33%;border:1px solid #e8e8e8}.answer-review[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid rgb(52,125,165);display:flex;align-items:center;color:#fff;justify-content:center;font-size:15px;-webkit-user-select:none;user-select:none}.border-none[_ngcontent-%COMP%]{border:none!important}.bg-question[_ngcontent-%COMP%]{margin-top:15px;padding:15px 10px;background:#fff}.question-pending-part[_ngcontent-%COMP%]{width:100%;height:50px}.pencil-edit[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:30px;height:30px;border-radius:50%;text-align:center;background:darkgrey;z-index:9999}.pencil-edit[_ngcontent-%COMP%]   .lucide[_ngcontent-%COMP%]{color:#fff;stroke-width:2.5px;height:29px}.margin-question-bar[_ngcontent-%COMP%]{margin-top:calc(3rem + 40px)!important}.sheet-screen[_ngcontent-%COMP%]{max-height:calc(100vh - 140px);overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.sheet-screen[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}  .layout{display:grid;margin:20px 0;grid-row-gap:20px}  .layout-4{grid-template-columns:1fr 1fr 1fr 1fr}  .layout-2{grid-template-columns:1fr 1fr}  .layout-1{grid-template-columns:1fr}  .question-standalone-content-box{max-width:100%;overflow-x:auto;overflow-y:hidden}  #boxContentQuestion .question-standalone-container{max-width:800px}@keyframes _ngcontent-%COMP%_shimmer{to{transform:translate(100%)}}@media (max-width: 768px){.answer-content-front[_ngcontent-%COMP%]{justify-content:center}.btn-ans-result[_ngcontent-%COMP%]{margin-right:auto!important}}@media (max-width: 800px){  #boxContentQuestion .question-standalone-container{max-width:calc(90vw - 16px)!important}}']}),Me})()},70297:(at,ue,w)=>{"use strict";w.d(ue,{f:()=>ze});var O=w(81002),u=w(79775),g=w(56443),h=w(65879),_=w(96814),m=w(11343),B=w(35852),W=w(41030),F=w(28221),E=w(11096),R=w(57394),A=w(25797),fe=w(19377),L=w(39621),U=w(46825),Z=w(96207),le=w(30617),P=w(21266),H=w(11964);const ce=function(k,Re){return{width:k,"margin-right":Re,"margin-left":"15px"}};function ge(k,Re){if(1&k){const y=h.EpF();h.TgZ(0,"span",6),h.NdJ("click",function(){h.CHM(y);const D=h.oxw();return h.KtG(D.showExplain())}),h._uU(1),h.ALo(2,"mytranslate"),h.TgZ(3,"mat-icon"),h._uU(4),h.qZA()()}if(2&k){const y=h.oxw();h.Q6J("ngStyle",h.WLB(6,ce,y.questionObj.help?"125px":"0px",y.questionObj.help?"-40px":"0px")),h.uIk("style",y.questionObj.help&&!y.notShowAnswerYet?"visibility:  visible":"visibility:  hidden",h.Ckj),h.xp6(1),h.hij(" ",h.lcZ(2,4,"lang_auto_giai_thich")," "),h.xp6(3),h.Oqu(y.isShowExplain?"expand_less":"expand_more")}}const Oe=function(k){return[k]},qe=function(k){return{backto:k}},Me=function(){return{"text-transform":"uppercase"}};function pt(k,Re){if(1&k&&(h.TgZ(0,"a",7),h.ALo(1,"navigationLocalize"),h._uU(2),h.ALo(3,"mytranslate"),h.qZA()),2&k){const y=h.oxw();h.Q6J("routerLink",h.VKq(8,Oe,h.lcZ(1,4,"/on-luyen/"+y.questionObj.practiceHashId)))("queryParams",h.VKq(10,qe,y.backToLink))("ngStyle",h.DdM(12,Me)),h.xp6(2),h.hij(" ",h.lcZ(3,6,"lang_azota_ui_practice_link")," ")}}const Fe=function(k){return{color:k}};function ht(k,Re){if(1&k&&(h.TgZ(0,"span",13),h._uU(1),h.ALo(2,"mytranslate"),h.qZA()),2&k){const y=h.oxw(2);h.Q6J("ngStyle",h.VKq(5,Fe,y.isFillAnswer?"#00ac33":"red")),h.xp6(1),h.AsE(" ",h.lcZ(2,3,"lang_auto_dap_an_dung"),": ",y.key," ")}}function we(k,Re){1&k&&h._UZ(0,"span",14)}function Ne(k,Re){1&k&&(h.TgZ(0,"mat-icon",21),h._uU(1,"close"),h.qZA())}function X(k,Re){1&k&&(h.TgZ(0,"mat-icon"),h._uU(1,"check_circle"),h.qZA())}function Be(k,Re){if(1&k&&(h.YNc(0,Ne,2,0,"mat-icon",19),h.YNc(1,X,2,0,"mat-icon",20)),2&k){const y=h.oxw().$implicit,S=h.oxw(2);h.Q6J("ngIf",S.haveChoose(y)&&2!=S.examObj.whenShowAnswer&&!S.notShowAnswerYet),h.xp6(1),h.Q6J("ngIf",S.haveChoose(y)&&2!=S.examObj.whenShowAnswer&&S.notShowAnswerYet)}}function V(k,Re){1&k&&(h.TgZ(0,"mat-icon"),h._uU(1,"check_circle"),h.qZA())}function oe(k,Re){if(1&k&&h.YNc(0,V,2,0,"mat-icon",20),2&k){const y=h.oxw().$implicit,S=h.oxw(2);h.Q6J("ngIf",S.haveChoose(y)&&2==S.examObj.whenShowAnswer)}}function pe(k,Re){1&k&&(h.TgZ(0,"mat-icon",22),h._uU(1,"check_circle"),h.qZA())}function Ue(k,Re){if(1&k&&(h.TgZ(0,"div",15),h.YNc(1,Be,2,2,"ng-template",16),h.YNc(2,oe,1,1,"ng-template",16),h.YNc(3,pe,2,0,"mat-icon",17),h.TgZ(4,"span",18),h._uU(5),h.qZA()()),2&k){const y=Re.$implicit,S=h.oxw(2);h.xp6(1),h.Q6J("ngIf",!(S.isKey(y)&&S.haveChoose(y))),h.xp6(1),h.Q6J("ngIf",!(S.isKey(y)&&S.haveChoose(y))),h.xp6(1),h.Q6J("ngIf",S.isKey(y)&&S.haveChoose(y)&&2!=S.examObj.whenShowAnswer),h.xp6(2),h.Oqu(y.alpha?y.alpha:y.key?y.key:y)}}function rt(k,Re){if(1&k&&(h.TgZ(0,"div",8),h.YNc(1,ht,3,7,"span",9),h.YNc(2,we,1,0,"span",10),h.TgZ(3,"div",11),h.YNc(4,Ue,6,4,"div",12),h.qZA()()),2&k){const y=h.oxw();h.xp6(1),h.Q6J("ngIf",2!=y.examObj.whenShowAnswer&&!y.notShowAnswerYet),h.xp6(1),h.Q6J("ngIf",y.keys&&2==y.examObj.whenShowAnswer),h.xp6(2),h.Q6J("ngForOf",y.labelArr)}}function Je(k,Re){if(1&k&&(h.TgZ(0,"span",13),h._uU(1),h.ALo(2,"mytranslate"),h.qZA()),2&k){const y=h.oxw(2);h.Q6J("ngStyle",h.VKq(5,Fe,y.isFillAnswer?"#00ac33":"red")),h.xp6(1),h.AsE(" ",h.lcZ(2,3,"lang_auto_dap_an_dung_"),"",y.keys.join("],["),"] ")}}function xt(k,Re){1&k&&h._UZ(0,"span",14)}function De(k,Re){if(1&k&&(h.TgZ(0,"div",8),h.YNc(1,Je,3,7,"span",9),h.YNc(2,xt,1,0,"span",10),h.TgZ(3,"div",23)(4,"div",24),h._uU(5),h.ALo(6,"mytranslate"),h.qZA()()()),2&k){const y=h.oxw();h.xp6(1),h.Q6J("ngIf",y.keys&&2!=y.examObj.whenShowAnswer&&!y.notShowAnswerYet),h.xp6(1),h.Q6J("ngIf",y.keys&&2==y.examObj.whenShowAnswer),h.xp6(3),h.hij(" ",y.userAnswersObj["id_"+y.questionObj.id]?y.userAnswersObj["id_"+y.questionObj.id]:h.lcZ(6,3,"lang_auto_thi_sinh_khong_thong_tin")," ")}}function wt(k,Re){if(1&k){const y=h.EpF();h.TgZ(0,"div")(1,"span",26),h.NdJ("click",function(){h.CHM(y);const D=h.oxw(2);return h.KtG(D.switchToEssayTab())}),h._uU(2),h.ALo(3,"mytranslate"),h.qZA()()}2&k&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"lang_auto_click_vao_day_de_xem_o_tab_tu_luan")," "))}function Ae(k,Re){1&k&&(h.TgZ(0,"div"),h._uU(1),h.ALo(2,"mytranslate"),h.qZA()),2&k&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"lang_auto_thi_sinh_khong_nhap_thong_tin")," "))}function ne(k,Re){if(1&k&&(h.ynx(0),h._UZ(1,"div",27),h.BQk()),2&k){const y=h.oxw(3);h.xp6(1),h.Q6J("innerHtml",y.userAnswersObj["id_"+y.questionObj.id],h.oJD)}}function Y(k,Re){if(1&k&&(h.ynx(0),h.YNc(1,Ae,3,3,"div",20),h.YNc(2,ne,2,1,"ng-container",20),h.BQk()),2&k){const y=h.oxw(2);h.xp6(1),h.Q6J("ngIf",!y.userAnswersObj["id_"+y.questionObj.id]),h.xp6(1),h.Q6J("ngIf",y.userAnswersObj["id_"+y.questionObj.id])}}function ae(k,Re){if(1&k&&(h.TgZ(0,"div",25),h.YNc(1,wt,4,3,"div",20),h.YNc(2,Y,3,2,"ng-container",20),h.qZA()),2&k){const y=h.oxw();h.xp6(1),h.Q6J("ngIf","multiple_choice_tab"==y.currentTab),h.xp6(1),h.Q6J("ngIf","multiple_choice_tab"!=y.currentTab)}}const $=function(k){return{"justify-content":k}};let Se=(()=>{class k extends L.Q{showExplain(){this.isShowExplainChange.emit(!this.isShowExplain)}switchToEssayTab(){this.answerBoxService.changeSwitchEssayTabMessage(!0)}isKey(y){return!(!this.questionObj?.answers||!this.questionObj.answerResult)&&(y.key?y.key==this.questionObj.answerResult[0]:y==this.questionObj.answerResult[0])}haveChoose(y){return!!this.userAnswersObj["id_"+this.questionObj?.id]&&(y.key?y.key.toString()==this.userAnswersObj["id_"+this.questionObj?.id]:y.toString()==this.userAnswersObj["id_"+this.questionObj?.id])}findKey(){if(this.questionObj?.answerResult)for(let y=0;y<this.labelArr.length;y++)if(this.questionObj&&this.questionObj.answerResult&&this.questionObj.answerResult[0]==this.labelArr[y].key&&this.labelArr[y].alpha){this.key=this.labelArr[y].alpha??"";break}}ngOnInit(){if(this.isFillAnswer=this.questionObj?.correctAnswer??!1,this.questionObj?.answerResult.length&&(this.key=this.questionObj.answerResult[0]),this.labelArr=this.questionObj?.answers??[],this.findKey(),this.answerTypeService.isOneChoiceAnswer(this.questionObj))for(let y=0;y<this.labelArr.length&&(this.isFillAnswer=this.isKey(this.labelArr[y])&&this.haveChoose(this.labelArr[y]),!0!==this.isFillAnswer);y++);this.answerTypeService.isFillAnswer(this.questionObj)&&this.questionObj?.answerResult&&this.questionObj.answerResult.length>0&&(this.keys=this.questionObj.answerResult,this.isFillAnswer=this.questionObj?.correctAnswer??!1),super.ngOnInit()}constructor(y,S){super(),this.answerTypeService=y,this.answerBoxService=S,this.isShowExplain=!1,this.userAnswersObj={},this.notShowAnswerYet=!1,this.currentTab="multiple_choice_tab",this.backToLink="",this.isShowExplainChange=new h.vpe,this.key="",this.keys=[],this.labelArr=[],this.isFillAnswer=!1}}return k.\u0275fac=function(y){return new(y||k)(h.Y36(U.i),h.Y36(Z.z))},k.\u0275cmp=h.Xpm({type:k,selectors:[["azt-answer-box-with-user-answer-for-student"]],inputs:{examObj:"examObj",questionObj:"questionObj",isShowExplain:"isShowExplain",userAnswersObj:"userAnswersObj",notShowAnswerYet:"notShowAnswerYet",currentTab:"currentTab",backToLink:"backToLink"},outputs:{isShowExplainChange:"isShowExplainChange"},features:[h.qOj],decls:10,vars:14,consts:[[1,"question-standalone-answer-box-for-student","box","p-2","pt-0","shadow-none",2,"border-top-left-radius","0","border-top-right-radius","0",3,"ngStyle"],[1,"flex","flex-col-reverse","sm:flex-row","sm:items-center"],["class","explainTxt text-pending cursor-pointer mr-3","azt-track-service","azt-standalone-question-nQrO97VmcYI",3,"ngStyle","click",4,"ngIf"],["class","btn btn-outline-primary btn-transparent",3,"routerLink","queryParams","ngStyle",4,"ngIf"],["class","answer-box-type1 mt-2",4,"ngIf"],["class","answer-box answer-box-type3 ml-auto justify-content-between notForPdfExport",4,"ngIf"],["azt-track-service","azt-standalone-question-nQrO97VmcYI",1,"explainTxt","text-pending","cursor-pointer","mr-3",3,"ngStyle","click"],[1,"btn","btn-outline-primary","btn-transparent",3,"routerLink","queryParams","ngStyle"],[1,"answer-box-type1","mt-2"],["class","keyText my-1",3,"ngStyle",4,"ngIf"],["class","keyText my-1 ml-2",4,"ngIf"],["id","type_3",1,"limit-max-width","answer-box","ml-auto","my-1",2,"border-color","00ac33"],["class","label-item",4,"ngFor","ngForOf"],[1,"keyText","my-1",3,"ngStyle"],[1,"keyText","my-1","ml-2"],[1,"label-item"],[3,"ngIf"],["style","color: #00ac33",4,"ngIf"],[1,"lalala"],["style","color: red",4,"ngIf"],[4,"ngIf"],[2,"color","red"],[2,"color","#00ac33"],["id","type_4",1,"answer-box","ml-auto","my-1",2,"border-color","00ac33"],[1,"text-answer"],[1,"answer-box","answer-box-type3","ml-auto","justify-content-between","notForPdfExport"],["azt-track-service","answer-box-LBNR1fkVDxS",1,"clickable",3,"click"],[1,"answer-essay-txt",3,"innerHtml"]],template:function(y,S){1&y&&(h.TgZ(0,"div",0)(1,"div",1),h.YNc(2,ge,5,9,"span",2),h.YNc(3,pt,4,13,"a",3),h.qZA(),h.YNc(4,rt,5,3,"div",4),h.ALo(5,"isOneChoiceAnswer"),h.YNc(6,De,7,5,"div",4),h.ALo(7,"isFillAnswer"),h.YNc(8,ae,3,2,"div",5),h.ALo(9,"isEssayAnswer"),h.qZA()),2&y&&(h.Q6J("ngStyle",h.VKq(12,$,2==S.examObj.whenShowAnswer?"flex-end":"space-between")),h.xp6(2),h.Q6J("ngIf",2!=S.examObj.whenShowAnswer),h.xp6(1),h.Q6J("ngIf",S.questionObj.practiceHashId),h.xp6(1),h.Q6J("ngIf",h.lcZ(5,6,S.questionObj)),h.xp6(2),h.Q6J("ngIf",h.lcZ(7,8,S.questionObj)),h.xp6(2),h.Q6J("ngIf",h.lcZ(9,10,S.questionObj)))},dependencies:[_.sg,_.O5,_.PC,le.Hw,P.rH,H.Jy,H.JV,H.Uy,H.eH,H.ck],styles:[".question-standalone-answer-box-for-student[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.answer-box[_ngcontent-%COMP%]{width:250px;display:flex;justify-content:space-around;padding:10px;border:1px solid #f1f1f1;border-radius:3px}.answer-box.limit-max-width[_ngcontent-%COMP%]{max-width:250px}.answer-box[_ngcontent-%COMP%]   .label-item[_ngcontent-%COMP%]{font-weight:500;display:flex;align-items:center;font-size:16px;width:40px;justify-content:flex-end}.answer-box.answer-box-type3[_ngcontent-%COMP%]{width:100%}.answer-box-type1[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-box-type1[_ngcontent-%COMP%]   .keyText[_ngcontent-%COMP%]{font-weight:500;font-size:16px;flex:auto;text-align:right;margin-right:15px}.text-answer[_ngcontent-%COMP%]{width:100%;min-height:40px;max-height:120px;overflow:auto;padding:10px}textarea[_ngcontent-%COMP%]:focus{border:none!important}.explainTxt[_ngcontent-%COMP%]{width:125px;font-weight:500;display:flex;align-items:center}@media screen and (max-width: 768px){.answer-box-type1[_ngcontent-%COMP%]{margin-left:15px}}@media screen and (max-width: 768px){.question-standalone-answer-box-for-student[_ngcontent-%COMP%]{flex-direction:column-reverse;align-items:flex-start}}@media screen and (max-width: 480px){.answer-box[_ngcontent-%COMP%]{width:auto}.text-answer[_ngcontent-%COMP%]{width:180px;max-height:auto}}"]}),k})();const ee=function(k){return{"skeleton-box-loading":k}};function Pe(k,Re){if(1&k&&h._UZ(0,"div",3),2&k){const y=h.oxw();h.Q6J("ngClass",h.VKq(1,ee,y.renderConfigObj.isFirstRender))}}function K(k,Re){if(1&k&&h._UZ(0,"azt-test-audio-ui",14),2&k){const y=h.oxw(2);h.Q6J("questionObj",y.questionObj)("isShowList",!0)}}const q=function(k){return{"pb-2":k}},ie=function(){return[]};function ye(k,Re){if(1&k){const y=h.EpF();h.TgZ(0,"div",4)(1,"div",5),h._UZ(2,"azt-question-group-content-box",6),h.TgZ(3,"div",7),h.YNc(4,K,1,2,"azt-test-audio-ui",8),h.TgZ(5,"div",9),h._UZ(6,"azt-question-label-box",10)(7,"azt-question-action-box",11),h.qZA(),h._UZ(8,"azt-question-content-box",6)(9,"azt-question-answer-view-content-box",6),h.qZA()(),h.TgZ(10,"azt-answer-box-with-user-answer-for-student",12),h.NdJ("isShowExplainChange",function(D){h.CHM(y);const j=h.oxw();return h.KtG(j.isShowExplain=D)}),h.qZA(),h._UZ(11,"azt-question-explain-box",13),h.qZA()}if(2&k){const y=h.oxw();h.xp6(1),h.Udp("font-size","1em")("line-height","1.7"),h.Q6J("id","question_render_container_"+y.questionObj.id)("ngClass",h.VKq(36,q,y.questionObj.attachments.length>0)),h.xp6(1),h.Q6J("examObj",y.examObj)("questionObj",y.questionObj)("renderConfigObj",y.renderConfigObj),h.xp6(2),h.Q6J("ngIf",y.questionObj.attachments.length>0),h.xp6(2),h.Q6J("examObj",y.examObj)("questionObj",y.questionObj)("renderConfigObj",y.renderConfigObj)("curQuestionIndex",y.curQuestionIndex),h.xp6(1),h.Q6J("showForTeacher",!1)("examObj",y.examObj)("questionObj",y.questionObj)("renderConfigObj",y.renderConfigObj)("curQuestionIndex",y.curQuestionIndex)("orgExamObjs",h.DdM(38,ie)),h.xp6(1),h.Q6J("examObj",y.examObj)("questionObj",y.questionObj)("renderConfigObj",y.renderConfigObj),h.xp6(1),h.Q6J("examObj",y.examObj)("questionObj",y.questionObj)("renderConfigObj",y.renderConfigObj),h.xp6(1),h.Q6J("examObj",y.examObj)("questionObj",y.questionObj)("userAnswersObj",y.userAnswersObj)("notShowAnswerYet",y.notShowAnswerYet)("isShowExplain",y.isShowExplain)("backToLink",y.backToLink)("currentTab",y.currentTab),h.xp6(1),h.Q6J("isShowExplain",y.isShowExplain)("questionObj",y.questionObj)("renderConfigObj",y.renderConfigObj)}}let ze=(()=>{class k extends O.R{ngOnInit(){super.ngOnInit();let y=new u.m(!1,!1,!1);super.initData(y,this.follower,this.questionObj),this.backToLink=`/test/answer-test/${this.examObj?.tenantId??0}/${this.examObj?.categoryId??0}/${this.examObj?.hashId}/${this.curExamResultId}`}constructor(){super(),this.follower=new g.p,this.curQuestionIndex=0,this.isShowExplain=!1,this.userAnswersObj={},this.notShowAnswerYet=!1,this.currentTab="multiple_choice_tab",this.backToLink=""}}return k.\u0275fac=function(y){return new(y||k)},k.\u0275cmp=h.Xpm({type:k,selectors:[["azt-question-standalone-for-student-at-review-page"]],inputs:{examObj:"examObj",questionObj:"questionObj",follower:"follower",curQuestionIndex:"curQuestionIndex",curExamResultId:"curExamResultId",isShowExplain:"isShowExplain",userAnswersObj:"userAnswersObj",notShowAnswerYet:"notShowAnswerYet",currentTab:"currentTab"},features:[h.qOj],decls:4,vars:3,consts:[["load_effect_lazy","",1,"question-standalone-box",3,"id"],["class","question-standalone-loader-box",3,"ngClass",4,"ngIf","ngIfElse"],["elementRended",""],[1,"question-standalone-loader-box",3,"ngClass"],[1,"question-standalone-content-box"],[1,"question-standalone-container","box","border-none",3,"id","ngClass"],[3,"examObj","questionObj","renderConfigObj"],[1,"question-standalone-main-content"],[3,"questionObj","isShowList",4,"ngIf"],[1,"flex","items-center","justify-between"],[3,"examObj","questionObj","renderConfigObj","curQuestionIndex"],[3,"showForTeacher","examObj","questionObj","renderConfigObj","curQuestionIndex","orgExamObjs"],[3,"examObj","questionObj","userAnswersObj","notShowAnswerYet","isShowExplain","backToLink","currentTab","isShowExplainChange"],[2,"display","block",3,"isShowExplain","questionObj","renderConfigObj"],[3,"questionObj","isShowList"]],template:function(y,S){if(1&y&&(h.TgZ(0,"div",0),h.YNc(1,Pe,1,3,"div",1),h.YNc(2,ye,12,39,"ng-template",null,2,h.W1O),h.qZA()),2&y){const D=h.MAs(3);h.Q6J("id","question_render_element_"+S.questionObj.id),h.xp6(1),h.Q6J("ngIf",!S.renderConfigObj.isRenderElement)("ngIfElse",D)}},dependencies:[_.mk,_.O5,m.C,B.T,W.J,F.w,E.S,R.L,A.w,fe.P,Se],styles:['.pr-7[_ngcontent-%COMP%]{padding-right:28px}.w-38px[_ngcontent-%COMP%]{width:38px}.remove-grid[_ngcontent-%COMP%]{display:block!important}.question-standalone-loader-box[_ngcontent-%COMP%]{min-height:50px}  .skeleton-box-loading{width:100%;height:30px;max-width:100%;margin-bottom:5px;display:inline-block}  .skeleton-box-loading:after{position:absolute;inset:0;transform:translate(-100%);animation:_ngcontent-%COMP%_shimmer 2s infinite;content:""}.question-standalone-box[_ngcontent-%COMP%]{margin-bottom:30px;display:block;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-ring-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-shadow);border-radius:.375rem}.question-standalone-container[_ngcontent-%COMP%]{padding:15px}.question-standalone-for-test-finder[_ngcontent-%COMP%]{border:none;margin-bottom:0;padding:0}.question-standalone-for-test-finder[_ngcontent-%COMP%]   .question-standalone-main-content[_ngcontent-%COMP%]{padding:15px;border:1px solid rgb(228,228,228)}.group-of-question-standalone-for-test-finder[_ngcontent-%COMP%]{padding:15px!important;border:1px solid rgb(228,228,228)!important}.question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid #2262AE!important;outline:3px solid rgba(125,160,201,.65)!important}.group-of-question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid green!important;outline:3px solid rgba(0,193,0,.321)!important}.question-standalone-container[_ngcontent-%COMP%]:hover   .prev_question_btn[_ngcontent-%COMP%], .question-standalone-container[_ngcontent-%COMP%]:hover   .next_question_btn[_ngcontent-%COMP%]{visibility:visible}.question-standalone-label[_ngcontent-%COMP%]{font-weight:700}.question-standalone-content-box[_ngcontent-%COMP%]{position:relative}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]{color:#f44336;position:relative;padding-left:20px;display:flex;align-items:center}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]:before{content:"!";position:absolute;left:0;color:#fff;background:#f44336;width:15px;height:15px;text-align:center;border-radius:50%;font-size:smaller;display:flex;justify-content:center;align-items:center}.question-standalone-step-container-box[_ngcontent-%COMP%]{margin-bottom:50px}.group-content-of-question-standalone[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.answer[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-label[_ngcontent-%COMP%]{width:20px;height:30px;min-width:20px;min-height:30px;display:flex;align-items:center;justify-content:flex-start;border-radius:50%;border-width:2px;border-style:solid;border-color:transparent}.answer-box[_ngcontent-%COMP%]{border-radius:0 0 3px 3px;padding:8px 20px;justify-content:space-between;align-items:center}.selected-answer[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff}.answer-content-front[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap;width:calc(100% - 30px)}.explainTxt[_ngcontent-%COMP%]{width:125px;font-weight:500;display:flex;align-items:center}#examHeader[_ngcontent-%COMP%]{display:block;border:1px solid #e7e7e7;border-radius:3px;overflow:hidden}.next_question_btn[_ngcontent-%COMP%]{position:absolute;right:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]{position:absolute;left:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]:hover, .next_question_btn[_ngcontent-%COMP%]:hover{visibility:visible}.arrow_btn[_ngcontent-%COMP%]{font-size:20px;vertical-align:middle;width:20px;height:20px;color:#fff;margin-left:auto!important;margin-right:auto!important;-webkit-user-select:none;user-select:none}.bottom_action[_ngcontent-%COMP%]{position:fixed;padding:15px;bottom:0;left:0;background:#312e2e;color:#fff;width:100%}.bottom_action[_ngcontent-%COMP%]   .collapse[_ngcontent-%COMP%]{display:block}.btn-ans-result[_ngcontent-%COMP%]{color:#fff;background-color:#f39c12}.show-list[_ngcontent-%COMP%]{max-width:200px}.show-list[_ngcontent-%COMP%]   .show-sheet[_ngcontent-%COMP%]   .listli[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:27px;height:27px;border-radius:50%;border:1px solid #347da5;display:flex;align-items:center;color:#fff;justify-content:center;font-size:12px;cursor:pointer;-webkit-user-select:none;user-select:none}.top_action[_ngcontent-%COMP%]{position:fixed;padding:10px;top:0;left:0;background:#312e2e;color:#fff;width:100%}.scrollSheetMobile[_ngcontent-%COMP%]{max-height:200px;overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.scrollSheetMobile[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}.notify-badge[_ngcontent-%COMP%]{position:absolute;right:3px;top:3px;text-align:center;color:#afafaf;padding:0;font-size:20px;cursor:pointer}.attach-container[_ngcontent-%COMP%]{background:#fff;padding:10px 0 0;border-radius:5px;width:83.33%;border:1px solid #e8e8e8}.answer-review[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid rgb(52,125,165);display:flex;align-items:center;color:#fff;justify-content:center;font-size:15px;-webkit-user-select:none;user-select:none}.border-none[_ngcontent-%COMP%]{border:none!important}.bg-question[_ngcontent-%COMP%]{margin-top:15px;padding:15px 10px;background:#fff}.question-pending-part[_ngcontent-%COMP%]{width:100%;height:50px}.pencil-edit[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:30px;height:30px;border-radius:50%;text-align:center;background:darkgrey;z-index:9999}.pencil-edit[_ngcontent-%COMP%]   .lucide[_ngcontent-%COMP%]{color:#fff;stroke-width:2.5px;height:29px}.margin-question-bar[_ngcontent-%COMP%]{margin-top:calc(3rem + 40px)!important}.sheet-screen[_ngcontent-%COMP%]{max-height:calc(100vh - 140px);overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.sheet-screen[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}  .layout{display:grid;margin:20px 0;grid-row-gap:20px}  .layout-4{grid-template-columns:1fr 1fr 1fr 1fr}  .layout-2{grid-template-columns:1fr 1fr}  .layout-1{grid-template-columns:1fr}  .question-standalone-content-box{max-width:100%;overflow-x:auto;overflow-y:hidden}  #boxContentQuestion .question-standalone-container{max-width:800px}@keyframes _ngcontent-%COMP%_shimmer{to{transform:translate(100%)}}@media (max-width: 768px){.answer-content-front[_ngcontent-%COMP%]{justify-content:center}.btn-ans-result[_ngcontent-%COMP%]{margin-right:auto!important}}@media (max-width: 800px){  #boxContentQuestion .question-standalone-container{max-width:calc(90vw - 16px)!important}}']}),k})()},87721:(at,ue,w)=>{"use strict";w.d(ue,{Y:()=>wt});var O=w(81002),u=w(79775),g=w(56443),h=w(65879),_=w(96814),m=w(39621),B=w(46825),W=w(96207),F=w(30617),E=w(11964);function R(Ae,ne){1&Ae&&(h.TgZ(0,"mat-icon",13),h._uU(1,"close"),h.qZA())}function A(Ae,ne){if(1&Ae&&h.YNc(0,R,2,0,"mat-icon",12),2&Ae){const Y=h.oxw().$implicit,ae=h.oxw(2);h.Q6J("ngIf",ae.haveChoose(Y))}}function fe(Ae,ne){1&Ae&&(h.TgZ(0,"mat-icon",14),h._uU(1,"check_circle"),h.qZA())}function L(Ae,ne){if(1&Ae&&(h.TgZ(0,"div",8),h.YNc(1,A,1,1,"ng-template",9),h.YNc(2,fe,2,0,"mat-icon",10),h.TgZ(3,"span",11),h._uU(4),h.qZA()()),2&Ae){const Y=ne.$implicit,ae=h.oxw(2);h.xp6(1),h.Q6J("ngIf",!(ae.isKey(Y)&&ae.haveChoose(Y))),h.xp6(1),h.Q6J("ngIf",ae.isKey(Y)&&ae.haveChoose(Y)),h.xp6(2),h.Oqu(Y.alpha?Y.alpha:Y.key?Y.key:Y)}}const U=function(Ae){return{color:Ae}},Z=function(Ae){return{"border-color":Ae}};function le(Ae,ne){if(1&Ae&&(h.TgZ(0,"div",4)(1,"span",5),h._uU(2),h.ALo(3,"mytranslate"),h.qZA(),h.TgZ(4,"div",6),h.YNc(5,L,5,3,"div",7),h.qZA()()),2&Ae){const Y=h.oxw();h.xp6(1),h.Q6J("ngStyle",h.VKq(7,U,Y.isFillAnswer?"#00ac33":"red")),h.xp6(1),h.AsE("",h.lcZ(3,5,"lang_auto_dap_an_dung"),": ",Y.key,""),h.xp6(2),h.Q6J("ngStyle",h.VKq(9,Z,Y.isFillAnswer?"#00ac33":"red")),h.xp6(1),h.Q6J("ngForOf",Y.labelArr)}}function P(Ae,ne){if(1&Ae&&(h.TgZ(0,"span",5),h._uU(1),h.ALo(2,"mytranslate"),h.qZA()),2&Ae){const Y=h.oxw(2);h.Q6J("ngStyle",h.VKq(5,U,Y.isFillAnswer?"#00ac33":"red")),h.xp6(1),h.AsE(" ",h.lcZ(2,3,"lang_auto_dap_an_dung_"),"",Y.keys.join("],["),"] ")}}function H(Ae,ne){if(1&Ae&&(h.TgZ(0,"div",4),h.YNc(1,P,3,7,"span",15),h.TgZ(2,"div",16)(3,"div",17),h._uU(4),h.ALo(5,"mytranslate"),h.qZA()()()),2&Ae){const Y=h.oxw();h.xp6(1),h.Q6J("ngIf",Y.keys),h.xp6(1),h.Q6J("ngStyle",h.VKq(5,Z,Y.isFillAnswer?"#00ac33":"red")),h.xp6(2),h.hij(" ",Y.userAnswersObj["id_"+Y.questionObj.id]?Y.userAnswersObj["id_"+Y.questionObj.id]:h.lcZ(5,3,"lang_auto_thi_sinh_khong_thong_tin")," ")}}function ce(Ae,ne){if(1&Ae){const Y=h.EpF();h.TgZ(0,"div")(1,"span",20),h.NdJ("click",function(){h.CHM(Y);const $=h.oxw(2);return h.KtG($.switchToEssayTab())}),h._uU(2),h.ALo(3,"mytranslate"),h.qZA()()}2&Ae&&(h.xp6(2),h.Oqu(h.lcZ(3,1,"lang_auto_click_vao_day_de_xem_o_tab_tu_luan")))}function ge(Ae,ne){1&Ae&&(h.TgZ(0,"div"),h._uU(1),h.ALo(2,"mytranslate"),h.qZA()),2&Ae&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"lang_auto_thi_sinh_khong_nhap_thong_tin")," "))}function Oe(Ae,ne){if(1&Ae&&(h.ynx(0),h._UZ(1,"div",21),h.BQk()),2&Ae){const Y=h.oxw(3);h.xp6(1),h.Q6J("innerHtml",Y.userAnswersObj["id_"+Y.questionObj.id],h.oJD)}}function qe(Ae,ne){if(1&Ae&&(h.ynx(0),h.YNc(1,ge,3,3,"div",19),h.YNc(2,Oe,2,1,"ng-container",19),h.BQk()),2&Ae){const Y=h.oxw(2);h.xp6(1),h.Q6J("ngIf",!Y.userAnswersObj["id_"+Y.questionObj.id]),h.xp6(1),h.Q6J("ngIf",Y.userAnswersObj["id_"+Y.questionObj.id])}}function Me(Ae,ne){if(1&Ae&&(h.TgZ(0,"div",18),h.YNc(1,ce,4,3,"div",19),h.YNc(2,qe,3,2,"ng-container",19),h.qZA()),2&Ae){const Y=h.oxw();h.xp6(1),h.Q6J("ngIf","multiple_choice_tab"==Y.currentTab),h.xp6(1),h.Q6J("ngIf","multiple_choice_tab"!=Y.currentTab)}}const pt=function(Ae,ne){return{width:Ae,visibility:ne}};let Fe=(()=>{class Ae extends m.Q{showExplain(){this.isShowExplainChange.emit(!this.isShowExplain)}switchToEssayTab(){this.answerBoxService.changeSwitchEssayTabMessage(!0)}isKey(Y){return!(!this.questionObj?.answers||!this.questionObj.answerResult)&&(Y.key?Y.key==this.questionObj.answerResult[0]:Y==this.questionObj.answerResult[0])}haveChoose(Y){return!!this.userAnswersObj["id_"+this.questionObj?.id]&&(Y.key?Y.key.toString()==this.userAnswersObj["id_"+this.questionObj?.id]:Y.toString()==this.userAnswersObj["id_"+this.questionObj?.id])}findKey(){if(this.questionObj?.answerResult)for(let Y=0;Y<this.labelArr.length;Y++)if(this.questionObj&&this.questionObj.answerResult&&this.questionObj.answerResult[0]==this.labelArr[Y].key&&this.labelArr[Y].alpha){this.key=this.labelArr[Y].alpha??"";break}}ngOnInit(){if(this.isFillAnswer=this.questionObj?.correctAnswer??!1,this.questionObj?.answerResult&&(this.key=this.questionObj.answerResult[0]),this.labelArr=this.questionObj?.answers??[],this.findKey(),this.answerTypeService.isOneChoiceAnswer(this.questionObj))for(let Y=0;Y<this.labelArr.length&&(this.isFillAnswer=this.isKey(this.labelArr[Y])&&this.haveChoose(this.labelArr[Y]),!0!==this.isFillAnswer);Y++);this.answerTypeService.isFillAnswer(this.questionObj)&&this.questionObj?.answerResult&&this.questionObj.answerResult.length>0&&(this.keys=this.questionObj.answerResult,this.isFillAnswer=this.questionObj?.correctAnswer??!1),super.ngOnInit()}constructor(Y,ae){super(),this.answerTypeService=Y,this.answerBoxService=ae,this.isShowExplain=!1,this.userAnswersObj={},this.notShowAnswerYet=!1,this.currentTab="multiple_choice_tab",this.isShowExplainChange=new h.vpe,this.key="",this.keys=[],this.labelArr=[],this.isFillAnswer=!1}}return Ae.\u0275fac=function(Y){return new(Y||Ae)(h.Y36(B.i),h.Y36(W.z))},Ae.\u0275cmp=h.Xpm({type:Ae,selectors:[["azt-answer-box-with-user-answer-for-teacher"]],inputs:{questionObj:"questionObj",examObj:"examObj",isShowExplain:"isShowExplain",userAnswersObj:"userAnswersObj",notShowAnswerYet:"notShowAnswerYet",currentTab:"currentTab"},outputs:{isShowExplainChange:"isShowExplainChange"},features:[h.qOj],decls:12,vars:17,consts:[[1,"question-standalone-answer-box-for-student","box","p-2","pt-0","shadow-none"],["azt-track-service","azt-standalone-question-sMnAQgQ7w7k",1,"explainTxt","text-pending","cursor-pointer","mt-2",3,"ngStyle","click"],["class","answer-box-type1 mt-2",4,"ngIf"],["class","answer-box answer-box-type3 ml-auto justify-content-between notForPdfExport",4,"ngIf"],[1,"answer-box-type1","mt-2"],[1,"keyText","my-1",3,"ngStyle"],["id","type_1",1,"limit-max-width","answer-box","ml-auto","my-1",3,"ngStyle"],["class","label-item",4,"ngFor","ngForOf"],[1,"label-item"],[3,"ngIf"],["class","rightIcon","style","color: #00ac33",4,"ngIf"],[1,"lalala"],["class","wrongIcon","style","color: red",4,"ngIf"],[1,"wrongIcon",2,"color","red"],[1,"rightIcon",2,"color","#00ac33"],["class","keyText my-1",3,"ngStyle",4,"ngIf"],["id","type_2",1,"answer-box","ml-auto","my-1",2,"padding","0",3,"ngStyle"],[1,"text-answer","answer-box","forPdfExport","justify-content-between"],[1,"answer-box","answer-box-type3","ml-auto","justify-content-between","notForPdfExport"],[4,"ngIf"],["azt-track-service","answer-box-LBNR1fkVDxS",1,"clickable",3,"click"],[1,"answer-essay-txt",3,"innerHtml"]],template:function(Y,ae){1&Y&&(h.TgZ(0,"div",0)(1,"span",1),h.NdJ("click",function(){return ae.showExplain()}),h._uU(2),h.ALo(3,"mytranslate"),h.TgZ(4,"mat-icon"),h._uU(5),h.qZA()(),h.YNc(6,le,6,11,"div",2),h.ALo(7,"isOneChoiceAnswer"),h.YNc(8,H,6,7,"div",2),h.ALo(9,"isFillAnswer"),h.YNc(10,Me,3,2,"div",3),h.ALo(11,"isEssayAnswer"),h.qZA()),2&Y&&(h.xp6(1),h.Q6J("ngStyle",h.WLB(14,pt,ae.questionObj.help?"125px":"0px",ae.questionObj.help?"visible":"hidden")),h.xp6(1),h.hij(" ",h.lcZ(3,6,"lang_auto_giai_thich")," "),h.xp6(3),h.Oqu(ae.isShowExplain?"expand_less":"expand_more"),h.xp6(1),h.Q6J("ngIf",h.lcZ(7,8,ae.questionObj)),h.xp6(2),h.Q6J("ngIf",h.lcZ(9,10,ae.questionObj)),h.xp6(2),h.Q6J("ngIf",h.lcZ(11,12,ae.questionObj)))},dependencies:[_.sg,_.O5,_.PC,F.Hw,E.JV,E.Uy,E.eH,E.ck],styles:[".question-standalone-answer-box-for-student[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.answer-box[_ngcontent-%COMP%]{width:250px;display:flex;justify-content:space-around;padding:10px;border:1px solid #f1f1f1;border-radius:3px}.answer-box.limit-max-width[_ngcontent-%COMP%]{max-width:250px}.answer-box[_ngcontent-%COMP%]   .label-item[_ngcontent-%COMP%]{font-weight:500;display:flex;align-items:center;font-size:16px;width:40px;justify-content:flex-end}.answer-box.answer-box-type3[_ngcontent-%COMP%]{width:100%}.answer-box-type1[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-box-type1[_ngcontent-%COMP%]   .keyText[_ngcontent-%COMP%]{font-weight:500;font-size:16px;flex:auto;text-align:right;margin-right:15px}.text-answer[_ngcontent-%COMP%]{width:100%;min-height:40px;max-height:120px;overflow:auto;padding:10px}textarea[_ngcontent-%COMP%]:focus{border:none!important}.explainTxt[_ngcontent-%COMP%]{width:125px;font-weight:500;display:flex;align-items:center}@media screen and (max-width: 768px){.answer-box-type1[_ngcontent-%COMP%]{margin-left:15px}}@media screen and (max-width: 768px){.question-standalone-answer-box-for-student[_ngcontent-%COMP%]{flex-direction:column-reverse;align-items:flex-start}}@media screen and (max-width: 480px){.answer-box[_ngcontent-%COMP%]{width:auto}.text-answer[_ngcontent-%COMP%]{width:180px;max-height:auto}}"]}),Ae})();var ht=w(11343),we=w(35852),Ne=w(41030),X=w(28221),Be=w(11096),V=w(57394),oe=w(25797),pe=w(19377);const Ue=function(Ae){return{"skeleton-box-loading":Ae}};function rt(Ae,ne){if(1&Ae&&h._UZ(0,"div",3),2&Ae){const Y=h.oxw();h.Q6J("ngClass",h.VKq(1,Ue,Y.renderConfigObj.isFirstRender))}}function Je(Ae,ne){if(1&Ae&&h._UZ(0,"azt-test-audio-ui",14),2&Ae){const Y=h.oxw(2);h.Q6J("questionObj",Y.questionObj)("isShowList",!0)}}const xt=function(Ae,ne){return{"pb-2":Ae,"mob-web-width":ne}};function De(Ae,ne){if(1&Ae){const Y=h.EpF();h.TgZ(0,"div",4)(1,"div",5),h._UZ(2,"azt-question-group-content-box",6),h.TgZ(3,"div",7),h.YNc(4,Je,1,2,"azt-test-audio-ui",8),h.TgZ(5,"div",9),h._UZ(6,"azt-question-label-box",10)(7,"azt-question-action-box",11),h.qZA(),h._UZ(8,"azt-question-content-box",6)(9,"azt-question-answer-view-content-box",6),h.qZA()(),h.TgZ(10,"azt-answer-box-with-user-answer-for-teacher",12),h.NdJ("isShowExplainChange",function($){h.CHM(Y);const Se=h.oxw();return h.KtG(Se.isShowExplain=$)}),h.qZA(),h._UZ(11,"azt-question-explain-box",13),h.qZA()}if(2&Ae){const Y=h.oxw();h.xp6(1),h.Udp("font-size","1em")("line-height","1.7"),h.Q6J("id","question_render_container_"+Y.questionObj.id)("ngClass",h.WLB(35,xt,Y.questionObj.attachments.length>0,Y.isMobileWebView)),h.xp6(1),h.Q6J("examObj",Y.examObj)("questionObj",Y.questionObj)("renderConfigObj",Y.renderConfigObj),h.xp6(2),h.Q6J("ngIf",Y.questionObj.attachments.length>0),h.xp6(2),h.Q6J("examObj",Y.examObj)("questionObj",Y.questionObj)("renderConfigObj",Y.renderConfigObj)("curQuestionIndex",Y.curQuestionIndex),h.xp6(1),h.Q6J("showForTeacher",!0)("examObj",Y.examObj)("questionObj",Y.questionObj)("renderConfigObj",Y.renderConfigObj)("curQuestionIndex",Y.curQuestionIndex)("orgExamObjs",Y.orgExamObjs),h.xp6(1),h.Q6J("examObj",Y.examObj)("questionObj",Y.questionObj)("renderConfigObj",Y.renderConfigObj),h.xp6(1),h.Q6J("examObj",Y.examObj)("questionObj",Y.questionObj)("renderConfigObj",Y.renderConfigObj),h.xp6(1),h.Q6J("examObj",Y.examObj)("questionObj",Y.questionObj)("userAnswersObj",Y.userAnswersObj)("notShowAnswerYet",Y.notShowAnswerYet)("isShowExplain",Y.isShowExplain)("currentTab",Y.currentTab),h.xp6(1),h.Q6J("isShowExplain",Y.isShowExplain)("questionObj",Y.questionObj)("renderConfigObj",Y.renderConfigObj)}}let wt=(()=>{class Ae extends O.R{ngOnInit(){super.ngOnInit();let Y=new u.m(!1,!1,!1);super.initData(Y,this.follower,this.questionObj)}constructor(){super(),this.follower=new g.p,this.curQuestionIndex=0,this.orgExamObjs=[],this.isShowExplain=!1,this.userAnswersObj={},this.notShowAnswerYet=!1,this.currentTab="multiple_choice_tab"}}return Ae.\u0275fac=function(Y){return new(Y||Ae)},Ae.\u0275cmp=h.Xpm({type:Ae,selectors:[["azt-question-standalone-for-teacher-at-review-page"]],inputs:{examObj:"examObj",questionObj:"questionObj",follower:"follower",curQuestionIndex:"curQuestionIndex",orgExamObjs:"orgExamObjs",isShowExplain:"isShowExplain",userAnswersObj:"userAnswersObj",notShowAnswerYet:"notShowAnswerYet",currentTab:"currentTab"},features:[h.qOj],decls:4,vars:3,consts:[["load_effect_lazy","",1,"question-standalone-box",3,"id"],["class","question-standalone-loader-box",3,"ngClass",4,"ngIf","ngIfElse"],["elementRended",""],[1,"question-standalone-loader-box",3,"ngClass"],[1,"question-standalone-content-box"],[1,"question-standalone-container","box","border-none",3,"id","ngClass"],[3,"examObj","questionObj","renderConfigObj"],[1,"question-standalone-main-content"],[3,"questionObj","isShowList",4,"ngIf"],[1,"flex","items-center","justify-between"],[3,"examObj","questionObj","renderConfigObj","curQuestionIndex"],[3,"showForTeacher","examObj","questionObj","renderConfigObj","curQuestionIndex","orgExamObjs"],[3,"examObj","questionObj","userAnswersObj","notShowAnswerYet","isShowExplain","currentTab","isShowExplainChange"],[2,"display","block",3,"isShowExplain","questionObj","renderConfigObj"],[3,"questionObj","isShowList"]],template:function(Y,ae){if(1&Y&&(h.TgZ(0,"div",0),h.YNc(1,rt,1,3,"div",1),h.YNc(2,De,12,38,"ng-template",null,2,h.W1O),h.qZA()),2&Y){const $=h.MAs(3);h.Q6J("id","question_render_element_"+ae.questionObj.id),h.xp6(1),h.Q6J("ngIf",!ae.renderConfigObj.isRenderElement)("ngIfElse",$)}},dependencies:[_.mk,_.O5,Fe,ht.C,we.T,Ne.J,X.w,Be.S,V.L,oe.w,pe.P],styles:['.pr-7[_ngcontent-%COMP%]{padding-right:28px}.w-38px[_ngcontent-%COMP%]{width:38px}.remove-grid[_ngcontent-%COMP%]{display:block!important}.question-standalone-loader-box[_ngcontent-%COMP%]{min-height:50px}  .skeleton-box-loading{width:100%;height:30px;max-width:100%;margin-bottom:5px;display:inline-block}  .skeleton-box-loading:after{position:absolute;inset:0;transform:translate(-100%);animation:_ngcontent-%COMP%_shimmer 2s infinite;content:""}.question-standalone-box[_ngcontent-%COMP%]{margin-bottom:30px;display:block;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-ring-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-shadow);border-radius:.375rem}.question-standalone-container[_ngcontent-%COMP%]{padding:15px}.question-standalone-for-test-finder[_ngcontent-%COMP%]{border:none;margin-bottom:0;padding:0}.question-standalone-for-test-finder[_ngcontent-%COMP%]   .question-standalone-main-content[_ngcontent-%COMP%]{padding:15px;border:1px solid rgb(228,228,228)}.group-of-question-standalone-for-test-finder[_ngcontent-%COMP%]{padding:15px!important;border:1px solid rgb(228,228,228)!important}.question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid #2262AE!important;outline:3px solid rgba(125,160,201,.65)!important}.group-of-question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid green!important;outline:3px solid rgba(0,193,0,.321)!important}.question-standalone-container[_ngcontent-%COMP%]:hover   .prev_question_btn[_ngcontent-%COMP%], .question-standalone-container[_ngcontent-%COMP%]:hover   .next_question_btn[_ngcontent-%COMP%]{visibility:visible}.question-standalone-label[_ngcontent-%COMP%]{font-weight:700}.question-standalone-content-box[_ngcontent-%COMP%]{position:relative}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]{color:#f44336;position:relative;padding-left:20px;display:flex;align-items:center}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]:before{content:"!";position:absolute;left:0;color:#fff;background:#f44336;width:15px;height:15px;text-align:center;border-radius:50%;font-size:smaller;display:flex;justify-content:center;align-items:center}.question-standalone-step-container-box[_ngcontent-%COMP%]{margin-bottom:50px}.group-content-of-question-standalone[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.answer[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-label[_ngcontent-%COMP%]{width:20px;height:30px;min-width:20px;min-height:30px;display:flex;align-items:center;justify-content:flex-start;border-radius:50%;border-width:2px;border-style:solid;border-color:transparent}.answer-box[_ngcontent-%COMP%]{border-radius:0 0 3px 3px;padding:8px 20px;justify-content:space-between;align-items:center}.selected-answer[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff}.answer-content-front[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap;width:calc(100% - 30px)}.explainTxt[_ngcontent-%COMP%]{width:125px;font-weight:500;display:flex;align-items:center}#examHeader[_ngcontent-%COMP%]{display:block;border:1px solid #e7e7e7;border-radius:3px;overflow:hidden}.next_question_btn[_ngcontent-%COMP%]{position:absolute;right:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]{position:absolute;left:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]:hover, .next_question_btn[_ngcontent-%COMP%]:hover{visibility:visible}.arrow_btn[_ngcontent-%COMP%]{font-size:20px;vertical-align:middle;width:20px;height:20px;color:#fff;margin-left:auto!important;margin-right:auto!important;-webkit-user-select:none;user-select:none}.bottom_action[_ngcontent-%COMP%]{position:fixed;padding:15px;bottom:0;left:0;background:#312e2e;color:#fff;width:100%}.bottom_action[_ngcontent-%COMP%]   .collapse[_ngcontent-%COMP%]{display:block}.btn-ans-result[_ngcontent-%COMP%]{color:#fff;background-color:#f39c12}.show-list[_ngcontent-%COMP%]{max-width:200px}.show-list[_ngcontent-%COMP%]   .show-sheet[_ngcontent-%COMP%]   .listli[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:27px;height:27px;border-radius:50%;border:1px solid #347da5;display:flex;align-items:center;color:#fff;justify-content:center;font-size:12px;cursor:pointer;-webkit-user-select:none;user-select:none}.top_action[_ngcontent-%COMP%]{position:fixed;padding:10px;top:0;left:0;background:#312e2e;color:#fff;width:100%}.scrollSheetMobile[_ngcontent-%COMP%]{max-height:200px;overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.scrollSheetMobile[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}.notify-badge[_ngcontent-%COMP%]{position:absolute;right:3px;top:3px;text-align:center;color:#afafaf;padding:0;font-size:20px;cursor:pointer}.attach-container[_ngcontent-%COMP%]{background:#fff;padding:10px 0 0;border-radius:5px;width:83.33%;border:1px solid #e8e8e8}.answer-review[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid rgb(52,125,165);display:flex;align-items:center;color:#fff;justify-content:center;font-size:15px;-webkit-user-select:none;user-select:none}.border-none[_ngcontent-%COMP%]{border:none!important}.bg-question[_ngcontent-%COMP%]{margin-top:15px;padding:15px 10px;background:#fff}.question-pending-part[_ngcontent-%COMP%]{width:100%;height:50px}.pencil-edit[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:30px;height:30px;border-radius:50%;text-align:center;background:darkgrey;z-index:9999}.pencil-edit[_ngcontent-%COMP%]   .lucide[_ngcontent-%COMP%]{color:#fff;stroke-width:2.5px;height:29px}.margin-question-bar[_ngcontent-%COMP%]{margin-top:calc(3rem + 40px)!important}.sheet-screen[_ngcontent-%COMP%]{max-height:calc(100vh - 140px);overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.sheet-screen[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}  .layout{display:grid;margin:20px 0;grid-row-gap:20px}  .layout-4{grid-template-columns:1fr 1fr 1fr 1fr}  .layout-2{grid-template-columns:1fr 1fr}  .layout-1{grid-template-columns:1fr}  .question-standalone-content-box{max-width:100%;overflow-x:auto;overflow-y:hidden}  #boxContentQuestion .question-standalone-container{max-width:800px}@keyframes _ngcontent-%COMP%_shimmer{to{transform:translate(100%)}}@media (max-width: 768px){.answer-content-front[_ngcontent-%COMP%]{justify-content:center}.btn-ans-result[_ngcontent-%COMP%]{margin-right:auto!important}}@media (max-width: 800px){  #boxContentQuestion .question-standalone-container{max-width:calc(90vw - 16px)!important}}']}),Ae})()},19377:(at,ue,w)=>{"use strict";w.d(ue,{P:()=>pt});var O=w(77127),u=w(19347),g=w(86670),h=w(90241),_=w(65879),m=w(71284),B=w(96814),W=w(20787),F=w(30251),E=w(11964);function R(Fe,ht){1&Fe&&(_.TgZ(0,"div",9)(1,"div",10)(2,"span",11),_._uU(3),_.ALo(4,"mytranslate"),_.qZA()()()),2&Fe&&(_.xp6(3),_.Oqu(_.lcZ(4,1,"lang_auto_dang_chuan_bi_tai_lieu_doing")))}function A(Fe,ht){if(1&Fe&&_._UZ(0,"azt-question-standalone-for-preview",15),2&Fe){const we=_.oxw().$implicit,Ne=_.oxw();_.Q6J("examObj",Ne.data.examObj)("questionObj",we.questionLog)("follower",Ne.data.follower)("curQuestionIndex",Ne.data.curQuestionIndex)}}function fe(Fe,ht){if(1&Fe&&(_.ynx(0),_.TgZ(1,"div",12),_._uU(2),_.ALo(3,"mytranslate"),_.ALo(4,"formatFullDateTimeWithoutSecondByUserUnitPipe"),_.qZA(),_.TgZ(5,"div",13),_.YNc(6,A,1,4,"azt-question-standalone-for-preview",14),_.qZA(),_.BQk()),2&Fe){const we=ht.$implicit;_.xp6(2),_.hij(" ",_.lcZ(3,2,"lang_azota_ui_the_time_of_question_editing")+": "+_.lcZ(4,4,we.createdAt)," "),_.xp6(4),_.Q6J("ngIf",we.questionLog)}}let L=(()=>{class Fe extends h.e{closeDialog(){this.dialogRef.close()}getLogQuestion(we){this.initStatusObj(),this.subscriptions.add(this.questionService.apiQuestionsIdLogsGet(we).subscribe(Ne=>{1===Ne.success?(Ne.data?.objs??[]).forEach(Be=>{let V={createdAt:Be.createdAt,questionLog:this.commonService.castJsonToClassObj(g.v,JSON.stringify(Be.questionLog))};V.questionLog&&(V.questionLog.isLogEditQuestion=!0),this.questionLogCustomList.push(V),this.successStatusObj()}):this.errorStatusObj(Ne.message??"",!0)}))}ngOnInit(){this.getLogQuestion(this.data.questionObj.id)}constructor(we,Ne,X){super(X,Ne),this.questionService=we,this.dialogRef=Ne,this.data=X,this.questionLogCustomList=[]}}return Fe.\u0275fac=function(we){return new(we||Fe)(_.Y36(m.aE),_.Y36(u.so,8),_.Y36(u.WI,8))},Fe.\u0275cmp=_.Xpm({type:Fe,selectors:[["show-question-edit-history-dialog"]],features:[_.qOj],decls:14,vars:12,consts:[[1,"box"],[1,"font-medium","p-3","bg-slate-100","dark:bg-darkmode-400"],[3,"defaultHeight"],["class","flex justify-center items-center h-40",4,"ngIf"],["id","boxContentQuestion",1,"p-2"],[4,"ngFor","ngForOf"],[1,"flex","items-center","p-2","pt-3"],[1,"ml-auto"],[1,"btn","btn-secondary",3,"click"],[1,"flex","justify-center","items-center","h-40"],["role","status",1,"spinner-border"],[1,"sr-only"],[1,"p-2","pb-0","text-xs","font-medium",2,"margin-bottom","-10px"],[1,"p-2"],[3,"examObj","questionObj","follower","curQuestionIndex",4,"ngIf"],[3,"examObj","questionObj","follower","curQuestionIndex"]],template:function(we,Ne){1&we&&(_.TgZ(0,"div",0)(1,"div",1),_._uU(2),_.ALo(3,"mytranslate"),_.ALo(4,"mytranslate"),_.qZA(),_.TgZ(5,"azt-mat-dialog-content",2),_.YNc(6,R,5,3,"div",3),_.TgZ(7,"div",4),_.YNc(8,fe,7,6,"ng-container",5),_.qZA()(),_.TgZ(9,"div",6)(10,"div",7)(11,"button",8),_.NdJ("click",function(){return Ne.closeDialog()}),_._uU(12),_.ALo(13,"mytranslate"),_.qZA()()()()),2&we&&(_.xp6(2),_.AsE(" ",_.lcZ(3,6,"lang_azota_ui_the_history_of_question_editing")," (",Ne.questionLogCustomList.length+" "+_.lcZ(4,8,"lang_testbank_powerpoint_times"),") "),_.xp6(3),_.Q6J("defaultHeight",60),_.xp6(1),_.Q6J("ngIf",Ne.statusObj.loading),_.xp6(2),_.Q6J("ngForOf",Ne.questionLogCustomList),_.xp6(4),_.hij(" ",_.lcZ(13,10,"lang_auto_dong")," "))},dependencies:[B.sg,B.O5,W.A,F.R,E.JV,E.$n],encapsulation:2}),Fe})();var U=w(39621),Z=w(56443),le=w(61675),P=w(21266),H=w(35318),ce=w(92596),ge=w(37722);function Oe(Fe,ht){if(1&Fe){const we=_.EpF();_.TgZ(0,"div",4)(1,"button",5),_.NdJ("click",function(){_.CHM(we);const X=_.oxw();return _.KtG(X.goToEditQuestion())}),_.ALo(2,"mytranslate"),_.TgZ(3,"span",6),_._UZ(4,"lucide-icon",7),_.qZA()()()}2&Fe&&(_.xp6(1),_.s9C("matTooltip",_.lcZ(2,1,"lang_core_chinh_sua_de_thi")))}function qe(Fe,ht){if(1&Fe){const we=_.EpF();_.TgZ(0,"div")(1,"button",5),_.NdJ("click",function(){_.CHM(we);const X=_.oxw();return _.KtG(X.showEditHistoryDialog())}),_.ALo(2,"mytranslate"),_.TgZ(3,"span",6),_._UZ(4,"lucide-icon",8),_.qZA()()()}2&Fe&&(_.xp6(1),_.s9C("matTooltip",_.lcZ(2,1,"lang_azota_ui_the_history_of_question_editing")))}function Me(Fe,ht){if(1&Fe){const we=_.EpF();_.TgZ(0,"div",9)(1,"button",10),_.NdJ("click",function(){_.CHM(we);const X=_.oxw();return _.KtG(X.showFeedbackQuestionDialog())}),_.ALo(2,"mytranslate"),_.TgZ(3,"span",6),_._UZ(4,"lucide-icon",11),_.qZA()()()}2&Fe&&(_.xp6(1),_.s9C("matTooltip",_.lcZ(2,1,"lang_auto_bao_loi")))}let pt=(()=>{class Fe extends U.Q{checkEditQuestion(){const we=this.questionObj?.createdAt,Ne=this.questionObj?.updatedAt;let X=this.timeService.calculationTimeOnlyMinutes(we,Ne);this.isEditQuestion=Number(X)>0}isOrgQuestion(){return null!=this.orgExamObjs.find(we=>we.questionId==this.questionObj.id)}goToEditQuestion(){var we=this.commonService.getMyParam(this.activeRoute,"cat_id")??"0",Ne=this.activeRoute.snapshot.paramMap.get("result_id")??"",X=this.activeRoute.snapshot.paramMap.get("user_id")??"",Be=this.activeRoute.snapshot.paramMap.get("student_id")??"",V=this.activeRoute.snapshot.paramMap.get("exam_id")??"",oe=we,pe=V;let Ue=this.orgExamObjs.find(xt=>xt.questionId==this.questionObj.id);Ue&&(oe=Ue.orgCategoryId?.toString()??"0",pe=Ue.orgExamId?.toString()??"0");var rt=this.commonService.getMyQueryParam("backto")??"";let Je=`/admin/testbank/test-review/${V}/${X}/${Be}/${Ne}`+(rt?"?backto="+encodeURIComponent(rt):"");window.location.href=this.commonService.getLocalRouter("/admin/testbank/update-exam/"+oe)+"/"+pe+"?backto="+encodeURIComponent(Je)+"&questionId="+this.questionObj.id}showEditHistoryDialog(){let we={follower:new Z.p,examObj:this.examObj,questionObj:this.questionObj,renderConfigObj:this.renderConfigObj,curQuestionIndex:this.curQuestionIndex};this.sAztDialogService.open(L,{width:"750px",data:we})}showFeedbackQuestionDialog(){this.sAztDialogService.open(O.V,{width:"750px",data:{questionObj:this.questionObj,role:this.showForTeacher?"TEACHER":"STUDENT",applyType:"MATRIX_QUESTION"},restoreFocus:!1,autoFocus:!1})}ngOnChanges(){this.checkEditQuestion()}constructor(we,Ne,X){super(),this.sAztDialogService=we,this.activeRoute=Ne,this.timeService=X,this.showForTeacher=!1,this.isEditQuestion=!1}}return Fe.\u0275fac=function(we){return new(we||Fe)(_.Y36(le.C),_.Y36(P.gz),_.Y36(H.D))},Fe.\u0275cmp=_.Xpm({type:Fe,selectors:[["azt-question-action-box"]],inputs:{examObj:"examObj",questionObj:"questionObj",renderConfigObj:"renderConfigObj",orgExamObjs:"orgExamObjs",showForTeacher:"showForTeacher",curQuestionIndex:"curQuestionIndex"},features:[_.qOj,_.TTD],decls:5,vars:5,consts:[[1,"flex"],["class","mr-1",4,"ngIf"],[4,"ngIf"],["reportQTakeTest","",4,"ngIf"],[1,"mr-1"],[1,"btn","btn-outline-primary","btn-sm","p-1",3,"matTooltip","click"],[1,"inline-block","w-4","h-4"],["name","file-edit"],["name","history"],["reportQTakeTest",""],["matTooltipShowDelay","200",1,"btn","btn-outline-primary","btn-sm","p-1",3,"matTooltip","click"],["name","alert-octagon"]],template:function(we,Ne){1&we&&(_.TgZ(0,"div",0),_.YNc(1,Oe,5,3,"div",1),_.ALo(2,"isOfflineExam"),_.YNc(3,qe,5,3,"div",2),_.YNc(4,Me,5,3,"div",3),_.qZA()),2&we&&(_.xp6(1),_.Q6J("ngIf",Ne.isOrgQuestion()&&!_.lcZ(2,3,Ne.examObj)),_.xp6(2),_.Q6J("ngIf",Ne.isEditQuestion&&!Ne.questionObj.isLogEditQuestion),_.xp6(1),_.Q6J("ngIf",Ne.showForTeacher&&Ne.questionObj.enableFeedback))},dependencies:[B.O5,ce.gM,ge.Nh5,E.JV,E.OJ],styles:['.pr-7[_ngcontent-%COMP%]{padding-right:28px}.w-38px[_ngcontent-%COMP%]{width:38px}.remove-grid[_ngcontent-%COMP%]{display:block!important}.question-standalone-loader-box[_ngcontent-%COMP%]{min-height:50px}  .skeleton-box-loading{width:100%;height:30px;max-width:100%;margin-bottom:5px;display:inline-block}  .skeleton-box-loading:after{position:absolute;inset:0;transform:translate(-100%);animation:_ngcontent-%COMP%_shimmer 2s infinite;content:""}.question-standalone-box[_ngcontent-%COMP%]{margin-bottom:30px;display:block;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-ring-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-shadow);border-radius:.375rem}.question-standalone-container[_ngcontent-%COMP%]{padding:15px}.question-standalone-for-test-finder[_ngcontent-%COMP%]{border:none;margin-bottom:0;padding:0}.question-standalone-for-test-finder[_ngcontent-%COMP%]   .question-standalone-main-content[_ngcontent-%COMP%]{padding:15px;border:1px solid rgb(228,228,228)}.group-of-question-standalone-for-test-finder[_ngcontent-%COMP%]{padding:15px!important;border:1px solid rgb(228,228,228)!important}.question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid #2262AE!important;outline:3px solid rgba(125,160,201,.65)!important}.group-of-question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid green!important;outline:3px solid rgba(0,193,0,.321)!important}.question-standalone-container[_ngcontent-%COMP%]:hover   .prev_question_btn[_ngcontent-%COMP%], .question-standalone-container[_ngcontent-%COMP%]:hover   .next_question_btn[_ngcontent-%COMP%]{visibility:visible}.question-standalone-label[_ngcontent-%COMP%]{font-weight:700}.question-standalone-content-box[_ngcontent-%COMP%]{position:relative}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]{color:#f44336;position:relative;padding-left:20px;display:flex;align-items:center}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]:before{content:"!";position:absolute;left:0;color:#fff;background:#f44336;width:15px;height:15px;text-align:center;border-radius:50%;font-size:smaller;display:flex;justify-content:center;align-items:center}.question-standalone-step-container-box[_ngcontent-%COMP%]{margin-bottom:50px}.group-content-of-question-standalone[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.answer[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-label[_ngcontent-%COMP%]{width:20px;height:30px;min-width:20px;min-height:30px;display:flex;align-items:center;justify-content:flex-start;border-radius:50%;border-width:2px;border-style:solid;border-color:transparent}.answer-box[_ngcontent-%COMP%]{border-radius:0 0 3px 3px;padding:8px 20px;justify-content:space-between;align-items:center}.selected-answer[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff}.answer-content-front[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap;width:calc(100% - 30px)}.explainTxt[_ngcontent-%COMP%]{width:125px;font-weight:500;display:flex;align-items:center}#examHeader[_ngcontent-%COMP%]{display:block;border:1px solid #e7e7e7;border-radius:3px;overflow:hidden}.next_question_btn[_ngcontent-%COMP%]{position:absolute;right:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]{position:absolute;left:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]:hover, .next_question_btn[_ngcontent-%COMP%]:hover{visibility:visible}.arrow_btn[_ngcontent-%COMP%]{font-size:20px;vertical-align:middle;width:20px;height:20px;color:#fff;margin-left:auto!important;margin-right:auto!important;-webkit-user-select:none;user-select:none}.bottom_action[_ngcontent-%COMP%]{position:fixed;padding:15px;bottom:0;left:0;background:#312e2e;color:#fff;width:100%}.bottom_action[_ngcontent-%COMP%]   .collapse[_ngcontent-%COMP%]{display:block}.btn-ans-result[_ngcontent-%COMP%]{color:#fff;background-color:#f39c12}.show-list[_ngcontent-%COMP%]{max-width:200px}.show-list[_ngcontent-%COMP%]   .show-sheet[_ngcontent-%COMP%]   .listli[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:27px;height:27px;border-radius:50%;border:1px solid #347da5;display:flex;align-items:center;color:#fff;justify-content:center;font-size:12px;cursor:pointer;-webkit-user-select:none;user-select:none}.top_action[_ngcontent-%COMP%]{position:fixed;padding:10px;top:0;left:0;background:#312e2e;color:#fff;width:100%}.scrollSheetMobile[_ngcontent-%COMP%]{max-height:200px;overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.scrollSheetMobile[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}.notify-badge[_ngcontent-%COMP%]{position:absolute;right:3px;top:3px;text-align:center;color:#afafaf;padding:0;font-size:20px;cursor:pointer}.attach-container[_ngcontent-%COMP%]{background:#fff;padding:10px 0 0;border-radius:5px;width:83.33%;border:1px solid #e8e8e8}.answer-review[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid rgb(52,125,165);display:flex;align-items:center;color:#fff;justify-content:center;font-size:15px;-webkit-user-select:none;user-select:none}.border-none[_ngcontent-%COMP%]{border:none!important}.bg-question[_ngcontent-%COMP%]{margin-top:15px;padding:15px 10px;background:#fff}.question-pending-part[_ngcontent-%COMP%]{width:100%;height:50px}.pencil-edit[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:30px;height:30px;border-radius:50%;text-align:center;background:darkgrey;z-index:9999}.pencil-edit[_ngcontent-%COMP%]   .lucide[_ngcontent-%COMP%]{color:#fff;stroke-width:2.5px;height:29px}.margin-question-bar[_ngcontent-%COMP%]{margin-top:calc(3rem + 40px)!important}.sheet-screen[_ngcontent-%COMP%]{max-height:calc(100vh - 140px);overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.sheet-screen[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}  .layout{display:grid;margin:20px 0;grid-row-gap:20px}  .layout-4{grid-template-columns:1fr 1fr 1fr 1fr}  .layout-2{grid-template-columns:1fr 1fr}  .layout-1{grid-template-columns:1fr}  .question-standalone-content-box{max-width:100%;overflow-x:auto;overflow-y:hidden}  #boxContentQuestion .question-standalone-container{max-width:800px}@keyframes _ngcontent-%COMP%_shimmer{to{transform:translate(100%)}}@media (max-width: 768px){.answer-content-front[_ngcontent-%COMP%]{justify-content:center}.btn-ans-result[_ngcontent-%COMP%]{margin-right:auto!important}}@media (max-width: 800px){  #boxContentQuestion .question-standalone-container{max-width:calc(90vw - 16px)!important}}']}),Fe})()},57394:(at,ue,w)=>{"use strict";w.d(ue,{L:()=>m});var O=w(39621),u=w(65879),g=w(96814),h=w(11964);function _(B,W){if(1&B&&(u.ynx(0),u._UZ(1,"div",1),u.ALo(2,"safeContentQuestion"),u.ALo(3,"async"),u.ALo(4,"mathJaxContent"),u.BQk()),2&B){const F=u.oxw();u.xp6(1),u.Q6J("innerHtml",u.lcZ(2,1,u.lcZ(3,3,u.xi3(4,5,F.questionObj.content,F.renderConfigObj.configRenderService))),u.oJD)}}let m=(()=>{class B extends O.Q{}return B.\u0275fac=function(){let W;return function(E){return(W||(W=u.n5z(B)))(E||B)}}(),B.\u0275cmp=u.Xpm({type:B,selectors:[["azt-question-content-box"]],inputs:{examObj:"examObj",questionObj:"questionObj",renderConfigObj:"renderConfigObj"},features:[u.qOj],decls:2,vars:3,consts:[[4,"ngIf"],[1,"question-standalone-content-box",3,"innerHtml"]],template:function(F,E){1&F&&(u.YNc(0,_,5,8,"ng-container",0),u.ALo(1,"isOfflineExam")),2&F&&u.Q6J("ngIf",!u.lcZ(1,1,E.examObj))},dependencies:[g.O5,g.Ov,h.Pc,h.ES,h.OJ],styles:['.pr-7[_ngcontent-%COMP%]{padding-right:28px}.w-38px[_ngcontent-%COMP%]{width:38px}.remove-grid[_ngcontent-%COMP%]{display:block!important}.question-standalone-loader-box[_ngcontent-%COMP%]{min-height:50px}  .skeleton-box-loading{width:100%;height:30px;max-width:100%;margin-bottom:5px;display:inline-block}  .skeleton-box-loading:after{position:absolute;inset:0;transform:translate(-100%);animation:_ngcontent-%COMP%_shimmer 2s infinite;content:""}.question-standalone-box[_ngcontent-%COMP%]{margin-bottom:30px;display:block;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-ring-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-shadow);border-radius:.375rem}.question-standalone-container[_ngcontent-%COMP%]{padding:15px}.question-standalone-for-test-finder[_ngcontent-%COMP%]{border:none;margin-bottom:0;padding:0}.question-standalone-for-test-finder[_ngcontent-%COMP%]   .question-standalone-main-content[_ngcontent-%COMP%]{padding:15px;border:1px solid rgb(228,228,228)}.group-of-question-standalone-for-test-finder[_ngcontent-%COMP%]{padding:15px!important;border:1px solid rgb(228,228,228)!important}.question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid #2262AE!important;outline:3px solid rgba(125,160,201,.65)!important}.group-of-question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid green!important;outline:3px solid rgba(0,193,0,.321)!important}.question-standalone-container[_ngcontent-%COMP%]:hover   .prev_question_btn[_ngcontent-%COMP%], .question-standalone-container[_ngcontent-%COMP%]:hover   .next_question_btn[_ngcontent-%COMP%]{visibility:visible}.question-standalone-label[_ngcontent-%COMP%]{font-weight:700}.question-standalone-content-box[_ngcontent-%COMP%]{position:relative}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]{color:#f44336;position:relative;padding-left:20px;display:flex;align-items:center}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]:before{content:"!";position:absolute;left:0;color:#fff;background:#f44336;width:15px;height:15px;text-align:center;border-radius:50%;font-size:smaller;display:flex;justify-content:center;align-items:center}.question-standalone-step-container-box[_ngcontent-%COMP%]{margin-bottom:50px}.group-content-of-question-standalone[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.answer[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-label[_ngcontent-%COMP%]{width:20px;height:30px;min-width:20px;min-height:30px;display:flex;align-items:center;justify-content:flex-start;border-radius:50%;border-width:2px;border-style:solid;border-color:transparent}.answer-box[_ngcontent-%COMP%]{border-radius:0 0 3px 3px;padding:8px 20px;justify-content:space-between;align-items:center}.selected-answer[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff}.answer-content-front[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap;width:calc(100% - 30px)}.explainTxt[_ngcontent-%COMP%]{width:125px;font-weight:500;display:flex;align-items:center}#examHeader[_ngcontent-%COMP%]{display:block;border:1px solid #e7e7e7;border-radius:3px;overflow:hidden}.next_question_btn[_ngcontent-%COMP%]{position:absolute;right:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]{position:absolute;left:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]:hover, .next_question_btn[_ngcontent-%COMP%]:hover{visibility:visible}.arrow_btn[_ngcontent-%COMP%]{font-size:20px;vertical-align:middle;width:20px;height:20px;color:#fff;margin-left:auto!important;margin-right:auto!important;-webkit-user-select:none;user-select:none}.bottom_action[_ngcontent-%COMP%]{position:fixed;padding:15px;bottom:0;left:0;background:#312e2e;color:#fff;width:100%}.bottom_action[_ngcontent-%COMP%]   .collapse[_ngcontent-%COMP%]{display:block}.btn-ans-result[_ngcontent-%COMP%]{color:#fff;background-color:#f39c12}.show-list[_ngcontent-%COMP%]{max-width:200px}.show-list[_ngcontent-%COMP%]   .show-sheet[_ngcontent-%COMP%]   .listli[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:27px;height:27px;border-radius:50%;border:1px solid #347da5;display:flex;align-items:center;color:#fff;justify-content:center;font-size:12px;cursor:pointer;-webkit-user-select:none;user-select:none}.top_action[_ngcontent-%COMP%]{position:fixed;padding:10px;top:0;left:0;background:#312e2e;color:#fff;width:100%}.scrollSheetMobile[_ngcontent-%COMP%]{max-height:200px;overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.scrollSheetMobile[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}.notify-badge[_ngcontent-%COMP%]{position:absolute;right:3px;top:3px;text-align:center;color:#afafaf;padding:0;font-size:20px;cursor:pointer}.attach-container[_ngcontent-%COMP%]{background:#fff;padding:10px 0 0;border-radius:5px;width:83.33%;border:1px solid #e8e8e8}.answer-review[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid rgb(52,125,165);display:flex;align-items:center;color:#fff;justify-content:center;font-size:15px;-webkit-user-select:none;user-select:none}.border-none[_ngcontent-%COMP%]{border:none!important}.bg-question[_ngcontent-%COMP%]{margin-top:15px;padding:15px 10px;background:#fff}.question-pending-part[_ngcontent-%COMP%]{width:100%;height:50px}.pencil-edit[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:30px;height:30px;border-radius:50%;text-align:center;background:darkgrey;z-index:9999}.pencil-edit[_ngcontent-%COMP%]   .lucide[_ngcontent-%COMP%]{color:#fff;stroke-width:2.5px;height:29px}.margin-question-bar[_ngcontent-%COMP%]{margin-top:calc(3rem + 40px)!important}.sheet-screen[_ngcontent-%COMP%]{max-height:calc(100vh - 140px);overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.sheet-screen[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}  .layout{display:grid;margin:20px 0;grid-row-gap:20px}  .layout-4{grid-template-columns:1fr 1fr 1fr 1fr}  .layout-2{grid-template-columns:1fr 1fr}  .layout-1{grid-template-columns:1fr}  .question-standalone-content-box{max-width:100%;overflow-x:auto;overflow-y:hidden}  #boxContentQuestion .question-standalone-container{max-width:800px}@keyframes _ngcontent-%COMP%_shimmer{to{transform:translate(100%)}}@media (max-width: 768px){.answer-content-front[_ngcontent-%COMP%]{justify-content:center}.btn-ans-result[_ngcontent-%COMP%]{margin-right:auto!important}}@media (max-width: 800px){  #boxContentQuestion .question-standalone-container{max-width:calc(90vw - 16px)!important}}']}),B})()},28221:(at,ue,w)=>{"use strict";w.d(ue,{w:()=>m});var O=w(39621),u=w(65879),g=w(96814),h=w(11964);const _=function(B){return{display:B}};let m=(()=>{class B extends O.Q{constructor(){super(...arguments),this.isShowExplain=!1}}return B.\u0275fac=function(){let W;return function(E){return(W||(W=u.n5z(B)))(E||B)}}(),B.\u0275cmp=u.Xpm({type:B,selectors:[["azt-question-explain-box"]],inputs:{isShowExplain:"isShowExplain",questionObj:"questionObj",renderConfigObj:"renderConfigObj"},features:[u.qOj],decls:4,vars:11,consts:[[1,"help-content","box","pt-1","pb-3","pl-4","pr-4","py-1","mt-1",2,"display","inherit","border-top-right-radius","0","border-top-left-radius","0","margin-top","-5px","box-shadow","none","overflow","auto","padding-bottom","20px",3,"ngStyle","innerHtml"]],template:function(F,E){1&F&&(u._UZ(0,"div",0),u.ALo(1,"safeContentQuestion"),u.ALo(2,"async"),u.ALo(3,"mathJaxContent")),2&F&&u.Q6J("ngStyle",u.VKq(9,_,E.isShowExplain&&E.questionObj.help?"inherit":"none"))("innerHtml",u.lcZ(1,2,u.lcZ(2,4,u.xi3(3,6,E.questionObj.help,E.renderConfigObj.configRenderService))),u.oJD)},dependencies:[g.PC,g.Ov,h.Pc,h.ES],styles:['.pr-7[_ngcontent-%COMP%]{padding-right:28px}.w-38px[_ngcontent-%COMP%]{width:38px}.remove-grid[_ngcontent-%COMP%]{display:block!important}.question-standalone-loader-box[_ngcontent-%COMP%]{min-height:50px}  .skeleton-box-loading{width:100%;height:30px;max-width:100%;margin-bottom:5px;display:inline-block}  .skeleton-box-loading:after{position:absolute;inset:0;transform:translate(-100%);animation:_ngcontent-%COMP%_shimmer 2s infinite;content:""}.question-standalone-box[_ngcontent-%COMP%]{margin-bottom:30px;display:block;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-ring-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-shadow);border-radius:.375rem}.question-standalone-container[_ngcontent-%COMP%]{padding:15px}.question-standalone-for-test-finder[_ngcontent-%COMP%]{border:none;margin-bottom:0;padding:0}.question-standalone-for-test-finder[_ngcontent-%COMP%]   .question-standalone-main-content[_ngcontent-%COMP%]{padding:15px;border:1px solid rgb(228,228,228)}.group-of-question-standalone-for-test-finder[_ngcontent-%COMP%]{padding:15px!important;border:1px solid rgb(228,228,228)!important}.question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid #2262AE!important;outline:3px solid rgba(125,160,201,.65)!important}.group-of-question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid green!important;outline:3px solid rgba(0,193,0,.321)!important}.question-standalone-container[_ngcontent-%COMP%]:hover   .prev_question_btn[_ngcontent-%COMP%], .question-standalone-container[_ngcontent-%COMP%]:hover   .next_question_btn[_ngcontent-%COMP%]{visibility:visible}.question-standalone-label[_ngcontent-%COMP%]{font-weight:700}.question-standalone-content-box[_ngcontent-%COMP%]{position:relative}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]{color:#f44336;position:relative;padding-left:20px;display:flex;align-items:center}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]:before{content:"!";position:absolute;left:0;color:#fff;background:#f44336;width:15px;height:15px;text-align:center;border-radius:50%;font-size:smaller;display:flex;justify-content:center;align-items:center}.question-standalone-step-container-box[_ngcontent-%COMP%]{margin-bottom:50px}.group-content-of-question-standalone[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.answer[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-label[_ngcontent-%COMP%]{width:20px;height:30px;min-width:20px;min-height:30px;display:flex;align-items:center;justify-content:flex-start;border-radius:50%;border-width:2px;border-style:solid;border-color:transparent}.answer-box[_ngcontent-%COMP%]{border-radius:0 0 3px 3px;padding:8px 20px;justify-content:space-between;align-items:center}.selected-answer[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff}.answer-content-front[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap;width:calc(100% - 30px)}.explainTxt[_ngcontent-%COMP%]{width:125px;font-weight:500;display:flex;align-items:center}#examHeader[_ngcontent-%COMP%]{display:block;border:1px solid #e7e7e7;border-radius:3px;overflow:hidden}.next_question_btn[_ngcontent-%COMP%]{position:absolute;right:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]{position:absolute;left:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]:hover, .next_question_btn[_ngcontent-%COMP%]:hover{visibility:visible}.arrow_btn[_ngcontent-%COMP%]{font-size:20px;vertical-align:middle;width:20px;height:20px;color:#fff;margin-left:auto!important;margin-right:auto!important;-webkit-user-select:none;user-select:none}.bottom_action[_ngcontent-%COMP%]{position:fixed;padding:15px;bottom:0;left:0;background:#312e2e;color:#fff;width:100%}.bottom_action[_ngcontent-%COMP%]   .collapse[_ngcontent-%COMP%]{display:block}.btn-ans-result[_ngcontent-%COMP%]{color:#fff;background-color:#f39c12}.show-list[_ngcontent-%COMP%]{max-width:200px}.show-list[_ngcontent-%COMP%]   .show-sheet[_ngcontent-%COMP%]   .listli[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:27px;height:27px;border-radius:50%;border:1px solid #347da5;display:flex;align-items:center;color:#fff;justify-content:center;font-size:12px;cursor:pointer;-webkit-user-select:none;user-select:none}.top_action[_ngcontent-%COMP%]{position:fixed;padding:10px;top:0;left:0;background:#312e2e;color:#fff;width:100%}.scrollSheetMobile[_ngcontent-%COMP%]{max-height:200px;overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.scrollSheetMobile[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}.notify-badge[_ngcontent-%COMP%]{position:absolute;right:3px;top:3px;text-align:center;color:#afafaf;padding:0;font-size:20px;cursor:pointer}.attach-container[_ngcontent-%COMP%]{background:#fff;padding:10px 0 0;border-radius:5px;width:83.33%;border:1px solid #e8e8e8}.answer-review[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid rgb(52,125,165);display:flex;align-items:center;color:#fff;justify-content:center;font-size:15px;-webkit-user-select:none;user-select:none}.border-none[_ngcontent-%COMP%]{border:none!important}.bg-question[_ngcontent-%COMP%]{margin-top:15px;padding:15px 10px;background:#fff}.question-pending-part[_ngcontent-%COMP%]{width:100%;height:50px}.pencil-edit[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:30px;height:30px;border-radius:50%;text-align:center;background:darkgrey;z-index:9999}.pencil-edit[_ngcontent-%COMP%]   .lucide[_ngcontent-%COMP%]{color:#fff;stroke-width:2.5px;height:29px}.margin-question-bar[_ngcontent-%COMP%]{margin-top:calc(3rem + 40px)!important}.sheet-screen[_ngcontent-%COMP%]{max-height:calc(100vh - 140px);overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.sheet-screen[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}  .layout{display:grid;margin:20px 0;grid-row-gap:20px}  .layout-4{grid-template-columns:1fr 1fr 1fr 1fr}  .layout-2{grid-template-columns:1fr 1fr}  .layout-1{grid-template-columns:1fr}  .question-standalone-content-box{max-width:100%;overflow-x:auto;overflow-y:hidden}  #boxContentQuestion .question-standalone-container{max-width:800px}@keyframes _ngcontent-%COMP%_shimmer{to{transform:translate(100%)}}@media (max-width: 768px){.answer-content-front[_ngcontent-%COMP%]{justify-content:center}.btn-ans-result[_ngcontent-%COMP%]{margin-right:auto!important}}@media (max-width: 800px){  #boxContentQuestion .question-standalone-container{max-width:calc(90vw - 16px)!important}}']}),B})()},41030:(at,ue,w)=>{"use strict";w.d(ue,{J:()=>W});var O=w(39621),u=w(65879),g=w(2376),h=w(96814),_=w(11964);const m=function(F,E,R){return{"group-of-question-standalone-for-test-finder":F,"group-of-question-standalone-has-selected":E,clickable:R}};function B(F,E){if(1&F){const R=u.EpF();u.TgZ(0,"div",1),u.NdJ("click",function(){u.CHM(R);const fe=u.oxw();let L;return u.KtG(fe.handleClickGroup(null!==(L=null==fe.questionObj.groupInfo?null:fe.questionObj.groupInfo.groupId)&&void 0!==L?L:-1))}),u.ALo(1,"safeContentQuestion"),u.ALo(2,"async"),u.ALo(3,"mathJaxContent"),u.qZA()}if(2&F){const R=u.oxw();let A;u.Q6J("ngClass",u.kEZ(9,m,R.isTestFinderModule,!!R.questionGroupIdsSelected.includes(null!==(A=null==R.questionObj.groupInfo?null:R.questionObj.groupInfo.groupId)&&void 0!==A?A:-1),R.isTestFinderModule))("innerHtml",u.lcZ(1,2,u.lcZ(2,4,u.xi3(3,6,null==R.questionObj.groupInfo?null:R.questionObj.groupInfo.groupContent,R.renderConfigObj.configRenderService))),u.oJD)}}let W=(()=>{class F extends O.Q{handleClickGroup(R){this.isTestFinderModule&&this.testFinderSupportService.sendQuestionGroupSelectedEvent(R)}constructor(R){super(),this.testFinderSupportService=R,this.isTestFinderModule=!1,this.questionGroupIdsSelected=[]}}return F.\u0275fac=function(R){return new(R||F)(u.Y36(g.c))},F.\u0275cmp=u.Xpm({type:F,selectors:[["azt-question-group-content-box"]],inputs:{examObj:"examObj",questionObj:"questionObj",renderConfigObj:"renderConfigObj",isTestFinderModule:"isTestFinderModule",questionGroupIdsSelected:"questionGroupIdsSelected"},features:[u.qOj],decls:1,vars:1,consts:[["class","group-content-of-question-standalone",3,"ngClass","innerHtml","click",4,"ngIf"],[1,"group-content-of-question-standalone",3,"ngClass","innerHtml","click"]],template:function(R,A){1&R&&u.YNc(0,B,4,13,"div",0),2&R&&u.Q6J("ngIf",(null==A.questionObj.groupInfo?null:A.questionObj.groupInfo.isFirstInGroup)&&(!A.examObj.hideGroupQuestion||A.questionObj.isRoleTeacher))},dependencies:[h.mk,h.O5,h.Ov,_.Pc,_.ES],styles:['.pr-7[_ngcontent-%COMP%]{padding-right:28px}.w-38px[_ngcontent-%COMP%]{width:38px}.remove-grid[_ngcontent-%COMP%]{display:block!important}.question-standalone-loader-box[_ngcontent-%COMP%]{min-height:50px}  .skeleton-box-loading{width:100%;height:30px;max-width:100%;margin-bottom:5px;display:inline-block}  .skeleton-box-loading:after{position:absolute;inset:0;transform:translate(-100%);animation:_ngcontent-%COMP%_shimmer 2s infinite;content:""}.question-standalone-box[_ngcontent-%COMP%]{margin-bottom:30px;display:block;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-ring-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-shadow);border-radius:.375rem}.question-standalone-container[_ngcontent-%COMP%]{padding:15px}.question-standalone-for-test-finder[_ngcontent-%COMP%]{border:none;margin-bottom:0;padding:0}.question-standalone-for-test-finder[_ngcontent-%COMP%]   .question-standalone-main-content[_ngcontent-%COMP%]{padding:15px;border:1px solid rgb(228,228,228)}.group-of-question-standalone-for-test-finder[_ngcontent-%COMP%]{padding:15px!important;border:1px solid rgb(228,228,228)!important}.question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid #2262AE!important;outline:3px solid rgba(125,160,201,.65)!important}.group-of-question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid green!important;outline:3px solid rgba(0,193,0,.321)!important}.question-standalone-container[_ngcontent-%COMP%]:hover   .prev_question_btn[_ngcontent-%COMP%], .question-standalone-container[_ngcontent-%COMP%]:hover   .next_question_btn[_ngcontent-%COMP%]{visibility:visible}.question-standalone-label[_ngcontent-%COMP%]{font-weight:700}.question-standalone-content-box[_ngcontent-%COMP%]{position:relative}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]{color:#f44336;position:relative;padding-left:20px;display:flex;align-items:center}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]:before{content:"!";position:absolute;left:0;color:#fff;background:#f44336;width:15px;height:15px;text-align:center;border-radius:50%;font-size:smaller;display:flex;justify-content:center;align-items:center}.question-standalone-step-container-box[_ngcontent-%COMP%]{margin-bottom:50px}.group-content-of-question-standalone[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.answer[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-label[_ngcontent-%COMP%]{width:20px;height:30px;min-width:20px;min-height:30px;display:flex;align-items:center;justify-content:flex-start;border-radius:50%;border-width:2px;border-style:solid;border-color:transparent}.answer-box[_ngcontent-%COMP%]{border-radius:0 0 3px 3px;padding:8px 20px;justify-content:space-between;align-items:center}.selected-answer[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff}.answer-content-front[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap;width:calc(100% - 30px)}.explainTxt[_ngcontent-%COMP%]{width:125px;font-weight:500;display:flex;align-items:center}#examHeader[_ngcontent-%COMP%]{display:block;border:1px solid #e7e7e7;border-radius:3px;overflow:hidden}.next_question_btn[_ngcontent-%COMP%]{position:absolute;right:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]{position:absolute;left:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]:hover, .next_question_btn[_ngcontent-%COMP%]:hover{visibility:visible}.arrow_btn[_ngcontent-%COMP%]{font-size:20px;vertical-align:middle;width:20px;height:20px;color:#fff;margin-left:auto!important;margin-right:auto!important;-webkit-user-select:none;user-select:none}.bottom_action[_ngcontent-%COMP%]{position:fixed;padding:15px;bottom:0;left:0;background:#312e2e;color:#fff;width:100%}.bottom_action[_ngcontent-%COMP%]   .collapse[_ngcontent-%COMP%]{display:block}.btn-ans-result[_ngcontent-%COMP%]{color:#fff;background-color:#f39c12}.show-list[_ngcontent-%COMP%]{max-width:200px}.show-list[_ngcontent-%COMP%]   .show-sheet[_ngcontent-%COMP%]   .listli[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:27px;height:27px;border-radius:50%;border:1px solid #347da5;display:flex;align-items:center;color:#fff;justify-content:center;font-size:12px;cursor:pointer;-webkit-user-select:none;user-select:none}.top_action[_ngcontent-%COMP%]{position:fixed;padding:10px;top:0;left:0;background:#312e2e;color:#fff;width:100%}.scrollSheetMobile[_ngcontent-%COMP%]{max-height:200px;overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.scrollSheetMobile[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}.notify-badge[_ngcontent-%COMP%]{position:absolute;right:3px;top:3px;text-align:center;color:#afafaf;padding:0;font-size:20px;cursor:pointer}.attach-container[_ngcontent-%COMP%]{background:#fff;padding:10px 0 0;border-radius:5px;width:83.33%;border:1px solid #e8e8e8}.answer-review[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid rgb(52,125,165);display:flex;align-items:center;color:#fff;justify-content:center;font-size:15px;-webkit-user-select:none;user-select:none}.border-none[_ngcontent-%COMP%]{border:none!important}.bg-question[_ngcontent-%COMP%]{margin-top:15px;padding:15px 10px;background:#fff}.question-pending-part[_ngcontent-%COMP%]{width:100%;height:50px}.pencil-edit[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:30px;height:30px;border-radius:50%;text-align:center;background:darkgrey;z-index:9999}.pencil-edit[_ngcontent-%COMP%]   .lucide[_ngcontent-%COMP%]{color:#fff;stroke-width:2.5px;height:29px}.margin-question-bar[_ngcontent-%COMP%]{margin-top:calc(3rem + 40px)!important}.sheet-screen[_ngcontent-%COMP%]{max-height:calc(100vh - 140px);overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.sheet-screen[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}  .layout{display:grid;margin:20px 0;grid-row-gap:20px}  .layout-4{grid-template-columns:1fr 1fr 1fr 1fr}  .layout-2{grid-template-columns:1fr 1fr}  .layout-1{grid-template-columns:1fr}  .question-standalone-content-box{max-width:100%;overflow-x:auto;overflow-y:hidden}  #boxContentQuestion .question-standalone-container{max-width:800px}@keyframes _ngcontent-%COMP%_shimmer{to{transform:translate(100%)}}@media (max-width: 768px){.answer-content-front[_ngcontent-%COMP%]{justify-content:center}.btn-ans-result[_ngcontent-%COMP%]{margin-right:auto!important}}@media (max-width: 800px){  #boxContentQuestion .question-standalone-container{max-width:calc(90vw - 16px)!important}}']}),F})()},25797:(at,ue,w)=>{"use strict";w.d(ue,{w:()=>h});var O=w(39621),u=w(65879),g=w(11964);let h=(()=>{class _ extends O.Q{constructor(){super(...arguments),this.curQuestionIndex=0}get customQuestionLabel(){const B=this.commonService.castJsonToObj(this.examObj.expandInfo??"")??void 0;return B?.label?B.label:"C\xe2u"}ngOnInit(){this.startQuestionIndex=this.examObj.startQuestionIndex??1}}return _.\u0275fac=function(){let m;return function(W){return(m||(m=u.n5z(_)))(W||_)}}(),_.\u0275cmp=u.Xpm({type:_,selectors:[["azt-question-label-box"]],inputs:{examObj:"examObj",questionObj:"questionObj",renderConfigObj:"renderConfigObj",curQuestionIndex:"curQuestionIndex"},features:[u.qOj],decls:4,vars:6,consts:[[1,"question-standalone-label"]],template:function(B,W){1&B&&(u.TgZ(0,"div",0),u._uU(1),u.ALo(2,"isOfflineExam"),u.ALo(3,"mytranslate"),u.qZA()),2&B&&(u.xp6(1),u.AsE(" ",W.customQuestionLabel+" "+(W.curQuestionIndex+W.startQuestionIndex)," ",u.lcZ(2,2,W.examObj)?" ("+u.lcZ(3,4,"lang_auto_hoi_de_thi_offline")+") ":null,"\n"))},dependencies:[g.JV,g.OJ],styles:['.pr-7[_ngcontent-%COMP%]{padding-right:28px}.w-38px[_ngcontent-%COMP%]{width:38px}.remove-grid[_ngcontent-%COMP%]{display:block!important}.question-standalone-loader-box[_ngcontent-%COMP%]{min-height:50px}  .skeleton-box-loading{width:100%;height:30px;max-width:100%;margin-bottom:5px;display:inline-block}  .skeleton-box-loading:after{position:absolute;inset:0;transform:translate(-100%);animation:_ngcontent-%COMP%_shimmer 2s infinite;content:""}.question-standalone-box[_ngcontent-%COMP%]{margin-bottom:30px;display:block;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-ring-shadow, 0 0 rgba(0, 0, 0, 0)),var(--tw-shadow);border-radius:.375rem}.question-standalone-container[_ngcontent-%COMP%]{padding:15px}.question-standalone-for-test-finder[_ngcontent-%COMP%]{border:none;margin-bottom:0;padding:0}.question-standalone-for-test-finder[_ngcontent-%COMP%]   .question-standalone-main-content[_ngcontent-%COMP%]{padding:15px;border:1px solid rgb(228,228,228)}.group-of-question-standalone-for-test-finder[_ngcontent-%COMP%]{padding:15px!important;border:1px solid rgb(228,228,228)!important}.question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid #2262AE!important;outline:3px solid rgba(125,160,201,.65)!important}.group-of-question-standalone-has-selected[_ngcontent-%COMP%]{border:1px solid green!important;outline:3px solid rgba(0,193,0,.321)!important}.question-standalone-container[_ngcontent-%COMP%]:hover   .prev_question_btn[_ngcontent-%COMP%], .question-standalone-container[_ngcontent-%COMP%]:hover   .next_question_btn[_ngcontent-%COMP%]{visibility:visible}.question-standalone-label[_ngcontent-%COMP%]{font-weight:700}.question-standalone-content-box[_ngcontent-%COMP%]{position:relative}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]{color:#f44336;position:relative;padding-left:20px;display:flex;align-items:center}.question-standalone-is-invalid-validation[_ngcontent-%COMP%]:before{content:"!";position:absolute;left:0;color:#fff;background:#f44336;width:15px;height:15px;text-align:center;border-radius:50%;font-size:smaller;display:flex;justify-content:center;align-items:center}.question-standalone-step-container-box[_ngcontent-%COMP%]{margin-bottom:50px}.group-content-of-question-standalone[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.answer[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-label[_ngcontent-%COMP%]{width:20px;height:30px;min-width:20px;min-height:30px;display:flex;align-items:center;justify-content:flex-start;border-radius:50%;border-width:2px;border-style:solid;border-color:transparent}.answer-box[_ngcontent-%COMP%]{border-radius:0 0 3px 3px;padding:8px 20px;justify-content:space-between;align-items:center}.selected-answer[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff}.answer-content-front[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap;width:calc(100% - 30px)}.explainTxt[_ngcontent-%COMP%]{width:125px;font-weight:500;display:flex;align-items:center}#examHeader[_ngcontent-%COMP%]{display:block;border:1px solid #e7e7e7;border-radius:3px;overflow:hidden}.next_question_btn[_ngcontent-%COMP%]{position:absolute;right:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]{position:absolute;left:10px;top:35%;padding:.35rem .45rem;background-color:#a3a5a670;border-radius:50%;visibility:hidden}.prev_question_btn[_ngcontent-%COMP%]:hover, .next_question_btn[_ngcontent-%COMP%]:hover{visibility:visible}.arrow_btn[_ngcontent-%COMP%]{font-size:20px;vertical-align:middle;width:20px;height:20px;color:#fff;margin-left:auto!important;margin-right:auto!important;-webkit-user-select:none;user-select:none}.bottom_action[_ngcontent-%COMP%]{position:fixed;padding:15px;bottom:0;left:0;background:#312e2e;color:#fff;width:100%}.bottom_action[_ngcontent-%COMP%]   .collapse[_ngcontent-%COMP%]{display:block}.btn-ans-result[_ngcontent-%COMP%]{color:#fff;background-color:#f39c12}.show-list[_ngcontent-%COMP%]{max-width:200px}.show-list[_ngcontent-%COMP%]   .show-sheet[_ngcontent-%COMP%]   .listli[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:27px;height:27px;border-radius:50%;border:1px solid #347da5;display:flex;align-items:center;color:#fff;justify-content:center;font-size:12px;cursor:pointer;-webkit-user-select:none;user-select:none}.top_action[_ngcontent-%COMP%]{position:fixed;padding:10px;top:0;left:0;background:#312e2e;color:#fff;width:100%}.scrollSheetMobile[_ngcontent-%COMP%]{max-height:200px;overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.scrollSheetMobile[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}.notify-badge[_ngcontent-%COMP%]{position:absolute;right:3px;top:3px;text-align:center;color:#afafaf;padding:0;font-size:20px;cursor:pointer}.attach-container[_ngcontent-%COMP%]{background:#fff;padding:10px 0 0;border-radius:5px;width:83.33%;border:1px solid #e8e8e8}.answer-review[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid rgb(52,125,165);display:flex;align-items:center;color:#fff;justify-content:center;font-size:15px;-webkit-user-select:none;user-select:none}.border-none[_ngcontent-%COMP%]{border:none!important}.bg-question[_ngcontent-%COMP%]{margin-top:15px;padding:15px 10px;background:#fff}.question-pending-part[_ngcontent-%COMP%]{width:100%;height:50px}.pencil-edit[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:30px;height:30px;border-radius:50%;text-align:center;background:darkgrey;z-index:9999}.pencil-edit[_ngcontent-%COMP%]   .lucide[_ngcontent-%COMP%]{color:#fff;stroke-width:2.5px;height:29px}.margin-question-bar[_ngcontent-%COMP%]{margin-top:calc(3rem + 40px)!important}.sheet-screen[_ngcontent-%COMP%]{max-height:calc(100vh - 140px);overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.sheet-screen[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}  .layout{display:grid;margin:20px 0;grid-row-gap:20px}  .layout-4{grid-template-columns:1fr 1fr 1fr 1fr}  .layout-2{grid-template-columns:1fr 1fr}  .layout-1{grid-template-columns:1fr}  .question-standalone-content-box{max-width:100%;overflow-x:auto;overflow-y:hidden}  #boxContentQuestion .question-standalone-container{max-width:800px}@keyframes _ngcontent-%COMP%_shimmer{to{transform:translate(100%)}}@media (max-width: 768px){.answer-content-front[_ngcontent-%COMP%]{justify-content:center}.btn-ans-result[_ngcontent-%COMP%]{margin-right:auto!important}}@media (max-width: 800px){  #boxContentQuestion .question-standalone-container{max-width:calc(90vw - 16px)!important}}']}),_})()},96207:(at,ue,w)=>{"use strict";w.d(ue,{z:()=>g});var O=w(65619),u=w(65879);let g=(()=>{class h{constructor(){this.switchEssayTabSource=new O.X(!1),this.switchEssayTabMessage=this.switchEssayTabSource.asObservable()}changeSwitchEssayTabMessage(m){this.switchEssayTabSource.next(m)}}return h.\u0275fac=function(m){return new(m||h)},h.\u0275prov=u.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},56443:(at,ue,w)=>{"use strict";w.d(ue,{p:()=>O});class O{constructor(){this.totalQuestionRender=0,this.numFollow={renderDone:{num:0,isRun:!1},firstDone:{num:0,isRun:!1},startDone:{num:0,isRun:!1}}}checker(){this.totalQuestionRender===this.numFollow.renderDone.num&&!this.numFollow.renderDone.isRun&&(this.numFollow.renderDone.isRun=!0),this.totalQuestionRender===this.numFollow.firstDone.num&&!this.numFollow.firstDone.isRun&&(this.numFollow.firstDone.isRun=!0)}setNumQuest(g){this.totalQuestionRender=g}doneItemPartQuest(){this.numFollow.firstDone.num++,this.checker()}}},2376:(at,ue,w)=>{"use strict";w.d(ue,{c:()=>h});var O=w(65619),u=w(65592),g=w(65879);let h=(()=>{class _{constructor(){this.questionSelectedEvent=new O.X(-1),this.questionGroupSelectedEvent=new O.X(-1)}listenQuestionSelectedEvent(){return new u.y(B=>{this.questionSelectedEvent.subscribe(W=>{-1!=W&&B.next(W)})})}listenQuestionGroupSelectedEvent(){return new u.y(B=>{this.questionGroupSelectedEvent.subscribe(W=>{-1!=W&&B.next(W)})})}sendQuestionSelectedEvent(B){this.questionSelectedEvent.next(B)}sendQuestionGroupSelectedEvent(B){this.questionGroupSelectedEvent.next(B)}}return _.\u0275fac=function(B){return new(B||_)},_.\u0275prov=g.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},77127:(at,ue,w)=>{"use strict";w.d(ue,{V:()=>ht});var O=w(56223),u=w(19347),g=w(90241),h=w(5961),_=w(65879),m=w(74736),B=w(96814),W=w(87466),F=w(775),E=w(10134),R=w(11964);function A(we,Ne){if(1&we&&(_.TgZ(0,"div",20)(1,"b",21),_._uU(2),_.qZA(),_._UZ(3,"div",22),_.ALo(4,"safeContentQuestion"),_.ALo(5,"async"),_.ALo(6,"mathJaxContent"),_.qZA()),2&we){const X=Ne.$implicit;let Be;_.xp6(2),_.hij("",null!==(Be=X.alpha)&&void 0!==Be?Be:X.key,"."),_.xp6(1),_.Q6J("innerHtml",_.lcZ(4,2,_.lcZ(5,4,_.lcZ(6,6,X.content))),_.oJD)}}function fe(we,Ne){if(1&we&&(_.TgZ(0,"div",18),_.YNc(1,A,7,8,"div",19),_.qZA()),2&we){const X=_.oxw(2);_.xp6(1),_.Q6J("ngForOf",X.data.questionObj.answers)}}function L(we,Ne){if(1&we&&(_.TgZ(0,"h2",23),_._uU(1),_.ALo(2,"mytranslate"),_.qZA()),2&we){const X=_.oxw(2);_.xp6(1),_.AsE(" ",_.lcZ(2,2,"lang_auto_dap_an"),": ",X.data.questionObj.answerResult.join(", ")," ")}}function U(we,Ne){if(1&we&&(_.TgZ(0,"div",6)(1,"h2",8),_._uU(2),_.ALo(3,"mytranslate"),_.qZA(),_._UZ(4,"div",15),_.ALo(5,"safeContentQuestion"),_.ALo(6,"async"),_.ALo(7,"mathJaxContent"),_.YNc(8,fe,2,1,"div",16),_.YNc(9,L,3,4,"h2",17),_.qZA()),2&we){const X=_.oxw();_.xp6(2),_.hij(" ",_.lcZ(3,4,"lang_auto_noi_dung_cau_hoi")," "),_.xp6(2),_.Q6J("innerHTML",_.lcZ(5,6,_.lcZ(6,8,_.lcZ(7,10,X.data.questionObj.content))),_.oJD),_.xp6(4),_.Q6J("ngIf",1==X.data.questionObj.answerType&&X.data.questionObj.answers&&X.data.questionObj.answers.length>0),_.xp6(1),_.Q6J("ngIf",X.data.questionObj.answerResult&&X.data.questionObj.isRoleTeacher)}}function Z(we,Ne){if(1&we&&(_.TgZ(0,"div",6)(1,"h2",24),_._uU(2),_.ALo(3,"mytranslate"),_.qZA(),_._UZ(4,"div",25),_.ALo(5,"safeContentQuestion"),_.ALo(6,"async"),_.ALo(7,"mathJaxContent"),_.qZA()),2&we){const X=_.oxw();_.xp6(2),_.hij(" ",_.lcZ(3,2,"lang_auto_loi_giai")," "),_.xp6(2),_.Q6J("innerHtml",_.lcZ(5,4,_.lcZ(6,6,_.lcZ(7,8,X.data.questionObj.help))),_.oJD)}}function le(we,Ne){1&we&&(_.ynx(0),_.TgZ(1,"div",26)(2,"span",27),_._UZ(3,"azt-loading-ui",28),_.qZA()(),_.BQk()),2&we&&(_.xp6(3),_.Q6J("type","oval"))}function P(we,Ne){if(1&we&&(_.TgZ(0,"div",48),_._UZ(1,"input",49),_.TgZ(2,"label",50),_._uU(3),_.ALo(4,"mytranslate"),_.qZA()()),2&we){const X=Ne.$implicit,Be=Ne.index;_.xp6(1),_.s9C("id","choice_"+Be),_.s9C("formControlName","choice_"+Be),_.xp6(1),_.s9C("for","choice_"+Be),_.xp6(1),_.hij(" ",_.lcZ(4,4,X)," ")}}function H(we,Ne){if(1&we&&(_.ynx(0),_.TgZ(1,"div",46),_.YNc(2,P,5,6,"div",47),_.qZA(),_.BQk()),2&we){const X=_.oxw().$implicit;_.xp6(1),_.s9C("formGroupName","survey_"+X.id),_.xp6(1),_.Q6J("ngForOf",X.choices)}}function ce(we,Ne){if(1&we&&(_.ynx(0),_.TgZ(1,"mat-radio-button",53),_._uU(2),_.ALo(3,"mytranslate"),_.qZA(),_.BQk()),2&we){const X=Ne.$implicit,Be=_.oxw(2).$implicit,V=_.oxw(3);_.xp6(1),_.s9C("value",X),_.Q6J("checked",V.form.controls["survey_"+Be.id].value==X),_.xp6(1),_.Oqu(_.lcZ(3,3,X))}}function ge(we,Ne){if(1&we&&(_.TgZ(0,"mat-radio-group",51),_.YNc(1,ce,4,5,"ng-container",52),_.qZA()),2&we){const X=_.oxw().$implicit;_.s9C("formControlName","survey_"+X.id),_.xp6(1),_.Q6J("ngForOf",X.choices)}}function Oe(we,Ne){if(1&we&&(_.TgZ(0,"div",42)(1,"div",43)(2,"h2",44),_._uU(3),_.ALo(4,"mytranslate"),_.qZA()(),_.TgZ(5,"div"),_.YNc(6,H,3,2,"ng-container",9),_.YNc(7,ge,2,2,"ng-template",null,45,_.W1O),_.qZA()()),2&we){const X=Ne.$implicit,Be=Ne.index,V=_.MAs(8);_.xp6(3),_.AsE(" ",Be+1+". ","",_.lcZ(4,4,X.content)," "),_.xp6(3),_.Q6J("ngIf",X.multiChoice&&X.choices&&X.choices.length>1)("ngIfElse",V)}}function qe(we,Ne){if(1&we&&(_.TgZ(0,"div"),_.YNc(1,Oe,9,6,"div",41),_.qZA()),2&we){const X=_.oxw(2);_.xp6(1),_.Q6J("ngForOf",X.surveyObjs)}}const Me=function(we,Ne){return{"btn-primary":we,"btn-secondary":Ne}};function pt(we,Ne){if(1&we){const X=_.EpF();_.YNc(0,qe,2,1,"div",29),_.TgZ(1,"div",30)(2,"button",31),_.NdJ("click",function(){_.CHM(X);const V=_.oxw();return _.KtG(V.changeFeedBackEmotion(2))}),_.O4$(),_.TgZ(3,"svg",32),_._UZ(4,"path",33)(5,"path",34),_.qZA(),_.kcU(),_.TgZ(6,"span",35),_._uU(7),_.ALo(8,"mytranslate"),_.qZA()(),_.TgZ(9,"button",36),_.NdJ("click",function(){_.CHM(X);const V=_.oxw();return _.KtG(V.changeFeedBackEmotion(1))}),_.O4$(),_.TgZ(10,"svg",32),_._UZ(11,"path",37)(12,"path",38),_.qZA(),_.kcU(),_.TgZ(13,"span",35),_._uU(14),_.ALo(15,"mytranslate"),_.qZA()()(),_.TgZ(16,"div",39)(17,"textarea",40),_.NdJ("keyup",function(){_.CHM(X);const V=_.oxw();return _.KtG(V.autoResizeFeedBackArea())}),_.ALo(18,"mytranslate"),_.qZA()()}if(2&we){const X=_.oxw();_.Q6J("ngIf",X.surveyObjs.length),_.xp6(2),_.Q6J("disabled",X.disableLike)("ngClass",_.WLB(14,Me,2==X.feedBackEmotion,2!=X.feedBackEmotion)),_.xp6(5),_.Oqu(_.lcZ(8,8,"lang_test_market_introduce_rating_like")),_.xp6(2),_.Q6J("disabled",X.disableLike)("ngClass",_.WLB(17,Me,1==X.feedBackEmotion,1!=X.feedBackEmotion)),_.xp6(5),_.Oqu(_.lcZ(15,10,"lang_test_market_introduce_rating_dislike")),_.xp6(3),_.s9C("placeholder",_.lcZ(18,12,"lang_global_question_ask_to_feedback_placeholder"))}}function Fe(we,Ne){1&we&&(_.TgZ(0,"span",54),_._UZ(1,"azt-loading-ui",28),_.qZA()),2&we&&(_.xp6(1),_.Q6J("type","oval"))}let ht=(()=>{class we extends g.e{changeFeedBackEmotion(X){this.disableLike||(this.feedBackEmotion=X,this.subscriptions.add(this.testMarketFeedbackService.apiTestMarketFeedbacksPost({objectId:this.questionId??void 0,userType:this.role??void 0,applyType:this.applyType??void 0,status:this.feedBackEmotion??void 0,content:"",surveyAnswers:[]}).subscribe(V=>{1==V.success?this.getInfoFeedback():this.errorStatusObj(V.message??"",!0)})))}autoResizeFeedBackArea(){const X=document.getElementById("text-area-feedback");X&&setTimeout(()=>{X.style.cssText="height:auto;",X.style.cssText="height:"+(X.scrollHeight+30)+"px"},0)}getAnswerSurvey(){let X=[],Be=this.commonService.getFormObj(this.form);for(let V in Be)if(V.includes("survey_")){let oe={surveyId:Number(V.substring(V.indexOf("_")+1)),answers:[]};if(Be[V]instanceof Object){let pe=this.surveyObjs.find(Ue=>Ue.id==oe.surveyId);if(pe)for(let Ue in Be[V])if(Be[V][Ue]){let rt=Number(Ue.substring(Ue.indexOf("_")+1));if(Array.isArray(pe.choices)&&pe.choices[rt]){let Je=pe.choices[rt];oe.answers?.push(Je)}}}else oe.answers=[Be[V]];X.push(oe)}return X}getFeedbackSurveys(){this.loadingFeedBackSurvey=!0,this.subscriptions.add(this.testMarketFeedbackService.apiTestMarketFeedbacksSurveysGet(this.applyType,this.role).subscribe(X=>{if(1==X.success){this.surveyObjs=X.data?.objs??[];let Be={feedBackContent:new O.NI("",[O.kI.required,h._.noWhiteSpace])};this.surveyObjs.length>0&&this.surveyObjs.forEach(V=>{if(V.multiChoice&&V.choices&&V.choices.length>1){let oe={};Be[`survey_${V.id}`]=new O.cw({}),V.choices.forEach((pe,Ue)=>{oe[`choice_${Ue}`]=new O.NI(!1)}),Be[`survey_${V.id}`]=this.fb.group(oe)}else Be[`survey_${V.id}`]=new O.NI("",[O.kI.required])}),this.form=this.fb.group(Be),this.loadingFeedBackSurvey=!1}else this.errorStatusObj(X.message??"",!0),this.loadingFeedBackSurvey=!1}))}getInfoFeedback(){this.subscriptions.add(this.testMarketFeedbackService.apiTestMarketFeedbacksGet(this.questionId,this.applyType,this.role).subscribe(X=>{if(1==X.success){let Be=X.data?.objs??[];Be.length&&Be[0].status&&(this.feedBackEmotion=Be[0].status,this.disableLike=!0)}else this.errorStatusObj(X.message??"",!0),this.disableLike=!1}))}sendFeedBack(){if(this.form.invalid)this.showErrorSnack("lang_auto_vui_long_dien_day_du_thong_tin");else{this.initStatusObj(),this.sendingFeedBack=!0;let X=this.commonService.getFormObj(this.form),Be={objectId:this.questionId??void 0,userType:this.role??void 0,applyType:this.applyType??void 0,status:this.feedBackEmotion??0,content:X.feedBackContent??void 0,surveyAnswers:this.getAnswerSurvey()};this.subscriptions.add(this.testMarketFeedbackService.apiTestMarketFeedbacksPost(Be).subscribe(V=>{1==V.success?(this.sendingFeedBack=!1,this.dialogRef.close(!0),this.successStatusObj("TEACHER"==this.role?"lang_test_market_success_feedback":"lang_test_market_success_feedback_student",!0)):(this.errorStatusObj(V.message??"",!0),this.sendingFeedBack=!1)}))}}btnCloseDialog(){this.dialogRef.close(!1)}ngOnInit(){this.form=this.fb.group({feedBackContent:new O.NI("",[O.kI.required,h._.noWhiteSpace])}),this.getInfoFeedback(),this.getFeedbackSurveys(),super.ngOnInit()}constructor(X,Be,V,oe){super(oe,V),this.fb=X,this.testMarketFeedbackService=Be,this.dialogRef=V,this.data=oe,this.role="",this.applyType="",this.form=new O.cw({}),this.feedBackEmotion=void 0,this.totalLike=0,this.totalDislike=0,this.sendingFeedBack=!1,this.loadingFeedBackSurvey=!1,this.disableLike=!1,this.surveyObjs=[],this.questionId=this.data.questionObj.id,this.role=this.data.role,this.applyType=this.data.applyType}}return we.\u0275fac=function(X){return new(X||we)(_.Y36(O.qu),_.Y36(m.nC),_.Y36(u.so,8),_.Y36(u.WI,8))},we.\u0275cmp=_.Xpm({type:we,selectors:[["exam-matrix-feedback-dialog"]],features:[_.qOj],decls:25,vars:19,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-3","border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"intro-y","overflow-auto",2,"max-height","calc(100vh - 150px)"],[1,"text-md","mr-auto","font-bold"],["class","border-t border-slate-200/60 dark:border-darkmode-400 py-2 mt-2",4,"ngIf"],[1,"border-t","border-slate-200/60","dark:border-darkmode-400","py-2","mt-2"],[3,"formGroup"],[1,"font-medium","text-md","text-center","mb-2"],[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"p-3","text-right"],["azt-track-service","exam-matrix-feedback-dialog-qXEblgFcT",1,"btn","w-24","btn-secondary","mr-3",3,"click"],["azt-track-service","exam-matrix-feedback-dialog-NGlD5D-IvA",1,"btn","btn-primary","mw-24",3,"disabled","click"],["class","w-4 h-4 mr-2",4,"ngIf"],[1,"tex2jax_process","box-content",2,"width","auto",3,"innerHTML"],["class","grid grid-cols-12 gap-2 answers",4,"ngIf"],["class","font-medium text-md text-left text-success my-2",4,"ngIf"],[1,"grid","grid-cols-12","gap-2","answers"],["class","answer col-span-12 md:col-span-6",4,"ngFor","ngForOf"],[1,"answer","col-span-12","md:col-span-6"],[1,"answer-label"],[1,"answer-content",3,"innerHtml"],[1,"font-medium","text-md","text-left","text-success","my-2"],[1,"font-medium","text-md","text-center"],[1,"help-content","box","px-3","mt-1",2,"display","inherit","border-top-right-radius","0","border-top-left-radius","0","box-shadow","none","overflow","auto","padding-bottom","20px",3,"innerHtml"],[1,"flex","items-center","h-full","w-full"],[1,"w-8","h-8","mx-auto"],[3,"type"],[4,"ngIf"],[1,"flex","items-center",2,"flex-wrap","wrap"],["azt-track-service","exam-matrix-feedback-dialog-PoMeFnagK",1,"btn","btn-sm","shadow-md","mt-2","mr-2",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"mr-2"],["d","M7 10v12"],["d","M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z"],[2,"vertical-align","middle"],["azt-track-service","exam-matrix-feedback-dialog-iJokCn34oQ",1,"btn","btn-sm","shadow-md","mt-2","mr-2",3,"disabled","ngClass","click"],["d","M17 14V2"],["d","M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z"],[1,"items-center","mt-1"],["id","text-area-feedback","type","text","cols","10","rows","3","formControlName","feedBackContent",1,"form-control","mt-1",3,"placeholder","keyup"],["class","flex flex-wrap mb-2",4,"ngFor","ngForOf"],[1,"flex","flex-wrap","mb-2"],[2,"min-width","300px"],[1,"text-md","mb-2"],["SingleChoice",""],[1,"block","px-2","ml-2","sm:flex",3,"formGroupName"],["class","mr-5",4,"ngFor","ngForOf"],[1,"mr-5"],["type","checkbox",1,"form-check-input",3,"id","formControlName"],[2,"vertical-align","middle","cursor","pointer","margin-left","3px",3,"for"],["color","primary",1,"px-2",2,"flex-direction","column",3,"formControlName"],[4,"ngFor","ngForOf"],[1,"mr-5",3,"checked","value"],[1,"w-4","h-4","mr-2"]],template:function(X,Be){if(1&X&&(_.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),_._uU(5),_.ALo(6,"mytranslate"),_.qZA(),_.YNc(7,U,10,12,"div",5),_.YNc(8,Z,8,10,"div",5),_.TgZ(9,"div",6)(10,"form",7)(11,"h2",8),_._uU(12),_.ALo(13,"mytranslate"),_.qZA(),_.YNc(14,le,4,1,"ng-container",9),_.YNc(15,pt,19,20,"ng-template",null,10,_.W1O),_.qZA()()()()(),_.TgZ(17,"div",11)(18,"button",12),_.NdJ("click",function(){return Be.btnCloseDialog()}),_._uU(19),_.ALo(20,"mytranslate"),_.qZA(),_.TgZ(21,"button",13),_.NdJ("click",function(){return Be.sendFeedBack()}),_.YNc(22,Fe,2,1,"span",14),_._uU(23),_.ALo(24,"mytranslate"),_.qZA()()()),2&X){const V=_.MAs(16);_.xp6(5),_.hij(" ",_.lcZ(6,11,Be.data.questionObj.isRoleTeacher?"lang_global_question_ask_to_feedback":"lang_global_question_ask_to_report")," "),_.xp6(2),_.Q6J("ngIf",Be.data.questionObj.content),_.xp6(1),_.Q6J("ngIf",Be.data.questionObj.help&&Be.data.questionObj.isRoleTeacher),_.xp6(2),_.Q6J("formGroup",Be.form),_.xp6(2),_.hij(" ",_.lcZ(13,13,"lang_auto_nhan_xet")," "),_.xp6(2),_.Q6J("ngIf",Be.loadingFeedBackSurvey)("ngIfElse",V),_.xp6(5),_.hij(" ",_.lcZ(20,15,"lang_auto_dong")," "),_.xp6(2),_.Q6J("disabled",Be.sendingFeedBack||Be.form.invalid),_.xp6(1),_.Q6J("ngIf",Be.sendingFeedBack),_.xp6(1),_.hij(" ",_.lcZ(24,17,"lang_buttom_send")," ")}},dependencies:[B.mk,B.sg,B.O5,W.VQ,W.U0,O._Y,O.Fj,O.Wl,O.JJ,O.JL,O.sg,O.u,O.x0,F.M,E.n,B.Ov,R.JV,R.Pc,R.ES],styles:[".answer-content[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap}.answer-box[_ngcontent-%COMP%]{border-radius:0 0 3px 3px;padding:8px 20px;justify-content:space-between;align-items:center}.answer[_ngcontent-%COMP%]{display:flex;align-items:center}.group-content-of-question-standalone[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.question-standalone-label[_ngcontent-%COMP%]{font-weight:700}.answer-label[_ngcontent-%COMP%]{min-width:20px;min-height:30px;display:flex;align-items:center;justify-content:flex-start;border-radius:50%;border-width:2px;border-style:solid;border-color:transparent}"]}),we})()},68234:(at,ue,w)=>{"use strict";w.d(ue,{z:()=>W});var O=w(39621),u=w(65879),g=w(96814),h=w(56223),_=w(775),m=w(11964);function B(F,E){if(1&F&&(u.TgZ(0,"div",1)(1,"form",2),u._UZ(2,"input",3),u.ALo(3,"mytranslate"),u._UZ(4,"input",4),u.ALo(5,"mytranslate"),u.qZA()()),2&F){const R=u.oxw();u.xp6(1),u.Q6J("formGroup",R.form),u.xp6(1),u.s9C("placeholder",u.lcZ(3,3,"lang_auto_ten_truong")),u.xp6(2),u.s9C("placeholder",u.lcZ(5,5,"lang_auto_mon_hoc_form"))}}let W=(()=>{class F extends O.Q{constructor(){super(),this.type=""}initData(){this.form?.patchValue({schoolName:this.examPrintInfoObj.schoolName,subjectName:this.examPrintInfoObj.subject})}ngOnInit(){this.initData()}}return F.\u0275fac=function(R){return new(R||F)},F.\u0275cmp=u.Xpm({type:F,selectors:[["add-info-print"]],inputs:{form:"form",examPrintInfoObj:"examPrintInfoObj",type:"type"},features:[u.qOj],decls:1,vars:1,consts:[["class","add-info-print",4,"ngIf"],[1,"add-info-print"],[3,"formGroup"],["id","school-name","type","text","formControlName","schoolName",1,"form-control","mt-3",3,"placeholder"],["id","subject-name","type","text","formControlName","subjectName",1,"form-control","mt-3",3,"placeholder"]],template:function(R,A){1&R&&u.YNc(0,B,6,7,"div",0),2&R&&u.Q6J("ngIf",A.form)},dependencies:[g.O5,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,_.M,m.JV],encapsulation:2}),F})()},51969:(at,ue,w)=>{"use strict";w.d(ue,{y:()=>W});var O=w(39621),u=w(65879),g=w(8415),h=w(96814);let _=(()=>{class F{convertUrl(){this.src=this.cdnService.getRawCdnLink(this.src)}constructor(R){this.cdnService=R,this.src=""}}return F.\u0275fac=function(R){return new(R||F)(u.Y36(g.E))},F.\u0275dir=u.lG2({type:F,selectors:[["","appImageFallback",""]],hostVars:1,hostBindings:function(R,A){1&R&&u.NdJ("error",function(){return A.convertUrl()}),2&R&&u.Ikx("src",A.src,u.P3R)},inputs:{src:"src"}}),F})();var m=w(11964);function B(F,E){1&F&&(u.TgZ(0,"div",2),u._UZ(1,"img",3),u.ALo(2,"convertCdnLinkOfGitHub"),u.qZA()),2&F&&(u.xp6(1),u.Q6J("src",u.lcZ(2,1,"azota_assets/svgs/Img2_dat-01.svg"),u.LSH))}let W=(()=>{class F extends O.Q{onError(R){if(this.isRetry){const A=R.target;setTimeout(()=>{1==this.countRetry?(A.src=this.cdnService.getMyCdn(this.imgSrc??""),this.countRetry++):this.countRetry<5?(this.countRetry++,A.src=this.cdnService.getRawCdnLink(this.imgSrc??"")+"?t="+(new Date).getTime()):this.stopStatusObj()},500)}}onLoad(){this.stopStatusObj()}get isLazyLoad(){return void 0!==this.width&&void 0!==this.height}constructor(R,A){super(),this.cdnService=R,this.cd=A,this.noClass=!1,this.isRetry=!0,this.countRetry=1}ngOnInit(){this.initStatusObj(),super.ngOnInit()}}return F.\u0275fac=function(R){return new(R||F)(u.Y36(g.E),u.Y36(u.sBO))},F.\u0275cmp=u.Xpm({type:F,selectors:[["azt-loaded-img"]],inputs:{imgSrc:"imgSrc",id:"id",noClass:"noClass",width:"width",height:"height",isRetry:"isRetry"},features:[u.qOj],decls:3,vars:10,consts:[["class","px-4 py-3 text-center",4,"ngIf"],["appImageFallback","",2,"width","100%",3,"width","height","hidden","load","error"],[1,"px-4","py-3","text-center"],["alt","image_loading_placeholer",3,"src"]],template:function(R,A){1&R&&(u.YNc(0,B,3,3,"div",0),u.TgZ(1,"img",1),u.NdJ("load",function(){return A.onLoad()})("error",function(L){return A.onError(L)}),u.ALo(2,"mycdn"),u.qZA()),2&R&&(u.Q6J("ngIf",!A.isLazyLoad&&A.statusObj.loading),u.xp6(1),u.Tol(A.id?"img-fluid questionId_"+A.id:A.noClass?"w-auto":"img-fluid"),u.Q6J("width",void 0!==A.width?A.width:null)("height",void 0!==A.height?A.height:null)("hidden",!A.isLazyLoad&&A.statusObj.loading),u.uIk("loading",A.isLazyLoad?"lazy":"eager")("src",u.lcZ(2,8,A.imgSrc),u.LSH))},dependencies:[h.O5,_,m.QN,m.Bo],encapsulation:2}),F})()},63833:(at,ue,w)=>{"use strict";w.d(ue,{r:()=>fe});var O=w(39621),u=w(65879),g=w(36922),h=w(96814),_=w(74104),m=w(11964);function B(L,U){if(1&L&&(u.TgZ(0,"td",10),u._uU(1),u.qZA()),2&L){const Z=u.oxw().$implicit,le=u.oxw().$implicit,P=u.oxw(2);u.uIk("rowspan",le.length),u.xp6(1),u.Oqu(P.toNumber(Z.index)+1)}}const W=function(L){return{"font-bold":L}};function F(L,U){if(1&L&&(u.ynx(0),u.TgZ(1,"tr"),u.YNc(2,B,2,2,"td",9),u.TgZ(3,"td",10),u._uU(4),u.ALo(5,"formatFullDateTimeTimezoneByUserUnitPipe"),u.qZA(),u.TgZ(6,"td",11),u._uU(7),u.qZA()(),u.BQk()),2&L){const Z=U.$implicit,le=U.index,P=u.oxw().$implicit;u.xp6(2),u.Q6J("ngIf",0==le),u.xp6(2),u.Oqu(u.lcZ(5,4,1e3*Z.second)),u.xp6(2),u.Q6J("ngClass",u.VKq(6,W,le==P.length-1)),u.xp6(1),u.Oqu(Z.alpha?Z.alpha:Z.key)}}function E(L,U){if(1&L&&(u.ynx(0),u.YNc(1,F,8,8,"ng-container",8),u.BQk()),2&L){const Z=U.$implicit;u.xp6(1),u.Q6J("ngForOf",Z)}}function R(L,U){if(1&L&&(u.TgZ(0,"table",4)(1,"tr")(2,"th",5),u._uU(3),u.ALo(4,"mytranslate"),u.qZA(),u.TgZ(5,"th",6),u._uU(6),u.ALo(7,"mytranslate"),u.qZA(),u.TgZ(8,"th",7),u._uU(9),u.ALo(10,"mytranslate"),u.qZA()(),u.YNc(11,E,2,1,"ng-container",8),u.qZA()),2&L){const Z=u.oxw();u.xp6(3),u.Oqu(u.lcZ(4,4,"lang_auto_cau_hoi")),u.xp6(3),u.Oqu(u.lcZ(7,6,"lang_auto_thoi_gian")),u.xp6(3),u.Oqu(u.lcZ(10,8,"lang_auto_dap_an")),u.xp6(2),u.Q6J("ngForOf",Z.groupObjs)}}function A(L,U){1&L&&(u.TgZ(0,"div",12),u._uU(1),u.ALo(2,"mytranslate"),u.qZA()),2&L&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"lang_auto_khong_co_du_lieu_lam_bai_trac_nghiem_chon_dap_an_dung_cua_thi_sinh")))}let fe=(()=>{class L extends O.Q{findReTapQuesions(){var Z=this.dictionaryService.getDictionaryByGroupFieldTS(this.dataResultObjs??[],"index");for(var le in Z)Z.hasOwnProperty(le)&&this.groupObjs.push(Z[le])}toNumber(Z){return parseInt(Z,10)+this.startQuestionIndex-1}ngOnInit(){this.findReTapQuesions(),super.ngOnInit()}constructor(Z){super(),this.dictionaryService=Z,this.startQuestionIndex=1,this.groupObjs=[],this.timezoneOffset=(new Date).getTimezoneOffset()}}return L.\u0275fac=function(Z){return new(Z||L)(u.Y36(g.k))},L.\u0275cmp=u.Xpm({type:L,selectors:[["azt-test-result-tracking"]],inputs:{startQuestionIndex:"startQuestionIndex",dataResultObjs:"dataResultObjs",dataScrollObjs:"dataScrollObjs"},features:[u.qOj],decls:7,vars:5,consts:[[3,"label"],[1,"overflow-x-auto","mt-5"],["id","tracktable","class","table table-bordered",4,"ngIf","ngIfElse"],["noData",""],["id","tracktable",1,"table","table-bordered"],["id","questionNum",1,"w-24","text-center"],["id","timeStamp",1,"w-56","text-center"],["id","answerLabel",1,"w-24","text-center"],[4,"ngFor","ngForOf"],["class","text-center",4,"ngIf"],[1,"text-center"],[1,"text-center",3,"ngClass"],[1,"alert","alert-secondary","p-5"]],template:function(Z,le){if(1&Z&&(u.TgZ(0,"mat-tab-group")(1,"mat-tab",0),u.ALo(2,"mytranslate"),u.TgZ(3,"div",1),u.YNc(4,R,12,10,"table",2),u.YNc(5,A,3,3,"ng-template",null,3,u.W1O),u.qZA()()()),2&Z){const P=u.MAs(6);u.xp6(1),u.s9C("label",u.lcZ(2,3,"lang_auto_chi_tiet_chon_dap_an")),u.xp6(3),u.Q6J("ngIf",le.groupObjs.length>0)("ngIfElse",P)}},dependencies:[h.mk,h.sg,h.O5,_.uX,_.SP,m.JV,m.Um],encapsulation:2}),L})()},70723:(at,ue,w)=>{"use strict";w.d(ue,{W:()=>R});var O=w(39621),u=w(65879),g=w(96814),h=w(70342),_=w(77988),m=w(92596),B=w(44589),W=w(11964);function F(A,fe){if(1&A){const L=u.EpF();u.O4$(),u.kcU(),u.ynx(0),u.TgZ(1,"div",24)(2,"p",25),u._uU(3),u.ALo(4,"mytranslate"),u.qZA(),u.TgZ(5,"p",25),u._uU(6),u.ALo(7,"mytranslate"),u.qZA(),u.TgZ(8,"div",26),u._UZ(9,"input",27),u.TgZ(10,"button",28),u.NdJ("click",function(){u.CHM(L);const Z=u.oxw();return u.KtG(Z.showCopySuccess())}),u.O4$(),u.TgZ(11,"svg",29),u._UZ(12,"rect",30)(13,"path",31),u.qZA(),u._uU(14),u.ALo(15,"mytranslate"),u.qZA()()(),u.BQk()}if(2&A){const L=u.oxw();u.xp6(3),u.Oqu(u.lcZ(4,5,"lang_auto_hoac")),u.xp6(3),u.Oqu(u.lcZ(7,7,"lang_classroom_QR_join_link_copy")),u.xp6(3),u.Q6J("value",L.linkUrl),u.xp6(1),u.Q6J("cdkCopyToClipboard",L.copyLinkToClipboard(L.linkUrl)),u.xp6(4),u.hij(" ",u.lcZ(15,9,"lang_auto_sao_chep")," ")}}const E=function(A){return{"w-80":A}};let R=(()=>{class A extends O.Q{constructor(){super(...arguments),this.id="",this.linkUrl="",this.fileName="",this.showLink=!1,this.qrCodeDownloadLink=""}showCopySuccess(){this.showSuccessSnack("lang_auto_sao_chep_thanh_cong")}copyLinkToClipboard(L){return L}bindUrlToQrCode(){}onChangeURL(L){this.qrCodeDownloadLink=L}downloadQrCode(){try{var L=document.createElement("a");document.body.appendChild(L),L.setAttribute("href",this.qrCodeDownloadLink.changingThisBreaksApplicationSecurity),L.setAttribute("download",""!=this.fileName?this.commonService.createFileNameExportFile([this.fileName])+".jpg":this.commonService.createFileNameExportFile(["azota-qr-code-"])+".jpg"),L.click()}catch{console.log("Download qrcode error")}}}return A.\u0275fac=function(){let fe;return function(U){return(fe||(fe=u.n5z(A)))(U||A)}}(),A.\u0275cmp=u.Xpm({type:A,selectors:[["azt-download-qr-code"]],inputs:{id:"id",linkUrl:"linkUrl",fileName:"fileName",showLink:"showLink"},features:[u.qOj],decls:28,vars:16,consts:[["azt-track-service","download-qr-code-hiQXy_iTc",1,"btn","btn-outline-primary","btn-transparent","p-1",3,"matMenuTriggerFor","matTooltip","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-6","h-6"],["x","3","y","3","width","5","height","5","rx","1"],["x","16","y","3","width","5","height","5","rx","1"],["x","3","y","16","width","5","height","5","rx","1"],["d","M21 16h-3a2 2 0 0 0-2 2v3"],["d","M21 21v.01"],["d","M12 7v3a2 2 0 0 1-2 2H7"],["d","M3 12h.01"],["d","M12 3h.01"],["d","M12 16v.01"],["d","M16 12h1"],["d","M21 12v.01"],["d","M12 21v-1"],["showQrCode","matMenu"],["azt-track-service","download-qr-code-9t-9Wiu2xv",1,"box","p-3","text-center",3,"ngClass","click"],[2,"background","#fff","padding","5px"],["colorDark","#2361ad","imageSrc","https://cdn.jsdelivr.net/gh/azota889/storage_public/azota_assets/images/Azota-For-QrCode-01.png",3,"allowEmptyString","qrdata","elementType","width","errorCorrectionLevel","qrCodeURL"],["azt-track-service","download-qr-code-RqVBz6g1z7",1,"btn","btn-outline-primary","btn-transparent","btn-sm","mx-auto","mt-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","7 10 12 15 17 10"],["x1","12","y1","15","x2","12","y2","3"],[4,"ngIf"],[1,"text-center"],[1,"h5","mt-2","font-medium"],[1,"azt-copy","relative","mt-2","intro-x"],["type","text","readonly","",1,"form-control","py-3","px-4","border-transparent","bg-slate-100","pr-10",2,"padding-right","120px",3,"value"],["azt-track-service","download-qr-code-yW-aFu0tO",1,"btn","btn-outline-primary","absolute","my-auto","inset-y-0","right-0",2,"border-top-left-radius","0","border-bottom-left-radius","0",3,"cdkCopyToClipboard","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["x","9","y","9","width","13","height","13","rx","2","ry","2"],["d","M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"]],template:function(L,U){if(1&L&&(u.TgZ(0,"button",0),u.NdJ("click",function(){return U.bindUrlToQrCode()}),u.ALo(1,"mytranslate"),u.O4$(),u.TgZ(2,"svg",1),u._UZ(3,"rect",2)(4,"rect",3)(5,"rect",4)(6,"path",5)(7,"path",6)(8,"path",7)(9,"path",8)(10,"path",9)(11,"path",10)(12,"path",11)(13,"path",12)(14,"path",13),u.qZA()(),u.kcU(),u.TgZ(15,"mat-menu",null,14)(17,"div",15),u.NdJ("click",function(le){return le.stopPropagation()}),u.TgZ(18,"div",16)(19,"qrcode",17),u.NdJ("qrCodeURL",function(le){return U.onChangeURL(le)}),u.qZA()(),u.TgZ(20,"a",18),u.NdJ("click",function(){return U.downloadQrCode()}),u.O4$(),u.TgZ(21,"svg",19),u._UZ(22,"path",20)(23,"polyline",21)(24,"line",22),u.qZA(),u._uU(25),u.ALo(26,"mytranslate"),u.qZA(),u.YNc(27,F,16,11,"ng-container",23),u.qZA()()),2&L){const Z=u.MAs(16);u.s9C("matTooltip",u.lcZ(1,10,"lang_auto_quet_hoac_tai_ma_qr_code")),u.Q6J("matMenuTriggerFor",Z),u.xp6(17),u.Q6J("ngClass",u.VKq(14,E,U.showLink)),u.xp6(2),u.Q6J("allowEmptyString",!0)("qrdata",U.linkUrl)("elementType","url")("width",128)("errorCorrectionLevel","M"),u.xp6(6),u.hij(" ",u.lcZ(26,12,"lang_auto_tai_ve_may")," "),u.xp6(2),u.Q6J("ngIf",U.showLink)}},dependencies:[g.mk,g.O5,h.i3,_.VK,_.p6,m.gM,B.V,W.JV],encapsulation:2}),A})()},65076:(at,ue,w)=>{"use strict";w.d(ue,{S:()=>Se});var O=w(49671),u=w(69862),g=w(65879),h=w(56223),_=w(69384),m=w(56443),B=w(39621),W=w(14845),F=w(94281),E=w(8415),R=w(50952),A=w(50503),fe=w(58222),L=w(96814),U=w(30617),Z=w(92596),le=w(87303),P=w(81373),H=w(775),ce=w(70297),ge=w(87721),Oe=w(11964);const qe=["mnoteContainer"],Me=["aztMarkNote"];function pt(ee,Pe){1&ee&&(g.TgZ(0,"span"),g._uU(1),g.ALo(2,"mytranslate"),g.qZA()),2&ee&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"lang_mark_essay_please_enter_a_score_greater_than_or_equal_to_0")," "))}function Fe(ee,Pe){1&ee&&(g.TgZ(0,"span"),g._uU(1),g.ALo(2,"mytranslate"),g.qZA()),2&ee&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"lang_mark_essay_please_enter_a_score_less_than_or_equal_to_the_score_of_the_question")," "))}function ht(ee,Pe){1&ee&&(g.TgZ(0,"span"),g._uU(1),g.ALo(2,"mytranslate"),g.qZA()),2&ee&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"lang_mark_essay_please_do_not_enter_more_than_8_numbers_after_the_decimal_point")," "))}function we(ee,Pe){if(1&ee&&(g.TgZ(0,"div",18),g.YNc(1,pt,3,3,"span",9),g.YNc(2,Fe,3,3,"span",9),g.YNc(3,ht,3,3,"span",9),g.qZA()),2&ee){const K=g.oxw().index,q=g.oxw();g.xp6(1),g.Q6J("ngIf",null==q.form.controls["cau"+K].errors?null:q.form.controls["cau"+K].errors.min),g.xp6(1),g.Q6J("ngIf",null==q.form.controls["cau"+K].errors?null:q.form.controls["cau"+K].errors.max),g.xp6(1),g.Q6J("ngIf",null==q.form.controls["cau"+K].errors?null:q.form.controls["cau"+K].errors.pattern)}}const Ne=function(ee){return{border:ee}},X=function(ee){return{"is-invalid":ee}};function Be(ee,Pe){if(1&ee){const K=g.EpF();g.TgZ(0,"div",11)(1,"div",12)(2,"mat-icon",13),g.NdJ("click",function(ie){const ze=g.CHM(K).index,k=g.oxw();return g.KtG(k.toggleVisibility(ie,ze))}),g.ALo(3,"mytranslate"),g._uU(4,"visibility"),g.qZA(),g.TgZ(5,"span",14),g._uU(6),g.ALo(7,"mytranslate"),g.TgZ(8,"span",15),g.ALo(9,"mytranslate"),g._uU(10),g.ALo(11,"mytranslate"),g.qZA()(),g._UZ(12,"input",16),g.ALo(13,"mytranslate"),g.qZA(),g.YNc(14,we,4,3,"div",17),g.qZA()}if(2&ee){const K=Pe.$implicit,q=Pe.index,ie=g.oxw();let ye;g.Q6J("ngStyle",g.VKq(23,Ne,q==ie.questions.length-1?"none":"")),g.xp6(2),g.s9C("matTooltip",g.lcZ(3,13,"lang_auto_anhien_phan_bai_lam_cua_cau_hoi_nay")),g.xp6(4),g.AsE(" ",g.lcZ(7,15,"lang_auto_cau")," ",(null!==(ye=K.indexLabel)&&void 0!==ye?ye:0)+1," "),g.xp6(2),g.s9C("matTooltip",g.lcZ(9,17,"lang_auto_diem_toi_da_cho_cau_hoi_nay_theo_thang_diem_brackets")),g.xp6(2),g.AsE("(",K.essMaxPoint," ",g.lcZ(11,19,"lang_auto_diem_brackets"),""),g.xp6(2),g.s9C("placeholder",g.lcZ(13,21,"lang_auto_nhap_diem")),g.MGl("formControlName","cau",q,""),g.Q6J("readonly",!ie.showForTeacher)("decimal",!0)("ngClass",g.VKq(25,X,ie.form.controls["cau"+q]&&ie.form.controls["cau"+q].invalid)),g.xp6(2),g.Q6J("ngIf",ie.form.controls["cau"+q].errors)}}function V(ee,Pe){if(1&ee){const K=g.EpF();g.TgZ(0,"div",19)(1,"button",20),g.NdJ("click",function(){g.CHM(K);const ie=g.oxw();return g.KtG(ie.saveDataMarkExercise())}),g._uU(2),g.ALo(3,"mytranslate"),g.ALo(4,"mytranslate"),g.qZA()()}if(2&ee){const K=g.oxw();g.xp6(1),g.Q6J("disabled",K.isLoading||K.form.invalid||K.loadingDataCdn&&K.files.length>0),g.xp6(1),g.hij(" ",K.isLoading?g.lcZ(3,2,"lang_auto_dang_luu_doing"):g.lcZ(4,4,"lang_auto_luu_diem")," ")}}function oe(ee,Pe){if(1&ee&&g._UZ(0,"azt-question-standalone-for-student-at-review-page",26),2&ee){const K=g.oxw().$implicit,q=g.oxw();let ie;g.Q6J("follower",q.followerRenderQuest)("examObj",q.examObj)("questionObj",K)("curQuestionIndex",null!==(ie=K.indexLabel)&&void 0!==ie?ie:0)("userAnswersObj",q.userAnswersObj)("currentTab","essay_tab")}}function pe(ee,Pe){if(1&ee&&g._UZ(0,"azt-question-standalone-for-teacher-at-review-page",27),2&ee){const K=g.oxw().$implicit,q=g.oxw();let ie;g.Q6J("follower",q.followerRenderQuest)("examObj",q.examObj)("questionObj",K)("curQuestionIndex",null!==(ie=K.indexLabel)&&void 0!==ie?ie:0)("userAnswersObj",q.userAnswersObj)("orgExamObjs",q.orgExamObjs)("currentTab","essay_tab")}}function Ue(ee,Pe){1&ee&&(g.TgZ(0,"span"),g._uU(1),g.ALo(2,"mytranslate"),g.qZA()),2&ee&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"lang_mark_essay_please_enter_a_score_greater_than_or_equal_to_0")," "))}function rt(ee,Pe){1&ee&&(g.TgZ(0,"span"),g._uU(1),g.ALo(2,"mytranslate"),g.qZA()),2&ee&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"lang_mark_essay_please_enter_a_score_less_than_or_equal_to_the_score_of_the_question")," "))}function Je(ee,Pe){1&ee&&(g.TgZ(0,"span"),g._uU(1),g.ALo(2,"mytranslate"),g.qZA()),2&ee&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"lang_mark_essay_please_do_not_enter_more_than_8_numbers_after_the_decimal_point")," "))}function xt(ee,Pe){if(1&ee&&(g.TgZ(0,"div",18),g.YNc(1,Ue,3,3,"span",9),g.YNc(2,rt,3,3,"span",9),g.YNc(3,Je,3,3,"span",9),g.qZA()),2&ee){const K=g.oxw(2).index,q=g.oxw();g.xp6(1),g.Q6J("ngIf",null==q.form.controls["cau"+K].errors?null:q.form.controls["cau"+K].errors.min),g.xp6(1),g.Q6J("ngIf",null==q.form.controls["cau"+K].errors?null:q.form.controls["cau"+K].errors.max),g.xp6(1),g.Q6J("ngIf",null==q.form.controls["cau"+K].errors?null:q.form.controls["cau"+K].errors.pattern)}}function De(ee,Pe){if(1&ee&&(g.TgZ(0,"div",28)(1,"form",29)(2,"label",30),g._uU(3),g.ALo(4,"mytranslate"),g.TgZ(5,"span",15),g.ALo(6,"mytranslate"),g._uU(7),g.ALo(8,"mytranslate"),g.qZA(),g._uU(9,":"),g.qZA(),g._UZ(10,"input",31),g.ALo(11,"mytranslate"),g.YNc(12,xt,4,3,"div",17),g.qZA()()),2&ee){const K=g.oxw(),q=K.index,ie=K.$implicit,ye=g.oxw();let ze;g.xp6(1),g.Q6J("formGroup",ye.form),g.xp6(1),g.s9C("for","cau_"+q),g.xp6(1),g.AsE("",g.lcZ(4,14,"lang_auto_nhap_diem_cau")," ",(null!==(ze=ie.indexLabel)&&void 0!==ze?ze:0)+1," "),g.xp6(2),g.s9C("matTooltip",g.lcZ(6,16,"lang_auto_diem_toi_da_cho_cau_hoi_nay_theo_thang_diem_brackets")),g.xp6(2),g.AsE("(",ie.essMaxPoint," ",g.lcZ(8,18,"lang_auto_diem_brackets"),""),g.xp6(3),g.s9C("placeholder",g.lcZ(11,20,"lang_auto_nhap_diem")),g.MGl("formControlName","cau",q,""),g.Q6J("readonly",!ye.showForTeacher)("ngClass",g.VKq(22,X,ye.form.controls["cau"+q]&&ye.form.controls["cau"+q].invalid))("id","cau_"+q)("decimal",!0),g.xp6(2),g.Q6J("ngIf",ye.form.controls["cau"+q].errors)}}function wt(ee,Pe){if(1&ee&&(g.TgZ(0,"div",21)(1,"div",22),g.YNc(2,oe,1,6,"azt-question-standalone-for-student-at-review-page",23),g.YNc(3,pe,1,7,"azt-question-standalone-for-teacher-at-review-page",24),g.YNc(4,De,13,24,"div",25),g.qZA()()),2&ee){const K=Pe.index,q=g.oxw();g.xp6(1),g.MGl("id","q_",K,""),g.xp6(1),g.Q6J("ngIf",!q.showForTeacher),g.xp6(1),g.Q6J("ngIf",q.showForTeacher),g.xp6(1),g.Q6J("ngIf",q.showForTeacher)}}function Ae(ee,Pe){1&ee&&(g.TgZ(0,"div",32)(1,"b"),g._uU(2),g.ALo(3,"mytranslate"),g.qZA(),g._uU(4),g.ALo(5,"mytranslate"),g.qZA()),2&ee&&(g.xp6(2),g.hij("",g.lcZ(3,2,"lang_auto_anh_bai_lam_tu_luan"),": "),g.xp6(2),g.hij("",g.lcZ(5,4,"lang_auto_khong_co_du_lieu_anh_bai_lam_tu_luan_cua_thi_sinh"),"\n"))}function ne(ee,Pe){if(1&ee){const K=g.EpF();g.TgZ(0,"azt-mark-note",34,35),g.NdJ("doneLoadData",function(ie){g.CHM(K);const ye=g.oxw(2);return g.KtG(ye.doneLoadData(ie))}),g.qZA()}if(2&ee){const K=g.oxw(2);g.Q6J("dataMarkNote",K.dataMarkNote)("screenType","exam")("modeView",K.showForTeacher?"teacher":"student")}}function Y(ee,Pe){if(1&ee&&(g.ynx(0),g.YNc(1,ne,2,3,"azt-mark-note",33),g.BQk()),2&ee){const K=g.oxw();g.xp6(1),g.Q6J("ngIf",1===K.curSelectedTab||K.changeSelectedTab)}}function ae(ee,Pe){if(1&ee){const K=g.EpF();g.TgZ(0,"div",36)(1,"button",37),g.NdJ("click",function(){g.CHM(K);const ie=g.oxw();return g.KtG(ie.saveDataMarkExercise())}),g._uU(2),g.ALo(3,"mytranslate"),g.ALo(4,"mytranslate"),g.qZA()()}if(2&ee){const K=g.oxw();g.xp6(1),g.Q6J("disabled",K.isLoading||K.form.invalid||K.loadingDataCdn&&K.files.length>0),g.xp6(1),g.hij(" ",K.isLoading?g.lcZ(3,2,"lang_auto_dang_luu_doing"):g.lcZ(4,4,"lang_auto_luu_diem")," ")}}const $=function(ee){return{display:ee}};let Se=(()=>{class ee extends B.Q{parseValue(K){return this.commonService.willDeleteParseJson(this.examResultObj.essayResult??"{}")[K]}getMaxPoint(K){var q=0;for(let ie=0;ie<this.questions.length;ie++)if(this.questions[ie].id==K){q=this.questions[ie].scorePerQuestion??0;break}return q}toggleVisibility(K,q){var ie=K.target,ye=document.getElementById(`q_${q}`);ye&&("block"==ye?.style.display?(ye.style.display="none",ie&&(ie.textContent="visibility_off")):(ye.style.display="block",ie&&(ie.textContent="visibility")))}isValidPoint(){let K=0;var q=this.form.value;for(var ie in q){var ye=Number(ie.substring(3));q[ie]>this.maxPointPerQuestion[ye]&&K++}return!(K>0)}validateForm(K,q,ie,ye){let ze="";this.form.get("cau"+ye)?.valueChanges.pipe((0,_.G)()).subscribe(([k,Re])=>{if(ze="string"==typeof Re&&Re.includes(",")?Re.replace(",","."):Re,isNaN(+ze))this.showErrorSnack("lang_auto_yeu_cau_chi_nhap_so"),this.form.controls["cau"+ye].setValue(q);else{let y=parseFloat(ze);y>ie&&this.showErrorSnack("lang_auto_khong_nhap_qua_so_diem_toi_da_cua_cau_hoi"),y<0&&this.showErrorSnack("lang_auto_ban_dang_nhap_nho_hon_0")}})}uploadBase64ToCDN(K,q){var ie=this.baseApiService.dataURItoBlob(K);this.apiUploadService.commonUploadForMarkResult(ie,`essay_note_${q}_${this.resultID}.png`,"image/png",1e4).subscribe(ye=>{ye.type!=u.dt.UploadProgress&&(1==ye.success?(this.mnoteJsonData.pages[q].draw=ye.data?.url,this.pagesCount--,0==this.pagesCount&&this.remark(JSON.stringify(this.mnoteJsonData))):this.commonService.snackError("lang_auto_luu_du_lieu_cham_bai_khong_thanh_cong"))})}uploadAll(K){this.pagesCount=0;for(let q=0;q<K.length;q++)K[q].draw&&this.pagesCount++;if(0==this.pagesCount)this.remark(JSON.stringify(this.mnoteJsonData));else for(let q=0;q<K.length;q++)K[q].draw&&this.uploadBase64ToCDN(K[q].draw,q)}sendDataToIframe(){const K=document.getElementById("mNote"),q=K?K.contentWindow:null;if(null!==q)if(this.examResultObj.confirmedAt&&this.examResultObj.result){if(this.examResultObj.result){var ie=this.commonService.willDeleteParseJson(this.examResultObj.result);if(null!=ie){for(let ze=0;ze<ie.pages.length;ze++)ie.pages[ze].backgroundImage&&(ie.pages[ze].backgroundImage=this.cdnService.getMyCdn(ie.pages[ze].backgroundImage)),ie.pages[ze].draw&&(ie.pages[ze].draw=this.cdnService.getMyCdn(ie.pages[ze].draw));ie=JSON.stringify(ie),this.examResultObj.result=ie}}var ye=this.checkMapBGImageWithFileLength(this.examResultObj.result??"{}");if(this.jsonData=this.commonService.willDeleteParseJson(ye?this.examResultObj.result??"{}":this.addBGImageByFileUrl(this.examResultObj.result??"{}")),this.jsonData&&this.jsonData.hasOwnProperty("pages"))for(let ze=0;ze<this.jsonData.pages.length;ze++)this.jsonData.pages[ze].hasOwnProperty("backgroundImage")&&(this.jsonData.pages[ze].backgroundImage=this.cdnService.getMyCdn(this.jsonData.pages[ze].backgroundImage)),this.jsonData.pages[ze].hasOwnProperty("draw")&&(this.jsonData.pages[ze].draw=this.cdnService.getMyCdn(this.jsonData.pages[ze].draw));this.jsonData&&(this.jsonData.cmd="initMNote",this.jsonData.mode=this.iframeViewMode,this.jsonData.context="exam"),q.postMessage(this.jsonData,"*")}else{let ze=[];this.files.forEach(Re=>{var y=this.cdnService.getMyCdn(Re.url);y&&ze.push({backgroundImage:y})}),q.postMessage({cmd:"initMNote",pages:ze,mode:this.showForTeacher?"edit":"view",context:"exam"},"*"),this.dataMarkNote.answer_obj={id:0,homeworkId:0,studentId:0,point:0,files:ze},console.log("43",this.dataMarkNote.answer_obj)}}checkMapBGImageWithFileLength(K){var q=this.commonService.willDeleteParseJson(K);let ie=!1;if(0==this.files.length)ie=!0;else if(this.files.length>0&&q&&q.pages&&this.files.length==q.pages.length){let ye=0;this.files.forEach((ze,k)=>{q.pages[k]&&q.pages[k].backgroundImage&&q.pages[k].backgroundImage.indexOf(ze.path)>-1&&ye++}),ye==this.files.length&&(ie=!0)}return ie}addBGImageByFileUrl(K){var q=this.commonService.willDeleteParseJson(K);return this.files.forEach((ie,ye)=>{let ze=!1;if(q&&q.pages){for(var k=0;k<q.pages.length;k++)if(q.pages[k]&&q.pages[k].backgroundImage&&q.pages[k].backgroundImage.indexOf(ie.path)>-1){ze=!0;break}!1===ze&&(q.pages[ye]&&q.pages[ye].id==ye?q.pages[ye].backgroundImage=this.cdnService.getMyCdn(ie.url??""):q.pages.splice(ye,0,{backgroundImage:this.cdnService.getMyCdn(ie.url??"")}))}}),JSON.stringify(q)}getMnoteJsonData(){if(this.permissionService.hasMarkPointPermission("exam",this.examObj)||this.permissionService.hasConfigAndMarkClassroomPermission("exam",this.examObj)){if(!this.isValidPoint())return void this.showErrorSnack("lang_auto_cham_diem_vuot_qua_so_diem_toi_da_vui_long_kiem_tra_lai");if(this.files&&this.files.length>0){const K=document.getElementById("mNote"),q=K?K.contentWindow:null;null!==q&&q.postMessage({cmd:"getMNoteJson"},"*")}else this.isLoading=!0,this.remark("")}else this.showErrorSnack("lang_auto_ban_khong_co_quen_cham_de_thi_nay")}remark(K){for(const ye in this.form.value)"string"==typeof this.form.value[ye]&&this.form.value[ye].includes(",")&&(this.form.value[ye]=this.form.value[ye].replace(",","."));let q=JSON.stringify({type:"exam",id:this.examObj.id,user:this.examObj.tenantId});var ie={id:this.resultID,result:K,essayResult:JSON.stringify(this.form.value)};this.examResultService.apiExamResultSaveResultPost(ie,q).subscribe(ye=>{1==ye.success?(this.showSuccessSnack("lang_auto_cham_diem_tu_luan_thanh_cong"),this.saveResultEvent.emit(1),this.isLoading=!1):(this.commonService.snackError(ye.message??""),this.saveResultEvent.emit(0),this.isLoading=!1)})}initDataMarkNote(){if(this.examResultObj.result)this.dataMarkNote.answer_obj={id:this.examResultObj.id??0,homeworkId:0,studentId:this.examResultObj.studentId??0,point:0,result:this.examResultObj.result,files:this.examResultObj.files,markedByTeacherId:this.examResultObj.markedByTeacherId,confirmedAt:this.examResultObj.confirmedAt,createdAt:this.examResultObj.createdAt,updatedAt:this.examResultObj.updatedAt,tenantId:this.examResultObj.tenantId};else{for(let K=0;K<this.files.length;K++)this.files[K].url=this.cdnService.getMyCdn(this.files[K].url??"");this.dataMarkNote.answer_obj={id:0,homeworkId:0,studentId:0,point:0,files:this.serializeJson(this.files)}}}saveDataMarkExercise(){var K=this;return(0,O.Z)(function*(){let q=!1;for(const ie in K.form.value)""!==K.form.value[ie]&&(q=!0);if(q){for(const ie in K.form.value)""===K.form.value[ie]&&(K.form.value[ie]=0,K.form.controls[ie].setValue(0));if(K.isLoading=!0,K.files&&K.files.length>0){K.objectResult=K.MarkNote?.exportDataMarkNote();let ie=!1;if(K.objectResult.pages?.length===K.files.length){for(let y=0;y<K.objectResult.pages.length;y++)if(K.objectResult.pages[y]&&K.objectResult.pages[y].draws?.length)for(let S=0;S<(K.objectResult.pages[y].draws?.length??0);S++){let D=K.objectResult.pages[y].draws?.[S]??{};D.src&&D.src.includes("base64")&&(ie=!0)}ie&&(yield K.uploadDrawBase64ToCdn());const ye=K.serializeJson(K.objectResult),ze=K.zipDataService.convertContentGzip(ye),k=new Blob([ze],{type:"text/plain"}),Re=new File([k],"txt",{type:"text/plain"});K.apiUploadService.uploadToCdnForHomework(Re).subscribe(y=>{1==y.success?K.remark(K.serializeJson({urlDataMark:y.data?.url??"",version:"0.1"})):K.showErrorSnack("lang_auto_co_loi_trong_qua_trinh_luu_du_lieu_len_cdn_vui_long_thu_lai")})}}else K.remark("")}else K.showErrorSnack("lang_core_vui_long_nhap_diem_tu_luan")})()}uploadDrawBase64ToCdn(){return new Promise(K=>{let q=[];if(this.objectResult.pages){this.objectResult.pages.forEach(ie=>{q.push(!1)});for(let ie=0;ie<this.objectResult.pages.length;ie++)if(this.objectResult.pages[ie]&&this.objectResult.pages[ie].draws?.length)for(let ye=0;ye<(this.objectResult.pages[ie].draws?.length??0);ye++){let ze=this.objectResult.pages[ie].draws?.[ye]??{};if(ze.src&&ze.src.includes("base64")){q[ie]=!0;let k=this.baseApiService.dataURItoBlob(ze.src);this.apiUploadService.commonUploadForMarkResult(k,`essay_note_${ie}_${ye}_${this.resultID}.png`,"image/png",1e4).subscribe(Re=>{Re.type!=u.dt.UploadProgress&&(ze.src=Re.data?.url,q[ie]=!1),q.includes(!0)||K()})}}}})}doneLoadData(K){this.loadingDataCdn=!1}ngOnInit(){this.initDataMarkNote();var K={};let q;this.examResultObj.confirmedAt&&(q=this.commonService.willDeleteParseJson(this.examResultObj.essayResult??"{}")),this.followerRenderQuest.setNumQuest(this.questions.length),this.questions.forEach(ye=>{let ze=this.getMaxPoint(ye.id);this.totalMaxPoint+=ze,ye.essMaxPoint=ze,this.maxPointPerQuestion.push(ye.essMaxPoint)});for(let ye=0;ye<this.questions.length;ye++){var ie=`cau${ye}`;K[ie]=new h.p4(q?q[ie]:"",[h.kI.pattern("^[0-9]((.|,){0,1})[0-9]{0,8}"),h.kI.min(0),h.kI.max(this.questions[ye].essMaxPoint??0)])}this.form=this.fb.group(K),this.form.valueChanges.subscribe(ye=>{let ze=JSON.stringify(ye);ze!=this.prevData&&(this.prevData=ze,this.form.patchValue(ye))}),super.ngOnInit()}constructor(K,q,ie,ye,ze,k,Re){super(),this.baseApiService=K,this.fb=q,this.permissionService=ie,this.cdnService=ye,this.examResultService=ze,this.apiUploadService=k,this.zipDataService=Re,this.orgExamObjs=[],this.questions=[],this.files=[],this.resultID=0,this.userAnswersObj={},this.curSelectedTab=0,this.changeSelectedTab=!1,this.iframeSrc="",this.hasLoadedData=!1,this.iframeViewMode="view",this.saveResultEvent=new g.vpe,this.followerRenderQuest=new m.p,this.form=new h.nJ({}),this.formValue={},this.isLoading=!1,this.totalMaxPoint=0,this.maxPointPerQuestion=[],this.hasSendDataToIframe=!1,this.jsonData={},this.mnoteJsonData={},this.pagesCount=0,this.dataMarkNote={},this.objectResult={},this.loadingDataCdn=!0}}return ee.\u0275fac=function(K){return new(K||ee)(g.Y36(W.V),g.Y36(h.QS),g.Y36(F.j),g.Y36(E.E),g.Y36(R.k),g.Y36(A.W),g.Y36(fe.a))},ee.\u0275cmp=g.Xpm({type:ee,selectors:[["azt-mark-essay-new"]],viewQuery:function(K,q){if(1&K&&(g.Gf(qe,5),g.Gf(Me,5)),2&K){let ie;g.iGM(ie=g.CRH())&&(q.mnoteContainer=ie.first),g.iGM(ie=g.CRH())&&(q.MarkNote=ie.first)}},inputs:{showForTeacher:"showForTeacher",examObj:"examObj",orgExamObjs:"orgExamObjs",questions:"questions",files:"files",resultID:"resultID",userAnswersObj:"userAnswersObj",examResultObj:"examResultObj",curSelectedTab:"curSelectedTab",changeSelectedTab:"changeSelectedTab",iframeSrc:"iframeSrc",hasLoadedData:"hasLoadedData",iframeViewMode:"iframeViewMode"},outputs:{saveResultEvent:"saveResultEvent"},features:[g.qOj],decls:11,vars:10,consts:[["id","essayBoxButtons",1,"flex","items-center","jusitfy-center","flex-col","p-3","rounded-md","border","border-slate-200","dark:border-darkmode-400"],[1,"grid","grid-cols-12","gap-3","pb-3","w-full","border-b","border-slate-200","dark:border-darkmode-400",3,"formGroup"],["class","col-span-12 md:col-span-6 lg:col-span-4 pr-3 border-r border-slate-200 dark:border-darkmode-400",3,"ngStyle",4,"ngFor","ngForOf"],["class","BWrap-one",4,"ngIf"],["id","showQuestionEssay"],["class","essay_qItem",4,"ngFor","ngForOf"],["class","mb-2 mt-2",4,"ngIf"],[1,"card-box","listPhotos",3,"ngStyle"],["mnoteContainer",""],[4,"ngIf"],["class","BWrap",4,"ngIf"],[1,"col-span-12","md:col-span-6","lg:col-span-4","pr-3","border-r","border-slate-200","dark:border-darkmode-400",3,"ngStyle"],[1,"flex","items-center"],["azt-track-service","mark-essay-new-jJ82weJqe",1,"mr-1","flex-none",3,"matTooltip","click"],[1,"mr-1","inline-block","flex-none",2,"min-width","130px"],[1,"maxPoint",3,"matTooltip"],["type","text","appOnlyNumber","","step",".01",1,"form-control",3,"readonly","decimal","placeholder","ngClass","formControlName"],["class","mt-2 text-danger text-xs",4,"ngIf"],[1,"mt-2","text-danger","text-xs"],[1,"BWrap-one"],["azt-track-service","mark-essay-new-qoh8TPOQYx","id","btn-1",1,"mt-3","btn","btn-primary",3,"disabled","click"],[1,"essay_qItem"],[1,"mt-2",2,"display","block",3,"id"],[3,"follower","examObj","questionObj","curQuestionIndex","userAnswersObj","currentTab",4,"ngIf"],[3,"follower","examObj","questionObj","curQuestionIndex","userAnswersObj","orgExamObjs","currentTab",4,"ngIf"],["class","block-input","style","margin-bottom: 40px; margin-top: -20px",4,"ngIf"],[3,"follower","examObj","questionObj","curQuestionIndex","userAnswersObj","currentTab"],[3,"follower","examObj","questionObj","curQuestionIndex","userAnswersObj","orgExamObjs","currentTab"],[1,"block-input",2,"margin-bottom","40px","margin-top","-20px"],[3,"formGroup"],[1,"mr-2","font-medium",3,"for"],["type","text","appOnlyNumber","","step",".01",1,"form-control","form-input","d-inline-flex",3,"readonly","ngClass","id","decimal","placeholder","formControlName"],[1,"mb-2","mt-2"],[3,"dataMarkNote","screenType","modeView","doneLoadData",4,"ngIf"],[3,"dataMarkNote","screenType","modeView","doneLoadData"],["aztMarkNote",""],[1,"BWrap"],["azt-track-service","mark-essay-new-kAM88sxUxu","id","btn-2",1,"mt-3","btn","btn-primary",3,"disabled","click"]],template:function(K,q){1&K&&(g.TgZ(0,"div",0)(1,"form",1),g.YNc(2,Be,15,27,"div",2),g.qZA(),g.YNc(3,V,5,6,"div",3),g.qZA(),g.TgZ(4,"div",4),g.YNc(5,wt,5,4,"div",5),g.qZA(),g.YNc(6,Ae,6,6,"div",6),g.TgZ(7,"div",7,8),g.YNc(9,Y,2,1,"ng-container",9),g.qZA(),g.YNc(10,ae,5,6,"div",10)),2&K&&(g.xp6(1),g.Q6J("formGroup",q.form),g.xp6(1),g.Q6J("ngForOf",q.questions),g.xp6(1),g.Q6J("ngIf",q.showForTeacher),g.xp6(2),g.Q6J("ngForOf",q.questions),g.xp6(1),g.Q6J("ngIf",q.files&&0==q.files.length),g.xp6(1),g.Q6J("ngStyle",g.VKq(8,$,q.files&&0==q.files.length?"none":"block")),g.xp6(2),g.Q6J("ngIf",q.dataMarkNote&&q.dataMarkNote.answer_obj&&q.files&&q.files.length>0),g.xp6(1),g.Q6J("ngIf",q.showForTeacher))},dependencies:[L.mk,L.sg,L.O5,L.PC,U.Hw,Z.gM,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,le.H,P.Y,H.M,ce.f,ge.Y,Oe.JV],styles:["#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]{flex:auto;display:flex;flex-wrap:wrap;padding-bottom:10px;width:100%}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{margin-right:5px;display:flex;justify-content:center;align-items:center;padding-right:5px;margin-bottom:5px;width:24%}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:0 5px;height:30px;border-radius:3px;padding-left:5px;width:60px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child, #essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:3px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   .maxPoint[_ngcontent-%COMP%]{color:#838383;margin-right:3px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   .maxPoint[_ngcontent-%COMP%]:hover{cursor:default}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#585858}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{cursor:pointer}.edit-question-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-radius:5px;margin-bottom:-15px!important;padding-bottom:0!important}.edit-question-header-right[_ngcontent-%COMP%]{display:flex;align-items:center}.edit-question-header-tag[_ngcontent-%COMP%], .edit-question-header-content[_ngcontent-%COMP%]{margin:5px 10px 10px;padding:5px}.edit-question-header-tag[_ngcontent-%COMP%]:hover, .edit-question-header-content[_ngcontent-%COMP%]:hover{background:rgba(35,97,174,.1803921569);border-radius:5px}.edit-question-header-dr[_ngcontent-%COMP%]{color:#607d8b;margin:0 10px}.edit-question-header-content[_ngcontent-%COMP%]{cursor:pointer}.edit-question-header-point[_ngcontent-%COMP%]{text-align:right}.form-control.is-invalid[_ngcontent-%COMP%]{padding-right:calc(1.5em + .15rem)!important;background-position:right calc(.375em + .02rem) center!important}.form-input[_ngcontent-%COMP%]{height:30px;width:96px}.form-mark[_ngcontent-%COMP%]{margin-left:20px}div#showQuestionEssay[_ngcontent-%COMP%]{width:100%}.BWrap[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;padding-bottom:15px}.essay_qItem[_ngcontent-%COMP%]:last-child > div[_ngcontent-%COMP%]{margin-bottom:1rem;padding-bottom:30px!important}[type=number][_ngcontent-%COMP%]{appearance:none;appearance:textfield;-webkit-appearance:none;-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.pr-3[_ngcontent-%COMP%]{padding-right:.75rem}@media screen and (max-width: 1474px){#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{margin-bottom:5px}.stt[_ngcontent-%COMP%]{font-size:12px}.maxPoint[_ngcontent-%COMP%]{font-size:10px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{width:48%}}@media screen and (max-width: 768px){.stt[_ngcontent-%COMP%]{font-size:13px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{width:48%}}@media screen and (max-width: 480px){#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{border-right:none;margin-bottom:5px}.stt[_ngcontent-%COMP%]{font-size:13px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{width:99%}}"]}),ee})()},58334:(at,ue,w)=>{"use strict";w.d(ue,{a:()=>Ae});var O=w(69862),u=w(65879),g=w(56223),h=w(69384),_=w(56443),m=w(39621),B=w(14845),W=w(94281),F=w(8415),E=w(52846),R=w(50952),A=w(50503),fe=w(96814),L=w(30617),U=w(92596),Z=w(81373),le=w(775),P=w(70297),H=w(87721),ce=w(11964);const ge=["mnoteContainer"];function Oe(ne,Y){1&ne&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"mytranslate"),u.qZA()),2&ne&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"lang_mark_essay_please_enter_a_score_greater_than_or_equal_to_0")," "))}function qe(ne,Y){1&ne&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"mytranslate"),u.qZA()),2&ne&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"lang_mark_essay_please_enter_a_score_less_than_or_equal_to_the_score_of_the_question")," "))}function Me(ne,Y){1&ne&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"mytranslate"),u.qZA()),2&ne&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"lang_mark_essay_please_do_not_enter_more_than_8_numbers_after_the_decimal_point")," "))}function pt(ne,Y){if(1&ne&&(u.TgZ(0,"div",18),u.YNc(1,Oe,3,3,"span",19),u.YNc(2,qe,3,3,"span",19),u.YNc(3,Me,3,3,"span",19),u.qZA()),2&ne){const ae=u.oxw().index,$=u.oxw();u.xp6(1),u.Q6J("ngIf",null==$.form.controls["cau"+ae].errors?null:$.form.controls["cau"+ae].errors.min),u.xp6(1),u.Q6J("ngIf",null==$.form.controls["cau"+ae].errors?null:$.form.controls["cau"+ae].errors.max),u.xp6(1),u.Q6J("ngIf",null==$.form.controls["cau"+ae].errors?null:$.form.controls["cau"+ae].errors.pattern)}}const Fe=function(ne){return{border:ne}},ht=function(ne){return{"is-invalid":ne}};function we(ne,Y){if(1&ne){const ae=u.EpF();u.TgZ(0,"div",11)(1,"div",12)(2,"mat-icon",13),u.NdJ("click",function(Se){const Pe=u.CHM(ae).index,K=u.oxw();return u.KtG(K.toggleVisibility(Se,Pe))}),u.ALo(3,"mytranslate"),u._uU(4,"visibility"),u.qZA(),u.TgZ(5,"span",14),u._uU(6),u.ALo(7,"mytranslate"),u.TgZ(8,"span",15),u.ALo(9,"mytranslate"),u._uU(10),u.ALo(11,"mytranslate"),u.qZA()(),u._UZ(12,"input",16),u.ALo(13,"mytranslate"),u.qZA(),u.YNc(14,pt,4,3,"div",17),u.qZA()}if(2&ne){const ae=Y.$implicit,$=Y.index,Se=u.oxw();let ee;u.Q6J("ngStyle",u.VKq(23,Fe,$==Se.questions.length-1?"none":"")),u.xp6(2),u.s9C("matTooltip",u.lcZ(3,13,"lang_auto_anhien_phan_bai_lam_cua_cau_hoi_nay")),u.xp6(4),u.AsE(" ",u.lcZ(7,15,"lang_auto_cau")," ",(null!==(ee=ae.indexLabel)&&void 0!==ee?ee:0)+1," "),u.xp6(2),u.s9C("matTooltip",u.lcZ(9,17,"lang_auto_diem_toi_da_cho_cau_hoi_nay_theo_thang_diem_brackets")),u.xp6(2),u.AsE("(",ae.essMaxPoint," ",u.lcZ(11,19,"lang_auto_diem_brackets"),""),u.xp6(2),u.s9C("placeholder",u.lcZ(13,21,"lang_auto_nhap_diem")),u.MGl("formControlName","cau",$,""),u.Q6J("readonly",!Se.showForTeacher)("decimal",!0)("ngClass",u.VKq(25,ht,Se.form.controls["cau"+$]&&Se.form.controls["cau"+$].invalid)),u.xp6(2),u.Q6J("ngIf",Se.form.controls["cau"+$].errors)}}function Ne(ne,Y){if(1&ne){const ae=u.EpF();u.TgZ(0,"div",20)(1,"button",21),u.NdJ("click",function(){u.CHM(ae);const Se=u.oxw();return u.KtG(Se.getMnoteJsonData())}),u._uU(2),u.ALo(3,"mytranslate"),u.ALo(4,"mytranslate"),u.qZA()()}if(2&ne){const ae=u.oxw();u.xp6(1),u.Q6J("disabled",ae.isLoading||ae.form.invalid),u.xp6(1),u.hij(" ",ae.isLoading?u.lcZ(3,2,"lang_auto_dang_luu_doing"):u.lcZ(4,4,"lang_auto_luu_diem")," ")}}function X(ne,Y){if(1&ne&&u._UZ(0,"azt-question-standalone-for-student-at-review-page",27),2&ne){const ae=u.oxw().$implicit,$=u.oxw();let Se;u.Q6J("follower",$.followerRenderQuest)("examObj",$.examObj)("questionObj",ae)("curQuestionIndex",null!==(Se=ae.indexLabel)&&void 0!==Se?Se:0)("userAnswersObj",$.userAnswersObj)("currentTab","essay_tab")}}function Be(ne,Y){if(1&ne&&u._UZ(0,"azt-question-standalone-for-teacher-at-review-page",28),2&ne){const ae=u.oxw().$implicit,$=u.oxw();let Se;u.Q6J("follower",$.followerRenderQuest)("examObj",$.examObj)("questionObj",ae)("curQuestionIndex",null!==(Se=ae.indexLabel)&&void 0!==Se?Se:0)("userAnswersObj",$.userAnswersObj)("orgExamObjs",$.orgExamObjs)("currentTab","essay_tab")}}function V(ne,Y){1&ne&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"mytranslate"),u.qZA()),2&ne&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"lang_mark_essay_please_enter_a_score_greater_than_or_equal_to_0")," "))}function oe(ne,Y){1&ne&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"mytranslate"),u.qZA()),2&ne&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"lang_mark_essay_please_enter_a_score_less_than_or_equal_to_the_score_of_the_question")," "))}function pe(ne,Y){1&ne&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"mytranslate"),u.qZA()),2&ne&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"lang_mark_essay_please_do_not_enter_more_than_8_numbers_after_the_decimal_point")," "))}function Ue(ne,Y){if(1&ne&&(u.TgZ(0,"div",18),u.YNc(1,V,3,3,"span",19),u.YNc(2,oe,3,3,"span",19),u.YNc(3,pe,3,3,"span",19),u.qZA()),2&ne){const ae=u.oxw(2).index,$=u.oxw();u.xp6(1),u.Q6J("ngIf",null==$.form.controls["cau"+ae].errors?null:$.form.controls["cau"+ae].errors.min),u.xp6(1),u.Q6J("ngIf",null==$.form.controls["cau"+ae].errors?null:$.form.controls["cau"+ae].errors.max),u.xp6(1),u.Q6J("ngIf",null==$.form.controls["cau"+ae].errors?null:$.form.controls["cau"+ae].errors.pattern)}}function rt(ne,Y){if(1&ne&&(u.TgZ(0,"div",29)(1,"form",30)(2,"label",31),u._uU(3),u.ALo(4,"mytranslate"),u.TgZ(5,"span",15),u.ALo(6,"mytranslate"),u._uU(7),u.ALo(8,"mytranslate"),u.qZA(),u._uU(9,": "),u.qZA(),u._UZ(10,"input",32),u.ALo(11,"mytranslate"),u.YNc(12,Ue,4,3,"div",17),u.qZA()()),2&ne){const ae=u.oxw(),$=ae.index,Se=ae.$implicit,ee=u.oxw();let Pe;u.xp6(1),u.Q6J("formGroup",ee.form),u.xp6(1),u.s9C("for","cau_"+$),u.xp6(1),u.AsE(" ",u.lcZ(4,14,"lang_auto_nhap_diem_cau")," ",(null!==(Pe=Se.indexLabel)&&void 0!==Pe?Pe:0)+1," "),u.xp6(2),u.s9C("matTooltip",u.lcZ(6,16,"lang_auto_diem_toi_da_cho_cau_hoi_nay_theo_thang_diem_brackets")),u.xp6(2),u.AsE("(",Se.essMaxPoint," ",u.lcZ(8,18,"lang_auto_diem_brackets"),""),u.xp6(3),u.s9C("placeholder",u.lcZ(11,20,"lang_auto_nhap_diem")),u.MGl("formControlName","cau",$,""),u.Q6J("readonly",!ee.showForTeacher)("ngClass",u.VKq(22,ht,ee.form.controls["cau"+$]&&ee.form.controls["cau"+$].invalid))("id","cau_"+$)("decimal",!0),u.xp6(2),u.Q6J("ngIf",ee.form.controls["cau"+$].errors)}}function Je(ne,Y){if(1&ne&&(u.TgZ(0,"div",22)(1,"div",23),u.YNc(2,X,1,6,"azt-question-standalone-for-student-at-review-page",24),u.YNc(3,Be,1,7,"azt-question-standalone-for-teacher-at-review-page",25),u.YNc(4,rt,13,24,"div",26),u.qZA()()),2&ne){const ae=Y.index,$=u.oxw();u.xp6(1),u.MGl("id","q_",ae,""),u.xp6(1),u.Q6J("ngIf",!$.showForTeacher),u.xp6(1),u.Q6J("ngIf",$.showForTeacher),u.xp6(1),u.Q6J("ngIf",$.showForTeacher)}}function xt(ne,Y){1&ne&&(u.TgZ(0,"div",33)(1,"b"),u._uU(2),u.ALo(3,"mytranslate"),u.qZA(),u._uU(4),u.ALo(5,"mytranslate"),u.qZA()),2&ne&&(u.xp6(2),u.hij("",u.lcZ(3,2,"lang_auto_anh_bai_lam_tu_luan"),": "),u.xp6(2),u.Oqu(u.lcZ(5,4,"lang_auto_khong_co_du_lieu_anh_bai_lam_tu_luan_cua_thi_sinh")))}function De(ne,Y){if(1&ne){const ae=u.EpF();u.TgZ(0,"div",34)(1,"button",35),u.NdJ("click",function(){u.CHM(ae);const Se=u.oxw();return u.KtG(Se.getMnoteJsonData())}),u._uU(2),u.ALo(3,"mytranslate"),u.ALo(4,"mytranslate"),u.qZA()()}if(2&ne){const ae=u.oxw();u.xp6(1),u.Q6J("disabled",ae.isLoading||ae.form.invalid),u.xp6(1),u.hij(" ",ae.isLoading?u.lcZ(3,2,"lang_auto_dang_luu_doing"):u.lcZ(4,4,"lang_auto_luu_diem")," ")}}const wt=function(ne){return{display:ne}};let Ae=(()=>{class ne extends m.Q{parseValue(ae){return this.commonService.willDeleteParseJson(this.examResultObj.essayResult??"{}")[ae]}getMaxPoint(ae){var $=0;for(let Se=0;Se<this.questions.length;Se++)if(this.questions[Se].id==ae){$=this.questions[Se].scorePerQuestion??0;break}return $}toggleVisibility(ae,$){var Se=ae.target,ee=document.getElementById(`q_${$}`);ee&&("block"==ee?.style.display?(ee.style.display="none",Se&&(Se.textContent="visibility_off")):(ee.style.display="block",Se&&(Se.textContent="visibility")))}isValidPoint(){let ae=0;var $=this.form.value;for(var Se in $){var ee=Number(Se.substring(3));$[Se]>this.maxPointPerQuestion[ee]&&ae++}return!(ae>0)}validateForm(ae,$,Se,ee){let Pe="";this.form.get("cau"+ee)?.valueChanges.pipe((0,h.G)()).subscribe(([K,q])=>{if(Pe="string"==typeof q&&q.includes(",")?q.replace(",","."):q,isNaN(+Pe))this.showErrorSnack("lang_auto_yeu_cau_chi_nhap_so"),this.form.controls["cau"+ee].setValue($);else{let ie=parseFloat(Pe);ie>Se&&this.showErrorSnack("lang_auto_khong_nhap_qua_so_diem_toi_da_cua_cau_hoi"),ie<0&&this.showErrorSnack("lang_auto_ban_dang_nhap_nho_hon_0")}})}uploadBase64ToCDN(ae,$){var Se=this.baseApiService.dataURItoBlob(ae);this.apiUploadService.commonUploadForMarkResult(Se,`essay_note_${$}_${this.resultID}.png`,"image/png",1e4).subscribe(ee=>{ee.type!=O.dt.UploadProgress&&(1==ee.success?(this.mnoteJsonData.pages[$].draw=ee.data?.url,this.pagesCount--,0==this.pagesCount&&this.remark(JSON.stringify(this.mnoteJsonData))):this.commonService.snackError("lang_auto_luu_du_lieu_cham_bai_khong_thanh_cong"))})}uploadAll(ae){this.pagesCount=0;for(let $=0;$<ae.length;$++)ae[$].draw&&this.pagesCount++;if(0==this.pagesCount)this.remark(JSON.stringify(this.mnoteJsonData));else for(let $=0;$<ae.length;$++)ae[$].draw&&this.uploadBase64ToCDN(ae[$].draw,$)}sendDataToIframe(){const ae=document.getElementById("mNote"),$=ae?ae.contentWindow:null;if(null!==$)if(this.examResultObj.confirmedAt&&this.examResultObj.result){if(this.examResultObj.result){var Se=this.commonService.willDeleteParseJson(this.examResultObj.result);if(null!=Se){for(let Pe=0;Pe<Se.pages.length;Pe++)Se.pages[Pe].backgroundImage&&(Se.pages[Pe].backgroundImage=this.cdnService.getMyCdn(Se.pages[Pe].backgroundImage)),Se.pages[Pe].draw&&(Se.pages[Pe].draw=this.cdnService.getMyCdn(Se.pages[Pe].draw));Se=JSON.stringify(Se),this.examResultObj.result=Se}}var ee=this.checkMapBGImageWithFileLength(this.examResultObj.result??"{}");if(this.jsonData=this.commonService.willDeleteParseJson(ee?this.examResultObj.result??"{}":this.addBGImageByFileUrl(this.examResultObj.result??"{}")),this.jsonData&&this.jsonData.hasOwnProperty("pages"))for(let Pe=0;Pe<this.jsonData.pages.length;Pe++)this.jsonData.pages[Pe].hasOwnProperty("backgroundImage")&&(this.jsonData.pages[Pe].backgroundImage=this.cdnService.getMyCdn(this.jsonData.pages[Pe].backgroundImage)),this.jsonData.pages[Pe].hasOwnProperty("draw")&&(this.jsonData.pages[Pe].draw=this.cdnService.getMyCdn(this.jsonData.pages[Pe].draw));this.jsonData&&(this.jsonData.cmd="initMNote",this.jsonData.mode=this.iframeViewMode,this.jsonData.context="exam"),$.postMessage(this.jsonData,"*")}else{let Pe=[];this.files.forEach(q=>{var ie=this.cdnService.getMyCdn(q.url);ie&&Pe.push({backgroundImage:ie})}),$.postMessage({cmd:"initMNote",pages:Pe,mode:this.showForTeacher?"edit":"view",context:"exam"},"*"),this.dataMarkNote.answer_obj={id:0,homeworkId:0,studentId:0,point:0,files:Pe}}}checkMapBGImageWithFileLength(ae){var $=this.commonService.willDeleteParseJson(ae);let Se=!1;if(0==this.files.length)Se=!0;else if(this.files.length>0&&$&&$.pages&&this.files.length==$.pages.length){let ee=0;this.files.forEach((Pe,K)=>{$.pages[K]&&$.pages[K].backgroundImage&&$.pages[K].backgroundImage.indexOf(Pe.path)>-1&&ee++}),ee==this.files.length&&(Se=!0)}return Se}addBGImageByFileUrl(ae){var $=this.commonService.willDeleteParseJson(ae);return this.files.forEach((Se,ee)=>{let Pe=!1;if($&&$.pages){for(var K=0;K<$.pages.length;K++)if($.pages[K]&&$.pages[K].backgroundImage&&$.pages[K].backgroundImage.indexOf(Se.path)>-1){Pe=!0;break}!1===Pe&&($.pages[ee]&&$.pages[ee].id==ee?$.pages[ee].backgroundImage=this.cdnService.getMyCdn(Se.url??""):$.pages.splice(ee,0,{backgroundImage:this.cdnService.getMyCdn(Se.url??"")}))}}),JSON.stringify($)}getMnoteJsonData(){if(this.permissionService.hasMarkPointPermission("exam",this.examObj)||this.permissionService.hasConfigAndMarkClassroomPermission("exam",this.examObj)){if(!this.isValidPoint())return void this.showErrorSnack("lang_auto_cham_diem_vuot_qua_so_diem_toi_da_vui_long_kiem_tra_lai");{let ae=!1;for(const $ in this.form.value)""!==this.form.value[$]&&(ae=!0);if(!ae)return void this.showErrorSnack("lang_core_vui_long_nhap_diem_tu_luan");for(const $ in this.form.value)""===this.form.value[$]&&(this.form.value[$]=0,this.form.controls[$].setValue(0));if(this.files&&this.files.length>0){const $=document.getElementById("mNote"),Se=$?$.contentWindow:null;null!==Se&&Se.postMessage({cmd:"getMNoteJson"},"*")}else this.isLoading=!0,this.remark("")}}else this.showErrorSnack("lang_auto_ban_khong_co_quen_cham_de_thi_nay")}remark(ae){if(this.checkMapBGImageWithFileLength(ae)){for(const Pe in this.form.value)"string"==typeof this.form.value[Pe]&&this.form.value[Pe].includes(",")&&(this.form.value[Pe]=this.form.value[Pe].replace(",","."));let ee=JSON.stringify({type:"exam",id:this.examObj.id,user:this.examObj.tenantId});var Se={id:this.resultID,result:ae,essayResult:JSON.stringify(this.form.value)};this.examResultService.apiExamResultSaveResultPost(Se,ee).subscribe(Pe=>{1==Pe.success?(this.showSuccessSnack("lang_auto_cham_diem_tu_luan_thanh_cong"),this.saveResultEvent.emit(1),this.isLoading=!1):(this.commonService.snackError(Pe.message??""),this.saveResultEvent.emit(0),this.isLoading=!1)})}else this.showErrorSnack("lang_auto_cham_diem_tu_luan_loi_du_lieu_bai_tu_luan_dang_duoc_tai_len_vui_long_tai_lai_trang_va_doi_trong_giay_lat"),this.saveResultEvent.emit(0),this.isLoading=!1}ngOnInit(){this.iframeSrc=this.envService.getEnvValue("classliveUrl")??"";var ae={};let $;this.examResultObj.confirmedAt&&($=this.commonService.willDeleteParseJson(this.examResultObj.essayResult??"{}")),this.followerRenderQuest.setNumQuest(this.questions.length),this.questions.forEach(ee=>{let Pe=this.getMaxPoint(ee.id);this.totalMaxPoint+=Pe,ee.essMaxPoint=Pe,this.maxPointPerQuestion.push(ee.essMaxPoint)});for(let ee=0;ee<this.questions.length;ee++){var Se=`cau${ee}`;ae[Se]=new g.p4($?$[Se]:"",[g.kI.pattern("^[0-9]((.|,){0,1})[0-9]{0,8}"),g.kI.min(0),g.kI.max(this.questions[ee].essMaxPoint??0)])}this.form=this.fb.group(ae),this.form.valueChanges.subscribe(ee=>{let Pe=JSON.stringify(ee);Pe!=this.prevData&&(this.prevData=Pe,this.form.patchValue(ee))}),super.ngOnInit()}ngAfterViewInit(){window.addEventListener("message",this.handleIframe)}constructor(ae,$,Se,ee,Pe,K,q){super(),this.baseApiService=ae,this.fb=$,this.permissionService=Se,this.cdnService=ee,this.envService=Pe,this.examResultService=K,this.apiUploadService=q,this.orgExamObjs=[],this.questions=[],this.files=[],this.userAnswersObj={},this.resultID=0,this.iframeSrc="",this.hasLoadedData=!1,this.iframeViewMode="view",this.saveResultEvent=new u.vpe,this.followerRenderQuest=new _.p,this.form=new g.nJ({}),this.formValue={},this.isLoading=!1,this.totalMaxPoint=0,this.maxPointPerQuestion=[],this.hasSendDataToIframe=!1,this.jsonData={},this.mnoteJsonData={},this.pagesCount=0,this.dataMarkNote={},this.handleIframe=ie=>{"MNoteJson"==ie.data.cmd&&(this.isLoading=!0,this.mnoteJsonData=ie.data.data,this.uploadAll(this.mnoteJsonData.pages)),"MNoteLoadComplete"==ie.data&&(this.hasLoadedData?(this.hasSendDataToIframe=!0,this.sendDataToIframe()):this.hasSendDataToIframe=!1)}}ngOnDestroy(){window.removeEventListener("message",this.handleIframe),super.ngOnDestroy()}}return ne.\u0275fac=function(ae){return new(ae||ne)(u.Y36(B.V),u.Y36(g.QS),u.Y36(W.j),u.Y36(F.E),u.Y36(E.h),u.Y36(R.k),u.Y36(A.W))},ne.\u0275cmp=u.Xpm({type:ne,selectors:[["azt-mark-essay"]],viewQuery:function(ae,$){if(1&ae&&u.Gf(ge,5),2&ae){let Se;u.iGM(Se=u.CRH())&&($.mnoteContainer=Se.first)}},inputs:{showForTeacher:"showForTeacher",examObj:"examObj",orgExamObjs:"orgExamObjs",questions:"questions",files:"files",examResultObj:"examResultObj",userAnswersObj:"userAnswersObj",resultID:"resultID",iframeSrc:"iframeSrc",hasLoadedData:"hasLoadedData",iframeViewMode:"iframeViewMode"},outputs:{saveResultEvent:"saveResultEvent"},features:[u.qOj],decls:12,vars:12,consts:[["id","essayBoxButtons",1,"flex","items-center","jusitfy-center","flex-col","p-3","rounded-md","border","border-slate-200","dark:border-darkmode-400"],[1,"grid","grid-cols-12","gap-3","pb-3","w-full","border-b","border-slate-200","dark:border-darkmode-400",3,"formGroup"],["class","col-span-12 md:col-span-6 lg:col-span-4 pr-3 border-r border-slate-200 dark:border-darkmode-400",3,"ngStyle",4,"ngFor","ngForOf"],["class","BWrap-one",4,"ngIf"],["id","showQuestionEssay"],["class","essay_qItem",4,"ngFor","ngForOf"],["class","mb-2 mt-2",4,"ngIf"],[1,"card-box","listPhotos",3,"ngStyle"],["mnoteContainer",""],["id","mNote","frameborder","0",2,"width","100%","height","100vh",3,"src"],["class","BWrap",4,"ngIf"],[1,"col-span-12","md:col-span-6","lg:col-span-4","pr-3","border-r","border-slate-200","dark:border-darkmode-400",3,"ngStyle"],[1,"flex","items-center"],["azt-track-service","mark-essay-new-jJ82weJqe",1,"mr-1","flex-none",3,"matTooltip","click"],[1,"mr-1","inline-block","flex-none",2,"min-width","130px"],[1,"maxPoint",3,"matTooltip"],["type","text","appOnlyNumber","","step",".01",1,"form-control",3,"readonly","decimal","placeholder","ngClass","formControlName"],["class","mt-2 text-danger text-xs",4,"ngIf"],[1,"mt-2","text-danger","text-xs"],[4,"ngIf"],[1,"BWrap-one"],["azt-track-service","mark-essay-TM1aspmGv4","id","btn-1",1,"mt-3","btn","btn-primary",3,"disabled","click"],[1,"essay_qItem"],[1,"mt-2",2,"display","block",3,"id"],[3,"follower","examObj","questionObj","curQuestionIndex","userAnswersObj","currentTab",4,"ngIf"],[3,"follower","examObj","questionObj","curQuestionIndex","userAnswersObj","orgExamObjs","currentTab",4,"ngIf"],["class","block-input","style"," margin-bottom: 40px; margin-top: -20px;",4,"ngIf"],[3,"follower","examObj","questionObj","curQuestionIndex","userAnswersObj","currentTab"],[3,"follower","examObj","questionObj","curQuestionIndex","userAnswersObj","orgExamObjs","currentTab"],[1,"block-input",2,"margin-bottom","40px","margin-top","-20px"],[3,"formGroup"],[1,"mr-2","font-medium",3,"for"],["type","text","appOnlyNumber","","step",".01",1,"form-control","form-input","d-inline-flex",3,"readonly","ngClass","id","decimal","placeholder","formControlName"],[1,"mb-2","mt-2"],[1,"BWrap"],["azt-track-service","mark-essay-RBBGLVIph5","id","btn-2",1,"mt-3","btn","btn-primary",3,"disabled","click"]],template:function(ae,$){1&ae&&(u.TgZ(0,"div",0)(1,"form",1),u.YNc(2,we,15,27,"div",2),u.qZA(),u.YNc(3,Ne,5,6,"div",3),u.qZA(),u.TgZ(4,"div",4),u.YNc(5,Je,5,4,"div",5),u.qZA(),u.YNc(6,xt,6,6,"div",6),u.TgZ(7,"div",7,8),u._UZ(9,"iframe",9),u.ALo(10,"safe"),u.qZA(),u.YNc(11,De,5,6,"div",10)),2&ae&&(u.xp6(1),u.Q6J("formGroup",$.form),u.xp6(1),u.Q6J("ngForOf",$.questions),u.xp6(1),u.Q6J("ngIf",$.showForTeacher),u.xp6(2),u.Q6J("ngForOf",$.questions),u.xp6(1),u.Q6J("ngIf",$.files&&0==$.files.length),u.xp6(1),u.Q6J("ngStyle",u.VKq(10,wt,$.files&&0==$.files.length?"none":"block")),u.xp6(2),u.Q6J("src",u.lcZ(10,8,$.iframeSrc),u.uOi),u.xp6(2),u.Q6J("ngIf",$.showForTeacher))},dependencies:[fe.mk,fe.sg,fe.O5,fe.PC,L.Hw,U.gM,g._Y,g.Fj,g.JJ,g.JL,g.sg,g.u,Z.Y,le.M,P.f,H.Y,ce.JV,ce.CR],styles:["#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]{flex:auto;display:flex;flex-wrap:wrap;padding-bottom:10px;width:100%}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{margin-right:5px;display:flex;justify-content:center;align-items:center;padding-right:5px;margin-bottom:5px;width:24%}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:0 5px;height:30px;border-radius:3px;padding-left:5px;width:60px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child, #essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:3px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   .maxPoint[_ngcontent-%COMP%]{color:#838383;margin-right:3px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   .maxPoint[_ngcontent-%COMP%]:hover{cursor:default}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#585858}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{cursor:pointer}.form-control.is-invalid[_ngcontent-%COMP%]{padding-right:calc(1.5em + .15rem)!important;background-position:right calc(.375em + .02rem) center!important}.form-input[_ngcontent-%COMP%]{height:30px;width:96px}.form-mark[_ngcontent-%COMP%]{margin-left:20px}div#showQuestionEssay[_ngcontent-%COMP%]{width:100%}.BWrap[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;padding-bottom:15px}.essay_qItem[_ngcontent-%COMP%]:last-child > div[_ngcontent-%COMP%]{margin-bottom:1rem;padding-bottom:30px!important}[type=number][_ngcontent-%COMP%]{appearance:none;appearance:textfield;-webkit-appearance:none;-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.pr-3[_ngcontent-%COMP%]{padding-right:.75rem}@media screen and (max-width: 1474px){#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{margin-bottom:5px}.stt[_ngcontent-%COMP%]{font-size:12px}.maxPoint[_ngcontent-%COMP%]{font-size:10px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{width:48%}}@media screen and (max-width: 768px){.stt[_ngcontent-%COMP%]{font-size:13px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{width:48%}}@media screen and (max-width: 480px){#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{border-right:none;margin-bottom:5px}.stt[_ngcontent-%COMP%]{font-size:13px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{width:99%}}"]}),ne})()},41715:(at,ue,w)=>{"use strict";w.d(ue,{cS:()=>fe});class O{constructor(){this.x=0,this.y=0}toBase64String(){return(new Z).writeCvPoint2u(this).toBase64String()}}class u{constructor(){this.x=0,this.y=0}toBase64String(){return(new Z).writeCvPoint2f(this).toBase64String()}}class g{constructor(){this.x=0,this.y=0,this.width=0,this.height=0}toBase64String(){return(new Z).writeCvRect2f(this).toBase64String()}}class h{constructor(){this.center=new u,this.filled=!1}toBase64String(){return(new Z).writeAnswerCircle(this).toBase64String()}}class _{constructor(){this.rows=0,this.cols=0,this.radius=0,this.answers=[]}toBase64String(){return(new Z).writeTableAnswer(this).toBase64String()}}class m{constructor(){this.top=new u,this.left=new u,this.bottom=new u,this.right=new u}toBase64String(){return(new Z).writeResultRect(this).toBase64String()}}class B{constructor(){this.id=0,this.region=new g}toBase64String(){return(new Z).writeCropRegion(this).toBase64String()}}class W{constructor(){this.type=0,this.errorCode=0,this.paperCorner=new m,this.studentId=new _,this.examId=new _,this.answerTable=new _,this.imageWidth=0,this.imageHeight=0,this.imageSize=0,this.cropRegion=[]}toBase64String(){return(new Z).writeResultOutput(this).toBase64String()}}class F{constructor(){this.templateType=0,this.imageWidth=0,this.imageHeight=0}toBase64String(){return(new Z).writeAnswerSheetInput(this).toBase64String()}}class E{constructor(){this.position=0,this.x=0,this.y=0,this.filledCols=0,this.rows=0}toBase64String(){return(new Z).writeSmallAnswerCircle(this).toBase64String()}}class R{constructor(){this.rows=0,this.cols=0,this.radius=0,this.answers=[]}toBase64String(){return(new Z).writeSmallTableAnswer(this).toBase64String()}}class A{constructor(){this.studentId=new R,this.examId=new R,this.answerTable=new R}toBase64String(){return(new Z).writeDrawData(this).toBase64String()}}class fe{constructor(P){this.bytes=P,this.cursor=0,this.length=P.byteLength}updateCursor(P){if(this.cursor=this.cursor+P,this.cursor>this.length)throw new Error("Overflow InputStreaming")}parseUchar(){let P=this.bytes[this.cursor];return this.updateCursor(1),P}parseInt(){let P=this.bytes.buffer.slice(this.cursor,this.cursor+4);return this.updateCursor(4),new DataView(P).getInt32(0)}parseDouble(){let P=this.bytes.buffer.slice(this.cursor,this.cursor+8);return this.updateCursor(8),new DataView(P).getFloat64(0,!0)}parseString(){let P=new TextDecoder("utf-8"),H=this.cursor,ce=this.bytes[this.cursor];for(;0!=ce;)this.updateCursor(1),ce=this.bytes[this.cursor];let ge=this.bytes.slice(H,this.cursor),Oe=P.decode(ge);return this.updateCursor(1),Oe}parseBool(){let P=this.bytes[this.cursor];return this.updateCursor(1),P>0}parseCvPoint2u(){let P=new O;return P.x=this.parseUchar(),P.y=this.parseUchar(),P}parseCvPoint2f(){let P=new u;return P.x=this.parseDouble(),P.y=this.parseDouble(),P}parseCvRect2f(){let P=new g;return P.x=this.parseDouble(),P.y=this.parseDouble(),P.width=this.parseDouble(),P.height=this.parseDouble(),P}parseAnswerCircle(){let P=new h;return P.center=this.parseCvPoint2f(),P.filled=this.parseBool(),P}parseTableAnswer(){let P=new _,H=0;P.rows=this.parseInt(),P.cols=this.parseInt(),P.radius=this.parseInt(),H=this.parseInt();for(let ce=0;ce<H;ce++)P.answers.push(this.parseAnswerCircle());return P}parseResultRect(){let P=new m;return P.top=this.parseCvPoint2f(),P.left=this.parseCvPoint2f(),P.bottom=this.parseCvPoint2f(),P.right=this.parseCvPoint2f(),P}parseCropRegion(){let P=new B;return P.id=this.parseInt(),P.region=this.parseCvRect2f(),P}parseResultOutput(){let P=new W,H=0;P.type=this.parseInt(),P.errorCode=this.parseInt(),P.paperCorner=this.parseResultRect(),P.studentId=this.parseTableAnswer(),P.examId=this.parseTableAnswer(),P.answerTable=this.parseTableAnswer(),P.imageWidth=this.parseInt(),P.imageHeight=this.parseInt(),P.imageSize=this.parseInt(),H=this.parseInt();for(let ce=0;ce<H;ce++)P.cropRegion.push(this.parseCropRegion());return P}parseAnswerSheetInput(){let P=new F;return P.templateType=this.parseInt(),P.imageWidth=this.parseInt(),P.imageHeight=this.parseInt(),P}parseSmallAnswerCircle(){let P=new E;return P.position=this.parseUchar(),P.x=this.parseUchar(),P.y=this.parseUchar(),P.filledCols=this.parseUchar(),P.rows=this.parseUchar(),P}parseSmallTableAnswer(){let P=new R,H=0;P.rows=this.parseUchar(),P.cols=this.parseUchar(),P.radius=this.parseUchar(),H=this.parseInt();for(let ce=0;ce<H;ce++)P.answers.push(this.parseSmallAnswerCircle());return P}parseDrawData(){let P=new A;return P.studentId=this.parseSmallTableAnswer(),P.examId=this.parseSmallTableAnswer(),P.answerTable=this.parseSmallTableAnswer(),P}}const L=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];class Z{constructor(){this.bytes=[]}writeUchar(P){return this.bytes.push(P),this}writeUint8Array(P){for(let H=0;H<P.length;H++)this.bytes.push(P[H]);return this}writeArrayBuffer(P){let H=new Uint8Array(P);return this.writeUint8Array(H),this}writeInt(P){let H=new ArrayBuffer(4);return new DataView(H).setUint32(0,P,!1),this.writeArrayBuffer(H),this}writeDouble(P){let H=new ArrayBuffer(8);return new DataView(H).setFloat64(0,P,!0),this.writeArrayBuffer(H),this}writeString(P){let ce=(new TextEncoder).encode(P);return this.writeUint8Array(ce),this.writeUchar(0),this}writeBool(P){return this.writeUchar(P?1:0),this}toBase64String(){return function U(le){let H,P="",ce=le.length;for(H=2;H<ce;H+=3)P+=L[le[H-2]>>2],P+=L[(3&le[H-2])<<4|le[H-1]>>4],P+=L[(15&le[H-1])<<2|le[H]>>6],P+=L[63&le[H]];return H===ce+1&&(P+=L[le[H-2]>>2],P+=L[(3&le[H-2])<<4],P+="=="),H===ce&&(P+=L[le[H-2]>>2],P+=L[(3&le[H-2])<<4|le[H-1]>>4],P+=L[(15&le[H-1])<<2],P+="="),P}(new Uint8Array(this.bytes))}writeCvPoint2u(P){return this.writeUchar(P.x),this.writeUchar(P.y),this}writeCvPoint2f(P){return this.writeDouble(P.x),this.writeDouble(P.y),this}writeCvRect2f(P){return this.writeDouble(P.x),this.writeDouble(P.y),this.writeDouble(P.width),this.writeDouble(P.height),this}writeAnswerCircle(P){return this.writeCvPoint2f(P.center),this.writeBool(P.filled),this}writeTableAnswer(P){this.writeInt(P.rows),this.writeInt(P.cols),this.writeInt(P.radius),this.writeInt(P.answers.length);for(let H of P.answers)this.writeAnswerCircle(H);return this}writeResultRect(P){return this.writeCvPoint2f(P.top),this.writeCvPoint2f(P.left),this.writeCvPoint2f(P.bottom),this.writeCvPoint2f(P.right),this}writeCropRegion(P){return this.writeInt(P.id),this.writeCvRect2f(P.region),this}writeResultOutput(P){this.writeInt(P.type),this.writeInt(P.errorCode),this.writeResultRect(P.paperCorner),this.writeTableAnswer(P.studentId),this.writeTableAnswer(P.examId),this.writeTableAnswer(P.answerTable),this.writeInt(P.imageWidth),this.writeInt(P.imageHeight),this.writeInt(P.imageSize),this.writeInt(P.cropRegion.length);for(let H of P.cropRegion)this.writeCropRegion(H);return this}writeAnswerSheetInput(P){return this.writeInt(P.templateType),this.writeInt(P.imageWidth),this.writeInt(P.imageHeight),this}writeSmallAnswerCircle(P){return this.writeUchar(P.position),this.writeUchar(P.x),this.writeUchar(P.y),this.writeUchar(P.filledCols),this.writeUchar(P.rows),this}writeSmallTableAnswer(P){this.writeUchar(P.rows),this.writeUchar(P.cols),this.writeUchar(P.radius),this.writeInt(P.answers.length);for(let H of P.answers)this.writeSmallAnswerCircle(H);return this}writeDrawData(P){return this.writeSmallTableAnswer(P.studentId),this.writeSmallTableAnswer(P.examId),this.writeSmallTableAnswer(P.answerTable),this}}},36669:(at,ue,w)=>{"use strict";w.d(ue,{t:()=>_});var O=w(65879),u=w(87384),g=w(58222),h=w(46825);let _=(()=>{class m{addIndexLabelToQuestionObjs(W){for(let F=0;F<(W?.length??0);F++)W?.[F]&&(W[F].indexLabel=F);return W}getEssayQuestionObjs(W){let F=[];for(let E=0;E<(W?.length??0);E++)this.answerTypeService.isEssayAnswer(W?.[E])&&W?.[E]&&F.push(W[E]);return F}getTrueFalseQuestionObjs(W){let F=[];for(let E=0;E<(W?.length??0);E++)(this.answerTypeService.isOneChoiceAnswer(W?.[E])||this.answerTypeService.isFillAnswer(W?.[E]))&&W?.[E]&&F.push(W[E]);return F}convertAnswersArr(W){let F={};return 0!=W.length&&W.forEach(E=>{E.AnswerContent&&E.AnswerContent.length&&(F[`id_${E.QuestionId}`]=E.AnswerContent[0].Content)}),F}mapStudentObjWithTestedObj(W,F,E){var R=this.commonService.castObj(W?.studentObj),A=F?.filter(fe=>fe.userId==E?.parentId);return R&&A&&A.length>0&&(R={...R,offlineMarkObj:A[0].offlineMarkObj,nameImage:A[0].nameImage??""}),E=R}mapStudentObjWithTestedObjForFrontendStudent(W,F,E){var R=this.commonService.castObj(W?.studentObj),A=F?.filter(fe=>fe.userId==E?.parentId);return R&&A&&A.length>0&&(R={...R,offlineMarkObj:A[0].offlineMarkObj,nameImage:A[0].nameImage??""}),E=R}constructor(W,F,E){this.commonService=W,this.zipDataService=F,this.answerTypeService=E}}return m.\u0275fac=function(W){return new(W||m)(O.LFG(u.z),O.LFG(g.a),O.LFG(h.i))},m.\u0275prov=O.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},44821:(at,ue,w)=>{"use strict";w.d(ue,{z:()=>W});var O=w(19347),u=w(90241),g=w(65879),h=w(41719),_=w(96814),m=w(11964);function B(F,E){1&F&&(g.TgZ(0,"span"),g.O4$(),g.TgZ(1,"svg",15)(2,"g",16)(3,"g",17),g._UZ(4,"circle",18),g.TgZ(5,"path",19),g._UZ(6,"animateTransform",20),g.qZA()()()()())}let W=(()=>{class F extends u.e{confirmDelete(){this.initStatusObj(),this.subscriptions.add(this.offlineExamResultService.apiOfflineExamResultDeleteExamResultObjGet(this.examHashId,this.examResultId).subscribe(R=>{1==R.success?(this.dialogRef.close(!0),this.showSuccessSnack("lang_cms_delete_success")):(this.btnCloseDialog(),this.showErrorSnack(R.message??""))}))}btnCloseDialog(){this.dialogRef.close()}ngOnInit(){super.ngOnInit()}constructor(R,A,fe){super(fe,A),this.offlineExamResultService=R,this.dialogRef=A,this.examHashId="",this.examResultId=0,this.examHashId=fe.examHashId,this.examResultId=fe.examResultId}}return F.\u0275fac=function(R){return new(R||F)(g.Y36(h.$4),g.Y36(O.so,8),g.Y36(O.WI,8))},F.\u0275cmp=g.Xpm({type:F,selectors:[["app-delete-dialog"]],features:[g.qOj],decls:22,vars:11,consts:[[1,"box",2,"max-width","600px"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-5"],[1,"text-md","flex"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-6","h-6","mr-2","text-danger","flex-none"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],[1,"mr-1"],[1,"p-3","text-right"],["azt-track-service","delete-dialog-VaCVDZ-8G",1,"btn","btn-secondary","w-24","mr-2",3,"click"],["azt-track-service","delete-dialog-GpxoaJJJor",1,"btn","w-32","btn-danger",3,"disabled","click"],[4,"ngIf"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","white",1,"w-4","h-4","mr-2"],["fill","none","fill-rule","evenodd"],["transform","translate(1 1)","stroke-width","4"],["stroke-opacity",".5","cx","18","cy","18","r","18"],["d","M36 18c0-9.94-8.06-18-18-18"],["attributeName","transform","type","rotate","from","0 18 18","to","360 18 18","dur","1s","repeatCount","indefinite"]],template:function(R,A){1&R&&(g.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),g.O4$(),g.TgZ(4,"svg",4),g._UZ(5,"path",5)(6,"path",6)(7,"path",7)(8,"line",8)(9,"line",9),g.qZA(),g.kcU(),g.TgZ(10,"div")(11,"span",10),g._uU(12),g.ALo(13,"mytranslate"),g.qZA()()()()(),g.TgZ(14,"div",11)(15,"button",12),g.NdJ("click",function(){return A.btnCloseDialog()}),g._uU(16),g.ALo(17,"mytranslate"),g.qZA(),g.TgZ(18,"button",13),g.NdJ("click",function(){return A.confirmDelete()}),g.YNc(19,B,7,0,"span",14),g._uU(20),g.ALo(21,"mytranslate"),g.qZA()()()),2&R&&(g.xp6(12),g.Oqu(g.lcZ(13,5,"lang_testbank_are_you_sure_to_delete_this_exam_result")),g.xp6(4),g.hij(" ",g.lcZ(17,7,"lang_cms_common_close_btn")," "),g.xp6(2),g.Q6J("disabled",A.statusObj.loading),g.xp6(1),g.Q6J("ngIf",A.statusObj.loading),g.xp6(1),g.hij(" ",g.lcZ(21,9,"lang_cms_common_confirm_btn")," "))},dependencies:[_.O5,m.JV],encapsulation:2}),F})()},73967:(at,ue,w)=>{"use strict";w.d(ue,{p:()=>H});var O=w(19347),u=w(90241),g=w(65879),h=w(96814),_=w(23680),m=w(75986),B=w(64170),W=w(87466),F=w(98525),E=w(92596),R=w(11964);function A(ce,ge){if(1&ce&&(g.TgZ(0,"div")(1,"div",10)(2,"div",11),g._uU(3),g.qZA(),g._UZ(4,"input",12),g.qZA()()),2&ce){const Oe=g.oxw().$implicit;g.xp6(3),g.hij(" ",Oe.title," "),g.xp6(1),g.s9C("value",Oe.contents[0]),g.Q6J("disabled",!0)}}function fe(ce,ge){if(1&ce&&(g.TgZ(0,"div",17)(1,"mat-checkbox",18)(2,"span",19),g._uU(3),g.qZA()()()),2&ce){const Oe=ge.$implicit;g.xp6(1),g.Q6J("checked",!0)("disabled",!0),g.xp6(1),g.s9C("matTooltip",Oe),g.xp6(1),g.Oqu(Oe)}}function L(ce,ge){if(1&ce&&(g.TgZ(0,"div")(1,"div",13)(2,"span",14),g._uU(3),g.qZA()(),g.TgZ(4,"div",15),g.YNc(5,fe,4,4,"div",16),g.qZA()()),2&ce){const Oe=g.oxw().$implicit;g.xp6(3),g.Oqu(Oe.title),g.xp6(2),g.Q6J("ngForOf",Oe.contents)}}function U(ce,ge){if(1&ce&&(g.TgZ(0,"mat-radio-button",22)(1,"span",19),g._uU(2),g.qZA()()),2&ce){const Oe=ge.$implicit;g.Q6J("checked",!0)("disabled",!0),g.xp6(1),g.s9C("matTooltip",Oe),g.xp6(1),g.Oqu(Oe)}}function Z(ce,ge){if(1&ce&&(g.TgZ(0,"div")(1,"div",13)(2,"span",20),g._uU(3),g.qZA()(),g.TgZ(4,"mat-radio-group",15),g.YNc(5,U,3,4,"mat-radio-button",21),g.qZA()()),2&ce){const Oe=g.oxw().$implicit;g.xp6(3),g.Oqu(Oe.title),g.xp6(2),g.Q6J("ngForOf",Oe.contents)}}function le(ce,ge){if(1&ce){const Oe=g.EpF();g.TgZ(0,"div")(1,"div",10)(2,"span",20),g._uU(3),g.qZA()(),g.TgZ(4,"div",23)(5,"mat-form-field",24)(6,"mat-select",25),g.NdJ("valueChange",function(Me){g.CHM(Oe);const pt=g.oxw().$implicit;return g.KtG(pt.contents[0]=Me)}),g.TgZ(7,"mat-option",26),g._uU(8),g.qZA()()()()()}if(2&ce){const Oe=g.oxw().$implicit;g.xp6(3),g.Oqu(Oe.title),g.xp6(3),g.Q6J("value",Oe.contents[0])("disabled",!0),g.xp6(1),g.s9C("value",Oe.contents[0]),g.xp6(1),g.Oqu(Oe.contents[0])}}function P(ce,ge){if(1&ce&&(g.ynx(0,8),g.YNc(1,A,5,3,"div",9),g.YNc(2,L,6,2,"div",9),g.YNc(3,Z,6,2,"div",9),g.YNc(4,le,9,5,"div",9),g.BQk()),2&ce){const Oe=ge.$implicit;g.xp6(1),g.Q6J("ngIf",0==Oe.type),g.xp6(1),g.Q6J("ngIf",1==Oe.type),g.xp6(1),g.Q6J("ngIf",2==Oe.type),g.xp6(1),g.Q6J("ngIf",3==Oe.type)}}let H=(()=>{class ce extends u.e{constructor(Oe,qe){super(qe,Oe),this.dialogRef=Oe,this.data=qe}btnCloseDialog(){this.dialogRef.close()}ngOnInit(){super.ngOnInit()}}return ce.\u0275fac=function(Oe){return new(Oe||ce)(g.Y36(O.so,8),g.Y36(O.WI))},ce.\u0275cmp=g.Xpm({type:ce,selectors:[["app-result-info-dialog"]],features:[g.qOj],decls:12,vars:7,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],["id","test-info-form-show",1,"p-5"],[1,"text-center","mx-auto"],[1,"text-md","font-medium"],["class","info-field",4,"ngFor","ngForOf"],[1,"p-3","text-right"],["azt-track-service","result-info-dialog-NTVpa2BtGs",1,"btn","btn-secondary","w-24","mr-2",3,"click"],[1,"info-field"],[4,"ngIf"],[1,"input-group","mt-3"],[1,"input-group-text","whitespace-nowrap","font-medium",2,"min-width","100px","text-align","left"],["type","text",1,"form-control",3,"disabled","value"],[1,"input-group","w-full","mt-3"],[1,"input-group-text","w-full","align-center","font-medium",2,"vertical-align","middle","border-bottom-left-radius","0","border-bottom-right-radius","0","white-space","normal"],[1,"grid","grid-cols-12","gap-3","p-2","ml-0","mr-0","border-row"],["class","col-span-12 sm:col-span-12 md:col-span-4 text-left mb-1",4,"ngFor","ngForOf"],[1,"col-span-12","sm:col-span-12","md:col-span-4","text-left","mb-1"],["color","primary",3,"checked","disabled"],[1,"truncate",2,"vertical-align","middle","color","#1e293c",3,"matTooltip"],[1,"input-group-text","w-full","font-medium",2,"vertical-align","middle","border-bottom-left-radius","0","border-bottom-right-radius","0","white-space","normal"],["color","primary","class","col-span-12 sm:col-span-12 md:col-span-4 text-left mb-1",3,"checked","disabled",4,"ngFor","ngForOf"],["color","primary",1,"col-span-12","sm:col-span-12","md:col-span-4","text-left","mb-1",3,"checked","disabled"],[1,"border-row"],["appearance","fill",1,"border-0"],[3,"value","disabled","valueChange"],[2,"color","#1e293c",3,"value"]],template:function(Oe,qe){1&Oe&&(g.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),g._uU(5),g.ALo(6,"mytranslate"),g.qZA()(),g.YNc(7,P,5,4,"ng-container",5),g.qZA()(),g.TgZ(8,"div",6)(9,"button",7),g.NdJ("click",function(){return qe.btnCloseDialog()}),g._uU(10),g.ALo(11,"mytranslate"),g.qZA()()()),2&Oe&&(g.xp6(5),g.hij(" ",g.lcZ(6,3,"lang_testbank_test_config_verify_profile_student")," "),g.xp6(2),g.Q6J("ngForOf",qe.data),g.xp6(3),g.hij(" ",g.lcZ(11,5,"lang_auto_dong")," "))},dependencies:[h.sg,h.O5,_.ey,m.oG,B.KE,W.VQ,W.U0,F.gD,E.gM,R.JV],encapsulation:2}),ce})()},63987:(at,ue,w)=>{"use strict";w.d(ue,{C:()=>Ne});var O=w(12889),u=w(39621),g=w(44821),h=w(65879),_=w(61675),m=w(58222),B=w(42014),W=w(41715),F=w(87384),E=w(8415);const A=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",""];let fe=(()=>{class X{constructor(V,oe,pe){this.commonService=V,this.zipDataService=oe,this.cdnService=pe}drawAzotaFileToCanvas(V,oe){return new Promise((pe,Ue)=>{var rt="",Je=this.commonService.willDeleteParseJson(this.zipDataService.decodeContentGzip(V.images??""));Je&&Je.url&&Je.url.includes(".azt")?this.httpGetAsync(this.cdnService.getMyCdn(Je.url)).then(xt=>{xt&&xt.length>0?B.decodeScanOfflineFile(xt).then(De=>{let wt=this._arrayBufferToBase64(De.getWrappedImage()??new Uint8Array),Ae=De.getWrappedImageExtension(),ne=De.scanOfflineData?.scanResult;if(wt){let Y=new Image;Y.src="data:image/"+Ae+";base64,"+wt,Y.crossOrigin="anonymous",Y.onload=()=>{var ae=document.createElement("canvas");ae.width=Y.width,ae.height=Y.height;const $=ae.getContext("2d");$?.drawImage(Y,0,0,ae.width,ae.height);let Se=V.resultsData?.answerObjs??[];if(ne?.examCodeRegion?.circles&&ne?.examCodeRegion?.circles.length>0&&this.drawCommonCircles(ne?.examCodeRegion?.circles,$),ne?.studentCodeRegion?.circles&&ne?.studentCodeRegion?.circles.length>0&&this.drawCommonCircles(ne?.studentCodeRegion?.circles,$),ne?.answerRegion?.circles&&ne?.answerRegion?.circles.length>0&&this.drawCircles(ne?.answerRegion?.circles,$,Se),ne?.answerRegion?.essayCircles&&ne?.answerRegion?.essayCircles.length>0&&oe&&this.drawCommonCircles(ne?.answerRegion?.essayCircles,$),ne?.answerRegion?.handwrittenAnswers&&ne?.answerRegion?.handwrittenAnswers.length>0){let ee=ne?.answerRegion?.handwrittenAnswers,Pe="18px";if($){$.fillStyle="#00ff00",$.font=Pe+" Comic Sans MS",$.textAlign="center";for(let q=0;q<ee.length;q++){let ie=ee[q];this.fillTextAnswerDrawForFileAzt(ie.recognizedText??"",$,Se[q],((ie.bottomRight.x??0)+(ie.topLeft.x??0))/2-3,((ie.bottomRight.y??0)+(ie.topLeft.y??0))/2+5)}}}rt=ae.toDataURL("image/jpeg",.9),pe({imgUrl:rt,studentCode:Number(ne?.studentCode),subExamCode:Number(ne?.subExamCode)})}}else pe({imgUrl:rt,studentCode:Number(ne?.studentCode),subExamCode:Number(ne?.subExamCode)})}):pe({imgUrl:rt,studentCode:0,subExamCode:0})}).catch(xt=>{Ue(xt)}):pe({imgUrl:rt,studentCode:0,subExamCode:0})})}drawScanFileToCanvas(V){return new Promise(oe=>{var pe="",Ue=this.commonService.willDeleteParseJson(this.zipDataService.decodeContentGzip(V.images??""));let rt=Ue?this.cdnService.getMyCdn(Ue.url):"";if(Ue&&rt){let Je=new Image;Je.src=rt,Je.crossOrigin="anonymous",Je.onload=()=>{var xt=document.createElement("canvas");xt.width=Je.width,xt.height=Je.height;const De=xt.getContext("2d");De?.drawImage(Je,0,0,xt.width,xt.height);var wt=V.resultsData?.answerObjs??[],Ae=this.commonService.willDeleteParseJson(V.resultsData?.pos??"");if("2.0"==Ae.version)try{let Ce=Uint8Array.from(atob(Ae.resultFilledPos),He=>He.charCodeAt(0)),be=new W.cS(Ce).parseDrawData(),nt=be.studentId?.answers??[];for(var ne=0;ne<nt.length;ne++)this.tickStudentIdAndExamId(nt[ne],De,be.answerTable?.radius??0);let Ve=be.examId?.answers??[];for(ne=0;ne<Ve.length;ne++)this.tickStudentIdAndExamId(Ve[ne],De,be.answerTable?.radius??0);let Ze=be.answerTable?.answers??[];for(ne=0;ne<Ze.length;ne++)this.answerPaintedRightOrWrong(Ze[ne],De,be.answerTable?.radius??0,wt);pe=xt.toDataURL("image/jpeg",.9),oe(pe)}catch{this.commonService.snackError("lang_auto_du_lieu_sai_khong_su_ly_duoc_anh_bai_thi_offline"),oe("")}else if("3.0"==Ae.version)try{let Ce=Ae.answersHandwritten??[],be=(Ce[0].answerRegion.height??0)-20+"px";if(De){De.fillStyle="#00ff00",De.font=be+" Comic Sans MS",De.textAlign="center";for(let Ve=0;Ve<Ce.length;Ve++){let Ze=Ce[Ve],$e=this.getTextAnswerDraw(A[-1==Ze.answer?26:Ze.answer],De,wt[Ve]);De.fillText($e,(Ze.answerRegion.x??0)+(Ze.answerRegion.width??0)/2,(Ze.answerRegion.y??0)+(Ze.answerRegion.height??0)/2+5)}}pe=xt.toDataURL("image/jpeg",.9),oe(pe)}catch{this.commonService.snackError("lang_auto_du_lieu_sai_khong_su_ly_duoc_anh_bai_thi_offline"),oe("")}else{var Y=Ae.configurationPos.split("_"),ae=Ae.resultFilledPos.split("_"),$=Ae.tableAnchorPos.split("_"),Se=this.checkWrongOrTrueAnswer(wt),ee=0;for(ne=0;ne<Y.length;ne++)if(1==ne||2==ne){var Pe=Y[ne].split("*");ee+=parseInt(Pe[1],10)}var K=0;for(ne=0;ne<$.length;ne++)if(ne>=2){var q={},ie={},ye=$[ne].split("*"),ze=ye[0].split(":"),k=ye[1].split(":"),Re={},y=Y[ne].split("*");Re.row=parseInt(y[0],10),Re.col=parseInt(y[1],10),Re.radius=parseInt(y[2],10),q.x=parseInt(ze[0],10),q.y=parseInt(ze[1],10),ie.x=parseInt(k[0],10),ie.y=parseInt(k[1],10);for(var S=(ie.y-q.y)/(Re.row+1),D=q.y,j=0;j<Re.row;j++)if((D+=S)>q.y&&D<ie.y){var de=K<wt.length?this.checkAnswerStudentRight(K,wt):0;K++,0!=de&&De&&(De.beginPath(),De.arc(q.x+S*de,D,Re.radius,0,2*Math.PI,!1),De.lineWidth=3,De.strokeStyle="#f3c12c",De.stroke())}}var J=0;for(j=0;j<ae.length;j++)if("empty"!=ae[j]){var me=ae[j].split(":"),je={x:parseInt(me[0],10),y:parseInt(me[1],10),line:parseInt(me[2],10)};j<ee+Se.length&&(j>=ee?(De&&(De.beginPath(),De.arc(je.x,je.y,je.line,0,2*Math.PI,!1),De.lineWidth=3,De.strokeStyle=Se[J],De.stroke()),J++):De&&(De.beginPath(),De.arc(je.x,je.y,je.line,0,2*Math.PI,!1),De.lineWidth=3,De.strokeStyle="#00ff00",De.stroke()))}pe=xt.toDataURL("image/jpeg",.9),oe(pe)}}}else oe("")})}_arrayBufferToBase64(V){for(var oe="",pe=new Uint8Array(V),Ue=pe.byteLength,rt=0;rt<Ue;rt++)oe+=String.fromCharCode(pe[rt]);return window.btoa(oe)}httpGetAsync(V){return new Promise((oe,pe)=>{try{const Ue=new XMLHttpRequest;Ue.open("GET",V,!0),Ue.responseType="arraybuffer",Ue.onload=rt=>{if(200===Ue.status||304===Ue.status){const Je=Ue.response;if(Je){const xt=new Uint8Array(Je);oe(xt)}else oe(new Uint8Array)}else oe(new Uint8Array)},Ue.onerror=rt=>{pe(new Error("lang_core_cant_loading_url"))},Ue.send(null)}catch(Ue){pe(Ue)}})}fillTextAnswerDrawForFileAzt(V,oe,pe,Ue,rt){let Je="";pe&&(V?pe.rightAnswer&&"ESSAY"!=pe.content&&pe.rightAnswer!=V?(oe.fillStyle="#f3c12c",oe.fillText("["+pe.rightAnswer+"]",Ue+15,rt),oe.fillStyle="red",Je=V+"-",Ue-=10):pe.rightAnswer&&"ESSAY"!=pe.content?(oe.fillStyle="#00ff00",Je+=V):(oe.fillStyle="red",Je+=V):(oe.fillStyle="#f3c12c",Je+=pe.rightAnswer)),oe.fillText(Je,Ue,rt)}drawCommonCircles(V,oe){V.length>0&&V.forEach(pe=>{if(pe.filled){let Ue=pe.center.x,rt=pe.center.y;oe&&(oe.beginPath(),oe.arc(Ue,rt,pe.radius+1,0,2*Math.PI,!1),oe.lineWidth=2,oe.strokeStyle="#00ff00",oe.stroke())}})}drawCircles(V,oe,pe){let Ue=[],rt=[];if(pe.length>0)for(let Je=0;Je<pe.length;Je++){let xt=Je+1+""+pe[Je].rightAnswer;this.commonService.filterArray(Ue,xt)||Ue.push(xt),"ESSAY"==pe[Je].content&&rt.push(Je+1)}V.forEach(Je=>{let xt=Number(Je.label.substring(0,Je.label.length-1)),De="";if(0==Ue.length?De="#00ff00":this.commonService.filterArray(Ue,Je.label)?De=Je.filled?"#00ff00":"#f3c12c":Je.filled&&(De="red"),De&&xt<=pe.length&&!this.commonService.filterArray(rt,xt)){let wt=Je.center.x,Ae=Je.center.y;oe&&(oe.beginPath(),oe.arc(wt,Ae,Je.radius+1,0,2*Math.PI,!1),oe.lineWidth=2,oe.strokeStyle=De,oe.stroke())}})}checkAnswerStudentRight(V,oe){var pe=0;return oe[V]&&""!=oe[V].rightAnswer&&0==oe[V].isRight&&(pe="A"==oe[V].rightAnswer?1:"B"==oe[V].rightAnswer?2:"C"==oe[V].rightAnswer?3:"D"==oe[V].rightAnswer?4:"E"==oe[V].rightAnswer?5:"F"==oe[V].rightAnswer?6:"G"==oe[V].rightAnswer?7:"H"==oe[V].rightAnswer?8:0),pe}checkWrongOrTrueAnswer(V){for(var oe=[],pe=0;pe<V.length;pe++)""!=V[pe].content&&(1==V[pe].isRight?oe.push("#00ff00"):0==V[pe].isRight&&oe.push("red"));return oe}tickStudentIdAndExamId(V,oe,pe){var Ue=256*Math.floor((V.position??0)/16)+V.x,rt=(V.position??0)%16*256+V.y;(V.filledCols??0)>=128&&oe&&(oe.beginPath(),oe.arc(Ue,rt,pe,0,2*Math.PI,!1),oe.lineWidth=3,oe.strokeStyle="#00ff00",oe.stroke())}answerPaintedRightOrWrong(V,oe,pe,Ue){var rt=256*Math.floor((V.position??0)/16)+V.x,Je=(V.position??0)%16*256+V.y,xt=V.rows??0,wt="#fff0";Ue.length>xt&&((V.filledCols??0)>=128?wt=1==Ue[xt].isRight?"#00ff00":"red":(V.filledCols??0)%128+1==this.checkAnswerStudentRight(xt,Ue)&&(wt="#f3c12c"),oe&&(oe.beginPath(),oe.arc(rt,Je,pe,0,2*Math.PI,!1),oe.lineWidth=3,oe.strokeStyle=wt,oe.stroke()))}getTextAnswerDraw(V,oe,pe){let Ue="";return pe&&(V?pe.isRight?(oe.fillStyle="#00ff00",Ue+=V):(oe.fillStyle="red",Ue=V+" - ["+pe.rightAnswer+"]"):(oe.fillStyle="#f3c12c",Ue+=pe.rightAnswer)),Ue}}return X.\u0275fac=function(V){return new(V||X)(h.LFG(F.z),h.LFG(m.a),h.LFG(E.E))},X.\u0275prov=h.Yz7({token:X,factory:X.\u0275fac,providedIn:"root"}),X})();var L=w(96814),U=w(92596),Z=w(11964);function le(X,Be){if(1&X){const V=h.EpF();h.TgZ(0,"div")(1,"a",15),h.NdJ("click",function(){h.CHM(V);const pe=h.oxw(2);let Ue;return h.KtG(pe.deleteOfflineExamResultObj(null!==(Ue=null==pe.examObj?null:pe.examObj.hashId)&&void 0!==Ue?Ue:"",pe.examResultIdParam))}),h.O4$(),h.TgZ(2,"svg",16),h._UZ(3,"path",17)(4,"path",18)(5,"path",19)(6,"line",20)(7,"line",21),h.qZA(),h._uU(8),h.ALo(9,"mytranslate"),h.qZA()()}2&X&&(h.xp6(8),h.hij(" ",h.lcZ(9,1,"lang_auto_xoa")," "))}function P(X,Be){1&X&&(h.TgZ(0,"span",22),h._uU(1),h.ALo(2,"mytranslate"),h.qZA()),2&X&&(h.xp6(1),h.hij("",h.lcZ(2,1,"lang_auto_anh_cham"),": "))}function H(X,Be){1&X&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"mytranslate"),h.qZA()),2&X&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"lang_auto_luu_trong_app_mobile")))}function ce(X,Be){1&X&&(h.ynx(0),h.TgZ(1,"span"),h._uU(2),h.ALo(3,"mytranslate"),h.qZA(),h.BQk()),2&X&&(h.xp6(2),h.Oqu(h.lcZ(3,1,"lang_test_review_error_get_url_img")))}function ge(X,Be){1&X&&(h.O4$(),h.TgZ(0,"svg",29)(1,"g",30)(2,"g",31),h._UZ(3,"circle",32),h.TgZ(4,"path",33),h._UZ(5,"animateTransform",34),h.qZA()()()())}function Oe(X,Be){if(1&X&&h._UZ(0,"img",35),2&X){const V=h.oxw(4);h.Akn(V.isMobileWebView?"width: 100% !important;":"height: auto !important;"),h.Q6J("src",V.fileScanUrl,h.LSH)}}function qe(X,Be){if(1&X){const V=h.EpF();h.TgZ(0,"a",26),h.NdJ("click",function(){h.CHM(V);const pe=h.oxw(3);return h.KtG(pe.onShowFile(pe.fileScanUrl))}),h.YNc(1,ge,6,0,"svg",27),h.YNc(2,Oe,1,3,"img",28),h.qZA()}if(2&X){const V=h.oxw(3);h.xp6(1),h.Q6J("ngIf",V.loadingScanUrl),h.xp6(1),h.Q6J("ngIf",!V.loadingScanUrl)}}function Me(X,Be){if(1&X&&(h.TgZ(0,"div",23),h.YNc(1,ce,4,3,"ng-container",24),h.YNc(2,qe,3,2,"ng-template",null,25,h.W1O),h.qZA()),2&X){const V=h.MAs(3),oe=h.oxw(2);h.xp6(1),h.Q6J("ngIf",!oe.loadingScanUrl&&!oe.fileScanUrl)("ngIfElse",V)}}function pt(X,Be){if(1&X&&(h.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"h3",6)(4,"span"),h._uU(5),h.ALo(6,"mytranslate"),h.qZA()(),h.YNc(7,le,10,3,"div",7),h.qZA()(),h.TgZ(8,"div",8)(9,"div",5)(10,"span",9),h.GkF(11,10),h.qZA(),h.TgZ(12,"span",11),h.ALo(13,"mytranslate"),h.GkF(14,10),h.qZA()(),h.TgZ(15,"div",12),h.YNc(16,P,3,3,"span",13),h.YNc(17,H,3,3,"span",7),h.qZA(),h.YNc(18,Me,4,2,"div",14),h.qZA()()),2&X){const V=h.oxw(),oe=h.MAs(2),pe=h.MAs(4);h.xp6(5),h.hij(" ",h.lcZ(6,8,"lang_auto_thi_offline")," "),h.xp6(2),h.Q6J("ngIf",V.isDeletableExamResultObj),h.xp6(4),h.Q6J("ngTemplateOutlet",oe),h.xp6(1),h.s9C("matTooltip",h.lcZ(13,10,"lang_auto_so_bao_danh")),h.xp6(2),h.Q6J("ngTemplateOutlet",pe),h.xp6(2),h.Q6J("ngIf",!V.isMobileWebView),h.xp6(1),h.Q6J("ngIf",!V.checkHttpLinkImg),h.xp6(1),h.Q6J("ngIf",V.checkHttpLinkImg)}}const Fe=function(X){return{"text-success":X}};function ht(X,Be){if(1&X&&(h._uU(0),h.ALo(1,"mytranslate"),h.TgZ(2,"span",36),h._uU(3),h.ALo(4,"formatOfflineExamHashIdToNumber"),h.qZA()),2&X){const V=h.oxw();let oe;h.hij(" ",h.lcZ(1,3,"lang_auto_ma_de_thi"),":\xa0 "),h.xp6(2),h.Q6J("ngClass",h.VKq(8,Fe,!(null!=V.offlineMarkObj&&V.offlineMarkObj.isErrorForOfflineMixQuestionHashId))),h.xp6(1),h.Oqu(h.xi3(4,5,null!==(oe=null==V.offlineMixQuestionObj?null:V.offlineMixQuestionObj.hashId)&&void 0!==oe?oe:0,3))}}function we(X,Be){if(1&X&&(h._uU(0),h.ALo(1,"mytranslate"),h.TgZ(2,"span",36),h._uU(3),h.ALo(4,"formatStudentCodeToNumber"),h.qZA()),2&X){const V=h.oxw();let oe;h.hij(" ",h.lcZ(1,3,"lang_testbank_offline_student_identification"),":\xa0 "),h.xp6(2),h.Q6J("ngClass",h.VKq(8,Fe,!(null!=V.offlineMarkObj&&V.offlineMarkObj.isErrorForStudentCode))),h.xp6(1),h.Oqu(h.xi3(4,5,(null!==(oe=null==V.offlineMarkObj?null:V.offlineMarkObj.studentCode)&&void 0!==oe?oe:0)<0?0:null==V.offlineMarkObj?null:V.offlineMarkObj.studentCode,6))}}let Ne=(()=>{class X extends u.Q{checkAzotaFile(V){return!(!V||!V.includes(".azt"))}checkHttpUrl(V){return!!V&&!!/(?:https?):\/\/(\w+:?\w*)?(\S+)(:\d+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/.test(V)}deleteOfflineExamResultObj(V,oe){oe&&this.sAztDialogService.open(g.z,{data:{examHashId:V,examResultId:oe},restoreFocus:!1}).afterClosed().subscribe(Ue=>{Ue&&this.goBackWhenDeleteExamResult()})}goBackWhenDeleteExamResult(){this.myNavigationBySpecialQueryString(this.backToLink?this.backToLink:"/admin/testbank/exam-results-list/"+(this.examObj?this.examObj.categoryId:0)+"/"+this.examIdParam+"/0")}onShowFile(V){this.sAztDialogService.open(O.q,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",data:{fileOption:{name:"",mimes:"image/jpeg",url:V,index:0}},restoreFocus:!1})}checkErrorForStudentAndExamCode(){this.examCodeError=!this.offlineMixQuestionObj&&(this.offlineMarkObj?.rawOfflineMixquestionId??0)>0,this.studentCodeError=(this.offlineMarkObj?.studentId??0)<=0&&(this.offlineMarkObj?.rawStudentCode??0)>0}initData(){if(!this.offlineMarkObj)return;let V=this.zipDataService.decodeContentGzip(this.offlineMarkObj?.images??""),oe=this.castJsonToObj(V);this.checkHttpLinkImg=this.checkHttpUrl(oe?.url),this.loadingScanUrl=!0,this.checkAzotaFile(oe?.url)?this.drawScanExamService.drawAzotaFileToCanvas(this.offlineMarkObj,this.essayExam).then(pe=>{pe.imgUrl?this.fileScanUrl=pe.imgUrl:this.checkHttpLinkImg=!0,this.loadingScanUrl=!1}).catch(pe=>{this.loadingScanUrl=!1}):this.drawScanExamService.drawScanFileToCanvas(this.offlineMarkObj).then(pe=>{pe?this.fileScanUrl=pe:this.checkHttpLinkImg=!0,this.loadingScanUrl=!1}).catch(pe=>{this.loadingScanUrl=!1})}ngOnChanges(){this.initData(),this.checkErrorForStudentAndExamCode()}ngOnInit(){super.ngOnInit()}constructor(V,oe,pe){super(),this.sAztDialogService=V,this.zipDataService=oe,this.drawScanExamService=pe,this.backToLink="",this.essayExam=!1,this.isDeletableExamResultObj=!1,this.fileScanUrl="",this.loadingScanUrl=!1,this.checkHttpLinkImg=!1,this.studentCodeError=!1,this.examCodeError=!1}}return X.\u0275fac=function(V){return new(V||X)(h.Y36(_.C),h.Y36(m.a),h.Y36(fe))},X.\u0275cmp=h.Xpm({type:X,selectors:[["app-testbank-show-offline-result"]],inputs:{backToLink:"backToLink",examResultIdParam:"examResultIdParam",userIdParam:"userIdParam",studentIdParam:"studentIdParam",examIdParam:"examIdParam",essayExam:"essayExam",examObj:"examObj",offlineMarkObj:"offlineMarkObj",offlineMixQuestionObj:"offlineMixQuestionObj",isDeletableExamResultObj:"isDeletableExamResultObj"},features:[h.qOj,h.TTD],decls:5,vars:1,consts:[["class","info-exam-offline mt-3 mb-3",4,"ngIf"],["viewExamCodeTpl",""],["viewStudentCodeTpl",""],[1,"info-exam-offline","mt-3","mb-3"],[1,"rounded-md","bg-slate-200","dark:bg-darkmode-400","p-3",2,"border-bottom-left-radius","0","border-bottom-right-radius","0"],[1,"flex","items-center"],[1,"text-md","mr-auto"],[4,"ngIf"],[1,"info-exam-body","rounded-md","border","border-slate-200/60","dark:border-darkmode-400","p-2",2,"border-top-left-radius","0","border-top-right-radius","0"],[1,"mr-auto"],[3,"ngTemplateOutlet"],[1,"mr-4",3,"matTooltip"],[1,"items-center","mt-2"],["class","mr-2",4,"ngIf"],["class","text-center mx-auto mt-1",4,"ngIf"],["azt-track-service","show-offline-result-i96BCircs2",1,"text-danger",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],[1,"mr-2"],[1,"text-center","mx-auto","mt-1"],[4,"ngIf","ngIfElse"],["showImgScan",""],["azt-track-service","show-offline-result-tsC_51kcf2",3,"click"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","rgb(30, 41, 59)","class","w-5 h-5 mr-3",4,"ngIf"],["alt","img",3,"src","style",4,"ngIf"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","rgb(30, 41, 59)",1,"w-5","h-5","mr-3"],["fill","none","fill-rule","evenodd"],["transform","translate(1 1)","stroke-width","4"],["stroke-opacity",".5","cx","18","cy","18","r","18"],["d","M36 18c0-9.94-8.06-18-18-18"],["attributeName","transform","type","rotate","from","0 18 18","to","360 18 18","dur","1s","repeatCount","indefinite"],["alt","img",3,"src"],[3,"ngClass"]],template:function(V,oe){1&V&&(h.YNc(0,pt,19,12,"div",0),h.YNc(1,ht,5,10,"ng-template",null,1,h.W1O),h.YNc(3,we,5,10,"ng-template",null,2,h.W1O)),2&V&&h.Q6J("ngIf",oe.offlineMarkObj)},dependencies:[L.mk,L.O5,L.tP,U.gM,Z.JV,Z.gw,Z.Aw],encapsulation:2}),X})()},11343:(at,ue,w)=>{"use strict";w.d(ue,{C:()=>g});var O=w(65879);let u=(()=>{class h{constructor(){this.observer=new IntersectionObserver(m=>{m.forEach(B=>{const W=B.target;B.isIntersecting?(this.reUpdateHeightAttribute(W),W.setAttribute("start_loading","true")):W.setAttribute("start_loading","false")})})}reUpdateHeightAttribute(m){const B=m.getBoundingClientRect();B.height>0&&m.setAttribute("data-current-height",B.height+"px")}observe(m){this.observer.observe(m)}}return h.\u0275fac=function(m){return new(m||h)},h.\u0275prov=O.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})(),g=(()=>{class h{constructor(m,B){this.injector=m,this.el=B;const W=this.el.nativeElement;this.injector.get(u).observe(W)}}return h.\u0275fac=function(m){return new(m||h)(O.Y36(O.zs3),O.Y36(O.SBq))},h.\u0275dir=O.lG2({type:h,selectors:[["","load_effect_lazy",""]]}),h})()},98914:(at,ue,w)=>{"use strict";w.d(ue,{s:()=>e_});var E,O=w(49671),u=w(33182),g=w(60752),h=w(24303),_=w(84537),m=w(87879),B=w(59058),W=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},F={},R=R||{},A=W||self;function fe(){}function L(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function U(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var le="closure_uid_"+(1e9*Math.random()>>>0),P=0;function H(n,e,t){return n.call.apply(n.bind,arguments)}function ce(n,e,t){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,i),n.apply(e,s)}}return function(){return n.apply(e,arguments)}}function ge(n,e,t){return(ge=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?H:ce).apply(null,arguments)}function Oe(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function qe(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(i,s,a){for(var l=Array(arguments.length-2),d=2;d<arguments.length;d++)l[d-2]=arguments[d];return e.prototype[s].apply(i,l)}}function Me(){this.s=this.s,this.o=this.o}Me.prototype.s=!1,Me.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function Z(n){Object.prototype.hasOwnProperty.call(n,le)&&n[le]||(n[le]=++P)}(this)},Me.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Fe=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function ht(n){const e=n.length;if(0<e){const t=Array(e);for(let i=0;i<e;i++)t[i]=n[i];return t}return[]}function we(n,e){for(let t=1;t<arguments.length;t++){const i=arguments[t];if(L(i)){const s=n.length||0,a=i.length||0;n.length=s+a;for(let l=0;l<a;l++)n[s+l]=i[l]}else n.push(i)}}function Ne(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Ne.prototype.h=function(){this.defaultPrevented=!0};var X=function(){if(!A.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{A.addEventListener("test",fe,e),A.removeEventListener("test",fe,e)}catch{}return n}();function Be(n){return/^[\s\xa0]*$/.test(n)}var V=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function oe(n,e){return n<e?-1:n>e?1:0}function pe(){var n=A.navigator;return n&&(n=n.userAgent)?n:""}function Ue(n){return-1!=pe().indexOf(n)}function rt(n){return rt[" "](n),n}rt[" "]=fe;var $,n,xt=Ue("Opera"),De=Ue("Trident")||Ue("MSIE"),wt=Ue("Edge"),Ae=wt||De,ne=Ue("Gecko")&&!(-1!=pe().toLowerCase().indexOf("webkit")&&!Ue("Edge"))&&!(Ue("Trident")||Ue("MSIE"))&&!Ue("Edge"),Y=-1!=pe().toLowerCase().indexOf("webkit")&&!Ue("Edge");function ae(){var n=A.document;return n?n.documentMode:void 0}e:{var Se="",ee=(n=pe(),ne?/rv:([^\);]+)(\)|;)/.exec(n):wt?/Edge\/([\d\.]+)/.exec(n):De?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Y?/WebKit\/(\S+)/.exec(n):xt?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(ee&&(Se=ee?ee[1]:""),De){var Pe=ae();if(null!=Pe&&Pe>parseFloat(Se)){$=String(Pe);break e}}$=Se}var K={};var ze=A.document&&De&&(ae()||parseInt($,10))||void 0;function k(n,e){if(Ne.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(ne){e:{try{rt(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Re[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&k.X.h.call(this)}}qe(k,Ne);var Re={2:"touch",3:"pen",4:"mouse"};k.prototype.h=function(){k.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var y="closure_listenable_"+(1e6*Math.random()|0),S=0;function D(n,e,t,i,s){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!i,this.ha=s,this.key=++S,this.ba=this.ea=!1}function j(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function de(n,e,t){for(const i in n)e.call(t,n[i],i,n)}function J(n){const e={};for(const t in n)e[t]=n[t];return e}const me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function je(n,e){let t,i;for(let s=1;s<arguments.length;s++){for(t in i=arguments[s],i)n[t]=i[t];for(let a=0;a<me.length;a++)t=me[a],Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}}function Ce(n){this.src=n,this.g={},this.h=0}function be(n,e){var t=e.type;if(t in n.g){var a,i=n.g[t],s=Fe(i,e);(a=0<=s)&&Array.prototype.splice.call(i,s,1),a&&(j(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function nt(n,e,t,i){for(var s=0;s<n.length;++s){var a=n[s];if(!a.ba&&a.listener==e&&a.capture==!!t&&a.ha==i)return s}return-1}Ce.prototype.add=function(n,e,t,i,s){var a=n.toString();(n=this.g[a])||(n=this.g[a]=[],this.h++);var l=nt(n,e,i,s);return-1<l?(e=n[l],t||(e.ea=!1)):((e=new D(e,this.src,a,!!i,s)).ea=t,n.push(e)),e};var Ve="closure_lm_"+(1e6*Math.random()|0),Ze={};function He(n,e,t,i,s){if(i&&i.once)return zt(n,e,t,i,s);if(Array.isArray(e)){for(var a=0;a<e.length;a++)He(n,e[a],t,i,s);return null}return t=Gs(t),n&&n[y]?n.N(e,t,U(i)?!!i.capture:!!i,s):$e(n,e,t,!1,i,s)}function $e(n,e,t,i,s,a){if(!e)throw Error("Invalid event type");var l=U(s)?!!s.capture:!!s,d=$i(n);if(d||(n[Ve]=d=new Ce(n)),(t=d.add(e,t,i,l,a)).proxy)return t;if(i=function Kt(){const e=Ws;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=i,i.src=n,i.listener=t,n.addEventListener)X||(s=l),void 0===s&&(s=!1),n.addEventListener(e.toString(),i,s);else if(n.attachEvent)n.attachEvent(ci(e.toString()),i);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(i)}return t}function zt(n,e,t,i,s){if(Array.isArray(e)){for(var a=0;a<e.length;a++)zt(n,e[a],t,i,s);return null}return t=Gs(t),n&&n[y]?n.O(e,t,U(i)?!!i.capture:!!i,s):$e(n,e,t,!0,i,s)}function Rt(n,e,t,i,s){if(Array.isArray(e))for(var a=0;a<e.length;a++)Rt(n,e[a],t,i,s);else i=U(i)?!!i.capture:!!i,t=Gs(t),n&&n[y]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=nt(a=n.g[e],t,i,s))&&(j(a[t]),Array.prototype.splice.call(a,t,1),0==a.length&&(delete n.g[e],n.h--))):n&&(n=$i(n))&&(e=n.g[e.toString()],n=-1,e&&(n=nt(e,t,i,s)),(t=-1<n?e[n]:null)&&ln(t))}function ln(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[y])be(e.i,n);else{var t=n.type,i=n.proxy;e.removeEventListener?e.removeEventListener(t,i,n.capture):e.detachEvent?e.detachEvent(ci(t),i):e.addListener&&e.removeListener&&e.removeListener(i),(t=$i(e))?(be(t,n),0==t.h&&(t.src=null,e[Ve]=null)):j(n)}}}function ci(n){return n in Ze?Ze[n]:Ze[n]="on"+n}function Ws(n,e){if(n.ba)n=!0;else{e=new k(e,this);var t=n.listener,i=n.ha||n.src;n.ea&&ln(n),n=t.call(i,e)}return n}function $i(n){return(n=n[Ve])instanceof Ce?n:null}var Qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gs(n){return"function"==typeof n?n:(n[Qt]||(n[Qt]=function(e){return n.handleEvent(e)}),n[Qt])}function gn(){Me.call(this),this.i=new Ce(this),this.P=this,this.I=null}function _n(n,e){var t,i=n.I;if(i)for(t=[];i;i=i.I)t.push(i);if(n=n.P,i=e.type||e,"string"==typeof e)e=new Ne(e,n);else if(e instanceof Ne)e.target=e.target||n;else{var s=e;je(e=new Ne(i,n),s)}if(s=!0,t)for(var a=t.length-1;0<=a;a--){var l=e.g=t[a];s=ki(l,i,!0,e)&&s}if(s=ki(l=e.g=n,i,!0,e)&&s,s=ki(l,i,!1,e)&&s,t)for(a=0;a<t.length;a++)s=ki(l=e.g=t[a],i,!1,e)&&s}function ki(n,e,t,i){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,a=0;a<e.length;++a){var l=e[a];if(l&&!l.ba&&l.capture==t){var d=l.listener,p=l.ha||l.src;l.ea&&be(n.i,l),s=!1!==d.call(p,i)&&s}}return s&&!i.defaultPrevented}qe(gn,Me),gn.prototype[y]=!0,gn.prototype.removeEventListener=function(n,e,t,i){Rt(this,n,e,t,i)},gn.prototype.M=function(){if(gn.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],i=0;i<t.length;i++)j(t[i]);delete n.g[e],n.h--}}this.I=null},gn.prototype.N=function(n,e,t,i){return this.i.add(String(n),e,!1,t,i)},gn.prototype.O=function(n,e,t,i){return this.i.add(String(n),e,!0,t,i)};var ns=A.JSON.stringify;function Ks(){var n=_h;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Rl,rs=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new wi,n=>n.reset());class wi{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Js(n){A.setTimeout(()=>{throw n},0)}function aa(n,e){Rl||function Hf(){var n=A.Promise.resolve(void 0);Rl=function(){n.then(Xf)}}(),Ll||(Rl(),Ll=!0),_h.add(n,e)}var Ll=!1,_h=new class is{constructor(){this.h=this.g=null}add(e,t){const i=rs.get();i.set(e,t),this.h?this.h.next=i:this.g=i,this.h=i}};function Xf(){for(var n;n=Ks();){try{n.h.call(n.g)}catch(t){Js(t)}var e=rs;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Ll=!1}function la(n,e){gn.call(this),this.h=n||1,this.g=e||A,this.j=ge(this.lb,this),this.l=Date.now()}function Fl(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function Nl(n,e,t){if("function"==typeof n)t&&(n=ge(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=ge(n.handleEvent,n)}return 2147483647<Number(e)?-1:A.setTimeout(n,e||0)}function ql(n){n.g=Nl(()=>{n.g=null,n.i&&(n.i=!1,ql(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}qe(la,gn),(E=la.prototype).ca=!1,E.R=null,E.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),_n(this,"tick"),this.ca&&(Fl(this),this.start()))}},E.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},E.M=function(){la.X.M.call(this),Fl(this),delete this.g};class ep extends Me{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:ql(this)}M(){super.M(),this.g&&(A.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $s(n){Me.call(this),this.h=n,this.g={}}qe($s,Me);var xh=[];function vh(n,e,t,i){Array.isArray(t)||(t&&(xh[0]=t.toString()),t=xh);for(var s=0;s<t.length;s++){var a=He(e,t[s],i||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function yh(n){de(n.g,function(e,t){this.g.hasOwnProperty(t)&&ln(e)},n),n.g={}}function ca(){this.g=!0}function Di(n,e,t,i){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function ip(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var i=t[n];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var a=s[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var l=1;l<s.length;l++)s[l]=""}}}return ns(t)}catch{return e}}(n,t)+(i?" "+i:"")})}$s.prototype.M=function(){$s.X.M.call(this),yh(this)},$s.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ca.prototype.Aa=function(){this.g=!1},ca.prototype.info=function(){};var Sr={},jl=null;function Ys(){return jl=jl||new gn}function Bl(n){Ne.call(this,Sr.Pa,n)}function Hs(n){const e=Ys();_n(e,new Bl(e))}function wh(n,e){Ne.call(this,Sr.STAT_EVENT,n),this.stat=e}function Nn(n){const e=Ys();_n(e,new wh(e,n))}function bh(n,e){Ne.call(this,Sr.Qa,n),this.size=e}function ss(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return A.setTimeout(function(){n()},e)}Sr.Pa="serverreachability",qe(Bl,Ne),Sr.STAT_EVENT="statevent",qe(wh,Ne),Sr.Qa="timingevent",qe(bh,Ne);var Xs={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},Ul={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function eo(){}function zl(){}eo.prototype.h=null;var da,Yi={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function ha(){Ne.call(this,"d")}function Zl(){Ne.call(this,"c")}function to(){}function Mr(n,e,t,i){this.l=n,this.j=e,this.m=t,this.U=i||1,this.S=new $s(this),this.O=Th,this.T=new la(n=Ae?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Oh}function Oh(){this.i=null,this.g="",this.h=!1}qe(ha,Ne),qe(Zl,Ne),qe(to,eo),to.prototype.g=function(){return new XMLHttpRequest},to.prototype.i=function(){return{}},da=new to;var Th=45e3,no={},os={};function Hi(n,e,t){n.K=1,n.v=Lt(Li(e)),n.s=t,n.P=!0,Ql(n,null)}function Ql(n,e){n.F=Date.now(),as(n),n.A=Li(n.v);var t=n.A,i=n.U;Array.isArray(i)||(i=[String(i)]),Jl(t.i,"t",i),n.C=0,t=n.l.H,n.h=new Oh,n.g=Vh(n.l,t?e:null,!n.s),0<n.N&&(n.L=new ep(ge(n.La,n,n.g),n.N)),vh(n.S,n.g,"readystatechange",n.ib),e=n.H?J(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),Hs(),function ua(n,e,t,i,s,a){n.info(function(){if(n.g)if(a)for(var l="",d=a.split("&"),p=0;p<d.length;p++){var x=d[p].split("=");if(1<x.length){var b=x[0];x=x[1];var I=b.split("_");l=2<=I.length&&"type"==I[1]?l+(b+"=")+x+"&":l+(b+"=redacted&")}}else l=null;else l=a;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+e+"\n"+t+"\n"+l})}(n.j,n.u,n.A,n.m,n.U,n.s)}function Vl(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function Ah(n,e,t){let s,i=!0;for(;!n.I&&n.C<t.length;){if(s=Ih(n,t),s==os){4==e&&(n.o=4,Nn(14),i=!1),Di(n.j,n.m,null,"[Incomplete Response]");break}if(s==no){n.o=4,Nn(15),Di(n.j,n.m,t,"[Invalid Chunk]"),i=!1;break}Di(n.j,n.m,s,null),Gl(n,s)}Vl(n)&&s!=os&&s!=no&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Nn(16),i=!1),n.i=n.i&&i,i?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),oc(e),e.K=!0,Nn(11))):(Di(n.j,n.m,t,"[Invalid Chunked Response]"),Pr(n),ro(n))}function Ih(n,e){var t=n.C,i=e.indexOf("\n",t);return-1==i?os:(t=Number(e.substring(t,i)),isNaN(t)?no:(i+=1)+t>e.length?os:(e=e.substr(i,t),n.C=i+t,e))}function as(n){n.V=Date.now()+n.O,Wl(n,n.O)}function Wl(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=ss(ge(n.gb,n),e)}function io(n){n.B&&(A.clearTimeout(n.B),n.B=null)}function ro(n){0==n.l.G||n.I||ac(n.l,n)}function Pr(n){io(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,Fl(n.T),yh(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function Gl(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||ga(t.h,n)))if(!n.J&&ga(t.h,n)&&3==t.G){try{var i=t.Fa.g.parse(e)}catch{i=null}if(Array.isArray(i)&&3==i.length){var s=i;if(0==s[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;fs(t),tr(t)}nr(t),Nn(18)}}else t.Ba=s[1],0<t.Ba-t.T&&37500>s[2]&&t.L&&0==t.A&&!t.v&&(t.v=ss(ge(t.cb,t),6e3));if(1>=Hl(t.h)&&t.ja){try{t.ja()}catch{}t.ja=void 0}}else bi(t,11)}else if((n.J||t.g==n)&&fs(t),!Be(e))for(s=t.Fa.g.parse(e),e=0;e<s.length;e++){let x=s[e];if(t.T=x[0],x=x[1],2==t.G)if("c"==x[0]){t.I=x[1],t.ka=x[2];const b=x[3];null!=b&&(t.ma=b,t.j.info("VER="+t.ma));const I=x[4];null!=I&&(t.Ca=I,t.j.info("SVER="+t.Ca));const G=x[5];null!=G&&"number"==typeof G&&0<G&&(t.J=i=1.5*G,t.j.info("backChannelRequestTimeoutMs_="+i)),i=t;const _e=n.g;if(_e){const Ee=_e.g?_e.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ee){var a=i.h;a.g||-1==Ee.indexOf("spdy")&&-1==Ee.indexOf("quic")&&-1==Ee.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(qn(a,a.h),a.h=null))}if(i.D){const Ke=_e.g?_e.g.getResponseHeader("X-HTTP-Session-Id"):null;Ke&&(i.za=Ke,Jt(i.F,i.D,Ke))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var l=n;if((i=t).sa=Qh(i,i.H?i.ka:null,i.V),l.J){Fh(i.h,l);var d=l,p=i.J;p&&d.setTimeout(p),d.B&&(io(d),as(d)),i.g=l}else Uh(i);0<t.i.length&&uo(t)}else"stop"!=x[0]&&"close"!=x[0]||bi(t,7);else 3==t.G&&("stop"==x[0]||"close"==x[0]?"stop"==x[0]?bi(t,7):co(t):"noop"!=x[0]&&t.l&&t.l.wa(x),t.A=0)}Hs()}catch{}}function Sh(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(L(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function rp(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(L(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const i in n)e[t++]=i;return e}}}(n),i=function Eh(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(L(n)){for(var e=[],t=n.length,i=0;i<t;i++)e.push(n[i]);return e}for(i in e=[],t=0,n)e[t++]=n[i];return e}(n),s=i.length,a=0;a<s;a++)e.call(void 0,i[a],t&&t[a],n)}(E=Mr.prototype).setTimeout=function(n){this.O=n},E.ib=function(n){n=n.target;const e=this.L;e&&3==Fi(n)?e.l():this.La(n)},E.La=function(n){try{if(n==this.g)e:{const b=Fi(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>b)&&(3!=b||Ae||this.g&&(this.h.h||this.g.fa()||va(this.g)))){this.I||4!=b||7==e||Hs(),io(this);var t=this.g.aa();this.Y=t;t:if(Vl(this)){var i=va(this.g);n="";var s=i.length,a=4==Fi(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Pr(this),ro(this);var l="";break t}this.h.i=new A.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,n+=this.h.i.decode(i[e],{stream:a&&e==s-1});i.splice(0,s),this.h.g+=n,this.C=0,l=this.h.g}else l=this.g.fa();if(this.i=200==t,function tp(n,e,t,i,s,a,l){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+e+"\n"+t+"\n"+a+" "+l})}(this.j,this.u,this.A,this.m,this.U,b,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var d,p=this.g;if((d=p.g?p.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Be(d)){var x=d;break t}}x=null}if(!(t=x)){this.i=!1,this.o=3,Nn(12),Pr(this),ro(this);break e}Di(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Gl(this,t)}this.P?(Ah(this,b,l),Ae&&this.i&&3==b&&(vh(this.S,this.T,"tick",this.hb),this.T.start())):(Di(this.j,this.m,l,null),Gl(this,l)),4==b&&Pr(this),this.i&&!this.I&&(4==b?ac(this.l,this):(this.i=!1,as(this)))}else 400==t&&0<l.indexOf("Unknown SID")?(this.o=3,Nn(12)):(this.o=0,Nn(13)),Pr(this),ro(this)}}}catch{}},E.hb=function(){if(this.g){var n=Fi(this.g),e=this.g.fa();this.C<e.length&&(io(this),Ah(this,n,e),this.i&&4!=n&&as(this))}},E.cancel=function(){this.I=!0,Pr(this)},E.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function np(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Hs(),Nn(17)),Pr(this),this.o=2,ro(this)):Wl(this,this.V-n)};var Mh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ri(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Ri){this.h=void 0!==e?e:n.h,fa(this,n.j),this.s=n.s,this.g=n.g,pa(this,n.m),this.l=n.l,e=n.i;var t=new oo;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Ph(this,t),this.o=n.o}else n&&(t=String(n).match(Mh))?(this.h=!!e,fa(this,t[1]||"",!0),this.s=kt(t[2]||""),this.g=kt(t[3]||"",!0),pa(this,t[4]),this.l=kt(t[5]||"",!0),Ph(this,t[6]||"",!0),this.o=kt(t[7]||"")):(this.h=!!e,this.i=new oo(null,this.h))}function Li(n){return new Ri(n)}function fa(n,e,t){n.j=t?kt(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function pa(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Ph(n,e,t){e instanceof oo?(n.i=e,function si(n,e){e&&!n.j&&($t(n),n.i=null,n.g.forEach(function(t,i){var s=i.toLowerCase();i!=s&&(Kl(this,i),Jl(this,s,t))},n)),n.j=e}(n.i,n.h)):(t||(e=so(e,cp)),n.i=new oo(e,n.h))}function Jt(n,e,t){n.i.set(e,t)}function Lt(n){return Jt(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function kt(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function so(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,op),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function op(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Ri.prototype.toString=function(){var n=[],e=this.j;e&&n.push(so(e,kh,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(so(e,kh,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(so(t,"/"==t.charAt(0)?lp:ap,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",so(t,Dh)),n.join("")};var kh=/[#\/\?@]/g,ap=/[#\?:]/g,lp=/[#\?]/g,cp=/[#\?@]/g,Dh=/#/g;function oo(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function $t(n){n.g||(n.g=new Map,n.h=0,n.i&&function sp(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var i=n[t].indexOf("="),s=null;if(0<=i){var a=n[t].substring(0,i);s=n[t].substring(i+1)}else a=n[t];e(a,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Kl(n,e){$t(n),e=Xi(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function ls(n,e){return $t(n),e=Xi(n,e),n.g.has(e)}function Jl(n,e,t){Kl(n,e),0<t.length&&(n.i=null,n.g.set(Xi(n,e),ht(t)),n.h+=t.length)}function Xi(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function $l(n){this.l=n||Lh,n=A.PerformanceNavigationTiming?0<(n=A.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(A.g&&A.g.Ga&&A.g.Ga()&&A.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(E=oo.prototype).add=function(n,e){$t(this),this.i=null,n=Xi(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},E.forEach=function(n,e){$t(this),this.g.forEach(function(t,i){t.forEach(function(s){n.call(e,s,i,this)},this)},this)},E.oa=function(){$t(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let i=0;i<e.length;i++){const s=n[i];for(let a=0;a<s.length;a++)t.push(e[i])}return t},E.W=function(n){$t(this);let e=[];if("string"==typeof n)ls(this,n)&&(e=e.concat(this.g.get(Xi(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},E.set=function(n,e){return $t(this),this.i=null,ls(this,n=Xi(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},E.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},E.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var i=e[t];const a=encodeURIComponent(String(i)),l=this.W(i);for(i=0;i<l.length;i++){var s=a;""!==l[i]&&(s+="="+encodeURIComponent(String(l[i]))),n.push(s)}}return this.i=n.join("&")};var Lh=10;function Yl(n){return!!n.h||!!n.g&&n.g.size>=n.j}function Hl(n){return n.h?1:n.g?n.g.size:0}function ga(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function qn(n,e){n.g?n.g.add(e):n.h=e}function Fh(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function Hn(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return ht(n.i)}function Xl(){}function Nh(){this.g=new Xl}function er(n,e,t){const i=t||"";try{Sh(n,function(s,a){let l=s;U(s)&&(l=ns(s)),e.push(i+a+"="+encodeURIComponent(l))})}catch(s){throw e.push(i+"type="+encodeURIComponent("_badmap")),s}}function cs(n,e,t,i,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(i)}catch{}}function Ft(n){this.l=n.ac||null,this.j=n.jb||!1}function ui(n,e){gn.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=ao,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}$l.prototype.cancel=function(){if(this.i=Hn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},Xl.prototype.stringify=function(n){return A.JSON.stringify(n,void 0)},Xl.prototype.parse=function(n){return A.JSON.parse(n,void 0)},qe(Ft,eo),Ft.prototype.g=function(){return new ui(this.l,this.j)},Ft.prototype.i=function(n){return function(){return n}}({}),qe(ui,gn);var ao=0;function qh(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function kr(n){n.readyState=4,n.l=null,n.j=null,n.A=null,lo(n)}function lo(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(E=ui.prototype).open=function(n,e){if(this.readyState!=ao)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,lo(this)},E.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||A).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},E.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,kr(this)),this.readyState=ao},E.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,lo(this)),this.g&&(this.readyState=3,lo(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof A.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;qh(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},E.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?kr(this):lo(this),3==this.readyState&&qh(this)}},E.Va=function(n){this.g&&(this.response=this.responseText=n,kr(this))},E.Ua=function(n){this.g&&(this.response=n,kr(this))},E.ga=function(){this.g&&kr(this)},E.setRequestHeader=function(n,e){this.v.append(n,e)},E.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},E.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(ui.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var up=A.JSON.parse;function nn(n){gn.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=ec,this.K=this.L=!1}qe(nn,gn);var ec="",_a=/^https?$/i,us=["POST","PUT"];function tc(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,nc(n),hs(n)}function nc(n){n.D||(n.D=!0,_n(n,"complete"),_n(n,"error"))}function xa(n){if(n.h&&typeof R<"u"&&(!n.C[1]||4!=Fi(n)||2!=n.aa()))if(n.v&&4==Fi(n))Nl(n.Ha,0,n);else if(_n(n,"readystatechange"),4==Fi(n)){n.h=!1;try{const d=n.aa();e:switch(d){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var i;if(i=0===d){var s=String(n.H).match(Mh)[1]||null;if(!s&&A.self&&A.self.location){var a=A.self.location.protocol;s=a.substr(0,a.length-1)}i=!_a.test(s?s.toLowerCase():"")}t=i}if(t)_n(n,"complete"),_n(n,"success");else{n.m=6;try{var l=2<Fi(n)?n.g.statusText:""}catch{l=""}n.j=l+" ["+n.aa()+"]",nc(n)}}finally{hs(n)}}}function hs(n,e){if(n.g){ic(n);const t=n.g,i=n.C[0]?fe:null;n.g=null,n.C=null,e||_n(n,"ready");try{t.onreadystatechange=i}catch{}}}function ic(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(A.clearTimeout(n.A),n.A=null)}function Fi(n){return n.g?n.g.readyState:0}function va(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case ec:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function ya(n){let e="";return de(n,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function rc(n,e,t){e:{for(i in t){var i=!1;break e}i=!0}i||(t=ya(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Jt(n,e,t))}function ds(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function Vn(n){this.Ca=0,this.i=[],this.j=new ca,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=ds("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=ds("baseRetryDelayMs",5e3,n),this.bb=ds("retryDelaySeedMs",1e4,n),this.$a=ds("forwardChannelMaxRetries",2,n),this.ta=ds("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new $l(n&&n.concurrentRequestLimit),this.Fa=new Nh,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function co(n){if(sc(n),3==n.G){var e=n.U++,t=Li(n.F);Jt(t,"SID",n.I),Jt(t,"RID",e),Jt(t,"TYPE","terminate"),ho(n,t),(e=new Mr(n,n.j,e,void 0)).K=2,e.v=Lt(Li(t)),t=!1,A.navigator&&A.navigator.sendBeacon&&(t=A.navigator.sendBeacon(e.v.toString(),"")),!t&&A.Image&&((new Image).src=e.v,t=!0),t||(e.g=Vh(e.l,null),e.g.da(e.v)),e.F=Date.now(),as(e)}Zh(n)}function tr(n){n.g&&(oc(n),n.g.cancel(),n.g=null)}function sc(n){tr(n),n.u&&(A.clearTimeout(n.u),n.u=null),fs(n),n.h.cancel(),n.m&&("number"==typeof n.m&&A.clearTimeout(n.m),n.m=null)}function uo(n){Yl(n.h)||n.m||(n.m=!0,aa(n.Ja,n),n.C=0)}function jh(n,e){var t;t=e?e.m:n.U++;const i=Li(n.F);Jt(i,"SID",n.I),Jt(i,"RID",t),Jt(i,"AID",n.T),ho(n,i),n.o&&n.s&&rc(i,n.o,n.s),t=new Mr(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=Bh(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),qn(n.h,t),Hi(t,i,e)}function ho(n,e){n.ia&&de(n.ia,function(t,i){Jt(e,i,t)}),n.l&&Sh({},function(t,i){Jt(e,i,t)})}function Bh(n,e,t){t=Math.min(n.i.length,t);var i=n.l?ge(n.l.Ra,n.l,n):null;e:{var s=n.i;let a=-1;for(;;){const l=["count="+t];-1==a?0<t?(a=s[0].h,l.push("ofs="+a)):a=0:l.push("ofs="+a);let d=!0;for(let p=0;p<t;p++){let x=s[p].h;const b=s[p].g;if(x-=a,0>x)a=Math.max(0,s[p].h-100),d=!1;else try{er(b,l,"req"+x+"_")}catch{i&&i(b)}}if(d){i=l.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,i}function Uh(n){n.g||n.u||(n.Z=1,aa(n.Ia,n),n.A=0)}function nr(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=ss(ge(n.Ia,n),Ni(n,n.A)),n.A++,0))}function oc(n){null!=n.B&&(A.clearTimeout(n.B),n.B=null)}function zh(n){n.g=new Mr(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=Li(n.sa);Jt(e,"RID","rpc"),Jt(e,"SID",n.I),Jt(e,"CI",n.L?"0":"1"),Jt(e,"AID",n.T),Jt(e,"TYPE","xmlhttp"),ho(n,e),n.o&&n.s&&rc(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=Lt(Li(e)),t.s=null,t.P=!0,Ql(t,n)}function fs(n){null!=n.v&&(A.clearTimeout(n.v),n.v=null)}function ac(n,e){var t=null;if(n.g==e){fs(n),oc(n),n.g=null;var i=2}else{if(!ga(n.h,e))return;t=e.D,Fh(n.h,e),i=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==i){t=e.s?e.s.length:0,e=Date.now()-e.F;var s=n.C;_n(i=Ys(),new bh(i,t)),uo(n)}else Uh(n);else if(3==(s=e.o)||0==s&&0<n.pa||!(1==i&&function dp(n,e){return!(Hl(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=ss(ge(n.Ja,n,e),Ni(n,n.C)),n.C++,0)))}(n,e)||2==i&&nr(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),s){case 1:bi(n,5);break;case 4:bi(n,10);break;case 3:bi(n,6);break;default:bi(n,2)}}function Ni(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function bi(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var i=ge(n.kb,n);t||(t=new Ri("//www.google.com/images/cleardot.gif"),A.location&&"http"==A.location.protocol||fa(t,"https"),Lt(t)),function ma(n,e){const t=new ca;if(A.Image){const i=new Image;i.onload=Oe(cs,t,i,"TestLoadImage: loaded",!0,e),i.onerror=Oe(cs,t,i,"TestLoadImage: error",!1,e),i.onabort=Oe(cs,t,i,"TestLoadImage: abort",!1,e),i.ontimeout=Oe(cs,t,i,"TestLoadImage: timeout",!1,e),A.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else e(!1)}(t.toString(),i)}else Nn(2);n.G=0,n.l&&n.l.va(e),Zh(n),sc(n)}function Zh(n){if(n.G=0,n.la=[],n.l){const e=Hn(n.h);(0!=e.length||0!=n.i.length)&&(we(n.la,e),we(n.la,n.i),n.h.i.length=0,ht(n.i),n.i.length=0),n.l.ua()}}function Qh(n,e,t){var i=t instanceof Ri?Li(t):new Ri(t,void 0);if(""!=i.g)e&&(i.g=e+"."+i.g),pa(i,i.m);else{var s=A.location;i=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var a=new Ri(null,void 0);i&&fa(a,i),e&&(a.g=e),s&&pa(a,s),t&&(a.l=t),i=a}return e=n.za,(t=n.D)&&e&&Jt(i,t,e),Jt(i,"VER",n.ma),ho(n,i),i}function Vh(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new nn(t&&n.Da&&!n.ra?new Ft({jb:!0}):n.ra)).Ka(n.H),e}function Dr(){}function Wn(){if(De&&!(10<=Number(ze)))throw Error("Environmental error: no available transport.")}function Gn(n,e){gn.call(this),this.g=new Vn(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!Be(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Be(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new ps(this)}function Wh(n){ha.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function Gh(){Zl.call(this),this.status=1}function ps(n){this.g=n}(E=nn.prototype).Ka=function(n){this.L=n},E.da=function(n,e,t,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():da.g(),this.C=function Ch(n){return n.h||(n.h=n.i())}(this.u?this.u:da),this.g.onreadystatechange=ge(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(a){return void tc(this,a)}if(n=t||"",t=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)t.set(s,i[s]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const a of i.keys())t.set(a,i.get(a))}i=Array.from(t.keys()).find(a=>"content-type"==a.toLowerCase()),s=A.FormData&&n instanceof A.FormData,!(0<=Fe(us,e))||i||s||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,l]of t)this.g.setRequestHeader(a,l);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{ic(this),0<this.B&&((this.K=function hp(n){return De&&function q(){return function Je(n){var e=K;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=V(String($)).split("."),t=V("9").split("."),i=Math.max(e.length,t.length);for(let l=0;0==n&&l<i;l++){var s=e[l]||"",a=t[l]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;n=oe(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||oe(0==s[2].length,0==a[2].length)||oe(s[2],a[2]),s=s[3],a=a[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ge(this.qa,this)):this.A=Nl(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){tc(this,a)}},E.qa=function(){typeof R<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,_n(this,"timeout"),this.abort(8))},E.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,_n(this,"complete"),_n(this,"abort"),hs(this))},E.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),hs(this,!0)),nn.X.M.call(this)},E.Ha=function(){this.s||(this.F||this.v||this.l?xa(this):this.fb())},E.fb=function(){xa(this)},E.aa=function(){try{return 2<Fi(this)?this.g.status:-1}catch{return-1}},E.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},E.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),up(e)}},E.Ea=function(){return this.m},E.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(E=Vn.prototype).ma=8,E.G=1,E.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const s=new Mr(this,this.j,n,void 0);let a=this.s;if(this.S&&(a?(a=J(a),je(a,this.S)):a=this.S),null!==this.o||this.N||(s.H=a,a=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var i=this.i[t];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Bh(this,s,e),Jt(t=Li(this.F),"RID",n),Jt(t,"CVER",22),this.D&&Jt(t,"X-HTTP-Session-Id",this.D),ho(this,t),a&&(this.N?e="headers="+encodeURIComponent(String(ya(a)))+"&"+e:this.o&&rc(t,this.o,a)),qn(this.h,s),this.Ya&&Jt(t,"TYPE","init"),this.O?(Jt(t,"$req",e),Jt(t,"SID","null"),s.Z=!0,Hi(s,t,null)):Hi(s,t,e),this.G=2}}else 3==this.G&&(n?jh(this,n):0==this.i.length||Yl(this.h)||jh(this))},E.Ia=function(){if(this.u=null,zh(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=ss(ge(this.eb,this),n)}},E.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Nn(10),tr(this),zh(this))},E.cb=function(){null!=this.v&&(this.v=null,tr(this),nr(this),Nn(19))},E.kb=function(n){n?(this.j.info("Successfully pinged google.com"),Nn(2)):(this.j.info("Failed to ping google.com"),Nn(1))},(E=Dr.prototype).xa=function(){},E.wa=function(){},E.va=function(){},E.ua=function(){},E.Ra=function(){},Wn.prototype.g=function(n,e){return new Gn(n,e)},qe(Gn,gn),Gn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;Nn(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=Qh(n,null,n.V),uo(n)},Gn.prototype.close=function(){co(this.g)},Gn.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=ns(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.ab++,n)),3==e.G&&uo(e)},Gn.prototype.M=function(){this.g.l=null,delete this.j,co(this.g),delete this.g,Gn.X.M.call(this)},qe(Wh,ha),qe(Gh,Zl),qe(ps,Dr),ps.prototype.xa=function(){_n(this.g,"a")},ps.prototype.wa=function(n){_n(this.g,new Wh(n))},ps.prototype.va=function(n){_n(this.g,new Gh)},ps.prototype.ua=function(){_n(this.g,"b")},Wn.prototype.createWebChannel=Wn.prototype.g,Gn.prototype.send=Gn.prototype.u,Gn.prototype.open=Gn.prototype.m,Gn.prototype.close=Gn.prototype.close,Xs.NO_ERROR=0,Xs.TIMEOUT=8,Xs.HTTP_ERROR=6,Ul.COMPLETE="complete",zl.EventType=Yi,Yi.OPEN="a",Yi.CLOSE="b",Yi.ERROR="c",Yi.MESSAGE="d",gn.prototype.listen=gn.prototype.N,nn.prototype.listenOnce=nn.prototype.O,nn.prototype.getLastError=nn.prototype.Oa,nn.prototype.getLastErrorCode=nn.prototype.Ea,nn.prototype.getStatus=nn.prototype.aa,nn.prototype.getResponseJson=nn.prototype.Sa,nn.prototype.getResponseText=nn.prototype.fa,nn.prototype.send=nn.prototype.da,nn.prototype.setWithCredentials=nn.prototype.Ka;var fp=F.createWebChannelTransport=function(){return new Wn},pp=F.getStatEventTarget=function(){return Ys()},gs=F.ErrorCode=Xs,z=F.EventType=Ul,he=F.Event=Sr,se=F.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Ye=F.FetchXmlHttpFactory=Ft,dt=F.WebChannel=zl,Pt=F.XhrIo=nn;const mn="@firebase/firestore";class mt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}mt.UNAUTHENTICATED=new mt(null),mt.GOOGLE_CREDENTIALS=new mt("google-credentials-uid"),mt.FIRST_PARTY=new mt("first-party-uid"),mt.MOCK_USER=new mt("mock-user");let ir="9.15.0";const rr=new m.Yd("@firebase/firestore");function Kn(){return rr.logLevel}function ke(n,...e){if(rr.logLevel<=m.in.DEBUG){const t=e.map(ms);rr.debug(`Firestore (${ir}): ${n}`,...t)}}function Zt(n,...e){if(rr.logLevel<=m.in.ERROR){const t=e.map(ms);rr.error(`Firestore (${ir}): ${n}`,...t)}}function qi(n,...e){if(rr.logLevel<=m.in.WARN){const t=e.map(ms);rr.warn(`Firestore (${ir}): ${n}`,...t)}}function ms(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Le(n="Unexpected state"){const e=`FIRESTORE (${ir}) INTERNAL ASSERTION FAILED: `+n;throw Zt(e),new Error(e)}function Xe(n,e){n||Le()}function Qe(n,e){return n}const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends B.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class xn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class fo{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class sr{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(mt.UNAUTHENTICATED))}shutdown(){}}class wa{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Kh{constructor(e){this.t=e,this.currentUser=mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var i=this;let s=this.i;const a=x=>this.i!==s?(s=this.i,t(x)):Promise.resolve();let l=new xn;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new xn,e.enqueueRetryable(()=>a(this.currentUser))};const d=()=>{const x=l;e.enqueueRetryable((0,O.Z)(function*(){yield x.promise,yield a(i.currentUser)}))},p=x=>{ke("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=x,this.auth.addAuthTokenListener(this.o),d()};this.t.onInit(x=>p(x)),setTimeout(()=>{if(!this.auth){const x=this.t.getImmediate({optional:!0});x?p(x):(ke("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new xn)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(ke("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Xe("string"==typeof i.accessToken),new fo(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Xe(null===e||"string"==typeof e),new mt(e)}}class ba{constructor(e,t,i,s){this.h=e,this.l=t,this.m=i,this.g=s,this.type="FirstParty",this.user=mt.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(Xe(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Jh{constructor(e,t,i,s){this.h=e,this.l=t,this.m=i,this.g=s}getToken(){return Promise.resolve(new ba(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cc{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ca{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const i=a=>{null!=a.error&&ke("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.A;return this.A=a.token,ke("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>i(a))};const s=a=>{ke("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.T.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.T.getImmediate({optional:!0});a?s(a):ke("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Xe("string"==typeof t.token),this.A=t.token,new cc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function po(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class or{static R(){const t=62*Math.floor(256/62);let i="";for(;i.length<20;){const s=po(40);for(let a=0;a<s.length;++a)i.length<20&&s[a]<t&&(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(s[a]%62))}return i}}function ct(n,e){return n<e?-1:n>e?1:0}function _s(n,e,t){return n.length===e.length&&n.every((i,s)=>t(i,e[s]))}class Xt{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ie(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ie(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ie(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Xt.fromMillis(Date.now())}static fromDate(e){return Xt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Xt(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ct(this.nanoseconds,e.nanoseconds):ct(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class et{constructor(e){this.timestamp=e}static fromTimestamp(e){return new et(e)}static min(){return new et(new Xt(0,0))}static max(){return new et(new Xt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class ar{constructor(e,t,i){void 0===t?t=0:t>e.length&&Le(),void 0===i?i=e.length-t:i>e.length-t&&Le(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return 0===ar.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ar?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const a=e.get(s),l=t.get(s);if(a<l)return-1;if(a>l)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class At extends ar{construct(e,t,i){return new At(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ie(re.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(s=>s.length>0))}return new At(t)}static emptyPath(){return new At([])}}const _p=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rn extends ar{construct(e,t,i){return new rn(e,t,i)}static isValidIdentifier(e){return _p.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new rn(["__name__"])}static fromServerFormat(e){const t=[];let i="",s=0;const a=()=>{if(0===i.length)throw new Ie(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let l=!1;for(;s<e.length;){const d=e[s];if("\\"===d){if(s+1===e.length)throw new Ie(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[s+1];if("\\"!==p&&"."!==p&&"`"!==p)throw new Ie(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=p,s+=2}else"`"===d?(l=!l,s++):"."!==d||l?(i+=d,s++):(a(),s++)}if(a(),l)throw new Ie(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new rn(t)}static emptyPath(){return new rn([])}}class We{constructor(e){this.path=e}static fromPath(e){return new We(At.fromString(e))}static fromName(e){return new We(At.fromString(e).popFirst(5))}static empty(){return new We(At.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===At.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return At.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new We(new At(e.slice()))}}function xs(n){return new jn(n.readTime,n.key,-1)}class jn{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new jn(et.min(),We.empty(),-1)}static max(){return new jn(et.max(),We.empty(),-1)}}function lr(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=We.comparator(n.documentKey,e.documentKey),0!==t?t:ct(n.largestBatchId,e.largestBatchId))}const vs="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mo{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function hi(n){return cr.apply(this,arguments)}function cr(){return cr=(0,O.Z)(function*(n){if(n.code!==re.FAILED_PRECONDITION||n.message!==vs)throw n;ke("LocalStore","Unexpectedly lost primary lease")}),cr.apply(this,arguments)}class te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new te((i,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(i,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(i,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof te?t:te.resolve(t)}catch(t){return te.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):te.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):te.reject(t)}static resolve(e){return new te((t,i)=>{t(e)})}static reject(e){return new te((t,i)=>{i(e)})}static waitFor(e){return new te((t,i)=>{let s=0,a=0,l=!1;e.forEach(d=>{++s,d.next(()=>{++a,l&&a===s&&t()},p=>i(p))}),l=!0,a===s&&t()})}static or(e){let t=te.resolve(!1);for(const i of e)t=t.next(s=>s?te.resolve(s):i());return t}static forEach(e,t){const i=[];return e.forEach((s,a)=>{i.push(t.call(this,s,a))}),this.waitFor(i)}static mapArray(e,t){return new te((i,s)=>{const a=e.length,l=new Array(a);let d=0;for(let p=0;p<a;p++){const x=p;t(e[x]).next(b=>{l[x]=b,++d,d===a&&i(l)},b=>s(b))}})}static doWhile(e,t){return new te((i,s)=>{const a=()=>{!0===e()?t().next(()=>{a()},s):i()};a()})}}function fi(n){return"IndexedDbTransactionError"===n.name}let ut=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=s=>this.ut(s),this.ct=s=>i.writeSequenceNumber(s))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}return n.at=-1,n})();class yp{constructor(e,t,i,s,a,l,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.useFetchStreams=p}}class Rr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Rr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Rr&&e.projectId===this.projectId&&e.database===this.database}}function Hh(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Xn(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Xh(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function vo(n){return null==n}function yo(n){return 0===n&&1/n==-1/0}class jt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new jt(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new jt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ct(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jt.EMPTY_BYTE_STRING=new jt("");const wp=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function dr(n){if(Xe(!!n),"string"==typeof n){let e=0;const t=wp.exec(n);if(Xe(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:on(n.seconds),nanos:on(n.nanos)}}function on(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Lr(n){return"string"==typeof n?jt.fromBase64String(n):jt.fromUint8Array(n)}function uc(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Ci(n){const e=n.mapValue.fields.__previous_value__;return uc(e)?Ci(e):e}function wo(n){const e=dr(n.mapValue.fields.__local_write_time__.timestampValue);return new Xt(e.seconds,e.nanos)}const fr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Fr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?uc(n)?4:id(n)?9007199254740991:10:Le()}function Oi(n,e){if(n===e)return!0;const t=Fr(n);if(t!==Fr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return wo(n).isEqual(wo(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=dr(i.timestampValue),l=dr(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return s=e,Lr(n.bytesValue).isEqual(Lr(s.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return on(i.geoPointValue.latitude)===on(s.geoPointValue.latitude)&&on(i.geoPointValue.longitude)===on(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return on(i.integerValue)===on(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=on(i.doubleValue),l=on(s.doubleValue);return a===l?yo(a)===yo(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return _s(n.arrayValue.values||[],e.arrayValue.values||[],Oi);case 10:return function(i,s){const a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(Hh(a)!==Hh(l))return!1;for(const d in a)if(a.hasOwnProperty(d)&&(void 0===l[d]||!Oi(a[d],l[d])))return!1;return!0}(n,e);default:return Le()}var s}function pi(n,e){return void 0!==(n.values||[]).find(t=>Oi(t,e))}function pr(n,e){if(n===e)return 0;const t=Fr(n),i=Fr(e);if(t!==i)return ct(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ct(n.booleanValue,e.booleanValue);case 2:return function(s,a){const l=on(s.integerValue||s.doubleValue),d=on(a.integerValue||a.doubleValue);return l<d?-1:l>d?1:l===d?0:isNaN(l)?isNaN(d)?0:-1:1}(n,e);case 3:return td(n.timestampValue,e.timestampValue);case 4:return td(wo(n),wo(e));case 5:return ct(n.stringValue,e.stringValue);case 6:return function(s,a){const l=Lr(s),d=Lr(a);return l.compareTo(d)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){const l=s.split("/"),d=a.split("/");for(let p=0;p<l.length&&p<d.length;p++){const x=ct(l[p],d[p]);if(0!==x)return x}return ct(l.length,d.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){const l=ct(on(s.latitude),on(a.latitude));return 0!==l?l:ct(on(s.longitude),on(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,a){const l=s.values||[],d=a.values||[];for(let p=0;p<l.length&&p<d.length;++p){const x=pr(l[p],d[p]);if(x)return x}return ct(l.length,d.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===fr.mapValue&&a===fr.mapValue)return 0;if(s===fr.mapValue)return 1;if(a===fr.mapValue)return-1;const l=s.fields||{},d=Object.keys(l),p=a.fields||{},x=Object.keys(p);d.sort(),x.sort();for(let b=0;b<d.length&&b<x.length;++b){const I=ct(d[b],x[b]);if(0!==I)return I;const G=pr(l[d[b]],p[x[b]]);if(0!==G)return G}return ct(d.length,x.length)}(n.mapValue,e.mapValue);default:throw Le()}}function td(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return ct(n,e);const t=dr(n),i=dr(e),s=ct(t.seconds,i.seconds);return 0!==s?s:ct(t.nanos,i.nanos)}function Pn(n){return hc(n)}function hc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(i){const s=dr(i);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Lr(n.bytesValue).toBase64():"referenceValue"in n?We.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(i){let s="[",a=!0;for(const l of i.values||[])a?a=!1:s+=",",s+=hc(l);return s+"]"}(n.arrayValue):"mapValue"in n?function(i){const s=Object.keys(i.fields||{}).sort();let a="{",l=!0;for(const d of s)l?l=!1:a+=",",a+=`${d}:${hc(i.fields[d])}`;return a+"}"}(n.mapValue):Le();var e}function Nr(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function dc(n){return!!n&&"integerValue"in n}function bo(n){return!!n&&"arrayValue"in n}function nd(n){return!!n&&"nullValue"in n}function fc(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Co(n){return!!n&&"mapValue"in n}function Oo(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Xn(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Oo(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Oo(n.arrayValue.values[t]);return e}return Object.assign({},n)}function id(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}class ji{constructor(e,t){this.position=e,this.inclusive=t}}function sd(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const a=e[s],l=n.position[s];if(i=a.field.isKeyField()?We.comparator(We.fromName(l.referenceValue),t.key):pr(l,t.data.field(a.field)),"desc"===a.dir&&(i*=-1),0!==i)break}return i}function Ti(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Oi(n.position[t],e.position[t]))return!1;return!0}class Ma{}class vt extends Ma{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,i):new bp(e,t,i):"array-contains"===t?new ld(e,i):"in"===t?new gi(e,i):"not-in"===t?new _c(e,i):"array-contains-any"===t?new Da(e,i):new vt(e,t,i)}static createKeyFieldInFilter(e,t,i){return"in"===t?new ad(e,i):new Tn(e,i)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(pr(t,this.value)):null!==t&&Fr(this.value)===Fr(t)&&this.matchesComparison(pr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class bt extends Ma{constructor(e,t){super(),this.filters=e,this.op=t,this.ht=null}static create(e,t){return new bt(e,t)}matches(e){return ys(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.lt(t=>t.isInequality());return null!==e?e.field:null}lt(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function ys(n){return"and"===n.op}function gc(n){return function ws(n){for(const e of n.filters)if(e instanceof bt)return!1;return!0}(n)&&ys(n)}function Bi(n){if(n instanceof vt)return n.field.canonicalString()+n.op.toString()+Pn(n.value);{const e=n.filters.map(t=>Bi(t)).join(",");return`${n.op}(${e})`}}function mc(n,e){return n instanceof vt?(t=n,(i=e)instanceof vt&&t.op===i.op&&t.field.isEqual(i.field)&&Oi(t.value,i.value)):n instanceof bt?function(t,i){return i instanceof bt&&t.op===i.op&&t.filters.length===i.filters.length&&t.filters.reduce((s,a,l)=>s&&mc(a,i.filters[l]),!0)}(n,e):void Le();var t,i}function Io(n){return n instanceof vt?`${(e=n).field.canonicalString()} ${e.op} ${Pn(e.value)}`:n instanceof bt?function(e){return e.op.toString()+" {"+e.getFilters().map(Io).join(" ,")+"}"}(n):"Filter";var e}class bp extends vt{constructor(e,t,i){super(e,t,i),this.key=We.fromName(i.referenceValue)}matches(e){const t=We.comparator(e.key,this.key);return this.matchesComparison(t)}}class ad extends vt{constructor(e,t){super(e,"in",t),this.keys=ka(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Tn extends vt{constructor(e,t){super(e,"not-in",t),this.keys=ka(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function ka(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(i=>We.fromName(i.referenceValue))}class ld extends vt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return bo(t)&&pi(t.arrayValue,this.value)}}class gi extends vt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&pi(this.value.arrayValue,t)}}class _c extends vt{constructor(e,t){super(e,"not-in",t)}matches(e){if(pi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!pi(this.value.arrayValue,t)}}class Da extends vt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!bo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>pi(this.value.arrayValue,i))}}class ai{constructor(e,t="asc"){this.field=e,this.dir=t}}function cd(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class It{constructor(e,t){this.comparator=e,this.root=t||An.EMPTY}insert(e,t){return new It(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,An.BLACK,null,null))}remove(e){return new It(this.comparator,this.root.remove(e,this.comparator).copy(null,null,An.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(0===i)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(0===s)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bs(this.root,e,this.comparator,!1)}getReverseIterator(){return new bs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bs(this.root,e,this.comparator,!0)}}class bs{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?i(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class An{constructor(e,t,i,s,a){this.key=e,this.value=t,this.color=i??An.RED,this.left=s??An.EMPTY,this.right=a??An.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,a){return new An(e??this.key,t??this.value,i??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const a=i(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,i),null):0===a?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return An.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===t(e,s.key)){if(s.right.isEmpty())return An.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,An.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,An.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Le();const e=this.left.check();if(e!==this.right.check())throw Le();return e+(this.isRed()?0:1)}}An.EMPTY=null,An.RED=!0,An.BLACK=!1,An.EMPTY=new class{constructor(){this.size=0}get key(){throw Le()}get value(){throw Le()}get color(){throw Le()}get left(){throw Le()}get right(){throw Le()}copy(n,e,t,i,s){return this}insert(n,e,t){return new An(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Nt{constructor(e){this.comparator=e,this.data=new It(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ud(this.data.getIterator())}getIteratorFrom(e){return new ud(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof Nt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=i.getNext().key;if(0!==this.comparator(s,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Nt(this.comparator);return t.data=e,t}}class ud{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ei{constructor(e){this.fields=e,e.sort(rn.comparator)}static empty(){return new ei([])}unionWith(e){let t=new Nt(rn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new ei(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return _s(this.fields,e.fields,(t,i)=>t.isEqual(i))}}class un{constructor(e){this.value=e}static empty(){return new un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Co(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Oo(t)}setAll(e){let t=rn.emptyPath(),i={},s=[];e.forEach((l,d)=>{if(!t.isImmediateParentOf(d)){const p=this.getFieldsMap(t);this.applyChanges(p,i,s),i={},s=[],t=d.popLast()}l?i[d.lastSegment()]=Oo(l):s.push(d.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,i,s)}delete(e){const t=this.field(e.popLast());Co(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Oi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];Co(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){Xn(t,(s,a)=>e[s]=a);for(const s of i)delete e[s]}clone(){return new un(Oo(this.value))}}function xc(n){const e=[];return Xn(n.fields,(t,i)=>{const s=new rn([t]);if(Co(i)){const a=xc(i.mapValue).fields;if(0===a.length)e.push(s);else for(const l of a)e.push(s.child(l))}else e.push(s)}),new ei(e)}class Vt{constructor(e,t,i,s,a,l,d){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=a,this.data=l,this.documentState=d}static newInvalidDocument(e){return new Vt(e,0,et.min(),et.min(),et.min(),un.empty(),0)}static newFoundDocument(e,t,i,s){return new Vt(e,1,t,et.min(),i,s,0)}static newNoDocument(e,t){return new Vt(e,2,t,et.min(),et.min(),un.empty(),0)}static newUnknownDocument(e,t){return new Vt(e,3,t,et.min(),et.min(),un.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(et.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=et.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Cp{constructor(e,t=null,i=[],s=[],a=null,l=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=a,this.startAt=l,this.endAt=d,this.ft=null}}function qr(n,e=null,t=[],i=[],s=null,a=null,l=null){return new Cp(n,e,t,i,s,a,l)}function jr(n){const e=Qe(n);if(null===e.ft){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>Bi(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>{return(s=i).field.canonicalString()+s.dir;var s}).join(","),vo(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Pn(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Pn(i)).join(",")),e.ft=t}return e.ft}function Eo(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!cd(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!mc(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ti(n.startAt,e.startAt)&&Ti(n.endAt,e.endAt)}function Cs(n){return We.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}class Ui{constructor(e,t=null,i=[],s=[],a=null,l="F",d=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=a,this.limitType=l,this.startAt=d,this.endAt=p,this.dt=null,this._t=null}}function mr(n){return new Ui(n)}function fd(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function Mo(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function Po(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function Ra(n){return null!==n.collectionGroup}function _r(n){const e=Qe(n);if(null===e.dt){e.dt=[];const t=Po(e),i=Mo(e);if(null!==t&&null===i)t.isKeyField()||e.dt.push(new ai(t)),e.dt.push(new ai(rn.keyField(),"asc"));else{let s=!1;for(const a of e.explicitOrderBy)e.dt.push(a),a.field.isKeyField()&&(s=!0);if(!s){const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new ai(rn.keyField(),a))}}}return e.dt}function yn(n){const e=Qe(n);if(!e._t)if("F"===e.limitType)e._t=qr(e.path,e.collectionGroup,_r(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const a of _r(e))t.push(new ai(a.field,"desc"===a.dir?"asc":"desc"));const i=e.endAt?new ji(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new ji(e.startAt.position,e.startAt.inclusive):null;e._t=qr(e.path,e.collectionGroup,t,e.filters,e.limit,i,s)}return e._t}function yc(n,e){e.getFirstInequalityField(),Po(n);const t=n.filters.concat([e]);return new Ui(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ko(n,e,t){return new Ui(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Os(n,e){return Eo(yn(n),yn(e))&&n.limitType===e.limitType}function pd(n){return`${jr(yn(n))}|lt:${n.limitType}`}function La(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(i=>Io(i)).join(", ")}]`),vo(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(i=>{return`${(s=i).field.canonicalString()} (${s.dir})`;var s}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Pn(i)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Pn(i)).join(",")),`Target(${t})`}(yn(n))}; limitType=${n.limitType})`}function wc(n,e){return e.isFoundDocument()&&function(t,i){const s=i.key.path;return null!==t.collectionGroup?i.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(s):We.isDocumentKey(t.path)?t.path.isEqual(s):t.path.isImmediateParentOf(s)}(n,e)&&function(t,i){for(const s of _r(t))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(n,e)&&function(t,i){for(const s of t.filters)if(!s.matches(i))return!1;return!0}(n,e)&&(i=e,!((t=n).startAt&&!function(s,a,l){const d=sd(s,a,l);return s.inclusive?d<=0:d<0}(t.startAt,_r(t),i)||t.endAt&&!function(s,a,l){const d=sd(s,a,l);return s.inclusive?d>=0:d>0}(t.endAt,_r(t),i)));var t,i}function bc(n){return(e,t)=>{let i=!1;for(const s of _r(n)){const a=Cc(s,e,t);if(0!==a)return a;i=i||s.field.isKeyField()}return 0}}function Cc(n,e,t){const i=n.field.isKeyField()?We.comparator(e.key,t.key):function(s,a,l){const d=a.data.field(s),p=l.data.field(s);return null!==d&&null!==p?pr(d,p):Le()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Le()}}function gd(n,e){if(n.wt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yo(e)?"-0":e}}function Na(n){return{integerValue:""+n}}function Ct(n,e){return function ed(n){return"number"==typeof n&&Number.isInteger(n)&&!yo(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}(e)?Na(e):gd(n,e)}class qa{constructor(){this._=void 0}}function Op(n,e,t){return n instanceof Ts?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof Br?ti(n,e):n instanceof Ur?Ro(n,e):function(i,s){const a=Oc(i,s),l=Tc(a)+Tc(i.gt);return dc(a)&&dc(i.gt)?Na(l):gd(i.yt,l)}(n,e)}function Do(n,e,t){return n instanceof Br?ti(n,e):n instanceof Ur?Ro(n,e):t}function Oc(n,e){return n instanceof xr?dc(t=e)||(i=t)&&"doubleValue"in i?e:{integerValue:0}:null;var i,t}class Ts extends qa{}class Br extends qa{constructor(e){super(),this.elements=e}}function ti(n,e){const t=Ac(e);for(const i of n.elements)t.some(s=>Oi(s,i))||t.push(i);return{arrayValue:{values:t}}}class Ur extends qa{constructor(e){super(),this.elements=e}}function Ro(n,e){let t=Ac(e);for(const i of n.elements)t=t.filter(s=>!Oi(s,i));return{arrayValue:{values:t}}}class xr extends qa{constructor(e,t){super(),this.yt=e,this.gt=t}}function Tc(n){return on(n.integerValue||n.doubleValue)}function Ac(n){return bo(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Ic{constructor(e,t){this.version=e,this.transformResults=t}}class Wt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Wt}static exists(e){return new Wt(void 0,e)}static updateTime(e){return new Wt(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zr(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Lo{}function ja(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new Is(n.key,Wt.none()):new As(n.key,n.data,Wt.none());{const t=n.data,i=un.empty();let s=new Nt(rn.comparator);for(let a of e.fields)if(!s.has(a)){let l=t.field(a);null===l&&a.length>1&&(a=a.popLast(),l=t.field(a)),null===l?i.delete(a):i.set(a,l),s=s.add(a)}return new kn(n.key,i,new ei(s.toArray()),Wt.none())}}function md(n,e,t){n instanceof As?function(i,s,a){const l=i.value.clone(),d=Mc(i.fieldTransforms,s,a.transformResults);l.setAll(d),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof kn?function(i,s,a){if(!zr(i.precondition,s))return void s.convertToUnknownDocument(a.version);const l=Mc(i.fieldTransforms,s,a.transformResults),d=s.data;d.setAll(Sc(i)),d.setAll(l),s.convertToFoundDocument(a.version,d).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Zr(n,e,t,i){return n instanceof As?function(s,a,l,d){if(!zr(s.precondition,a))return l;const p=s.value.clone(),x=Ba(s.fieldTransforms,d,a);return p.setAll(x),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),null}(n,e,t,i):n instanceof kn?function(s,a,l,d){if(!zr(s.precondition,a))return l;const p=Ba(s.fieldTransforms,d,a),x=a.data;return x.setAll(Sc(s)),x.setAll(p),a.convertToFoundDocument(a.version,x).setHasLocalMutations(),null===l?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(b=>b.field))}(n,e,t,i):(l=t,zr(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l);var a,l}function Ec(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),a=Oc(i.transform,s||null);null!=a&&(null===t&&(t=un.empty()),t.set(i.field,a))}return t||null}function zi(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===i||t&&i&&_s(t,i,(s,a)=>function vr(n,e){return n.field.isEqual(e.field)&&(i=e.transform,(t=n.transform)instanceof Br&&i instanceof Br||t instanceof Ur&&i instanceof Ur?_s(t.elements,i.elements,Oi):t instanceof xr&&i instanceof xr?Oi(t.gt,i.gt):t instanceof Ts&&i instanceof Ts);var t,i}(s,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,i}class As extends Lo{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class kn extends Lo{constructor(e,t,i,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Sc(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function Mc(n,e,t){const i=new Map;Xe(n.length===t.length);for(let s=0;s<t.length;s++){const a=n[s],l=a.transform,d=e.data.field(a.field);i.set(a.field,Do(l,d,t[s]))}return i}function Ba(n,e,t){const i=new Map;for(const s of n){const a=s.transform,l=t.data.field(s.field);i.set(s.field,Op(a,l,e))}return i}class Is extends Lo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Pc extends Lo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Tp{constructor(e){this.count=e}}var hn,Et;function kc(n){if(void 0===n)return Zt("GRPC error has no .code"),re.UNKNOWN;switch(n){case hn.OK:return re.OK;case hn.CANCELLED:return re.CANCELLED;case hn.UNKNOWN:return re.UNKNOWN;case hn.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case hn.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case hn.INTERNAL:return re.INTERNAL;case hn.UNAVAILABLE:return re.UNAVAILABLE;case hn.UNAUTHENTICATED:return re.UNAUTHENTICATED;case hn.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case hn.NOT_FOUND:return re.NOT_FOUND;case hn.ALREADY_EXISTS:return re.ALREADY_EXISTS;case hn.PERMISSION_DENIED:return re.PERMISSION_DENIED;case hn.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case hn.ABORTED:return re.ABORTED;case hn.OUT_OF_RANGE:return re.OUT_OF_RANGE;case hn.UNIMPLEMENTED:return re.UNIMPLEMENTED;case hn.DATA_LOSS:return re.DATA_LOSS;default:return Le()}}(Et=hn||(hn={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";class Zi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0!==i)for(const[s,a]of i)if(this.equalsFn(s,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(void 0===s)return this.inner[i]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0===i)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return 1===i.length?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Xn(this.inner,(t,i)=>{for(const[s,a]of i)e(s,a)})}isEmpty(){return Xh(this.inner)}size(){return this.innerSize}}const Jn=new It(We.comparator);function en(){return Jn}const xd=new It(We.comparator);function Fo(...n){let e=xd;for(const t of n)e=e.insert(t.key,t);return e}function No(n){let e=xd;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Bn(){return Es()}function Dc(){return Es()}function Es(){return new Zi(n=>n.toString(),(n,e)=>n.isEqual(e))}const Ap=new It(We.comparator),vd=new Nt(We.comparator);function ft(...n){let e=vd;for(const t of n)e=e.add(t);return e}const qo=new Nt(ct);function Ua(){return qo}class Ss{constructor(e,t,i,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,Ms.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Ss(et.min(),s,Ua(),en(),ft())}}class Ms{constructor(e,t,i,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Ms(i,t,ft(),ft(),ft())}}class Qr{constructor(e,t,i,s){this.It=e,this.removedTargetIds=t,this.key=i,this.Tt=s}}class Rc{constructor(e,t){this.targetId=e,this.Et=t}}class jo{constructor(e,t,i=jt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class za{constructor(){this.At=0,this.Rt=Lc(),this.bt=jt.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}get current(){return this.Pt}get resumeToken(){return this.bt}get Vt(){return 0!==this.At}get St(){return this.vt}Dt(e){e.approximateByteSize()>0&&(this.vt=!0,this.bt=e)}Ct(){let e=ft(),t=ft(),i=ft();return this.Rt.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:Le()}}),new Ms(this.bt,this.Pt,e,t,i)}xt(){this.vt=!1,this.Rt=Lc()}Nt(e,t){this.vt=!0,this.Rt=this.Rt.insert(e,t)}kt(e){this.vt=!0,this.Rt=this.Rt.remove(e)}Ot(){this.At+=1}Mt(){this.At-=1}Ft(){this.vt=!0,this.Pt=!0}}class Za{constructor(e){this.$t=e,this.Bt=new Map,this.Lt=en(),this.qt=yd(),this.Ut=new Nt(ct)}Kt(e){for(const t of e.It)e.Tt&&e.Tt.isFoundDocument()?this.Gt(t,e.Tt):this.Qt(t,e.key,e.Tt);for(const t of e.removedTargetIds)this.Qt(t,e.key,e.Tt)}jt(e){this.forEachTarget(e,t=>{const i=this.Wt(t);switch(e.state){case 0:this.zt(t)&&i.Dt(e.resumeToken);break;case 1:i.Mt(),i.Vt||i.xt(),i.Dt(e.resumeToken);break;case 2:i.Mt(),i.Vt||this.removeTarget(t);break;case 3:this.zt(t)&&(i.Ft(),i.Dt(e.resumeToken));break;case 4:this.zt(t)&&(this.Ht(t),i.Dt(e.resumeToken));break;default:Le()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Bt.forEach((i,s)=>{this.zt(s)&&t(s)})}Jt(e){const t=e.targetId,i=e.Et.count,s=this.Yt(t);if(s){const a=s.target;if(Cs(a))if(0===i){const l=new We(a.path);this.Qt(t,l,Vt.newNoDocument(l,et.min()))}else Xe(1===i);else this.Xt(t)!==i&&(this.Ht(t),this.Ut=this.Ut.add(t))}}Zt(e){const t=new Map;this.Bt.forEach((a,l)=>{const d=this.Yt(l);if(d){if(a.current&&Cs(d.target)){const p=new We(d.target.path);null!==this.Lt.get(p)||this.te(l,p)||this.Qt(l,p,Vt.newNoDocument(p,e))}a.St&&(t.set(l,a.Ct()),a.xt())}});let i=ft();this.qt.forEach((a,l)=>{let d=!0;l.forEachWhile(p=>{const x=this.Yt(p);return!x||2===x.purpose||(d=!1,!1)}),d&&(i=i.add(a))}),this.Lt.forEach((a,l)=>l.setReadTime(e));const s=new Ss(e,t,this.Ut,this.Lt,i);return this.Lt=en(),this.qt=yd(),this.Ut=new Nt(ct),s}Gt(e,t){if(!this.zt(e))return;const i=this.te(e,t.key)?2:0;this.Wt(e).Nt(t.key,i),this.Lt=this.Lt.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ee(t.key).add(e))}Qt(e,t,i){if(!this.zt(e))return;const s=this.Wt(e);this.te(e,t)?s.Nt(t,1):s.kt(t),this.qt=this.qt.insert(t,this.ee(t).delete(e)),i&&(this.Lt=this.Lt.insert(t,i))}removeTarget(e){this.Bt.delete(e)}Xt(e){const t=this.Wt(e).Ct();return this.$t.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ot(e){this.Wt(e).Ot()}Wt(e){let t=this.Bt.get(e);return t||(t=new za,this.Bt.set(e,t)),t}ee(e){let t=this.qt.get(e);return t||(t=new Nt(ct),this.qt=this.qt.insert(e,t)),t}zt(e){const t=null!==this.Yt(e);return t||ke("WatchChangeAggregator","Detected inactive target",e),t}Yt(e){const t=this.Bt.get(e);return t&&t.Vt?null:this.$t.ne(e)}Ht(e){this.Bt.set(e,new za),this.$t.getRemoteKeysForTarget(e).forEach(t=>{this.Qt(e,t,null)})}te(e,t){return this.$t.getRemoteKeysForTarget(e).has(t)}}function yd(){return new It(We.comparator)}function Lc(){return new It(We.comparator)}const Qa={asc:"ASCENDING",desc:"DESCENDING"},wd={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Fc={and:"AND",or:"OR"};class Ip{constructor(e,t){this.databaseId=e,this.wt=t}}function Vr(n,e){return n.wt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ai(n,e){return n.wt?e.toBase64():e.toUint8Array()}function bd(n,e){return Vr(n,e.toTimestamp())}function an(n){return Xe(!!n),et.fromTimestamp(function(e){const t=dr(e);return new Xt(t.seconds,t.nanos)}(n))}function Nc(n,e){return(t=n,new At(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function qc(n){const e=At.fromString(n);return Xe(Dn(e)),e}function Bo(n,e){return Nc(n.databaseId,e.path)}function Ii(n,e){const t=qc(e);if(t.get(1)!==n.databaseId.projectId)throw new Ie(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ie(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new We(Wa(t))}function mi(n,e){return Nc(n.databaseId,e)}function Wr(n){return new At(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Wa(n){return Xe(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function Uo(n,e,t){return{name:Bo(n,e),fields:t.value.mapValue.fields}}function Ka(n,e){return{documents:[mi(n,e.path)]}}function Ja(n,e){const t={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(t.parent=mi(n,i),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=mi(n,i.popLast()),t.structuredQuery.from=[{collectionId:i.lastSegment()}]);const s=function(p){if(0!==p.length)return Ad(bt.create(p,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const a=function(p){if(0!==p.length)return p.map(x=>{return{field:Ps((b=x).field),direction:Od(b.dir)};var b})}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=(x=e.limit,n.wt||vo(x)?x:{value:x});var x,d,p;return null!==l&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt={before:(d=e.startAt).inclusive,values:d.position}),e.endAt&&(t.structuredQuery.endAt={before:!(p=e.endAt).inclusive,values:p.position}),t}function En(n){let e=function Va(n){const e=qc(n);return 4===e.length?At.emptyPath():Wa(e)}(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){Xe(1===i);const b=t.from[0];b.allDescendants?s=b.collectionId:e=e.child(b.collectionId)}let a=[];t.where&&(a=function(b){const I=Cd(b);return I instanceof bt&&gc(I)?I.getFilters():[I]}(t.where));let l=[];t.orderBy&&(l=t.orderBy.map(b=>{return new ai(ks((I=b).field),function(G){switch(G){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(I.direction));var I}));let d=null;t.limit&&(d=function(b){let I;return I="object"==typeof b?b.value:b,vo(I)?null:I}(t.limit));let p=null;var b;t.startAt&&(p=new ji((b=t.startAt).values||[],!!b.before));let x=null;return t.endAt&&(x=function(b){return new ji(b.values||[],!b.before)}(t.endAt)),function vc(n,e,t,i,s,a,l,d){return new Ui(n,e,t,i,s,a,l,d)}(e,s,l,a,d,"F",p,x)}function Cd(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=ks(e.unaryFilter.field);return vt.create(t,"==",{doubleValue:NaN});case"IS_NULL":const i=ks(e.unaryFilter.field);return vt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ks(e.unaryFilter.field);return vt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ks(e.unaryFilter.field);return vt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Le()}}(n):void 0!==n.fieldFilter?vt.create(ks((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Le()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return bt.create(e.compositeFilter.filters.map(t=>Cd(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Le()}}(e.compositeFilter.op))}(n):Le();var e}function Od(n){return Qa[n]}function Mp(n){return wd[n]}function Td(n){return Fc[n]}function Ps(n){return{fieldPath:n.canonicalString()}}function ks(n){return rn.fromServerFormat(n.fieldPath)}function Ad(n){return n instanceof vt?function(e){if("=="===e.op){if(fc(e.value))return{unaryFilter:{field:Ps(e.field),op:"IS_NAN"}};if(nd(e.value))return{unaryFilter:{field:Ps(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(fc(e.value))return{unaryFilter:{field:Ps(e.field),op:"IS_NOT_NAN"}};if(nd(e.value))return{unaryFilter:{field:Ps(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ps(e.field),op:Mp(e.op),value:e.value}}}(n):n instanceof bt?function(e){const t=e.getFilters().map(i=>Ad(i));return 1===t.length?t[0]:{compositeFilter:{op:Td(e.op),filters:t}}}(n):Le()}function Vi(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Dn(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class Qc{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&md(a,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Zr(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Zr(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=Dc();return this.mutations.forEach(s=>{const a=e.get(s.key),l=a.overlayedDocument;let d=this.applyToLocalView(l,a.mutatedFields);d=t.has(s.key)?null:d;const p=ja(l,d);null!==p&&i.set(s.key,p),l.isValidDocument()||l.convertToNoDocument(et.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ft())}isEqual(e){return this.batchId===e.batchId&&_s(this.mutations,e.mutations,(t,i)=>zi(t,i))&&_s(this.baseMutations,e.baseMutations,(t,i)=>zi(t,i))}}class Vc{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){Xe(e.mutations.length===i.length);let s=Ap;const a=e.mutations;for(let l=0;l<a.length;l++)s=s.insert(a[l].key,i[l].version);return new Vc(e,t,i,s)}}class Wc{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class br{constructor(e,t,i,s,a=et.min(),l=et.min(),d=jt.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d}withSequenceNumber(e){return new br(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new br(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Fd{constructor(e){this.ie=e}}function Gc(n){const e=En({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?ko(e,e.limit,"L"):e}class bn{constructor(){}ue(e,t){this.ce(e,t),t.ae()}ce(e,t){if("nullValue"in e)this.he(t,5);else if("booleanValue"in e)this.he(t,10),t.le(e.booleanValue?1:0);else if("integerValue"in e)this.he(t,15),t.le(on(e.integerValue));else if("doubleValue"in e){const i=on(e.doubleValue);isNaN(i)?this.he(t,13):(this.he(t,15),yo(i)?t.le(0):t.le(i))}else if("timestampValue"in e){const i=e.timestampValue;this.he(t,20),"string"==typeof i?t.fe(i):(t.fe(`${i.seconds||""}`),t.le(i.nanos||0))}else if("stringValue"in e)this.de(e.stringValue,t),this._e(t);else if("bytesValue"in e)this.he(t,30),t.we(Lr(e.bytesValue)),this._e(t);else if("referenceValue"in e)this.me(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.he(t,45),t.le(i.latitude||0),t.le(i.longitude||0)}else"mapValue"in e?id(e)?this.he(t,Number.MAX_SAFE_INTEGER):(this.ge(e.mapValue,t),this._e(t)):"arrayValue"in e?(this.ye(e.arrayValue,t),this._e(t)):Le()}de(e,t){this.he(t,25),this.pe(e,t)}pe(e,t){t.fe(e)}ge(e,t){const i=e.fields||{};this.he(t,55);for(const s of Object.keys(i))this.de(s,t),this.ce(i[s],t)}ye(e,t){const i=e.values||[];this.he(t,50);for(const s of i)this.ce(s,t)}me(e,t){this.he(t,37),We.fromName(e).path.forEach(i=>{this.he(t,60),this.pe(i,t)})}he(e,t){e.le(t)}_e(e){e.le(2)}}bn.Ie=new bn;class Qp{constructor(){this.Je=new eu}addToCollectionParentIndex(e,t){return this.Je.add(t),te.resolve()}getCollectionParents(e,t){return te.resolve(this.Je.getEntries(t))}addFieldIndex(e,t){return te.resolve()}deleteFieldIndex(e,t){return te.resolve()}getDocumentsMatchingTarget(e,t){return te.resolve(null)}getIndexType(e,t){return te.resolve(0)}getFieldIndexes(e,t){return te.resolve([])}getNextCollectionGroupToUpdate(e){return te.resolve(null)}getMinOffset(e,t){return te.resolve(jn.min())}getMinOffsetFromCollectionGroup(e,t){return te.resolve(jn.min())}updateCollectionGroup(e,t,i){return te.resolve()}updateIndexEntries(e,t){return te.resolve()}}class eu{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new Nt(At.comparator),a=!s.has(i);return this.index[t]=s.add(i),a}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new Nt(At.comparator)).toArray()}}new Uint8Array(0);class Rn{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new Rn(e,Rn.DEFAULT_COLLECTION_PERCENTILE,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Rn.DEFAULT_COLLECTION_PERCENTILE=10,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rn.DEFAULT=new Rn(41943040,Rn.DEFAULT_COLLECTION_PERCENTILE,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rn.DISABLED=new Rn(-1,0,0);class Yr{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new Yr(0)}static vn(){return new Yr(-1)}}class Yp{constructor(){this.changes=new Zi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return void 0!==i?te.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class eg{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class nu{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(i=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(null!==i&&Zr(i.mutation,s,ei.empty(),Xt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,ft()).next(()=>i))}getLocalViewOfDocuments(e,t,i=ft()){const s=Bn();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,i).next(a=>{let l=Fo();return a.forEach((d,p)=>{l=l.insert(d,p.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const i=Bn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,ft()))}populateOverlays(e,t,i){const s=[];return i.forEach(a=>{t.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((l,d)=>{t.set(l,d)})})}computeViews(e,t,i,s){let a=en();const l=Es(),d=Es();return t.forEach((p,x)=>{const b=i.get(x.key);s.has(x.key)&&(void 0===b||b.mutation instanceof kn)?a=a.insert(x.key,x):void 0!==b&&(l.set(x.key,b.mutation.getFieldMask()),Zr(b.mutation,x,b.mutation.getFieldMask(),Xt.now()))}),this.recalculateAndSaveOverlays(e,a).next(p=>(p.forEach((x,b)=>l.set(x,b)),t.forEach((x,b)=>{var I;return d.set(x,new eg(b,null!==(I=l.get(x))&&void 0!==I?I:null))}),d))}recalculateAndSaveOverlays(e,t){const i=Es();let s=new It((l,d)=>l-d),a=ft();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const d of l)d.keys().forEach(p=>{const x=t.get(p);if(null===x)return;let b=i.get(p)||ei.empty();b=d.applyToLocalView(x,b),i.set(p,b);const I=(s.get(d.batchId)||ft()).add(p);s=s.insert(d.batchId,I)})}).next(()=>{const l=[],d=s.getReverseIterator();for(;d.hasNext();){const p=d.getNext(),x=p.key,b=p.value,I=Dc();b.forEach(G=>{if(!a.has(G)){const _e=ja(t.get(G),i.get(G));null!==_e&&I.set(G,_e),a=a.add(G)}}),l.push(this.documentOverlayCache.saveOverlays(e,x,I))}return te.waitFor(l)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i){return We.isDocumentKey((s=t).path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Ra(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i):this.getDocumentsMatchingCollectionQuery(e,t,i);var s}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next(a=>{const l=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-a.size):te.resolve(Bn());let d=-1,p=a;return l.next(x=>te.forEach(x,(b,I)=>(d<I.largestBatchId&&(d=I.largestBatchId),a.get(b)?te.resolve():this.remoteDocumentCache.getEntry(e,b).next(G=>{p=p.insert(b,G)}))).next(()=>this.populateOverlays(e,x,a)).next(()=>this.computeViews(e,p,x,ft())).next(b=>({batchId:d,changes:No(b)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new We(t)).next(i=>{let s=Fo();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,i){const s=t.collectionGroup;let a=Fo();return this.indexManager.getCollectionParents(e,s).next(l=>te.forEach(l,d=>{const p=(x=t,b=d.child(s),new Ui(b,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt));var x,b;return this.getDocumentsMatchingCollectionQuery(e,p,i).next(x=>{x.forEach((b,I)=>{a=a.insert(b,I)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,i){let s;return this.remoteDocumentCache.getAllFromCollection(e,t.path,i).next(a=>(s=a,this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId))).next(a=>{a.forEach((d,p)=>{const x=p.getKey();null===s.get(x)&&(s=s.insert(x,Vt.newInvalidDocument(x)))});let l=Fo();return s.forEach((d,p)=>{const x=a.get(d);void 0!==x&&Zr(x.mutation,p,ei.empty(),Xt.now()),wc(t,p)&&(l=l.insert(d,p))}),l})}}class sf{constructor(e){this.yt=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return te.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var i;return this.Zn.set(t.id,{id:(i=t).id,version:i.version,createTime:an(i.createTime)}),te.resolve()}getNamedQuery(e,t){return te.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,{name:(i=t).name,query:Gc(i.bundledQuery),readTime:an(i.readTime)}),te.resolve();var i}}class tg{constructor(){this.overlays=new It(We.comparator),this.es=new Map}getOverlay(e,t){return te.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Bn();return te.forEach(t,s=>this.getOverlay(e,s).next(a=>{null!==a&&i.set(s,a)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((s,a)=>{this.oe(e,t,a)}),te.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.es.get(i);return void 0!==s&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.es.delete(i)),te.resolve()}getOverlaysForCollection(e,t,i){const s=Bn(),a=t.length+1,l=new We(t.child("")),d=this.overlays.getIteratorFrom(l);for(;d.hasNext();){const p=d.getNext().value,x=p.getKey();if(!t.isPrefixOf(x.path))break;x.path.length===a&&p.largestBatchId>i&&s.set(p.getKey(),p)}return te.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let a=new It((x,b)=>x-b);const l=this.overlays.getIterator();for(;l.hasNext();){const x=l.getNext().value;if(x.getKey().getCollectionGroup()===t&&x.largestBatchId>i){let b=a.get(x.largestBatchId);null===b&&(b=Bn(),a=a.insert(x.largestBatchId,b)),b.set(x.getKey(),x)}}const d=Bn(),p=a.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((x,b)=>d.set(x,b)),!(d.size()>=s)););return te.resolve(d)}oe(e,t,i){const s=this.overlays.get(i.key);if(null!==s){const l=this.es.get(s.largestBatchId).delete(i.key);this.es.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new Wc(t,i));let a=this.es.get(t);void 0===a&&(a=ft(),this.es.set(t,a)),this.es.set(t,a.add(i.key))}}class iu{constructor(){this.ns=new Nt(Cn.ss),this.rs=new Nt(Cn.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const i=new Cn(e,t);this.ns=this.ns.add(i),this.rs=this.rs.add(i)}us(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.cs(new Cn(e,t))}hs(e,t){e.forEach(i=>this.removeReference(i,t))}ls(e){const t=new We(new At([])),i=new Cn(t,e),s=new Cn(t,e+1),a=[];return this.rs.forEachInRange([i,s],l=>{this.cs(l),a.push(l.key)}),a}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new We(new At([])),i=new Cn(t,e),s=new Cn(t,e+1);let a=ft();return this.rs.forEachInRange([i,s],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new Cn(e,0),i=this.ns.firstAfterOrEqual(t);return null!==i&&e.isEqual(i.key)}}class Cn{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return We.comparator(e.key,t.key)||ct(e._s,t._s)}static os(e,t){return ct(e._s,t._s)||We.comparator(e.key,t.key)}}class ng{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new Nt(Cn.ss)}checkEmpty(e){return te.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,i,s){const a=this.ws;this.ws++;const l=new Qc(a,t,i,s);this.mutationQueue.push(l);for(const d of s)this.gs=this.gs.add(new Cn(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return te.resolve(l)}lookupMutationBatch(e,t){return te.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const s=this.ps(t+1),a=s<0?0:s;return te.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return te.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Cn(t,0),s=new Cn(t,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([i,s],l=>{const d=this.ys(l._s);a.push(d)}),te.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Nt(ct);return t.forEach(s=>{const a=new Cn(s,0),l=new Cn(s,Number.POSITIVE_INFINITY);this.gs.forEachInRange([a,l],d=>{i=i.add(d._s)})}),te.resolve(this.Is(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let a=i;We.isDocumentKey(a)||(a=a.child(""));const l=new Cn(new We(a),0);let d=new Nt(ct);return this.gs.forEachWhile(p=>{const x=p.key.path;return!!i.isPrefixOf(x)&&(x.length===s&&(d=d.add(p._s)),!0)},l),te.resolve(this.Is(d))}Is(e){const t=[];return e.forEach(i=>{const s=this.ys(i);null!==s&&t.push(s)}),t}removeMutationBatch(e,t){Xe(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let i=this.gs;return te.forEach(t.mutations,s=>{const a=new Cn(s.key,t.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.gs=i})}An(e){}containsKey(e,t){const i=new Cn(t,0),s=this.gs.firstAfterOrEqual(i);return te.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return te.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class al{constructor(e){this.Es=e,this.docs=new It(We.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),a=s?s.size:0,l=this.Es(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return te.resolve(i?i.document.mutableCopy():Vt.newInvalidDocument(t))}getEntries(e,t){let i=en();return t.forEach(s=>{const a=this.docs.get(s);i=i.insert(s,a?a.document.mutableCopy():Vt.newInvalidDocument(s))}),te.resolve(i)}getAllFromCollection(e,t,i){let s=en();const a=new We(t.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:p}}=l.getNext();if(!t.isPrefixOf(d.path))break;d.path.length>t.length+1||lr(xs(p),i)<=0||(s=s.insert(p.key,p.mutableCopy()))}return te.resolve(s)}getAllFromCollectionGroup(e,t,i,s){Le()}As(e,t){return te.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new ig(this)}getSize(e){return te.resolve(this.size)}}class ig extends Yp{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?t.push(this.Yn.addEntry(e,s)):this.Yn.removeEntry(i)}),te.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class rg{constructor(e){this.persistence=e,this.Rs=new Zi(t=>jr(t),Eo),this.lastRemoteSnapshotVersion=et.min(),this.highestTargetId=0,this.bs=0,this.Ps=new iu,this.targetCount=0,this.vs=Yr.Pn()}forEachTarget(e,t){return this.Rs.forEach((i,s)=>t(s)),te.resolve()}getLastRemoteSnapshotVersion(e){return te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return te.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),te.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.bs&&(this.bs=t),te.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new Yr(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,te.resolve()}updateTargetData(e,t){return this.Dn(t),te.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,te.resolve()}removeTargets(e,t,i){let s=0;const a=[];return this.Rs.forEach((l,d)=>{d.sequenceNumber<=t&&null===i.get(d.targetId)&&(this.Rs.delete(l),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),s++)}),te.waitFor(a).next(()=>s)}getTargetCount(e){return te.resolve(this.targetCount)}getTargetData(e,t){const i=this.Rs.get(t)||null;return te.resolve(i)}addMatchingKeys(e,t,i){return this.Ps.us(t,i),te.resolve()}removeMatchingKeys(e,t,i){this.Ps.hs(t,i);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach(l=>{a.push(s.markPotentiallyOrphaned(e,l))}),te.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),te.resolve()}getMatchingKeysForTargetId(e,t){const i=this.Ps.ds(t);return te.resolve(i)}containsKey(e,t){return te.resolve(this.Ps.containsKey(t))}}class of{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new ut(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new rg(this),this.indexManager=new Qp,this.remoteDocumentCache=new al(i=>this.referenceDelegate.xs(i)),this.yt=new Fd(t),this.Ns=new sf(this.yt)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new tg,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Vs[e.toKey()];return i||(i=new ng(t,this.referenceDelegate),this.Vs[e.toKey()]=i),i}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,i){ke("MemoryPersistence","Starting transaction:",e);const s=new sg(this.Ss.next());return this.referenceDelegate.ks(),i(s).next(a=>this.referenceDelegate.Os(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Ms(e,t){return te.or(Object.values(this.Vs).map(i=>()=>i.containsKey(e,t)))}}class sg extends mo{constructor(e){super(),this.currentSequenceNumber=e}}class ll{constructor(e){this.persistence=e,this.Fs=new iu,this.$s=null}static Bs(e){return new ll(e)}get Ls(){if(this.$s)return this.$s;throw Le()}addReference(e,t,i){return this.Fs.addReference(i,t),this.Ls.delete(i.toString()),te.resolve()}removeReference(e,t,i){return this.Fs.removeReference(i,t),this.Ls.add(i.toString()),te.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),te.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach(s=>this.Ls.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(a=>this.Ls.add(a.toString()))}).next(()=>i.removeTargetData(e,t))}ks(){this.$s=new Set}Os(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return te.forEach(this.Ls,i=>{const s=We.fromPath(i);return this.qs(e,s).next(a=>{a||t.removeEntry(s,et.min())})}).next(()=>(this.$s=null,t.apply(e)))}updateLimboDocument(e,t){return this.qs(e,t).next(i=>{i?this.Ls.delete(t.toString()):this.Ls.add(t.toString())})}xs(e){return 0}qs(e,t){return te.or([()=>te.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ms(e,t)])}}class ou{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.Si=i,this.Di=s}static Ci(e,t){let i=ft(),s=ft();for(const a of t.docChanges)switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new ou(e,t.fromCache,i,s)}}class au{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,i,s){return this.ki(e,t).next(a=>a||this.Oi(e,t,s,i)).next(a=>a||this.Mi(e,t))}ki(e,t){if(fd(t))return te.resolve(null);let i=yn(t);return this.indexManager.getIndexType(e,i).next(s=>0===s?null:(null!==t.limit&&1===s&&(t=ko(t,null,"F"),i=yn(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(a=>{const l=ft(...a);return this.Ni.getDocuments(e,l).next(d=>this.indexManager.getMinOffset(e,i).next(p=>{const x=this.Fi(t,d);return this.$i(t,x,l,p.readTime)?this.ki(e,ko(t,null,"F")):this.Bi(e,x,t,p)}))})))}Oi(e,t,i,s){return fd(t)||s.isEqual(et.min())?this.Mi(e,t):this.Ni.getDocuments(e,i).next(a=>{const l=this.Fi(t,a);return this.$i(t,l,i,s)?this.Mi(e,t):(Kn()<=m.in.DEBUG&&ke("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),La(t)),this.Bi(e,l,t,function Aa(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=et.fromTimestamp(1e9===i?new Xt(t+1,0):new Xt(t,i));return new jn(s,We.empty(),e)}(s,-1)))})}Fi(e,t){let i=new Nt(bc(e));return t.forEach((s,a)=>{wc(e,a)&&(i=i.add(a))}),i}$i(e,t,i,s){if(null===e.limit)return!1;if(i.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Mi(e,t){return Kn()<=m.in.DEBUG&&ke("QueryEngine","Using full collection scan to execute query:",La(t)),this.Ni.getDocumentsMatchingQuery(e,t,jn.min())}Bi(e,t,i,s){return this.Ni.getDocumentsMatchingQuery(e,i,s).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}class lf{constructor(e,t,i,s){this.persistence=e,this.Li=t,this.yt=s,this.qi=new It(ct),this.Ui=new Zi(a=>jr(a),Eo),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(i)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nu(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.qi))}}function lu(n,e){return hl.apply(this,arguments)}function hl(){return hl=(0,O.Z)(function*(n,e){const t=Qe(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next(a=>(s=a,t.Qi(e),t.mutationQueue.getAllMutationBatches(i))).next(a=>{const l=[],d=[];let p=ft();for(const x of s){l.push(x.batchId);for(const b of x.mutations)p=p.add(b.key)}for(const x of a){d.push(x.batchId);for(const b of x.mutations)p=p.add(b.key)}return t.localDocuments.getDocuments(i,p).next(x=>({ji:x,removedBatchIds:l,addedBatchIds:d}))})})}),hl.apply(this,arguments)}function cu(n){const e=Qe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Cs.getLastRemoteSnapshotVersion(t))}function lg(n,e){const t=Qe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Gi(n,e,t){return uu.apply(this,arguments)}function uu(){return uu=(0,O.Z)(function*(n,e,t){const i=Qe(n),s=i.qi.get(e),a=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",a,l=>i.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!fi(l))throw l;ke("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}i.qi=i.qi.remove(e),i.Ui.delete(s.target)}),uu.apply(this,arguments)}function dl(n,e,t){const i=Qe(n);let s=et.min(),a=ft();return i.persistence.runTransaction("Execute query","readonly",l=>function(d,p,x){const b=Qe(d),I=b.Ui.get(x);return void 0!==I?te.resolve(b.qi.get(I)):b.Cs.getTargetData(p,x)}(i,l,yn(e)).next(d=>{if(d)return s=d.lastLimboFreeSnapshotVersion,i.Cs.getMatchingKeysForTargetId(l,d.targetId).next(p=>{a=p})}).next(()=>i.Li.getDocumentsMatchingQuery(l,e,t?s:et.min(),t?a:ft())).next(d=>(function hf(n,e,t){let i=n.Ki.get(e)||et.min();t.forEach((s,a)=>{a.readTime.compareTo(i)>0&&(i=a.readTime)}),n.Ki.set(e,i)}(i,function Fa(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}(e),d),{documents:d,Hi:a})))}class ni{constructor(){this.activeTargetIds=Ua()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pf{constructor(){this.Lr=new ni,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.Lr.er(e),this.qr[e]||"not-current"}updateQueryState(e,t,i){this.qr[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.qr[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new ni,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class es{Ur(e){}shutdown(){}}class _t{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}Ur(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){ke("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){ke("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const hg={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class $n{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class dn extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.oo=(e.ssl?"https":"http")+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,t,i,s,a){const l=this.ho(e,t);ke("RestConnection","Sending: ",l,i);const d={};return this.lo(d,s,a),this.fo(e,l,d,i).then(p=>(ke("RestConnection","Received: ",p),p),p=>{throw qi("RestConnection",`${e} failed with error: `,p,"url: ",l,"request:",i),p})}_o(e,t,i,s,a,l){return this.ao(e,t,i,s,a)}lo(e,t,i){e["X-Goog-Api-Client"]="gl-js/ fire/"+ir,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,a)=>e[a]=s),i&&i.headers.forEach((s,a)=>e[a]=s)}ho(e,t){return`${this.oo}/v1/${t}:${hg[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,t,i,s){return new Promise((a,l)=>{const d=new Pt;d.setWithCredentials(!0),d.listenOnce(z.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case gs.NO_ERROR:const x=d.getResponseJson();ke("Connection","XHR received:",JSON.stringify(x)),a(x);break;case gs.TIMEOUT:ke("Connection",'RPC "'+e+'" timed out'),l(new Ie(re.DEADLINE_EXCEEDED,"Request time out"));break;case gs.HTTP_ERROR:const b=d.getStatus();if(ke("Connection",'RPC "'+e+'" failed with status:',b,"response text:",d.getResponseText()),b>0){let I=d.getResponseJson();Array.isArray(I)&&(I=I[0]);const G=I?.error;if(G&&G.status&&G.message){const _e=function(Ee){const Ke=Ee.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf(Ke)>=0?Ke:re.UNKNOWN}(G.status);l(new Ie(_e,G.message))}else l(new Ie(re.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new Ie(re.UNAVAILABLE,"Connection failed."));break;default:Le()}}finally{ke("Connection",'RPC "'+e+'" completed.')}});const p=JSON.stringify(s);d.send(t,"POST",p,i,15)})}wo(e,t,i){const s=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=fp(),l=pp(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(d.xmlHttpFactory=new Ye({})),this.lo(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;const p=s.join("");ke("Connection","Creating WebChannel: "+p,d);const x=a.createWebChannel(p,d);let b=!1,I=!1;const G=new $n({Hr:Ee=>{I?ke("Connection","Not sending because WebChannel is closed:",Ee):(b||(ke("Connection","Opening WebChannel transport."),x.open(),b=!0),ke("Connection","WebChannel sending:",Ee),x.send(Ee))},Jr:()=>x.close()}),_e=(Ee,Ke,it)=>{Ee.listen(Ke,Ht=>{try{it(Ht)}catch(pn){setTimeout(()=>{throw pn},0)}})};return _e(x,dt.EventType.OPEN,()=>{I||ke("Connection","WebChannel transport opened.")}),_e(x,dt.EventType.CLOSE,()=>{I||(I=!0,ke("Connection","WebChannel transport closed"),G.io())}),_e(x,dt.EventType.ERROR,Ee=>{I||(I=!0,qi("Connection","WebChannel transport errored:",Ee),G.io(new Ie(re.UNAVAILABLE,"The operation could not be completed")))}),_e(x,dt.EventType.MESSAGE,Ee=>{var Ke;if(!I){const it=Ee.data[0];Xe(!!it);const pn=it.error||(null===(Ke=it[0])||void 0===Ke?void 0:Ke.error);if(pn){ke("Connection","WebChannel received error:",pn);const Ut=pn.status;let Fn=function(qt){const Qn=hn[qt];if(void 0!==Qn)return kc(Qn)}(Ut),Gt=pn.message;void 0===Fn&&(Fn=re.INTERNAL,Gt="Unknown error status: "+Ut+" with message "+pn.message),I=!0,G.io(new Ie(Fn,Gt)),x.close()}else ke("Connection","WebChannel received:",it),G.ro(it)}}),_e(l,he.STAT_EVENT,Ee=>{Ee.stat===se.PROXY?ke("Connection","Detected buffering proxy"):Ee.stat===se.NOPROXY&&ke("Connection","Detected no buffering proxy")}),setTimeout(()=>{G.so()},0),G}}function xi(){return typeof document<"u"?document:null}function $o(n){return new Ip(n,!0)}class _u{constructor(e,t,i=1e3,s=1.5,a=6e4){this.Hs=e,this.timerId=t,this.mo=i,this.yo=s,this.po=a,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const t=Math.floor(this.Io+this.bo()),i=Math.max(0,Date.now()-this.Eo),s=Math.max(0,t-i);s>0&&ke("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Io} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class mf{constructor(e,t,i,s,a,l,d,p){this.Hs=e,this.vo=i,this.Vo=s,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=d,this.listener=p,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new _u(e,t)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var e=this;return(0,O.Z)(function*(){e.No()&&(yield e.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(e){this.Lo(),this.stream.send(e)}$o(){var e=this;return(0,O.Z)(function*(){if(e.ko())return e.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}qo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(e,t){var i=this;return(0,O.Z)(function*(){i.Lo(),i.qo(),i.xo.cancel(),i.So++,4!==e?i.xo.reset():t&&t.code===re.RESOURCE_EXHAUSTED?(Zt(t.toString()),Zt("Using maximum backoff delay to prevent overloading the backend."),i.xo.Ao()):t&&t.code===re.UNAUTHENTICATED&&3!==i.state&&(i.authCredentialsProvider.invalidateToken(),i.appCheckCredentialsProvider.invalidateToken()),null!==i.stream&&(i.Uo(),i.stream.close(),i.stream=null),i.state=e,yield i.listener.Zr(t)})()}Uo(){}auth(){this.state=1;const e=this.Ko(this.So),t=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.So===t&&this.Go(i,s)},i=>{e(()=>{const s=new Ie(re.UNKNOWN,"Fetching auth token failed: "+i.message);return this.Qo(s)})})}Go(e,t){const i=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr(()=>{i(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(s=>{i(()=>this.Qo(s))}),this.stream.onMessage(s=>{i(()=>this.onMessage(s))})}Oo(){var e=this;this.state=5,this.xo.Ro((0,O.Z)(function*(){e.state=0,e.start()}))}Qo(e){return ke("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return t=>{this.Hs.enqueueAndForget(()=>this.So===e?t():(ke("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dg extends mf{constructor(e,t,i,s,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,l),this.yt=a}jo(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.xo.reset();const t=function Ga(n,e){let t;if("targetChange"in e){const i="NO_CHANGE"===(p=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===p?1:"REMOVE"===p?2:"CURRENT"===p?3:"RESET"===p?4:Le(),s=e.targetChange.targetIds||[],a=function(p,x){return p.wt?(Xe(void 0===x||"string"==typeof x),jt.fromBase64String(x||"")):(Xe(void 0===x||x instanceof Uint8Array),jt.fromUint8Array(x||new Uint8Array))}(n,e.targetChange.resumeToken),l=e.targetChange.cause,d=l&&function(p){const x=void 0===p.code?re.UNKNOWN:kc(p.code);return new Ie(x,p.message||"")}(l);t=new jo(i,s,a,d||null)}else if("documentChange"in e){const i=e.documentChange,s=Ii(n,i.document.name),a=an(i.document.updateTime),l=i.document.createTime?an(i.document.createTime):et.min(),d=new un({mapValue:{fields:i.document.fields}}),p=Vt.newFoundDocument(s,a,l,d);t=new Qr(i.targetIds||[],i.removedTargetIds||[],p.key,p)}else if("documentDelete"in e){const i=e.documentDelete,s=Ii(n,i.document),a=i.readTime?an(i.readTime):et.min(),l=Vt.newNoDocument(s,a);t=new Qr([],i.removedTargetIds||[],l.key,l)}else if("documentRemove"in e){const i=e.documentRemove,s=Ii(n,i.document);t=new Qr([],i.removedTargetIds||[],s,null)}else{if(!("filter"in e))return Le();{const i=e.filter,a=new Tp(i.count||0);t=new Rc(i.targetId,a)}}var p;return t}(this.yt,e),i=function(s){if(!("targetChange"in s))return et.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?et.min():a.readTime?an(a.readTime):et.min()}(e);return this.listener.Wo(t,i)}zo(e){const t={};t.database=Wr(this.yt),t.addTarget=function(s,a){let l;const d=a.target;return l=Cs(d)?{documents:Ka(s,d)}:{query:Ja(s,d)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0?l.resumeToken=Ai(s,a.resumeToken):a.snapshotVersion.compareTo(et.min())>0&&(l.readTime=Vr(s,a.snapshotVersion.toTimestamp())),l}(this.yt,e);const i=function Sp(n,e){const t=function(i,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Le()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);i&&(t.labels=i),this.Bo(t)}Ho(e){const t={};t.database=Wr(this.yt),t.removeTarget=e,this.Bo(t)}}class fg extends mf{constructor(e,t,i,s,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,l),this.yt=a,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}Uo(){this.Jo&&this.Xo([])}jo(e,t){return this.connection.wo("Write",e,t)}onMessage(e){if(Xe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const t=function Ep(n,e){return n&&n.length>0?(Xe(void 0!==e),n.map(t=>function(i,s){let a=an(i.updateTime?i.updateTime:s);return a.isEqual(et.min())&&(a=an(s)),new Ic(a,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),i=an(e.commitTime);return this.listener.Zo(i,t)}return Xe(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=Wr(this.yt),this.Bo(e)}Xo(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>function Kr(n,e){let t;if(e instanceof As)t={update:Uo(n,e.key,e.value)};else if(e instanceof Is)t={delete:Bo(n,e.key)};else if(e instanceof kn)t={update:Uo(n,e.key,e.data),updateMask:Vi(e.fieldMask)};else{if(!(e instanceof Pc))return Le();t={verify:Bo(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,a){const l=a.transform;if(l instanceof Ts)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Br)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ur)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof xr)return{fieldPath:a.field.canonicalString(),increment:l.gt};throw Le()}(0,i))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:bd(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:Le()),t;var s}(this.yt,i))};this.Bo(t)}}class xu extends class{}{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.yt=s,this.nu=!1}su(){if(this.nu)throw new Ie(re.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,t,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.ao(e,t,i,s,a)).catch(s=>{throw"FirebaseError"===s.name?(s.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ie(re.UNKNOWN,s.toString())})}_o(e,t,i,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection._o(e,t,i,a,l,s)).catch(a=>{throw"FirebaseError"===a.name?(a.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ie(re.UNKNOWN,a.toString())})}terminate(){this.nu=!0}}class _f{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Zt(t),this.ou=!1):ke("OnlineStateTracker",t)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class ml{constructor(e,t,i,s,a){var l=this;this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=a,this.mu.Ur(d=>{i.enqueueAndForget((0,O.Z)(function*(){var p;ii(l)&&(ke("RemoteStore","Restarting streams for network reachability change."),yield(p=(0,O.Z)(function*(x){const b=Qe(x);b._u.add(4),yield ts(b),b.gu.set("Unknown"),b._u.delete(4),yield Bt(b)}),function(x){return p.apply(this,arguments)})(l))}))}),this.gu=new _f(i,s)}}function Bt(n){return Yt.apply(this,arguments)}function Yt(){return Yt=(0,O.Z)(function*(n){if(ii(n))for(const e of n.wu)yield e(!0)}),Yt.apply(this,arguments)}function ts(n){return vu.apply(this,arguments)}function vu(){return vu=(0,O.Z)(function*(n){for(const e of n.wu)yield e(!1)}),vu.apply(this,arguments)}function _l(n,e){const t=Qe(n);t.du.has(e.targetId)||(t.du.set(e.targetId,e),xl(t)?wu(t):js(t).ko()&&yu(t,e))}function Yo(n,e){const t=Qe(n),i=js(t);t.du.delete(e),i.ko()&&xf(t,e),0===t.du.size&&(i.ko()?i.Fo():ii(t)&&t.gu.set("Unknown"))}function yu(n,e){n.yu.Ot(e.targetId),js(n).zo(e)}function xf(n,e){n.yu.Ot(e),js(n).Ho(e)}function wu(n){n.yu=new Za({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ne:e=>n.du.get(e)||null}),js(n).start(),n.gu.uu()}function xl(n){return ii(n)&&!js(n).No()&&n.du.size>0}function ii(n){return 0===Qe(n)._u.size}function vl(n){n.yu=void 0}function gg(n){return yl.apply(this,arguments)}function yl(){return yl=(0,O.Z)(function*(n){n.du.forEach((e,t)=>{yu(n,e)})}),yl.apply(this,arguments)}function wl(n,e){return Un.apply(this,arguments)}function Un(){return Un=(0,O.Z)(function*(n,e){vl(n),xl(n)?(n.gu.hu(e),wu(n)):n.gu.set("Unknown")}),Un.apply(this,arguments)}function Fs(n,e,t){return bu.apply(this,arguments)}function bu(){return bu=(0,O.Z)(function*(n,e,t){if(n.gu.set("Online"),e instanceof jo&&2===e.state&&e.cause)try{yield(i=(0,O.Z)(function*(s,a){const l=a.cause;for(const d of a.targetIds)s.du.has(d)&&(yield s.remoteSyncer.rejectListen(d,l),s.du.delete(d),s.yu.removeTarget(d))}),function(s,a){return i.apply(this,arguments)})(n,e)}catch(i){ke("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield bl(n,i)}else if(e instanceof Qr?n.yu.Kt(e):e instanceof Rc?n.yu.Jt(e):n.yu.jt(e),!t.isEqual(et.min()))try{const i=yield cu(n.localStore);t.compareTo(i)>=0&&(yield function(s,a){const l=s.yu.Zt(a);return l.targetChanges.forEach((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const x=s.du.get(p);x&&s.du.set(p,x.withResumeToken(d.resumeToken,a))}}),l.targetMismatches.forEach(d=>{const p=s.du.get(d);if(!p)return;s.du.set(d,p.withResumeToken(jt.EMPTY_BYTE_STRING,p.snapshotVersion)),xf(s,d);const x=new br(p.target,d,1,p.sequenceNumber);yu(s,x)}),s.remoteSyncer.applyRemoteEvent(l)}(n,t))}catch(i){ke("RemoteStore","Failed to raise snapshot:",i),yield bl(n,i)}var i}),bu.apply(this,arguments)}function bl(n,e,t){return Cu.apply(this,arguments)}function Cu(){return Cu=(0,O.Z)(function*(n,e,t){if(!fi(e))throw e;n._u.add(1),yield ts(n),n.gu.set("Offline"),t||(t=()=>cu(n.localStore)),n.asyncQueue.enqueueRetryable((0,O.Z)(function*(){ke("RemoteStore","Retrying IndexedDB access"),yield t(),n._u.delete(1),yield Bt(n)}))}),Cu.apply(this,arguments)}function vf(n,e){return e().catch(t=>bl(n,t,e))}function Ns(n){return Cl.apply(this,arguments)}function Cl(){return Cl=(0,O.Z)(function*(n){const e=Qe(n),t=Ir(e);let i=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;Ki(e);)try{const s=yield lg(e.localStore,i);if(null===s){0===e.fu.length&&t.Fo();break}i=s.batchId,yt(e,s)}catch(s){yield bl(e,s)}Ou(e)&&ri(e)}),Cl.apply(this,arguments)}function Ki(n){return ii(n)&&n.fu.length<10}function yt(n,e){n.fu.push(e);const t=Ir(n);t.ko()&&t.Yo&&t.Xo(e.mutations)}function Ou(n){return ii(n)&&!Ir(n).No()&&n.fu.length>0}function ri(n){Ir(n).start()}function yf(n){return Tu.apply(this,arguments)}function Tu(){return Tu=(0,O.Z)(function*(n){Ir(n).eu()}),Tu.apply(this,arguments)}function Dt(n){return Au.apply(this,arguments)}function Au(){return Au=(0,O.Z)(function*(n){const e=Ir(n);for(const t of n.fu)e.Xo(t.mutations)}),Au.apply(this,arguments)}function wf(n,e,t){return qs.apply(this,arguments)}function qs(){return qs=(0,O.Z)(function*(n,e,t){const i=n.fu.shift(),s=Vc.from(i,e,t);yield vf(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield Ns(n)}),qs.apply(this,arguments)}function mg(n,e){return Iu.apply(this,arguments)}function Iu(){return Iu=(0,O.Z)(function*(n,e){var t;e&&Ir(n).Yo&&(yield(t=(0,O.Z)(function*(i,s){if(function _d(n){switch(n){default:return Le();case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0}}(a=s.code)&&a!==re.ABORTED){const l=i.fu.shift();Ir(i).Mo(),yield vf(i,()=>i.remoteSyncer.rejectFailedWrite(l.batchId,s)),yield Ns(i)}var a}),function(i,s){return t.apply(this,arguments)})(n,e)),Ou(n)&&ri(n)}),Iu.apply(this,arguments)}function bf(n,e){return Eu.apply(this,arguments)}function Eu(){return Eu=(0,O.Z)(function*(n,e){const t=Qe(n);t.asyncQueue.verifyOperationInProgress(),ke("RemoteStore","RemoteStore received new credentials");const i=ii(t);t._u.add(3),yield ts(t),i&&t.gu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t._u.delete(3),yield Bt(t)}),Eu.apply(this,arguments)}function Mu(){return Mu=(0,O.Z)(function*(n,e){const t=Qe(n);e?(t._u.delete(2),yield Bt(t)):e||(t._u.add(2),yield ts(t),t.gu.set("Unknown"))}),Mu.apply(this,arguments)}function js(n){return n.pu||(n.pu=function(e,t,i){const s=Qe(e);return s.su(),new dg(t,s.connection,s.authCredentials,s.appCheckCredentials,s.yt,i)}(n.datastore,n.asyncQueue,{Yr:gg.bind(null,n),Zr:wl.bind(null,n),Wo:Fs.bind(null,n)}),n.wu.push(function(){var e=(0,O.Z)(function*(t){t?(n.pu.Mo(),xl(n)?wu(n):n.gu.set("Unknown")):(yield n.pu.stop(),vl(n))});return function(t){return e.apply(this,arguments)}}())),n.pu}function Ir(n){return n.Iu||(n.Iu=function(e,t,i){const s=Qe(e);return s.su(),new fg(t,s.connection,s.authCredentials,s.appCheckCredentials,s.yt,i)}(n.datastore,n.asyncQueue,{Yr:yf.bind(null,n),Zr:mg.bind(null,n),tu:Dt.bind(null,n),Zo:wf.bind(null,n)}),n.wu.push(function(){var e=(0,O.Z)(function*(t){t?(n.Iu.Mo(),yield Ns(n)):(yield n.Iu.stop(),n.fu.length>0&&(ke("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(t){return e.apply(this,arguments)}}())),n.Iu}class Pu{constructor(e,t,i,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=a,this.deferred=new xn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}static createAndSchedule(e,t,i,s,a){const l=Date.now()+i,d=new Pu(e,t,l,s,a);return d.start(i),d}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ie(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bs(n,e){if(Zt("AsyncQueue",`${e}: ${n}`),fi(n))return new Ie(re.UNAVAILABLE,`${e}: ${n}`);throw n}class Us{constructor(e){this.comparator=e?(t,i)=>e(t,i)||We.comparator(t.key,i.key):(t,i)=>We.comparator(t.key,i.key),this.keyedMap=Fo(),this.sortedSet=new It(this.comparator)}static emptySet(e){return new Us(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Us)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=i.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const i=new Us;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Cf{constructor(){this.Tu=new It(We.comparator)}track(e){const t=e.doc.key,i=this.Tu.get(t);i?0!==e.type&&3===i.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==i.type?this.Tu=this.Tu.insert(t,{type:i.type,doc:e.doc}):2===e.type&&2===i.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===i.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===i.type?this.Tu=this.Tu.remove(t):1===e.type&&2===i.type?this.Tu=this.Tu.insert(t,{type:1,doc:i.doc}):0===e.type&&1===i.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):Le():this.Tu=this.Tu.insert(t,e)}Eu(){const e=[];return this.Tu.inorderTraversal((t,i)=>{e.push(i)}),e}}class zs{constructor(e,t,i,s,a,l,d,p,x){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=p,this.hasCachedResults=x}static fromInitialDocuments(e,t,i,s,a){const l=[];return t.forEach(d=>{l.push({type:0,doc:d})}),new zs(e,t,Us.emptySet(t),l,i,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Os(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}class ku{constructor(){this.Au=void 0,this.listeners=[]}}class _g{constructor(){this.queries=new Zi(e=>pd(e),Os),this.onlineState="Unknown",this.Ru=new Set}}function Ho(n,e){return Du.apply(this,arguments)}function Du(){return Du=(0,O.Z)(function*(n,e){const t=Qe(n),i=e.query;let s=!1,a=t.queries.get(i);if(a||(s=!0,a=new ku),s)try{a.Au=yield t.onListen(i)}catch(l){const d=Bs(l,`Initialization of query '${La(e.query)}' failed`);return void e.onError(d)}t.queries.set(i,a),a.listeners.push(e),e.bu(t.onlineState),a.Au&&e.Pu(a.Au)&&Fu(t)}),Du.apply(this,arguments)}function Ru(n,e){return Lu.apply(this,arguments)}function Lu(){return Lu=(0,O.Z)(function*(n,e){const t=Qe(n),i=e.query;let s=!1;const a=t.queries.get(i);if(a){const l=a.listeners.indexOf(e);l>=0&&(a.listeners.splice(l,1),s=0===a.listeners.length)}if(s)return t.queries.delete(i),t.onUnlisten(i)}),Lu.apply(this,arguments)}function On(n,e){const t=Qe(n);let i=!1;for(const s of e){const l=t.queries.get(s.query);if(l){for(const d of l.listeners)d.Pu(s)&&(i=!0);l.Au=s}}i&&Fu(t)}function Yn(n,e,t){const i=Qe(n),s=i.queries.get(e);if(s)for(const a of s.listeners)a.onError(t);i.queries.delete(e)}function Fu(n){n.Ru.forEach(e=>{e.next()})}class Nu{constructor(e,t,i){this.query=e,this.vu=t,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=i||{}}Pu(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)3!==s.type&&i.push(s);e=new zs(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),t=!0):this.Cu(e,this.onlineState)&&(this.xu(e),t=!0),this.Su=e,t}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}Cu(e,t){return!e.fromCache||(!this.options.Nu||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Du(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(e){e=zs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}class Tf{constructor(e){this.key=e}}class ju{constructor(e){this.key=e}}class Af{constructor(e,t){this.query=e,this.qu=t,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=ft(),this.mutatedKeys=ft(),this.Gu=bc(e),this.Qu=new Us(this.Gu)}get ju(){return this.qu}Wu(e,t){const i=t?t.zu:new Cf,s=t?t.Qu:this.Qu;let a=t?t.mutatedKeys:this.mutatedKeys,l=s,d=!1;const p="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,x="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((b,I)=>{const G=s.get(b),_e=wc(this.query,I)?I:null,Ee=!!G&&this.mutatedKeys.has(G.key),Ke=!!_e&&(_e.hasLocalMutations||this.mutatedKeys.has(_e.key)&&_e.hasCommittedMutations);let it=!1;G&&_e?G.data.isEqual(_e.data)?Ee!==Ke&&(i.track({type:3,doc:_e}),it=!0):this.Hu(G,_e)||(i.track({type:2,doc:_e}),it=!0,(p&&this.Gu(_e,p)>0||x&&this.Gu(_e,x)<0)&&(d=!0)):!G&&_e?(i.track({type:0,doc:_e}),it=!0):G&&!_e&&(i.track({type:1,doc:G}),it=!0,(p||x)&&(d=!0)),it&&(_e?(l=l.add(_e),a=Ke?a.add(b):a.delete(b)):(l=l.delete(b),a=a.delete(b)))}),null!==this.query.limit)for(;l.size>this.query.limit;){const b="F"===this.query.limitType?l.last():l.first();l=l.delete(b.key),a=a.delete(b.key),i.track({type:1,doc:b})}return{Qu:l,zu:i,$i:d,mutatedKeys:a}}Hu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i){const s=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const a=e.zu.Eu();a.sort((x,b)=>function(I,G){const _e=Ee=>{switch(Ee){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le()}};return _e(I)-_e(G)}(x.type,b.type)||this.Gu(x.doc,b.doc)),this.Ju(i);const l=t?this.Yu():[],d=0===this.Ku.size&&this.current?1:0,p=d!==this.Uu;return this.Uu=d,0!==a.length||p?{snapshot:new zs(this.query,e.Qu,s,a,e.mutatedKeys,0===d,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),Xu:l}:{Xu:l}}bu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new Cf,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.qu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(t=>this.qu=this.qu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.qu=this.qu.delete(t)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=ft(),this.Qu.forEach(i=>{this.Zu(i.key)&&(this.Ku=this.Ku.add(i.key))});const t=[];return e.forEach(i=>{this.Ku.has(i)||t.push(new ju(i))}),this.Ku.forEach(i=>{e.has(i)||t.push(new Tf(i))}),t}tc(e){this.qu=e.Hi,this.Ku=ft();const t=this.Wu(e.documents);return this.applyChanges(t,!0)}ec(){return zs.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.Uu,this.hasCachedResults)}}class yg{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class wg{constructor(e){this.key=e,this.nc=!1}}class If{constructor(e,t,i,s,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.sc={},this.ic=new Zi(d=>pd(d),Os),this.rc=new Map,this.oc=new Set,this.uc=new It(We.comparator),this.cc=new Map,this.ac=new iu,this.hc={},this.lc=new Map,this.fc=Yr.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function Ef(n,e){return Bu.apply(this,arguments)}function Bu(){return Bu=(0,O.Z)(function*(n,e){const t=function sh(n){const e=Qe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Sf.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Sg.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Pf.bind(null,e),e.sc.Wo=On.bind(null,e.eventManager),e.sc.wc=Yn.bind(null,e.eventManager),e}(n);let i,s;const a=t.ic.get(e);if(a)i=a.targetId,t.sharedClientState.addLocalQueryTarget(i),s=a.view.ec();else{const l=yield function Wi(n,e){const t=Qe(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return t.Cs.getTargetData(i,e).next(a=>a?(s=a,te.resolve(s)):t.Cs.allocateTargetId(i).next(l=>(s=new br(e,l,0,i.currentSequenceNumber),t.Cs.addTargetData(i,s).next(()=>s))))}).then(i=>{const s=t.qi.get(i.targetId);return(null===s||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.qi=t.qi.insert(i.targetId,i),t.Ui.set(e,i.targetId)),i})}(t.localStore,yn(e));t.isPrimaryClient&&_l(t.remoteStore,l);const d=t.sharedClientState.addLocalQueryTarget(l.targetId);i=l.targetId,s=yield function Uu(n,e,t,i,s){return zu.apply(this,arguments)}(t,e,i,"current"===d,l.resumeToken)}return s}),Bu.apply(this,arguments)}function zu(){return zu=(0,O.Z)(function*(n,e,t,i,s){n._c=(I,G,_e)=>{return(Ee=(0,O.Z)(function*(Ke,it,Ht,pn){let Ut=it.view.Wu(Ht);Ut.$i&&(Ut=yield dl(Ke.localStore,it.query,!1).then(({documents:qt})=>it.view.Wu(qt,Ut)));const Fn=pn&&pn.targetChanges.get(it.targetId),Gt=it.view.applyChanges(Ut,Ke.isPrimaryClient,Fn);return $u(Ke,it.targetId,Gt.Xu),Gt.snapshot}),function(Ke,it,Ht,pn){return Ee.apply(this,arguments)})(n,I,G,_e);var Ee};const a=yield dl(n.localStore,e,!0),l=new Af(e,a.Hi),d=l.Wu(a.documents),p=Ms.createSynthesizedTargetChangeForCurrentChange(t,i&&"Offline"!==n.onlineState,s),x=l.applyChanges(d,n.isPrimaryClient,p);$u(n,t,x.Xu);const b=new yg(e,t,l);return n.ic.set(e,b),n.rc.has(t)?n.rc.get(t).push(e):n.rc.set(t,[e]),x.snapshot}),zu.apply(this,arguments)}function bg(n,e){return Er.apply(this,arguments)}function Er(){return Er=(0,O.Z)(function*(n,e){const t=Qe(n),i=t.ic.get(e),s=t.rc.get(i.targetId);if(s.length>1)return t.rc.set(i.targetId,s.filter(a=>!Os(a,e))),void t.ic.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(i.targetId),t.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Gi(t.localStore,i.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(i.targetId),Yo(t.remoteStore,i.targetId),Zs(t,i.targetId)}).catch(hi))):(Zs(t,i.targetId),yield Gi(t.localStore,i.targetId,!0))}),Er.apply(this,arguments)}function Zu(){return Zu=(0,O.Z)(function*(n,e,t){const i=function Ln(n){const e=Qe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Og.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Tg.bind(null,e),e}(n);try{const s=yield function(a,l){const d=Qe(a),p=Xt.now(),x=l.reduce((G,_e)=>G.add(_e.key),ft());let b,I;return d.persistence.runTransaction("Locally write mutations","readwrite",G=>{let _e=en(),Ee=ft();return d.Gi.getEntries(G,x).next(Ke=>{_e=Ke,_e.forEach((it,Ht)=>{Ht.isValidDocument()||(Ee=Ee.add(it))})}).next(()=>d.localDocuments.getOverlayedDocuments(G,_e)).next(Ke=>{b=Ke;const it=[];for(const Ht of l){const pn=Ec(Ht,b.get(Ht.key).overlayedDocument);null!=pn&&it.push(new kn(Ht.key,pn,xc(pn.value.mapValue),Wt.exists(!0)))}return d.mutationQueue.addMutationBatch(G,p,it,l)}).next(Ke=>{I=Ke;const it=Ke.applyToLocalDocumentSet(b,Ee);return d.documentOverlayCache.saveOverlays(G,Ke.batchId,it)})}).then(()=>({batchId:I.batchId,changes:No(b)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),function(a,l,d){let p=a.hc[a.currentUser.toKey()];p||(p=new It(ct)),p=p.insert(l,d),a.hc[a.currentUser.toKey()]=p}(i,s.batchId,t),yield Ji(i,s.changes),yield Ns(i.remoteStore)}catch(s){const a=Bs(s,"Failed to persist write");t.reject(a)}}),Zu.apply(this,arguments)}function Sf(n,e){return Qu.apply(this,arguments)}function Qu(){return Qu=(0,O.Z)(function*(n,e){const t=Qe(n);try{const i=yield function ag(n,e){const t=Qe(n),i=e.snapshotVersion;let s=t.qi;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.Gi.newChangeBuffer({trackRemovals:!0});s=t.qi;const d=[];e.targetChanges.forEach((b,I)=>{const G=s.get(I);if(!G)return;d.push(t.Cs.removeMatchingKeys(a,b.removedDocuments,I).next(()=>t.Cs.addMatchingKeys(a,b.addedDocuments,I)));let _e=G.withSequenceNumber(a.currentSequenceNumber);var Ee,Ke,it;e.targetMismatches.has(I)?_e=_e.withResumeToken(jt.EMPTY_BYTE_STRING,et.min()).withLastLimboFreeSnapshotVersion(et.min()):b.resumeToken.approximateByteSize()>0&&(_e=_e.withResumeToken(b.resumeToken,i)),s=s.insert(I,_e),Ke=_e,it=b,(0===(Ee=G).resumeToken.approximateByteSize()||Ke.snapshotVersion.toMicroseconds()-Ee.snapshotVersion.toMicroseconds()>=3e8||it.addedDocuments.size+it.modifiedDocuments.size+it.removedDocuments.size>0)&&d.push(t.Cs.updateTargetData(a,_e))});let p=en(),x=ft();if(e.documentUpdates.forEach(b=>{e.resolvedLimboDocuments.has(b)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,b))}),d.push(function uf(n,e,t){let i=ft(),s=ft();return t.forEach(a=>i=i.add(a)),e.getEntries(n,i).next(a=>{let l=en();return t.forEach((d,p)=>{const x=a.get(d);p.isFoundDocument()!==x.isFoundDocument()&&(s=s.add(d)),p.isNoDocument()&&p.version.isEqual(et.min())?(e.removeEntry(d,p.readTime),l=l.insert(d,p)):!x.isValidDocument()||p.version.compareTo(x.version)>0||0===p.version.compareTo(x.version)&&x.hasPendingWrites?(e.addEntry(p),l=l.insert(d,p)):ke("LocalStore","Ignoring outdated watch update for ",d,". Current version:",x.version," Watch version:",p.version)}),{Wi:l,zi:s}})}(a,l,e.documentUpdates).next(b=>{p=b.Wi,x=b.zi})),!i.isEqual(et.min())){const b=t.Cs.getLastRemoteSnapshotVersion(a).next(I=>t.Cs.setTargetsMetadata(a,a.currentSequenceNumber,i));d.push(b)}return te.waitFor(d).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,p,x)).next(()=>p)}).then(a=>(t.qi=s,a))}(t.localStore,e);e.targetChanges.forEach((s,a)=>{const l=t.cc.get(a);l&&(Xe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?l.nc=!0:s.modifiedDocuments.size>0?Xe(l.nc):s.removedDocuments.size>0&&(Xe(l.nc),l.nc=!1))}),yield Ji(t,i,e)}catch(i){yield hi(i)}}),Qu.apply(this,arguments)}function Mf(n,e,t){const i=Qe(n);if(i.isPrimaryClient&&0===t||!i.isPrimaryClient&&1===t){const s=[];i.ic.forEach((a,l)=>{const d=l.view.bu(e);d.snapshot&&s.push(d.snapshot)}),function(a,l){const d=Qe(a);d.onlineState=l;let p=!1;d.queries.forEach((x,b)=>{for(const I of b.listeners)I.bu(l)&&(p=!0)}),p&&Fu(d)}(i.eventManager,e),s.length&&i.sc.Wo(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function Pf(n,e,t){return Ol.apply(this,arguments)}function Ol(){return Ol=(0,O.Z)(function*(n,e,t){const i=Qe(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.cc.get(e),a=s&&s.key;if(a){let l=new It(We.comparator);l=l.insert(a,Vt.newNoDocument(a,et.min()));const d=ft().add(a),p=new Ss(et.min(),new Map,new Nt(ct),l,d);yield Sf(i,p),i.uc=i.uc.remove(a),i.cc.delete(e),Yu(i)}else yield Gi(i.localStore,e,!1).then(()=>Zs(i,e,t)).catch(hi)}),Ol.apply(this,arguments)}function Og(n,e){return Vu.apply(this,arguments)}function Vu(){return Vu=(0,O.Z)(function*(n,e){const t=Qe(n),i=e.batch.batchId;try{const s=yield function cf(n,e){const t=Qe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const s=e.batch.keys(),a=t.Gi.newChangeBuffer({trackRemovals:!0});return function(l,d,p,x){const b=p.batch,I=b.keys();let G=te.resolve();return I.forEach(_e=>{G=G.next(()=>x.getEntry(d,_e)).next(Ee=>{const Ke=p.docVersions.get(_e);Xe(null!==Ke),Ee.version.compareTo(Ke)<0&&(b.applyToRemoteDocument(Ee,p),Ee.isValidDocument()&&(Ee.setReadTime(p.commitVersion),x.addEntry(Ee)))})}),G.next(()=>l.mutationQueue.removeMutationBatch(d,b))}(t,i,e,a).next(()=>a.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(l){let d=ft();for(let p=0;p<l.mutationResults.length;++p)l.mutationResults[p].transformResults.length>0&&(d=d.add(l.batch.mutations[p].key));return d}(e))).next(()=>t.localDocuments.getDocuments(i,s))})}(t.localStore,e);Ju(t,i,null),Ku(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield Ji(t,s)}catch(s){yield hi(s)}}),Vu.apply(this,arguments)}function Tg(n,e,t){return Wu.apply(this,arguments)}function Wu(){return Wu=(0,O.Z)(function*(n,e,t){const i=Qe(n);try{const s=yield function(a,l){const d=Qe(a);return d.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let x;return d.mutationQueue.lookupMutationBatch(p,l).next(b=>(Xe(null!==b),x=b.keys(),d.mutationQueue.removeMutationBatch(p,b))).next(()=>d.mutationQueue.performConsistencyCheck(p)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(p,x,l)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,x)).next(()=>d.localDocuments.getDocuments(p,x))})}(i.localStore,e);Ju(i,e,t),Ku(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield Ji(i,s)}catch(s){yield hi(s)}}),Wu.apply(this,arguments)}function Ku(n,e){(n.lc.get(e)||[]).forEach(t=>{t.resolve()}),n.lc.delete(e)}function Ju(n,e,t){const i=Qe(n);let s=i.hc[i.currentUser.toKey()];if(s){const a=s.get(e);a&&(t?a.reject(t):a.resolve(),s=s.remove(e)),i.hc[i.currentUser.toKey()]=s}}function Zs(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.rc.get(e))n.ic.delete(i),t&&n.sc.wc(i,t);n.rc.delete(e),n.isPrimaryClient&&n.ac.ls(e).forEach(i=>{n.ac.containsKey(i)||kf(n,i)})}function kf(n,e){n.oc.delete(e.path.canonicalString());const t=n.uc.get(e);null!==t&&(Yo(n.remoteStore,t),n.uc=n.uc.remove(e),n.cc.delete(t),Yu(n))}function $u(n,e,t){for(const i of t)i instanceof Tf?(n.ac.addReference(i.key,e),Ig(n,i)):i instanceof ju?(ke("SyncEngine","Document no longer in limbo: "+i.key),n.ac.removeReference(i.key,e),n.ac.containsKey(i.key)||kf(n,i.key)):Le()}function Ig(n,e){const t=e.key,i=t.path.canonicalString();n.uc.get(t)||n.oc.has(i)||(ke("SyncEngine","New document in limbo: "+t),n.oc.add(i),Yu(n))}function Yu(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const e=n.oc.values().next().value;n.oc.delete(e);const t=new We(At.fromString(e)),i=n.fc.next();n.cc.set(i,new wg(t)),n.uc=n.uc.insert(t,i),_l(n.remoteStore,new br(yn(mr(t.path)),i,2,ut.at))}}function Ji(n,e,t){return Hu.apply(this,arguments)}function Hu(){return Hu=(0,O.Z)(function*(n,e,t){const i=Qe(n),s=[],a=[],l=[];var d;i.ic.isEmpty()||(i.ic.forEach((d,p)=>{l.push(i._c(p,e,t).then(x=>{if((x||t)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(p.targetId,x?.fromCache?"not-current":"current"),x){s.push(x);const b=ou.Ci(p.targetId,x);a.push(b)}}))}),yield Promise.all(l),i.sc.Wo(s),yield(d=(0,O.Z)(function*(p,x){const b=Qe(p);try{yield b.persistence.runTransaction("notifyLocalViewChanges","readwrite",I=>te.forEach(x,G=>te.forEach(G.Si,_e=>b.persistence.referenceDelegate.addReference(I,G.targetId,_e)).next(()=>te.forEach(G.Di,_e=>b.persistence.referenceDelegate.removeReference(I,G.targetId,_e)))))}catch(I){if(!fi(I))throw I;ke("LocalStore","Failed to update sequence numbers: "+I)}for(const I of x){const G=I.targetId;if(!I.fromCache){const _e=b.qi.get(G),Ke=_e.withLastLimboFreeSnapshotVersion(_e.snapshotVersion);b.qi=b.qi.insert(G,Ke)}}}),function(p,x){return d.apply(this,arguments)})(i.localStore,a))}),Hu.apply(this,arguments)}function Eg(n,e){return Xu.apply(this,arguments)}function Xu(){return Xu=(0,O.Z)(function*(n,e){const t=Qe(n);if(!t.currentUser.isEqual(e)){ke("SyncEngine","User change. New user:",e.toKey());const i=yield lu(t.localStore,e);t.currentUser=e,(s=t).lc.forEach(l=>{l.forEach(d=>{d.reject(new Ie(re.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.lc.clear(),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield Ji(t,i.ji)}var s}),Xu.apply(this,arguments)}function Sg(n,e){const t=Qe(n),i=t.cc.get(e);if(i&&i.nc)return ft().add(i.key);{let s=ft();const a=t.rc.get(e);if(!a)return s;for(const l of a){const d=t.ic.get(l);s=s.unionWith(d.view.ju)}return s}}class Ng{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,O.Z)(function*(){t.yt=$o(e.databaseInfo.databaseId),t.sharedClientState=t.gc(e),t.persistence=t.yc(e),yield t.persistence.start(),t.localStore=t.Ic(e),t.gcScheduler=t.Tc(e,t.localStore),t.indexBackfillerScheduler=t.Ec(e,t.localStore)})()}Tc(e,t){return null}Ec(e,t){return null}Ic(e){return function ul(n,e,t,i){return new lf(n,e,t,i)}(this.persistence,new au,e.initialUser,this.yt)}yc(e){return new of(ll.Bs,this.yt)}gc(e){return new pf}terminate(){var e=this;return(0,O.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class ah{initialize(e,t){var i=this;return(0,O.Z)(function*(){i.localStore||(i.localStore=e.localStore,i.sharedClientState=e.sharedClientState,i.datastore=i.createDatastore(t),i.remoteStore=i.createRemoteStore(t),i.eventManager=i.createEventManager(t),i.syncEngine=i.createSyncEngine(t,!e.synchronizeTabs),i.sharedClientState.onlineStateHandler=s=>Mf(i.syncEngine,s,1),i.remoteStore.remoteSyncer.handleCredentialChange=Eg.bind(null,i.syncEngine),yield function Su(n,e){return Mu.apply(this,arguments)}(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(e){return new _g}createDatastore(e){const t=$o(e.databaseInfo.databaseId),i=new dn(e.databaseInfo);return new xu(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return t=this.localStore,i=this.datastore,s=e.asyncQueue,a=d=>Mf(this.syncEngine,d,0),l=_t.C()?new _t:new es,new ml(t,i,s,a,l);var t,i,s,a,l}createSyncEngine(e,t){return function(i,s,a,l,d,p,x){const b=new If(i,s,a,l,d,p);return x&&(b.dc=!0),b}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,O.Z)(function*(t){const i=Qe(t);ke("RemoteStore","RemoteStore shutting down."),i._u.add(5),yield ts(i),i.mu.shutdown(),i.gu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function ta(n,e,t){if(!t)throw new Ie(re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Al(n){if(!We.isDocumentKey(n))throw new Ie(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Rf(n){if(We.isDocumentKey(n))throw new Ie(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Il(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":Le()}function St(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ie(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Il(n);throw new Ie(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}const lh=new Map;class Ff{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Ie(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Ie(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function Bg(n,e,t,i){if(!0===e&&!0===i)throw new Ie(re.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class na{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ff({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ie(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ie(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ff(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new sr;switch(t.type){case"gapi":return new Jh(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Ie(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=lh.get(e);t&&(ke("ComponentProvider","Removing Datastore"),lh.delete(e),t.terminate())}(this),Promise.resolve()}}class tn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new tn(this.firestore,e,this._key)}}class vn{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new vn(this.firestore,e,this._query)}}class Mi extends vn{constructor(e,t,i){super(e,t,mr(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new tn(this.firestore,null,new We(e))}withConverter(e){return new Mi(this.firestore,e,this._path)}}function ia(n,e,...t){if(n=(0,B.m9)(n),ta("collection","path",e),n instanceof na){const i=At.fromString(e,...t);return Rf(i),new Mi(n,null,i)}{if(!(n instanceof tn||n instanceof Mi))throw new Ie(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(At.fromString(e,...t));return Rf(i),new Mi(n.firestore,null,i)}}function Qs(n,e,...t){if(n=(0,B.m9)(n),1===arguments.length&&(e=or.R()),ta("doc","path",e),n instanceof na){const i=At.fromString(e,...t);return Al(i),new tn(n,null,new We(i))}{if(!(n instanceof tn||n instanceof Mi))throw new Ie(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(At.fromString(e,...t));return Al(i),new tn(n.firestore,n instanceof Mi?n.converter:null,new We(i))}}class El{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):Zt("Uncaught Error in snapshot listener:",e.toString())}bc(){this.muted=!0}Rc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Gg{constructor(e,t,i,s){var a=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=mt.UNAUTHENTICATED,this.clientId=or.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,function(){var l=(0,O.Z)(function*(d){ke("FirestoreClient","Received user=",d.uid),yield a.authCredentialListener(d),a.user=d});return function(d){return l.apply(this,arguments)}}()),this.appCheckCredentials.start(i,l=>(ke("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}getConfiguration(){var e=this;return(0,O.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ie(re.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new xn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,O.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(i){const s=Bs(i,"Failed to shutdown persistence");t.reject(s)}})),t.promise}}function ch(){return ch=(0,O.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),ke("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(function(){var s=(0,O.Z)(function*(a){i.isEqual(a)||(yield lu(e.localStore,a),i=a)});return function(a){return s.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),ch.apply(this,arguments)}function uh(){return uh=(0,O.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield function hh(n){return dh.apply(this,arguments)}(n);ke("FirestoreClient","Initializing OnlineComponentProvider");const i=yield n.getConfiguration();yield e.initialize(t,i),n.setCredentialChangeListener(s=>bf(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,a)=>bf(e.remoteStore,a)),n.onlineComponents=e}),uh.apply(this,arguments)}function dh(){return dh=(0,O.Z)(function*(n){return n.offlineComponents||(ke("FirestoreClient","Using default OfflineComponentProvider"),yield function jf(n,e){return ch.apply(this,arguments)}(n,new Ng)),n.offlineComponents}),dh.apply(this,arguments)}function r(n){return o.apply(this,arguments)}function o(){return o=(0,O.Z)(function*(n){return n.onlineComponents||(ke("FirestoreClient","Using default OnlineComponentProvider"),yield function Bf(n,e){return uh.apply(this,arguments)}(n,new ah)),n.onlineComponents}),o.apply(this,arguments)}function N(n){return Q.apply(this,arguments)}function Q(){return Q=(0,O.Z)(function*(n){const e=yield r(n),t=e.eventManager;return t.onListen=Ef.bind(null,e.syncEngine),t.onUnlisten=bg.bind(null,e.syncEngine),t}),Q.apply(this,arguments)}class Mt{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new _u(this,"async_queue_retry"),this.Wc=()=>{const t=xi();t&&ke("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const e=xi();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.qc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.qc){this.qc=!0,this.Qc=e||!1;const t=xi();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.qc)return new Promise(()=>{});const t=new xn;return this.Hc(()=>this.qc&&this.Qc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Lc.push(e),this.Jc()))}Jc(){var e=this;return(0,O.Z)(function*(){if(0!==e.Lc.length){try{yield e.Lc[0](),e.Lc.shift(),e.xo.reset()}catch(t){if(!fi(t))throw t;ke("AsyncQueue","Operation failed with retryable error: "+t)}e.Lc.length>0&&e.xo.Ro(()=>e.Jc())}})()}Hc(e){const t=this.Bc.then(()=>(this.Gc=!0,e().catch(i=>{throw this.Kc=i,this.Gc=!1,Zt("INTERNAL UNHANDLED ERROR: ",function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),l}(i)),i}).then(i=>(this.Gc=!1,i))));return this.Bc=t,t}enqueueAfterDelay(e,t,i){this.zc(),this.jc.indexOf(e)>-1&&(t=0);const s=Pu.createAndSchedule(this,e,t,i,a=>this.Yc(a));return this.Uc.push(s),s}zc(){this.Kc&&Le()}verifyOperationInProgress(){}Xc(){var e=this;return(0,O.Z)(function*(){let t;do{t=e.Bc,yield t}while(t!==e.Bc)})()}Zc(e){for(const t of this.Uc)if(t.timerId===e)return!0;return!1}ta(e){return this.Xc().then(()=>{this.Uc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Uc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Xc()})}ea(e){this.jc.push(e)}Yc(e){const t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}function zn(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const i=e;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(n)}class gt extends na{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new Mt,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||lm(this),this._firestoreClient.terminate()}}function yi(n,e){const t="object"==typeof n?n:(0,h.getApp)(),i="string"==typeof n?n:e||"(default)",s=(0,h._getProvider)(t,"firestore").getImmediate({identifier:i});if(!s._initialized){const a=(0,B.P0)("firestore");a&&function Ug(n,e,t,i={}){var s;const a=(n=St(n,na))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==e&&qi("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},a),{host:`${e}:${t}`,ssl:!1})),i.mockUserToken){let l,d;if("string"==typeof i.mockUserToken)l=i.mockUserToken,d=mt.MOCK_USER;else{l=(0,B.Sg)(i.mockUserToken,null===(s=n._app)||void 0===s?void 0:s.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new Ie(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new mt(p)}n._authCredentials=new wa(new fo(l,d))}}(s,...a)}return s}function fn(n){return n._firestoreClient||lm(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function lm(n){var e;const t=n._freezeSettings(),i=(a=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new yp(n._databaseId,a,n._persistenceKey,(d=t).host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,d.useFetchStreams));var a,d;n._firestoreClient=new Gg(n._authCredentials,n._appCheckCredentials,n._queue,i)}class ra{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ra(jt.fromBase64String(e))}catch(t){throw new Ie(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ra(jt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Sl{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Ie(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hm{constructor(e){this._methodName=e}}class Kg{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ie(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ie(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ct(this._lat,e._lat)||ct(this._long,e._long)}}const Lm=/^__.*__$/;class Fm{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return null!==this.fieldMask?new kn(e,this.data,this.fieldMask,t,this.fieldTransforms):new As(e,this.data,t,this.fieldTransforms)}}function fm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le()}}class Uf{constructor(e,t,i,s,a,l){this.settings=e,this.databaseId=t,this.yt=i,this.ignoreUndefinedProperties=s,void 0===a&&this.na(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new Uf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),s=this.ia({path:i,oa:!1});return s.ua(e),s}ca(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),s=this.ia({path:i,oa:!1});return s.na(),s}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return Zf(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(fm(this.sa)&&Lm.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class Nm{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.yt=i||$o(e)}da(e,t,i,s=!1){return new Uf({sa:e,methodName:t,fa:i,path:rn.emptyPath(),oa:!1,la:s},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}function Ml(n){const e=n._freezeSettings(),t=$o(n._databaseId);return new Nm(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Jg(n,e,t,i,s,a={}){const l=n.da(a.merge||a.mergeFields?2:0,e,t,s);Yg("Data must be an object, but it was:",l,i);const d=xm(i,l);let p,x;if(a.merge)p=new ei(l.fieldMask),x=l.fieldTransforms;else if(a.mergeFields){const b=[];for(const I of a.mergeFields){const G=Hg(e,I,t);if(!l.contains(G))throw new Ie(re.INVALID_ARGUMENT,`Field '${G}' is specified in your field mask but missing from your input data.`);ym(b,G)||b.push(G)}p=new ei(b),x=l.fieldTransforms.filter(I=>p.covers(I.field))}else p=null,x=l.fieldTransforms;return new Fm(new un(d),p,x)}function sa(n,e){if(vm(n=(0,B.m9)(n)))return Yg("Unsupported field value:",e,n),xm(n,e);if(n instanceof hm)return function(t,i){if(!fm(i.sa))throw i.ha(`${t._methodName}() can only be used with update() and set()`);if(!i.path)throw i.ha(`${t._methodName}() is not currently supported inside arrays`);const s=t._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,i){const s=[];let a=0;for(const l of t){let d=sa(l,i.aa(a));null==d&&(d={nullValue:"NULL_VALUE"}),s.push(d),a++}return{arrayValue:{values:s}}}(n,e)}return function(t,i){if(null===(t=(0,B.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ct(i.yt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const s=Xt.fromDate(t);return{timestampValue:Vr(i.yt,s)}}if(t instanceof Xt){const s=new Xt(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vr(i.yt,s)}}if(t instanceof Kg)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ra)return{bytesValue:Ai(i.yt,t._byteString)};if(t instanceof tn){const s=i.databaseId,a=t.firestore._databaseId;if(!a.isEqual(s))throw i.ha(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Nc(t.firestore._databaseId||i.databaseId,t._key.path)}}throw i.ha(`Unsupported field value: ${Il(t)}`)}(n,e)}function xm(n,e){const t={};return Xh(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xn(n,(i,s)=>{const a=sa(s,e.ra(i));null!=a&&(t[i]=a)}),{mapValue:{fields:t}}}function vm(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Xt||n instanceof Kg||n instanceof ra||n instanceof tn||n instanceof hm)}function Yg(n,e,t){if(!vm(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const i=Il(t);throw e.ha("an object"===i?n+" a custom object":n+" "+i)}var i}function Hg(n,e,t){if((e=(0,B.m9)(e))instanceof Sl)return e._internalPath;if("string"==typeof e)return zf(n,e);throw Zf("Field path arguments must be of type string or ",n,!1,void 0,t)}const Um=new RegExp("[~\\*/\\[\\]]");function zf(n,e,t){if(e.search(Um)>=0)throw Zf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Sl(...e.split("."))._internalPath}catch{throw Zf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Zf(n,e,t,i,s){const a=i&&!i.isEmpty(),l=void 0!==s;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let p="";return(a||l)&&(p+=" (found",a&&(p+=` in field ${i}`),l&&(p+=` in document ${s}`),p+=")"),new Ie(re.INVALID_ARGUMENT,d+n+p)}function ym(n,e){return n.some(t=>t.isEqual(e))}class Xg{constructor(e,t,i,s,a){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new tn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new zm(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Qf("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class zm extends Xg{data(){return super.data()}}function Qf(n,e){return"string"==typeof e?zf(n,e):e instanceof Sl?e._internalPath:e._delegate._internalPath}function wm(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Ie(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class em{}class Zm extends em{}function bm(n,e,...t){let i=[];e instanceof em&&i.push(e),i=i.concat(t),function(s){const a=s.filter(d=>d instanceof Pl).length,l=s.filter(d=>d instanceof ph).length;if(a>1||a>0&&l>0)throw new Ie(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const s of i)n=s._apply(n);return n}class ph extends Zm{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new ph(e,t,i)}_apply(e){const t=this._parse(e);return Im(e._query,t),new vn(e.firestore,e.converter,yc(e._query,t))}_parse(e){const t=Ml(e.firestore);return function(s,a,l,d,p,x,b){let I;if(p.isKeyField()){if("array-contains"===x||"array-contains-any"===x)throw new Ie(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if("in"===x||"not-in"===x){Am(b,x);const G=[];for(const _e of b)G.push(Tm(d,s,_e));I={arrayValue:{values:G}}}else I=Tm(d,s,b)}else"in"!==x&&"not-in"!==x&&"array-contains-any"!==x||Am(b,x),I=function _m(n,e,t,i=!1){return sa(t,n.da(i?4:3,e))}(l,"where",b,"in"===x||"not-in"===x);return vt.create(p,x,I)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}function Cm(n,e,t){const i=e,s=Qf("where",n);return ph._create(s,i,t)}class Pl extends em{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Pl(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return 1===t.length?t[0]:bt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,s){let a=i;const l=s.getFlattenedFilters();for(const d of l)Im(a,d),a=yc(a,d)}(e._query,t),new vn(e.firestore,e.converter,yc(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function Tm(n,e,t){if("string"==typeof(t=(0,B.m9)(t))){if(""===t)throw new Ie(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ra(e)&&-1!==t.indexOf("/"))throw new Ie(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(At.fromString(t));if(!We.isDocumentKey(i))throw new Ie(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Nr(n,new We(i))}if(t instanceof tn)return Nr(n,t._key);throw new Ie(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Il(t)}.`)}function Am(n,e){if(!Array.isArray(n)||0===n.length)throw new Ie(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new Ie(re.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Im(n,e){if(e.isInequality()){const i=Po(n),s=e.field;if(null!==i&&!i.isEqual(s))throw new Ie(re.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${i.toString()}' and '${s.toString()}'`);const a=Mo(n);null!==a&&function Em(n,e,t){if(!t.isEqual(e))throw new Ie(re.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}(0,s,a)}const t=function(i,s){for(const a of i)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Ie(re.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Qm{convertValue(e,t="none"){switch(Fr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return on(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Lr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Le()}}convertObject(e,t){const i={};return Xn(e.fields,(s,a)=>{i[s]=this.convertValue(a,t)}),i}convertGeoPoint(e){return new Kg(on(e.latitude),on(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Ci(e);return null==i?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(wo(e));default:return null}}convertTimestamp(e){const t=dr(e);return new Xt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=At.fromString(e);Xe(Dn(i));const s=new Rr(i.get(1),i.get(3)),a=new We(i.popFirst(5));return s.isEqual(t)||Zt(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}class oa{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class kl extends Xg{constructor(e,t,i,s,a,l){super(e,t,i,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Kf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Qf("DocumentSnapshot.get",e));if(null!==i)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class Kf extends kl{data(e={}){return super.data(e)}}class Dl{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new oa(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Kf(this._firestore,this._userDataWriter,i.key,i,new oa(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ie(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>({type:"added",doc:new Kf(i._firestore,i._userDataWriter,l.doc.key,l.doc,new oa(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:a++}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||3!==l.type).map(l=>{const d=new Kf(i._firestore,i._userDataWriter,l.doc.key,l.doc,new oa(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let p=-1,x=-1;return 0!==l.type&&(p=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),1!==l.type&&(a=a.add(l.doc),x=a.indexOf(l.doc.key)),{type:Vm(l.type),doc:d,oldIndex:p,newIndex:x}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Vm(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le()}}class Vs extends Qm{constructor(e){super(),this.firestore=e}convertBytes(e){return new ra(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new tn(this.firestore,null,t)}}function Mm(n){n=St(n,vn);const e=St(n.firestore,gt),t=fn(e),i=new Vs(e);return wm(n._query),function ot(n,e,t={}){const i=new xn;return n.asyncQueue.enqueueAndForget((0,O.Z)(function*(){return function(s,a,l,d,p){const x=new El({next:I=>{a.enqueueAndForget(()=>Ru(s,b)),I.fromCache&&"server"===d.source?p.reject(new Ie(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(I)},error:I=>p.reject(I)}),b=new Nu(l,x,{includeMetadataChanges:!0,Nu:!0});return Ho(s,b)}(yield N(n),n.asyncQueue,e,t,i)})),i.promise}(t,n._query).then(s=>new Dl(e,i,n,s))}function Pm(n,e,t){n=St(n,tn);const i=St(n.firestore,gt),s=function nm(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}(n.converter,e,t);return gh(i,[Jg(Ml(i),"setDoc",n._key,s,null!==n.converter,t).toMutation(n._key,Wt.none())])}function Jf(n,...e){var t,i,s;n=(0,B.m9)(n);let a={includeMetadataChanges:!1},l=0;"object"!=typeof e[l]||zn(e[l])||(a=e[l],l++);const d={includeMetadataChanges:a.includeMetadataChanges};if(zn(e[l])){const I=e[l];e[l]=null===(t=I.next)||void 0===t?void 0:t.bind(I),e[l+1]=null===(i=I.error)||void 0===i?void 0:i.bind(I),e[l+2]=null===(s=I.complete)||void 0===s?void 0:s.bind(I)}let p,x,b;if(n instanceof tn)x=St(n.firestore,gt),b=mr(n._key.path),p={next:I=>{e[l]&&e[l](im(x,n,I))},error:e[l+1],complete:e[l+2]};else{const I=St(n,vn);x=St(I.firestore,gt),b=I._query;const G=new Vs(x);p={next:_e=>{e[l]&&e[l](new Dl(x,G,I,_e))},error:e[l+1],complete:e[l+2]},wm(n._query)}return function(I,G,_e,Ee){const Ke=new El(Ee),it=new Nu(G,Ke,_e);return I.asyncQueue.enqueueAndForget((0,O.Z)(function*(){return Ho(yield N(I),it)})),()=>{Ke.bc(),I.asyncQueue.enqueueAndForget((0,O.Z)(function*(){return Ru(yield N(I),it)}))}}(fn(x),b,d,p)}function gh(n,e){return function(t,i){const s=new xn;return t.asyncQueue.enqueueAndForget((0,O.Z)(function*(){return function Cg(n,e,t){return Zu.apply(this,arguments)}(yield function T(n){return r(n).then(e=>e.syncEngine)}(t),i,s)})),s.promise}(fn(n),e)}function im(n,e,t){const i=t.docs.get(e._key),s=new Vs(n);return new kl(n,s,e._key,i,new oa(t.hasPendingWrites,t.fromCache),e.converter)}!function(n,e=!0){ir=h.SDK_VERSION,(0,h._registerComponent)(new _.wA("firestore",(t,{instanceIdentifier:i,options:s})=>{const a=t.getProvider("app").getImmediate(),l=new gt(new Kh(t.getProvider("auth-internal")),new Ca(t.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ie(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rr(d.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:e},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),(0,h.registerVersion)(mn,"3.8.0",n),(0,h.registerVersion)(mn,"3.8.0","esm2017")}();var Mn=w(65592),Dm=w(20553),Yf=w(65879),Ym=w(86309),Hm=w(63934),Xm=w(87384);let e_=(()=>{class n{examSessions_read(t){var i=this;return new Mn.y(s=>{this.getFirestoreDb(!1).subscribe(function(){var a=(0,O.Z)(function*(l){if(l&&1==l.success)try{var d=yield i._getDocument(l.data,"exam_sessions/"+t,i.getUserId());s.next({success:1,data:d,message:"successful"}),s.complete()}catch(x){console.log(x),s.next({success:0,data:"",message:""+x}),s.complete()}else s.next({success:0,data:"",message:l.message}),s.complete()});return function(l){return a.apply(this,arguments)}}())})}examSessions_write(t,i){var s=this;return new Mn.y(a=>{this.getFirestoreDb(!1).subscribe(function(){var l=(0,O.Z)(function*(d){if(d&&1==d.success)try{var p=yield s._saveDocument(d.data,"exam_sessions/"+t,s.getUserId(),i);a.next({success:1,data:p,message:"successful"}),a.complete()}catch(b){console.log(b),a.next({success:0,data:"",message:""+b}),a.complete()}else a.next({success:0,data:"",message:d.message}),a.complete()});return function(d){return l.apply(this,arguments)}}())})}examSessions_writeUserMap(t,i){var s=this;return new Mn.y(a=>{this.getFirestoreDbForStudentExam(!1,t).subscribe(function(){var l=(0,O.Z)(function*(d){if(d&&1==d.success&&d.data)try{var p=yield s._saveDocumentMerge(d.data,"exam_sessions/"+t,"user_map",i);a.next({success:1,data:p,message:"successful"}),a.complete()}catch(b){console.log(b),a.next({success:0,data:"",message:""+b}),a.complete()}else a.next({success:0,data:"",message:d.message}),a.complete()});return function(d){return l.apply(this,arguments)}}())})}examSessions_delete(t){var i=this;return new Mn.y(s=>{this.getFirestoreDb(!1).subscribe(function(){var a=(0,O.Z)(function*(l){if(l&&1==l.success)try{yield i._removeDocument(l.data,"exam_sessions/"+t,i.getUserId()),s.next({success:1,data:"",message:"successful"}),s.complete()}catch(p){console.log(p),s.next({success:0,data:"",message:""+p}),s.complete()}else s.next({success:0,data:"",message:l.message}),s.complete()});return function(l){return a.apply(this,arguments)}}())})}examSessions_subscribeUserMap(t){var i=this;return new Mn.y(s=>{this.getFirestoreDbForTeacherExam(!1,t).subscribe(function(){var a=(0,O.Z)(function*(l){if(l&&1==l.success)try{var d=i.myOnSnapshot(l.data,"exam_sessions/"+t,"user_map",b=>{s.next({success:1,data:b,message:"successful"}),s.complete()});i.addUnsubscribe("exam_sessions_"+t,d)}catch(b){console.log(b),s.next({success:0,data:void 0,message:""+b}),s.complete()}else s.next({success:0,data:void 0,message:l.message}),s.complete()});return function(l){return a.apply(this,arguments)}}())})}examSessions_subscribe(t){var i=this;return new Mn.y(s=>{this.getFirestoreDb(!1).subscribe(function(){var a=(0,O.Z)(function*(l){if(l&&1==l.success)try{var d=i.myOnSnapshot(l.data,"exam_sessions/"+t,i.getUserId(),b=>{s.next({success:1,data:b,message:"successful"}),s.complete()});i.addUnsubscribe("exam_sessions_"+t,d)}catch(b){console.log(b),s.next({success:0,data:void 0,message:""+b}),s.complete()}else s.next({success:0,data:void 0,message:l.message}),s.complete()});return function(l){return a.apply(this,arguments)}}())})}examSessions_unsubscribe(t){this.removeAllunsubscribe("exam_sessions_"+t)}examSessions_subscribeWithQuery(t,i){var s=this;return new Mn.y(i&&3==i.length?a=>{this.getFirestoreDb(!1).subscribe(function(){var l=(0,O.Z)(function*(d){if(d&&1==d.success)try{var p=s.myOnSnapshotCollectionWithQuery(d.data,"exam_sessions/"+t,i,I=>{a.next({success:1,data:I,message:"successful"}),a.complete()});s.addUnsubscribe("exam_sessions_"+t,p)}catch(I){console.log(I),a.next({success:0,data:void 0,message:""+I}),a.complete()}else a.next({success:0,data:void 0,message:d.message}),a.complete()});return function(d){return l.apply(this,arguments)}}())}:a=>{a.next({success:0,data:void 0,message:"EXCEPTION Query Param not valid"}),a.complete(),a.next({success:0,message:"EXCEPTION Query Param not valid"})})}examLiveTeachers_student_subscribe(t){var i=this;return new Mn.y(s=>{this.getFirestoreDbForStudentExam(!1,t).subscribe(function(){var a=(0,O.Z)(function*(l){if(l&&1==l.success)try{var d=i.myOnSnapshotCollection(l.data,"exam_live_teachers/"+t,p=>{s.next({success:1,data:p})});i.addUnsubscribe("exam_live_teachers_"+t,d)}catch(p){console.log(p),s.next({success:0,message:"EXCEPTION",ex:p.toString()})}else s.next(l)});return function(l){return a.apply(this,arguments)}}())})}examLiveTeachers_student_unbsubscribe(t){this.removeAllunsubscribe("exam_live_teachers_"+t)}examLiveTeachers_teacher_saveChange(t,i){var s=this;return new Mn.y(a=>{this.getFirestoreDbForTeacherExam(!1,t).subscribe(function(){var l=(0,O.Z)(function*(d){if(d&&1==d.success)try{var p=yield s._saveDocument(d.data,"exam_live_teachers/"+t,s.getUserId(),i);a.next({success:1,data:p})}catch(x){console.log(x),a.next({success:0,message:"EXCEPTION",ex:x.toString()})}else a.next(d)});return function(d){return l.apply(this,arguments)}}())})}examLives_teacher_getDocumentByUserIds(t,i){var s=this;return new Mn.y(a=>{this.getFirestoreDbForTeacherExam(!1,t).subscribe(function(){var l=(0,O.Z)(function*(d){if(d&&1==d.success)try{var p=yield s._getDocuments(d.data,"exam_lives/"+t,i);a.next({success:1,data:p})}catch(x){console.log(x),a.next({success:0,message:"EXCEPTION",ex:x.toString()})}else a.next(d)});return function(d){return l.apply(this,arguments)}}())})}examLiveStudents_student_subscribe(t){var i=this;return new Mn.y(s=>{this.getFirestoreDbForStudentExam(!1,t).subscribe(function(){var a=(0,O.Z)(function*(l){if(l&&1==l.success)try{var d=i.myOnSnapshot(l.data,"exam_live_students/"+t,i.getUserId(),p=>{s.next({success:1,data:p})});i.addUnsubscribe("exam_live_students_"+t,d)}catch(p){console.log(p),s.next({success:0,message:"EXCEPTION",ex:p.toString()})}else s.next(l)});return function(l){return a.apply(this,arguments)}}())})}examLiveStudents_student_unbsubscribe(t){this.removeAllunsubscribe("exam_live_students_"+t)}examLiveStudents_teacher_subscribe(t,i){var s=this;return new Mn.y(a=>{this.getFirestoreDbForTeacherExam(!1,t).subscribe(function(){var l=(0,O.Z)(function*(d){if(d&&1==d.success)try{var p=s.myOnSnapshot(d.data,"exam_live_students/"+t,i,x=>{a.next({success:1,data:x})});s.addUnsubscribe("exam_live_students_"+t,p)}catch(x){console.log(x),a.next({success:0,message:"EXCEPTION",ex:x.toString()})}else a.next(d)});return function(d){return l.apply(this,arguments)}}())})}examLiveStudents_teacher_unbsubscribe(t){this.removeAllunsubscribe("exam_live_students_"+t)}examLiveStudents_student_saveChange(t,i){var s=this;return new Mn.y(a=>{this.getFirestoreDbForStudentExam(!1,t).subscribe(function(){var l=(0,O.Z)(function*(d){if(d&&1==d.success)try{var p=yield s._saveDocument(d.data,"exam_live_students/"+t,s.getUserId(),i);a.next({success:1,data:p})}catch(x){console.log(x),a.next({success:0,message:"EXCEPTION",ex:x.toString()})}else a.next(d)});return function(d){return l.apply(this,arguments)}}())})}examLiveStudents_teacher_saveChange(t,i,s){var a=this;return new Mn.y(l=>{this.getFirestoreDbForTeacherExam(!1,t).subscribe(function(){var d=(0,O.Z)(function*(p){if(p&&1==p.success)try{var x=yield a._saveDocumentMerge(p.data,"exam_live_students/"+t,i,s);l.next({success:1,data:x})}catch(b){console.log(b),l.next({success:0,message:"EXCEPTION",ex:b.toString()})}else l.next(p)});return function(p){return d.apply(this,arguments)}}())})}getFirestoreDb(t){return new Mn.y(i=>{var s=this.createFirestoreKey("firestore_db"),a=this.getLocalFirestoreDb(s);null!=a&&0==t?(i.next({success:1,data:a,message:"successful"}),i.complete()):this.firestoreServiceApi.apiFirestoreGetSimpleTokenGet().subscribe(d=>{d&&1==d.success?(0,g._p)(this.getAuthApp(),d?.data?.token??"").then(()=>{var x=yi(this.app);this.setLocalFirestoreDb(s,x),i.next({success:1,data:x,message:"successful"}),i.complete()}).catch(x=>{"auth/invalid-custom-token"===x.code?(i.next({success:0,data:void 0,message:"EXPIRED"}),i.complete()):(i.next({success:0,data:void 0,message:"AUTH_ERROR"}),i.complete())}):(i.next({success:0,data:void 0,message:d.message??""}),i.complete())})})}getFirestoreDbForStudentExam(t,i){return new Mn.y(s=>{var a=this.createFirestoreKey("firestore_db_student_"+i),l=this.getLocalFirestoreDb(a);null!=l&&0==t?(s.next({success:1,data:l,message:"successful"}),s.complete()):this.firestoreServiceApi.apiFirestoreGetStudentExamTokenGet(i).subscribe(p=>{p&&1==p.success?(0,g._p)(this.getAuthApp(),p?.data?.token??"").then(()=>{var b=yi(this.app);this.setLocalFirestoreDb(a,b),s.next({success:1,data:b,message:"successful"}),s.complete()}).catch(b=>{"auth/invalid-custom-token"===b.code?(s.next({success:0,data:void 0,message:"EXPIRED"}),s.complete()):(s.next({success:0,data:void 0,message:"AUTH_ERROR"}),s.complete())}):(s.next({success:0,data:void 0,message:p.message??""}),s.complete())})})}getFirestoreDbForTeacherExam(t,i){return new Mn.y(s=>{var a=this.createFirestoreKey("firestore_db_teacher_"+i),l=this.getLocalFirestoreDb(a);null!=l&&0==t?(s.next({success:1,data:l,message:"successful"}),s.complete()):this.firestoreServiceApi.apiFirestoreGetTeacherExamTokenGet(i).subscribe(p=>{p&&1==p.success?(0,g._p)(this.getAuthApp(),p?.data?.token??"").then(()=>{var b=yi(this.app);this.setLocalFirestoreDb(a,b),s.next({success:1,data:b,message:"successful"}),s.complete()}).catch(b=>{"auth/invalid-custom-token"===b.code?(s.next({success:0,data:void 0,message:"EXPIRED"}),s.complete()):(s.next({success:0,data:void 0,message:"AUTH_ERROR"}),s.complete())}):(s.next({success:0,data:void 0,message:p.message??""}),s.complete())})})}signInUserByToken(t){return new Mn.y(i=>{(0,g._p)(this.getAuthApp(),t).then(()=>{i.next({success:1,data:"",message:"successful"}),i.complete()}).catch(s=>{"auth/invalid-custom-token"===s.code?(i.next({success:0,data:"",message:"EXPIRED"}),i.complete()):(i.next({success:0,data:"",message:"AUTH_ERROR"}),i.complete())})})}setLocalFirestoreDb(t,i){this.firestoreDbs[t]=i}getLocalFirestoreDb(t){if(this.firestoreDbs.hasOwnProperty(t))return this.firestoreDbs[t]}removeLocalFirestoreDb(t){this.firestoreDbs.hasOwnProperty(t)&&delete this.firestoreDbs[t]}createFirestoreKey(t){return this.userService.getUserObj().id+"_"+t}getUserId(){return this.userService.getUserObj().id?.toString()??"0"}addUnsubscribe(t,i){t=this.getUserId()+"_"+t,this.listSubscribers.hasOwnProperty(t)||(this.listSubscribers[t]=[]),this.listSubscribers[t].push(i)}removeAllunsubscribe(t){if(t=this.getUserId()+"_"+t,this.listSubscribers.hasOwnProperty(t)){for(var i=0;i<this.listSubscribers[t].length;i++)this.listSubscribers[t][i]();delete this.listSubscribers[t]}}_saveDocument(t,i,s,a){var l=this;return(0,O.Z)(function*(){return i=l.getBaseFirestore()+"/"+i,yield Pm(Qs(t,i,s),l.commonSerivce.myClone(a)),s})()}_saveDocumentMerge(t,i,s,a){var l=this;return(0,O.Z)(function*(){return i=l.getBaseFirestore()+"/"+i,yield Pm(Qs(t,i,s),l.commonSerivce.myClone(a),{merge:!0}),s})()}_getCollection(t,i){var s=this;return(0,O.Z)(function*(){i=s.getBaseFirestore()+"/"+i;const a=ia(t,i);return(yield Mm(a)).docs.map(p=>p.data())})()}_getDocument(t,i,s){var a=this;return(0,O.Z)(function*(){i=a.getBaseFirestore()+"/"+i;const l=Qs(t,i,s),d=yield function Wm(n){n=St(n,tn);const e=St(n.firestore,gt);return function Ge(n,e,t={}){const i=new xn;return n.asyncQueue.enqueueAndForget((0,O.Z)(function*(){return function(s,a,l,d,p){const x=new El({next:I=>{a.enqueueAndForget(()=>Ru(s,b));const G=I.docs.has(l);!G&&I.fromCache?p.reject(new Ie(re.UNAVAILABLE,"Failed to get document because the client is offline.")):G&&I.fromCache&&d&&"server"===d.source?p.reject(new Ie(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(I)},error:I=>p.reject(I)}),b=new Nu(mr(l.path),x,{includeMetadataChanges:!0,Nu:!0});return Ho(s,b)}(yield N(n),n.asyncQueue,e,t,i)})),i.promise}(fn(e),n._key).then(t=>im(e,n,t))}(l);return d.exists()?d.data():null})()}_getDocuments(t,i,s){var a=this;return(0,O.Z)(function*(){var l={};i=a.getBaseFirestore()+"/"+i;const d=bm(ia(t,i),Cm(function Rm(){return new Sl("__name__")}(),"in",s));return(yield Mm(d)).forEach(x=>{l[x.id]=x.data()}),l})()}_removeDocument(t,i,s){var a=this;return(0,O.Z)(function*(){i=a.getBaseFirestore()+"/"+i,yield function Gm(n){return gh(St(n.firestore,gt),[new Is(n._key,Wt.none())])}(Qs(t,i,s))})()}myOnSnapshot(t,i,s,a){return Jf(Qs(t,i=this.getBaseFirestore()+"/"+i,s),d=>{a(d.data())})}myOnSnapshotCollection(t,i,s){return Jf(ia(t,i=this.getBaseFirestore()+"/"+i),function(){var l=(0,O.Z)(function*(d){var p=[];d.forEach(x=>{p.push(x.data())}),s(p)});return function(d){return l.apply(this,arguments)}}())}myOnSnapshotOnlyChangeInCollection(t,i,s){return Jf(ia(t,i=this.getBaseFirestore()+"/"+i),function(){var l=(0,O.Z)(function*(d){var p=[];d.docChanges().forEach(x=>{p.push(x.doc.data())}),s(p)});return function(d){return l.apply(this,arguments)}}())}myOnSnapshotCollectionWithQuery(t,i,s,a){return Jf(bm(ia(t,i=this.getBaseFirestore()+"/"+i),Cm(s[0],s[1],s[2])),function(){var p=(0,O.Z)(function*(x){var b=[];x.docChanges().forEach(I=>{b.push(I.doc.data())}),a(b)});return function(x){return p.apply(this,arguments)}}())}getBaseFirestore(){return Dm.N.firestoreBase}getInitApp(){return this.app}getAuthApp(){return(0,g.v0)(this.app)}constructor(t,i,s){this.firestoreServiceApi=t,this.userService=i,this.commonSerivce=s,this.firestoreDbs={},this.listSubscribers={},this.app=(0,u.ZF)(Dm.N.firestoreConfig_app1,"firestoreapp")}}return n.\u0275fac=function(t){return new(t||n)(Yf.LFG(Ym.C),Yf.LFG(Hm.U),Yf.LFG(Xm.z))},n.\u0275prov=Yf.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},41003:(at,ue,w)=>{"use strict";w.d(ue,{Ip:()=>F,JR:()=>B,Le:()=>u,O8:()=>O,a3:()=>g,fI:()=>h,uG:()=>m});const O="00B050",u="f44336",g="_@COLOR@_",h="_@COLOR_END@_";function _(E,R,A){return E.replace(new RegExp(R,"g"),A)}function m(E,R="math",A=" xmlns"){if(!E)return"";const L=E.split(`<${R}`);return[["<span class=\"qv_string_eng_ans\" style='([^']+)'>([^<]*)<span style='([^']+)'>([A-Z])</span></span>",'<b><u below="$4"> $2</u></b>'],["([^>])(\r\n|\r|\n)([^<])","$1<br/>$3"]].forEach(U=>{for(let Z=0;Z<L.length;Z++)if(L[Z].startsWith(A)){const le=L[Z].split(`</${R}>`);le.length>0&&(le[1]=_(le[1],U[0],U[1])),L[Z]=le.join(`</${R}>`)}else L[Z]=_(L[Z],U[0],U[1])}),L.join(`<${R}`)}function B(E){return E.forEach(R=>{R.content=m(R.content);for(let A=0;A<R.answers.length;A++)R.answers[A]=m(R.answers[A])}),E}const W=[{key:"TABLE",value:'<w:tblPr><w:tblStyle w:val="TableGrid" /><w:tblpPr w:leftFromText="180" w:rightFromText="180" w:vertAnchor="text" w:tblpXSpec="right" w:tblpY="1" /><w:tblOverlap w:val="never" /><w:tblW w:w="0" w:type="auto" /><w:tblBorders><w:insideV w:val="none" w:sz="0" w:space="0" w:color="auto" /></w:tblBorders><w:tblCellMar><w:top w:w="113" w:type="dxa" /><w:left w:w="397" w:type="dxa" /><w:bottom w:w="113" w:type="dxa" /><w:right w:w="397" w:type="dxa" /></w:tblCellMar><w:tblLook w:val="0600" w:firstRow="0" w:lastRow="0" w:firstColumn="0" w:lastColumn="0" w:noHBand="1" w:noVBand="1" /></w:tblPr>'},{key:"CORRECT",value:`<w:tcPr><w:tcW w:w="0" w:type="auto" /><w:tcBorders><w:top w:val="single" w:sz="4" w:space="0" w:color="FFFFFF" /><w:left w:val="single" w:sz="4" w:space="0" w:color="FFFFFF" /><w:bottom w:val="single" w:sz="4" w:space="0" w:color="FFFFFF" /><w:right w:val="single" w:sz="4" w:space="0" w:color="${g}" /></w:tcBorders><w:vAlign w:val="center" /></w:tcPr>`},{key:"KEY_RESULT",value:`<w:tcPr><w:tcW w:w="0" w:type="auto" /><w:tcBorders><w:top w:val="single" w:sz="4" w:space="0" w:color="${g}" /><w:left w:val="single" w:sz="4" w:space="0" w:color="FFFFFF" /><w:bottom w:val="single" w:sz="4" w:space="0" w:color="${g}" /><w:right w:val="single" w:sz="4" w:space="0" w:color="${h}" /></w:tcBorders><w:vAlign w:val="center" /></w:tcPr>`},{key:"FILL_RESULT",value:`<w:tcPr><w:tcW w:w="0" w:type="auto" /><w:tcBorders><w:top w:val="single" w:sz="4" w:space="0" w:color="${g}" /><w:left w:val="single" w:sz="4" w:space="0" w:color="FFFFFF" /><w:bottom w:val="single" w:sz="4" w:space="0" w:color="${g}" /><w:right w:val="single" w:sz="4" w:space="0" w:color="${g}" /></w:tcBorders><w:vAlign w:val="center" /></w:tcPr>`},{key:"HEADER_TABLE",value:'<w:tblPr><w:tblW w:w="0" w:type="auto"/><w:jc w:val="center"/><w:tblBorders><w:top w:val="single" w:sz="4" w:space="0" w:color="auto"/><w:left w:val="single" w:sz="4" w:space="0" w:color="auto"/><w:bottom w:val="single" w:sz="4" w:space="0" w:color="auto"/><w:right w:val="single" w:sz="4" w:space="0" w:color="auto"/><w:insideH w:val="single" w:sz="4" w:space="0" w:color="auto"/><w:insideV w:val="single" w:sz="4" w:space="0" w:color="auto"/></w:tblBorders><w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/></w:tblPr>'},{key:"HEADER_TABLE_NO_BORDER",value:'<w:tblPr><w:tblW w:w="0" w:type="auto"/><w:jc w:val="center"/><w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/></w:tblPr>'},{key:"HEADER_TABLE_TR",value:'<w:trPr><w:jc w:val="center" /></w:trPr>'},{key:"HEADER_TABLE_LEFT",value:'<w:tcPr><w:tcW w:w="3528" w:type="dxa" /></w:tcPr>'},{key:"HEADER_TABLE_RIGHT",value:'<w:tcPr><w:tcW w:w="7262" w:type="dxa" /><w:hideMark /></w:tcPr>'},{key:"TB_RESULT_TXT",value:'<w:pPr><w:jc w:val="center" /></w:pPr>'},{key:"TB_RESULT_POINT",value:'<w:pPr><w:jc w:val="center" /></w:pPr>'},{key:"TB_RESULT_COMMENT",value:"<w:pPr><w:rPr><w:i /><w:iCs /></w:rPr></w:pPr>"},{key:"LINE_CENTER",value:'<w:pPr><w:jc w:val="center" /></w:pPr>'}];class F{static get(R,A=[]){const fe=W.find(L=>L.key===R);if(fe){let L=fe.value;for(const U of A)L=_(L,U.key,U.value);return btoa(L)}return""}static makeHeaderTable(R,A,fe=!0){const L=document.createElement("table"),U=document.createElement("tr");L.appendChild(U);const Z=document.createElement("td"),le=document.createElement("td");U.appendChild(Z),U.appendChild(le),L.setAttribute("docx-style",F.get(fe?"HEADER_TABLE":"HEADER_TABLE_NO_BORDER")),U.setAttribute("docx-style",F.get("HEADER_TABLE_TR")),Z.setAttribute("docx-style",F.get("HEADER_TABLE_LEFT")),le.setAttribute("docx-style",F.get("HEADER_TABLE_RIGHT"));const P=document.createElement("span"),H=document.createElement("span");return R.forEach(ce=>{if("string"==typeof ce){const ge=document.createElement("br"),Oe=document.createElement("b");Oe.innerText=ce,Oe.appendChild(ge),P.appendChild(Oe)}else P.appendChild(ce)}),A.forEach(ce=>{if("string"==typeof ce){const ge=document.createElement("br"),Oe=document.createElement("b");Oe.innerText=ce,Oe.appendChild(ge),H.appendChild(Oe)}else H.appendChild(ce)}),Z.appendChild(P),le.appendChild(H),L.outerHTML}static createLineBold(R){const A=document.createElement("p"),fe=document.createElement("b");return fe.innerText=R,A.appendChild(fe),A}static createLineCenterBold(R){const A=document.createElement("p"),fe=document.createElement("b");return A.setAttribute("docx-style",F.get("LINE_CENTER")),fe.innerText=R,A.appendChild(fe),A}static createLineCenterItalicized(R){const A=document.createElement("p"),fe=document.createElement("i");return A.setAttribute("docx-style",F.get("LINE_CENTER")),fe.innerText=R,A.appendChild(fe),A}}},38801:(at,ue,w)=>{"use strict";w.d(ue,{G:()=>g});var O=w(65879),u=w(52846);let g=(()=>{class h{constructor(m){this.envService=m}getTmpVersionMonitor(){var m=this.envService.getEnvValue("classliveUrl"),B="1.0";if(m){var W=m.split("=");W.length>1&&(B=W[1])}return"https://azota889.github.io/storage_public/almo/listactive.js?ver="+B}getMNoteVer(){var m=this.envService.getEnvValue("classliveUrl"),B="1.0";if(m){var W=m.split("=");W.length>1&&(B=W[1])}return B}checkValidForSetUpMonitor(){return!0}}return h.\u0275fac=function(m){return new(m||h)(O.LFG(u.h))},h.\u0275prov=O.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},32955:(at,ue,w)=>{"use strict";w.d(ue,{r:()=>g});var O=w(65879),u=w(87384);let g=(()=>{class h{constructor(m){this.commonService=m}partQuestionSearchText(m){let B=m.content??"",W=m.answers?.findIndex(F=>m.answerResult?.includes(F.key??""));if(void 0!==W&&-1!=W){let F=m.answers?.map(E=>E.content??"")??[];B+="\n"+this.commonService.getCorrectAnsTxt(F,W)}return this.commonService.parseQuestionContent(B)}partQuestionSearchTextByQuestionForm(m){let B=m.questionContent??"";const W=this.commonService.myParseJson(m.answerConfig??""),F=this.commonService.myParseJson(m?.answerResult??"[]")??[""];let E=W?.findIndex(R=>F.includes(R.key??""));if(void 0!==E&&-1!=E){let R=W?.map(A=>A.content??"")??[];B+="\n"+this.commonService.getCorrectAnsTxt(R,E)}return this.commonService.parseQuestionContent(B)}}return h.\u0275fac=function(m){return new(m||h)(O.LFG(u.z))},h.\u0275prov=O.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},9855:(at,ue,w)=>{"use strict";w.d(ue,{U:()=>ze});var O=w(85965),u=w(3760),g=w(10548),h=w(19347),_=w(39621),m=w(65879),B=w(96814),W=w(30251),F=w(11964);function E(k,Re){if(1&k&&(m.TgZ(0,"li"),m._uU(1),m.qZA()),2&k){const y=Re.$implicit;m.xp6(1),m.hij("* ",y.message,"")}}function R(k,Re){1&k&&(m.TgZ(0,"span",10),m._uU(1),m.ALo(2,"mytranslate"),m.TgZ(3,"span",11),m._uU(4),m.ALo(5,"mytranslate"),m.qZA(),m._uU(6),m.ALo(7,"mytranslate"),m.ALo(8,"mytranslate"),m.qZA()),2&k&&(m.xp6(1),m.hij(" ",m.lcZ(2,4,"lang_auto_click")," "),m.xp6(3),m.hij('"',m.lcZ(5,6,"lang_auto_tai_ve"),'"'),m.xp6(2),m.AsE(" ",m.lcZ(7,8,"lang_auto_de_tai_ve")," ",m.lcZ(8,10,"lang_auto_cac_bai_lam_da_tao_thanh_cong"),". "))}function A(k,Re){if(1&k){const y=m.EpF();m.TgZ(0,"button",19),m.NdJ("click",function(){m.CHM(y);const D=m.oxw();return m.KtG(D.onPressTrue())}),m._uU(1),m.ALo(2,"mytranslate"),m.qZA()}2&k&&(m.xp6(1),m.hij(" ",m.lcZ(2,1,"lang_auto_tai_ve")," "))}let fe=(()=>{class k extends _.Q{onPressTrue(){this.dialogRef.close(!0)}constructor(y,S){super(),this.data=y,this.dialogRef=S,this.result=y.result}}return k.\u0275fac=function(y){return new(y||k)(m.Y36(h.WI),m.Y36(h.so,8))},k.\u0275cmp=m.Xpm({type:k,selectors:[["app-push-error-student-export-docx"]],features:[m.qOj],decls:32,vars:23,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"box-header","bg-slate-100","dark:bg-darkmode-400"],[1,"header-left"],[1,"header-right"],["azt-track-service","push-error-student-export-xUXBRZF-kY1",1,"btn","btn-transparent","btn-outline-danger","btn-sm",3,"mat-dialog-close"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"box-content"],[1,"box-title"],[1,"box-description"],[3,"defaultHeight"],[1,"box-list"],[4,"ngFor","ngForOf"],["class","box-title",4,"ngIf"],[1,"p-3","text-right"],["azt-track-service","push-error-student-export-PEAaBsdI7jR",1,"btn","w-24","btn-secondary","mr-3",3,"mat-dialog-close"],["azt-track-service","push-error-student-export-cI-G2ar81ss","class","btn w-24 btn-primary",3,"click",4,"ngIf"],["azt-track-service","push-error-student-export-cI-G2ar81ss",1,"btn","w-24","btn-primary",3,"click"]],template:function(y,S){1&y&&(m.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),m._uU(4),m.ALo(5,"mytranslate"),m.qZA(),m.TgZ(6,"div",4)(7,"a",5),m.O4$(),m.TgZ(8,"svg",6),m._UZ(9,"line",7)(10,"line",8),m.qZA()()()(),m.kcU(),m.TgZ(11,"div",9)(12,"span",10),m._uU(13),m.ALo(14,"mytranslate"),m.TgZ(15,"span",11),m._uU(16),m.qZA(),m._uU(17),m.ALo(18,"lowercase"),m.ALo(19,"mytranslate"),m.qZA(),m.TgZ(20,"span",10),m._uU(21),m.ALo(22,"mytranslate"),m.qZA(),m.TgZ(23,"azt-mat-dialog-content",12)(24,"ul",13),m.YNc(25,E,2,1,"li",14),m.qZA()(),m.YNc(26,R,9,12,"span",15),m.qZA(),m.TgZ(27,"div",16)(28,"a",17),m._uU(29),m.ALo(30,"mytranslate"),m.qZA(),m.YNc(31,A,3,3,"button",18),m.qZA()()()),2&y&&(m.xp6(4),m.Oqu(m.lcZ(5,11,"lang_auto_xay_ra_loi_trong_qua_trinh_xuat_docx")),m.xp6(9),m.hij(" ",m.lcZ(14,13,"lang_auto_he_thong_tao_thanh_cong_cho")," "),m.xp6(3),m.AsE("",S.result.datas.length,"/",S.result.errs.length+S.result.datas.length,""),m.xp6(1),m.hij(" ",m.lcZ(18,15,m.lcZ(19,17,"lang_auto_hoc_sinh"))," "),m.xp6(4),m.hij(" ",m.lcZ(22,19,"lang_auto_danh_sach_hoc_sinh_khong_the_tao_file_ket_qua"),": "),m.xp6(2),m.Q6J("defaultHeight",60),m.xp6(2),m.Q6J("ngForOf",S.result.errs),m.xp6(1),m.Q6J("ngIf",S.result.datas.length>0),m.xp6(3),m.hij(" ",m.lcZ(30,21,"lang_cms_common_close_btn")," "),m.xp6(2),m.Q6J("ngIf",S.result.datas.length>0))},dependencies:[B.sg,B.O5,h.ZT,W.R,B.i8,F.JV],styles:[".box[_ngcontent-%COMP%]{max-width:600px}.box-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;border-radius:.375rem}.box-content[_ngcontent-%COMP%]{padding:10px 20px}.box-title[_ngcontent-%COMP%]{display:block;font-weight:500;font-size:15px;padding:10px 0}.box-description[_ngcontent-%COMP%]{color:rgb(var(--color-primary))}.box-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:#f44336}"]}),k})();var L=w(56223),U=w(60723),Z=w(50626),le=w(92596),P=w(95545),H=w(775),ce=w(52544),ge=w(7544),Oe=w(68234);function qe(k,Re){if(1&k&&(m.TgZ(0,"span",32),m._uU(1),m.qZA()),2&k){const y=m.oxw();let S;m.xp6(1),m.Oqu(null!==(S=null==y.studentsInClassResults[0].classObj?null:y.studentsInClassResults[0].classObj.name)&&void 0!==S?S:"")}}function Me(k,Re){if(1&k&&(m.TgZ(0,"div",37)(1,"div",19),m._UZ(2,"input",38),m.TgZ(3,"label",39,40),m._uU(5),m.qZA()()()),2&k){const y=Re.$implicit,S=m.MAs(4),D=m.oxw(2);let j;m.Q6J("hidden",1===D.studentsInClassResults.length),m.xp6(2),m.MGl("id","select-classroom-export__",null==y.classObj?null:y.classObj.id,""),m.Q6J("value",null==y.classObj?null:y.classObj.id),m.xp6(1),m.MGl("for","select-classroom-export__",null==y.classObj?null:y.classObj.id,""),m.Q6J("matTooltip",null!==(j=null==y.classObj?null:y.classObj.name)&&void 0!==j?j:"")("isDisabledTooltip",!1)("matTooltipDisabled",S.isDisabled),m.xp6(2),m.Oqu(null==y.classObj?null:y.classObj.name)}}const pt=function(k,Re){return{"box-classrooms":k,"box-max-classrooms":Re}};function Fe(k,Re){if(1&k&&(m.TgZ(0,"div",33)(1,"ng-scrollbar",34)(2,"div",35),m.YNc(3,Me,6,8,"div",36),m.qZA()()()),2&k){const y=m.oxw();let S;m.Q6J("ngClass",m.WLB(3,pt,(null==(S=y.form.get("listStudents"))?null:S.controls.length)>21||y.studentsInClassResults.length>18,(null==(S=y.form.get("listStudents"))?null:S.controls.length)<=21&&y.studentsInClassResults.length>18)),m.xp6(1),m.Q6J("visibility","hover"),m.xp6(2),m.Q6J("ngForOf",y.studentsInClassResults)}}function ht(k,Re){if(1&k&&(m.TgZ(0,"label",39,40),m._uU(2),m.qZA()),2&k){const y=m.MAs(1),S=m.oxw().$implicit;let D,j,de;m.MGl("for","select-classroom-export__",null==(D=S.get("id"))?null:D.value,""),m.Q6J("matTooltip",null!==(j=null==(j=S.get("label"))?null:j.value)&&void 0!==j?j:"")("isDisabledTooltip",!1)("matTooltipDisabled",y.isDisabled),m.xp6(2),m.Oqu(null==(de=S.get("label"))?null:de.value)}}function we(k,Re){if(1&k&&(m.TgZ(0,"label",46),m._UZ(1,"img",47),m.qZA()),2&k){const y=m.oxw().$implicit;let S,D;m.MGl("for","select-classroom-export__",null==(S=y.get("id"))?null:S.value,""),m.xp6(1),m.Q6J("nameImages",null==(D=y.get("nameImages"))?null:D.value)}}function Ne(k,Re){if(1&k){const y=m.EpF();m.TgZ(0,"div",41)(1,"div",42)(2,"input",43),m.NdJ("change",function(){m.CHM(y);const D=m.oxw();return m.KtG(D.onChangeStudentOption())}),m.qZA(),m.YNc(3,ht,3,5,"label",44),m.YNc(4,we,2,2,"label",45),m.qZA()()}if(2&k){const y=Re.$implicit;let S,D,j;m.xp6(1),m.Q6J("formGroup",y),m.xp6(1),m.MGl("id","select-classroom-export__",null==(S=y.get("id"))?null:S.value,""),m.xp6(1),m.Q6J("ngIf",(null==(D=y.get("label"))?null:D.value)||!(null!=(D=y.get("isImage"))&&D.value)),m.xp6(1),m.Q6J("ngIf",!(null!=(j=y.get("label"))&&j.value)&&(null==(j=y.get("isImage"))?null:j.value))}}function X(k,Re){1&k&&(m.TgZ(0,"span",28),m._uU(1),m.ALo(2,"mytranslate"),m.qZA()),2&k&&(m.xp6(1),m.hij("* ",m.lcZ(2,1,"lang_core_chon_it_nhat_mot_hoc_sinh"),""))}function Be(k,Re){if(1&k){const y=m.EpF();m.TgZ(0,"div",51),m.NdJ("click",function(){m.CHM(y);const D=m.oxw(2);return m.KtG(D.showAskInfo=!0)}),m._uU(1),m.ALo(2,"mytranslate"),m.qZA()}2&k&&(m.xp6(1),m.hij("+ ",m.lcZ(2,1,"lang_testbank_test_config_add_information"),""))}function V(k,Re){if(1&k&&(m.TgZ(0,"div"),m._UZ(1,"add-info-print",52),m.qZA()),2&k){const y=m.oxw(2);m.xp6(1),m.Q6J("form",y.form)}}function oe(k,Re){1&k&&(m.TgZ(0,"span",55),m._uU(1),m.ALo(2,"mytranslate"),m.qZA()),2&k&&(m.xp6(1),m.hij("(",m.lcZ(2,1,"lang_auto_cac_thong_tin_khong_bat_buoc"),")"))}function pe(k,Re){if(1&k){const y=m.EpF();m.TgZ(0,"div",53),m.NdJ("click",function(){m.CHM(y);const D=m.oxw(2);return m.KtG(D.showAskInfo=!1)}),m._uU(1),m.ALo(2,"mytranslate"),m.ALo(3,"lowercase"),m.ALo(4,"mytranslate"),m.YNc(5,oe,3,3,"span",54),m.qZA()}if(2&k){const y=m.oxw(2);m.xp6(1),m.AsE(" ",m.lcZ(2,3,"lang_auto_huy")," ",m.lcZ(3,5,m.lcZ(4,7,"lang_testbank_test_config_add_information"))," "),m.xp6(4),m.Q6J("ngIf",y.isAskInfo&&y.showAskInfo)}}function Ue(k,Re){if(1&k&&(m.TgZ(0,"div")(1,"span",48),m._uU(2),m.ALo(3,"mytranslate"),m.qZA(),m.YNc(4,Be,3,3,"div",49),m.YNc(5,V,2,1,"div",27),m.YNc(6,pe,6,9,"div",50),m.qZA()),2&k){const y=m.oxw();m.xp6(2),m.AsE("* ",m.lcZ(3,5,"lang_core_so_hoc_sinh_da_duoc_lua_chon")," : ",y.countStudentSelect,""),m.xp6(2),m.Q6J("ngIf",y.isAskInfo&&!y.showAskInfo),m.xp6(1),m.Q6J("ngIf",y.isAskInfo&&y.showAskInfo),m.xp6(1),m.Q6J("ngIf",y.isAskInfo&&y.showAskInfo)}}function rt(k,Re){1&k&&(m.TgZ(0,"div")(1,"div",16)(2,"span",28),m._uU(3),m.ALo(4,"mytranslate"),m.qZA()()()),2&k&&(m.xp6(3),m.hij("* ",m.lcZ(4,1,"lang_testbank_exam_result_there_is_no_result_in_exam"),""))}let Je=(()=>{class k extends _.Q{confirmAction(){const y=this.form.value,S=this.studentsInClassResults.find(D=>D.classObj?.id===y.classId);if(S){const D=y.listStudents.filter(j=>j.choose).map(j=>j.id);S.results=S.results?.filter(j=>D.includes(j.reId)),S.schoolName=this.showAskInfo?y.schoolName:void 0,S.subjectName=this.showAskInfo?y.subjectName:void 0,this.dialogRef.close(S)}else this.dialogRef.close()}setChangeSelectAll(){const y=this.form.get("selectAll");if(y){y.setValue(!y.value);const S=this.form.get("listStudents");S&&S.controls.forEach(D=>{D.get("choose").setValue(y.value)}),this.countStudentSelect=y.value?S.controls.length:0}}onChangeStudentOption(){const y=this.form.get("listStudents");let S=!0,D=0;y&&y.controls.forEach(de=>{!1===de.get("choose").value?S=!1:D++});const j=this.form.get("selectAll");j&&j.setValue(S),this.countStudentSelect=D}setupArrayStudent(y){this.currNameClass=y.classObj?.name??"";const S=this.form.get("listStudents");if(S){S.clear();let D=y.results??[];if(void 0!==y.classObj?.sortType){let j=y.classObj?.sortType;D=0==j?this.sortService.sortFirstNameStudents(this.commonService.myClone(D)):99==j?this.sortService.sortTimeDESC(this.commonService.myClone(D)):this.sortService.sortArrayByMultipleObjectKeyAsc(this.commonService.myClone(D),"pos","id")}D.forEach(j=>{(j.confirmedAt||!this.data.examHasEssay&&1==j.status)&&S.push(this.fb.group({isImage:new L.p4(j.nameImages),nameImages:new L.p4(j.nameImages),label:new L.p4(j.fullName),id:new L.p4(j.reId),choose:new L.p4(!1)}))})}}classroomChange(y){this.setupArrayStudent(y)}ngOnInit(){if(super.ngOnInit(),this.studentsInClassResults.length>0){let y=this.studentsInClassResults[0];this.form=this.fb.group({classId:new L.p4(y.classObj?.id,[L.kI.required]),selectAll:new L.p4(!1),listStudents:this.fb.array([]),schoolName:new L.p4(""),subjectName:new L.p4("")}),this.setupArrayStudent(y),this.form.get("classId").valueChanges.subscribe(D=>{const j=this.form.get("selectAll");j&&j.setValue(!1),this.countStudentSelect=0;const de=this.studentsInClassResults.find(J=>J.classObj?.id===D);de&&this.setupArrayStudent(de)})}}constructor(y,S,D,j){super(),this.fb=y,this.sortService=S,this.data=D,this.dialogRef=j,this.studentsInClassResults=[],this.form=new L.nJ({}),this.countStudentSelect=0,this.showAskInfo=!1,this.currNameClass="",this.isAskInfo=D.isAskInfo,this.studentsInClassResults=D.studentsInClassResults.map(de=>({...de,results:de.results?.map(J=>({...J,reId:U.G.generateIdRequired(10)}))}))}}return k.\u0275fac=function(y){return new(y||k)(m.Y36(L.qu),m.Y36(Z.V),m.Y36(h.WI),m.Y36(h.so,8))},k.\u0275cmp=m.Xpm({type:k,selectors:[["app-select-student-to-export-docx"]],features:[m.qOj],decls:50,vars:35,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"box-header","bg-slate-100","dark:bg-darkmode-400"],[1,"header-left"],[1,"header-right"],["azt-track-service","select-student-export-sMT2Np4C_Vf",1,"btn","btn-transparent","btn-outline-danger","btn-sm",3,"mat-dialog-close"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"box-content"],[3,"formGroup","hidden"],[1,"col-span-12",3,"hidden"],[1,"mb-3","mt-3","font-medium","flex","items-center","px-3"],["class","text-only-class",4,"ngIf"],["class","box-min-classrooms",3,"ngClass",4,"ngIf"],[3,"hidden"],[1,"col-span-12","mt-2","px-3"],[1,"font-medium","flex","items-center"],[1,"col-span-12","mt-2","mb-2","px-3","pt-0"],[1,"form-check","mr-10"],["id","select-all-students","type","checkbox",1,"form-check-input",3,"checked","change"],["for","select-all-students",1,"form-check-label"],[1,"box-students"],["pointerEventsMethod","scrollbar",2,"width","100%","height","100%",3,"visibility"],[1,"grid","grid-cols-12","p-3",2,"align-items","center"],["class","col-span-12 md:col-span-4 mt-2","formArrayName","listStudents",4,"ngFor","ngForOf"],["class","err-color",4,"ngIf"],[4,"ngIf"],[1,"err-color"],[1,"p-3","text-right"],["azt-track-service","select-student-export-H_SWYi6hbiY",1,"btn","w-24","btn-secondary","mr-3",3,"mat-dialog-close"],["azt-track-service","select-student-export-FAs4GdQImfT",1,"btn","w-24","btn-primary",3,"disabled","click"],[1,"text-only-class"],[1,"box-min-classrooms",3,"ngClass"],["track","vertical","pointerEventsMethod","scrollbar",3,"visibility"],[1,"grid","grid-cols-12","p-3","pt-0",2,"align-items","center"],["class","col-span-12 md:col-span-4 mt-2",3,"hidden",4,"ngFor","ngForOf"],[1,"col-span-12","md:col-span-4","mt-2",3,"hidden"],["formControlName","classId","type","radio",1,"form-check-input",3,"id","value"],[1,"form-check-label","truncate",3,"matTooltip","isDisabledTooltip","matTooltipDisabled","for"],["c","isDisabled"],["formArrayName","listStudents",1,"col-span-12","md:col-span-4","mt-2"],[1,"form-check","mr-10",3,"formGroup"],["formControlName","choose","type","checkbox",1,"form-check-input",3,"id","change"],["class","form-check-label truncate",3,"matTooltip","isDisabledTooltip","matTooltipDisabled","for",4,"ngIf"],["class","form-check-label truncate",3,"for",4,"ngIf"],[1,"form-check-label","truncate",3,"for"],["appDrawNameImage","",1,"img-name-fluid",3,"nameImages"],[1,"note-color"],["azt-track-service","select-student-export-RBRnT8RJQO0","class","mt-1 font-medium more-info-color",3,"click",4,"ngIf"],["azt-track-service","select-student-export-u8TMFqclpqj","class","mt-2 font-medium more-info-color",3,"click",4,"ngIf"],["azt-track-service","select-student-export-RBRnT8RJQO0",1,"mt-1","font-medium","more-info-color",3,"click"],[3,"form"],["azt-track-service","select-student-export-u8TMFqclpqj",1,"mt-2","font-medium","more-info-color",3,"click"],["class","ms-1 font-medium text-xs text-slate-500",4,"ngIf"],[1,"ms-1","font-medium","text-xs","text-slate-500"]],template:function(y,S){if(1&y&&(m.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),m._uU(4),m.ALo(5,"mytranslate"),m.qZA(),m.TgZ(6,"div",4)(7,"a",5),m.O4$(),m.TgZ(8,"svg",6),m._UZ(9,"line",7)(10,"line",8),m.qZA()()()(),m.kcU(),m.TgZ(11,"div",9)(12,"form",10)(13,"div",11)(14,"div",12),m._uU(15),m.ALo(16,"mytranslate"),m.YNc(17,qe,2,1,"span",13),m.qZA()(),m.YNc(18,Fe,4,6,"div",14),m.TgZ(19,"div",15)(20,"div",16)(21,"div",17),m._uU(22),m.ALo(23,"mytranslate"),m.qZA()(),m.TgZ(24,"div",18)(25,"div",19)(26,"input",20),m.NdJ("change",function(){return S.setChangeSelectAll()}),m.qZA(),m.TgZ(27,"label",21),m._uU(28),m.ALo(29,"mytranslate"),m.qZA()()(),m.TgZ(30,"div",22)(31,"ng-scrollbar",23)(32,"div",24),m.YNc(33,Ne,5,4,"div",25),m.qZA()()(),m.TgZ(34,"div",16),m.YNc(35,X,3,3,"span",26),m.YNc(36,Ue,7,7,"div",27),m.qZA()(),m.TgZ(37,"div",15)(38,"div",16)(39,"span",28),m._uU(40),m.ALo(41,"mytranslate"),m.qZA()()()(),m.YNc(42,rt,5,3,"div",27),m.qZA(),m.TgZ(43,"div",29)(44,"a",30),m._uU(45),m.ALo(46,"mytranslate"),m.qZA(),m.TgZ(47,"button",31),m.NdJ("click",function(){return S.confirmAction()}),m._uU(48),m.ALo(49,"mytranslate"),m.qZA()()()()),2&y){let D,j,de,J;m.xp6(4),m.Oqu(m.lcZ(5,21,"lang_testbank_what_to_export_select_students_export")),m.xp6(8),m.Q6J("formGroup",S.form)("hidden",0===S.studentsInClassResults.length),m.xp6(1),m.Q6J("hidden",1===S.studentsInClassResults.length&&null==S.studentsInClassResults[0].classObj),m.xp6(2),m.hij(" ",m.lcZ(16,23,"lang_core_chon_lop_xuat_bai_lam_hoc_sinh"),": "),m.xp6(2),m.Q6J("ngIf",1===S.studentsInClassResults.length),m.xp6(1),m.Q6J("ngIf",S.studentsInClassResults.length>1),m.xp6(1),m.Q6J("hidden",0===(null==(D=S.form.get("listStudents"))?null:D.controls.length)),m.xp6(3),m.hij("",m.lcZ(23,25,"lang_core_chon_hoc_sinh_xuat_bai_lam"),":"),m.xp6(4),m.Q6J("checked",null==(j=S.form.get("selectAll"))?null:j.value),m.xp6(2),m.Oqu(m.lcZ(29,27,"lang_auto_chon_tat_ca")),m.xp6(3),m.Q6J("visibility","hover"),m.xp6(2),m.Q6J("ngForOf",null==(de=S.form.get("listStudents"))?null:de.controls),m.xp6(2),m.Q6J("ngIf",0===S.countStudentSelect),m.xp6(1),m.Q6J("ngIf",S.countStudentSelect>0),m.xp6(1),m.Q6J("hidden",(null==(J=S.form.get("listStudents"))?null:J.controls.length)>0),m.xp6(3),m.hij("* ",m.lcZ(41,29,"lang_auto_chua_co_thi_sinh_du_thi"),""),m.xp6(2),m.Q6J("ngIf",0===S.studentsInClassResults.length),m.xp6(3),m.hij(" ",m.lcZ(46,31,"lang_cms_common_close_btn")," "),m.xp6(2),m.Q6J("disabled",0===S.countStudentSelect),m.xp6(1),m.hij(" ",m.lcZ(49,33,"lang_cms_common_confirm_btn")," ")}},dependencies:[B.mk,B.sg,B.O5,h.ZT,le.gM,P.KC,L._Y,L.Fj,L.Wl,L._,L.JJ,L.JL,L.sg,L.u,L.CE,H.M,ce.L,ge.Q,Oe.z,B.i8,F.JV],styles:[".box[_ngcontent-%COMP%]{max-width:800px}.box-content[_ngcontent-%COMP%]{padding:10px}.box-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;border-radius:.375rem}.err-color[_ngcontent-%COMP%]{color:#f44336;font-size:small;font-weight:500}.note-color[_ngcontent-%COMP%]{font-size:small;font-weight:500}.truncate[_ngcontent-%COMP%]{display:inline-block;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;max-width:150px}.more-info-color[_ngcontent-%COMP%]{color:rgb(var(--color-primary));cursor:pointer}.text-only-class[_ngcontent-%COMP%]{color:#546e7a;margin-left:5px;font-weight:400}.box-students[_ngcontent-%COMP%]{height:15vh;overflow:hidden}.box-classrooms[_ngcontent-%COMP%]{height:10vh;overflow:hidden}.box-min-classrooms[_ngcontent-%COMP%]{height:45px}.box-max-classrooms[_ngcontent-%COMP%]{height:15vh;overflow:hidden}"]}),k})();var xt=w(86670),De=w(41003),wt=w(43216),Ae=w(78386),ne=w(8415),Y=w(58222),ae=w(87384),$=w(46825);let Se=(()=>{class k{parseEssayMarkResult(y,S){let D=y.filter(J=>this.answerTypeService.isEssayAnswer(J));if(0!=D.length&&S&&S.essayResult){var j=this.commonService.willDeleteParseJson(S.essayResult);if(j){var de=Object.entries(j);for(let J=0;J<D.length;J++)D[J].essayMarkParsed=de[J][1]}}}constructor(y,S){this.commonService=y,this.answerTypeService=S}}return k.\u0275fac=function(y){return new(y||k)(m.LFG(ae.z),m.LFG($.i))},k.\u0275prov=m.Yz7({token:k,factory:k.\u0275fac,providedIn:"root"}),k})(),ee=(()=>{class k{convertAnswersArr(y,S){0!=y.length&&y.forEach(D=>{D.QuestionId&&D.AnswerContent&&D.AnswerContent[0]&&D.AnswerContent[0].Content&&(S[`id_${D.QuestionId}`]=D.AnswerContent[0].Content)})}}return k.\u0275fac=function(y){return new(y||k)},k.\u0275prov=m.Yz7({token:k,factory:k.\u0275fac,providedIn:"root"}),k})();var Pe=w(66131),K=w(90467),q=w(71284),ie=w(67517),ye=w(32839);let ze=(()=>{class k{processHomeworks(y,S){return new Promise((D,j)=>{this.reset(),this.logger.start(this.commonService.myTranslateInstant("lang_cms_common_loading")),this.answerService.apiAnswerGetStudentsHomeworkGet(S).subscribe(de=>{1==de.success?(this.logger.remove(),this.dialog.open(Je,{width:"750px",restoreFocus:!1,data:{studentsInClassResults:[{classObj:de.data?.classroomObj,results:de.data?.studentObjs}],isAskInfo:!1}}).afterClosed().subscribe(J=>{if(J){this.logger.start(`${this.commonService.myTranslateInstant("lang_auto_chuan_bi_xuat_ket_qua_cho")} ${1===J.results.length?"":J.results.length} ${this.commonService.myTranslateInstant("lang_auto_hoc_sinh")}`);const me=new wt.O(!0);this.logger.pushChild(me),this.loadLibAction(me).then(()=>{this.logger.pushMsg(`${this.commonService.myTranslateInstant("lang_auto_dang_tao_tep_tin_ket_qua_bai_lam_cho")} ${1===J.results.length?"":J.results.length} ${this.commonService.myTranslateInstant("lang_auto_hoc_sinh")}`);const je=new wt.O(!0);this.logger.pushChild(je);const Ce=new u.Q(1,{function:(be,nt,Ve)=>{je.pushMsg(`${this.commonService.myTranslateInstant("lang_auto_tao_tep_tin_cho_hoc_sinh")} ${1===nt?"":"th\u1ee9 "+(be+1)} ${Ve?": "+Ve:""}`)}});J.results.forEach(be=>{const nt=new wt.O;je.pushChild(nt),Ce.addTask(this,this.makeFileHomework,[S,be,nt],be.fullName??"")}),Ce.start().then(be=>{je.remove(),0===be.errs.length?this.finishHomework(J.classObj.name??"",de.data?.homeworkObj?.name??"",be,D,j):(this.logger.remove(),this.dialog.open(fe,{data:{result:be},restoreFocus:!1}).afterClosed().subscribe(nt=>{nt&&(this.logger.start(`${this.commonService.myTranslateInstant("lang_testbank_export_pdf_by_user_processing")} ...`),this.finishHomework(J.classObj.name??"",de.data?.homeworkObj?.name??"",be,D,j))}))})}).catch(je=>{this.logger.remove(),j(je)})}})):(this.logger.remove(),j(new Error(this.commonService.myTranslateInstant(de.message))))})})}processClasses(y,S){return new Promise((D,j)=>{let de;switch(this.reset(),this.logger.start(this.commonService.myTranslateInstant("lang_cms_common_loading")),S){case"highest":de=this.testedListApiService.getTestedHighestMark("export_tool",y);break;case"first":de=this.testedListApiService.getTestedFirstMark("export_tool",y);break;default:de=this.testedListApiService.getTestedLastMark("export_tool",y)}de.subscribe(J=>{if(1==J.success){this.logger.remove();let me=!1;if(J.data?.questionObjs){let Ce=J.data?.questionObjs.filter(be=>this.answerTypeService.isEssayAnswer(be));Ce&&Ce.length&&(me=!0)}let je=J.data?.studentsInClassResults??[];J.data?.studentsNotInClassResults&&J.data?.studentsNotInClassResults?.length>0&&je.push({classObj:{name:this.commonService.myTranslateInstant("lang_auto_tu_do")??"",id:0,teacherId:0,countStudents:0,grade:0,showAddStudent:0},results:J.data.studentsNotInClassResults}),this.dialog.open(Je,{data:{studentsInClassResults:je,examHasEssay:me,isAskInfo:!0},restoreFocus:!1,width:"750px"}).afterClosed().subscribe(Ce=>{Ce?(this.expandInfoParse=this.commonService.castJsonToObj(J.data?.examObj?.expandInfo??"{}")??{},this.logger.start(`${this.commonService.myTranslateInstant("lang_auto_xuat_ket_qua_cho")} ${1===Ce.results?.length?"":Ce.results?.length} ${this.commonService.myTranslateInstant("lang_auto_hoc_sinh")}`),this.processConvertDataClassroom(y,Ce,Ce.classObj?.name??"",J.data?.examObj).then(()=>{this.logger.remove(),D()}).catch(nt=>{this.logger.remove(),j(nt)})):(this.logger.remove(),D())})}else this.logger.remove(),j(new Error(this.commonService.myTranslateInstant(J.message)??""))})})}processUser(y,S,D,j,de,J=!0,me,je){return new Promise((Ce,be)=>{this.reset(),de=de||this.logger,de?.start(`${this.commonService.myTranslateInstant("lang_auto_chuan_bi_xuat_ket_qua_cho")} ${this.commonService.myTranslateInstant("lang_auto_hoc_sinh")}`);const nt=new wt.O(!0);de?.pushChild(nt),this.loadLibAction(nt).then(()=>{de?.pushMsg(this.commonService.myTranslateInstant("lang_cms_common_loading")??""),this.examResultService.apiExamResultGetLastResultGet(y,D??"",j??"",S).subscribe(Ve=>{if(1==Ve.success){this.expandInfoParse=this.commonService.castJsonToObj(Ve.data?.examObj?.expandInfo??"{}")??{},de?.pushMsg(`${this.commonService.myTranslateInstant("lang_auto_dang")} ${this.commonService.myTranslateInstant("lang_auto_tao_tep_tin_cho_hoc_sinh")}`);let Ze=this.commonService.myTranslateInstant("lang_auto_tu_do")??"";const He=Ve.data?.studentObj;de?.pushMsg(`${this.commonService.myTranslateInstant("lang_auto_dang")} ${this.commonService.myTranslateInstant("lang_auto_tao_tep_tin_cho_hoc_sinh")} ${He?.fullName??""}`);let $e="";$e=Ve.data?.classroomObj?Ve.data?.classroomObj.name??Ze:Ze;const Kt=Ve.data?.examTracks,zt=Ve.data?.examObj,Rt=Ve.data?.examResultObj,ln=this.commonService.castJsonToClassObjs(xt.v,JSON.stringify(Ve.data?.questionObjs))??[];for(let Qt=0;Qt<ln.length;Qt++)ln[Qt].indexLabel=Qt+(zt?.startQuestionIndex??1),ln[Qt].correctAnswer=this.commonService.filterArray(Ve.data?.correctQuestionIds,ln[Qt].id);const ci={};let Ws=this.commonService.castJsonToObj(Ve.data?.examResultObj?.answers??"");this.exportPdfConvertDataService.convertAnswersArr(Ws??[],ci);const $i=new wt.O;de?.pushChild($i),this.processConvertDataUser($i,ln,He,Rt).then(Qt=>{Qt&&this.convertDataMarkNote(Qt?.resultTeacherDraw).then(Gs=>{this.loadTeacherDrawResult(Gs,de??new wt.O,He?.fullName??this.commonService.myTranslateInstant("lang_cms_test_offline_title")??"").then(gn=>{Qt=gn,$i.remove();const _n=new wt.O(!0,this.commonService.myTranslateInstant("lang_auto_dang_khoi_tao_file_word"));de?.pushChild(_n);let ki=[];ki.push({content:this.getLineInfoData($e,zt,Kt,Rt,He,ln,Qt,me,je).join("<br/>")+"<br/><br/><br/>",answers:[]}),ki=ki.concat(this.startGenUserLineFile(Rt,ln,Qt)),azotaDocx.exportToDocxBinary({questions:(0,De.JR)(ki),additionalParams:{isHeadless:!0}}).then(ns=>{const Ks=new Blob([ns],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});let is=this.commonService.createFileNameExportFile([He?.fullName??this.commonService.myTranslateInstant("lang_cms_test_offline_title")??"",Rt?.id?Rt.id.toString():""])+"_test_result";if(J)if(Qt.mediaAnswerWraps.concat(Qt.mediaWraps).length>0){const rs=new O;rs.file(is+".docx",Ks),Qt.mediaAnswerWraps.concat(Qt.mediaWraps).forEach(wi=>{const Js=new Blob([wi]);rs.file("attachments/"+wi.name,Js)}),rs.generateAsync({type:"blob"}).then(wi=>{let Js=this.commonService.createFileNameExportFile([$e,is])+"_attachments_exam_result.zip";this.shareFileFlutterService.shareFileWithBlob(wi,Js),de?.remove(),Ce()},wi=>{de?.remove(),Ce(wi)})}else this.shareFileFlutterService.shareFileWithBlob(Ks,is+".docx"),de?.remove(),Ce();else de?.remove(),Ce({name:is,blob:Ks,medias:Qt.mediaAnswerWraps.concat(Qt.mediaWraps)})})})})}).catch(Qt=>{de?.remove(),be(Qt)})}else de?.remove(),be(new Error(this.commonService.myTranslateInstant(Ve.message)))})}).catch(Ve=>{de?.remove(),be(Ve)})})}finishClassroom(y,S,D,j,de){if(D.length>1){const J=new O;D.forEach(me=>{me.medias.length>0?(J.file(me.name+"/"+me.name+".docx",me.blob),me.medias.forEach(je=>{const Ce=new Blob([je]);J.file(me.name+"/attachments/"+je.name,Ce)})):J.file(me.name+".docx",me.blob)}),J.generateAsync({type:"blob"}).then(me=>{let je=this.commonService.createFileNameExportFile([y,S])+"_exam_result.zip";this.shareFileFlutterService.shareFileWithBlob(me,je),j()},me=>{j(me)})}else if(D[0].medias.length>0){const J=new O;J.file(D[0].name+"/"+D[0].name+".docx",D[0].blob),D[0].medias.forEach(me=>{const je=new Blob([me]);J.file(D[0].name+"/attachments/"+me.name,je)}),J.generateAsync({type:"blob"}).then(me=>{let je=this.commonService.createFileNameExportFile([y,S])+"_attachments_exam_result.zip";this.shareFileFlutterService.shareFileWithBlob(me,je),j()},me=>{j(me)})}else this.shareFileFlutterService.shareFileWithBlob(D[0].blob,D[0].name+".docx"),j()}finishHomework(y,S,D,j,de){if(1===D.datas.length)if(D.datas[0].medias.length>0){const J=new O;J.file(D.datas[0].name+"/"+D.datas[0].name+".docx",D.datas[0].blob),D.datas[0].medias.forEach(me=>{const je=new Blob([me]);J.file(D.datas[0].name+"/attachments/"+me.name,je)}),J.generateAsync({type:"blob"}).then(me=>{let je=this.commonService.createFileNameExportFile([y,D.datas[0].name])+"_attachments_exam_result.zip";this.logger.remove(),this.shareFileFlutterService.shareFileWithBlob(me,je),j()},me=>{this.logger.remove(),j(me)})}else this.shareFileFlutterService.shareFileWithBlob(D.datas[0].blob,D.datas[0].name+".docx"),this.logger.remove(),j();else{this.logger.pushMsg(this.commonService.myTranslateInstant("lang_auto_dang_nen_zip_cac_bai_lam_cua_hoc_sinh")??"");const J=new O;D.datas.forEach(me=>{me.medias.length>0?(J.file("results/"+me.name+"/"+me.name+".docx",me.blob),me.medias.forEach(je=>{const Ce=new Blob([je]);J.file("results/"+me.name+"/attachments/"+je.name,Ce)})):J.file("results/"+me.name+".docx",me.blob)}),J.generateAsync({type:"blob"}).then(me=>{let je=this.commonService.createFileNameExportFile([y,S])+"_homework_result.zip";this.shareFileFlutterService.shareFileWithBlob(me,je),this.logger.remove(),j()},me=>{this.logger.remove(),de(me)})}}makeFileHomework(y,S,D){return new Promise((j,de)=>{D.start(this.commonService.myTranslateInstant("lang_cms_common_loading")??""),this.answerService.apiAnswerGetObjGet(y,S.answer?.id??0).subscribe(J=>{if(D.pushMsg(this.commonService.myTranslateInstant("lang_auto_dang_giai_nen_ket_qua_bai_lam")??""),this.zipDataService.convertSubmittedAnswersObj(J.data?.answerObj),J.data?.answerObj){D.pushMsg(this.commonService.myTranslateInstant("lang_auto_dang_khoi_tao_tep_tin")??"");let je=this.commonService.castJsonToObj(J.data.answerObj.result??"")??{};this.convertDataMarkNote(je).then(Ce=>{this.loadTeacherDrawResult(Ce,D,S.fullName??"").then(be=>{D.pushMsg(this.commonService.myTranslateInstant("lang_auto_dang_khoi_tao_tep_tin")??"");let nt=[];[`<b>${this.commonService.myTranslateInstant("lang_auto_ho_va_ten")}</b>: ${J.data?.studentObj?.fullName} <br/>`,`<b>${this.commonService.myTranslateInstant("lang_auto_lop_hoc")}</b>: ${J.data?.classroomObj?.name} <br/>`,`<b>${this.commonService.myTranslateInstant("lang_auto_bai_tap")}</b>: ${J.data?.homeworkObj?.name} <br/>`,`<b>${this.commonService.myTranslateInstant("lang_auto_ma_bai_lam")}</b>: ${J.data?.answerObj?.id} <br/>`].forEach(Ze=>{nt.push({content:Ze,answers:[]})});let Ve=this.commonService.castJsonToObj(J.data?.answerObj?.resultNote??"");if(Ve){const Ze=[{mark:1e3,lang:"lang_auto_dat"},{mark:1001,lang:"lang_auto_chua_dat"},{mark:2e3,lang:"lang_auto_hoan_thanh"},{mark:2001,lang:"lang_auto_chua_hoan_thanh"},{mark:3e3,lang:"lang_auto_hoan_thanh_tot"}],He=document.createElement("p");He.innerText=this.commonService.myTranslateInstant("lang_point")??"",He.setAttribute("docx-style",De.Ip.get("TB_RESULT_TXT"));const $e=document.createElement("p");let Kt=J.data?.answerObj?.point;Ze.forEach(ln=>{ln.mark===Kt&&(Kt=this.commonService.myTranslateInstant(ln.lang))}),$e.innerText=Kt?.toString()??"",$e.setAttribute("docx-style",De.Ip.get("TB_RESULT_POINT"));const zt=document.createElement("p");zt.setAttribute("docx-style",De.Ip.get("TB_RESULT_TXT")),zt.innerText=this.commonService.myTranslateInstant("lang_homework_homework_frontend_submit_homework_comment")??"";const Rt=document.createElement("span");Rt.setAttribute("docx-style",De.Ip.get("TB_RESULT_COMMENT")),0===Ve?.IsHideMark&&(Rt.innerText=this.getTextContentInTagHTML(Ve.Note),be.resultTeacherDraw?.commentEmoji&&(Rt.appendChild(document.createElement("br")),be.resultTeacherDraw.commentEmoji.forEach(ln=>{if(be.canvasList[ln]){const ci=new Image;ci.src=be.canvasList[ln].toDataURL(),ci.style.width=be.canvasList[ln].width/5+"px",ci.style.height=be.canvasList[ln].height/5+"px",Rt.appendChild(ci)}}))),nt.push({content:De.Ip.makeHeaderTable([He,$e],[zt,Rt]),answers:[]})}nt=nt.concat(this.getLineImageAnswer(be)),azotaDocx.exportToDocxBinary({questions:(0,De.JR)(nt),additionalParams:{isHeadless:!0}}).then(Ze=>{D.remove();const He=new Blob([Ze],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});let $e=`${this.commonService.convertVietnameseToEnglish(S.fullName??"")}_${J.data?.answerObj?.id??0}`;j({name:$e,blob:He,medias:be.mediaAnswerWraps.concat(be.mediaWraps)})})}).catch(be=>{D.remove(),de(be)})})}else D.remove(),de(new Error(this.commonService.myTranslateInstant("lang_auto_khong_tai_duoc_ket_qua_hoc_sinh")))})})}processConvertDataClassroom(y,S,D,j){return new Promise((de,J)=>{const me=new u.Q(1,{function:(Ce,be)=>{this.logger.pushMsg(`${this.commonService.myTranslateInstant("lang_auto_xuat_ket_qua_cho_hoc_sinh")}${1===be?"":` (${Ce+1}/${be})`}`),this.logger.percent=Ce/be}},1e3),je=[];S.results?.forEach(Ce=>{me.addTask(this,()=>new Promise((be,nt)=>{const Ve=new wt.O(!0,"");this.logger.pushChild(Ve),this.processUser(y,Number(Ce.resultId),Ce.userId,Ce.studentId?.toString(),Ve,!1,S.schoolName,S.subjectName).then(Ze=>{Ze?(Ve.remove(),je.push(Ze),be()):(Ve.remove(),nt(new Error))}).catch(Ze=>{Ve.remove(),nt(Ze)})}))}),me.start().then(Ce=>{Ce.errs.length>0?(this.logger.remove(),Ce.datas=je,this.dialog.open(fe,{data:{result:Ce},restoreFocus:!1}).afterClosed().subscribe(be=>{be&&(this.logger.start(`${this.commonService.myTranslateInstant("lang_testbank_export_pdf_by_user_processing")} ...`),this.finishClassroom(D,j?.name??"",je,de,J))})):this.finishClassroom(D,j?.name??"",je,de,J)})})}processConvertDataUser(y,S,D,j){return new Promise((de,J)=>{let me={canvasList:[],mediaWraps:[],mediaAnswerWraps:[],isExportAnsMedia:!0};y.start();const Ve=new u.Q(1,{function:(Ze,He,$e)=>{y.pushMsg(`${this.commonService.myTranslateInstant("lang_auto_tien_trinh")} ${Ze+1}/${He}: ${$e}`)}});Ve.addTask(this,()=>new Promise((Ze,He)=>{const $e=new wt.O(!0);y.pushChild($e),this.questionRenderService.parseRenderQuestions(S,Kt=>{$e.pushMsg(`${this.commonService.myTranslateInstant("lang_auto_tien_do_tai_du_lieu_cau_hoi")}: ${Math.floor(Kt)}%`)},void 0,50,!0).then(()=>{$e.remove(),Ze()}).catch(Kt=>{const zt=Rt=>{Object.prototype.hasOwnProperty.call(Rt,"type")&&"LOAD_IMAGE"===Rt.type?He(new Error(`${Rt.message} ${this.commonService.trimMidLimitLength(Rt.data[0],30)}`)):He(Kt)};$e.remove(),Array.isArray(Kt)?zt(Kt[0]):zt(Kt)})}),[],this.commonService.myTranslateInstant("lang_auto_tai_du_lieu_cau_hoi")),j&&j.result&&Ve.addTask(this,()=>new Promise((Ze,He)=>{this.loadTeacherDrawResult(this.commonService.castJsonToObj(j?.result??"")??{},y,D?.fullName??"").then($e=>{me=$e,Ze()}).catch($e=>{He($e)})}),[],this.commonService.myTranslateInstant("lang_auto_tai_du_lieu_cham_tu_luan_cua_giao_vien")),Ve.addTask(this,()=>new Promise((Ze,He)=>{D?this.loadNameImage(D).then($e=>{D=$e,Ze()}).catch($e=>{He($e)}):He(new Error)}),[],this.commonService.myTranslateInstant("lang_auto_tai_hinh_anh_ten_hoc_sinh")),me.isExportMedia&&Ve.addTask(this,()=>new Promise((Ze,He)=>{const $e=new wt.O(!0);y.pushChild($e);const Kt=new u.Q(3,{function:(zt,Rt)=>{$e.pushMsg(`${this.commonService.myTranslateInstant("lang_core_dang_tai_tep_tin")} (${zt}/${Rt})`)}},100);S.forEach(zt=>{zt.attachments&&zt.attachments.length>0&&zt.attachments.forEach(Rt=>{Kt.addTask(this,this.loadAztFile,[Rt,me,"att"])})}),Kt.start().then(zt=>{0===zt.errs.length?($e.remove(),Ze()):($e.remove(),He(zt.errs[0]))})}),[],this.commonService.myTranslateInstant("lang_core_dang_tai_tep_tin_dinh_kem")),Ve.start().then(Ze=>{y.remove(),0===Ze.errs.length?(this.exportPdfUtilsService.parseEssayMarkResult(S,j),de(me)):J(Ze.errs[0])})})}hasMultiple(y){let S=!1;for(let D=0;D<y.length;D++)if(this.answerTypeService.isOneChoiceAnswer(y[D])){S=!0;break}return S}hasEssay(y){let S=!1;for(let D=0;D<y.length;D++)if(this.answerTypeService.isEssayAnswer(y[D])){S=!0;break}return S}getLineInfoData(y,S,D,j,de,J,me,je,Ce){const be=[];be.push(De.Ip.makeHeaderTable([De.Ip.createLineCenterBold(je||`{ ${this.commonService.myTranslateInstant("lang_testbank_utils_footer_infomation_school")?.toUpperCase()} }`)],[De.Ip.createLineCenterBold(S?.name??"{"+this.commonService.myTranslateInstant("lang_notify_list_tested")?.toUpperCase()+"}"),De.Ip.createLineCenterBold(Ce||"{"+this.commonService.myTranslateInstant("lang_auto_mon_hoc")?.toUpperCase()+"}"),De.Ip.createLineCenterBold(S?.minutes&&S?.minutes>0?(this.commonService.myTranslateInstant("lang_auto_thoi_gian_lam_bai")??"")+": "+S?.minutes+" "+this.commonService.myTranslateInstant("lang_auto_minute")+" ("+this.commonService.myTranslateInstant("lang_core_khong_ke_thoi_gian_giao_de")+")":this.commonService.myTranslateInstant("lang_auto_thoi_gian_lam_bai")+": "+this.commonService.myTranslateInstant("lang_auto_khong_gioi_han"))]));const nt=J.filter(Ve=>this.answerTypeService.isEssayAnswer(Ve)).length;return de&&de.nameImages&&parseInt(de?.id??"0")<=0?be.push(`<b>${this.commonService.myTranslateInstant("lang_auto_thi_sinh")}</b>: <img src="${de?.nameImages.url}" />`):be.push(`<b>${this.commonService.myTranslateInstant("lang_auto_thi_sinh")}</b>: ${de?.fullName}`),be.push(`<b>${this.commonService.myTranslateInstant("lang_auto_lop")}</b>: ${y}`),S?.subjectMarks&&j?.subjectMarkValues&&j.subjectMarkValues.forEach((Ve,Ze)=>{be.push(`<b>${this.commonService.myTranslateInstant("lang_combine_exam_component")}${Ze+1} </b>: ${Ve}/10`)}),this.hasMultiple(J)&&be.push(`<b>${this.commonService.myTranslateInstant("lang_auto_trac_nghiem")}</b>: ${j?.trueFalseMark} (${j?.rightAnswer}/${(j?.totalQuestion??0)-nt} ${this.commonService.myTranslateInstant("lang_auto_cau_brackets")}`),this.hasEssay(J)&&be.push(`<b>${this.commonService.myTranslateInstant("lang_auto_tu_luan")}</b>: ${j?.essayMark+" ("+nt+" "+this.commonService.myTranslateInstant("lang_auto_cau_brackets")}`),this.hasEssay(J)&&me.resultTeacherDraw&&be.push(`<b>${this.commonService.myTranslateInstant("lang_auto_so_file_da_nop")}</b>: ${this.commonService.castJsonToObj(j?.files??"")?.length??"0"}`),D&&0!=S?.autoMonitor&&(be.push(`<b>${this.commonService.myTranslateInstant("lang_auto_so_lan_thoat_man_hinh")}</b>: ${D.exitFullScreen}`),be.push(`<b>${this.commonService.myTranslateInstant("lang_auto_so_lan_thoat_trinh_duyet")}</b>: ${D.blurWindow}`)),be.push(`<b>${this.commonService.myTranslateInstant("lang_auto_ma_bai_lam")}</b>: ${j?.id}`),be}startGenUserLineFile(y,S,D){let j=[];const de=this.commonService.castJsonToObj(y?.answers??"");return de&&S.forEach(J=>{J.attachments&&D.isExportMedia&&J.attachments.forEach(je=>{j.push({content:`[${this.commonService.myTranslateInstant("lang_core_dinh_kem_file_tai")} attachments/${je.name}]`,answers:[]})}),j=j.concat(this.genLineQuestion(J));const me=this.mapQuestResultObj(J,de??[]);switch(J.answerType){case 1:j=j.concat(this.genLineAnswerType1(J,me));break;case 3:j=j.concat(this.genLineAnswerType3(J,me));break;case 4:j=j.concat(this.genLineAnswerType4(J,me))}}),this.hasEssay(S)&&(j=j.concat(this.getLineImageAnswer(D))),j}genLineQuestion(y){const S=[];let j={content:"<b>"+(this.expandInfoParse.label??this.commonService.myTranslateInstant("lang_auto_cau"))+" "+(y.indexLabel??1)+".</b> "+(y.content?.includes("<img")?"<br>":"")+y.content,answers:this.convertAnswerQuestion(y.answers??[])};return S.push(j),S}mapQuestResultObj(y,S){return S.find(j=>j.QuestionId===y.id)||{QuestionId:y.id??0,AnswerContent:[]}}convertAnswerQuestion(y){let S=[];return y.forEach(D=>{S.push("<b>     "+(D.alpha?D.alpha:D.key)+".</b> "+D.content)}),S}genLineAnswerType1(y,S){const D=document.createElement("table"),j=y.correctAnswer?De.O8:De.Le;D.setAttribute("docx-style",De.Ip.get("TABLE"));const de=[],J=document.createElement("tr");D.appendChild(J);const me=document.createElement("td");me.setAttribute("docx-style",De.Ip.get("CORRECT",[{key:De.a3,value:j}]));const je=document.createElement("span"),Ce=y.answers?y.answers.filter(Ve=>y.answerResult?.includes(Ve.key)).map(Ve=>Ve.alpha??Ve.key).join(" & "):y.answerResult?.join(" & ");je.innerText=(this.commonService.myTranslateInstant("lang_auto_dap_an_dung")??"")+": "+Ce,je.setAttribute("color",j),me.appendChild(je),J.appendChild(me);const be=document.createElement("span"),nt=document.createElement("span");return be.innerText="\u2713",be.setAttribute("color",De.O8),nt.innerText="\u2717",nt.setAttribute("color",De.Le),y.answers?.forEach((Ve,Ze)=>{const He=document.createElement("td"),$e=document.createElement("span"),Kt=[{key:De.a3,value:j}];Kt.push({key:De.fI,value:Ze+1===y.answers?.length?j:"FFFFFF"}),He.setAttribute("docx-style",De.Ip.get("KEY_RESULT",Kt)),$e.innerText=Ve.alpha??Ve.key,S.AnswerContent.filter(Rt=>Rt.Content===Ve.key).length>0&&He.appendChild(y.correctAnswer?be:nt),He.appendChild($e),J.appendChild(He)}),de.push({content:`<br>${D.outerHTML}<br><br><br><br>`,answers:[]}),de}genLineAnswerType3(y,S){const D=[];return D.push({content:`<b>${this.capitalized(this.commonService.myTranslateInstant("lang_auto_cau_tra_loi"))}:</b><br/>`,answers:[]}),0===S.AnswerContent.length?D.push({content:`<span>${this.commonService.myTranslateInstant("lang_auto_thi_sinh_khong_nhap_thong_tin")}</span>`,answers:[]}):S.AnswerContent.forEach(j=>{D.push({content:`<span>${j.Content}</span>`,answers:[]})}),D.push({content:`<b>${this.commonService.myTranslateInstant("lang_auto_da_cham")}: ${y.essayMarkParsed} ${this.commonService.myTranslateInstant("lang_auto_diem_toi_da")}: ${y.scorePerQuestion})</b>`,answers:[]}),D}genLineAnswerType4(y,S){const D=document.createElement("table"),j=y.correctAnswer?De.O8:De.Le;D.setAttribute("docx-style",De.Ip.get("TABLE"));const de=[],J=document.createElement("tr");J.setAttribute("docx-style",De.Ip.get("TR")),D.appendChild(J);const me=document.createElement("td");me.setAttribute("docx-style",De.Ip.get("CORRECT",[{key:De.a3,value:j}]));const je=document.createElement("span");je.innerText=(this.commonService.myTranslateInstant("lang_auto_dap_an_dung")??"")+": ["+y.answerResult?.join(";")+"]",je.setAttribute("color",j),me.appendChild(je),J.appendChild(me),0===S.AnswerContent.length&&S.AnswerContent.push({Index:0,Content:this.commonService.myTranslateInstant("lang_auto_thi_sinh_khong_thong_tin")??""});const Ce=document.createElement("td"),be=document.createElement("span");return Ce.setAttribute("docx-style",De.Ip.get("FILL_RESULT",[{key:De.a3,value:j}])),be.innerText=S.AnswerContent.map(Ve=>Ve.Content).join(";"),Ce.appendChild(be),J.appendChild(Ce),de.push({content:`<br>${D.outerHTML}<br><br><br><br>`,answers:[]}),de}loadNameImage(y){return new Promise((S,D)=>{y&&y.nameImages&&parseInt(y?.id??"0")<=0?this.checkDrawImgNameService.getBase64Url(y.nameImages).then(j=>{j&&y.nameImages&&(y.nameImages.url=j),S(y)}).catch(j=>{D(j)}):S(y)})}loadScriptAction(y=0){return new Promise((S,D)=>{this.commonService.loadScriptPromises([{source:this.cdnService.registerJsCdn("min.azota_docx_script"),name:"min.azota_docx_script"}]).then(()=>{setTimeout(()=>{window.hasOwnProperty("azotaDocx")&&typeof azotaDocx<"u"&&azotaDocx&&S(),++y>3?D(new Error(this.commonService.myTranslateInstant("lang_auto_tai_thu_vien_that_bao_vui_long_load_lai_trang_de_thu_lai"))):this.loadScriptAction(y)},500)}).catch(j=>{D(j)})})}loadCssFrameAction(){return new Promise(y=>{const S=document.createElement("div"),D=j=>{const de=document.createElement("span");return de.style.fontFamily=j,de.innerText="Aa",de};S.appendChild(D("font_chu_dep")),S.appendChild(D("font_chu_dep_z")),S.appendChild(D("font_chu_in")),S.appendChild(D("font_chu_in_nghieng")),S.appendChild(D("font_chu_in_dam")),S.style.opacity="0",document.body.appendChild(S),setTimeout(()=>{S.remove(),y()},2e3)})}loadLibAction(y){return new Promise((S,D)=>{const j=new u.Q(1,{function:(de,J,me)=>{y.pushMsg(`${this.commonService.myTranslateInstant("lang_auto_tien_trinh")} ${de+1}/${J}: ${me}`)}});j.addTask(this,this.loadScriptAction,[],this.commonService.myTranslateInstant("lang_auto_tai_thu_vien")),j.addTask(this,this.loadCssFrameAction,[],this.commonService.myTranslateInstant("lang_auto_tai_tai_nguyen")),j.start().then(de=>{y.remove(),de.errs.length>0?D(de.errs[0]):S()})})}reset(){}checkUrlIsImage(y){return null!=y.match(/\.(jpeg|jpg|png|gif)$/)}loadAztFile(y,S,D){return new Promise((j,de)=>{fetch(this.cdnService.getRawCdnLink(y.url??"")).then(J=>{J.ok?J.blob().then(me=>{const Ce=new File([me],y.name??"",{type:y.mimes});"ans"===D?S.isExportAnsMedia&&S.mediaAnswerWraps.push(Ce):S.isExportMedia&&S.mediaWraps.push(Ce),j()}):de(new Error(`${this.commonService.myTranslateInstant("lang_core_khong_the_tai_tep_tin_dinh_kem")} ${y.name}`))}).catch(()=>{de(new Error(`${this.commonService.myTranslateInstant("lang_core_khong_the_tai_tep_tin_dinh_kem")} ${y.name}`))})})}wrapLoadMedia(y,S){return this.checkUrlIsImage(y)?(0,g.dr)(y,S):new Promise((D,j)=>{D(void 0)})}replaceImageToBase64(y,S,D,j,de,J){return new Promise((me,je)=>{Object.prototype.hasOwnProperty.call(y,S)&&"string"==typeof y[S]?this.wrapLoadMedia(y[S],de).then(Ce=>{if(Ce){const be=document.createElement("canvas");be.width=Ce.width,be.height=Ce.height,be.getContext("2d")?.drawImage(Ce,0,0),y[S]=D.canvasList.push(be)-1,me()}else{J=J?J+1:1;let be=y[S].split(".");be=be.length>0?be[be.length-1]:"mp3";const nt=this.commonService.createFileNameExportFile([this.commonService.myTranslateInstant("lang_core_file_dinh_kem_o_vi_tri")??"",J.toString(),j])+"."+be;this.loadAztFile({name:this.commonService.replaceAll(nt,"_"," ")??"",url:y[S],path:"",extension:"",mimes:"",size:"0"},D,"ans").then(()=>{me()}).catch(Ve=>{je(new Error(this.commonService.myTranslateInstant(Ve.message)+(j.length>0?" : "+j:"")))})}}).catch(Ce=>{je(new Error(this.commonService.myTranslateInstant(Ce.message)+(j.length>0?" : "+j:"")))}):je(new Error(this.commonService.myTranslateInstant("lang_auto_tai_hinh_anh_khong_thanh_cong")+(j.length>0?" : "+j:"")))})}loadTeacherDrawResult(y,S,D){return new Promise((j,de)=>{const J={canvasList:[],mediaWraps:[],mediaAnswerWraps:[],isExportAnsMedia:!0},me=new u.Q(3,{function:(je,Ce)=>{S.pushMsg(`${this.commonService.myTranslateInstant("lang_auto_dang_xu_ly_hinh_anh")} (${je+1}/${Ce})`)}});if(J.resultTeacherDraw=y,J.resultTeacherDraw){J.resultTeacherDraw.pages?.forEach((Ce,be)=>{me.addTask(this,this.replaceImageToBase64,[Ce,"backgroundImage",J,D,this.cdnService,be]),Ce.draw&&me.addTask(this,this.replaceImageToBase64,[Ce,"draw",J,D,this.cdnService,be])});const je=this.commonService.castJsonToObj(J.resultTeacherDraw.staticTextConfig??"");if(J.resultTeacherConfig=je,J.resultTeacherConfig&&J.resultTeacherConfig.urlImgCorrect&&J.resultTeacherConfig.urlImgWrong&&(J.resultTeacherConfig.urlImgCorrect=(J.resultTeacherConfig.type?"":"assets/images/classlive/")+J.resultTeacherConfig.urlImgCorrect,J.resultTeacherConfig.urlImgWrong=(J.resultTeacherConfig.type?"":"assets/images/classlive/")+J.resultTeacherConfig.urlImgWrong,me.addTask(this,this.replaceImageToBase64,[J.resultTeacherConfig,"urlImgCorrect",J,D]),me.addTask(this,this.replaceImageToBase64,[J.resultTeacherConfig,"urlImgWrong",J,D])),J.resultTeacherDraw.commentEmoji&&J.resultTeacherDraw.commentEmoji.length>0)for(let Ce=0;Ce<J.resultTeacherDraw.commentEmoji.length;Ce++)J.resultTeacherDraw.commentEmoji[Ce]="https://azota889.github.io/storage_public/mnote/"+J.resultTeacherDraw.commentEmoji[Ce],me.addTask(this,this.replaceImageToBase64,[J.resultTeacherDraw.commentEmoji,Ce,J,D])}me.start().then(je=>{0===je.errs.length?j(J):de(je.errs[0])})})}capitalized(y){return y?y.charAt(0).toUpperCase()+y.slice(1):""}wrapText(y,S,D,j,de,J){const me=document.createElement("span");me.innerHTML=this.commonService.removeXssInHtml(S),(S=me.innerText.replace(/<div>/g,"\n").replace(/<\/div>/g,"").replace(/_divbrdiv_/g,"\n").replace(/_divdiv_/g,"")).split("\n").forEach(Ce=>{for(var be=Ce.split(" "),nt="",Ve=0;Ve<be.length;Ve++){var Ze=nt+be[Ve]+" ";y.measureText(Ze).width>de&&Ve>0?(y.fillText(nt,D,j),nt=be[Ve]+" ",j+=J):nt=Ze}y.fillText(nt,D,j)})}getLineImageAnswer(y){const S=[];return y.mediaAnswerWraps&&y.isExportAnsMedia&&y.mediaAnswerWraps.forEach(D=>{S.push({content:`<span color="2196f3">{${this.commonService.myTranslateInstant("lang_core_dinh_kem_file_tai")} attachments/${D.name}}</span>`,answers:[]})}),y.resultTeacherDraw&&y.resultTeacherDraw.pages?.forEach(D=>{let j=y.canvasList[Number(D.backgroundImage)];if(j){const de=document.createElement("canvas");de.width=D.width??1,de.height=D.height??1;const J=de.getContext("2d");if(J){J.fillStyle="#FFFFFF",J.fillRect(0,0,de.width,de.height);let Ce=document.createElement("canvas"),be=Ce.getContext("2d");0!==D.rotation&&be?(90===Math.abs(D.rotation??0)?(Ce.width=j.height,Ce.height=j.width):(Ce.width=j.width,Ce.height=j.height),be.translate(Ce.width/2,Ce.height/2),be.rotate(((D.rotation??0)>0?1:-1)*(D.rotation??0)*Math.PI/180),be.drawImage(j,-j.width/2,-j.height/2),be.restore()):Ce=j;const nt=de.height/Ce.height*Ce.width;if(J.drawImage(Ce,0,0,Ce.width,Ce.height,(de.width-nt)/2,0,nt,de.height/Ce.height*Ce.height),D.draw){const He=y.canvasList[Number(D.draw)];He&&J.drawImage(He,0,0)}if(D.staticText&&D.staticText.length>0&&D.staticText.forEach(He=>{if(J.font=`${y.resultTeacherConfig?.fontSize}px ${y.resultTeacherConfig?.fontText}`,J.fillStyle=y.resultTeacherConfig?.fontColor??"#000000",y.resultTeacherConfig?.useCorrectText&&"correct"==He.value&&this.wrapText(J,y.resultTeacherConfig?.textCorrect??"",He.x,He.y,de.width-He.x,25),y.resultTeacherConfig?.useCorrectText&&"wrong"==He.value&&this.wrapText(J,y.resultTeacherConfig?.textWrong??"",He.x,He.y,de.width-He.x,25),!y.resultTeacherConfig?.useCorrectText&&"correct"==He.value){const $e=y.canvasList[Number(y.resultTeacherConfig?.urlImgCorrect)];$e&&J.drawImage($e,0,0,$e.width,$e.height,He.x,He.y,30,30)}if(!y.resultTeacherConfig?.useWrongText&&"wrong"==He.value){const $e=y.canvasList[Number(y.resultTeacherConfig?.urlImgWrong)];$e&&J.drawImage($e,0,0,$e.width,$e.height,He.x,He.y,30,30)}}),D.objText&&D.objText.length>0){let He=300;D.objText.forEach($e=>{J.font=`${parseFloat($e.textStyle.size)}px ${$e.textStyle.font}`,J.fillStyle=$e.textStyle.color,J.textAlign=$e.textStyle.align??"center",J.lineWidth=$e.textStyle.width??He,this.wrapText(J,$e.value,$e.x,$e.y,de.width-$e.x,25)})}}const me=693,je=me/de.width;S.push({content:`<img src="${de.toDataURL()}" style="width:${me}px;height:${de.height*je}px" /><br/>`,answers:[]})}}),0===S.length?S.push({content:`<br/><br/>${De.Ip.createLineCenterBold(this.commonService.myTranslateInstant("lang_auto_khong_co_anh_bai_lam_tu_luan")??"").outerHTML}<br/><br/>`,answers:[]}):S.unshift({content:`<br/>${De.Ip.createLineCenterBold(this.commonService.myTranslateInstant("lang_auto_anh_bai_lam_tu_luan")??"").outerHTML}<br/>`,answers:[]}),S}convertDataMarkNote(y){return new Promise((S,D)=>{y&&y.urlDataMark?this.cdnService.loadTextCdn(y.urlDataMark).subscribe(j=>{const de=this.zipDataService.decodeContentGzip(j),J=this.commonService.castJsonToObj(de);y.pages=[];let me={};J?.pages.forEach((be,nt)=>{let Ve={width:be.width,height:be.height,draw:be.draws?.[0]?.src??void 0,backgroundImage:be.backgroundSrc,rotation:be.backgroundRotate,objText:[],staticText:[]};be.childData?.length&&be.childData.forEach((Ze,He)=>{if("UIQuickMark"==Ze.className&&(Ve.staticText?.push({x:Ze.x+5,y:Ze.y+(Ze.height+5+Ze.fontSize)/2,value:"type_right"===Ze.type?"correct":"wrong"}),0===He&&(me={txtCommentFont:Ze.fontFace?.family??"font_chu_dep",useCorrectText:!0,useWrongText:!0,correctWidth:Ze.width,correctHeight:Ze.height,wrongWidth:Ze.width,wrongHeight:Ze.height,fontText:Ze.fontFace?.family??"font_chu_dep",fontColor:"red",fontSize:Ze.fontSize??30,textWrong:"s",textCorrect:"\u0111",type:"v2"})),!me.urlImgWrong&&"type_wrong"==Ze.type&&(me.urlImgWrong=Ze.imageSrc),!me.urlImgCorrect&&"type_right"==Ze.type&&(me.urlImgCorrect=Ze.imageSrc),!me.textWrong&&"type_wrong"==Ze.type&&(me.textWrong=Ze.textContent),!me.textCorrect&&"type_right"==Ze.type&&(me.textCorrect=Ze.textContent),me.useCorrectText=!me.urlImgCorrect,me.useWrongText=!me.urlImgWrong,"UIText"===Ze.className){let $e=this.getStyleContent(Ze.textContent);Ve.objText?.push({x:Ze.x+15,y:Ze.y+15,value:Ze.textContent,textStyle:{size:Ze.fontSize?Ze.fontSize:$e?.fontSize,align:$e?.textAlign??"left",color:$e?.color,fill:!0,font:$e?.fontFamily}})}}),y.pages?.push(Ve)}),y.staticTextConfig=this.commonService.serializeJson(me),S(y)}):S(y??{})})}getStyleContent(y){let S=document.createElement("div");S.innerHTML=y;let D=S.querySelector("p"),j=S.querySelector("span");return j?{fontSize:j.style.fontSize,color:j.style.color,fontFamily:j.style.fontFamily,textAlign:D?.style.textAlign??"left"}:void 0}getTextContentInTagHTML(y){return(new DOMParser).parseFromString(y,"text/html").body.textContent??y}constructor(y,S,D,j,de,J,me,je,Ce,be,nt,Ve,Ze){this.dialog=y,this.checkDrawImgNameService=S,this.cdnService=D,this.zipDataService=j,this.exportPdfUtilsService=de,this.answerTypeService=J,this.exportPdfConvertDataService=me,this.questionRenderService=je,this.commonService=Ce,this.answerService=be,this.examResultService=nt,this.testedListApiService=Ve,this.shareFileFlutterService=Ze,this.logger=new wt.O,this.expandInfoParse={}}get percent(){return this.logger.percent}get keyLoading(){return this.logger.lines}get isLoading(){return this.logger.run??!1}}return k.\u0275fac=function(y){return new(y||k)(m.LFG(h.uw),m.LFG(Ae.o),m.LFG(ne.E),m.LFG(Y.a),m.LFG(Se),m.LFG($.i),m.LFG(ee),m.LFG(Pe.h),m.LFG(ae.z),m.LFG(K.P6),m.LFG(q.kS),m.LFG(ie.X),m.LFG(ye.g))},k.\u0275prov=m.Yz7({token:k,factory:k.\u0275fac,providedIn:"root"}),k})()},43216:(at,ue,w)=>{"use strict";w.d(ue,{O:()=>O});class O{pushChild(g){this.child.push(g)}pushMsg(g){this.msg=g}start(g){this.run=!0,g&&(this.msg=g)}remove(){this.run=!1,this.msg="",this.child=[],this.percent=void 0}get lines(){const g=[];return this.msg&&""!==this.msg&&g.push(this.msg),`<p>${g.concat(this.lineChild).join("</p><p>")}</p>`}get lineChild(){let g=[];return this.child.filter(h=>h.run).forEach(h=>{g=g.concat(h.lines)}),g}constructor(g=!1,h="",_){this.run=g,this.msg=h,this.percent=_,this.child=[]}}},4779:(at,ue,w)=>{"use strict";w.d(ue,{K:()=>m});var O=w(65879),u=w(87384),g=w(50626),h=w(31518),_=w(46825);let m=(()=>{class B{_saveSortTypeOfSetting(F){this.browserStorageService.saveSimpleStorage(this.sortByStorageKey,F)}_removeSortTypeOfSetting(){this.browserStorageService.removeSimpleStorage(this.sortByStorageKey)}_getSortTypeOfSetting(F){return this.browserStorageService.getSimpleStorage(this.sortByStorageKey)==F}_getCurrentSortTypeOfSetting(){return this._getSortTypeOfSetting("isSortByNameAsc")?"isSortByNameAsc":this._getSortTypeOfSetting("isSortByMarkDesc")?"isSortByMarkDesc":this._getSortTypeOfSetting("isSortByTimeDesc")?"isSortByTimeDesc":void 0}_filterExamResultObjsByFilterSettingObjByClassroom(F,E){var R=[];return E.forEach(A=>{A.results=this._filterExamResultObjsByFilterSettingObjNotInClassroom(F,A.results??new Array),R.push(A)}),R}_filterExamResultObjsByFilterSettingObjNotInClassroom(F,E){var R=[];if(F.isMarked||F.isNotMarked||F.isOnTest||F.isNotSubmit||F.isNotTested)for(var A of E){let fe=!1,L=F.isOnTest||F.isNotSubmit;F.isMarked&&1==A.isMarked&&(!L||!(1!=A.status&&(A.isMarked||A.isNotMarked)))&&(fe=!0),F.isNotMarked&&1==A.isNotMarked&&(!L||!(1!=A.status&&(A.isMarked||A.isNotMarked)))&&(fe=!0),F.isOnTest&&(1==A.isOnTest||0==A.status&&(A.isMarked||A.isNotMarked))&&(fe=!0),F.isNotTested&&1==A.isNotTested&&(fe=!0),F.isNotSubmit&&(1==A.isNotSubmit||-1==A.status&&(A.isMarked||A.isNotMarked))&&(fe=!0),fe&&R.push(A)}else R=E;return R}_searchExamResultObjsByFullNameInClassroom(F,E){var R=[];return this.commonService.myClone(F).forEach(fe=>{var L=this._searchExamResultObjsByFullNameNotInClassroom(fe.results??[],E);L.length>0&&(fe.results=L,R.push(fe))}),R}_searchExamResultObjsByFullNameNotInClassroom(F,E){E=this.commonService.convertVietnameseToEnglish(E).toLowerCase();var R=[];return F.forEach(A=>{-1!=this.commonService.convertVietnameseToEnglish(A.fullName??"").toLowerCase().indexOf(E)&&R.push(A)}),R}_sortExamResultObjsBySettingObjByClassroom(F,E,R){return"isSortByNameAsc"==R?this.sortService.sortFirstNameStudentsInClass(F):"isSortByTimeDesc"==R?this.sortService.sortTimeStudentsInClass(F,1):"isSortByMarkDesc"==R?this.sortService.sortMarkStudentsInClass(F,1,E):this._sortExamResultObjsBySortTypeOfClassroom(F)}_sortExamResultObjsBySettingObjNotInClassroom(F,E,R){return"isSortByNameAsc"==R?this.sortService.sortFirstNameStudents(F):"isSortByTimeDesc"==R?this.sortService.sortTimeDESC(F):"isSortByMarkDesc"==R?this.sortService.sortMarkDESC(F,E):F}_sortExamResultObjsBySortTypeOfClassroom(F){var E=this.commonService.myClone(F);return E.forEach((R,A)=>{R.results=0==R.classObj?.sortType?this.sortService.sortFirstNameStudents(R.results??[]):this.sortService.sortArrayByMultipleObjectKeyAsc(R.results??[],"pos","id"),E[A]=R}),E}_changeExamResultStatusForAllClassroom(F,E,R){var A=[];return F.forEach((fe,L)=>{fe.results=this._changeExamResultStatusForOneClassroom(fe.results??new Array,E),fe={indexCounter:L,...fe,countSubmitted:R?fe.classObj?.countSubmitted:this._countTotalSubmittedOfExamResultObjs(fe.results??new Array)},A.push(fe)}),A}_changeExamResultStatusForOneClassroom(F,E){var R=[...F];return R.forEach((A,fe)=>{A.confirmedAt&&""!=A.confirmedAt&&A.resultId&&A.resultId>0?A.isMarked=!0:A.resultId&&A.resultId>0&&(!A.confirmedAt||""==A.confirmedAt)?A.isNotMarked=!0:A.resultId&&0!=A.resultId||!A.startedTest||""==A.startedTest||0!=A.status?A.resultId&&0!=A.resultId||!A.startedTest||""==A.startedTest||-1!=A.status?null==A.startedTest&&(A.isNotTested=!0):A.isNotSubmit=!0:A.isOnTest=!0,R[fe]=A}),R.forEach((A,fe)=>{A.files&&""!=A.files&&!Array.isArray(A.files)&&(A.filesParse=this.commonService.myParseJson(A.files)),R[fe]=A}),R}_countTotalSubmittedOfExamResultObjs(F){var E=0;return F.forEach(R=>{(R.isMarked||R.isNotMarked)&&E++}),E}_counterTotalEssayOfQuestionObjs(F){let E=0;return F.forEach(R=>{this.answerTypeService.isEssayAnswer(R)&&E++}),E}_checkCounterEssayQuestionObjs(F){let E=0;return F.forEach(R=>{R.isEssay&&E++}),E}constructor(F,E,R,A){this.commonService=F,this.sortService=E,this.browserStorageService=R,this.answerTypeService=A,this.sortByStorageKey="exam_list_sort_by"}}return B.\u0275fac=function(F){return new(F||B)(O.LFG(u.z),O.LFG(g.V),O.LFG(h.n),O.LFG(_.i))},B.\u0275prov=O.Yz7({token:B,factory:B.\u0275fac,providedIn:"root"}),B})()},67517:(at,ue,w)=>{"use strict";w.d(ue,{X:()=>R});var O=w(65592),u=w(65879),g=w(87384),h=w(71284),_=w(94281),m=w(38474),B=w(31518),W=w(51026),F=w(67854),E=w(4779);let R=(()=>{class A{constructor(L,U,Z,le,P,H,ce,ge){this.commonService=L,this.examPageResultService=U,this.permissionService=Z,this.globalService=le,this.browserStorageService=P,this.gzipHelper=H,this.homeworkExamService=ce,this.sAztExamResultListSortService=ge}getTestedUserObjs(L,U,Z){return this.globalService.startIntervalFunc(L),this.getTestedOfExamResult(L,U,"default",Z)}getTestedLastMark(L,U,Z){return this.globalService.startIntervalFunc(L),this.getTestedOfExamResult(L,U,"last",void 0,Z)}getTestedHighestMark(L,U,Z){return this.globalService.startIntervalFunc(L),this.getTestedOfExamResult(L,U,"highest",void 0,Z)}getTestedFirstMark(L,U,Z){return this.globalService.startIntervalFunc(L),this.getTestedOfExamResult(L,U,"first",void 0,Z)}getTestedAllResult(L,U,Z){return this.globalService.startIntervalFunc(L),this.getTestedOfExamResult(L,U,"all",void 0,Z)}getTestedOfExamResult(L,U,Z,le,P){return new O.y(H=>{let ce="tested_list_result_v2_"+U,ge=this.browserStorageService.getSimpleSessionStorage(ce)??"",Oe=this.gzipHelper.resultContentSupport(ge),qe=Oe&&this.commonService.willDeleteParseJson(Oe)?this.commonService.willDeleteParseJson(Oe):void 0;le&&ge&&qe?(H.next({status:200,success:1,data:qe,message:"successful"}),H.complete()):this.examPageResultService.apiExamPageResultGetObjV2Get(U).subscribe(Me=>{if(1==Me.success){let Fe=Me.data?.serverSecond??0,ht=Me.data?.examObj,we=Me.data?.classroomWithAvatarAndStudentObjs??new Array,Ne=Me.data?.totalAttended??0,X=Me.data?.examQuestionObjs??new Array,Be=Me.data?.examCreatorObj,V=Me.data?.offlineExamObj,oe=Me.data?.hasEssayQuestion,pe=Me.data?.totalQuestion??0,Ue=Me.data?.offlineMixQuestionObjs,rt=Me.data?.canResetStudentCode,Je=Me.data?.hasCreateStudentCode,xt=Me.data?.fileTypeStr??"";this.permissionService.hasViewExamPermission("exam",ht)||this.permissionService.hasConfigAndMarkClassroomPermission("exam",ht)?this.getAllExamResultObjs(L,[],U,"",De=>{if(De.hasOwnProperty("success")&&1==De.success){let wt=this.mergeStudentWithAvatar(De.studentWithResultObjs??[]),Ae={},ne=[];wt?.forEach(q=>{let ie=q.parentId??"0";Ae.hasOwnProperty(ie)?Ae[ie].push(...q.examResultObjs??[]):Ae[ie]=q.examResultObjs??[],ne=ne.concat(Ae[ie])});let Y=ht?this.filterExamResultOnTest(ne,ht,Fe):{},ae=[],$=[];if(this.homeworkExamService.mustInClassroom(ht)&&we.length>0)for(let q=0;q<we.length;q++){let ie=we[q].classroomObj,ye=we[q].studentObjs??[],ze=[];if(ye.length>0)for(let k=0;k<ye.length;k++){let Re=ye[k].parentId??"0";this.commonService.filterArray($,ye[k].parentId)||$.push(ye[k].parentId??"0"),Ae.hasOwnProperty(Re)&&(Array.isArray(ye[k].examResultObjs)||(ye[k].examResultObjs=[]),ye[k].examResultObjs=this.findExamResultOfStudent(Ae[Re],ye[k].id??"0"));let y=Y.hasOwnProperty(ye[k].parentId??0)?Y[ye[k].parentId??0]:0;if("all"==Z)if(ye[k].examResultObjs?.length)ye[k].examResultObjs?.forEach((S,D)=>{let j=this.commonService.castJsonToObj(JSON.stringify(S));j&&(j.resultId=j.testStatus&&j.testStatus>0?j.id:0);let de=this.createStudentWithResult(ye[k],j,y,pe,D,ye[k].examResultObjs?.length??0);ze.push(de)});else{let S=this.createStudentWithResult(ye[k],void 0,y,pe,-1,0);ze.push(S)}else{let S=this.filterExamResultByType(ye[k].examResultObjs??[],Z),D=S.hasOwnProperty(ye[k].parentId??0)?S[ye[k].parentId??0]:void 0,de=this.createStudentWithResult(ye[k],D,y,pe,(D&&null!=D.indexTest&&D.indexTest>=0?D.indexTest:"first"==Z?0:(ye[k].examResultObjs?.length??0)-1)??0,ye[k].examResultObjs?.length??0);ze.push(de)}}ae.push({classObj:ie,results:ze})}let Se=[],ee=this.commonService.myClone(wt)??[];for(let q=0;q<ee?.length;q++)if(!this.commonService.filterArray($,ee[q].parentId)){let ie=Y.hasOwnProperty(ee[q].parentId??0)?Y[ee[q].parentId??0]:0;if("all"==Z)if(ee[q].examResultObjs?.length)ee[q].examResultObjs?.forEach((ye,ze)=>{let k=this.commonService.castJsonToObj(JSON.stringify(ye));k&&(k.resultId=k.testStatus&&k.testStatus>0?k.id:0);let Re=this.createStudentWithResult(ee[q],k,ie,pe,ze,ee[q].examResultObjs?.length??0);Se.push(Re)});else{let ye=this.createStudentWithResult(ee[q],void 0,ie,pe,-1,0);Se.push(ye)}else{let ye=this.filterExamResultByType(ee[q].examResultObjs??[],Z),ze=ye.hasOwnProperty(ee[q].parentId??0)?ye[ee[q].parentId??0]:void 0,Re=this.createStudentWithResult(ee[q],ze,ie,pe,(ze&&null!=ze?.indexTest&&ze.indexTest>=0?ze.indexTest:"first"==Z?0:(ee[q].examResultObjs?.length??0)-1)??0,ee[q].examResultObjs?.length??0);Se.push(Re)}}"all"!=Z&&Se.sort((q,ie)=>this.compareTwoDate(q.createdAt??"",ie.createdAt??""));let Pe=0;(ae.length||Se.length)&&(ae.forEach(q=>{q.results?.forEach(ie=>{let ye=this.getMaxGroupId(ie.groupPoints??[]);Pe<ye&&(Pe=ye)})}),Se.forEach(q=>{let ie=this.getMaxGroupId(q.groupPoints??[]);Pe<ie&&(Pe=ie)})),"export_tool"==L&&P?.length&&(ae=ae.filter(q=>this.commonService.filterArray(P,q.classObj?.id)),this.commonService.filterArray(P,-1)||(Se=[]));let K={studentsInClassResults:ae.length>0?ae:[],studentsNotInClassResults:Se.length>0?Se:[],totalAttended:Ne,totalQuestion:pe,totalUsers:0,examCreatorObj:Be,offlineMixQuestionObjs:Ue,examObj:ht,hasEssayQuestion:oe,offlineExamObj:V,canResetStudentCode:rt,hasCreateStudentCode:Je,questionObjs:X,fileTypeStr:xt,errorConfigClassroomPermission:Me.data?.errorConfigClassroomPermission,errorMessage:Me.data?.errorMessage,maxGroupId:Pe};if("export_tool"!=L){let q=this.gzipHelper.zipBigContent(JSON.stringify(K));this.browserStorageService.saveSimpleSessionStorage(ce,q)}H.next({status:200,success:1,data:K,message:"successful"}),H.complete()}else H.next({status:De.code,success:0,data:null,message:De.message??""}),H.complete()}):(H.next({status:200,success:1,data:{studentsInClassResults:[],studentsNotInClassResults:[],totalAttended:Ne,totalQuestion:pe,hasEssayQuestion:oe,totalUsers:0,examCreatorObj:Be,offlineMixQuestionObjs:Ue,examObj:ht,offlineExamObj:V,canResetStudentCode:rt,hasCreateStudentCode:Je,questionObjs:X,fileTypeStr:Me.data?.fileTypeStr,errorConfigClassroomPermission:Me.data?.errorConfigClassroomPermission,errorMessage:Me.data?.errorMessage,maxGroupId:0},message:"successful"}),H.complete())}else H.next({status:Me.code,success:0,data:null,message:Me.message??""}),H.complete()})})}getAllExamResultObjs(L,U,Z,le,P){this.examPageResultService.apiExamPageResultGetObjsV2Get(Z,"test_review"==L||"export_tool"==L?"export":"tested_list",le).subscribe(ce=>{1==ce.success?(ce.data?.objs&&U.push(...ce.data.objs),ce.data?.nextPage?this.globalService.isStopIntervalFunc(L)?P({studentWithResultObjs:U,success:1}):setTimeout(()=>{this.getAllExamResultObjs(L,U,Z,ce.data?.nextPage??"",P)},300):P({studentWithResultObjs:U,success:1})):P({code:ce.code,studentWithResultObjs:[],success:0,message:ce.message??""})})}compareTwoDate(L,U){var Z=new Date(L).getTime();Z=isNaN(Z)?0:Z;var le=new Date(U).getTime();return Z-(le=isNaN(le)?0:le)>0?1:Z-le<0?-1:0}filterExamResultOnTest(L,U,Z){var le={};return L.forEach(P=>{var H=this.commonService.myClone(P)??{};if(H.testStatus)le[H.userId??0]=H.testStatus;else if(H.startedTest&&Z)if(U.endTime){var ce=Math.floor(new Date(U.endTime).getTime()/1e3);le[H.userId??0]=Z<=ce+60*(U.minutes??0)+600?0:-1}else{var ge=H.startedTest?Math.floor(new Date(H.startedTest).getTime()/1e3):0;le[H.userId??0]=Z<=ge+86400?0:-1}else le[H.userId??0]=0}),le}filterExamResultByType(L,U){var Z={};if(L.length>1)L.forEach((P,H)=>{var ce=this.commonService.myClone(P);P.testStatus&&(ce.resultId=ce.id,ce.indexTest=H,"default"==U&&(Z[ce.userId??0]=ce),"last"==U&&(Z[ce.userId??0]=ce),"first"==U&&(Z.hasOwnProperty(ce.userId??0)||(Z[ce.userId??0]=ce)),"highest"==U)&&(Z.hasOwnProperty(ce.userId??0)?(Z[ce.userId??0].mark??-1)<=(ce.mark??-1)&&(Z[ce.userId??0]=ce):Z[ce.userId??0]=ce)});else{var le=this.commonService.myClone(L[0]??{});le.resultId=le.testStatus?le.id:0,le.indexTest=0,Z[le.userId??0]=le}return Z}findExamResultOfStudent(L,U){var Z=[];return L.forEach(le=>{(le.studentId==U||null==le.studentId)&&Z.push(le)}),Z}addResultIdToExamResult(L){var U=[];return L.forEach(Z=>{var le=this.commonService.myClone(Z)??{};le.resultId=le.id,le.testStatus&&U.push(le)}),U}compareLengthWithExamQuestion(L,U){var Z=this.commonService.myClone(L);if(U>0&&L.length<U)for(var le=0;le<U-L.length;le++)Z.push("");return Z}mergeStudentWithAvatar(L){var U=[];return L.forEach(Z=>{var le=U.filter(H=>H.parentId==Z.parentId);if(le&&0!=le.length)for(var P=0;P<U.length;P++)U[P].parentId==Z.parentId&&(U[P].examResultObjs=U[P].examResultObjs?.concat(Z.examResultObjs??[]));else U.push(Z)}),U}createStudentWithResult(L,U,Z,le,P,H){return{id:L.id,userId:L.parentId,studentId:L.id,identificationNumber:U?.examResultStatisticObj?.offlineMarkInfoObj?.studentCode??0,offlineMixQuestionHashId:U?.offlineMark?.rawOfflineMixquestionId??0,studentCode:U?.offlineMark?.studentCode??0,gender:L.gender,fullName:L.fullName,avatar:L.avatar,birthday:L.birthday,resultId:U?.hasOwnProperty("resultId")?U.resultId:0,answers:U?.hasOwnProperty("answers")?U.answers:null,rightAnswer:U?.hasOwnProperty("rightAnswer")?U.rightAnswer:0,totalQuestion:U?.hasOwnProperty("totalQuestion")?U.totalQuestion:0,mark:U?.hasOwnProperty("mark")?U?.mark:null,trueFalseMark:U?.hasOwnProperty("trueFalseMark")?U.trueFalseMark:null,essayMark:U?.hasOwnProperty("essayMark")?U.essayMark:null,files:U?.hasOwnProperty("files")?U.files:null,infors:U?.hasOwnProperty("infors")?U?.infors:null,confirmedAt:U?.hasOwnProperty("confirmedAt")?U?.confirmedAt:null,startedTest:U?.hasOwnProperty("startedTest")?U?.startedTest:null,createdAt:U?.hasOwnProperty("createdAt")?U.createdAt:null,allResultObjs:this.addResultIdToExamResult(L.examResultObjs??[]),answeredQuestions:U?.hasOwnProperty("answeredQuestions")?U.answeredQuestions:[],groupPoints:this.getGroupPoints(U?.answeredQuestions?U?.answeredQuestions:[]),classroomIds:[],eventTracks:{exitCount:U?.examTrackObj?.exitFullScreen,blurCount:U?.examTrackObj?.blurWindow},status:Z,nameImages:L.nameImages,nameImage:"",answerMixObjs:this.compareLengthWithExamQuestion(U?.answerMixObjs??[],le)??[],testedTime:P+1,totalTestTime:H,subjectMarkValues:U?.subjectMarks,isOffline:U?.isOffline??!1,countEssayQuestion:this.sAztExamResultListSortService._checkCounterEssayQuestionObjs(U?.hasOwnProperty("answeredQuestions")&&U?.answeredQuestions?U.answeredQuestions:[])}}getGroupPoints(L){let U=[];return L.forEach(Z=>{let le=!1;for(let P=0;P<U.length;P++)U[P].id==Z.groupId&&(le=!0,U[P].point+=Z.correct&&Z.scorePerQuestion?Z.scorePerQuestion:0);!le&&Z.groupId&&U.push({id:Z.groupId,point:Z.correct&&Z.scorePerQuestion?Z.scorePerQuestion:0})}),U.sort((Z,le)=>(Z.id??0)-(le.id??0)),U}getMaxGroupId(L){let U=[];return L.forEach(Z=>{Z.id&&!this.commonService.filterArray(U,Z.id)&&U.push(Z.id)}),U.length}}return A.\u0275fac=function(L){return new(L||A)(u.LFG(g.z),u.LFG(h.DR),u.LFG(_.j),u.LFG(m.q),u.LFG(B.n),u.LFG(W.n),u.LFG(F.v),u.LFG(E.K))},A.\u0275prov=u.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A})()},67898:(at,ue,w)=>{"use strict";w.d(ue,{W:()=>u});var O=w(65879);let u=(()=>{class g{processData(_){let m=[],B=[];if(_)for(var W=0;W<_.length;W++)if("scroll"!=_[W][0]){var F={index:_[W][0],alpha:_[W][1],key:_[W][2],questionId:Number(_[W][3]),second:Number(_[W][4])};m.push(F)}else{var E={scrollPos:Number(_[W][1]),second:Number(_[W][2])};B.push(E)}return[m,B]}}return g.\u0275fac=function(_){return new(_||g)},g.\u0275prov=O.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},35852:(at,ue,w)=>{"use strict";w.d(ue,{T:()=>P});var O=w(65879),u=w(56223),g=w(39621),h=w(87384),_=w(96814),m=w(30617),B=w(92596),W=w(11964);function F(H,ce){1&H&&(O.TgZ(0,"span",9),O._uU(1),O.ALo(2,"mytranslate"),O.qZA()),2&H&&(O.xp6(1),O.hij("\xa0",O.lcZ(2,1,"lang_auto_het_luot"),""))}function E(H,ce){if(1&H){const ge=O.EpF();O.TgZ(0,"mat-icon",15),O.NdJ("click",function(){O.CHM(ge);const qe=O.oxw().$implicit,Me=O.oxw(4);let pt;return O.KtG(Me.playAudio(Me.questionObj.id,null!==(pt=qe.index)&&void 0!==pt?pt:0))}),O.ALo(1,"mytranslate"),O._uU(2,"play_arrow"),O.qZA()}2&H&&O.s9C("matTooltip",O.lcZ(1,1,"lang_auto_bat_dau_audio"))}function R(H,ce){if(1&H){const ge=O.EpF();O.TgZ(0,"mat-icon",16),O.NdJ("click",function(){O.CHM(ge);const qe=O.oxw().$implicit,Me=O.oxw(4);let pt;return O.KtG(Me.stopAudio(Me.questionObj.id,null!==(pt=qe.index)&&void 0!==pt?pt:0))}),O.ALo(1,"mytranslate"),O._uU(2,"delete"),O.qZA()}2&H&&O.s9C("matTooltip",O.lcZ(1,1,"lang_auto_ket_thuc"))}function A(H,ce){if(1&H&&(O.TgZ(0,"span",10),O.YNc(1,E,3,3,"mat-icon",11),O.YNc(2,R,3,3,"mat-icon",12),O.TgZ(3,"audio",13),O._UZ(4,"source",14),O.ALo(5,"safe"),O.ALo(6,"mycdn"),O.qZA()()),2&H){const ge=ce.$implicit,Oe=O.oxw(4);let qe,Me;O.Q6J("hidden",!ge.status),O.xp6(1),O.Q6J("ngIf",!Oe.checkAudioPlay(Oe.questionObj.id,null!==(qe=ge.index)&&void 0!==qe?qe:0)),O.xp6(1),O.Q6J("ngIf",Oe.checkAudioPlay(Oe.questionObj.id,null!==(Me=ge.index)&&void 0!==Me?Me:0)),O.xp6(1),O.s9C("id",Oe.isShowList?"audio_list_"+Oe.questionObj.id+"_"+ge.index:"audio_unit_"+Oe.questionObj.id+"_"+ge.index),O.xp6(1),O.Q6J("src",O.lcZ(5,5,O.lcZ(6,7,Oe.questionObj.attachments[0].url)),O.LSH)}}function fe(H,ce){if(1&H&&(O.TgZ(0,"div",5)(1,"span",6),O._uU(2),O.ALo(3,"mytranslate"),O.qZA(),O.YNc(4,F,3,3,"span",7),O.YNc(5,A,7,9,"ng-template",8),O.qZA()),2&H){const ge=O.oxw(3);O.xp6(2),O.hij("",O.lcZ(3,3,"lang_auto_so_luot_nghe"),": "),O.xp6(2),O.Q6J("ngIf",ge.questionObj.limitAudio==ge.totalLimit),O.xp6(1),O.Q6J("ngForOf",ge.questionObj.audioLimitObjs)}}function L(H,ce){if(1&H&&(O.TgZ(0,"div",3),O.YNc(1,fe,6,5,"div",4),O.qZA()),2&H){const ge=O.oxw(2);O.xp6(1),O.Q6J("ngIf",(null!=ge.questionObj.limitAudio?ge.questionObj.limitAudio:ge.totalLimit+1)<=ge.totalLimit)}}function U(H,ce){if(1&H&&(O.TgZ(0,"div"),O.YNc(1,L,2,1,"div",2),O.qZA()),2&H){const ge=O.oxw();O.xp6(1),O.Q6J("ngIf",ge.questionObj.attachments&&ge.questionObj.attachments.length>0)}}function Z(H,ce){if(1&H&&(O.TgZ(0,"div",18)(1,"audio",19),O._UZ(2,"source",14),O.ALo(3,"safe"),O.ALo(4,"mycdn"),O.qZA()()),2&H){const ge=O.oxw(2);O.xp6(1),O.s9C("id","audio_"+ge.questionObj.id),O.xp6(1),O.Q6J("src",O.lcZ(3,2,O.lcZ(4,4,ge.questionObj.attachments[0].url)),O.LSH)}}function le(H,ce){if(1&H&&O.YNc(0,Z,5,6,"div",17),2&H){const ge=O.oxw();O.Q6J("ngIf",ge.questionObj.attachments&&ge.questionObj.attachments.length>0)}}let P=(()=>{class H extends g.Q{detectAllAudioPlaying(){var ge=!1;let Oe=document.getElementsByTagName("audio");for(let qe=0;qe<Oe.length;qe++)if(Oe[qe].duration>0&&!Oe[qe].paused){ge=!0;break}return ge}playAudio(ge,Oe){var qe=this.isShowList?document.getElementById("audio_list_"+ge+"_"+Oe):document.getElementById("audio_unit_"+ge+"_"+Oe);qe&&(this.detectAllAudioPlaying()?this.commonService.snackWarning("lang_auto_file_dang_duoc_phat"):(this.sendAudioEmitter.emit({obj:this.questionObj,play:1,index:Oe}),qe.play()))}stopAudio(ge,Oe){var qe=this.isShowList?document.getElementById("audio_list_"+ge+"_"+Oe):document.getElementById("audio_unit_"+ge+"_"+Oe);qe&&qe.duration>0&&!qe.paused&&(qe.pause(),qe.currentTime=0,qe.setAttribute("src",""),this.sendAudioEmitter.emit({obj:this.questionObj,play:0,index:Oe}))}checkAudioPlay(ge,Oe){var qe=this.isShowList?document.getElementById("audio_list_"+ge+"_"+Oe):document.getElementById("audio_unit_"+ge+"_"+Oe);return!!qe&&(qe.duration>0&&!qe.paused||((qe.ended||qe.currentTime>0&&qe.paused)&&(qe.currentTime=0,qe.setAttribute("src",""),this.sendAudioEmitter.emit({obj:this.questionObj,play:0,index:Oe})),!1))}ngOnInit(){super.ngOnInit()}constructor(ge){super(),this.commonService=ge,this.totalLimit=0,this.isShowList=!0,this.sendAudioEmitter=new O.vpe,this.form=new u.nJ({})}}return H.\u0275fac=function(ge){return new(ge||H)(O.Y36(h.z))},H.\u0275cmp=O.Xpm({type:H,selectors:[["azt-test-audio-ui"]],inputs:{questionObj:"questionObj",totalLimit:"totalLimit",isShowList:"isShowList"},outputs:{sendAudioEmitter:"sendAudioEmitter"},features:[O.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["NormalAudio",""],["class","text-left ml-auto mr-auto",4,"ngIf"],[1,"text-left","ml-auto","mr-auto"],["class","limit_audio",4,"ngIf"],[1,"limit_audio"],[1,"mb-0",2,"font-size","14px","font-weight","400"],["class","mb-0","style","font-size: 14px; font-weight: 450;color: #da0522 ",4,"ngIf"],["ngFor","",3,"ngForOf"],[1,"mb-0",2,"font-size","14px","font-weight","450","color","#da0522"],[1,"audio-control",3,"hidden"],["azt-track-service","test-audio-ui-lkN7GNueEv","style","vertical-align: middle; line-height: 1; color: #000",3,"matTooltip","click",4,"ngIf"],["azt-track-service","test-audio-ui-lLxXpRGATU","style","vertical-align: middle; line-height: 1; color: #da0522",3,"matTooltip","click",4,"ngIf"],["preload","true",3,"id"],[3,"src"],["azt-track-service","test-audio-ui-lkN7GNueEv",2,"vertical-align","middle","line-height","1","color","#000",3,"matTooltip","click"],["azt-track-service","test-audio-ui-lLxXpRGATU",2,"vertical-align","middle","line-height","1","color","#da0522",3,"matTooltip","click"],["class","text-center ml-auto mr-auto",4,"ngIf"],[1,"text-center","ml-auto","mr-auto"],["controls","","preload","true",2,"margin-left","10px","margin-right","10px","max-width","70%",3,"id"]],template:function(ge,Oe){if(1&ge&&(O.YNc(0,U,2,1,"div",0),O.YNc(1,le,1,1,"ng-template",null,1,O.W1O)),2&ge){const qe=O.MAs(2);O.Q6J("ngIf",Oe.totalLimit>0)("ngIfElse",qe)}},dependencies:[_.sg,_.O5,m.Hw,B.gM,W.JV,W.QN,W.CR],styles:[".limit_audio[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;align-items:center}.audio-control[_ngcontent-%COMP%]{border-radius:50%;background-color:#f0f3f4;color:#000;padding:5px;height:35px;width:35px;margin-left:5px;cursor:pointer;text-align:center}"]}),H})()},42014:function(at,ue,w){"use strict";var O=this&&this.__awaiter||function(_,m,B,W){return new(B||(B=Promise))(function(E,R){function A(U){try{L(W.next(U))}catch(Z){R(Z)}}function fe(U){try{L(W.throw(U))}catch(Z){R(Z)}}function L(U){U.done?E(U.value):function F(E){return E instanceof B?E:new B(function(R){R(E)})}(U.value).then(A,fe)}L((W=W.apply(_,m||[])).next())})};Object.defineProperty(ue,"__esModule",{value:!0}),ue.decodeScanOfflineFile=ue.decode=void 0;const u=w(42588);ue.decode=function g(_){return O(this,void 0,void 0,function*(){return u.AzotaFileDecode.decode(_)})},ue.decodeScanOfflineFile=function h(_){return O(this,void 0,void 0,function*(){return u.AzotaFileDecode.decodeScanOfflineFile(_)})}},23597:(at,ue,w)=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0}),ue.AzotaFile=ue.FileType=void 0;const O=w(34416),u=w(99025);class g{}ue.FileType=g,g.scanOffline="scanOffline";class h{constructor(){}static fromZipFolder(m){let B=new h;return B.folder=m,B.readAztMain(),B}readAztMain(){let m=this.folder.getUtf8Text("main.json");if(null==m)throw new O.InvalidAztFileException("Couldn't found main.json file");this.aztMain=u.AztMain.fromJsonString(m)}}ue.AzotaFile=h},42588:function(at,ue,w){"use strict";var O=this&&this.__awaiter||function(m,B,W,F){return new(W||(W=Promise))(function(R,A){function fe(Z){try{U(F.next(Z))}catch(le){A(le)}}function L(Z){try{U(F.throw(Z))}catch(le){A(le)}}function U(Z){Z.done?R(Z.value):function E(R){return R instanceof W?R:new W(function(A){A(R)})}(Z.value).then(fe,L)}U((F=F.apply(m,B||[])).next())})};Object.defineProperty(ue,"__esModule",{value:!0}),ue.AzotaFileDecode=void 0;const u=w(81831),g=w(34850),h=w(23597);class _{static decode(B){return O(this,void 0,void 0,function*(){return u.ZipFolder.fromZip(B).then(W=>{let F=h.AzotaFile.fromZipFolder(W);return F.aztMain.fileType==h.FileType.scanOffline?g.ScanOfflineFile.fromZipFolder(F.folder):F})})}static decodeScanOfflineFile(B){return _.decode(B).then(W=>W)}}ue.AzotaFileDecode=_},99025:(at,ue,w)=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0}),ue.AztMain=void 0;const O=w(33516);class u{static fromJsonString(h){return u.fromJson(JSON.parse(h))}static fromJson(h){return(0,O.plainToInstance)(u,h)}}ue.AztMain=u},34416:(at,ue)=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0}),ue.InvalidAztFileException=void 0;class w extends Error{constructor(u){super(u)}}ue.InvalidAztFileException=w},59096:(at,ue,w)=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0}),ue.Point2d=ue.DrawingRectangle=ue.DrawingCircle=ue.AnswerRegionResult=ue.StudentCodeRegionResult=ue.ExamCodeRegionResult=ue.ScanOfflineResult=ue.ScanOfflineData=void 0;const O=w(33516);class u{static fromJsonString(R){return u.fromJson(JSON.parse(R))}static fromJson(R){return(0,O.plainToInstance)(u,R)}}ue.ScanOfflineData=u,ue.ScanOfflineResult=class g{},ue.ExamCodeRegionResult=class h{},ue.StudentCodeRegionResult=class _{},ue.AnswerRegionResult=class m{},ue.DrawingCircle=class B{},ue.DrawingRectangle=class W{},ue.Point2d=class F{}},34850:(at,ue,w)=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0}),ue.ScanOfflineFile=void 0;const O=w(23597),u=w(34416),g=w(59096);class h extends O.AzotaFile{constructor(){super()}static fromZipFolder(m){let B=new h;if(B.folder=m,B.readAztMain(),B.aztMain.fileType!=O.FileType.scanOffline)throw new u.InvalidAztFileException(`fileType must be ${O.FileType.scanOffline}`);let F=m.getUtf8Text(B.aztMain.detailPath);if(null==F)throw new u.InvalidAztFileException(`Couldn't found ${F} file`);return B.scanOfflineData=g.ScanOfflineData.fromJsonString(F),B}getWrappedImage(){var m,B;return null==(null===(B=null===(m=this.scanOfflineData)||void 0===m?void 0:m.scanResult)||void 0===B?void 0:B.wrappedScanFilePath)?null:this.folder.getBinary(this.scanOfflineData.scanResult.wrappedScanFilePath)}getWrappedImageExtension(){var m,B;let W=null===(B=null===(m=this.scanOfflineData)||void 0===m?void 0:m.scanResult)||void 0===B?void 0:B.wrappedScanFilePath;return null==W?null:W.substring(W.lastIndexOf("."))}}ue.ScanOfflineFile=h},81831:function(at,ue,w){"use strict";var O=this&&this.__awaiter||function(h,_,m,B){return new(m||(m=Promise))(function(F,E){function R(L){try{fe(B.next(L))}catch(U){E(U)}}function A(L){try{fe(B.throw(L))}catch(U){E(U)}}function fe(L){L.done?F(L.value):function W(F){return F instanceof m?F:new m(function(E){E(F)})}(L.value).then(R,A)}fe((B=B.apply(h,_||[])).next())})};Object.defineProperty(ue,"__esModule",{value:!0}),ue.ZipFolder=void 0;const u=w(85965);class g{constructor(_){this.files=new Map,_.forEach((m,B)=>{this.files.set(B,m)})}static fromZip(_){return O(this,void 0,void 0,function*(){let B=yield(new u).loadAsync(_).then(W=>{const F=[];return W.forEach(function(E){let R=W.file(E);R&&F.push(R.async("uint8array").then(A=>({path:E,data:A})))}),F});return Promise.all(B).then(W=>{let F=new Map;return W.forEach(E=>{F.set(E.path,E.data)}),new g(F)})})}setBinary(_,m){this.files.set(_,m)}setUtf8Text(_,m){let B=(new TextEncoder).encode(m);this.files.set(_,B)}getBinary(_){var m;return null!==(m=this.files.get(_))&&void 0!==m?m:null}getUtf8Text(_){let m=this.files.get(_);return null===m?null:(new TextDecoder).decode(m)}toDocx(){return O(this,void 0,void 0,function*(){const _=new u;for(let[m,B]of Array.from(this.files))_.file(m,B,{binary:!0});return _.generateAsync({type:"uint8array",compression:"DEFLATE",compressionOptions:{level:9}})})}toBlob(){return O(this,void 0,void 0,function*(){const _=new u;for(let[m,B]of Array.from(this.files))_.file(m,B,{binary:!0});return _.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:9}})})}}ue.ZipFolder=g},6990:function(at,ue,w){var O;at=w.nmd(at),function(){var u,m="Expected a function",W="__lodash_hash_undefined__",E="__lodash_placeholder__",oe=1/0,pe=9007199254740991,Je=4294967295,wt=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],Ae="[object Arguments]",ne="[object Array]",ae="[object Boolean]",$="[object Date]",ee="[object Error]",Pe="[object Function]",K="[object GeneratorFunction]",q="[object Map]",ie="[object Number]",ze="[object Object]",k="[object Promise]",y="[object RegExp]",S="[object Set]",D="[object String]",j="[object Symbol]",J="[object WeakMap]",je="[object ArrayBuffer]",Ce="[object DataView]",be="[object Float32Array]",nt="[object Float64Array]",Ve="[object Int8Array]",Ze="[object Int16Array]",He="[object Int32Array]",$e="[object Uint8Array]",Kt="[object Uint8ClampedArray]",zt="[object Uint16Array]",Rt="[object Uint32Array]",ln=/\b__p \+= '';/g,ci=/\b(__p \+=) '' \+/g,Ws=/(__e\(.*?\)|\b__t\)) \+\n'';/g,$i=/&(?:amp|lt|gt|quot|#39);/g,Qt=/[&<>"']/g,Gs=RegExp($i.source),gn=RegExp(Qt.source),_n=/<%-([\s\S]+?)%>/g,ki=/<%([\s\S]+?)%>/g,ns=/<%=([\s\S]+?)%>/g,Ks=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,is=/^\w*$/,rs=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,wi=/[\\^$.*+?()[\]{}|]/g,Js=RegExp(wi.source),aa=/^\s+/,Rl=/\s/,Hf=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ll=/\{\n\/\* \[wrapped with (.+)\] \*/,_h=/,? & /,Xf=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,la=/[()=,{}\[\]\/\s]/,Fl=/\\(\\)?/g,Nl=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ql=/\w*$/,ep=/^[-+]0x[0-9a-f]+$/i,$s=/^0b[01]+$/i,xh=/^\[object .+?Constructor\]$/,vh=/^0o[0-7]+$/i,yh=/^(?:0|[1-9]\d*)$/,ca=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ua=/($^)/,tp=/['\n\r\u2028\u2029\\]/g,Di="\\ud800-\\udfff",jl="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ys="\\u2700-\\u27bf",Bl="a-z\\xdf-\\xf6\\xf8-\\xff",ss="A-Z\\xc0-\\xd6\\xd8-\\xde",Xs="\\ufe0e\\ufe0f",Ul="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ch="["+Di+"]",zl="["+Ul+"]",Yi="["+jl+"]",ha="\\d+",Zl="["+Ys+"]",da="["+Bl+"]",to="[^"+Di+Ul+ha+Ys+Bl+ss+"]",Mr="\\ud83c[\\udffb-\\udfff]",Th="[^"+Di+"]",no="(?:\\ud83c[\\udde6-\\uddff]){2}",os="[\\ud800-\\udbff][\\udc00-\\udfff]",Hi="["+ss+"]",Vl="(?:"+da+"|"+to+")",Ah="(?:"+Hi+"|"+to+")",Ih="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",as="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Wl="(?:"+Yi+"|"+Mr+")?",io="["+Xs+"]?",Eh=io+Wl+"(?:\\u200d(?:"+[Th,no,os].join("|")+")"+io+Wl+")*",rp="(?:"+[Zl,no,os].join("|")+")"+Eh,Sh="(?:"+[Th+Yi+"?",Yi,no,os,Ch].join("|")+")",Mh=RegExp("['\u2019]","g"),sp=RegExp(Yi,"g"),Ri=RegExp(Mr+"(?="+Mr+")|"+Sh+Eh,"g"),Li=RegExp([Hi+"?"+da+"+"+Ih+"(?="+[zl,Hi,"$"].join("|")+")",Ah+"+"+as+"(?="+[zl,Hi+Vl,"$"].join("|")+")",Hi+"?"+Vl+"+"+Ih,Hi+"+"+as,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ha,rp].join("|"),"g"),fa=RegExp("[\\u200d"+Di+jl+Xs+"]"),pa=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ph=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Jt=-1,Lt={};Lt[be]=Lt[nt]=Lt[Ve]=Lt[Ze]=Lt[He]=Lt[$e]=Lt[Kt]=Lt[zt]=Lt[Rt]=!0,Lt[Ae]=Lt[ne]=Lt[je]=Lt[ae]=Lt[Ce]=Lt[$]=Lt[ee]=Lt[Pe]=Lt[q]=Lt[ie]=Lt[ze]=Lt[y]=Lt[S]=Lt[D]=Lt[J]=!1;var kt={};kt[Ae]=kt[ne]=kt[je]=kt[Ce]=kt[ae]=kt[$]=kt[be]=kt[nt]=kt[Ve]=kt[Ze]=kt[He]=kt[q]=kt[ie]=kt[ze]=kt[y]=kt[S]=kt[D]=kt[j]=kt[$e]=kt[Kt]=kt[zt]=kt[Rt]=!0,kt[ee]=kt[Pe]=kt[J]=!1;var ap={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},lp=parseFloat,cp=parseInt,Dh="object"==typeof global&&global&&global.Object===Object&&global,oo="object"==typeof self&&self&&self.Object===Object&&self,$t=Dh||oo||Function("return this")(),Kl=ue&&!ue.nodeType&&ue,ls=Kl&&at&&!at.nodeType&&at,Jl=ls&&ls.exports===Kl,Xi=Jl&&Dh.process,si=function(){try{return ls&&ls.require&&ls.require("util").types||Xi&&Xi.binding&&Xi.binding("util")}catch{}}(),Rh=si&&si.isArrayBuffer,$l=si&&si.isDate,Lh=si&&si.isMap,Yl=si&&si.isRegExp,Hl=si&&si.isSet,ga=si&&si.isTypedArray;function qn(z,he,se){switch(se.length){case 0:return z.call(he);case 1:return z.call(he,se[0]);case 2:return z.call(he,se[0],se[1]);case 3:return z.call(he,se[0],se[1],se[2])}return z.apply(he,se)}function Fh(z,he,se,Ye){for(var dt=-1,Pt=null==z?0:z.length;++dt<Pt;){var mn=z[dt];he(Ye,mn,se(mn),z)}return Ye}function Hn(z,he){for(var se=-1,Ye=null==z?0:z.length;++se<Ye&&!1!==he(z[se],se,z););return z}function Xl(z,he){for(var se=null==z?0:z.length;se--&&!1!==he(z[se],se,z););return z}function Nh(z,he){for(var se=-1,Ye=null==z?0:z.length;++se<Ye;)if(!he(z[se],se,z))return!1;return!0}function er(z,he){for(var se=-1,Ye=null==z?0:z.length,dt=0,Pt=[];++se<Ye;){var mn=z[se];he(mn,se,z)&&(Pt[dt++]=mn)}return Pt}function ma(z,he){return!(null==z||!z.length)&&us(z,he,0)>-1}function cs(z,he,se){for(var Ye=-1,dt=null==z?0:z.length;++Ye<dt;)if(se(he,z[Ye]))return!0;return!1}function Ft(z,he){for(var se=-1,Ye=null==z?0:z.length,dt=Array(Ye);++se<Ye;)dt[se]=he(z[se],se,z);return dt}function ui(z,he){for(var se=-1,Ye=he.length,dt=z.length;++se<Ye;)z[dt+se]=he[se];return z}function ao(z,he,se,Ye){var dt=-1,Pt=null==z?0:z.length;for(Ye&&Pt&&(se=z[++dt]);++dt<Pt;)se=he(se,z[dt],dt,z);return se}function qh(z,he,se,Ye){var dt=null==z?0:z.length;for(Ye&&dt&&(se=z[--dt]);dt--;)se=he(se,z[dt],dt,z);return se}function kr(z,he){for(var se=-1,Ye=null==z?0:z.length;++se<Ye;)if(he(z[se],se,z))return!0;return!1}var lo=xa("length");function ec(z,he,se){var Ye;return se(z,function(dt,Pt,mn){if(he(dt,Pt,mn))return Ye=Pt,!1}),Ye}function _a(z,he,se,Ye){for(var dt=z.length,Pt=se+(Ye?1:-1);Ye?Pt--:++Pt<dt;)if(he(z[Pt],Pt,z))return Pt;return-1}function us(z,he,se){return he==he?function Qh(z,he,se){for(var Ye=se-1,dt=z.length;++Ye<dt;)if(z[Ye]===he)return Ye;return-1}(z,he,se):_a(z,tc,se)}function hp(z,he,se,Ye){for(var dt=se-1,Pt=z.length;++dt<Pt;)if(Ye(z[dt],he))return dt;return-1}function tc(z){return z!=z}function nc(z,he){var se=null==z?0:z.length;return se?va(z,he)/se:NaN}function xa(z){return function(he){return null==he?u:he[z]}}function hs(z){return function(he){return null==z?u:z[he]}}function ic(z,he,se,Ye,dt){return dt(z,function(Pt,mn,mt){se=Ye?(Ye=!1,Pt):he(se,Pt,mn,mt)}),se}function va(z,he){for(var se,Ye=-1,dt=z.length;++Ye<dt;){var Pt=he(z[Ye]);Pt!==u&&(se=se===u?Pt:se+Pt)}return se}function ya(z,he){for(var se=-1,Ye=Array(z);++se<z;)Ye[se]=he(se);return Ye}function ds(z){return z&&z.slice(0,Gn(z)+1).replace(aa,"")}function Vn(z){return function(he){return z(he)}}function co(z,he){return Ft(he,function(se){return z[se]})}function tr(z,he){return z.has(he)}function sc(z,he){for(var se=-1,Ye=z.length;++se<Ye&&us(he,z[se],0)>-1;);return se}function uo(z,he){for(var se=z.length;se--&&us(he,z[se],0)>-1;);return se}var jh=hs({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),ho=hs({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Bh(z){return"\\"+ap[z]}function nr(z){return fa.test(z)}function fs(z){var he=-1,se=Array(z.size);return z.forEach(function(Ye,dt){se[++he]=[dt,Ye]}),se}function ac(z,he){return function(se){return z(he(se))}}function Ni(z,he){for(var se=-1,Ye=z.length,dt=0,Pt=[];++se<Ye;){var mn=z[se];(mn===he||mn===E)&&(z[se]=E,Pt[dt++]=se)}return Pt}function bi(z){var he=-1,se=Array(z.size);return z.forEach(function(Ye){se[++he]=Ye}),se}function Dr(z){return nr(z)?function Gh(z){for(var he=Ri.lastIndex=0;Ri.test(z);)++he;return he}(z):lo(z)}function Wn(z){return nr(z)?function ps(z){return z.match(Ri)||[]}(z):function up(z){return z.split("")}(z)}function Gn(z){for(var he=z.length;he--&&Rl.test(z.charAt(he)););return he}var Wh=hs({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),gs=function z(he){var r,se=(he=null==he?$t:gs.defaults($t.Object(),he,gs.pick($t,Ph))).Array,Ye=he.Date,dt=he.Error,Pt=he.Function,mn=he.Math,mt=he.Object,ir=he.RegExp,rr=he.String,Kn=he.TypeError,lc=se.prototype,Zt=mt.prototype,qi=he["__core-js_shared__"],ms=Pt.prototype.toString,Le=Zt.hasOwnProperty,Xe=0,gp=(r=/[^.]+$/.exec(qi&&qi.keys&&qi.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",Qe=Zt.toString,re=ms.call(mt),Ie=$t._,xn=ir("^"+ms.call(Le).replace(wi,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fo=Jl?he.Buffer:u,sr=he.Symbol,wa=he.Uint8Array,Kh=fo?fo.allocUnsafe:u,ba=ac(mt.getPrototypeOf,mt),Jh=mt.create,cc=Zt.propertyIsEnumerable,Ca=lc.splice,mp=sr?sr.isConcatSpreadable:u,po=sr?sr.iterator:u,or=sr?sr.toStringTag:u,ct=function(){try{var r=Qi(mt,"defineProperty");return r({},"",{}),r}catch{}}(),_s=he.clearTimeout!==$t.clearTimeout&&he.clearTimeout,$h=Ye&&Ye.now!==$t.Date.now&&Ye.now,Xt=he.setTimeout!==$t.setTimeout&&he.setTimeout,et=mn.ceil,ar=mn.floor,At=mt.getOwnPropertySymbols,_p=fo?fo.isBuffer:u,rn=he.isFinite,We=lc.join,Oa=ac(mt.keys,mt),cn=mn.max,sn=mn.min,xp=Ye.now,Ta=he.parseInt,Yh=mn.random,go=lc.reverse,Aa=Qi(he,"DataView"),xs=Qi(he,"Map"),jn=Qi(he,"Promise"),lr=Qi(he,"Set"),vs=Qi(he,"WeakMap"),mo=Qi(mt,"create"),hi=vs&&new vs,cr={},te=wr(Aa),Ia=wr(xs),di=wr(jn),vp=wr(lr),_o=wr(vs),fi=sr?sr.prototype:u,xo=fi?fi.valueOf:u,ur=fi?fi.toString:u;function C(r){if(Yt(r)&&!_t(r)&&!(r instanceof ut)){if(r instanceof oi)return r;if(Le.call(r,"__wrapped__"))return Ld(r)}return new oi(r)}var hr=function(){function r(){}return function(o){if(!Bt(o))return{};if(Jh)return Jh(o);r.prototype=o;var c=new r;return r.prototype=u,c}}();function Ea(){}function oi(r,o){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=u}function ut(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Je,this.__views__=[]}function Xn(r){var o=-1,c=null==r?0:r.length;for(this.clear();++o<c;){var f=r[o];this.set(f[0],f[1])}}function jt(r){var o=-1,c=null==r?0:r.length;for(this.clear();++o<c;){var f=r[o];this.set(f[0],f[1])}}function Ci(r){var o=-1,c=null==r?0:r.length;for(this.clear();++o<c;){var f=r[o];this.set(f[0],f[1])}}function pi(r){var o=-1,c=null==r?0:r.length;for(this.__data__=new Ci;++o<c;)this.add(r[o])}function Pn(r){var o=this.__data__=new jt(r);this.size=o.size}function fc(r,o){var c=_t(r),f=!c&&es(r),v=!c&&!f&&xi(r),T=!c&&!f&&!v&&Fs(r),M=c||f||v||T,N=M?ya(r.length,rr):[],Q=N.length;for(var xe in r)(o||Le.call(r,xe))&&(!M||!("length"==xe||v&&("offset"==xe||"parent"==xe)||T&&("buffer"==xe||"byteLength"==xe||"byteOffset"==xe)||Vi(xe,Q)))&&N.push(xe);return N}function Co(r){var o=r.length;return o?r[Cc(0,o-1)]:u}function Oo(r,o){return Ya(Jn(r),vt(o,0,r.length))}function id(r){return Ya(Jn(r))}function pc(r,o,c){(c!==u&&!ni(r[o],c)||c===u&&!(o in r))&&Ti(r,o,c)}function To(r,o,c){var f=r[o];(!Le.call(r,o)||!ni(f,c)||c===u&&!(o in r))&&Ti(r,o,c)}function Ao(r,o){for(var c=r.length;c--;)if(ni(r[c][0],o))return c;return-1}function rd(r,o,c,f){return Bi(r,function(v,T,M){o(f,v,c(v),M)}),f}function ji(r,o){return r&&en(o,On(o),r)}function Ti(r,o,c){"__proto__"==o&&ct?ct(r,o,{configurable:!0,enumerable:!0,value:c,writable:!0}):r[o]=c}function Ma(r,o){for(var c=-1,f=o.length,v=se(f),T=null==r;++c<f;)v[c]=T?u:ku(r,o[c]);return v}function vt(r,o,c){return r==r&&(c!==u&&(r=r<=c?r:c),o!==u&&(r=r>=o?r:o)),r}function bt(r,o,c,f,v,T){var M,N=1&o,Q=2&o,xe=4&o;if(c&&(M=v?c(r,f,v,T):c(r)),M!==u)return M;if(!Bt(r))return r;var ve=_t(r);if(ve){if(M=function Mp(r){var o=r.length,c=new r.constructor(o);return o&&"string"==typeof r[0]&&Le.call(r,"index")&&(c.index=r.index,c.input=r.input),c}(r),!N)return Jn(r,M)}else{var Te=En(r),Ge=Te==Pe||Te==K;if(xi(r))return Mc(r,N);if(Te==ze||Te==Ae||Ge&&!v){if(M=Q||Ge?{}:Td(r),!N)return Q?function Fo(r,o){return en(r,Ja(r),o)}(r,function sd(r,o){return r&&en(o,Yn(o),r)}(M,r)):function xd(r,o){return en(r,Ka(r),o)}(r,ji(M,r))}else{if(!kt[Te])return v?r:{};M=function Ps(r,o,c){var f=r.constructor;switch(o){case je:return Ba(r);case ae:case $:return new f(+r);case Ce:return function Is(r,o){var c=o?Ba(r.buffer):r.buffer;return new r.constructor(c,r.byteOffset,r.byteLength)}(r,c);case be:case nt:case Ve:case Ze:case He:case $e:case Kt:case zt:case Rt:return hn(r,c);case q:return new f;case ie:case D:return new f(r);case y:return function Pc(r){var o=new r.constructor(r.source,ql.exec(r));return o.lastIndex=r.lastIndex,o}(r);case S:return new f;case j:return function Tp(r){return xo?mt(xo.call(r)):{}}(r)}}(r,Te,N)}}T||(T=new Pn);var tt=T.get(r);if(tt)return tt;T.set(r,M),yl(r)?r.forEach(function(lt){M.add(bt(lt,o,c,lt,r,T))}):ts(r)&&r.forEach(function(lt,Tt){M.set(Tt,bt(lt,o,c,Tt,r,T))});var Ot=ve?u:(xe?Q?Wr:Va:Q?Yn:On)(r);return Hn(Ot||r,function(lt,Tt){Ot&&(lt=r[Tt=lt]),To(M,Tt,bt(lt,o,c,Tt,r,T))}),M}function Pa(r,o,c){var f=c.length;if(null==r)return!f;for(r=mt(r);f--;){var v=c[f],M=r[v];if(M===u&&!(v in r)||!(0,o[v])(M))return!1}return!0}function gc(r,o,c){if("function"!=typeof r)throw new Kn(m);return zo(function(){r.apply(u,c)},o)}function ws(r,o,c,f){var v=-1,T=ma,M=!0,N=r.length,Q=[],xe=o.length;if(!N)return Q;c&&(o=Ft(o,Vn(c))),f?(T=cs,M=!1):o.length>=200&&(T=tr,M=!1,o=new pi(o));e:for(;++v<N;){var ve=r[v],Te=null==c?ve:c(ve);if(ve=f||0!==ve?ve:0,M&&Te==Te){for(var Ge=xe;Ge--;)if(o[Ge]===Te)continue e;Q.push(ve)}else T(o,Te,f)||Q.push(ve)}return Q}C.templateSettings={escape:_n,evaluate:ki,interpolate:ns,variable:"",imports:{_:C}},(C.prototype=Ea.prototype).constructor=C,(oi.prototype=hr(Ea.prototype)).constructor=oi,(ut.prototype=hr(Ea.prototype)).constructor=ut,Xn.prototype.clear=function Xh(){this.__data__=mo?mo(null):{},this.size=0},Xn.prototype.delete=function vo(r){var o=this.has(r)&&delete this.__data__[r];return this.size-=o?1:0,o},Xn.prototype.get=function yo(r){var o=this.__data__;if(mo){var c=o[r];return c===W?u:c}return Le.call(o,r)?o[r]:u},Xn.prototype.has=function ed(r){var o=this.__data__;return mo?o[r]!==u:Le.call(o,r)},Xn.prototype.set=function rm(r,o){var c=this.__data__;return this.size+=this.has(r)?0:1,c[r]=mo&&o===u?W:o,this},jt.prototype.clear=function wp(){this.__data__=[],this.size=0},jt.prototype.delete=function dr(r){var o=this.__data__,c=Ao(o,r);return!(c<0||(c==o.length-1?o.pop():Ca.call(o,c,1),--this.size,0))},jt.prototype.get=function on(r){var o=this.__data__,c=Ao(o,r);return c<0?u:o[c][1]},jt.prototype.has=function Lr(r){return Ao(this.__data__,r)>-1},jt.prototype.set=function uc(r,o){var c=this.__data__,f=Ao(c,r);return f<0?(++this.size,c.push([r,o])):c[f][1]=o,this},Ci.prototype.clear=function wo(){this.size=0,this.__data__={hash:new Xn,map:new(xs||jt),string:new Xn}},Ci.prototype.delete=function fr(r){var o=Ga(this,r).delete(r);return this.size-=o?1:0,o},Ci.prototype.get=function Sa(r){return Ga(this,r).get(r)},Ci.prototype.has=function Fr(r){return Ga(this,r).has(r)},Ci.prototype.set=function Oi(r,o){var c=Ga(this,r),f=c.size;return c.set(r,o),this.size+=c.size==f?0:1,this},pi.prototype.add=pi.prototype.push=function pr(r){return this.__data__.set(r,W),this},pi.prototype.has=function td(r){return this.__data__.has(r)},Pn.prototype.clear=function hc(){this.__data__=new jt,this.size=0},Pn.prototype.delete=function Nr(r){var o=this.__data__,c=o.delete(r);return this.size=o.size,c},Pn.prototype.get=function dc(r){return this.__data__.get(r)},Pn.prototype.has=function bo(r){return this.__data__.has(r)},Pn.prototype.set=function nd(r,o){var c=this.__data__;if(c instanceof jt){var f=c.__data__;if(!xs||f.length<199)return f.push([r,o]),this.size=++c.size,this;c=this.__data__=new Ci(f)}return c.set(r,o),this.size=c.size,this};var Bi=Dc(gi),mc=Dc(_c,!0);function od(r,o){var c=!0;return Bi(r,function(f,v,T){return c=!!o(f,v,T)}),c}function Io(r,o,c){for(var f=-1,v=r.length;++f<v;){var T=r[f],M=o(T);if(null!=M&&(N===u?M==M&&!Un(M):c(M,N)))var N=M,Q=T}return Q}function ad(r,o){var c=[];return Bi(r,function(f,v,T){o(f,v,T)&&c.push(f)}),c}function Tn(r,o,c,f,v){var T=-1,M=r.length;for(c||(c=Ad),v||(v=[]);++T<M;){var N=r[T];o>0&&c(N)?o>1?Tn(N,o-1,c,f,v):ui(v,N):f||(v[v.length]=N)}return v}var ka=Es(),ld=Es(!0);function gi(r,o){return r&&ka(r,o,On)}function _c(r,o){return r&&ld(r,o,On)}function Da(r,o){return er(o,function(c){return vi(r[c])})}function ai(r,o){for(var c=0,f=(o=zi(o,r)).length;null!=r&&c<f;)r=r[Si(o[c++])];return c&&c==f?r:u}function cd(r,o,c){var f=o(r);return _t(r)?f:ui(f,c(r))}function It(r){return null==r?r===u?"[object Undefined]":"[object Null]":or&&or in mt(r)?function Ep(r){var o=Le.call(r,or),c=r[or];try{r[or]=u;var f=!0}catch{}var v=Qe.call(r);return f&&(o?r[or]=c:delete r[or]),v}(r):function Lp(r){return Qe.call(r)}(r)}function bs(r,o){return r>o}function An(r,o){return null!=r&&Le.call(r,o)}function Nt(r,o){return null!=r&&o in mt(r)}function gr(r,o,c){for(var f=c?cs:ma,v=r[0].length,T=r.length,M=T,N=se(T),Q=1/0,xe=[];M--;){var ve=r[M];M&&o&&(ve=Ft(ve,Vn(o))),Q=sn(ve.length,Q),N[M]=!c&&(o||v>=120&&ve.length>=120)?new pi(M&&ve):u}ve=r[0];var Te=-1,Ge=N[0];e:for(;++Te<v&&xe.length<Q;){var tt=ve[Te],ot=o?o(tt):tt;if(tt=c||0!==tt?tt:0,!(Ge?tr(Ge,ot):f(xe,ot,c))){for(M=T;--M;){var Ot=N[M];if(!(Ot?tr(Ot,ot):f(r[M],ot,c)))continue e}Ge&&Ge.push(ot),xe.push(tt)}}return xe}function un(r,o,c){var f=null==(r=Md(r,o=zi(o,r)))?r:r[Si(bn(o))];return null==f?u:qn(f,r,c)}function xc(r){return Yt(r)&&It(r)==Ae}function qr(r,o,c,f,v){return r===o||(null==r||null==o||!Yt(r)&&!Yt(o)?r!=r&&o!=o:function jr(r,o,c,f,v,T){var M=_t(r),N=_t(o),Q=M?ne:En(r),xe=N?ne:En(o),ve=(Q=Q==Ae?ze:Q)==ze,Te=(xe=xe==Ae?ze:xe)==ze,Ge=Q==xe;if(Ge&&xi(r)){if(!xi(o))return!1;M=!0,ve=!1}if(Ge&&!ve)return T||(T=new Pn),M||Fs(r)?qc(r,o,c,f,v,T):function Bo(r,o,c,f,v,T,M){switch(c){case Ce:if(r.byteLength!=o.byteLength||r.byteOffset!=o.byteOffset)return!1;r=r.buffer,o=o.buffer;case je:return!(r.byteLength!=o.byteLength||!T(new wa(r),new wa(o)));case ae:case $:case ie:return ni(+r,+o);case ee:return r.name==o.name&&r.message==o.message;case y:case D:return r==o+"";case q:var N=fs;case S:if(N||(N=bi),r.size!=o.size&&!(1&f))return!1;var xe=M.get(r);if(xe)return xe==o;f|=2,M.set(r,o);var ve=qc(N(r),N(o),f,v,T,M);return M.delete(r),ve;case j:if(xo)return xo.call(r)==xo.call(o)}return!1}(r,o,Q,c,f,v,T);if(!(1&c)){var tt=ve&&Le.call(r,"__wrapped__"),ot=Te&&Le.call(o,"__wrapped__");if(tt||ot){var Ot=tt?r.value():r,lt=ot?o.value():o;return T||(T=new Pn),v(Ot,lt,c,f,T)}}return!!Ge&&(T||(T=new Pn),function Ii(r,o,c,f,v,T){var M=1&c,N=Va(r),Q=N.length;if(Q!=Va(o).length&&!M)return!1;for(var Te=Q;Te--;){var Ge=N[Te];if(!(M?Ge in o:Le.call(o,Ge)))return!1}var tt=T.get(r),ot=T.get(o);if(tt&&ot)return tt==o&&ot==r;var Ot=!0;T.set(r,o),T.set(o,r);for(var lt=M;++Te<Q;){var Tt=r[Ge=N[Te]],Mt=o[Ge];if(f)var zn=M?f(Mt,Tt,Ge,o,r,T):f(Tt,Mt,Ge,r,o,T);if(!(zn===u?Tt===Mt||v(Tt,Mt,c,f,T):zn)){Ot=!1;break}lt||(lt="constructor"==Ge)}if(Ot&&!lt){var Zn=r.constructor,li=o.constructor;Zn!=li&&"constructor"in r&&"constructor"in o&&!("function"==typeof Zn&&Zn instanceof Zn&&"function"==typeof li&&li instanceof li)&&(Ot=!1)}return T.delete(r),T.delete(o),Ot}(r,o,c,f,v,T))}(r,o,c,f,qr,v))}function Cs(r,o,c,f){var v=c.length,T=v,M=!f;if(null==r)return!T;for(r=mt(r);v--;){var N=c[v];if(M&&N[2]?N[1]!==r[N[0]]:!(N[0]in r))return!1}for(;++v<T;){var Q=(N=c[v])[0],xe=r[Q],ve=N[1];if(M&&N[2]){if(xe===u&&!(Q in r))return!1}else{var Te=new Pn;if(f)var Ge=f(xe,ve,Q,r,o,Te);if(!(Ge===u?qr(ve,xe,3,f,Te):Ge))return!1}}return!0}function So(r){return!(!Bt(r)||function Ei(r){return!!gp&&gp in r}(r))&&(vi(r)?xn:xh).test(wr(r))}function vc(r){return"function"==typeof r?r:null==r?Ln:"object"==typeof r?_t(r)?_r(r[0],r[1]):Ra(r):lh(r)}function mr(r){if(!yr(r))return Oa(r);var o=[];for(var c in mt(r))Le.call(r,c)&&"constructor"!=c&&o.push(c);return o}function Mo(r,o){return r<o}function Po(r,o){var c=-1,f=$n(r)?se(r.length):[];return Bi(r,function(v,T,M){f[++c]=o(v,T,M)}),f}function Ra(r){var o=Kr(r);return 1==o.length&&o[0][2]?Ed(o[0][0],o[0][1]):function(c){return c===r||Cs(c,r,o)}}function _r(r,o){return Sn(r)&&jc(o)?Ed(Si(r),o):function(c){var f=ku(c,r);return f===u&&f===o?Ho(c,r):qr(o,f,3)}}function yn(r,o,c,f,v){r!==o&&ka(o,function(T,M){if(v||(v=new Pn),Bt(T))!function yc(r,o,c,f,v,T,M){var N=Bc(r,c),Q=Bc(o,c),xe=M.get(Q);if(xe)pc(r,c,xe);else{var ve=T?T(N,Q,c+"",r,o,M):u,Te=ve===u;if(Te){var Ge=_t(Q),tt=!Ge&&xi(Q),ot=!Ge&&!tt&&Fs(Q);ve=Q,Ge||tt||ot?_t(N)?ve=N:dn(N)?ve=Jn(N):tt?(Te=!1,ve=Mc(Q,!0)):ot?(Te=!1,ve=hn(Q,!0)):ve=[]:ii(Q)||es(Q)?(ve=N,es(N)?ve=yf(N):(!Bt(N)||vi(N))&&(ve=Td(Q))):Te=!1}Te&&(M.set(Q,ve),v(ve,Q,f,T,M),M.delete(Q)),pc(r,c,ve)}}(r,o,M,c,yn,f,v);else{var N=f?f(Bc(r,M),T,M+"",r,o,v):u;N===u&&(N=T),pc(r,M,N)}},Yn)}function ko(r,o){var c=r.length;if(c)return Vi(o+=o<0?c:0,c)?r[o]:u}function Os(r,o,c){o=o.length?Ft(o,function(T){return _t(T)?function(M){return ai(M,1===T.length?T[0]:T)}:T}):[Ln];var f=-1;return o=Ft(o,Vn(st())),function Fi(z,he){var se=z.length;for(z.sort(he);se--;)z[se]=z[se].value;return z}(Po(r,function(T,M,N){return{criteria:Ft(o,function(xe){return xe(T)}),index:++f,value:T}}),function(T,M){return function _d(r,o,c){for(var f=-1,v=r.criteria,T=o.criteria,M=v.length,N=c.length;++f<M;){var Q=Et(v[f],T[f]);if(Q)return f>=N?Q:Q*("desc"==c[f]?-1:1)}return r.index-o.index}(T,M,c)})}function La(r,o,c){for(var f=-1,v=o.length,T={};++f<v;){var M=o[f],N=ai(r,M);c(N,M)&&Do(T,zi(M,r),N)}return T}function Fa(r,o,c,f){var v=f?hp:us,T=-1,M=o.length,N=r;for(r===o&&(o=Jn(o)),c&&(N=Ft(r,Vn(c)));++T<M;)for(var Q=0,xe=o[T],ve=c?c(xe):xe;(Q=v(N,ve,Q,f))>-1;)N!==r&&Ca.call(N,Q,1),Ca.call(r,Q,1);return r}function bc(r,o){for(var c=r?o.length:0,f=c-1;c--;){var v=o[c];if(c==f||v!==T){var T=v;Vi(v)?Ca.call(r,v,1):Ic(r,v)}}return r}function Cc(r,o){return r+ar(Yh()*(o-r+1))}function Na(r,o){var c="";if(!r||o<1||o>pe)return c;do{o%2&&(c+=r),(o=ar(o/2))&&(r+=r)}while(o);return c}function Ct(r,o){return Uc(Sd(r,o,Ln),r+"")}function qa(r){return Co(Er(r))}function Op(r,o){var c=Er(r);return Ya(c,vt(o,0,c.length))}function Do(r,o,c,f){if(!Bt(r))return r;for(var v=-1,T=(o=zi(o,r)).length,M=T-1,N=r;null!=N&&++v<T;){var Q=Si(o[v]),xe=c;if("__proto__"===Q||"constructor"===Q||"prototype"===Q)return r;if(v!=M){var ve=N[Q];(xe=f?f(ve,Q,N):u)===u&&(xe=Bt(ve)?ve:Vi(o[v+1])?[]:{})}To(N,Q,xe),N=N[Q]}return r}var Oc=hi?function(r,o){return hi.set(r,o),r}:Ln,Ts=ct?function(r,o){return ct(r,"toString",{configurable:!0,enumerable:!1,value:ea(o),writable:!0})}:Ln;function Br(r){return Ya(Er(r))}function ti(r,o,c){var f=-1,v=r.length;o<0&&(o=-o>v?0:v+o),(c=c>v?v:c)<0&&(c+=v),v=o>c?0:c-o>>>0,o>>>=0;for(var T=se(v);++f<v;)T[f]=r[f+o];return T}function Ur(r,o){var c;return Bi(r,function(f,v,T){return!(c=o(f,v,T))}),!!c}function Ro(r,o,c){var f=0,v=null==r?f:r.length;if("number"==typeof o&&o==o&&v<=2147483647){for(;f<v;){var T=f+v>>>1,M=r[T];null!==M&&!Un(M)&&(c?M<=o:M<o)?f=T+1:v=T}return v}return xr(r,o,Ln,c)}function xr(r,o,c,f){var v=0,T=null==r?0:r.length;if(0===T)return 0;for(var M=(o=c(o))!=o,N=null===o,Q=Un(o),xe=o===u;v<T;){var ve=ar((v+T)/2),Te=c(r[ve]),Ge=Te!==u,tt=null===Te,ot=Te==Te,Ot=Un(Te);if(M)var lt=f||ot;else lt=xe?ot&&(f||Ge):N?ot&&Ge&&(f||!tt):Q?ot&&Ge&&!tt&&(f||!Ot):!tt&&!Ot&&(f?Te<=o:Te<o);lt?v=ve+1:T=ve}return sn(T,4294967294)}function Tc(r,o){for(var c=-1,f=r.length,v=0,T=[];++c<f;){var M=r[c],N=o?o(M):M;if(!c||!ni(N,Q)){var Q=N;T[v++]=0===M?0:M}}return T}function Ac(r){return"number"==typeof r?r:Un(r)?NaN:+r}function In(r){if("string"==typeof r)return r;if(_t(r))return Ft(r,In)+"";if(Un(r))return ur?ur.call(r):"";var o=r+"";return"0"==o&&1/r==-oe?"-0":o}function vr(r,o,c){var f=-1,v=ma,T=r.length,M=!0,N=[],Q=N;if(c)M=!1,v=cs;else if(T>=200){var xe=o?null:Ip(r);if(xe)return bi(xe);M=!1,v=tr,Q=new pi}else Q=o?[]:N;e:for(;++f<T;){var ve=r[f],Te=o?o(ve):ve;if(ve=c||0!==ve?ve:0,M&&Te==Te){for(var Ge=Q.length;Ge--;)if(Q[Ge]===Te)continue e;o&&Q.push(Te),N.push(ve)}else v(Q,Te,c)||(Q!==N&&Q.push(Te),N.push(ve))}return N}function Ic(r,o){return null==(r=Md(r,o=zi(o,r)))||delete r[Si(bn(o))]}function Wt(r,o,c,f){return Do(r,o,c(ai(r,o)),f)}function zr(r,o,c,f){for(var v=r.length,T=f?v:-1;(f?T--:++T<v)&&o(r[T],T,r););return c?ti(r,f?0:T,f?T+1:v):ti(r,f?T+1:0,f?v:T)}function Lo(r,o){var c=r;return c instanceof ut&&(c=c.value()),ao(o,function(f,v){return v.func.apply(v.thisArg,ui([f],v.args))},c)}function ja(r,o,c){var f=r.length;if(f<2)return f?vr(r[0]):[];for(var v=-1,T=se(f);++v<f;)for(var M=r[v],N=-1;++N<f;)N!=v&&(T[v]=ws(T[v]||M,r[N],o,c));return vr(Tn(T,1),o,c)}function md(r,o,c){for(var f=-1,v=r.length,T=o.length,M={};++f<v;)c(M,r[f],f<T?o[f]:u);return M}function Zr(r){return dn(r)?r:[]}function Ec(r){return"function"==typeof r?r:Ln}function zi(r,o){return _t(r)?r:Sn(r,o)?[r]:zc(Dt(r))}var As=Ct;function kn(r,o,c){var f=r.length;return c=c===u?f:c,!o&&c>=f?r:ti(r,o,c)}var Sc=_s||function(r){return $t.clearTimeout(r)};function Mc(r,o){if(o)return r.slice();var c=r.length,f=Kh?Kh(c):new r.constructor(c);return r.copy(f),f}function Ba(r){var o=new r.constructor(r.byteLength);return new wa(o).set(new wa(r)),o}function hn(r,o){var c=o?Ba(r.buffer):r.buffer;return new r.constructor(c,r.byteOffset,r.length)}function Et(r,o){if(r!==o){var c=r!==u,f=null===r,v=r==r,T=Un(r),M=o!==u,N=null===o,Q=o==o,xe=Un(o);if(!N&&!xe&&!T&&r>o||T&&M&&Q&&!N&&!xe||f&&M&&Q||!c&&Q||!v)return 1;if(!f&&!T&&!xe&&r<o||xe&&c&&v&&!f&&!T||N&&c&&v||!M&&v||!Q)return-1}return 0}function kc(r,o,c,f){for(var v=-1,T=r.length,M=c.length,N=-1,Q=o.length,xe=cn(T-M,0),ve=se(Q+xe),Te=!f;++N<Q;)ve[N]=o[N];for(;++v<M;)(Te||v<T)&&(ve[c[v]]=r[v]);for(;xe--;)ve[N++]=r[v++];return ve}function Zi(r,o,c,f){for(var v=-1,T=r.length,M=-1,N=c.length,Q=-1,xe=o.length,ve=cn(T-N,0),Te=se(ve+xe),Ge=!f;++v<ve;)Te[v]=r[v];for(var tt=v;++Q<xe;)Te[tt+Q]=o[Q];for(;++M<N;)(Ge||v<T)&&(Te[tt+c[M]]=r[v++]);return Te}function Jn(r,o){var c=-1,f=r.length;for(o||(o=se(f));++c<f;)o[c]=r[c];return o}function en(r,o,c,f){var v=!c;c||(c={});for(var T=-1,M=o.length;++T<M;){var N=o[T],Q=f?f(c[N],r[N],N,c,r):u;Q===u&&(Q=r[N]),v?Ti(c,N,Q):To(c,N,Q)}return c}function No(r,o){return function(c,f){var v=_t(c)?Fh:rd,T=o?o():{};return v(c,r,st(f,2),T)}}function Bn(r){return Ct(function(o,c){var f=-1,v=c.length,T=v>1?c[v-1]:u,M=v>2?c[2]:u;for(T=r.length>3&&"function"==typeof T?(v--,T):u,M&&Dn(c[0],c[1],M)&&(T=v<3?u:T,v=1),o=mt(o);++f<v;){var N=c[f];N&&r(o,N,f,T)}return o})}function Dc(r,o){return function(c,f){if(null==c)return c;if(!$n(c))return r(c,f);for(var v=c.length,T=o?v:-1,M=mt(c);(o?T--:++T<v)&&!1!==f(M[T],T,M););return c}}function Es(r){return function(o,c,f){for(var v=-1,T=mt(o),M=f(o),N=M.length;N--;){var Q=M[r?N:++v];if(!1===c(T[Q],Q,T))break}return o}}function vd(r){return function(o){var c=nr(o=Dt(o))?Wn(o):u,f=c?c[0]:o.charAt(0),v=c?kn(c,1).join(""):o.slice(1);return f[r]()+v}}function ft(r){return function(o){return ao(ih(Ol(o).replace(Mh,"")),r,"")}}function qo(r){return function(){var o=arguments;switch(o.length){case 0:return new r;case 1:return new r(o[0]);case 2:return new r(o[0],o[1]);case 3:return new r(o[0],o[1],o[2]);case 4:return new r(o[0],o[1],o[2],o[3]);case 5:return new r(o[0],o[1],o[2],o[3],o[4]);case 6:return new r(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new r(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var c=hr(r.prototype),f=r.apply(c,o);return Bt(f)?f:c}}function Ss(r){return function(o,c,f){var v=mt(o);if(!$n(o)){var T=st(c,3);o=On(o),c=function(N){return T(v[N],N,v)}}var M=r(o,c,f);return M>-1?v[T?o[M]:M]:u}}function Ms(r){return mi(function(o){var c=o.length,f=c,v=oi.prototype.thru;for(r&&o.reverse();f--;){var T=o[f];if("function"!=typeof T)throw new Kn(m);if(v&&!M&&"wrapper"==Uo(T))var M=new oi([],!0)}for(f=M?f:c;++f<c;){var N=Uo(T=o[f]),Q="wrapper"==N?Wa(T):u;M=Q&&$a(Q[0])&&424==Q[1]&&!Q[4].length&&1==Q[9]?M[Uo(Q[0])].apply(M,Q[3]):1==T.length&&$a(T)?M[N]():M.thru(T)}return function(){var xe=arguments,ve=xe[0];if(M&&1==xe.length&&_t(ve))return M.plant(ve).value();for(var Te=0,Ge=c?o[Te].apply(this,xe):ve;++Te<c;)Ge=o[Te].call(this,Ge);return Ge}})}function Qr(r,o,c,f,v,T,M,N,Q,xe){var ve=128&o,Te=1&o,Ge=2&o,tt=24&o,ot=512&o,Ot=Ge?u:qo(r);return function lt(){for(var Tt=arguments.length,Mt=se(Tt),zn=Tt;zn--;)Mt[zn]=arguments[zn];if(tt)var Zn=Gr(lt),li=function dp(z,he){for(var se=z.length,Ye=0;se--;)z[se]===he&&++Ye;return Ye}(Mt,Zn);if(f&&(Mt=kc(Mt,f,v,tt)),T&&(Mt=Zi(Mt,T,M,tt)),Tt-=li,tt&&Tt<xe){var gt=Ni(Mt,Zn);return wd(r,o,Qr,lt.placeholder,c,Mt,gt,N,Q,xe-Tt)}var Pi=Te?c:this,yi=Ge?Pi[r]:r;return Tt=Mt.length,N?Mt=function Fp(r,o){for(var c=r.length,f=sn(o.length,c),v=Jn(r);f--;){var T=o[f];r[f]=Vi(T,c)?v[T]:u}return r}(Mt,N):ot&&Tt>1&&Mt.reverse(),ve&&Q<Tt&&(Mt.length=Q),this&&this!==$t&&this instanceof lt&&(yi=Ot||qo(yi)),yi.apply(Pi,Mt)}}function Rc(r,o){return function(c,f){return function ei(r,o,c,f){return gi(r,function(v,T,M){o(f,c(v),T,M)}),f}(c,r,o(f),{})}}function jo(r,o){return function(c,f){var v;if(c===u&&f===u)return o;if(c!==u&&(v=c),f!==u){if(v===u)return f;"string"==typeof c||"string"==typeof f?(c=In(c),f=In(f)):(c=Ac(c),f=Ac(f)),v=r(c,f)}return v}}function za(r){return mi(function(o){return o=Ft(o,Vn(st())),Ct(function(c){var f=this;return r(o,function(v){return qn(v,f,c)})})})}function Za(r,o){var c=(o=o===u?" ":In(o)).length;if(c<2)return c?Na(o,r):o;var f=Na(o,et(r/Dr(o)));return nr(o)?kn(Wn(f),0,r).join(""):f.slice(0,r)}function Lc(r){return function(o,c,f){return f&&"number"!=typeof f&&Dn(o,c,f)&&(c=f=u),o=Ki(o),c===u?(c=o,o=0):c=Ki(c),function gd(r,o,c,f){for(var v=-1,T=cn(et((o-r)/(c||1)),0),M=se(T);T--;)M[f?T:++v]=r,r+=c;return M}(o,c,f=f===u?o<c?1:-1:Ki(f),r)}}function Qa(r){return function(o,c){return"string"==typeof o&&"string"==typeof c||(o=ri(o),c=ri(c)),r(o,c)}}function wd(r,o,c,f,v,T,M,N,Q,xe){var ve=8&o;o|=ve?32:64,4&(o&=~(ve?64:32))||(o&=-4);var Ot=[r,o,v,ve?T:u,ve?M:u,ve?u:T,ve?u:M,N,Q,xe],lt=c.apply(u,Ot);return $a(r)&&Pd(lt,Ot),lt.placeholder=f,kd(lt,r,o)}function Fc(r){var o=mn[r];return function(c,f){if(c=ri(c),(f=null==f?0:sn(yt(f),292))&&rn(c)){var v=(Dt(c)+"e").split("e");return+((v=(Dt(o(v[0]+"e"+(+v[1]+f)))+"e").split("e"))[0]+"e"+(+v[1]-f))}return o(c)}}var Ip=lr&&1/bi(new lr([,-0]))[1]==oe?function(r){return new lr(r)}:Al;function Vr(r){return function(o){var c=En(o);return c==q?fs(o):c==S?function Zh(z){var he=-1,se=Array(z.size);return z.forEach(function(Ye){se[++he]=[Ye,Ye]}),se}(o):function rc(z,he){return Ft(he,function(se){return[se,z[se]]})}(o,r(o))}}function Ai(r,o,c,f,v,T,M,N){var Q=2&o;if(!Q&&"function"!=typeof r)throw new Kn(m);var xe=f?f.length:0;if(xe||(o&=-97,f=v=u),M=M===u?M:cn(yt(M),0),N=N===u?N:yt(N),xe-=v?v.length:0,64&o){var ve=f,Te=v;f=v=u}var Ge=Q?u:Wa(r),tt=[r,o,c,f,v,ve,Te,T,M,N];if(Ge&&function Dp(r,o){var c=r[1],f=o[1],v=c|f;if(!(v<131)&&!(128==f&&8==c||128==f&&256==c&&r[7].length<=o[8]||384==f&&o[7].length<=o[8]&&8==c))return r;1&f&&(r[2]=o[2],v|=1&c?0:4);var N=o[3];if(N){var Q=r[3];r[3]=Q?kc(Q,N,o[4]):N,r[4]=Q?Ni(r[3],E):o[4]}(N=o[5])&&(r[5]=(Q=r[5])?Zi(Q,N,o[6]):N,r[6]=Q?Ni(r[5],E):o[6]),(N=o[7])&&(r[7]=N),128&f&&(r[8]=null==r[8]?o[8]:sn(r[8],o[8])),null==r[9]&&(r[9]=o[9]),r[0]=o[0],r[1]=v}(tt,Ge),r=tt[0],o=tt[1],c=tt[2],f=tt[3],v=tt[4],!(N=tt[9]=tt[9]===u?Q?0:r.length:cn(tt[9]-xe,0))&&24&o&&(o&=-25),o&&1!=o)ot=8==o||16==o?function Ua(r,o,c){var f=qo(r);return function v(){for(var T=arguments.length,M=se(T),N=T,Q=Gr(v);N--;)M[N]=arguments[N];var xe=T<3&&M[0]!==Q&&M[T-1]!==Q?[]:Ni(M,Q);return(T-=xe.length)<c?wd(r,o,Qr,v.placeholder,u,M,xe,u,u,c-T):qn(this&&this!==$t&&this instanceof v?f:r,this,M)}}(r,o,N):32!=o&&33!=o||v.length?Qr.apply(u,tt):function yd(r,o,c,f){var v=1&o,T=qo(r);return function M(){for(var N=-1,Q=arguments.length,xe=-1,ve=f.length,Te=se(ve+Q),Ge=this&&this!==$t&&this instanceof M?T:r;++xe<ve;)Te[xe]=f[xe];for(;Q--;)Te[xe++]=arguments[++N];return qn(Ge,v?c:this,Te)}}(r,o,c,f);else var ot=function Ap(r,o,c){var f=1&o,v=qo(r);return function T(){return(this&&this!==$t&&this instanceof T?v:r).apply(f?c:this,arguments)}}(r,o,c);return kd((Ge?Oc:Pd)(ot,tt),r,o)}function bd(r,o,c,f){return r===u||ni(r,Zt[c])&&!Le.call(f,c)?o:r}function an(r,o,c,f,v,T){return Bt(r)&&Bt(o)&&(T.set(o,r),yn(r,o,u,an,T),T.delete(o)),r}function Nc(r){return ii(r)?u:r}function qc(r,o,c,f,v,T){var M=1&c,N=r.length,Q=o.length;if(N!=Q&&!(M&&Q>N))return!1;var xe=T.get(r),ve=T.get(o);if(xe&&ve)return xe==o&&ve==r;var Te=-1,Ge=!0,tt=2&c?new pi:u;for(T.set(r,o),T.set(o,r);++Te<N;){var ot=r[Te],Ot=o[Te];if(f)var lt=M?f(Ot,ot,Te,o,r,T):f(ot,Ot,Te,r,o,T);if(lt!==u){if(lt)continue;Ge=!1;break}if(tt){if(!kr(o,function(Tt,Mt){if(!tr(tt,Mt)&&(ot===Tt||v(ot,Tt,c,f,T)))return tt.push(Mt)})){Ge=!1;break}}else if(ot!==Ot&&!v(ot,Ot,c,f,T)){Ge=!1;break}}return T.delete(r),T.delete(o),Ge}function mi(r){return Uc(Sd(r,u,Ds),r+"")}function Va(r){return cd(r,On,Ka)}function Wr(r){return cd(r,Yn,Ja)}var Wa=hi?function(r){return hi.get(r)}:Al;function Uo(r){for(var o=r.name+"",c=cr[o],f=Le.call(cr,o)?c.length:0;f--;){var v=c[f],T=v.func;if(null==T||T==r)return v.name}return o}function Gr(r){return(Le.call(C,"placeholder")?C:r).placeholder}function st(){var r=C.iteratee||oh;return r=r===oh?vc:r,arguments.length?r(arguments[0],arguments[1]):r}function Ga(r,o){var c=r.__data__;return function Pp(r){var o=typeof r;return"string"==o||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==r:null===r}(o)?c["string"==typeof o?"string":"hash"]:c.map}function Kr(r){for(var o=On(r),c=o.length;c--;){var f=o[c],v=r[f];o[c]=[f,v,jc(v)]}return o}function Qi(r,o){var c=function Uh(z,he){return null==z?u:z[he]}(r,o);return So(c)?c:u}var Ka=At?function(r){return null==r?[]:(r=mt(r),er(At(r),function(o){return cc.call(r,o)}))}:tn,Ja=At?function(r){for(var o=[];r;)ui(o,Ka(r)),r=ba(r);return o}:tn,En=It;function Od(r,o,c){for(var f=-1,v=(o=zi(o,r)).length,T=!1;++f<v;){var M=Si(o[f]);if(!(T=null!=r&&c(r,M)))break;r=r[M]}return T||++f!=v?T:!!(v=null==r?0:r.length)&&ml(v)&&Vi(M,v)&&(_t(r)||es(r))}function Td(r){return"function"!=typeof r.constructor||yr(r)?{}:hr(ba(r))}function Ad(r){return _t(r)||es(r)||!!(mp&&r&&r[mp])}function Vi(r,o){var c=typeof r;return!!(o=o??pe)&&("number"==c||"symbol"!=c&&yh.test(r))&&r>-1&&r%1==0&&r<o}function Dn(r,o,c){if(!Bt(c))return!1;var f=typeof o;return!!("number"==f?$n(c)&&Vi(o,c.length):"string"==f&&o in c)&&ni(c[o],r)}function Sn(r,o){if(_t(r))return!1;var c=typeof r;return!("number"!=c&&"symbol"!=c&&"boolean"!=c&&null!=r&&!Un(r))||is.test(r)||!Ks.test(r)||null!=o&&r in mt(o)}function $a(r){var o=Uo(r),c=C[o];if("function"!=typeof c||!(o in ut.prototype))return!1;if(r===c)return!0;var f=Wa(c);return!!f&&r===f[0]}(Aa&&En(new Aa(new ArrayBuffer(1)))!=Ce||xs&&En(new xs)!=q||jn&&En(jn.resolve())!=k||lr&&En(new lr)!=S||vs&&En(new vs)!=J)&&(En=function(r){var o=It(r),c=o==ze?r.constructor:u,f=c?wr(c):"";if(f)switch(f){case te:return Ce;case Ia:return q;case di:return k;case vp:return S;case _o:return J}return o});var Id=qi?vi:vn;function yr(r){var o=r&&r.constructor;return r===("function"==typeof o&&o.prototype||Zt)}function jc(r){return r==r&&!Bt(r)}function Ed(r,o){return function(c){return null!=c&&c[r]===o&&(o!==u||r in mt(c))}}function Sd(r,o,c){return o=cn(o===u?r.length-1:o,0),function(){for(var f=arguments,v=-1,T=cn(f.length-o,0),M=se(T);++v<T;)M[v]=f[o+v];v=-1;for(var N=se(o+1);++v<o;)N[v]=f[v];return N[o]=c(M),qn(r,this,N)}}function Md(r,o){return o.length<2?r:ai(r,ti(o,0,-1))}function Bc(r,o){if(("constructor"!==o||"function"!=typeof r[o])&&"__proto__"!=o)return r[o]}var Pd=Dd(Oc),zo=Xt||function(r,o){return $t.setTimeout(r,o)},Uc=Dd(Ts);function kd(r,o,c){var f=o+"";return Uc(r,function ks(r,o){var c=o.length;if(!c)return r;var f=c-1;return o[f]=(c>1?"& ":"")+o[f],o=o.join(c>2?", ":" "),r.replace(Hf,"{\n/* [wrapped with "+o+"] */\n")}(f,function Rd(r,o){return Hn(wt,function(c){var f="_."+c[0];o&c[1]&&!ma(r,f)&&r.push(f)}),r.sort()}(function Cd(r){var o=r.match(Ll);return o?o[1].split(_h):[]}(f),c)))}function Dd(r){var o=0,c=0;return function(){var f=xp(),v=16-(f-c);if(c=f,v>0){if(++o>=800)return arguments[0]}else o=0;return r.apply(u,arguments)}}function Ya(r,o){var c=-1,f=r.length,v=f-1;for(o=o===u?f:o;++c<o;){var T=Cc(c,v),M=r[T];r[T]=r[c],r[c]=M}return r.length=o,r}var zc=function kp(r){var o=Wi(r,function(f){return 500===c.size&&c.clear(),f}),c=o.cache;return o}(function(r){var o=[];return 46===r.charCodeAt(0)&&o.push(""),r.replace(rs,function(c,f,v,T){o.push(v?T.replace(Fl,"$1"):f||c)}),o});function Si(r){if("string"==typeof r||Un(r))return r;var o=r+"";return"0"==o&&1/r==-oe?"-0":o}function wr(r){if(null!=r){try{return ms.call(r)}catch{}try{return r+""}catch{}}return""}function Ld(r){if(r instanceof ut)return r.clone();var o=new oi(r.__wrapped__,r.__chain__);return o.__actions__=Jn(r.__actions__),o.__index__=r.__index__,o.__values__=r.__values__,o}var Vc=Ct(function(r,o){return dn(r)?ws(r,Tn(o,1,dn,!0)):[]}),Wc=Ct(function(r,o){var c=bn(o);return dn(c)&&(c=u),dn(r)?ws(r,Tn(o,1,dn,!0),st(c,2)):[]}),br=Ct(function(r,o){var c=bn(o);return dn(c)&&(c=u),dn(r)?ws(r,Tn(o,1,dn,!0),u,c):[]});function Cr(r,o,c){var f=null==r?0:r.length;if(!f)return-1;var v=null==c?0:yt(c);return v<0&&(v=cn(f+v,0)),_a(r,st(o,3),v)}function Or(r,o,c){var f=null==r?0:r.length;if(!f)return-1;var v=f-1;return c!==u&&(v=yt(c),v=c<0?cn(f+v,0):sn(v,f-1)),_a(r,st(o,3),v,!0)}function Ds(r){return null!=r&&r.length?Tn(r,1):[]}function Jc(r){return r&&r.length?r[0]:u}var Bd=Ct(function(r){var o=Ft(r,Zr);return o.length&&o[0]===r[0]?gr(o):[]}),Ud=Ct(function(r){var o=bn(r),c=Ft(r,Zr);return o===bn(c)?o=u:c.pop(),c.length&&c[0]===r[0]?gr(c,st(o,2)):[]}),Xa=Ct(function(r){var o=bn(r),c=Ft(r,Zr);return(o="function"==typeof o?o:u)&&c.pop(),c.length&&c[0]===r[0]?gr(c,u,o):[]});function bn(r){var o=null==r?0:r.length;return o?r[o-1]:u}var Bp=Ct(Zd);function Zd(r,o){return r&&r.length&&o&&o.length?Fa(r,o):r}var $r=mi(function(r,o){var c=null==r?0:r.length,f=Ma(r,o);return bc(r,Ft(o,function(v){return Vi(v,c)?+v:v}).sort(Et)),f});function el(r){return null==r?r:go.call(r)}var Gd=Ct(function(r){return vr(Tn(r,1,dn,!0))}),Vo=Ct(function(r){var o=bn(r);return dn(o)&&(o=u),vr(Tn(r,1,dn,!0),st(o,2))}),il=Ct(function(r){var o=bn(r);return o="function"==typeof o?o:u,vr(Tn(r,1,dn,!0),u,o)});function Rn(r){if(!r||!r.length)return[];var o=0;return r=er(r,function(c){if(dn(c))return o=cn(c.length,o),!0}),ya(o,function(c){return Ft(r,xa(c))})}function tu(r,o){if(!r||!r.length)return[];var c=Rn(r);return null==o?c:Ft(c,function(f){return qn(o,u,f)})}var rl=Ct(function(r,o){return dn(r)?ws(r,o):[]}),sl=Ct(function(r){return ja(er(r,dn))}),$d=Ct(function(r){var o=bn(r);return dn(o)&&(o=u),ja(er(r,dn),st(o,2))}),Ar=Ct(function(r){var o=bn(r);return o="function"==typeof o?o:u,ja(er(r,dn),u,o)}),Rs=Ct(Rn),Wp=Ct(function(r){var o=r.length,c=o>1?r[o-1]:u;return c="function"==typeof c?(r.pop(),c):u,tu(r,c)});function Hr(r){var o=C(r);return o.__chain__=!0,o}function _i(r,o){return o(r)}var Xd=mi(function(r){var o=r.length,c=o?r[0]:0,f=this.__wrapped__,v=function(T){return Ma(T,r)};return!(o>1||this.__actions__.length)&&f instanceof ut&&Vi(c)?((f=f.slice(c,+c+(o?1:0))).__actions__.push({func:_i,args:[v],thisArg:u}),new oi(f,this.__chain__).thru(function(T){return o&&!T.length&&T.push(u),T})):this.thru(v)}),ef=No(function(r,o,c){Le.call(r,c)?++r[c]:Ti(r,c,1)}),Xr=Ss(Cr),Go=Ss(Or);function nu(r,o){return(_t(r)?Hn:Bi)(r,st(o,3))}function sf(r,o){return(_t(r)?Xl:mc)(r,st(o,3))}var tg=No(function(r,o,c){Le.call(r,c)?r[c].push(o):Ti(r,c,[o])}),Cn=Ct(function(r,o,c){var f=-1,v="function"==typeof o,T=$n(r)?se(r.length):[];return Bi(r,function(M){T[++f]=v?qn(o,M,c):un(M,o,c)}),T}),ng=No(function(r,o,c){Ti(r,c,o)});function al(r,o){return(_t(r)?Ft:Po)(r,st(o,3))}var rg=No(function(r,o,c){r[c?0:1].push(o)},function(){return[[],[]]}),cl=Ct(function(r,o){if(null==r)return[];var c=o.length;return c>1&&Dn(r,o[0],o[1])?o=[]:c>2&&Dn(o[0],o[1],o[2])&&(o=[o[0]]),Os(r,Tn(o,1),[])}),Ls=$h||function(){return $t.Date.now()};function au(r,o,c){return o=c?u:o,Ai(r,128,u,u,u,u,o=r&&null==o?r.length:o)}function lf(r,o){var c;if("function"!=typeof o)throw new Kn(m);return r=yt(r),function(){return--r>0&&(c=o.apply(this,arguments)),r<=1&&(o=u),c}}var ul=Ct(function(r,o,c){var f=1;if(c.length){var v=Ni(c,Gr(ul));f|=32}return Ai(r,f,o,c,v)}),lu=Ct(function(r,o,c){var f=3;if(c.length){var v=Ni(c,Gr(lu));f|=32}return Ai(o,f,r,c,v)});function cu(r,o,c){var f,v,T,M,N,Q,xe=0,ve=!1,Te=!1,Ge=!0;if("function"!=typeof r)throw new Kn(m);function tt(gt){var Pi=f,yi=v;return f=v=u,xe=gt,M=r.apply(yi,Pi)}function lt(gt){var Pi=gt-Q;return Q===u||Pi>=o||Pi<0||Te&&gt-xe>=T}function Tt(){var gt=Ls();if(lt(gt))return Mt(gt);N=zo(Tt,function Ot(gt){var fn=o-(gt-Q);return Te?sn(fn,T-(gt-xe)):fn}(gt))}function Mt(gt){return N=u,Ge&&f?tt(gt):(f=v=u,M)}function li(){var gt=Ls(),Pi=lt(gt);if(f=arguments,v=this,Q=gt,Pi){if(N===u)return function ot(gt){return xe=gt,N=zo(Tt,o),ve?tt(gt):M}(Q);if(Te)return Sc(N),N=zo(Tt,o),tt(Q)}return N===u&&(N=zo(Tt,o)),M}return o=ri(o)||0,Bt(c)&&(ve=!!c.leading,T=(Te="maxWait"in c)?cn(ri(c.maxWait)||0,o):T,Ge="trailing"in c?!!c.trailing:Ge),li.cancel=function zn(){N!==u&&Sc(N),xe=0,f=Q=v=N=u},li.flush=function Zn(){return N===u?M:Mt(Ls())},li}var ag=Ct(function(r,o){return gc(r,1,o)}),uf=Ct(function(r,o,c){return gc(r,ri(o)||0,c)});function Wi(r,o){if("function"!=typeof r||null!=o&&"function"!=typeof o)throw new Kn(m);var c=function(){var f=arguments,v=o?o.apply(this,f):f[0],T=c.cache;if(T.has(v))return T.get(v);var M=r.apply(this,f);return c.cache=T.set(v,M)||T,M};return c.cache=new(Wi.Cache||Ci),c}function Gi(r){if("function"!=typeof r)throw new Kn(m);return function(){var o=arguments;switch(o.length){case 0:return!r.call(this);case 1:return!r.call(this,o[0]);case 2:return!r.call(this,o[0],o[1]);case 3:return!r.call(this,o[0],o[1],o[2])}return!r.apply(this,o)}}Wi.Cache=Ci;var dl=As(function(r,o){var c=(o=1==o.length&&_t(o[0])?Ft(o[0],Vn(st())):Ft(Tn(o,1),Vn(st()))).length;return Ct(function(f){for(var v=-1,T=sn(f.length,c);++v<T;)f[v]=o[v].call(this,f[v]);return qn(r,this,f)})}),fl=Ct(function(r,o){var c=Ni(o,Gr(fl));return Ai(r,32,u,o,c)}),hu=Ct(function(r,o){var c=Ni(o,Gr(hu));return Ai(r,64,u,o,c)}),hf=mi(function(r,o){return Ai(r,256,u,u,u,o)});function ni(r,o){return r===o||r!=r&&o!=o}var mu=Qa(bs),pf=Qa(function(r,o){return r>=o}),es=xc(function(){return arguments}())?xc:function(r){return Yt(r)&&Le.call(r,"callee")&&!cc.call(r,"callee")},_t=se.isArray,hg=Rh?Vn(Rh):function Vt(r){return Yt(r)&&It(r)==je};function $n(r){return null!=r&&ml(r.length)&&!vi(r)}function dn(r){return Yt(r)&&$n(r)}var xi=_p||vn,$o=$l?Vn($l):function Cp(r){return Yt(r)&&It(r)==$};function xu(r){if(!Yt(r))return!1;var o=It(r);return o==ee||"[object DOMException]"==o||"string"==typeof r.message&&"string"==typeof r.name&&!ii(r)}function vi(r){if(!Bt(r))return!1;var o=It(r);return o==Pe||o==K||"[object AsyncFunction]"==o||"[object Proxy]"==o}function _f(r){return"number"==typeof r&&r==yt(r)}function ml(r){return"number"==typeof r&&r>-1&&r%1==0&&r<=pe}function Bt(r){var o=typeof r;return null!=r&&("object"==o||"function"==o)}function Yt(r){return null!=r&&"object"==typeof r}var ts=Lh?Vn(Lh):function Eo(r){return Yt(r)&&En(r)==q};function xl(r){return"number"==typeof r||Yt(r)&&It(r)==ie}function ii(r){if(!Yt(r)||It(r)!=ze)return!1;var o=ba(r);if(null===o)return!0;var c=Le.call(o,"constructor")&&o.constructor;return"function"==typeof c&&c instanceof c&&ms.call(c)==re}var vl=Yl?Vn(Yl):function hd(r){return Yt(r)&&It(r)==y},yl=Hl?Vn(Hl):function dd(r){return Yt(r)&&En(r)==S};function wl(r){return"string"==typeof r||!_t(r)&&Yt(r)&&It(r)==D}function Un(r){return"symbol"==typeof r||Yt(r)&&It(r)==j}var Fs=ga?Vn(ga):function Ui(r){return Yt(r)&&ml(r.length)&&!!Lt[It(r)]},vf=Qa(Mo),Ns=Qa(function(r,o){return r<=o});function Cl(r){if(!r)return[];if($n(r))return wl(r)?Wn(r):Jn(r);if(po&&r[po])return function zh(z){for(var he,se=[];!(he=z.next()).done;)se.push(he.value);return se}(r[po]());var o=En(r);return(o==q?fs:o==S?bi:Er)(r)}function Ki(r){return r?(r=ri(r))===oe||r===-oe?17976931348623157e292*(r<0?-1:1):r==r?r:0:0===r?r:0}function yt(r){var o=Ki(r),c=o%1;return o==o?c?o-c:o:0}function Ou(r){return r?vt(yt(r),0,Je):0}function ri(r){if("number"==typeof r)return r;if(Un(r))return NaN;if(Bt(r)){var o="function"==typeof r.valueOf?r.valueOf():r;r=Bt(o)?o+"":o}if("string"!=typeof r)return 0===r?r:+r;r=ds(r);var c=$s.test(r);return c||vh.test(r)?cp(r.slice(2),c?2:8):ep.test(r)?NaN:+r}function yf(r){return en(r,Yn(r))}function Dt(r){return null==r?"":In(r)}var Au=Bn(function(r,o){if(yr(o)||$n(o))en(o,On(o),r);else for(var c in o)Le.call(o,c)&&To(r,c,o[c])}),wf=Bn(function(r,o){en(o,Yn(o),r)}),qs=Bn(function(r,o,c,f){en(o,Yn(o),r,f)}),mg=Bn(function(r,o,c,f){en(o,On(o),r,f)}),Iu=mi(Ma),Eu=Ct(function(r,o){r=mt(r);var c=-1,f=o.length,v=f>2?o[2]:u;for(v&&Dn(o[0],o[1],v)&&(f=1);++c<f;)for(var T=o[c],M=Yn(T),N=-1,Q=M.length;++N<Q;){var xe=M[N],ve=r[xe];(ve===u||ni(ve,Zt[xe])&&!Le.call(r,xe))&&(r[xe]=T[xe])}return r}),Su=Ct(function(r){return r.push(u,an),qn(qu,u,r)});function ku(r,o,c){var f=null==r?u:ai(r,o);return f===u?c:f}function Ho(r,o){return null!=r&&Od(r,o,Nt)}var Du=Rc(function(r,o,c){null!=o&&"function"!=typeof o.toString&&(o=Qe.call(o)),r[o]=c},ea(Ln)),Ru=Rc(function(r,o,c){null!=o&&"function"!=typeof o.toString&&(o=Qe.call(o)),Le.call(r,o)?r[o].push(c):r[o]=[c]},st),Lu=Ct(un);function On(r){return $n(r)?fc(r):mr(r)}function Yn(r){return $n(r)?fc(r,!0):function fd(r){if(!Bt(r))return function Rp(r){var o=[];if(null!=r)for(var c in mt(r))o.push(c);return o}(r);var o=yr(r),c=[];for(var f in r)"constructor"==f&&(o||!Le.call(r,f))||c.push(f);return c}(r)}var xg=Bn(function(r,o,c){yn(r,o,c)}),qu=Bn(function(r,o,c,f){yn(r,o,c,f)}),vg=mi(function(r,o){var c={};if(null==r)return c;var f=!1;o=Ft(o,function(T){return T=zi(T,r),f||(f=T.length>1),T}),en(r,Wr(r),c),f&&(c=bt(c,7,Nc));for(var v=o.length;v--;)Ic(c,o[v]);return c}),Tf=mi(function(r,o){return null==r?{}:function pd(r,o){return La(r,o,function(c,f){return Ho(r,f)})}(r,o)});function ju(r,o){if(null==r)return{};var c=Ft(Wr(r),function(f){return[f]});return o=st(o),La(r,c,function(f,v){return o(f,v[0])})}var If=Vr(On),Ef=Vr(Yn);function Er(r){return null==r?[]:co(r,On(r))}var Mf=ft(function(r,o,c){return o=o.toLowerCase(),r+(c?Pf(o):o)});function Pf(r){return Xo(Dt(r).toLowerCase())}function Ol(r){return(r=Dt(r))&&r.replace(ca,jh).replace(sp,"")}var Wu=ft(function(r,o,c){return r+(c?"-":"")+o.toLowerCase()}),Ag=ft(function(r,o,c){return r+(c?" ":"")+o.toLowerCase()}),Gu=vd("toLowerCase"),Yu=ft(function(r,o,c){return r+(c?"_":"")+o.toLowerCase()}),Hu=ft(function(r,o,c){return r+(c?" ":"")+Xo(o)}),Dg=ft(function(r,o,c){return r+(c?" ":"")+o.toUpperCase()}),Xo=vd("toUpperCase");function ih(r,o,c){return r=Dt(r),(o=c?u:o)===u?function oc(z){return pa.test(z)}(r)?function fp(z){return z.match(Li)||[]}(r):function nn(z){return z.match(Xf)||[]}(r):r.match(o)||[]}var Tl=Ct(function(r,o){try{return qn(r,u,o)}catch(c){return xu(c)?c:new dt(c)}}),Df=mi(function(r,o){return Hn(o,function(c){c=Si(c),Ti(r,c,ul(r[c],r))}),r});function ea(r){return function(){return r}}var rh=Ms(),sh=Ms(!0);function Ln(r){return r}function oh(r){return vc("function"==typeof r?r:bt(r,1))}var jg=Ct(function(r,o){return function(c){return un(c,r,o)}}),ah=Ct(function(r,o){return function(c){return un(r,c,o)}});function ta(r,o,c){var f=On(o),v=Da(o,f);null==c&&(!Bt(o)||!v.length&&f.length)&&(c=o,o=r,r=this,v=Da(o,On(o)));var T=!(Bt(c)&&"chain"in c&&!c.chain),M=vi(r);return Hn(v,function(N){var Q=o[N];r[N]=Q,M&&(r.prototype[N]=function(){var xe=this.__chain__;if(T||xe){var ve=r(this.__wrapped__);return(ve.__actions__=Jn(this.__actions__)).push({func:Q,args:arguments,thisArg:r}),ve.__chain__=xe,ve}return Q.apply(r,ui([this.value()],arguments))})}),r}function Al(){}var Il=za(Ft),St=za(Nh),Lf=za(kr);function lh(r){return Sn(r)?xa(Si(r)):function wc(r){return function(o){return ai(o,r)}}(r)}var na=Lc(),Ug=Lc(!0);function tn(){return[]}function vn(){return!1}var qf=jo(function(r,o){return r+o},0),El=Fc("ceil"),zg=jo(function(r,o){return r/o},1),am=Fc("floor"),ch=jo(function(r,o){return r*o},1),Bf=Fc("round"),uh=jo(function(r,o){return r-o},0);return C.after=function ou(r,o){if("function"!=typeof o)throw new Kn(m);return r=yt(r),function(){if(--r<1)return o.apply(this,arguments)}},C.ary=au,C.assign=Au,C.assignIn=wf,C.assignInWith=qs,C.assignWith=mg,C.at=Iu,C.before=lf,C.bind=ul,C.bindAll=Df,C.bindKey=lu,C.castArray=function ff(){if(!arguments.length)return[];var r=arguments[0];return _t(r)?r:[r]},C.chain=Hr,C.chunk=function Zc(r,o,c){o=(c?Dn(r,o,c):o===u)?1:cn(yt(o),0);var f=null==r?0:r.length;if(!f||o<1)return[];for(var v=0,T=0,M=se(et(f/o));v<f;)M[T++]=ti(r,v,v+=o);return M},C.compact=function wn(r){for(var o=-1,c=null==r?0:r.length,f=0,v=[];++o<c;){var T=r[o];T&&(v[f++]=T)}return v},C.concat=function Qc(){var r=arguments.length;if(!r)return[];for(var o=se(r-1),c=arguments[0],f=r;f--;)o[f-1]=arguments[f];return ui(_t(c)?Jn(c):[c],Tn(o,1))},C.cond=function Rg(r){var o=null==r?0:r.length,c=st();return r=o?Ft(r,function(f){if("function"!=typeof f[1])throw new Kn(m);return[c(f[0]),f[1]]}):[],Ct(function(f){for(var v=-1;++v<o;){var T=r[v];if(qn(T[0],this,f))return qn(T[1],this,f)}})},C.conforms=function Lg(r){return function ys(r){var o=On(r);return function(c){return Pa(c,r,o)}}(bt(r,1))},C.constant=ea,C.countBy=ef,C.create=function bf(r,o){var c=hr(r);return null==o?c:ji(c,o)},C.curry=function hl(r,o,c){var f=Ai(r,8,u,u,u,u,u,o=c?u:o);return f.placeholder=hl.placeholder,f},C.curryRight=function cf(r,o,c){var f=Ai(r,16,u,u,u,u,u,o=c?u:o);return f.placeholder=cf.placeholder,f},C.debounce=cu,C.defaults=Eu,C.defaultsDeep=Su,C.defer=ag,C.delay=uf,C.difference=Vc,C.differenceBy=Wc,C.differenceWith=br,C.drop=function Fd(r,o,c){var f=null==r?0:r.length;return f?ti(r,(o=c||o===u?1:yt(o))<0?0:o,f):[]},C.dropRight=function Np(r,o,c){var f=null==r?0:r.length;return f?ti(r,0,(o=f-(o=c||o===u?1:yt(o)))<0?0:o):[]},C.dropRightWhile=function Nd(r,o){return r&&r.length?zr(r,st(o,3),!0,!0):[]},C.dropWhile=function Ha(r,o){return r&&r.length?zr(r,st(o,3),!0):[]},C.fill=function Jr(r,o,c,f){var v=null==r?0:r.length;return v?(c&&"number"!=typeof c&&Dn(r,o,c)&&(c=0,f=v),function bp(r,o,c,f){var v=r.length;for((c=yt(c))<0&&(c=-c>v?0:v+c),(f=f===u||f>v?v:yt(f))<0&&(f+=v),f=c>f?0:Ou(f);c<f;)r[c++]=o;return r}(r,o,c,f)):[]},C.filter=function tf(r,o){return(_t(r)?er:ad)(r,st(o,3))},C.flatMap=function nf(r,o){return Tn(al(r,o),1)},C.flatMapDeep=function rf(r,o){return Tn(al(r,o),oe)},C.flatMapDepth=function eg(r,o,c){return c=c===u?1:yt(c),Tn(al(r,o),c)},C.flatten=Ds,C.flattenDeep=function qd(r){return null!=r&&r.length?Tn(r,oe):[]},C.flattenDepth=function Gc(r,o){return null!=r&&r.length?Tn(r,o=o===u?1:yt(o)):[]},C.flip=function lg(r){return Ai(r,512)},C.flow=rh,C.flowRight=sh,C.fromPairs=function Kc(r){for(var o=-1,c=null==r?0:r.length,f={};++o<c;){var v=r[o];f[v[0]]=v[1]}return f},C.functions=function Cf(r){return null==r?[]:Da(r,On(r))},C.functionsIn=function zs(r){return null==r?[]:Da(r,Yn(r))},C.groupBy=tg,C.initial=function qp(r){return null!=r&&r.length?ti(r,0,-1):[]},C.intersection=Bd,C.intersectionBy=Ud,C.intersectionWith=Xa,C.invert=Du,C.invertBy=Ru,C.invokeMap=Cn,C.iteratee=oh,C.keyBy=ng,C.keys=On,C.keysIn=Yn,C.map=al,C.mapKeys=function Fu(r,o){var c={};return o=st(o,3),gi(r,function(f,v,T){Ti(c,o(f,v,T),f)}),c},C.mapValues=function Nu(r,o){var c={};return o=st(o,3),gi(r,function(f,v,T){Ti(c,v,o(f,v,T))}),c},C.matches=function Ng(r){return Ra(bt(r,1))},C.matchesProperty=function qg(r,o){return _r(r,bt(o,1))},C.memoize=Wi,C.merge=xg,C.mergeWith=qu,C.method=jg,C.methodOf=ah,C.mixin=ta,C.negate=Gi,C.nthArg=function Rf(r){return r=yt(r),Ct(function(o){return ko(o,r)})},C.omit=vg,C.omitBy=function Of(r,o){return ju(r,Gi(st(o)))},C.once=function uu(r){return lf(2,r)},C.orderBy=function ig(r,o,c,f){return null==r?[]:(_t(o)||(o=null==o?[]:[o]),_t(c=f?u:c)||(c=null==c?[]:[c]),Os(r,o,c))},C.over=Il,C.overArgs=dl,C.overEvery=St,C.overSome=Lf,C.partial=fl,C.partialRight=hu,C.partition=rg,C.pick=Tf,C.pickBy=ju,C.property=lh,C.propertyOf=function Ff(r){return function(o){return null==r?u:ai(r,o)}},C.pull=Bp,C.pullAll=Zd,C.pullAllBy=function Up(r,o,c){return r&&r.length&&o&&o.length?Fa(r,o,st(c,2)):r},C.pullAllWith=function Qo(r,o,c){return r&&r.length&&o&&o.length?Fa(r,o,u,c):r},C.pullAt=$r,C.range=na,C.rangeRight=Ug,C.rearg=hf,C.reject=function ll(r,o){return(_t(r)?er:ad)(r,Gi(st(o,3)))},C.remove=function Tr(r,o){var c=[];if(!r||!r.length)return c;var f=-1,v=[],T=r.length;for(o=st(o,3);++f<T;){var M=r[f];o(M,f,r)&&(c.push(M),v.push(f))}return bc(r,v),c},C.rest=function cg(r,o){if("function"!=typeof r)throw new Kn(m);return Ct(r,o=o===u?o:yt(o))},C.reverse=el,C.sampleSize=function af(r,o,c){return o=(c?Dn(r,o,c):o===u)?1:yt(o),(_t(r)?Oo:Op)(r,o)},C.set=function yg(r,o,c){return null==r?r:Do(r,o,c)},C.setWith=function wg(r,o,c,f){return f="function"==typeof f?f:u,null==r?r:Do(r,o,c,f)},C.shuffle=function ru(r){return(_t(r)?id:Br)(r)},C.slice=function zp(r,o,c){var f=null==r?0:r.length;return f?(c&&"number"!=typeof c&&Dn(r,o,c)?(o=0,c=f):(o=null==o?0:yt(o),c=c===u?f:yt(c)),ti(r,o,c)):[]},C.sortBy=cl,C.sortedUniq=function Xc(r){return r&&r.length?Tc(r):[]},C.sortedUniqBy=function Wd(r,o){return r&&r.length?Tc(r,st(o,2)):[]},C.split=function Ji(r,o,c){return c&&"number"!=typeof c&&Dn(r,o,c)&&(o=c=u),(c=c===u?Je:c>>>0)?(r=Dt(r))&&("string"==typeof o||null!=o&&!vl(o))&&!(o=In(o))&&nr(r)?kn(Wn(r),0,c):r.split(o,c):[]},C.spread=function du(r,o){if("function"!=typeof r)throw new Kn(m);return o=null==o?0:cn(yt(o),0),Ct(function(c){var f=c[o],v=kn(c,0,o);return f&&ui(v,f),qn(r,this,v)})},C.tail=function tl(r){var o=null==r?0:r.length;return o?ti(r,1,o):[]},C.take=function Qp(r,o,c){return r&&r.length?ti(r,0,(o=c||o===u?1:yt(o))<0?0:o):[]},C.takeRight=function eu(r,o,c){var f=null==r?0:r.length;return f?ti(r,(o=f-(o=c||o===u?1:yt(o)))<0?0:o,f):[]},C.takeRightWhile=function nl(r,o){return r&&r.length?zr(r,st(o,3),!1,!0):[]},C.takeWhile=function Vp(r,o){return r&&r.length?zr(r,st(o,3)):[]},C.tap=function Hd(r,o){return o(r),r},C.throttle=function ug(r,o,c){var f=!0,v=!0;if("function"!=typeof r)throw new Kn(m);return Bt(c)&&(f="leading"in c?!!c.leading:f,v="trailing"in c?!!c.trailing:v),cu(r,o,{leading:f,maxWait:o,trailing:v})},C.thru=_i,C.toArray=Cl,C.toPairs=If,C.toPairsIn=Ef,C.toPath=function om(r){return _t(r)?Ft(r,Si):Un(r)?[r]:Jn(zc(Dt(r)))},C.toPlainObject=yf,C.transform=function Bu(r,o,c){var f=_t(r),v=f||xi(r)||Fs(r);if(o=st(o,4),null==c){var T=r&&r.constructor;c=v?f?new T:[]:Bt(r)&&vi(T)?hr(ba(r)):{}}return(v?Hn:gi)(r,function(M,N,Q){return o(c,M,N,Q)}),c},C.unary=function fu(r){return au(r,1)},C.union=Gd,C.unionBy=Vo,C.unionWith=il,C.uniq=function Wo(r){return r&&r.length?vr(r):[]},C.uniqBy=function Kd(r,o){return r&&r.length?vr(r,st(o,2)):[]},C.uniqWith=function Jd(r,o){return o="function"==typeof o?o:u,r&&r.length?vr(r,u,o):[]},C.unset=function Uu(r,o){return null==r||Ic(r,o)},C.unzip=Rn,C.unzipWith=tu,C.update=function zu(r,o,c){return null==r?r:Wt(r,o,Ec(c))},C.updateWith=function bg(r,o,c,f){return f="function"==typeof f?f:u,null==r?r:Wt(r,o,Ec(c),f)},C.values=Er,C.valuesIn=function Cg(r){return null==r?[]:co(r,Yn(r))},C.without=rl,C.words=ih,C.wrap=function df(r,o){return fl(Ec(o),r)},C.xor=sl,C.xorBy=$d,C.xorWith=Ar,C.zip=Rs,C.zipObject=function Yd(r,o){return md(r||[],o||[],To)},C.zipObjectDeep=function Yr(r,o){return md(r||[],o||[],Do)},C.zipWith=Wp,C.entries=If,C.entriesIn=Ef,C.extend=wf,C.extendWith=qs,ta(C,C),C.add=qf,C.attempt=Tl,C.camelCase=Mf,C.capitalize=Pf,C.ceil=El,C.clamp=function Zu(r,o,c){return c===u&&(c=o,o=u),c!==u&&(c=(c=ri(c))==c?c:0),o!==u&&(o=(o=ri(o))==o?o:0),vt(ri(r),o,c)},C.clone=function pu(r){return bt(r,4)},C.cloneDeep=function Jo(r){return bt(r,5)},C.cloneDeepWith=function gl(r,o){return bt(r,5,o="function"==typeof o?o:u)},C.cloneWith=function pl(r,o){return bt(r,4,o="function"==typeof o?o:u)},C.conformsTo=function gu(r,o){return null==o||Pa(r,o,On(o))},C.deburr=Ol,C.defaultTo=function Fg(r,o){return null==r||r!=r?o:r},C.divide=zg,C.endsWith=function Og(r,o,c){r=Dt(r),o=In(o);var f=r.length,v=c=c===u?f:vt(yt(c),0,f);return(c-=o.length)>=0&&r.slice(c,v)==o},C.eq=ni,C.escape=function Vu(r){return(r=Dt(r))&&gn.test(r)?r.replace(Qt,ho):r},C.escapeRegExp=function Tg(r){return(r=Dt(r))&&Js.test(r)?r.replace(wi,"\\$&"):r},C.every=function Xp(r,o,c){var f=_t(r)?Nh:od;return c&&Dn(r,o,c)&&(o=u),f(r,st(o,3))},C.find=Xr,C.findIndex=Cr,C.findKey=function Mu(r,o){return ec(r,st(o,3),gi)},C.findLast=Go,C.findLastIndex=Or,C.findLastKey=function js(r,o){return ec(r,st(o,3),_c)},C.floor=am,C.forEach=nu,C.forEachRight=sf,C.forIn=function Ir(r,o){return null==r?r:ka(r,st(o,3),Yn)},C.forInRight=function Pu(r,o){return null==r?r:ld(r,st(o,3),Yn)},C.forOwn=function Bs(r,o){return r&&gi(r,st(o,3))},C.forOwnRight=function Us(r,o){return r&&_c(r,st(o,3))},C.get=ku,C.gt=mu,C.gte=pf,C.has=function _g(r,o){return null!=r&&Od(r,o,An)},C.hasIn=Ho,C.head=Jc,C.identity=Ln,C.includes=function iu(r,o,c,f){r=$n(r)?r:Er(r),c=c&&!f?yt(c):0;var v=r.length;return c<0&&(c=cn(v+c,0)),wl(r)?c<=v&&r.indexOf(o,c)>-1:!!v&&us(r,o,c)>-1},C.indexOf=function jd(r,o,c){var f=null==r?0:r.length;if(!f)return-1;var v=null==c?0:yt(c);return v<0&&(v=cn(f+v,0)),us(r,o,v)},C.inRange=function Sf(r,o,c){return o=Ki(o),c===u?(c=o,o=0):c=Ki(c),function ud(r,o,c){return r>=sn(o,c)&&r<cn(o,c)}(r=ri(r),o,c)},C.invoke=Lu,C.isArguments=es,C.isArray=_t,C.isArrayBuffer=hg,C.isArrayLike=$n,C.isArrayLikeObject=dn,C.isBoolean=function gf(r){return!0===r||!1===r||Yt(r)&&It(r)==ae},C.isBuffer=xi,C.isDate=$o,C.isElement=function _u(r){return Yt(r)&&1===r.nodeType&&!ii(r)},C.isEmpty=function mf(r){if(null==r)return!0;if($n(r)&&(_t(r)||"string"==typeof r||"function"==typeof r.splice||xi(r)||Fs(r)||es(r)))return!r.length;var o=En(r);if(o==q||o==S)return!r.size;if(yr(r))return!mr(r).length;for(var c in r)if(Le.call(r,c))return!1;return!0},C.isEqual=function dg(r,o){return qr(r,o)},C.isEqualWith=function fg(r,o,c){var f=(c="function"==typeof c?c:u)?c(r,o):u;return f===u?qr(r,o,u,c):!!f},C.isError=xu,C.isFinite=function pg(r){return"number"==typeof r&&rn(r)},C.isFunction=vi,C.isInteger=_f,C.isLength=ml,C.isMap=ts,C.isMatch=function vu(r,o){return r===o||Cs(r,o,Kr(o))},C.isMatchWith=function _l(r,o,c){return c="function"==typeof c?c:u,Cs(r,o,Kr(o),c)},C.isNaN=function Yo(r){return xl(r)&&r!=+r},C.isNative=function yu(r){if(Id(r))throw new dt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return So(r)},C.isNil=function wu(r){return null==r},C.isNull=function xf(r){return null===r},C.isNumber=xl,C.isObject=Bt,C.isObjectLike=Yt,C.isPlainObject=ii,C.isRegExp=vl,C.isSafeInteger=function gg(r){return _f(r)&&r>=-pe&&r<=pe},C.isSet=yl,C.isString=wl,C.isSymbol=Un,C.isTypedArray=Fs,C.isUndefined=function bu(r){return r===u},C.isWeakMap=function bl(r){return Yt(r)&&En(r)==J},C.isWeakSet=function Cu(r){return Yt(r)&&"[object WeakSet]"==It(r)},C.join=function Zo(r,o){return null==r?"":We.call(r,o)},C.kebabCase=Wu,C.last=bn,C.lastIndexOf=function jp(r,o,c){var f=null==r?0:r.length;if(!f)return-1;var v=f;return c!==u&&(v=(v=yt(c))<0?cn(f+v,0):sn(v,f-1)),o==o?function Vh(z,he,se){for(var Ye=se+1;Ye--;)if(z[Ye]===he)return Ye;return Ye}(r,o,v):_a(r,tc,v,!0)},C.lowerCase=Ag,C.lowerFirst=Gu,C.lt=vf,C.lte=Ns,C.max=function Zg(r){return r&&r.length?Io(r,Ln,bs):u},C.maxBy=function Qg(r,o){return r&&r.length?Io(r,st(o,2),bs):u},C.mean=function Vg(r){return nc(r,Ln)},C.meanBy=function Wg(r,o){return nc(r,st(o,2))},C.min=function Gg(r){return r&&r.length?Io(r,Ln,Mo):u},C.minBy=function jf(r,o){return r&&r.length?Io(r,st(o,2),Mo):u},C.stubArray=tn,C.stubFalse=vn,C.stubObject=function Mi(){return{}},C.stubString=function ia(){return""},C.stubTrue=function sm(){return!0},C.multiply=ch,C.nth=function zd(r,o){return r&&r.length?ko(r,yt(o)):u},C.noConflict=function Bg(){return $t._===this&&($t._=Ie),this},C.noop=Al,C.now=Ls,C.pad=function Ku(r,o,c){r=Dt(r);var f=(o=yt(o))?Dr(r):0;if(!o||f>=o)return r;var v=(o-f)/2;return Za(ar(v),c)+r+Za(et(v),c)},C.padEnd=function Ju(r,o,c){r=Dt(r);var f=(o=yt(o))?Dr(r):0;return o&&f<o?r+Za(o-f,c):r},C.padStart=function Zs(r,o,c){r=Dt(r);var f=(o=yt(o))?Dr(r):0;return o&&f<o?Za(o-f,c)+r:r},C.parseInt=function kf(r,o,c){return c||null==o?o=0:o&&(o=+o),Ta(Dt(r).replace(aa,""),o||0)},C.random=function Qu(r,o,c){if(c&&"boolean"!=typeof c&&Dn(r,o,c)&&(o=c=u),c===u&&("boolean"==typeof o?(c=o,o=u):"boolean"==typeof r&&(c=r,r=u)),r===u&&o===u?(r=0,o=1):(r=Ki(r),o===u?(o=r,r=0):o=Ki(o)),r>o){var f=r;r=o,o=f}if(c||r%1||o%1){var v=Yh();return sn(r+v*(o-r+lp("1e-"+((v+"").length-1))),o)}return Cc(r,o)},C.reduce=function of(r,o,c){var f=_t(r)?ao:ic,v=arguments.length<3;return f(r,st(o,4),c,v,Bi)},C.reduceRight=function sg(r,o,c){var f=_t(r)?qh:ic,v=arguments.length<3;return f(r,st(o,4),c,v,mc)},C.repeat=function $u(r,o,c){return o=(c?Dn(r,o,c):o===u)?1:yt(o),Na(Dt(r),o)},C.replace=function Ig(){var r=arguments,o=Dt(r[0]);return r.length<3?o:o.replace(r[1],r[2])},C.result=function Af(r,o,c){var f=-1,v=(o=zi(o,r)).length;for(v||(v=1,r=u);++f<v;){var T=null==r?u:r[Si(o[f])];T===u&&(f=v,T=c),r=vi(T)?T.call(r):T}return r},C.round=Bf,C.runInContext=z,C.sample=function og(r){return(_t(r)?Co:qa)(r)},C.size=function su(r){if(null==r)return 0;if($n(r))return wl(r)?Dr(r):r.length;var o=En(r);return o==q||o==S?r.size:mr(r).length},C.snakeCase=Yu,C.some=function Ko(r,o,c){var f=_t(r)?kr:Ur;return c&&Dn(r,o,c)&&(o=u),f(r,st(o,3))},C.sortedIndex=function Qd(r,o){return Ro(r,o)},C.sortedIndexBy=function Zp(r,o,c){return xr(r,o,st(c,2))},C.sortedIndexOf=function $c(r,o){var c=null==r?0:r.length;if(c){var f=Ro(r,o);if(f<c&&ni(r[f],o))return f}return-1},C.sortedLastIndex=function Yc(r,o){return Ro(r,o,!0)},C.sortedLastIndexBy=function Vd(r,o,c){return xr(r,o,st(c,2),!0)},C.sortedLastIndexOf=function Hc(r,o){if(null!=r&&r.length){var f=Ro(r,o,!0)-1;if(ni(r[f],o))return f}return-1},C.startCase=Hu,C.startsWith=function Eg(r,o,c){return r=Dt(r),c=null==c?0:vt(yt(c),0,r.length),o=In(o),r.slice(c,c+o.length)==o},C.subtract=uh,C.sum=function hh(r){return r&&r.length?va(r,Ln):0},C.sumBy=function dh(r,o){return r&&r.length?va(r,st(o,2)):0},C.template=function Xu(r,o,c){var f=C.templateSettings;c&&Dn(r,o,c)&&(o=u),r=Dt(r),o=qs({},o,f,bd);var N,Q,v=qs({},o.imports,f.imports,bd),T=On(v),M=co(v,T),xe=0,ve=o.interpolate||ua,Te="__p += '",Ge=ir((o.escape||ua).source+"|"+ve.source+"|"+(ve===ns?Nl:ua).source+"|"+(o.evaluate||ua).source+"|$","g"),tt="//# sourceURL="+(Le.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Jt+"]")+"\n";r.replace(Ge,function(lt,Tt,Mt,zn,Zn,li){return Mt||(Mt=zn),Te+=r.slice(xe,li).replace(tp,Bh),Tt&&(N=!0,Te+="' +\n__e("+Tt+") +\n'"),Zn&&(Q=!0,Te+="';\n"+Zn+";\n__p += '"),Mt&&(Te+="' +\n((__t = ("+Mt+")) == null ? '' : __t) +\n'"),xe=li+lt.length,lt}),Te+="';\n";var ot=Le.call(o,"variable")&&o.variable;if(ot){if(la.test(ot))throw new dt("Invalid `variable` option passed into `_.template`")}else Te="with (obj) {\n"+Te+"\n}\n";Te=(Q?Te.replace(ln,""):Te).replace(ci,"$1").replace(Ws,"$1;"),Te="function("+(ot||"obj")+") {\n"+(ot?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(N?", __e = _.escape":"")+(Q?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+Te+"return __p\n}";var Ot=Tl(function(){return Pt(T,tt+"return "+Te).apply(u,M)});if(Ot.source=Te,xu(Ot))throw Ot;return Ot},C.times=function Qs(r,o){if((r=yt(r))<1||r>pe)return[];var c=Je,f=sn(r,Je);o=st(o),r-=Je;for(var v=ya(f,o);++c<r;)o(c);return v},C.toFinite=Ki,C.toInteger=yt,C.toLength=Ou,C.toLower=function Sg(r){return Dt(r).toLowerCase()},C.toNumber=ri,C.toSafeInteger=function Tu(r){return r?vt(yt(r),-pe,pe):0===r?r:0},C.toString=Dt,C.toUpper=function Mg(r){return Dt(r).toUpperCase()},C.trim=function eh(r,o,c){if((r=Dt(r))&&(c||o===u))return ds(r);if(!r||!(o=In(o)))return r;var f=Wn(r),v=Wn(o);return kn(f,sc(f,v),uo(f,v)+1).join("")},C.trimEnd=function Pg(r,o,c){if((r=Dt(r))&&(c||o===u))return r.slice(0,Gn(r)+1);if(!r||!(o=In(o)))return r;var f=Wn(r);return kn(f,0,uo(f,Wn(o))+1).join("")},C.trimStart=function th(r,o,c){if((r=Dt(r))&&(c||o===u))return r.replace(aa,"");if(!r||!(o=In(o)))return r;var f=Wn(r);return kn(f,sc(f,Wn(o))).join("")},C.truncate=function kg(r,o){var c=30,f="...";if(Bt(o)){var v="separator"in o?o.separator:v;c="length"in o?yt(o.length):c,f="omission"in o?In(o.omission):f}var T=(r=Dt(r)).length;if(nr(r)){var M=Wn(r);T=M.length}if(c>=T)return r;var N=c-Dr(f);if(N<1)return f;var Q=M?kn(M,0,N).join(""):r.slice(0,N);if(v===u)return Q+f;if(M&&(N+=Q.length-N),vl(v)){if(r.slice(N).search(v)){var xe,ve=Q;for(v.global||(v=ir(v.source,Dt(ql.exec(v))+"g")),v.lastIndex=0;xe=v.exec(ve);)var Te=xe.index;Q=Q.slice(0,Te===u?N:Te)}}else if(r.indexOf(In(v),N)!=N){var Ge=Q.lastIndexOf(v);Ge>-1&&(Q=Q.slice(0,Ge))}return Q+f},C.unescape=function nh(r){return(r=Dt(r))&&Gs.test(r)?r.replace($i,Wh):r},C.uniqueId=function Nf(r){var o=++Xe;return Dt(r)+o},C.upperCase=Dg,C.upperFirst=Xo,C.each=nu,C.eachRight=sf,C.first=Jc,ta(C,function(){var r={};return gi(C,function(o,c){Le.call(C.prototype,c)||(r[c]=o)}),r}(),{chain:!1}),C.VERSION="4.17.21",Hn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){C[r].placeholder=C}),Hn(["drop","take"],function(r,o){ut.prototype[r]=function(c){c=c===u?1:cn(yt(c),0);var f=this.__filtered__&&!o?new ut(this):this.clone();return f.__filtered__?f.__takeCount__=sn(c,f.__takeCount__):f.__views__.push({size:sn(c,Je),type:r+(f.__dir__<0?"Right":"")}),f},ut.prototype[r+"Right"]=function(c){return this.reverse()[r](c).reverse()}}),Hn(["filter","map","takeWhile"],function(r,o){var c=o+1,f=1==c||3==c;ut.prototype[r]=function(v){var T=this.clone();return T.__iteratees__.push({iteratee:st(v,3),type:c}),T.__filtered__=T.__filtered__||f,T}}),Hn(["head","last"],function(r,o){var c="take"+(o?"Right":"");ut.prototype[r]=function(){return this[c](1).value()[0]}}),Hn(["initial","tail"],function(r,o){var c="drop"+(o?"":"Right");ut.prototype[r]=function(){return this.__filtered__?new ut(this):this[c](1)}}),ut.prototype.compact=function(){return this.filter(Ln)},ut.prototype.find=function(r){return this.filter(r).head()},ut.prototype.findLast=function(r){return this.reverse().find(r)},ut.prototype.invokeMap=Ct(function(r,o){return"function"==typeof r?new ut(this):this.map(function(c){return un(c,r,o)})}),ut.prototype.reject=function(r){return this.filter(Gi(st(r)))},ut.prototype.slice=function(r,o){r=yt(r);var c=this;return c.__filtered__&&(r>0||o<0)?new ut(c):(r<0?c=c.takeRight(-r):r&&(c=c.drop(r)),o!==u&&(c=(o=yt(o))<0?c.dropRight(-o):c.take(o-r)),c)},ut.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},ut.prototype.toArray=function(){return this.take(Je)},gi(ut.prototype,function(r,o){var c=/^(?:filter|find|map|reject)|While$/.test(o),f=/^(?:head|last)$/.test(o),v=C[f?"take"+("last"==o?"Right":""):o],T=f||/^find/.test(o);v&&(C.prototype[o]=function(){var M=this.__wrapped__,N=f?[1]:arguments,Q=M instanceof ut,xe=N[0],ve=Q||_t(M),Te=function(Tt){var Mt=v.apply(C,ui([Tt],N));return f&&Ge?Mt[0]:Mt};ve&&c&&"function"==typeof xe&&1!=xe.length&&(Q=ve=!1);var Ge=this.__chain__,ot=T&&!Ge,Ot=Q&&!this.__actions__.length;if(!T&&ve){M=Ot?M:new ut(this);var lt=r.apply(M,N);return lt.__actions__.push({func:_i,args:[Te],thisArg:u}),new oi(lt,Ge)}return ot&&Ot?r.apply(this,N):(lt=this.thru(Te),ot?f?lt.value()[0]:lt.value():lt)})}),Hn(["pop","push","shift","sort","splice","unshift"],function(r){var o=lc[r],c=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",f=/^(?:pop|shift)$/.test(r);C.prototype[r]=function(){var v=arguments;if(f&&!this.__chain__){var T=this.value();return o.apply(_t(T)?T:[],v)}return this[c](function(M){return o.apply(_t(M)?M:[],v)})}}),gi(ut.prototype,function(r,o){var c=C[o];if(c){var f=c.name+"";Le.call(cr,f)||(cr[f]=[]),cr[f].push({name:o,func:c})}}),cr[Qr(u,2).name]=[{name:"wrapper",func:u}],ut.prototype.clone=function yp(){var r=new ut(this.__wrapped__);return r.__actions__=Jn(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=Jn(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=Jn(this.__views__),r},ut.prototype.reverse=function Rr(){if(this.__filtered__){var r=new ut(this);r.__dir__=-1,r.__filtered__=!0}else(r=this.clone()).__dir__*=-1;return r},ut.prototype.value=function Hh(){var r=this.__wrapped__.value(),o=this.__dir__,c=_t(r),f=o<0,v=c?r.length:0,T=function Sp(r,o,c){for(var f=-1,v=c.length;++f<v;){var T=c[f],M=T.size;switch(T.type){case"drop":r+=M;break;case"dropRight":o-=M;break;case"take":o=sn(o,r+M);break;case"takeRight":r=cn(r,o-M)}}return{start:r,end:o}}(0,v,this.__views__),M=T.start,N=T.end,Q=N-M,xe=f?N:M-1,ve=this.__iteratees__,Te=ve.length,Ge=0,tt=sn(Q,this.__takeCount__);if(!c||!f&&v==Q&&tt==Q)return Lo(r,this.__actions__);var ot=[];e:for(;Q--&&Ge<tt;){for(var Ot=-1,lt=r[xe+=o];++Ot<Te;){var Tt=ve[Ot],zn=Tt.type,Zn=(0,Tt.iteratee)(lt);if(2==zn)lt=Zn;else if(!Zn){if(1==zn)continue e;break e}}ot[Ge++]=lt}return ot},C.prototype.at=Xd,C.prototype.chain=function Gp(){return Hr(this)},C.prototype.commit=function Kp(){return new oi(this.value(),this.__chain__)},C.prototype.next=function Jp(){this.__values__===u&&(this.__values__=Cl(this.value()));var r=this.__index__>=this.__values__.length;return{done:r,value:r?u:this.__values__[this.__index__++]}},C.prototype.plant=function ol(r){for(var o,c=this;c instanceof Ea;){var f=Ld(c);f.__index__=0,f.__values__=u,o?v.__wrapped__=f:o=f;var v=f;c=c.__wrapped__}return v.__wrapped__=r,o},C.prototype.reverse=function Yp(){var r=this.__wrapped__;if(r instanceof ut){var o=r;return this.__actions__.length&&(o=new ut(this)),(o=o.reverse()).__actions__.push({func:_i,args:[el],thisArg:u}),new oi(o,this.__chain__)}return this.thru(el)},C.prototype.toJSON=C.prototype.valueOf=C.prototype.value=function Hp(){return Lo(this.__wrapped__,this.__actions__)},C.prototype.first=C.prototype.head,po&&(C.prototype[po]=function $p(){return this}),C}();$t._=gs,(O=function(){return gs}.call(ue,w,ue,at))!==u&&(at.exports=O)}.call(this)}}]);