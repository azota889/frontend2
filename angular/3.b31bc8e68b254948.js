"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[3],{46527:(U,I,n)=>{n.d(I,{S:()=>z});var t=n(65879),s=n(39621),j=n(11530),y=n(96814),C=n(91190);const o=["table"];function d(E,D){if(1&E&&(t.TgZ(0,"td",6),t._uU(1),t.ALo(2,"formatOfflineExamHashIdToNumber"),t.qZA()),2&E){const v=D.$implicit,M=D.index;t.uIk("excelRow",1)("excelColumn",M+1),t.xp6(1),t.hij(" ",t.lcZ(2,3,null==v?null:v.offlineMixQuestionHashId)," ")}}function f(E,D){if(1&E&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&E){const v=t.oxw(2).$implicit,M=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,v.offlineQuestionObjs[M].answer)," ")}}function u(E,D){1&E&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&E&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_core_essay_question")," "))}function A(E,D){if(1&E&&(t.TgZ(0,"span"),t.YNc(1,f,3,3,"span",7),t.YNc(2,u,3,3,"span",7),t.qZA()),2&E){const v=t.oxw().$implicit,M=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",!(null!=v.offlineQuestionObjs&&null!=v.offlineQuestionObjs[M]&&v.offlineQuestionObjs[M].isEssay)),t.xp6(1),t.Q6J("ngIf",null==v.offlineQuestionObjs||null==v.offlineQuestionObjs[M]?null:v.offlineQuestionObjs[M].isEssay)}}function S(E,D){if(1&E&&(t.TgZ(0,"td",6),t.YNc(1,A,3,2,"span",7),t.qZA()),2&E){const v=D.$implicit,M=D.index,Z=t.oxw().$implicit;let B;t.uIk("excelRow",Z+2)("excelColumn",M+1),t.xp6(1),t.Q6J("ngIf",(null!==(B=null==v.offlineQuestionObjs?null:v.offlineQuestionObjs.length)&&void 0!==B?B:0)>Z)}}const P=function(){return[]};function e(E,D){if(1&E&&(t.TgZ(0,"tr")(1,"td",3),t._uU(2),t.qZA(),t.YNc(3,S,2,3,"td",4),t.qZA()),2&E){const v=D.$implicit,M=t.oxw();let Z;t.xp6(1),t.uIk("excelRow",v+2)("excelColumn",0),t.xp6(1),t.hij(" ",v+M.startQuestionIndex," "),t.xp6(1),t.Q6J("ngForOf",null!==(Z=null==M.obj?null:M.obj.offlineMixQuestionObjs)&&void 0!==Z?Z:t.DdM(4,P))}}let z=(()=>{class E extends s.Q{calculateMaxQuestion(){let v=0;return this.obj.offlineMixQuestionObjs&&this.obj.offlineMixQuestionObjs.forEach(M=>{v<(M.offlineQuestionObjs?.length??0)&&(v=M.offlineQuestionObjs?.length??0)}),v}ngOnChanges(){this.isExported=!1,this.maxQuestionIndex=this.calculateMaxQuestion(),this.totalExamCode=this.obj.offlineMixQuestionObjs?.length??0}ngAfterViewChecked(){0==this.isExported&&(this.isExported=!0,setTimeout(()=>{this.exportDataDone.emit(this.exportExcelService.exportHtmlTableToExcelBlob(this.table,!0))},0))}ngOnInit(){super.ngOnInit()}constructor(v){super(),this.exportExcelService=v,this.startQuestionIndex=1,this.exportDataDone=new t.vpe,this.maxQuestionIndex=0,this.totalExamCode=0,this.isExported=!1}}return E.\u0275fac=function(v){return new(v||E)(t.Y36(j.L))},E.\u0275cmp=t.Xpm({type:E,selectors:[["azt-export-excel-for-answersheet"]],viewQuery:function(v,M){if(1&v&&t.Gf(o,5),2&v){let Z;t.iGM(Z=t.CRH())&&(M.table=Z.first)}},inputs:{obj:"obj",startQuestionIndex:"startQuestionIndex"},outputs:{exportDataDone:"exportDataDone"},features:[t.qOj,t.TTD],decls:14,vars:16,consts:[[1,"table","table-bordered",2,"display","none"],["table",""],["rowspan","2","excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true},"font":{"bold":true}}',1,"text-center","azt-excel-cell"],["excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true},"font":{"bold":true}}',1,"text-center","azt-excel-cell"],["class","text-center azt-excel-cell","excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true}}',4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true}}',1,"text-center","azt-excel-cell"],[4,"ngIf"]],template:function(v,M){if(1&v&&(t.TgZ(0,"table",0,1)(2,"tbody")(3,"tr")(4,"td",2),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"td",3),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()(),t.TgZ(10,"tr"),t.YNc(11,d,3,5,"td",4),t.qZA(),t.YNc(12,e,4,5,"tr",5),t.ALo(13,"createEmptyArray"),t.qZA()()),2&v){let Z;t.xp6(4),t.uIk("excelRow",0)("excelColumn",0),t.xp6(1),t.hij(" ",t.lcZ(6,9,"lang_testbank_answersheet_question_title")," "),t.xp6(2),t.uIk("colspan",M.totalExamCode)("excelRow",0)("excelColumn",1),t.xp6(1),t.hij(" ",t.lcZ(9,11,"lang_auto_ma_de_thi")," "),t.xp6(3),t.Q6J("ngForOf",null!==(Z=null==M.obj?null:M.obj.offlineMixQuestionObjs)&&void 0!==Z?Z:t.DdM(15,P)),t.xp6(1),t.Q6J("ngForOf",t.lcZ(13,13,M.maxQuestionIndex))}},dependencies:[y.sg,y.O5,C.JV,C.Aw,C.ib],encapsulation:2}),E})()},78585:(U,I,n)=>{n.d(I,{h:()=>V});var t=n(56223),s=n(19347),j=n(90241),y=n(35187),C=n(217),o=n(65879),d=n(41719),f=n(79107),u=n(96814),A=n(70342),S=n(87466),P=n(95545),e=n(37722),z=n(775),E=n(10463),D=n(74438),v=n(91190);function M(O,N){1&O&&(o.TgZ(0,"div",8)(1,"div",9)(2,"span",10),o._uU(3,"Loading..."),o.qZA()()())}function Z(O,N){1&O&&(o.TgZ(0,"div",32),o._uU(1),o.ALo(2,"mytranslate"),o.qZA()),2&O&&(o.xp6(1),o.hij("*** ",o.lcZ(2,1,"lang_testbank_test_config_you_not_yet_class"),""))}function B(O,N){if(1&O&&(o.TgZ(0,"div",30),o.YNc(1,Z,3,3,"div",31),o.qZA()),2&O){const p=o.oxw(3);o.xp6(1),o.Q6J("ngIf",p.form.controls.classroomIds.errors.classroomCheckBoxValidatorWithoutWhoAllow)}}function R(O,N){if(1&O){const p=o.EpF();o.TgZ(0,"div",33)(1,"span",34),o._uU(2),o.ALo(3,"mytranslate"),o.qZA(),o.TgZ(4,"button",35),o.NdJ("click",function(){o.CHM(p);const g=o.oxw(3);return o.KtG(g.showCopySuccess())}),o.TgZ(5,"div",36),o._UZ(6,"lucide-icon",37),o.qZA(),o._uU(7," Copy link "),o.qZA()()}if(2&O){const p=o.oxw(3);o.xp6(2),o.Oqu(o.lcZ(3,3,"lang_auto_copy_link_gui_cho_hoc_sinh")),o.xp6(2),o.Q6J("cdkCopyToClipboard",p.copyLinkToClipboard())("disabled",2==p.form.getRawValue().chooseOption&&(null==p.form.controls.classroomIds.errors?null:p.form.controls.classroomIds.errors.classroomCheckBoxValidatorWithoutWhoAllow))}}function W(O,N){1&O&&(o.TgZ(0,"div",38)(1,"p",39),o._uU(2),o.ALo(3,"mytranslate"),o.qZA()()),2&O&&(o.xp6(2),o.Oqu(o.lcZ(3,1,"lang_auto_chua_duoc_cau_hinh_tra_de_thi")))}const Q=function(O){return{"h-56-important":O}};function J(O,N){if(1&O){const p=o.EpF();o.ynx(0),o.TgZ(1,"div",15)(2,"mat-radio-group",16),o.NdJ("change",function(){o.CHM(p);const g=o.oxw(2);return o.KtG(g.changeStatusOfflineShare(void 0))}),o.TgZ(3,"mat-radio-button",17),o._uU(4),o.ALo(5,"mytranslate"),o.qZA(),o.TgZ(6,"mat-radio-button",18),o._uU(7),o.ALo(8,"mytranslate"),o.qZA(),o.TgZ(9,"mat-radio-button",19),o._uU(10),o.ALo(11,"mytranslate"),o.qZA()()(),o.TgZ(12,"div",20)(13,"div",21)(14,"azt-list-classroom-check-all",22),o.NdJ("changeCheckboxEvent",function(g){o.CHM(p);const r=o.oxw(2);return o.KtG(r.changeStatusOfflineShare(g))}),o.qZA()(),o.TgZ(15,"div",23)(16,"ng-scrollbar",24)(17,"azt-list-classroom-checkbox",25),o.NdJ("changeCheckboxEvent",function(g){o.CHM(p);const r=o.oxw(2);return o.KtG(r.changeStatusOfflineShare(g))}),o.qZA()()()(),o.YNc(18,B,2,1,"div",26),o.TgZ(19,"div",27),o.YNc(20,R,8,5,"div",28),o.qZA(),o.YNc(21,W,4,3,"div",29),o.ALo(22,"fullPermission"),o.BQk()}if(2&O){const p=o.oxw(2);o.xp6(3),o.Q6J("checked",0==p.form.getRawValue().chooseOption),o.xp6(1),o.Oqu(o.lcZ(5,21,"lang_auto_khong")),o.xp6(2),o.Q6J("checked",1==p.form.getRawValue().chooseOption),o.xp6(1),o.Oqu(o.lcZ(8,23,"lang_auto_tat_ca_cac_lop")),o.xp6(2),o.Q6J("checked",2==p.form.getRawValue().chooseOption),o.xp6(1),o.Oqu(o.lcZ(11,25,"lang_auto_tuy_chon_theo_lop")),o.xp6(2),o.Q6J("hidden",2!=p.form.getRawValue().chooseOption),o.xp6(2),o.Q6J("formArray",p.form.controls.classroomIds)("objs",p.classroomObjs)("permissionName",p.permissionTypes.exam),o.xp6(2),o.Q6J("visibility","hover")("autoHeightDisabled",!1)("ngClass",o.VKq(30,Q,p.isMobileWebView)),o.xp6(1),o.Q6J("form",p.form)("formArrayName","classroomIds")("objs",p.classroomObjs)("shareClassroomIds",p.shareClassroomIds)("permissionName",p.permissionTypes.exam),o.xp6(1),o.Q6J("ngIf",p.form.controls.classroomIds.errors&&2==p.form.getRawValue().chooseOption),o.xp6(2),o.Q6J("ngIf",0!=p.form.getRawValue().chooseOption),o.xp6(1),o.Q6J("ngIf",!o.xi3(22,27,p.examWithPermissionObj,"exam"))}}function K(O,N){1&O&&(o.TgZ(0,"div",41)(1,"p",39),o._uU(2),o.ALo(3,"mytranslate"),o.qZA()()),2&O&&(o.xp6(2),o.Oqu(o.lcZ(3,1,"lang_auto_chua_duoc_cau_hinh_tra_de_thi")))}function F(O,N){if(1&O&&(o.YNc(0,K,4,3,"div",40),o.ALo(1,"fullPermission")),2&O){const p=o.oxw(2);o.Q6J("ngIf",!o.xi3(1,1,p.examWithPermissionObj,"exam"))}}function Y(O,N){if(1&O&&(o.TgZ(0,"form",11)(1,"div",12),o.YNc(2,J,23,32,"ng-container",13),o.ALo(3,"fullPermission"),o.YNc(4,F,2,4,"ng-template",null,14,o.W1O),o.qZA()()),2&O){const p=o.MAs(5),x=o.oxw();o.Q6J("formGroup",x.form),o.xp6(2),o.Q6J("ngIf",o.xi3(3,3,x.examWithPermissionObj,"exam"))("ngIfElse",p)}}function G(O,N){if(1&O){const p=o.EpF();o.TgZ(0,"div",42)(1,"button",43),o.NdJ("click",function(){o.CHM(p);const g=o.oxw();return o.KtG(g.btnCloseDialog(!1))}),o._uU(2),o.ALo(3,"mytranslate"),o.qZA()()}2&O&&(o.xp6(2),o.hij(" ",o.lcZ(3,1,"lang_auto_dong")," "))}let V=(()=>{class O extends j.e{btnCloseDialog(p){this.dialogRef.close(p)}copyLinkToClipboard(){let p=this.commonService.getCurrentDomain();return this.linkCopy=`${p}/de-thi/${this.examWithPermissionObj?.hashId}?offline=${this.offlineCode}`,this.linkCopy}showCopySuccess(){this.showSuccessSnack("lang_auto_sao_chep_thanh_cong")}getCodeOfflineShare(){this.initStatusObj(),this.subscriptions.add(this.offlineShareService.apiOfflineShareGetObjGet(this.examHashId).subscribe(p=>{1==p.success?(this.offlineCode=p.data?.shareHashId??"",this.classroomObjs=p.data?.classroomObjs??[],this.shareClassroomIds=p.data?.shareClassroomIds??[],this.examWithPermissionObj=p.data?.examObj,this.form.controls.chooseOption.setValue(p.data?.showOfflineResult??0),this.successStatusObj()):this.errorStatusObj(p.message??"",!0)}))}changeStatusOfflineShare(p){if(2==this.form.getRawValue().chooseOption&&this.form.controls.classroomIds.errors?.classroomCheckBoxValidatorWithoutWhoAllow)return;let x=this.form.getRawValue().chooseOption;var g=this.sAztClassroomCheckboxService.findClassroomWithNoPermission(this.classroomObjs,y.y.homework);g.push(0);const r=2!=x?[]:this.sAztClassroomCheckboxService.getClassroomIdsChecked(this.classroomObjs,g,this.form.getRawValue().classroomIds);this.subscriptions.add(this.offlineShareService.apiOfflineShareChangeStatusPost({examHashId:this.examWithPermissionObj?.hashId??"",status:x,classroomIds:r}).subscribe(m=>{1==m.success?this.offlineCode=m.data?.shareHashId??"":this.errorStatusObj(m.message??"",!0)}))}ngOnInit(){this.getCodeOfflineShare(),super.ngOnInit()}constructor(p,x,g,r){super(g,x),this.offlineShareService=p,this.dialogRef=x,this.sAztClassroomCheckboxService=r,this.examHashId="",this.useDialog=!1,this.permissionTypes=y.y,this.offlineCode="",this.linkCopy="",this.examWithPermissionObj=void 0,this.classroomObjs=[],this.shareClassroomIds=[],this.examHashId=g.examHashId?g.examHashId:this.examHashId,this.useDialog=g?g.useDialog:this.useDialog,this.form=new t.cw({chooseOption:new t.NI(0,{nonNullable:!0}),classroomIds:new t.Oe([])},{validators:[C.h.classroomCheckBoxValidatorWithoutWhoAllow]})}}return O.\u0275fac=function(p){return new(p||O)(o.Y36(d.kN),o.Y36(s.so,8),o.Y36(s.WI,8),o.Y36(f.f))},O.\u0275cmp=o.Xpm({type:O,selectors:[["azt-offline-share"]],inputs:{examHashId:"examHashId",useDialog:"useDialog"},features:[o.qOj],decls:12,vars:6,consts:[[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],[1,"intro-y"],[1,"text-base","font-medium","mr-auto"],["class","d-flex justify-content-center align-items-center",4,"ngIf","ngIfElse"],["doneLoading",""],["class","text-right mt-3",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center"],["role","status",1,"spinner-border","text-secondary"],[1,"sr-only"],[3,"formGroup"],[1,"block-body"],[4,"ngIf","ngIfElse"],["noFullPermission",""],[1,"input-toggle"],["color","primary","formControlName","chooseOption",2,"flex-direction","column",3,"change"],["value","0",3,"checked"],["value","1",1,"mt-1",3,"checked"],["value","2",1,"mt-1",3,"checked"],[1,"block-main-classroom",3,"hidden"],[1,"classroom_check_all"],[3,"formArray","objs","permissionName","changeCheckboxEvent"],[1,"classroom_list"],["pointerEventsMethod","scrollbar",1,"w-full",3,"visibility","autoHeightDisabled","ngClass"],[3,"form","formArrayName","objs","shareClassroomIds","permissionName","changeCheckboxEvent"],["class","col-12 pl-0 pt-3",4,"ngIf"],[1,"block-main","mt-2"],["class","block-copy",4,"ngIf"],["class","block-else",4,"ngIf"],[1,"col-12","pl-0","pt-3"],["class","text-left text-danger",4,"ngIf"],[1,"text-left","text-danger"],[1,"block-copy"],[1,"title-copy","mr-2"],["azt-track-service","azt-offline-share-6FNwLsA2D",1,"btn","btn-primary",3,"cdkCopyToClipboard","disabled","click"],[1,"w-4","h-4","mr-2"],["name","copy"],[1,"block-else"],[1,"note"],["class","block-else text-center",4,"ngIf"],[1,"block-else","text-center"],[1,"text-right","mt-3"],["azt-track-service","azt-offline-share-hrBGx7oL2r",1,"btn","w-24","btn-secondary",3,"click"]],template:function(p,x){if(1&p&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),o._uU(5),o.ALo(6,"mytranslate"),o.qZA()(),o.TgZ(7,"div",3),o.YNc(8,M,4,0,"div",5),o.YNc(9,Y,6,6,"ng-template",null,6,o.W1O),o.qZA(),o.YNc(11,G,4,3,"div",7),o.qZA()()()),2&p){const g=o.MAs(10);o.xp6(5),o.Oqu(o.lcZ(6,4,"lang_auto_tra_ket_qua_thi_offline")),o.xp6(3),o.Q6J("ngIf",x.statusObj.loading)("ngIfElse",g),o.xp6(3),o.Q6J("ngIf",x.useDialog)}},dependencies:[u.mk,u.O5,A.i3,S.VQ,S.U0,t._Y,t.JJ,t.JL,t.sg,t.u,t.CE,P.KC,e.Nh5,z.M,E.B,D.V,v.JV,v.NK],styles:[".school-info_bg[_ngcontent-%COMP%]{z-index:1000;width:100%;display:flex;left:0;top:0;position:fixed;height:100%;min-height:100vh;background-color:#3c3c3c80}.block-note[_ngcontent-%COMP%]{padding:5px}.note[_ngcontent-%COMP%]{color:#acacac}.school-info[_ngcontent-%COMP%]{z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);position:fixed;width:500px;min-height:180px;background:#fff;margin-left:auto;margin-right:auto;box-shadow:0 0 13px 3px #00000094}.btn-close[_ngcontent-%COMP%]{transition:all .5s}.btn-close[_ngcontent-%COMP%]:hover{background:#dfe6e9}mat-radio-group[_ngcontent-%COMP%]{margin:10px 5px;width:90%;display:flex;justify-content:space-between}.block-title[_ngcontent-%COMP%]{text-align:center;font-size:18px;font-weight:500}.block-main-classroom[_ngcontent-%COMP%]{padding:10px;border:1px solid #908e8e;border-radius:5px;height:200px;overflow:hidden}.classroom-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:15px}.btn-copy[_ngcontent-%COMP%]{border-radius:5px;transition:all .5s;text-transform:inherit}.btn-copy[_ngcontent-%COMP%]:hover:not([disabled]){background:rgba(211,211,211,.58)}@media only screen and (max-width: 1024px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:800px}}@media only screen and (max-width: 768px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:700px}}@media only screen and (max-width: 576px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:400px}.classroom-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}@media only screen and (max-width: 380px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:300px}}@media only screen and (max-width: 290px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:250px}}"]}),O})()},36937:(U,I,n)=>{n.d(I,{H:()=>x});var t=n(65879),s=n(19347),j=n(60013),y=n(56443),C=n(90241),o=n(86670),d=n(32839),f=n(14845),u=n(94281),A=n(96790),S=n(82898),P=n(41719),e=n(52630),z=n(96814),E=n(70342),D=n(77988),v=n(92596),M=n(37722),Z=n(51969),B=n(20787),R=n(30251),W=n(46527),Q=n(91190);function J(g,r){if(1&g&&(t.TgZ(0,"a",29),t.ALo(1,"mytranslate"),t.TgZ(2,"span",19),t._UZ(3,"lucide-icon",30),t.qZA()()),2&g){t.oxw(2);const a=t.MAs(3);t.s9C("matTooltip",t.lcZ(1,2,"lang_auto_tai_ve")),t.Q6J("matMenuTriggerFor",a)}}function K(g,r){if(1&g){const a=t.EpF();t.TgZ(0,"a",31),t.NdJ("click",function(){t.CHM(a);const b=t.oxw(2);return t.KtG(b.showCopySuccess())}),t.ALo(1,"mytranslate"),t.TgZ(2,"span",5),t._UZ(3,"lucide-icon",32),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}if(2&g){const a=t.oxw(2);t.s9C("matTooltip",t.lcZ(1,3,"lang_auto_copy_link_de_thi")),t.Q6J("cdkCopyToClipboard",a.copyLinkExam()),t.xp6(5),t.Oqu(t.lcZ(6,5,"lang_auto_copy_link"))}}function F(g,r){1&g&&(t.TgZ(0,"div",33)(1,"div",34)(2,"span",35),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()()()),2&g&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"lang_auto_dang_chuan_bi_tai_lieu_doing")))}function Y(g,r){if(1&g&&(t.TgZ(0,"div",36),t._UZ(1,"div",37),t.ALo(2,"safeAdminHtmlContent"),t.qZA()),2&g){const a=t.oxw(2);t.xp6(1),t.Q6J("innerHtml",t.lcZ(2,1,a.data.headerContent),t.oJD)}}function G(g,r){if(1&g&&t._UZ(0,"azt-loaded-img",38),2&g){const a=t.oxw(2);t.Q6J("imgSrc",a.data.obj.examHeader)}}function V(g,r){if(1&g&&t._UZ(0,"azt-question-standalone-for-preview",40),2&g){const a=t.oxw(),m=a.$implicit,b=a.index,L=t.oxw(2);t.Q6J("examObj",L.examObj)("questionObj",m)("follower",L.followerRenderQuest)("curQuestionIndex",b)}}function O(g,r){if(1&g&&(t.ynx(0),t.YNc(1,V,1,4,"azt-question-standalone-for-preview",39),t.BQk()),2&g){const a=t.oxw(2);t.xp6(1),t.Q6J("ngIf",a.examObj)}}function N(g,r){if(1&g&&(t.ynx(0),t.TgZ(1,"div",10)(2,"div",11)(3,"div",12)(4,"div",13)(5,"div",14),t.YNc(6,J,4,4,"a",15),t.YNc(7,K,7,7,"a",16),t.qZA()(),t.TgZ(8,"div",17)(9,"a",18)(10,"span",19),t._UZ(11,"lucide-icon",20),t.qZA()()()(),t.TgZ(12,"azt-mat-dialog-content",21),t.YNc(13,F,5,3,"div",22),t.TgZ(14,"div",23),t._UZ(15,"div",24),t.YNc(16,Y,3,3,"div",25),t.YNc(17,G,1,1,"azt-loaded-img",26),t.YNc(18,O,2,1,"ng-container",27),t._UZ(19,"div",28),t.qZA()()()(),t.BQk()),2&g){const a=t.oxw();t.xp6(6),t.Q6J("ngIf",!(null!=a.data&&a.data.globalLadingPage||a.data.allowHeader)),t.xp6(1),t.Q6J("ngIf",0==(null==a.data?null:a.data.isOnLib)&&!(null!=a.data&&a.data.globalLadingPage)),t.xp6(5),t.Q6J("defaultHeight",70),t.xp6(1),t.Q6J("ngIf",a.statusObj.loading),t.xp6(3),t.Q6J("ngIf",a.data.allowHeader&&!a.statusObj.loading),t.xp6(1),t.Q6J("ngIf",null==a.data||null==a.data.obj?null:a.data.obj.examHeader),t.xp6(1),t.Q6J("ngForOf",a.questionList)}}function p(g,r){if(1&g){const a=t.EpF();t.TgZ(0,"azt-export-excel-for-answersheet",41),t.NdJ("exportDataDone",function(b){t.CHM(a);const L=t.oxw();return t.KtG(L.exportDataDone(b))}),t.qZA()}if(2&g){const a=t.oxw();let m;t.Q6J("startQuestionIndex",null!==(m=null==a.examObj?null:a.examObj.startQuestionIndex)&&void 0!==m?m:1)("obj",a.exportExcelData)}}let x=(()=>{class g extends C.e{btnCloseDialog(){this.closeDialog.emit()}copyLinkExam(){return`${this.commonService.getCurrentDomain()}/de-thi/${this.data?.obj?.hashId}`}showCopySuccess(){this.commonService.snackSuccess("lang_auto_sao_chep_thanh_cong")}downloadExam(){let a=this.commonService.myTranslateInstant("lang_auto_dang_khoi_tao_du_lieu")??"";j.G.openLoadingEffect(`${a}...`);let m={nameSchool:this.printAddInfo.nameSchool??"",nameSubject:this.printAddInfo.nameSubject??""},b=this.printAddInfo.templateType??0;this.data.obj&&(this.data.obj.hideGroupQuestion=0,this.exportSAztDocxService.downloadExam(!1,{...this.data.obj,editable:!1,allowStudentView:!0},void 0,void 0,this.cloneQuestionList,m,b,void 0,void 0,void 0,!0).catch(L=>{this.showErrorSnack(L.message)}))}getData(a){this.initStatusObj(),this.data?.globalLadingPage?this.examService.apiExamGetGlobalQuestionsIdGet(a?.id??0).subscribe(m=>{const b=this.commonService.castJsonToClassObjs(o.v,JSON.stringify(m.data?.questionObjs||[]))??[];this.followerRenderQuest.setNumQuest(b.length),this.addRoleQuestion(b),this.cloneQuestionList=this.commonService.myClone(b),this.questionList=b,this.examObj=m.data?.examObj,this.successStatusObj()}):this.permissionService.hasViewPermission("exam",a)?this.examService.apiExamGetQuestionsIdGet(a?.id??0).subscribe(m=>{const b=this.commonService.castJsonToClassObjs(o.v,JSON.stringify(m.data?.questionObjs||[]))??[];this.followerRenderQuest.setNumQuest(b.length),this.addRoleQuestion(b),this.cloneQuestionList=this.commonService.myClone(b),this.questionList=b,this.examObj=m.data?.examObj,this.successStatusObj()}):this.showErrorSnack("lang_auto_ban_khong_co_quyen_thuc_thi_chuc_nang_nay")}addRoleQuestion(a){for(let m=0;m<a.length;m++)a[m].isRoleTeacher=!0}downloadExamAnswer(){this.subscriptions.add(this.offlineExamExportService.apiOfflineExamExportExportResultOfRawExamGet(this.examObj?.hashId??"").subscribe(a=>{if(1===a.success){let m=a.data?.obj;m?.offlineMixQuestionObjs&&m.offlineMixQuestionObjs.length>0&&(this.exportExcelData=this.commonService.myClone(m))}else this.errorStatusObj(a.message??"")}))}exportDataDone(a){let m=this.createNameExam("answerexcel",!1);this.shareFileFlutterService.shareFileWithBlob(a,m)}createNameExam(a,m){let b="";b="answersheet"==a?this.printAnswersheetService.exportFileNameOfAnswerSheet(0,this.examObj?.name??"",""):"answerexcel"==a?this.printAnswersheetService.exportFileNameOfAnswerExcelOffline(0,this.examObj?.name??"",""):this.printAnswersheetService.exportFileNameOfExamOffline(0,this.examObj?.name??"","",void 0),m&&(b=this.commonService.replaceAll(b,"_","-")??"");let L=".docx";return L="answersheet"==a?".pdf":L,L="answerexcel"==a?".xlsx":L,b+L}ngOnChanges(){this.data?.obj&&this.getData(this.data.obj)}ngOnInit(){this.data?.obj&&this.getData(this.data.obj),super.ngOnInit()}constructor(a,m,b,L,_,w,l,i,c){super(c,i),this.shareFileFlutterService=a,this.baseApiService=m,this.permissionService=b,this.exportSAztDocxService=L,this.examService=_,this.offlineExamExportService=w,this.printAnswersheetService=l,this.dialogRef=i,this.data=c,this.closeDialog=new t.vpe,this.questionList=[],this.cloneQuestionList=[],this.followerRenderQuest=new y.p,this.printAddInfo={}}}return g.\u0275fac=function(a){return new(a||g)(t.Y36(d.g),t.Y36(f.V),t.Y36(u.j),t.Y36(A.F),t.Y36(S.O),t.Y36(P.qr),t.Y36(e.s),t.Y36(s.so,8),t.Y36(s.WI,8))},g.\u0275cmp=t.Xpm({type:g,selectors:[["azt-preview-exam"]],outputs:{closeDialog:"closeDialog"},features:[t.qOj,t.TTD],decls:19,vars:11,consts:[[4,"ngIf"],["menuDownload","matMenu"],[1,"dropdown-menu","show","relative","w-56"],[1,"dropdown-content"],["azt-track-service","azt-preview-exam-4UtiW7OU6PC",1,"dropdown-item",3,"click"],[1,"w-4","h-4","mr-2","flex-none"],["name","file-check"],["azt-track-service","azt-preview-exam--mJB2JKFgNu",1,"dropdown-item",3,"click"],["name","file-spreadsheet"],[3,"startQuestionIndex","obj","exportDataDone",4,"ngIf"],[1,"az-dialog-info"],[1,"box",2,"overflow-x","hidden"],[1,"flex","items-center","p-2","bg-slate-100","dark:bg-darkmode-400"],[1,"mr-auto"],[1,"flex","items-center","mr-2"],["class","btn btn-sm btn-outline-secondary btn-transparent mr-2",3,"matTooltip","matMenuTriggerFor",4,"ngIf"],["azt-track-service","azt-preview-exam-dgdyLZO48Hq","class","btn btn-sm btn-outline-secondary btn-transparent mr-2",3,"matTooltip","cdkCopyToClipboard","click",4,"ngIf"],[1,"ml-auto"],["azt-track-service","azt-preview-exam-y2xqBN7DlGX",1,"btn","btn-transparent","btn-outline-danger","btn-sm",3,"mat-dialog-close"],[1,"w-4","h-4","flex-none"],["name","x"],[1,"mt-3",3,"defaultHeight"],["class","flex justify-center items-center h-40",4,"ngIf"],["id","boxContentQuestion",1,"p-2"],[1,"pt-3"],["class","box p-3 mb-3",4,"ngIf"],["style","display: block","class","mt-5",3,"imgSrc",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"py-5"],[1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"matTooltip","matMenuTriggerFor"],["name","download"],["azt-track-service","azt-preview-exam-dgdyLZO48Hq",1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"matTooltip","cdkCopyToClipboard","click"],["name","copy"],[1,"flex","justify-center","items-center","h-40"],["role","status",1,"spinner-border"],[1,"sr-only"],[1,"box","p-3","mb-3"],[2,"line-height","1.5",3,"innerHtml"],[1,"mt-5",2,"display","block",3,"imgSrc"],[3,"examObj","questionObj","follower","curQuestionIndex",4,"ngIf"],[3,"examObj","questionObj","follower","curQuestionIndex"],[3,"startQuestionIndex","obj","exportDataDone"]],template:function(a,m){1&a&&(t.YNc(0,N,20,7,"ng-container",0),t.ALo(1,"viewPermission"),t.TgZ(2,"mat-menu",null,1)(4,"div",2)(5,"ul",3)(6,"li")(7,"a",4),t.NdJ("click",function(){return m.downloadExam()}),t.TgZ(8,"span",5),t._UZ(9,"lucide-icon",6),t.qZA(),t._uU(10),t.ALo(11,"mytranslate"),t.qZA()(),t.TgZ(12,"li")(13,"a",7),t.NdJ("click",function(){return m.downloadExamAnswer()}),t.TgZ(14,"span",5),t._UZ(15,"lucide-icon",8),t.qZA(),t._uU(16),t.ALo(17,"mytranslate"),t.qZA()()()()(),t.YNc(18,p,1,2,"azt-export-excel-for-answersheet",9)),2&a&&(t.Q6J("ngIf",t.xi3(1,4,null==m.data?null:m.data.obj,"exam")||(null==m.data?null:m.data.globalLadingPage)),t.xp6(10),t.hij(" ",t.lcZ(11,7,"lang_auto_tai_xuong_de_thi")," "),t.xp6(6),t.hij(" ",t.lcZ(17,9,"lang_auto_tai_xuong_dap_an_de_thi")," "),t.xp6(2),t.Q6J("ngIf",null!=m.exportExcelData))},dependencies:[z.sg,z.O5,E.i3,s.ZT,D.VK,D.p6,v.gM,M.Nh5,Z.y,B.A,R.R,W.S,Q.JV,Q.Tm,Q.J7],encapsulation:2}),g})()},14099:(U,I,n)=>{n.d(I,{h:()=>t});var t=function(s){return s.COPY="copy",s.CUT="cut",s.DELETE="delete",s}(t||{})},36058:(U,I,n)=>{n.d(I,{Y:()=>t});var t=function(s){return s[s.EXAM_CATEGORY=0]="EXAM_CATEGORY",s[s.EXAM=1]="EXAM",s}(t||{})},43151:(U,I,n)=>{n.d(I,{e:()=>y});var t=n(14099),s=n(36058),j=n(65879);let y=(()=>{class C{constructor(){this.clipboardObjs=[]}setActionToClipboard(d,f,u,A){var S={id:d,name:A,type:f,action:u};this.clipboardObjs.filter(e=>e.id==S.id&&e.type==S.type).length>0?this.clipboardObjs.forEach(e=>{e.id==S.id&&e.type==S.type&&(e.action=S.action)}):this.clipboardObjs.push(S)}hasInClipboard(d,f){return this.clipboardObjs.filter(A=>A.id==d&&A.type==f).length>0}hasCopyFolderActionInClipboard(){var d=!1;return this.clipboardObjs.forEach(f=>{f.type==s.Y.EXAM_CATEGORY&&f.action==t.h.COPY&&(d=!0)}),d}getActionOfDocumentObj(d,f){var u=this.clipboardObjs.filter(A=>A.id==d&&A.type==f);if(u&&u.length>0)return u[0].action}removeDocumentInClipboard(d,f){for(var u=0;u<this.clipboardObjs.length;u++)this.clipboardObjs[u].id==d&&this.clipboardObjs[u].type==f&&this.clipboardObjs.splice(u,1)}isPasteToSelfFolder(d){var f=!1;return this.clipboardObjs.forEach(u=>{u.id==d&&u.type==s.Y.EXAM_CATEGORY&&u.action==t.h.COPY&&(f=!0)}),f}getCurrentClipBoard(){return this.clipboardObjs}resetClipBoardAfterPasteOrCancelAllActions(){this.clipboardObjs=[]}}return C.\u0275fac=function(d){return new(d||C)},C.\u0275prov=j.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()},83746:(U,I,n)=>{n.d(I,{M:()=>t});class t{static studentCheckBoxValidator(j){const y=j.value.controls?.whoAllow,C=j.value.controls?.studentIds;return y&&C?"3"==y?.value&&t.countCheckBox(C.value)<1?(C?.setErrors({checkboxValidator:!0}),{identityRevealed:!0}):(C?.setErrors(null),null):null}static countCheckBox(j){for(var y=0,C=0;C<j.length;C++)j[C].listStudents?.length&&j[C].listStudents?.forEach(o=>{o.choose&&(y+=1)});return y}}},88135:(U,I,n)=>{n.d(I,{Y:()=>p});var t=n(29023),s=n(56223),j=n(73445),y=n(23680),C=n(19347),o=n(16019),d=n(88620),f=n(90241),u=n(35187),A=n(35318),S=n(217),P=n(83746),e=n(65879),z=n(51488),E=n(94281),D=n(79107),v=n(96814),M=n(95545),Z=n(775),B=n(10463),R=n(74438),W=n(47859),Q=n(65110),J=n(91190);function K(x,g){1&x&&(e.TgZ(0,"div",5),e.O4$(),e.TgZ(1,"svg",6)(2,"g",7)(3,"g",8),e._UZ(4,"circle",9),e.TgZ(5,"path",10),e._UZ(6,"animateTransform",11),e.qZA()()()()())}function F(x,g){1&x&&(e.TgZ(0,"div",49),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&x&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"lang_testbank_test_config_you_not_yet_class")," "))}function Y(x,g){if(1&x&&(e.TgZ(0,"div",47),e.YNc(1,F,3,3,"div",48),e.qZA()),2&x){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.form.controls.classroomIds.errors.checkboxValidator||0==r.countCheckedClassroom)}}function G(x,g){1&x&&(e.TgZ(0,"div",49),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&x&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"lang_testbank_test_config_you_not_yet_student")," "))}function V(x,g){if(1&x&&(e.TgZ(0,"div",47),e.YNc(1,G,3,3,"div",48),e.qZA()),2&x){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.form.controls.studentIds.errors.checkboxValidator)}}const O=function(x){return{"h-56-important":x}};function N(x,g){if(1&x){const r=e.EpF();e.TgZ(0,"div",12)(1,"form",13)(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17),e._uU(6),e.ALo(7,"mytranslate"),e.qZA()(),e.TgZ(8,"div",18)(9,"div",19)(10,"div",20)(11,"input",21),e.NdJ("change",function(){e.CHM(r);const m=e.oxw();return e.KtG(m.clearAllCheckBox(0))}),e.qZA(),e.TgZ(12,"label",22),e._uU(13),e.ALo(14,"mytranslate"),e.qZA()(),e.TgZ(15,"div",23)(16,"input",24),e.NdJ("change",function(){e.CHM(r);const m=e.oxw();return e.KtG(m.clearAllCheckBox(2))}),e.qZA(),e.TgZ(17,"label",25),e._uU(18),e.ALo(19,"mytranslate"),e.qZA()(),e.TgZ(20,"div",26)(21,"input",27),e.NdJ("change",function(){e.CHM(r);const m=e.oxw();return e.KtG(m.clearAllCheckBox(3))}),e.qZA(),e.TgZ(22,"label",28),e._uU(23),e.ALo(24,"mytranslate"),e.qZA()()()(),e.TgZ(25,"div",29)(26,"div",30)(27,"div",31)(28,"h3",32),e._uU(29),e.ALo(30,"mytranslate"),e.ALo(31,"mytranslate"),e.qZA(),e.TgZ(32,"div",33)(33,"div",34),e._UZ(34,"azt-list-classroom-check-all",35),e.qZA(),e.TgZ(35,"div",36),e._UZ(36,"azt-is-show-check-classroom",37),e.qZA()()(),e.TgZ(37,"div",38)(38,"ng-scrollbar",39)(39,"azt-list-classroom-checkbox",40),e.NdJ("objsChange",function(m){e.CHM(r);const b=e.oxw();return e.KtG(b.classroomObjs=m)}),e.qZA()()()()(),e.YNc(40,Y,2,1,"div",41),e.TgZ(41,"div",29)(42,"div",30)(43,"div",42)(44,"h3",32),e._uU(45),e.ALo(46,"mytranslate"),e.qZA()(),e.TgZ(47,"div",38)(48,"ng-scrollbar",39),e._UZ(49,"list-student-checkbox",43),e.qZA()()()(),e.YNc(50,V,2,1,"div",41),e.qZA()()()(),e.TgZ(51,"div",44)(52,"button",45),e.NdJ("click",function(){e.CHM(r);const m=e.oxw();return e.KtG(m.closeDialog())}),e._uU(53),e.ALo(54,"mytranslate"),e.qZA(),e.TgZ(55,"button",46),e.NdJ("click",function(){e.CHM(r);const m=e.oxw();return e.KtG(m.savePublishExam("save"))}),e._uU(56),e.ALo(57,"mytranslate"),e.qZA()()}if(2&x){const r=e.oxw();e.xp6(1),e.Q6J("formGroup",r.form),e.xp6(5),e.hij(" ",e.lcZ(7,35,"lang_testbank_test_config_who_tested")," "),e.xp6(7),e.hij(" ",e.lcZ(14,37,"lang_testbank_test_config_all_people")," "),e.xp6(5),e.hij(" ",e.lcZ(19,39,"lang_testbank_test_config_assigne_class")," "),e.xp6(5),e.hij(" ",e.lcZ(24,41,"lang_testbank_test_config_assigne_student")," "),e.xp6(2),e.Q6J("hidden",2!=r.form.controls.whoAllow.value),e.xp6(4),e.AsE(" ",e.lcZ(30,43,"lang_auto_danh_sach_cac_lop")," (",e.lcZ(31,45,"lang_auto_da_chon")+": "+r.countCheckedClassroom+"/"+r.form.controls.classroomIds.value.length,") "),e.xp6(5),e.Q6J("formArray",r.form.controls.classroomIds)("objs",r.classroomObjs)("permissionName",r.permissionTypes.exam),e.xp6(2),e.Q6J("form",r.form),e.xp6(2),e.Q6J("visibility","hover")("autoHeightDisabled",!1)("ngClass",e.VKq(53,O,r.isMobileWebView)),e.xp6(1),e.Q6J("form",r.form)("formArrayName","classroomIds")("objs",r.classroomObjs)("examClassroomObjs",r.examClassroomObjs)("permissionName",r.permissionTypes.exam),e.xp6(1),e.Q6J("ngIf",r.form.controls.classroomIds.errors),e.xp6(1),e.Q6J("hidden",3!=r.form.controls.whoAllow.value),e.xp6(4),e.hij(" ",e.lcZ(46,47,"lang_test_config_student_list")," "),e.xp6(3),e.Q6J("visibility","hover")("autoHeightDisabled",!1)("ngClass",e.VKq(55,O,r.isMobileWebView)),e.xp6(1),e.Q6J("form",r.form)("formArrayName","studentIds")("objs",r.classroomObjs)("examStudentObjs",r.data.examStudents)("permissionName",r.permissionTypes.exam),e.xp6(1),e.Q6J("ngIf",3==r.form.controls.whoAllow.value&&r.form.controls.studentIds.errors),e.xp6(3),e.hij(" ",e.lcZ(54,49,"lang_auto_huy")," "),e.xp6(2),e.Q6J("disabled",1==r.form.controls.whoAllow.value&&r.form.invalid||2==r.form.controls.whoAllow.value&&!r.hasClassroomIdChecked||3==r.form.controls.whoAllow.value&&r.form.controls.studentIds.errors),e.xp6(1),e.hij(" ",e.lcZ(57,51,"lang_auto_luu")," ")}}let p=(()=>{class x extends f.e{clearAllCheckBox(r){1==r?this.isSelectClassroom=!1:2==r&&(this.isSelectClassroom=!0)}closeDialog(r){this.dialogRef.close(r)}get hasClassroomIdChecked(){var r=this.form.getRawValue();let a=!1;for(let m=0;m<r.classroomIds.length;m++)if(r.classroomIds[m]){a=!0;break}return a}savePublishExam(r){if(1==this.form.getRawValue().whoAllow&&this.form.invalid||2==this.form.getRawValue().whoAllow&&!this.hasClassroomIdChecked)return void this.showErrorSnack("lang_auto_vui_long_nhap_day_du_thong_tin");this.initStatusObj();let a="publish"===r?1:void 0;var m=this.form.getRawValue(),b=this.sAztClassroomCheckboxService.findClassroomWithNoPermission(this.classroomObjs,u.y.exam);const L=this.sAztClassroomCheckboxService.getClassroomIdsChecked(this.classroomObjs,b,m.classroomIds);let _=[];3==m.whoAllow&&m.studentIds&&m.studentIds.length?m.studentIds.forEach(c=>{let h={classroomId:c.classroomId??0,assignStudentIds:[]};c.listStudents?.forEach(T=>{T.id&&T.choose&&h.assignStudentIds?.push(T.id)}),h.assignStudentIds?.length&&_?.push(h)}):_=void 0;let w={whoAllow:m.whoAllow,isPublished:a??void 0,classroomIds:L,assignStudents:_,isSaveConfig:0};var l=this.permissionService.hasEditPermission("exam",this.obj)?this.documentConfigService.apiDocumentConfigSaveExamConfigPost(this.hashId,w):this.documentConfigService.apiDocumentConfigSaveExamDataForConfigClassroomPost(this.hashId,w);this.subscriptions.add(l.subscribe(i=>{1==i.success?(this.successStatusObj(),this.showSuccessSnack("lang_auto_luu_thanh_cong"),this.closeDialog(i.data?.obj)):this.errorStatusObj(i.message??"",!0)}))}getExamDataByHashId(r){this.initStatusObj(),this.subscriptions.add(this.documentConfigService.apiDocumentConfigGetExamDataForConfigClassroomGet(r).subscribe(a=>{if(1==a.success){if(null!=a.data){var b,m=a.data?.examObj;if(!(b=this.castObj(m)))return;b.limitQuestionGroupsParse=this.commonService.myParseJson(m.limitQuestionGroups??""),this.obj=b,this.hashId=this.obj.hashId??"",this.classroomObjs=a.data.classroomObjs??new Array,this.examClassroomObjs=a.data.examClassroomObjs??[],this.form.patchValue({whoAllow:this.obj.whoAllow}),this.isSelectClassroom=2==this.obj.whoAllow,this.successStatusObj()}}else this.errorStatusObj(a.message??"",!0)}))}ngOnChanges(){this.form.controls.classroomIds.valueChanges.subscribe(r=>{this.countCheckedClassroom=this.form.controls.classroomIds.controls.filter(a=>a.value).length,this.cd.detectChanges()})}ngOnInit(){this.form.valueChanges.subscribe(r=>{let a=JSON.stringify(r);a!=this.prevData&&(this.prevData=a,this.form.patchValue(r))}),this.form.controls.classroomIds.valueChanges.subscribe(r=>{this.countCheckedClassroom=this.form.controls.classroomIds.controls.filter(a=>a.value).length,this.cd.detectChanges()}),this.getExamDataByHashId(this.hashId),super.ngOnInit()}constructor(r,a,m,b,L,_){super(L,b),this.cd=r,this.documentConfigService=a,this.permissionService=m,this.dialogRef=b,this.data=L,this.sAztClassroomCheckboxService=_,this.permissionTypes=u.y,this.checkDialogFastContent=[],this.prevData="",this.classroomObjs=[],this.examClassroomObjs=[],this.isSelectClassroom=!1,this.hashId="",this.countCheckedClassroom=0,this.hashId=L.hashId,this.form=new s.cw({whoAllow:new s.NI(0,{nonNullable:!0}),classroomIds:new s.Oe([]),studentIds:new s.Oe([]),isShowCheckClass:new s.NI(!1,{nonNullable:!0})},{validators:[S.h.classroomCheckBoxValidator,P.M.studentCheckBoxValidator]})}}return x.\u0275fac=function(r){return new(r||x)(e.Y36(e.sBO),e.Y36(z.C),e.Y36(E.j),e.Y36(C.so,8),e.Y36(C.WI,8),e.Y36(D.f))},x.\u0275cmp=e.Xpm({type:x,selectors:[["config-online-exam-dialog"]],features:[e._Bn([{provide:t.fM,useClass:o.WG,deps:[y.Ad,j.o8]},{provide:t.ab,useFactory:d.hx,deps:[A.D]}]),e.qOj,e.TTD],decls:6,vars:2,consts:[[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],["class","loading flex items-center justify-center",4,"ngIf","ngIfElse"],["doneLoading",""],[1,"loading","flex","items-center","justify-center"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","rgb(30, 41, 59)",1,"w-8","h-8"],["fill","none","fill-rule","evenodd"],["transform","translate(1 1)","stroke-width","4"],["stroke-opacity",".5","cx","18","cy","18","r","18"],["d","M36 18c0-9.94-8.06-18-18-18"],["attributeName","transform","type","rotate","from","0 18 18","to","360 18 18","dur","1s","repeatCount","indefinite"],[1,"col-md-12","setting"],[3,"formGroup"],[1,"setting-base"],["id","azt-config-who-allow",1,"grid","grid-cols-12","mt-4"],[1,"col-span-12","lg:col-span-3","pr-2"],[1,"mb-0","font-medium","flex","items-center"],[1,"col-span-12","lg:col-span-9"],[1,"flex","flex-col","sm:flex-row"],[1,"form-check","mr-5"],["id","config-who-all","formControlName","whoAllow","type","radio","value","0",1,"form-check-input",3,"change"],["for","config-who-all",1,"form-check-label"],[1,"form-check","mt-2","sm:mt-0","mr-5"],["id","config-who-class","formControlName","whoAllow","type","radio","value","2",1,"form-check-input",3,"change"],["for","config-who-class",1,"form-check-label"],[1,"form-check","mt-2","sm:mt-0"],["id","config-who-student","formControlName","whoAllow","type","radio","value","3",1,"form-check-input",3,"change"],["for","config-who-student",1,"form-check-label"],[1,"col-span-12","mt-4","intro-y",3,"hidden"],[1,"border","border-slate-200/60","dark:border-darkmode-400","rounded-md","pb-1"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","flex-col","sm:flex-row","sm:h-auto","sm:items-center"],[1,"mr-auto"],[1,"flex","mt-2","sm:mt-0"],[1,"mr-3"],[3,"formArray","objs","permissionName"],[1,"mr-0"],[3,"form"],[1,"classroom_list"],["pointerEventsMethod","scrollbar",1,"w-full",3,"visibility","autoHeightDisabled","ngClass"],[3,"form","formArrayName","objs","examClassroomObjs","permissionName","objsChange"],["class","col-span-12 mt-2 intro-y",4,"ngIf"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","items-center"],[3,"form","formArrayName","objs","examStudentObjs","permissionName"],[1,"text-right","mt-4"],["azt-track-service","config-exam-classroom-6-a-m4KztM",1,"btn","w-24","btn-secondary","mr-3",3,"click"],["azt-track-service","config-exam-classroom-brv1ZZTsfLY",1,"btn","w-24","btn-primary",3,"disabled","click"],[1,"col-span-12","mt-2","intro-y"],["class","text-xs text-danger",4,"ngIf"],[1,"text-xs","text-danger"]],template:function(r,a){if(1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,K,7,0,"div",3),e.YNc(4,N,58,57,"ng-template",null,4,e.W1O),e.qZA()()()),2&r){const m=e.MAs(5);e.xp6(3),e.Q6J("ngIf",a.statusObj.loading)("ngIfElse",m)}},dependencies:[v.mk,v.O5,M.KC,s._Y,s.Fj,s._,s.JJ,s.JL,s.sg,s.u,s.CE,Z.M,B.B,R.V,W.M,Q.V,J.JV],styles:["input[_ngcontent-%COMP%]::placeholder{color:#b2b2b2!important}.test-config[_ngcontent-%COMP%]{width:620px}.loading[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center}.setting-title[_ngcontent-%COMP%]{text-transform:uppercase;margin-bottom:5px;font-size:14px;color:#2262ae}.setting-block[_ngcontent-%COMP%]{background:#fff}.setting-item[_ngcontent-%COMP%]{margin-bottom:15px}.setting-input[_ngcontent-%COMP%]{height:100%;border-left:0px;border-top-left-radius:0;border-bottom-left-radius:0}.setting-label[_ngcontent-%COMP%]{padding:15px;align-self:center;line-height:1.5;color:#495057;background-color:#e9ecef;border:1px solid #ced4da;border-bottom-left-radius:5px;border-top-left-radius:5px}.setting-form-input[_ngcontent-%COMP%]{padding:8.3px 15px;line-height:1.5;font-size:1rem;color:#495057;background-color:#fff;border:1px solid #ced4da;border-bottom-right-radius:.25rem;border-top-right-radius:.25rem}.setting-field-time[_ngcontent-%COMP%]{border:1px solid #ced4da;border-radius:3px;text-align:center;padding:0}.p-custom[_ngcontent-%COMP%]{padding:12.8px 15px}.setting-advanced[_ngcontent-%COMP%]{margin-top:20px}.setting-head[_ngcontent-%COMP%]{margin-bottom:10px;display:flex;align-items:center}.setting-label-textarea[_ngcontent-%COMP%]{align-self:initial;display:flex;justify-content:center;align-items:center}.setting-textarea[_ngcontent-%COMP%]{height:120px}.picker-icon[_ngcontent-%COMP%]{cursor:pointer;position:absolute;width:16px;height:0;font-size:16px;right:0}.btn-transparent[_ngcontent-%COMP%]{display:flex;align-items:center;border:none;background:transparent}.btn-transparent[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-left:20px;color:#2262ae}.more-link[_ngcontent-%COMP%]{color:#2262ae;transition:all .5s}.more-link[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{color:#103767}.label-custom[_ngcontent-%COMP%]{padding:45px 15px}  .mat-checkbox-layout{margin-bottom:0}small[_ngcontent-%COMP%]{color:#0006}.box-input[_ngcontent-%COMP%]{margin:0 5px;border:1px solid #ccc;height:24px;border-radius:3px;padding-left:5px;width:60px}.full-width[_ngcontent-%COMP%]{width:100%;max-width:100%}.w-92[_ngcontent-%COMP%]{width:92%!important}.w-9325[_ngcontent-%COMP%]{width:93.25%!important}.info_field[_ngcontent-%COMP%]{margin:8px 0}.form-field-custom[_ngcontent-%COMP%]{background-color:#0000000a;border:1px solid rgba(206,212,218,.6980392157);border-radius:.25rem;padding:5px 8px}.custom-input[_ngcontent-%COMP%], .custom-input-btn[_ngcontent-%COMP%]{border:none;width:100%;padding:5px;margin-left:5px}.border-auto[_ngcontent-%COMP%]{border:1px solid #dc3545}.custom-input[_ngcontent-%COMP%]:hover{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem #007bff40}.custom-input[_ngcontent-%COMP%]:focus{outline-width:1px}.form-custom[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}@media only screen and (max-width: 1196px){  .mat-radio-label-content{white-space:normal}}@media only screen and (max-width: 350px){.test-config__box--grid[_ngcontent-%COMP%]{display:grid}}[type=number][_ngcontent-%COMP%]{appearance:none;appearance:textfield;-webkit-appearance:none;-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.word-wrap[_ngcontent-%COMP%]{word-break:break-word}.school-info_bg[_ngcontent-%COMP%]{width:100%}.note[_ngcontent-%COMP%]{font-style:italic;font-size:13px;font-weight:600}.dialog-title[_ngcontent-%COMP%]{font-size:18px;font-weight:500;text-align:center}.infor_box[_ngcontent-%COMP%]{background-color:#fff;border:1px solid rgba(206,212,218,.6980392157);border-radius:.25rem;margin:8px 0}.no_select[_ngcontent-%COMP%]{-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}.custom-mix-question-height[_ngcontent-%COMP%]{height:160px}.custom-invalid-mix-form[_ngcontent-%COMP%]{border-color:#dc3545}.custom-mix-group-question[_ngcontent-%COMP%]{background-color:#e9ecef;padding-left:0!important;padding-right:0!important;margin-left:0!important;margin-right:0!important;padding-bottom:0!important;border:1px solid #ced4da;border-radius:.25rem}.test-config__formMixQuestion[_ngcontent-%COMP%]{border:none;border-left:1px solid #ced4da}.no-border[_ngcontent-%COMP%]{border:none}.btn-offline[_ngcontent-%COMP%]{background:#ec9b00;color:#fff;transition:all .5s}.btn-offline[_ngcontent-%COMP%]:hover{background:#c8860b}.custom-select[_ngcontent-%COMP%]{height:100%;border-top-left-radius:0;border-bottom-left-radius:0;border-left:none}.custom-select-md[_ngcontent-%COMP%]{border:1px solid #ced4da;border-radius:.25rem}.btn-width[_ngcontent-%COMP%]{width:140px}.classroom_list[_ngcontent-%COMP%]{height:220px;white-space:nowrap;padding-left:2px;overflow:hidden}.badge-info[_ngcontent-%COMP%]{color:#fff;background-color:#2361ae}.setting-block-mix[_ngcontent-%COMP%]{height:180px;overflow:hidden;padding-bottom:40px}.hiddenTooltip[_ngcontent-%COMP%]{position:absolute;visibility:hidden;left:140px;width:0;top:3em}  .mat-checkbox-layout .mat-checkbox-label{font-weight:400}.px-15[_ngcontent-%COMP%]{padding-right:15px;padding-left:15px}.flex-around[_ngcontent-%COMP%]{justify-content:space-around}.setting-form-input-v2[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;justify-content:center;padding-right:0}.setting-block-mix-head[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding-right:20px}.py-azt-4[_ngcontent-%COMP%]{padding:30px 15px}@media only screen and (max-width: 1024px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:95%}.block-icon[_ngcontent-%COMP%]{right:20px}}@media screen and (max-width: 768px){.setting-label[_ngcontent-%COMP%]{color:#495057;background-color:transparent;border:none;padding:0;font-weight:500;text-align:left;margin-bottom:10px}.classroom_list[_ngcontent-%COMP%]{white-space:pre-wrap;padding-left:2px;overflow:auto}.setting-form-input[_ngcontent-%COMP%]{padding:10px 15px;color:#495057;background-color:#fff;border:1px solid #ced4da;border-radius:.25rem}.setting-input[_ngcontent-%COMP%]{border-radius:.25rem;border:1px solid #ced4da;min-height:65px}.btn-azt-block[_ngcontent-%COMP%]{display:block;margin-bottom:10px}.px-15[_ngcontent-%COMP%]{padding-right:0}.flex-around[_ngcontent-%COMP%]{justify-content:flex-start}.mt-md-10[_ngcontent-%COMP%]{margin-top:10px}.setting-block-mix[_ngcontent-%COMP%]{height:auto}.setting-form-input-v2[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;justify-content:center}.setting-field-time[_ngcontent-%COMP%]{margin-top:10px}.paddingCustom[_ngcontent-%COMP%]{padding:0!important}.setting-block-mix-head[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.py-azt-4[_ngcontent-%COMP%]{padding:0}.setting-label-textarea[_ngcontent-%COMP%]{justify-content:flex-start}.test-config[_ngcontent-%COMP%]{width:auto}}"]}),x})()},65110:(U,I,n)=>{n.d(I,{V:()=>L});var t=n(65879),s=n(56223),j=n(65592),y=n(35187),C=n(39621),o=n(19347),d=n(90241),f=n(96814),u=n(92596),A=n(775),S=n(30251),P=n(10134),e=n(91190);function z(_,w){1&_&&(t.ynx(0),t._uU(1),t.ALo(2,"mytranslate"),t.BQk()),2&_&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_remove_all")," "))}function E(_,w){1&_&&(t._uU(0),t.ALo(1,"mytranslate")),2&_&&t.hij(" ",t.lcZ(1,1,"lang_select_all")," ")}function D(_,w){if(1&_){const l=t.EpF();t.TgZ(0,"span")(1,"div",15)(2,"input",16),t.NdJ("change",function(){t.CHM(l);const c=t.oxw(3).$implicit,h=t.oxw(2);let T;return t.KtG(h.selectAllStudentOfClass(null==(T=c.get("classroomId"))?null:T.value))}),t.qZA(),t.TgZ(3,"label",17),t.YNc(4,z,3,3,"ng-container",13),t.YNc(5,E,2,3,"ng-template",null,18,t.W1O),t.qZA()()()}if(2&_){const l=t.MAs(6),i=t.oxw(3).$implicit;let c;t.xp6(2),t.Q6J("checked",null==(c=i.get("selectAll"))?null:c.value),t.xp6(2),t.Q6J("ngIf",i.get("selectAll").value)("ngIfElse",l)}}function v(_,w){1&_&&(t.ynx(0),t.TgZ(1,"div",19)(2,"div",20),t._UZ(3,"azt-loading-ui",21),t.qZA()(),t.BQk()),2&_&&(t.xp6(3),t.Q6J("type","oval"))}function M(_,w){1&_&&(t.ynx(0),t.TgZ(1,"div",23)(2,"span"),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.BQk()),2&_&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"lang_core_class_has_no_student")))}function Z(_,w){if(1&_){const l=t.EpF();t.TgZ(0,"div",28)(1,"div",29)(2,"input",30),t.NdJ("change",function(c){t.CHM(l);const h=t.oxw(6).$implicit,T=t.oxw(2);let k;return t.KtG(T.selectStudent(c,null==(k=h.get("classroomId"))?null:k.value))}),t.qZA(),t.TgZ(3,"label",31),t.ALo(4,"mytranslate"),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()()}if(2&_){const l=w.$implicit;let i,c,h,T;t.xp6(1),t.Q6J("formGroup",l),t.xp6(1),t.s9C("id","azt-checkbox-student-"+(null==(i=l.get("id"))?null:i.value)),t.xp6(1),t.s9C("for","azt-checkbox-student-"+(null==(c=l.get("id"))?null:c.value)),t.Q6J("matTooltip",t.lcZ(4,5,null==(h=l.get("name"))?null:h.value)),t.xp6(2),t.Oqu(t.lcZ(6,7,null==(T=l.get("name"))?null:T.value))}}function B(_,w){if(1&_&&(t.TgZ(0,"div",26),t.YNc(1,Z,7,9,"div",27),t.qZA()),2&_){const l=t.oxw(5).$implicit;let i;t.xp6(1),t.Q6J("ngForOf",null==(i=l.get("listStudents"))?null:i.controls)}}function R(_,w){if(1&_&&(t.TgZ(0,"azt-mat-dialog-content",24),t.YNc(1,B,2,1,"div",25),t.qZA()),2&_){const l=t.oxw(4).$implicit;let i;t.Q6J("defaultHeight",60),t.xp6(1),t.Q6J("ngIf",(null==(i=l.get("show"))?null:i.value)&&(null==(i=l.get("listStudents"))?null:i.controls.length))}}function W(_,w){if(1&_&&(t.YNc(0,M,5,3,"ng-container",13),t.YNc(1,R,2,2,"ng-template",null,22,t.W1O)),2&_){const l=t.MAs(2),i=t.oxw(3).$implicit;let c;t.Q6J("ngIf",(null==(c=i.get("show"))?null:c.value)&&!(null!=(c=i.get("listStudents"))&&c.controls.length))("ngIfElse",l)}}function Q(_,w){if(1&_&&(t.TgZ(0,"div",10)(1,"div",11)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,D,7,3,"span",8),t.qZA(),t.YNc(5,v,4,1,"ng-container",13),t.YNc(6,W,3,2,"ng-template",null,14,t.W1O),t.qZA()),2&_){const l=t.MAs(7),i=t.oxw(2).$implicit,c=t.oxw(2);let h,T;t.Q6J("formGroup",i),t.xp6(3),t.hij(" ",c.data.classroomName," "),t.xp6(1),t.Q6J("ngIf",null==(h=i.get("listStudents"))?null:h.controls.length),t.xp6(1),t.Q6J("ngIf",null==(T=i.get("loadingStudents"))?null:T.value)("ngIfElse",l)}}const J=function(_){return{permissionObj:_}};function K(_,w){if(1&_&&(t.TgZ(0,"div"),t.YNc(1,Q,8,5,"div",9),t.ALo(2,"createPermission"),t.qZA()),2&_){const l=t.oxw().$implicit,i=t.oxw(2);let c;t.xp6(1),t.Q6J("ngIf",null!=(null==(c=l.get("permissionObjs"))?null:c.value)&&t.xi3(2,1,t.VKq(4,J,null==(c=l.get("permissionObjs"))?null:c.value),i.listPermissionTypes[i.data.permissionName]))}}function F(_,w){if(1&_&&(t.ynx(0,7),t.YNc(1,K,3,6,"div",8),t.BQk()),2&_){const l=w.$implicit;let i;t.xp6(1),t.Q6J("ngIf",null==(i=l.get("show"))?null:i.value)}}function Y(_,w){if(1&_){const l=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3),t.YNc(3,F,2,1,"ng-container",4),t.qZA()(),t.TgZ(4,"div",5)(5,"button",6),t.NdJ("click",function(){t.CHM(l);const c=t.oxw();return t.KtG(c.btnCloseDialog())}),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()()}if(2&_){const l=t.oxw();let i;t.xp6(2),t.Q6J("formGroup",l.data.form),t.xp6(1),t.Q6J("ngForOf",null==(i=l.data.form.get("studentIds"))?null:i.controls),t.xp6(3),t.hij(" ",t.lcZ(7,3,"lang_auto_dong")," ")}}let G=(()=>{class _ extends d.e{constructor(l,i){super(i,l),this.dialogRef=l,this.data=i,this.listPermissionTypes=y.y,this.formArray=i.formArray}btnCloseDialog(){this.dialogRef.close()}selectAllStudentOfClass(l){this.formArray.controls.forEach(i=>{if(i instanceof s.cw&&i.controls.classroomId.value==l&&i.controls.listStudents instanceof s.Oe&&i.controls.listStudents.length)if(0==i.controls.selectAll.value){for(let c=0;c<i.controls.listStudents.controls.length;c++)i.controls.listStudents.controls[c].get("choose")?.setValue(!0);i.controls.countSelect.setValue(i.controls.listStudents.controls.length),i.controls.selectAll.setValue(!0)}else{for(let c=0;c<i.controls.listStudents.controls.length;c++)i.controls.listStudents.controls[c].get("choose")?.setValue(!1);i.controls.countSelect.setValue(0),i.controls.selectAll.setValue(!1)}},this.formArray.controls)}selectStudent(l,i){this.formArray.controls.forEach(c=>{if(c instanceof s.cw&&c.controls.classroomId.value==i){let h=c.controls.countSelect.value;l.target.checked?(h++,c.controls.countSelect.setValue(h)):(h--,c.controls.countSelect.setValue(h)),c.controls.listStudents instanceof s.Oe&&c.controls.listStudents.length&&c.controls.selectAll.setValue(h==c.controls.listStudents.controls.length)}},this.formArray.controls)}}return _.\u0275fac=function(l){return new(l||_)(t.Y36(o.so,8),t.Y36(o.WI,8))},_.\u0275cmp=t.Xpm({type:_,selectors:[["azt-list-student-dialog"]],features:[t.qOj],decls:1,vars:1,consts:[["class","box",4,"ngIf"],[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-0",3,"formGroup"],["formArrayName","studentIds",4,"ngFor","ngForOf"],[1,"p-3","text-right"],["azt-track-service","azt-dialog-warning-3FIn9IaXN",1,"btn","w-24","btn-primary",3,"click"],["formArrayName","studentIds"],[4,"ngIf"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","items-center"],[1,"font-medium","mr-auto"],[4,"ngIf","ngIfElse"],["doneLoadStudents",""],[1,"form-check"],["id","selected-all","type","checkbox",1,"form-check-input",3,"checked","change"],["for","selected-all",1,"form-check-label"],["elseTemplate",""],[1,"flex","items-center","justify-center","p-5"],[1,"w-5","h-5"],[3,"type"],["hasStudents",""],[1,"w-full","text-center","p-5"],[3,"defaultHeight"],["class","grid grid-cols-12 gap-3 p-3","formArrayName","listStudents",4,"ngIf"],["formArrayName","listStudents",1,"grid","grid-cols-12","gap-3","p-3"],["class","col-span-12 md:col-span-4",4,"ngFor","ngForOf"],[1,"col-span-12","md:col-span-4"],[1,"azt-checkbox-item",3,"formGroup"],["type","checkbox","formControlName","choose",1,"form-check-input",3,"id","change"],[1,"form-check-label","truncate",2,"vertical-align","middle",3,"matTooltip","for"]],template:function(l,i){1&l&&t.YNc(0,Y,8,5,"div",0),2&l&&t.Q6J("ngIf",i.data.form)},dependencies:[f.sg,f.O5,u.gM,s.Wl,s.JJ,s.JL,s.sg,s.u,s.CE,A.M,S.R,P.n,e.JV,e.nq],encapsulation:2}),_})();var V=n(61675),O=n(79430),N=n(37722);function p(_,w){if(1&_&&(t.TgZ(0,"span",11),t._uU(1),t.ALo(2,"slice"),t.qZA()),2&_){const l=t.oxw().$implicit;let i,c;t.s9C("matTooltip",null==(i=l.get("classroomName"))?null:i.value),t.xp6(1),t.hij(" ",t.Dn7(2,2,null==(c=l.get("classroomName"))?null:c.value,0,30)+"..."," ")}}function x(_,w){if(1&_&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&_){const l=t.oxw().$implicit;let i;t.xp6(1),t.hij(" ",null==(i=l.get("classroomName"))?null:i.value," ")}}function g(_,w){1&_&&(t.TgZ(0,"span",12),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&_&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_test_config_share")," "))}const r=function(_){return{"text-primary font-medium":_}},a=function(_){return{permissionObj:_}};function m(_,w){if(1&_){const l=t.EpF();t.TgZ(0,"div",4)(1,"div",5),t.NdJ("click",function(){const h=t.CHM(l).$implicit,T=t.oxw(2);let k;return t.KtG(T.showListStudentInClassroom(null==(k=h.get("classroomId"))?null:k.value,null==(k=h.get("classroomName"))?null:k.value))}),t.TgZ(2,"span",6),t._UZ(3,"lucide-icon",7),t.qZA(),t.YNc(4,p,3,6,"span",8),t.YNc(5,x,2,1,"span",0),t.YNc(6,g,3,3,"span",9),t.ALo(7,"fullPermission"),t.TgZ(8,"span",10),t._uU(9),t.qZA()()()}if(2&_){const l=w.$implicit;let i,c,h,T,k;t.xp6(1),t.Q6J("ngClass",t.VKq(8,r,null==(i=l.get("countSelect"))?null:i.value)),t.xp6(3),t.Q6J("ngIf",(null==(c=l.get("classroomName"))||null==c.value?null:c.value.length)>30),t.xp6(1),t.Q6J("ngIf",(null==(h=l.get("classroomName"))||null==h.value?null:h.value.length)<=30),t.xp6(1),t.Q6J("ngIf",!t.xi3(7,5,t.VKq(10,a,null==(T=l.get("permissionObjs"))?null:T.value),"classroom")),t.xp6(3),t.hij(" (",(null==(k=l.get("countSelect"))?null:k.value)+"/"+(null==(k=l.get("countStudents"))?null:k.value),") ")}}function b(_,w){if(1&_&&(t.TgZ(0,"div")(1,"form",1)(2,"div",2),t.YNc(3,m,10,12,"div",3),t.qZA()()()),2&_){const l=t.oxw();let i;t.xp6(1),t.Q6J("formGroup",l.form),t.xp6(2),t.Q6J("ngForOf",null==(i=l.form.get("studentIds"))?null:i.controls)}}let L=(()=>{class _ extends C.Q{initClassroomCheckbox(){this.formArray.clear();for(let c=0;c<this.objs.length;c++){let h=new s.cw({classroomId:new s.NI(this.objs[c].id,{nonNullable:!0}),classroomName:new s.NI(this.objs[c].name,{nonNullable:!0}),permissionObjs:new s.NI(this.objs[c].permissionObj,{nonNullable:!0}),listStudents:new s.Oe([]),countStudents:new s.NI(this.objs[c].countStudents,{nonNullable:!0}),show:new s.NI(!1,{nonNullable:!0}),loadingStudents:new s.NI(!1,{nonNullable:!0}),selectAll:new s.NI(!1,{nonNullable:!0}),countSelect:new s.NI(0,{nonNullable:!0})});this.formArray.push(h)}let l=[],i=[];if(this.examStudentObjs.length)for(let c=0;c<this.examStudentObjs.length;c++){let h=this.examStudentObjs[c].classroomId,T=this.examStudentObjs[c].studentId;h&&!this.commonService.filterArray(i,h)&&i.push(h),T&&!this.commonService.filterArray(l,T)&&l.push(T)}if(i)for(let c=0;c<i.length;c++)this.showListStudentOfClassroom(i[c],l);else this.objs.length&&this.objs[0].id&&this.showListStudentOfClassroom(this.objs[0].id)}addStudentToFormArr(l,i,c){this.formArray.controls.forEach(h=>{if(h instanceof s.cw&&h.controls.classroomId.value==i){let T=h.controls.countSelect.value;l.forEach(k=>{let H=this.commonService.filterArray(c,k.id),q=new s.cw({id:new s.NI(k.id,{nonNullable:!0}),name:new s.NI(k.fullName??"",{nonNullable:!0}),choose:new s.NI(!!H,{nonNullable:!0})});H&&(T++,h.controls.countSelect.setValue(T)),h.controls.listStudents.push(q),T==l.length&&h.controls.selectAll.setValue(!0)}),h.controls.loadingStudents.setValue(!1)}},this.formArray.controls)}getStudentListByClass(l){return new j.y(i=>{this.subscriptions.add(this.studentProfileV2Service.apiStudentProfileV2GetObjsByClassroomIdGet(l).subscribe(c=>{1==c.success?(i.next(c.data?.studentObjs),i.complete()):(i.next([]),i.complete())}))})}showListStudentOfClassroom(l,i){this.formArray.controls.forEach(c=>{c instanceof s.cw&&c.controls.classroomId.value==l&&c.controls.listStudents instanceof s.Oe&&!c.controls.listStudents.length&&(c.controls.loadingStudents.setValue(!0),this.getStudentListByClass(l).subscribe(h=>{h.length?this.addStudentToFormArr(h,l,i??[]):c.controls.loadingStudents.setValue(!1)}))},this.formArray.controls)}showListStudentInClassroom(l,i){this.formArray.controls.forEach(h=>{h instanceof s.cw&&h.controls.classroomId.value==l&&h.controls.show.setValue(!0)}),this.showListStudentOfClassroom(l),this.sAztDialogService.open(G,{data:{form:this.form,classroomId:l,classroomName:i,permissionName:this.permissionName,formArray:this.formArray},width:"1000px",autoFocus:!1}).afterClosed().subscribe(()=>{this.formArray.controls.forEach(h=>{h.controls.show.setValue(!1)})})}ngOnInit(){super.ngOnInit(),this.formArray=this.form?.get(this.formArrayName);for(var l=0;l<this.objs.length;l++)this.objs[l].name=this.commonService.myTranslateInstant(this.objs[l].name)??"";this.formArray&&this.initClassroomCheckbox()}constructor(l,i){super(),this.sAztDialogService=l,this.studentProfileV2Service=i,this.changeCheckboxEvent=new t.vpe,this.formArrayName="",this.objs=[],this.examStudentObjs=[],this.permissionName=y.y.exam,this.listPermissionTypes=y.y,this.loadingStudentList=!1,this.formArray=new s.Oe([]),this.form=new s.cw({})}}return _.\u0275fac=function(l){return new(l||_)(t.Y36(V.C),t.Y36(O.LU))},_.\u0275cmp=t.Xpm({type:_,selectors:[["list-student-checkbox"]],inputs:{form:"form",formArrayName:"formArrayName",objs:"objs",examStudentObjs:"examStudentObjs",permissionName:"permissionName"},outputs:{changeCheckboxEvent:"changeCheckboxEvent"},features:[t.qOj],decls:1,vars:1,consts:[[4,"ngIf"],[3,"formGroup"],[1,"grid","grid-cols-12","gap-3","p-3"],["class","col-span-12 md:col-span-6 mt-2","formArrayName","studentIds",4,"ngFor","ngForOf"],["formArrayName","studentIds",1,"col-span-12","md:col-span-6","mt-2"],[1,"flex","cursor-pointer","items-center","icon-align-justify",2,"vertical-align","middle",3,"ngClass","click"],[1,"w-4","h-4","inline-block","mr-2"],["name","align-justify"],[3,"matTooltip",4,"ngIf"],["class","ml-2 py-0.5 px-2 rounded-full text-xs bg-primary text-white cursor-pointer font-medium",4,"ngIf"],[1,"ml-2"],[3,"matTooltip"],[1,"ml-2","py-0.5","px-2","rounded-full","text-xs","bg-primary","text-white","cursor-pointer","font-medium"]],template:function(l,i){1&l&&t.YNc(0,b,4,2,"div",0),2&l&&t.Q6J("ngIf",i.form)},dependencies:[f.mk,f.sg,f.O5,u.gM,s._Y,s.JL,s.sg,s.CE,N.Nh5,f.OU,e.JV,e.NK],encapsulation:2}),_})()},20254:(U,I,n)=>{n.d(I,{Q:()=>u});var t=n(65592),s=n(78585),j=n(36937),y=n(88135),C=n(20760),o=n(65879),d=n(87384),f=n(61675);let u=(()=>{class A{doExamAction(P,e){switch(e){case C.F.CONFIG_EXAM_CLASSROOM:return this.showConfigExamClassroomDialog(P);case C.F.SHOW_EXAM_DETAIL:this.showExamDetailDialog(P);break;case C.F.SHARE_OFFLINE_RESULT:this.showOfflineShareDialog(P);break;case C.F.COPY_EXAM_LINK:this.copyExamLink()}return this.returnUndefinedOutput()}copyExamLink(){this.commonService.snackSuccess("lang_auto_sao_chep_thanh_cong")}showConfigExamClassroomDialog(P){return new t.y(e=>{this.sAztDialogService.open(y.Y,{width:"750px",data:{hashId:P.examObj.hashId,examStudents:P.examObj?.examStudents??[]},restoreFocus:!1}).afterClosed().subscribe(E=>{E?(e.next({reloadData:!0}),e.complete()):(e.next(void 0),e.complete())})})}showExamDetailDialog(P){let e={obj:{...P.examObj,countQuestion:0,showFrontend:1,editable:!0,allowStudentView:!0},globalLadingPage:P.globalLadingPage,curCateId:P.categoryId,isOnLib:0,isShow:!0,showDelete:!0};this.sAztDialogService.open(j.H,{width:"800px",maxWidth:"90vw",enterAnimationDuration:"0ms",exitAnimationDuration:"0ms",data:e,restoreFocus:!1}).afterClosed().subscribe(E=>{})}showOfflineShareDialog(P){this.sAztDialogService.open(s.h,{width:"600px",data:{examHashId:P.examObj.hashId,useDialog:!0},restoreFocus:!1})}returnUndefinedOutput(){return new t.y(P=>{P.next(void 0),P.complete()})}constructor(P,e){this.commonService=P,this.sAztDialogService=e}}return A.\u0275fac=function(P){return new(P||A)(o.LFG(d.z),o.LFG(f.C))},A.\u0275prov=o.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A})()},27722:(U,I,n)=>{n.d(I,{d:()=>y});var t=n(25690),s=n(65879),j=n(87384);let y=(()=>{class C{sortExamByColumn(d,f,u){return f==t.H.BY_NAME?this.sortExamByName(d,u):f==t.H.BY_PUBLISH_STATUS?this.sortExamByPublishStatus(d,u):f==t.H.BY_UPDATED_DATE?this.sortExamByDateUpdated(d,u):f==t.H.BY_ATTENDED?this.sortExamByAttended(d,u):this.sortExamByName(d,u)}sortExamByName(d,f){var u=[...d.rootCategoryObjs??[]],A=[...d.rootDocumentObjs??[]];return 1==f?{categoryObjs:this._sortCateByName(u),documentObjs:this._sortDocumentByName(A)}:{categoryObjs:this._sortCateByName(u).reverse(),documentObjs:this._sortDocumentByName(A).reverse()}}sortExamByPublishStatus(d,f){var u=[...d.rootDocumentObjs??[]];return 1==f?{categoryObjs:d.currentCategoryObjs,documentObjs:this._sortDocumentByPublish(u,u?.length)}:{categoryObjs:d.currentCategoryObjs,documentObjs:this._sortDocumentByPublish(u,u?.length).reverse()}}sortExamByDateUpdated(d,f){var u=this.commonService.castObj(d.rootCategoryObjs),A=this.commonService.castObj(d.rootDocumentObjs);return 1==f?{categoryObjs:this._sortCateByDateUpdateExam(u??[]),documentObjs:this._sortDocumentByUpdateTime(A??[])}:{categoryObjs:this._sortCateByDateUpdateExam(u??[]).reverse(),documentObjs:this._sortDocumentByUpdateTime(A??[]).reverse()}}sortExamByAttended(d,f){var u=this.commonService.castObj(d.rootDocumentObjs);return 1==f?{categoryObjs:d.currentCategoryObjs,documentObjs:this._sortDocumentByAttended(u??[])}:{categoryObjs:d.currentCategoryObjs,documentObjs:this._sortDocumentByAttended(u??[]).reverse()}}_sortCateByName(d){return d?.sort((f,u)=>(f.name?.trim()??"").localeCompare(u.name?.trim()??""))??[]}_sortDocumentByName(d){return d?.sort((f,u)=>(f.name?.trim()??"").localeCompare(u.name?.trim()??""))??[]}_sortDocumentByPublish(d,f){let u=[],A=[];for(let S=0;S<(f??0);S++)0==d?.[S].isPublished&&u.push(d[S]),1==d?.[S].isPublished&&A.push(d[S]);return u.concat(A)}_sortCateByDateUpdateExam(d){return d.sort((f,u)=>Number(new Date(f.updatedAt??""))-Number(new Date(u.updatedAt??""))),d}_sortDocumentByUpdateTime(d){return d?.sort((f,u)=>Number(new Date(f.updatedAt??""))-Number(new Date(u.updatedAt??"")))}_sortDocumentByAttended(d){return d?.sort((f,u)=>Number(f.attended)-Number(u.attended))}constructor(d){this.commonService=d}}return C.\u0275fac=function(d){return new(d||C)(s.LFG(j.z))},C.\u0275prov=s.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()},20760:(U,I,n)=>{n.d(I,{F:()=>t});var t=function(s){return s[s.CONFIG_EXAM_CLASSROOM=0]="CONFIG_EXAM_CLASSROOM",s[s.SHOW_EXAM_DETAIL=1]="SHOW_EXAM_DETAIL",s[s.SHARE_OFFLINE_RESULT=2]="SHARE_OFFLINE_RESULT",s[s.COPY_EXAM_LINK=3]="COPY_EXAM_LINK",s}(t||{})},31810:(U,I,n)=>{n.d(I,{T:()=>t});var t=function(s){return s[s.OFFLINE_CONFIG=0]="OFFLINE_CONFIG",s[s.CONFIG_EXAM=1]="CONFIG_EXAM",s[s.EDIT_EXAM=2]="EDIT_EXAM",s[s.POWER_POINT=3]="POWER_POINT",s[s.STATISTIC=4]="STATISTIC",s[s.TESTED_LIST=5]="TESTED_LIST",s}(t||{})},25690:(U,I,n)=>{n.d(I,{H:()=>t});var t=function(s){return s[s.BY_NAME=0]="BY_NAME",s[s.BY_PUBLISH_STATUS=1]="BY_PUBLISH_STATUS",s[s.BY_UPDATED_DATE=2]="BY_UPDATED_DATE",s[s.BY_ATTENDED=3]="BY_ATTENDED",s}(t||{})}}]);