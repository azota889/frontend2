"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[841],{70460:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.FileParser=void 0;const O=b(87693),h=b(3934),j=b(78721),x=b(32651);Q.FileParser=class u{constructor(){this.services=[],this.conf=""}loadConf(g){this.conf=g}init(){this.registerService(new x.WordService),this.registerService(new h.PdfService),this.registerService(new O.ImageService),this.registerService(new j.TableService)}registerService(g){g.loadConf(this.conf),this.services.push(g)}start(g){return new Promise((f,T)=>{let k=0;for(let y=0;y<this.services.length;y++)this.services[y].start(g).then(L=>{k++,L.supported?f(L):k===this.services.length&&T()})})}loadAllLibs(g){return new Promise(f=>{let T=0;const k=()=>{if(T===g.length)f(!0);else{const y=g[T];if(document.getElementById(y.name))T++,k();else{const L=document.createElement("script");L.setAttribute("src",y.link),L.setAttribute("id",y.name),L.setAttribute("async","false"),L.addEventListener("load",()=>{T++,k()},!1),document.body.appendChild(L)}}};k()})}}},37908:(it,Q,b)=>{Q.uD=void 0;const h=b(70460);Object.defineProperty(Q,"uD",{enumerable:!0,get:function(){return h.FileParser}});b(89)},89:(it,Q)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.DocxParser=void 0;class b{constructor(){this.arrayBuffer=null,this.numberID=0}start(h){this.wmf||(this.wmf=new WMFConverter),this.file=h}reset(){this.file=void 0,this.arrayBuffer=void 0}load(){return new Promise(h=>{if(this.file){const j=this.file.name.split(".").pop();if("docx"===(null==j?void 0:j.toLocaleLowerCase())){const x=new FileReader;x.onloadend=()=>{this.arrayBuffer=x.result,h(!0)},x.readAsArrayBuffer(this.file)}else h(!1)}else h(!1)})}toTextLines(){return new Promise((h,j)=>{this.load().then(x=>{if(x){const u=[],t=[];mammoth.convertToMarkdown({arrayBuffer:this.arrayBuffer},{styleMap:["b => ","i => ","u => "]}).then(T=>{T.value.split("\n").forEach(y=>{y.length>0&&(0===y.indexOf("\t")&&(y=y.substring(1)),y=this.convertImageString(y,t),u.push(y.replace(/\t/g,"    ").replace(/\\./g,".")))}),t.forEach(y=>{this.processImageWmf(y)}),h({str:u,maps:t})})}else j({msg:"File kh\xf4ng h\u1ed7 tr\u1ee3."})})})}processImageWmf(h){(h.link.indexOf("image/x-wmf")>=0||h.link.indexOf("image/x-emf")>=0)&&(h.link=this.wmf.toPNG(h.link))}convertImageString(h,j){for(;-1!==h.indexOf(b.IMG_MD_START);){const x="ha"+this.numberID,u=h.indexOf(b.IMG_MD_START),t=h.indexOf(")",u+1),g=h.substring(u+b.IMG_MD_START.length,t);j.push({id:x,link:g}),h=h.substring(0,u)+"[!img:"+x+"]"+h.substring(t+1,h.length),this.numberID++}return h}}Q.DocxParser=b,b.IMG_MD_START="![]("},87693:(it,Q)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.ImageService=void 0,Q.ImageService=class b{constructor(){this.conf=""}toBase64(h){return new Promise((j,x)=>{const u=new FileReader;u.onload=()=>{j(u.result)},u.onerror=t=>{x(t)},u.readAsDataURL(h)})}isFileImage(h){return h&&"image"===h.type.split("/")[0]}generateIdRequired(h){let j="";const x="abcdefghijklmnopqrstuvwxyz0123456789",u=x.length;for(let t=0;t<h;t++)j+=x.charAt(Math.floor(Math.random()*u));return Math.floor(Date.now()/1e3)+j}loadConf(h){this.conf=h}start(h){return new Promise(j=>{this.isFileImage(h)?this.toBase64(h).then(x=>{const u="ih"+this.generateIdRequired(3),t={maps:[],str:[]};t.maps.push({id:u,link:x}),t.str.push("[!img:"+u+"]"),j({type:"image",supported:!0,data:t})}).catch(()=>{j({type:"image",supported:!1,data:{str:[],maps:[]}})}):j({type:"image",supported:!1,data:{str:[],maps:[]}})})}}},3934:(it,Q)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.PdfService=void 0,Q.PdfService=class b{constructor(){this.conf=""}isPdfDocument(h){return/^(?:application\/pdf)$/i.test(h.type)}loadConf(h){this.conf=h}start(h){return new Promise(j=>{this.isPdfDocument(h)?j({type:"pdf",supported:!0,data:{str:[],maps:[]}}):j({type:"pdf",supported:!1,data:{str:[],maps:[]}})})}cropQuestionContent(h,j){const x=[];let u=Number.MAX_VALUE;return h.answers.forEach(g=>{x.push({label:this.mergeContentCanvas(g.remove,j),content:this.mergeContentsCanvas(g.positions,j),conf:g}),u>g.positions[0].top&&(u=g.positions[0].top)}),h.positions[h.positions.length-1].heigh=u-h.positions[h.positions.length-1].top,{label:this.mergeContentCanvas(h.remove,j),content:this.mergeContentsCanvas(h.positions,j),ans:x,conf:h}}mergeContentsCanvas(h,j){let x=0,u=0,t=[];h.forEach(k=>{const y=this.mergeContentCanvas(k,j);x=y.width,u+=y.height,t.push(y)});const g=document.createElement("canvas");g.width=x,g.height=u;const f=g.getContext("2d");let T=0;return t.forEach(k=>{null==f||f.drawImage(k,0,T,k.width,k.height,0,0,k.width,k.height),T+=k.height}),g}mergeContentCanvas(h,j){const x=j[h.pageIndex].canvas,u=document.createElement("canvas");u.width=h.width,u.height=h.heigh;const t=u.getContext("2d");return null==t||t.drawImage(x,h.left,h.top,h.width,h.heigh,0,0,h.width,h.heigh),u}}},78721:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.TableService=void 0;const O=b(89);Q.TableService=class h{constructor(){this.conf="",this.docxParser=new O.DocxParser}loadConf(x){}start(x){return new Promise(u=>{u("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==x.type||"application/vnd.ms-excel"==x.type||".csv"==x.type?{type:"xlsx",supported:!0,data:{str:[],maps:[]}}:{type:"xlsx",supported:!1,data:{str:[],maps:[]}})})}}},32651:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.WordService=void 0;const O=b(89);Q.WordService=class h{constructor(){this.pattern_remove=/<a id="[^"]+"><\/a>/g,this.conf="",this.docxParser=new O.DocxParser}loadConf(x){}start(x){return new Promise(u=>{this.docxParser.start(x),this.docxParser.toTextLines().then(t=>{for(let g=0;g<t.str.length;g++)t.str[g]=t.str[g].replace(this.pattern_remove,"");u({type:"docx",supported:!0,data:t})}).catch(t=>{u({type:"docx",supported:!1,data:{str:[],maps:[]}})})})}}},25442:(it,Q)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.Utils=Q.CONST=void 0;class b{static load(j){let x=JSON.parse(j);Object.assign(this,x)}}Q.CONST=b,b.RENDER_SCALE=2,b.LINE_SMALL_HEIGHT=7*b.RENDER_SCALE,b.SPLIT_MARGIN=3*b.RENDER_SCALE,b.INTERSEC_MARGIN=20*b.RENDER_SCALE,b.LINE_MAGIN=2*b.RENDER_SCALE,b.MARGIN_LEFT=2*b.RENDER_SCALE,b.ENABLE_IMAGE_PROCESS=!0,b.STEP_SIZE=2,b.CROP_FULL_WIDTH=!0,b.OVERLAP=.5,b.QUESTION_PATTERN=[],b.QUESTION_PATTERN2=[],b.BREAK_LINE_PATTERN=[],b.SECTION_PATTERN_LOWER=[],b.SECTION_PATTERN_NORMAL=[],b.KICK_PATTERN=[],b.TVCN_CHAR=[],b.HET_PATTERN=[],b.DAPAN_PATTERN=[],b.HUONGDAN_PATTERN=[],b.MULTIPLE_ANS_PATTERN=[],b.DRAW_RESULT="",b.SKIP_CHAR=[],b.FOOTER_PATTERN=[],b.HELP_ANS_PATTERN=[],Q.Utils=class O{static capitalizeFirstLetter(j){return j.charAt(0).toUpperCase()+j.slice(1)}static tagLang(j){let x=new Map([["EASY","NB"],["MEDIUM","TH"],["HARD","VD"],["HARDEST","VDC"],["MC","TN"],["FB","\u0110T"],["ES","TL"]]);return x.has(j)?x.get(j):j}static parseInclude(j){let x=j.split("=>"),u=x.length>1?x[1]:-1,k=x[0];k=k.replaceAll(/\[@([CTQG]\d+):[^\]]*\]/g,"$1").replaceAll(/\[@(F:[^\]]*)\]/g,"$1").replaceAll(/\[[^\]\d]+(\d+)[^\]\d]+\]/g,"$1").replaceAll(/\[[^\]]+\]/g,"");let E,y=k.split("."),Z=[],L=[],I=[],S=[],H=[],G=new Map([["EASY","NB"],["MEDIUM","TH"],["HARD","VD"],["HARDEST","VDC"],["MC","TN"],["FB","\u0110T"],["ES","TL"]]);for(let Y=y.length-1;Y>=0;Y--){let $=y[Y].trim();if(/^\d*$/.test($)){E=+$;continue}let K=$.split(",");for(let nt of K)if(/^G\d+$/.test(nt.trim()))Z.push(+nt.trim().substring(1));else if(/^Q\d+$/.test(nt.trim()))I.push(+nt.trim().substring(1));else if(/^C\d+$/.test(nt.trim()))S.push(+nt.trim().substring(1));else if(/^T\d+$/.test(nt.trim()))L.push(+nt.trim().substring(1));else if(/^F:/.test(nt.trim())){let st=nt.trim().substring(2);H.push(G.has(st)?G.get(st):st)}if(I.length>0||S.length>0||L.length>0)break}return I.length>0&&(E=I.length),{catId:S,examId:L,tag:H,groupId:Z,questId:I,getNum:E,idx:u}}static getNumberFromStr(j){let x=j.match(/(\d+)/);return x?x[0]:""}static removeAccents(j){let x=["a\xe0\u1ea3\xe3\xe1\u1ea1\u0103\u1eb1\u1eb3\u1eb5\u1eaf\u1eb7\xe2\u1ea7\u1ea9\u1eab\u1ea5\u1ead","A\xc0\u1ea2\xc3\xc1\u1ea0\u0102\u1eb0\u1eb2\u1eb4\u1eae\u1eb6\xc2\u1ea6\u1ea8\u1eaa\u1ea4\u1eac","d\u0111","D\u0110","e\xe8\u1ebb\u1ebd\xe9\u1eb9\xea\u1ec1\u1ec3\u1ec5\u1ebf\u1ec7","E\xc8\u1eba\u1ebc\xc9\u1eb8\xca\u1ec0\u1ec2\u1ec4\u1ebe\u1ec6","i\xec\u1ec9\u0129\xed\u1ecb","I\xcc\u1ec8\u0128\xcd\u1eca","o\xf2\u1ecf\xf5\xf3\u1ecd\xf4\u1ed3\u1ed5\u1ed7\u1ed1\u1ed9\u01a1\u1edd\u1edf\u1ee1\u1edb\u1ee3","O\xd2\u1ece\xd5\xd3\u1ecc\xd4\u1ed2\u1ed4\u1ed6\u1ed0\u1ed8\u01a0\u1edc\u1ede\u1ee0\u1eda\u1ee2","u\xf9\u1ee7\u0169\xfa\u1ee5\u01b0\u1eeb\u1eed\u1eef\u1ee9\u1ef1","U\xd9\u1ee6\u0168\xda\u1ee4\u01af\u1eea\u1eec\u1eee\u1ee8\u1ef0","y\u1ef3\u1ef7\u1ef9\xfd\u1ef5","Y\u1ef2\u1ef6\u1ef8\xdd\u1ef4"];for(const u of x){let t=new RegExp("["+u.substring(1)+"]","g");j=j.replace(t,u[0])}return j}static zeroPad(j,x){return j=j||2,(new Array(j).join("0")+x).slice(-1*j)}}},17585:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.ExamParser=void 0;const O=b(25442),h=b(70432),j=b(99739),x=b(80983),u=b(65465),t=b(72687),g=b(29688),f=b(49362),T=b(50610),k=b(85215),y=b(72617),Z=b(69504),L=b(633);Q.ExamParser=class I{constructor(E){this.DEF_QUEST_NAME="c\xe2u ",this.lang="vi",O.CONST.load(E)}setLang(E){this.lang=E,this.DEF_QUEST_NAME="vi"==E?"c\xe2u ":"question "}parse(E,H,G){var Y,$,K,nt,st,ft,ct,_t,Ct,Dt;let Tt=this.findItems(E,G);H&&console.log("items",Tt);let jt=new Map,wt=[],It=null,Lt=0,Mt="main",Ht=0,ce=0,$e=[],Te=!0,St=new Map;for(let mt=0;mt<Tt.length;mt++){let Et=Tt[mt],Ut=mt==Tt.length-1?void 0:Tt[mt+1],qt=this.getPartInfo(E,Et,Ut);if(this.loadText(E,qt),Et.type==T.SectionParser.TYPE_NAME&&"main"==Mt&&(Lt++,wt.push({label:Lt,parts:qt,answers:[],isGroup:!0})),Et.type==f.QuestionParser.TYPE_NAME){if(Ut&&Ut.type==h.AnswerParser.TYPE_NAME&&Ut.pos[2]>0){let ve;for(let pe=mt+1;pe<Tt.length;pe++)if(Tt[pe].type!=h.AnswerParser.TYPE_NAME){ve=Tt[pe];break}qt=this.getPartInfo(E,Et,ve),this.loadText(E,qt)}let re=Et.label?+Et.label:0,Rt=jt.get(re);Rt&&"main"!=Mt?(Rt.help=qt,It=Rt):"main"==Mt&&(Rt={label:re,olabel:Et.olabel,answers:[],parts:qt},Lt>0&&(Rt.group=Lt),jt.set(re,Rt),wt.push(Rt),It=Rt)}if(Et.type==h.AnswerParser.TYPE_NAME&&It){let re=!1;if(1==qt.length){let Ee=E[qt[0].lineIdx].replace(/\|/g,"").trim().match(O.CONST.MULTIPLE_ANS_PATTERN.join("|"));null!=Ee&&Ee.length>0&&(re=!0)}let Rt=""==Et.olabel;Et.pos[2]>0&&(qt=[qt[0]],qt[0].e=Et.pos[2],this.loadText(E,qt),Rt=!0);let ve={label:null!==(Y=Et.label)&&void 0!==Y?Y:"",isCorrect:"*"==Et.extInfo,parts:Rt?[qt[0]]:qt,isInline:Rt,olabel:Et.olabel};It.answers.push(ve),It.isFixAns=Rt||re}if(Et.type==g.IncludeParser.TYPE_NAME)if(Et.label&&/\.\d*$/.test(Et.label)){let re=Et.label.split("."),Rt=+re[re.length-1],ve=null!==($=qt[0].text)&&void 0!==$?$:"",pe=null!==(K=St.get(ve))&&void 0!==K?K:-1;if(pe++,St.set(ve,pe),0==Rt){Lt++;let _e=ve+"=>"+pe+"-0",vn=[];vn.push(...qt),vn[0]={lineIdx:qt[0].lineIdx,s:0,b:0,text:_e},wt.push({label:Lt,parts:vn,answers:[],isGroup:!0});continue}let cn=It?It.label:0,Ee=0;for(let _e=0;_e<Rt;_e++){Ee++;let vn=ve+"=>"+pe+"-"+_e,We=[];We.push(...qt),We[0]={lineIdx:qt[0].lineIdx,s:0,b:0,text:vn};let Zn={label:cn+Ee,olabel:It?null===(nt=It.olabel)||void 0===nt?void 0:nt.replace(/\d+/,cn+Ee+""):this.DEF_QUEST_NAME+(cn+Ee)+".",answers:[],parts:We};jt.set(Zn.label,Zn),wt.push(Zn),It=Zn}}else if(Et.label&&/\.Q\d+(,Q\d+)*$/.test(Et.label)){let Rt=Et.label.split(".").pop(),ve=null!==(st=null==Rt?void 0:Rt.split(",").length)&&void 0!==st?st:0;for(let pe=0;pe<ve;pe++){let cn={lineIdx:qt[0].lineIdx,s:0,b:0,text:qt[0].text+"=>0-"+pe},Ee=It?It.label:0,_e={label:Ee+1,olabel:It?null===(ft=It.olabel)||void 0===ft?void 0:ft.replace(/\d+/,Ee+1+""):this.DEF_QUEST_NAME+(Ee+1)+".",answers:[],parts:[cn]};jt.set(_e.label,_e),wt.push(_e),It=_e}}Et.type==t.HuongDanParser.TYPE_NAME&&It&&(qt.splice(0,1),Ut&&Ut.type==f.QuestionParser.TYPE_NAME&&Ut.label&&!jt.has(+Ut.label)||!Ut||Ut.type==T.SectionParser.TYPE_NAME?"main"==Mt&&(It.help=qt):"main"==Mt&&(Mt="info",Ht=null!==(ct=Et.lineIdx)&&void 0!==ct?ct:0),Ht>0&&0==ce&&(ce=null!==(_t=Et.lineIdx)&&void 0!==_t?_t:0)),(Et.type==u.HetParser.TYPE_NAME||Et.type==x.DapAnParser.TYPE_NAME)&&(Mt="info",Ht=null!==(Ct=Et.lineIdx)&&void 0!==Ct?Ct:0),Et.type==j.DapAnChiTietParser.TYPE_NAME&&Te&&$e.push(Et),Et.type!=j.DapAnChiTietParser.TYPE_NAME&&$e.length>0&&(Te=!1)}let zt=new j.DapAnChiTietParser,Xt=zt.getAnsMC(E,$e),ln=new Map;if(Ht>0){let mt=ce>0?E.slice(Ht,ce):E.slice(Ht);ln=zt.getAnsStr(mt)}console.log("mapans",Xt,ln);for(const mt of wt){if(mt.isGroup)continue;let Et=Xt.get(mt.label),Ut=ln.get(mt.label),qt=null;if(mt.help&&(qt=zt.getAnsFromHelp(mt.help,E)),(Et||Ut&&"ABCD".includes(Ut)||qt&&"ABCD".includes(qt))&&0==mt.answers.length)for(const re of"ABCD")mt.answers.push({label:re,isCorrect:re==Et,parts:[]}),mt.isFixAns=!0;else if(mt.answers.length>0){let re=mt.answers.filter(Rt=>Rt.isCorrect);for(let Rt=1;Rt<re.length;Rt++)re[Rt].isCorrect=!1;if(0==re.length){let Rt=null!==(Dt=null!=Et?Et:qt)&&void 0!==Dt?Dt:Ut?Ut[0]:"";for(const ve of mt.answers)if(ve.label==Rt){ve.isCorrect=!0;break}}}else mt.strAns=Ut}return H&&console.log("lstQuest",wt),wt}cleanRes(E){for(const H of E){for(let G=H.parts.length-1;G>=0;G--)""==H.parts[G].text&&H.parts.splice(G,1);for(const G of H.answers)for(let Y=G.parts.length-1;Y>=0;Y--)""==G.parts[Y].text&&G.parts.splice(Y,1);if(H.help)for(let G=H.help.length-1;G>=0;G--)""==H.help[G].text&&H.help.splice(G,1)}}getPartInfo(E,H,G){var Y,$;let K=null!==(Y=H.lineIdx)&&void 0!==Y?Y:0,nt=null!==($=null==G?void 0:G.lineIdx)&&void 0!==$?$:E.length-1;if(K==nt)return G?[{lineIdx:K,b:H.pos[0],s:H.pos[1],e:null==G?void 0:G.pos[0]}]:[{lineIdx:K,b:H.pos[0],s:H.pos[1]}];{let st=[];st.push({lineIdx:K,b:H.pos[0],s:H.pos[1]});for(let ft=K+1;ft<nt;ft++)st.push({lineIdx:ft,b:0,s:0});if(G){let ft=null==G?void 0:G.pos[0];""!=E[nt].substring(0,ft).replace(/\|/g,"").trim()&&st.push({lineIdx:nt,b:0,s:0,e:ft})}else st.push({lineIdx:nt,b:0,s:0});return st}}loadText(E,H){for(const G of H)G.text=E[G.lineIdx].substring(G.s,G.e).replace(/\s+/g," ").trim()}findItems(E,H){let G=["remove:q-s-a => 1","remove:s-s => 0","remove:h-h => 0","rmdup:a-a => void","remove:q-a:\\d+\\-[^A] => 0","remove:s-a:.+\\-[^A] => 0","remove:a-a:A\\-[^B] => 0","remove:a-a:B\\-[^C] => 0","remove:a-a:C\\-[^D] => 0","remove:a-a:D\\-[^E] => 0","remove:a-a:E\\-[^F] => 0","same:a: => void","same:q:QUESTION_PATTERN,QUESTION_PATTERN2 => void"];H&&(G=["remove:q-s-a => 1","remove:s-s => 0","remove:h-h => 0","remove:q-a:\\d+\\-[^A] => 0","remove:s-a:.+\\-[^A] => 0","remove:a-a:A\\-[^AB] => 0","remove:a-a:B\\-[^ABC] => 0","remove:a-a:C\\-[^ACD] => 0","remove:a-a:D\\-[^ADE] => 0","remove:a-a:E\\-[^AEF] => 0","same:a: => void","same:q:QUESTION_PATTERN,QUESTION_PATTERN2 => void"]);let Y=[new Z.RemoveRule,new k.ModifyAnsRule,new L.SameKindRule,new y.RemoveDupRule],$=[{parser:new j.DapAnChiTietParser,also:[2]},{parser:new T.SectionParser,from:[0],to:[1],also:[3]},{parser:new f.QuestionParser,from:[0],to:[1],also:[3]},{parser:new h.AnswerParser},{parser:new u.HetParser,to:[2]},{parser:new x.DapAnParser,to:[2],also:[6]},{parser:new t.HuongDanParser},{parser:new g.IncludeParser,from:[0],to:[1]}],K=[{name:"start",expect:[1,2,7]},{name:"main",expect:[1,2,3,4,5,6,7]},{name:"info",expect:[0,1,2,6]}],nt=K[0],st=[],ft=0;for(const Ct of E)if(""!=Ct){for(const Dt of nt.expect){let Tt=$[Dt],jt=Tt.parser.parse(Ct);if(jt.length>0){if(jt.forEach(wt=>wt.lineIdx=ft),st.push(...jt),Tt.parser.TYPE==t.HuongDanParser.TYPE_NAME){let wt=st.filter(Mt=>Mt.type==f.QuestionParser.TYPE_NAME).length,It=st.filter(Mt=>Mt.type==t.HuongDanParser.TYPE_NAME).length,Lt=st.filter(Mt=>Mt.type==x.DapAnParser.TYPE_NAME).length;if(nt.name==K[1].name&&wt>1&&0==It){nt=K[2];let Mt=K[2].expect.indexOf(6);Mt>=0&&K[2].expect.splice(Mt,1)}else if(nt.name==K[2].name){Lt>0&&$[0].parser.off();let Mt=K[2].expect.indexOf(6);Mt>=0&&K[2].expect.splice(Mt,1)}}if(Tt.to){let wt=0;for(const It of Tt.to)(Tt.from&&K[Tt.from[wt]]==nt||!Tt.from)&&(nt=K[It])}if(Tt.also)for(const wt of Tt.also){let Lt=st[st.length-1].pos[1],Mt=$[wt].parser.parse(Ct.substring(Lt));Mt.length>0&&(Mt.forEach(Ht=>{Ht.lineIdx=ft;for(let ce=0;ce<Ht.pos.length;ce++)Ht.pos[ce]=Ht.pos[ce]+Lt}),st.push(...Mt))}break}}ft++}else ft++;let ct=[];for(const Ct of G)for(const Dt of Y){let Tt=Dt.load(Ct);if(Tt){ct.push(Tt);break}}let _t=0;for(;_t<st.length;){for(const Ct of ct){let Dt=st.length;if(Ct.run(st,_t)){let Tt=Dt-st.length;Tt>0&&(_t-=Tt+1);break}}_t++}return st}}},82439:(it,Q)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.EditorApiService=void 0,Q.EditorApiService=class b{}},86855:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.ExamIntellisense=void 0;const O=b(17585),h=b(71063),j=b(82910),x=b(68954),u=b(82642),t=b(59615),g=b(82781);Q.ExamIntellisense=class f{constructor(k){this.conf=k,this._lstQuest=[],this._lines=[],this.singleMode=!1,this.exParser=new O.ExamParser(k),this.apiService=null}setSingleMode(k){this.singleMode=k}setLines(k){this._lines=k}setApiService(k){this.apiService=k}parse(){return this._lstQuest=this.exParser.parse(this._lines,!0,!0),this._lstQuest}getAutofillValue(k,y,Z){var L;if(0==this._lstQuest.length)return[];if(/^\[?\s*@/.test(this._lines[k].trim()))return[];let S=[],E=this.getCurPos(k,y),H=E[0],G=E[1],Y=E[2],$=this._lines[k>0?k-1:0];if(H&&H.parts.length>0&&(null===(L=H.parts[0].text)||void 0===L||L.trim().startsWith("[@")),$.startsWith("[@")||""==$.trim())return[];if(G&&H){let K="ABCDEFGHIJKLMN",nt=K.indexOf(G.label),st=K[nt+1]+G.olabel+" ",ft=G.label+G.olabel+" ";if(!this.singleMode&&this._lines[G.parts[0].lineIdx].trim()==ft.trim()&&G.parts[0].lineIdx!=k){let ct=H.parts[0],Ct=this._lines[ct.lineIdx].substring(ct.b,ct.s).replace(/\d+/,H.label+1+"")+" ";return S.push(`${G.parts[0].lineIdx}|0|${ft.length}|`),S.push(`${k}|${y}|${y}|${Ct}`),S}if(G.label<"D"&&("enter"!=Z||k>0&&""!=this._lines[k-1].trim()&&G.parts[0].lineIdx!=k))return S.push(`${k}|${y}|${y}|${st}`),S;if(!this.singleMode&&G.label>="D"&&G.parts[0].lineIdx!=k&&"enter"==Z&&k==this._lines.length-1){let ct=H.parts[0],Ct=this._lines[ct.lineIdx].substring(ct.b,ct.s).replace(/\d+/,H.label+1+"")+" ";return S.push(`${k}|${y}|${y}|\n${Ct}`),S}}if(!G&&!Y&&H&&"enter"==Z&&""==this._lines[k].trim()&&k>0&&""!=this._lines[k-1].trim()){let K=H.parts[0],nt=this._lines[K.lineIdx].substring(K.s).trim();if(this.singleMode||""!=nt)if(0==H.answers.length)S.push(`${k}|${y}|${y}|A. `);else if(!this.singleMode){let st=H.parts[0],ct=this._lines[st.lineIdx].substring(st.b,st.s).replace(/\d+/,H.label+1+"")+" ";S.push(`${k}|${y}|${y}|${ct}`)}return S}return S}getSuggestions(k,y,Z,L){return new Promise(I=>{var S,E;let H=null!==(S=null==L?void 0:L.substring(0,y))&&void 0!==S?S:"",G=this.singleMode?[new h.AnsSugg,new x.EndSugg,new j.ChooseSugg]:[new u.IncludeSugg(this.apiService,I),new t.QuestSugg,new h.AnsSugg,new g.SectionSugg,new x.EndSugg,new j.ChooseSugg],Y=[],$=this.getCurPos(k,y),K=$[0],nt=$[1],ct=K?{type:$[2]?"h":nt?"a":"q",quest:K,ansLabel:nt?nt.label:void 0,secLabel:K.group?null===(E=this._lstQuest.filter(_t=>_t.isGroup).pop())||void 0===E?void 0:E.parts[0].text:void 0,lineIdx:k,col:y}:void 0;for(let _t of G){let Ct=_t.run(H,Z,ct);if(1==Ct.length&&"-1"==Ct[0])return;Y.push(...Ct)}I(Y)})}getEditHint(){let y=0,Z=[],L=!1;for(const I of this._lstQuest){if(I.isGroup)continue;let S="",E="A".charCodeAt(0)-1,H=!1;for(const G of I.answers){if(""==G.olabel)break;if(S+=G.label,!H&&!"ABCDEFGHIJKLMN".startsWith(S)&&(H=!0),E++,H){let Y=G.parts[0];Z.push(`${Y.lineIdx}|${Y.b}|${Y.b+1}|${String.fromCharCode(E)}`)}}if(!L&&I.label-y<=0&&y>0&&(L=!0),L){let G=I.parts[0],$=this._lines[G.lineIdx].substring(G.b,G.s).replace(/\d+/,y+1+"");Z.push(`${G.lineIdx}|${G.b}|${G.s}|${$}`),y++}else y=I.label}return Z}getCurPos(k,y){var Z,L;let I=!1,S=null,E=null,H=!1,G=!1;for(const Y of this._lstQuest){for(const $ of Y.parts)if($.lineIdx==k){I=!0,S=Y,E=null,Y.parts.length>0&&(null===(Z=Y.parts[0].text)||void 0===Z?void 0:Z.trim().startsWith("[@"))&&(G=!0,I=!1);break}if(!Y.isGroup){if(G&&Y.parts.length>0&&(null===(L=Y.parts[0].text)||void 0===L||!L.trim().startsWith("[@")))break;for(const $ of Y.answers)for(const K of $.parts)if(K.lineIdx==k&&K.s<=y&&(!K.e||K.e>=y)){I=!0,S=Y,E=$;break}if(I)break;if(Y.help)for(const $ of Y.help)if($.lineIdx==k&&$.s<=y&&(!$.e||$.e>=y)){I=!0,S=Y,E=null,H=!0;break}if(I)break}}return[S,E,H]}}},71063:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.AnsSugg=void 0;const O=b(30033);Q.AnsSugg=class h extends O.Sugg{run(x,u,t){if(!t||"h"==t.type||/^\[?\s*@/.test(x))return[];let g=t.ansLabel?String.fromCharCode(t.ansLabel.charCodeAt(0)+1)+".":"A.";return[g+"|"+g+" "]}}},82910:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.ChooseSugg=void 0;const O=b(30033);Q.ChooseSugg=class h extends O.Sugg{run(x,u,t){if(x!=u||!t)return[];let g=[];if("h"==t.type&&t.quest)for(let f of t.quest.answers)g.push(`azt_lang_sugg_choose ${f.label}|azt_lang_sugg_choose ${f.label}`);return g}}},68954:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.EndSugg=void 0;const O=b(30033);Q.EndSugg=class h extends O.Sugg{run(x,u){return x!=u?[]:["azt_lang_sugg_help_unsign|azt_lang_sugg_help\n","azt_lang_sugg_help|azt_lang_sugg_help\n","azt_lang_sugg_ans_table_unsign|azt_lang_sugg_ans_table_upper\n","azt_lang_sugg_ans_table|azt_lang_sugg_ans_table_upper\n","azt_lang_sugg_the_end_short_unsign|azt_lang_sugg_the_end\n","azt_lang_sugg_the_end_short|azt_lang_sugg_the_end\n","azt_lang_sugg_instruction_unsign|azt_lang_sugg_instruction\n","azt_lang_sugg_instruction|azt_lang_sugg_instruction\n"]}}},82642:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.IncludeSugg=void 0;const O=b(25442),h=b(30033);Q.IncludeSugg=class j extends h.Sugg{constructor(u,t){super(),this.apiService=u,this.resolve=t}run(u){let t=u;if(t.startsWith("@[")&&(t=t.substring(1)),/^\[?\s*@/.test(t)&&null!=this.apiService){let g=t.replace("]..","].").split("].").map(I=>I.replace("]","").replace("[","").replace("@","").trim()),f=g[g.length-1],T=0,k="azt_lang_sugg_random x azt_lang_sugg_question|[azt_lang_sugg_random ${1:2} azt_lang_sugg_question]|snippet",y="azt_lang_sugg_get_all|[ALL]|snippet",Z=["azt_lang_sugg_filter: azt_lang_sugg_level azt_lang_sugg_level_easy|[@F:azt_lang_tag_NB].|snippet","azt_lang_sugg_filter: azt_lang_sugg_level azt_lang_sugg_level_medium|[@F:azt_lang_tag_TH].|snippet","azt_lang_sugg_filter: azt_lang_sugg_level azt_lang_sugg_level_hard|[@F:azt_lang_tag_VD].|snippet","azt_lang_sugg_filter: azt_lang_sugg_level azt_lang_sugg_level_hardest|[@F:azt_lang_tag_VDC].|snippet","azt_lang_sugg_filter: azt_lang_sugg_type azt_lang_sugg_type_multiple_choice|[@F:azt_lang_tag_TN].|snippet","azt_lang_sugg_filter: azt_lang_sugg_type azt_lang_sugg_type_fill_blank|[@F:azt_lang_tag_DT].|snippet","azt_lang_sugg_filter: azt_lang_sugg_type azt_lang_sugg_type_essay|[@F:azt_lang_tag_TL].|snippet"],L="";if(console.log("sugg",g),g.length>1){f.endsWith(",")&&/^([CTGQH]\d+|F):/.test(f)&&(L=f.substring(0,1),f="");let I=g[g.length-2];if(I.startsWith("F:"))return this.resolve([k]),["-1"];if(I.indexOf(",")>=0){let S=[];return""==L&&S.push(k),S.push(...Z),this.resolve(S),["-1"]}if(f.trim().length>0&&!/^[CTGQH]\d+:/.test(f))return this.resolve([]),["-1"];if(!/^[CTGQH]\d+:/.test(I))return this.resolve([]),["-1"];if(/^C\d+:/.test(I)&&(T=+I.split(":")[0].trim().substring(1)),/^T\d+:/.test(I)&&(T=-I.split(":")[0].trim().substring(1)),/^G\d+:/.test(I)){let S=I.split(":")[1].split("-")[0];return this.resolve(["azt_lang_sugg_get_group_title|[azt_lang_sugg_get_title]|snippet",`azt_lang_sugg_get_all|[azt_lang_sugg_get_title]\n${t}[azt_lang_sugg_get_all ${S} azt_lang_sugg_question]|snippet`,`azt_lang_sugg_random x azt_lang_sugg_question|${"[azt_lang_sugg_get_title]\n"+t+"[azt_lang_sugg_random ${1:2} azt_lang_sugg_question]"}|snippet`]),["-1"]}if(/^Q\d+:/.test(I)||/^Q\d+:/.test(f))return this.resolve([]),["-1"];if(/^H\d+:/.test(I)||/^Q\d+:/.test(f))return this.resolve([]),["-1"]}if(T>=0)return"F"==L?(this.resolve(Z),["-1"]):(this.apiService.searchRes("",T).then(I=>{let S=I.map(E=>{let H=E.name;return H=H.replaceAll(/[\[\],\.\-]+/g,""),T<=0&&(k=""),`${H}|[@${("cat"==E.type?"C":"T")+E.id}:${H}].|${"cat"==E.type?"folder":"file"}`});""!=k&&""==L&&(S.push(k),S.push(...Z)),this.resolve(S)}),["-1"]);if(t.endsWith(".")||t.endsWith(",")){let I=Math.abs(T);return this.apiService.getQuestion(I).then(S=>{let E=S.map(Y=>{let $=("group"==Y.type?"azt_lang_sugg_group_cc ":"azt_lang_sugg_question_cc ")+Y.label,K=("group"==Y.type?"G":"Q")+Y.id,nt="group"==Y.type?".":"",st=Y.content,ft="group"==Y.type?"class":"function",ct="group"==Y.type?S.filter(Tt=>Tt.groupId==Y.id).length+"-":"",_t="group"!=Y.type&&Y.groupId?"G"+O.Utils.zeroPad(3,Y.groupId):"G000";return"group"==Y.type&&(_t="G"+O.Utils.zeroPad(3,Y.id)),{name:$,code:K,groupQnum:ct,posfix:nt,icon:ft,sort:`${_t}-${"group"==Y.type?"G"+O.Utils.zeroPad(3,Y.id):"Q"+O.Utils.zeroPad(10,Y.id)}`,doc:st}});E.sort((Y,$)=>Y.sort>$.sort?1:-1);let H=E.map(Y=>`${Y.name}|[@${Y.code}:${Y.groupQnum}${Y.name}]${Y.posfix}|${Y.icon}|${Y.sort}|${Y.doc}`),G=[];if(""!=k){""==L&&(G.push(k),G.push(...Z));let Y=y.split("|");Y[1]=E.map(($,K)=>(0==K?"":t)+`[@${$.code}:${$.groupQnum}${$.name}]`+($.code.startsWith("G")?".[azt_lang_sugg_get_title]":"")).join("\n"),G.push(Y.join("|"))}G.push(...H),"F"==L&&(G=Z),this.resolve(G)}),["-1"]}return this.resolve([]),["-1"]}return[]}}},59615:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.QuestSugg=void 0;const O=b(25442),h=b(30033);Q.QuestSugg=class j extends h.Sugg{run(u,t,g){var f;if(u!=t)return[];if(!g)return["azt_lang_sugg_question_cc 1. |azt_lang_sugg_question_cc 1. ","azt_lang_sugg_question_cc_unsign 1. |azt_lang_sugg_question_cc 1. ","Question 1. |Question 1. "];let T=null!==(f=g.quest.olabel)&&void 0!==f?f:"azt_lang_sugg_question_cc 1.",k=+O.Utils.getNumberFromStr(T),y=T.replace(/\d+/,k+1+"");return y=O.Utils.capitalizeFirstLetter(y),[O.Utils.removeAccents(y)+"|"+y+" ",y+"|"+y+" "]}}},82781:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.SectionSugg=Q.toArabic=Q.isRoman=Q.toRoman=Q.BaseNumbers=Q.RomanNumber=void 0;const O=b(25442),h=b(30033);class j{constructor(T,k){this.baseUnits=0,this.thousands=0,this.num=T,this.str=k}}function x(f){let T,k;if(f<=0||f>3999)return"";{T=0;let y="";for(f=Math.floor(f);f>0;)k=Q.BaseNumbers[T],0===Math.floor(f/k.num)?++T:(y+=k.str,f-=k.num);return y}}function u(f){return/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/.test(f)}function t(f){let T=f.toUpperCase();if(!u(T))return null;let k=0,y=0;for(;T.length>0&&y<Q.BaseNumbers.length;){const Z=Q.BaseNumbers[y];T.startsWith(Z.str)?(k+=Z.num,T=T.substring(Z.str.length)):y++}return T.length>0?null:k}Q.RomanNumber=j,Q.BaseNumbers=[new j(1e3,"M"),new j(900,"CM"),new j(500,"D"),new j(400,"CD"),new j(100,"C"),new j(90,"XC"),new j(50,"L"),new j(40,"XL"),new j(10,"X"),new j(9,"IX"),new j(5,"V"),new j(4,"IV"),new j(1,"I")],Q.toRoman=x,Q.isRoman=u,Q.toArabic=t,Q.SectionSugg=class g extends h.Sugg{run(T,k,y){var Z,L;if(T!=k)return[];if(!y)return["azt_lang_sugg_part_cc 1. |azt_lang_sugg_part_cc 1. ","azt_lang_sugg_part_cc_unsign 1. |azt_lang_sugg_part_cc 1. ","Part 1. |Part 1. "];if("h"==y.type||!y.secLabel)return[];let I="";if(/^(ph\u1ea7n|part)\s*\d+\./.test(y.secLabel.toLowerCase())){let S=y.secLabel.split("."),E=+O.Utils.getNumberFromStr(S[0]);I=S[0].replace(/\d+/,E+1+".")}else if(/^(ph\u1ea7n|part)\s+[ivx]+\./.test(y.secLabel.toLowerCase())){let E=y.secLabel.split(".")[0].split(" "),G=x((null!==(Z=t(E.pop()))&&void 0!==Z?Z:0)+1);E.push(G),I=E.join(" ")+"."}else/^[ivx]+\./.test(y.secLabel.toLowerCase())&&(I=x((null!==(L=t(y.secLabel.split(".")[0]))&&void 0!==L?L:0)+1)+".");return[O.Utils.removeAccents(I)+"|"+I+" ",I+"|"+I+" "]}}},30033:(it,Q)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.Sugg=void 0,Q.Sugg=class b{constructor(){this.lang="vi"}setLang(h){this.lang=h}}},25034:function(it,Q,b){var O=this&&this.__createBinding||(Object.create?function(j,x,u,t){void 0===t&&(t=u);var g=Object.getOwnPropertyDescriptor(x,u);(!g||("get"in g?!x.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return x[u]}}),Object.defineProperty(j,t,g)}:function(j,x,u,t){void 0===t&&(t=u),j[t]=x[u]}),h=this&&this.__exportStar||function(j,x){for(var u in j)"default"!==u&&!Object.prototype.hasOwnProperty.call(x,u)&&O(x,j,u)};Object.defineProperty(Q,"__esModule",{value:!0}),h(b(86855),Q),h(b(82439),Q),h(b(17585),Q),h(b(22161),Q),h(b(25442),Q)},24363:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.CanvasUtil=void 0;const O=b(25442);class h{static drawPoint(x,u,t){null!=x&&(x.fillStyle=u,x.beginPath(),x.arc(t.left,t.top,5,0,2*Math.PI),x.fill())}static drawBox(x,u,t,g){null!=x&&(g?(x.fillStyle=u,x.beginPath(),x.rect(t.left,t.top,t.width,t.heigh),x.fill()):(x.strokeStyle=u,x.beginPath(),x.rect(t.left,t.top,t.width,t.heigh),x.stroke()))}static drawBox2(x,u,t,g,f){null!=x&&(x.strokeStyle=u,x.beginPath(),x.rect(f[4],f[5],t,g),x.stroke())}static drawLine(x,u,t,g){null!=x&&(x.strokeStyle=u,x.beginPath(),x.moveTo(t,g),x.lineTo(x.canvas.width-10,g),x.stroke())}static drawText(x,u,t,g){null!=x&&(x.font="11px Arial",x.fillStyle=u,x.fillText(g,t[4],t[5]))}static isLineIntersec(x,u){let t=x.transform[5]<=u.transform[5]&&u.transform[5]<=x.transform[5]+x.height,g=u.transform[5]<=x.transform[5]&&x.transform[5]<=u.transform[5]+u.height,f=x.transform[4]<=u.transform[4]&&u.transform[4]<=x.transform[4]+x.width+O.CONST.INTERSEC_MARGIN,T=u.transform[4]<=x.transform[4]&&x.transform[4]<=u.transform[4]+u.width+O.CONST.INTERSEC_MARGIN,k=this.isSameLine(x,u);return(t||g)&&(f||T)&&!k}static isLineVIntersec(x,u){return(x.transform[5]<=u.transform[5]&&u.transform[5]<=x.transform[5]+x.height||u.transform[5]<=x.transform[5]&&x.transform[5]<=u.transform[5]+u.height)&&(x.transform[4]<=u.transform[4]&&u.transform[4]<=x.transform[4]+x.width+O.CONST.INTERSEC_MARGIN||u.transform[4]<=x.transform[4]&&x.transform[4]<=u.transform[4]+u.width+O.CONST.INTERSEC_MARGIN)&&Math.abs(u.transform[4]-x.transform[4])>O.CONST.INTERSEC_MARGIN/2}static isSameLine(x,u){return Math.abs(x.transform[5]+x.height-(u.transform[5]+u.height))<=O.CONST.LINE_MAGIN}static isObjIntersec(x,u){return x.transform[5]<=u.transform[5]&&u.transform[5]<=x.transform[5]+x.height||u.transform[5]<=x.transform[5]&&x.transform[5]<=u.transform[5]+u.height}static isObjFullIntersec(x,u){return(x.transform[5]<=u.transform[5]&&u.transform[5]<=x.transform[5]+x.height||u.transform[5]<=x.transform[5]&&x.transform[5]<=u.transform[5]+u.height)&&(x.transform[4]<=u.transform[4]&&u.transform[4]<=x.transform[4]+x.width||u.transform[4]<=x.transform[4]&&x.transform[4]<=u.transform[4]+u.width)}static isFirstLineOfPage(x,u){return!(x<0||x>=u.length||0!=x&&u[x-1].pageIndex==u[x].pageIndex)}static isLastLineOfPage(x,u){return!(x<0||x>=u.length||x!=u.length-1&&u[x+1].pageIndex==u[x].pageIndex)}static getTopLine(x,u,t){let g=t[u],f=[[O.CONST.STEP_SIZE,O.CONST.OVERLAP],[1,O.CONST.OVERLAP],[1,.3]];for(const T of f){let k=T[0],y=T[1],Z=g.transform[5],L=0,I=3*k;if(!h.isFirstLineOfPage(u,t)){let E=h.isSameLine(t[u-1],g);h.isLineIntersec(t[u-1],g)?(Z=t[u-1].transform[5]+t[u-1].height,L=t[u-1].transform[5],t[u-1].transform[4]>t[u].transform[4]+2*O.CONST.MARGIN_LEFT?L-=2*O.CONST.MARGIN_LEFT:L+=t[u-1].height*y,k=1,I=t[u].transform[5]+t[u].height/2-Z):(L=E&&u-2>=0?t[u-2].transform[5]+t[u-2].height*y:t[u-1].transform[5]+t[u-1].height*y,E&&h.isFirstLineOfPage(u-1,t)&&(L=0))}if(!O.CONST.ENABLE_IMAGE_PROCESS)return[Z,0];let S=!1;for(;Z>L;){if(!h.hasColor(x,g.transform[4],Z,g.width,k))return[Z,0];S||(S=!0,Z+=I),Z-=k}}return[g.transform[5],1]}static arrContains(x,u){for(const t of u)if(t==x)return!0;return!1}static getBottomLine(x,u,t){let g=t[u],f=[[O.CONST.STEP_SIZE,O.CONST.OVERLAP],[1,O.CONST.OVERLAP],[1,.3]];for(const T of f){let k=T[0],y=T[1],Z=g.transform[5]+g.height,L=9999,I=3*k;if(!h.isLastLineOfPage(u,t)){let E=h.isSameLine(t[u+1],g);h.isLineIntersec(t[u+1],g)?(Z=t[u+1].transform[5],L=t[u+1].transform[5]+t[u+1].height,t[u+1].transform[4]>t[u].transform[4]+2*O.CONST.MARGIN_LEFT?L+=2*O.CONST.MARGIN_LEFT:L-=t[u+1].height*y,I=t[u].transform[5]+t[u].height/2-Z):(L=E&&u+2<t.length?t[u+2].transform[5]+t[u+2].height-t[u+2].height*y:t[u+1].transform[5]+t[u+1].height-t[u+1].height*y,E&&h.isLastLineOfPage(u+1,t)&&(L=9999));let H=t[u+1].top;if(H&&Z>=H&&!E)return[H,0]}if(!O.CONST.ENABLE_IMAGE_PROCESS)return[Z,0];let S=!1;for(;Z<L;){if(!h.hasColor(x,g.transform[4],Z,g.width,k))return[Z,0];S||(S=!0,Z-=I),Z+=k}}return[g.transform[5]+g.height,1]}static hasColor(x,u,t,g,f){let T=Math.round(u),k=Math.round(T+g),y=Math.round(t),Z=Math.round(y+f);for(let H=y;H<Z;H++)for(let G=T;G<k;G++){let Y=4*(H*x.width+G);if((x.data[Y]+x.data[Y+1]+x.data[Y+2])/3<150)return!0}return!1}static calIndexPos2(x,u,t,g,f){let T=[],k=0,y=0,Z=0,L=0,I=0,S=0,E=!0,H=!0;for(const K of x){H=this.isObjIntersec(x[0],K),L=K.transform[4],f||(k+=L-Z>O.CONST.SPLIT_MARGIN&&""!=K.str.trim()||I!=K.transform[5]?1:0),E=L+2*O.CONST.MARGIN_LEFT>=Z;let nt=K.transform[4]+K.width;if(H&&(Z=nt),nt>y&&H&&(y=nt),k+=K.str.length,k>g&&E&&H){K.transform.forEach(_t=>{T.push(_t)}),T[3]=K.height,T[2]=S,T[1]=K.str.length-k+g;let st=K.str.substr(0,K.str.length-k+g+1);if(st.length==K.str.length){T[4]=T[4]+K.width;break}var Y=u[K.fontName].fontFamily,$=Math.hypot(K.transform[2],K.transform[3]);t.font=`${$}px ${Y}`;let ft=t.measureText(st).width,ct=t.measureText(K.str).width;T[4]=T[4]+K.width*ft/ct;break}H&&(I=K.transform[5]),S++}return 0==T.length&&(T=[0,x[x.length-1].length-1,x.length-1,x[0].height,y,x[0].transform[5]]),T}static calIndexPos(x,u,t,g,f){let T=[],k=0,y=0,Z=0,L=0,I=0,S=0,E=!0,H=!0,G="";for(const nt of x){H=this.isObjIntersec(x[0],nt),L=nt.transform[4],f||(k+=L-Z>O.CONST.SPLIT_MARGIN&&""!=nt.str.trim()||I!=nt.transform[5]?1:0,G+=(L-Z>O.CONST.SPLIT_MARGIN&&""!=nt.str.trim()||I!=nt.transform[5]?"|":"")+nt.str),E=L+2*O.CONST.MARGIN_LEFT>=Z;let st=nt.transform[4]+nt.width;if(H&&(Z=st),st>y&&H&&(y=st),k+=nt.str.length,k>g&&E&&H){let ft=nt.str.substr(0,nt.str.length-k+g);var $=u[nt.fontName].fontFamily,K=Math.hypot(nt.transform[2],nt.transform[3]);t.font=`${K}px ${$}`;let ct=t.measureText(ft).width,_t=t.measureText(nt.str).width;nt.transform.forEach(Ct=>{T.push(Ct)}),T[4]=T[4]+nt.width*ct/_t,T[3]=nt.height,T[2]=S,T[1]=nt.str.length-k+g;break}H&&(I=nt.transform[5]),S++}return 0==T.length&&(T=[0,x[x.length-1].length-1,x.length-1,x[0].height,y,x[0].transform[5]]),T}static getTextBottom(x,u,t,g){let f=Math.atan2(x[1],x[0]);u.vertical&&(f+=Math.PI/2);const T=Math.hypot(x[2],x[3]),k=T*h.getAscent(u.fontFamily,t,g);let y=x[5],Z=0;Z=0===f?k:k*Math.cos(f);let L=0*Z;return y=x[5]-Z-L,[y,T+L]}static getAscent(x,u,t){const T=t.get(x);if(T)return T;u.save(),u.font=`30px ${x}`;const k=u.measureText("");let y=k.fontBoundingBoxAscent,Z=Math.abs(k.fontBoundingBoxDescent);if(y){u.restore();const I=y/(y+Z);return t.set(x,I),I}u.strokeStyle="red",u.clearRect(0,0,30,30),u.strokeText("g",0,0);let L=u.getImageData(0,0,30,30).data;Z=0;for(let I=L.length-1-3;I>=0;I-=4)if(L[I]>0){Z=Math.ceil(I/4/30);break}u.clearRect(0,0,30,30),u.strokeText("A",0,30),L=u.getImageData(0,0,30,30).data,y=0;for(let I=0,S=L.length;I<S;I+=4)if(L[I]>0){y=30-Math.floor(I/4/30);break}if(u.restore(),y){const I=y/(y+Z);return t.set(x,I),I}return t.set(x,.8),.8}static getMaxLineRight(x,u){let t=0;for(const g of u)if(g.pageIndex==x||-1==x){let f=g.transform[4]+g.width;f>t&&(t=f)}return t}static getMinLineLeft(x,u){let t=99999;for(const g of u)if(g.pageIndex==x||-1==x){let f=g.transform[4];f<t&&(t=f)}return t}}Q.CanvasUtil=h},95318:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.PdfUtils=void 0;const O=b(25442),h=b(24363);class j{constructor(){let u=document.createElement("canvas");this.tempCanvas=u.getContext("2d"),this.ascentCache=new Map,this.imageCache=[]}loadPdf(u,t){let f={url:URL.createObjectURL(u),cMapPacked:!0,cMapUrl:"/assets/js/pdf-js-v2/cmaps/",disableAutoFetch:!1,disableFontFace:!1,disableRange:!1,disableStream:!1,docBaseUrl:"",enableXfa:!0,fontExtraProperties:!1,isEvalSupported:!0,maxImageSize:-1,pdfBug:!1,standardFontDataUrl:"/assets/js/pdf-js-v2/standard_fonts/",verbosity:1};const T=pdfjsLib.getDocument(f);let k=[],y=this;T.promise.then(function(Z){y.optionalContentConfigPromise=Z.getOptionalContentConfig();let L=Z._pdfInfo.numPages;for(let I=1;I<=L;I++)Z.getPage(I).then(S=>{k.push(S),k.length==L&&(k=k.sort((E,H)=>E._pageIndex>H._pageIndex?1:-1),t(k))})},function(Z){console.error(Z)})}getImages(u,t){let g=[];if("function"!=typeof u.objs.getAll)return g;let f=u.objs.getAll(),T=Object.keys(f);for(const k of T)f[k].data.pageIndex=t,g.push(f[k].data);return g}isImageObj(u){return-999==u.transform[0]&&"img"==u.str}getLines(u,t,g,f){let T=f.scale,k=u.items.length;for(let S=0;S<k;S++){let E=u.items[S];this.isImageObj(E)||(E.transform=j.transform(f.transform,E.transform),E.width=E.width*T),E.transform[4]+E.width>g.canvas.width&&(E.width=g.canvas.width-E.transform[4]-20);let H=this.isImageObj(E)?[E.transform[5],E.height]:h.CanvasUtil.getTextBottom(E.transform,u.styles[E.fontName],this.tempCanvas,this.ascentCache);E.height=H[1];let G=Math.ceil(H[0]);E.transform[5]=G}u.items.sort((S,E)=>1e6*Math.floor(S.transform[5])-S.transform[4]<1e6*Math.floor(E.transform[5])-E.transform[4]?-1:1);let L,y=[],Z=0;this.imageCache[t]?L=this.imageCache[t]:(L=g.getImageData(0,0,g.canvas.width,g.canvas.height),this.imageCache[t]=L);let I={strLine:"",transform:[],textObjs:[],pageIndex:t,width:0,height:0,txtLength:0};for(let S=0;S<k;S++){let E=u.items[S];if(this.isImageObj(E))for(let G=0;G<k;G++){let Y=u.items[G];if(!this.isImageObj(Y)&&S!=G&&h.CanvasUtil.isObjIntersec(E,Y)&&""!=Y.str.trim()&&!/^[\sA-K\.\|]+$/g.test(Y.str)){E.str="";break}}if(h.CanvasUtil.arrContains(E.str.trim(),O.CONST.SKIP_CHAR))continue;let H=Math.floor(E.transform[5]+E.height);0!=Z?Z-H>=-O.CONST.LINE_MAGIN?this.addTxtToLine(I,E):0!=I.textObjs.length&&(y.push(I),I=this.newLine(E,t),Z=Math.floor(I.transform[5]+I.height)):(I=this.newLine(E,t),Z=Math.floor(I.transform[5]+I.height))}y.push(I);for(const S of y)this.calculateSize(S);this.findAndMergeAnsQuestBlock(y,"ans"),this.findAndMergeAnsQuestBlock(y,"quest"),this.findAndMergeBlock(y),this.mergeIntersecLine(y),this.mergeSmallLine(y,L);for(const S of y)this.calculateSize(S);return y}mergeIntersecLine(u){let t=0;for(;t<u.length;){let g=u[t];t++,t<u.length&&h.CanvasUtil.isLineVIntersec(g,u[t])&&(this.mergeLine(g,u[t]),u.splice(t,1),t--)}}findAndSplitQuestAnsLine(u,t,g){let f=0,T=[],k=O.CONST.BREAK_LINE_PATTERN.join("|");for(const y of u){y.top=void 0,y.bottom=void 0;let Z=y.strLine.replace(/\|/g,"").trim().match(k);if(null!=Z&&Z.length>0){let L=/[\s\|\.]+[B\u0412][\s\|]*\./g,I=y.strLine.trim().toUpperCase().match(L);if(null!=I&&I.length>0){let S=Z[0].toUpperCase().indexOf("A");T.push({lineIndex:f,strIndex:S})}}f++}for(let y=T.length-1;y>=0;y--){let Z=T[y].lineIndex;this.splitLine(Z,t[u[Z].pageIndex],g[u[Z].pageIndex],T[y].strIndex,u)}}mergeSmallLine(u,t){let g=0,f=1.2*O.CONST.LINE_SMALL_HEIGHT;for(;g<u.length;){let T=u[g];if(!T||!this.isSmallLine(T)){g++;continue}g-1>=0&&!u[g-1].bottom&&(u[g-1].bottom=h.CanvasUtil.getBottomLine(t,g-1,u)[0]),g+1<u.length&&!u[g+1].top&&(u[g+1].top=h.CanvasUtil.getTopLine(t,g+1,u)[0]);let k=g-1<0?-9999:this.getLineTop(T)-this.getLineBot(u[g-1]),y=g+1>=u.length?-9999:this.getLineTop(u[g+1])-this.getLineBot(T),Z=g-1>=0&&u[g-1].transform[4]<=T.transform[4]&&T.transform[4]<=u[g-1].transform[4]+u[g-1].width,L=g+1<u.length&&u[g+1].transform[4]<=T.transform[4]&&T.transform[4]<=u[g+1].transform[4]+u[g+1].width;if(0==g&&y<=f&&L){this.mergeLine(u[g+1],T),u.splice(g,1),g--;continue}if(g==u.length-1&&k<=f&&Z){this.mergeLine(u[g-1],T),u.splice(g,1),g--;continue}let I=-1;k>y&&L&&y<=f?I=g+1:k<=y&&Z&&k<=f?I=g-1:k<=y&&L&&y<=f?I=g+1:k>y&&Z&&k<=f&&(I=g-1),I>=0?(this.mergeLine(u[I],T),u.splice(g,1),g--):g++}}isSmallLine(u){return u.height<O.CONST.LINE_SMALL_HEIGHT}mergeLine(u,t){for(const g of t.textObjs)this.addTxtToLine(u,g)}findAndMergeAnsQuestBlock(u,t){let f=0;for(;f<u.length;){if("ans"==t&&this.isAnsLine(u[f])||"quest"==t&&this.isQuestLine(u[f])){let k=f,y=-1,Z=1,L=[];for(;Z<=10;){if(k=f+y*Z,k<0){y=1,Z=1;continue}if(k>=u.length)break;let I=this.isAnsLine(u[k]),S=I||this.isQuestLine(u[k]),E="ans"==t&&I&&h.CanvasUtil.isSameLine(u[f],u[k]),H=!S&&h.CanvasUtil.isLineIntersec(u[f],u[k])&&u[k].transform[4]>u[f].transform[4];if((E||H)&&L.push(k),Z++,S&&1==y)break;(Z>10||S)&&-1==y&&(y=1,Z=1)}L.sort((I,S)=>I<S?1:-1);for(const I of L)for(const S of u[I].textObjs)this.addTxtToLine(u[f],S);for(const I of L)u.splice(I,1),I<f&&f--}f++}}findAndMergeBlock(u){let t=0;for(;t<u.length;){if(this.isAnsLine(u[t])||this.isQuestLine(u[t])){t++;continue}let f=t+1;for(;f<u.length&&u[t].pageIndex==u[f].pageIndex;){let T=this.isAnsLine(u[f])||this.isQuestLine(u[f]);if(h.CanvasUtil.isLineIntersec(u[t],u[f])&&!T||h.CanvasUtil.isSameLine(u[t],u[f])){for(const k of u[f].textObjs)this.addTxtToLine(u[t],k);u.splice(f,1),f=t}f++}t++}}isAnsLine(u){let g=u.strLine.trim().match(/[\s\|\.]+[AB\u0412CDEFGHIJK]\s*\./g);return null!=g&&g.length>0}isQuestLine(u){let t=O.CONST.QUESTION_PATTERN.join("|"),g=u.strLine.replace(/\|/g,"").toLowerCase().trim().match(t);return null!=g&&g.length>0}encodeLines(u,t){let g="",f=0;for(const T of t){if(T.height<O.CONST.LINE_SMALL_HEIGHT){f-1>=0&&!t[f-1].bottom&&(t[f-1].bottom=h.CanvasUtil.getBottomLine(u,f-1,t)[0]),f+1<t.length&&!t[f+1].top&&(t[f+1].top=h.CanvasUtil.getTopLine(u,f+1,t)[0]);let k=f-1<0?-9999:this.getLineTop(T)-this.getLineBot(t[f-1]),y=f+1>=t.length?-9999:this.getLineTop(t[f+1])-this.getLineBot(T),Z=f-1>=0&&t[f-1].transform[4]<=T.transform[4]&&T.transform[4]+T.width<=t[f-1].transform[4]+t[f-1].width,L=f+1<t.length&&t[f+1].transform[4]<=T.transform[4]&&T.transform[4]+T.width<=t[f+1].transform[4]+t[f+1].width,I=1.2*O.CONST.LINE_SMALL_HEIGHT;Math.abs(k)>=I&&Math.abs(y)>=I?g+="L":g+=-9999==k?"3":-9999==y?"4":k>y&&L?"2":k<=y&&Z?"1":k<=y&&L?"2":k>y&&Z?"1":"L"}else g+="L";f++}return g}getLineTop(u){return u.top?u.top:u.transform[5]}getLineBot(u){return u.bottom?u.bottom:u.transform[5]+u.height}splitLine(u,t,g,f,T){let k=T[u],y=h.CanvasUtil.calIndexPos(k.textObjs,t,g,f,!0),Z=this.newLine(k.textObjs[0],k.pageIndex),L=y[2],I=y[1],S=k.textObjs[L],E=S.transform,H={str:S.str.substr(0,I),width:y[4]-E[4],height:S.height,fontName:S.fontName,transform:[E[0],E[1],E[2],E[3],E[4],E[5]]},G={str:S.str.substr(I),width:S.width-H.width,height:S.height,fontName:S.fontName,transform:[E[0],E[1],E[2],E[3],y[4],E[5]]},Y=k.textObjs;k.textObjs=[],Z.textObjs=[];for(let $=0;$<Y.length;$++)$<L?this.addTxtToLine(k,Y[$]):$>L?this.addTxtToLine(Z,Y[$]):(this.addTxtToLine(k,H),this.addTxtToLine(Z,G));return this.calculateSize(k),this.calculateSize(Z),u==T.length-1?T.push(Z):T.splice(u+1,0,Z),Z}findAndMergeSmallLine(u,t,g){let f=0,T=u.matchAll(g),k=[];for(;;){let y=T.next();if(y.done)break;let Z=y.value[0],L=y.value.index,I=0,S=[];for(let E=0;E<Z.length;E++)"L"==Z[E]?I=L+E:S.push(L+E);for(const E of S){for(const H of t[E].textObjs)this.addTxtToLine(t[I],H);t[I].top=void 0,t[I].bottom=void 0,k.push(E)}f++}k.sort((y,Z)=>y<Z?1:-1);for(const y of k)t.splice(y,1);return f}newLine(u,t){let g={strLine:"",transform:[],textObjs:[],pageIndex:t,width:0,height:0,txtLength:0};return g.transform[4]=u.transform[4],g.transform[5]=u.transform[5],g.height=u.height,g.width=u.width,g.txtLength=u.str.length,g.textObjs.push(u),g}addTxtToLine(u,t){t.transform[4]<u.transform[4]&&(u.transform[4]=t.transform[4]),t.transform[5]<u.transform[5]&&(u.transform[5]=t.transform[5]),t.transform[5]+t.height>u.transform[5]+u.height&&(u.height=t.transform[5]+t.height-u.transform[5]),t.transform[4]+t.width>u.transform[4]+u.width&&(u.width=t.transform[4]+t.width-u.transform[4]),u.txtLength+=t.str.length,u.textObjs.push(t);let g=u.transform[4]+u.width,f=u.height;for(const T of u.textObjs)T.transform[4]+T.width>g&&(g=T.transform[4]+T.width),T.transform[5]+T.height>u.transform[5]+f&&(f=T.transform[5]+T.height-u.transform[5]);u.width=g-u.transform[4],u.height=f}static transform(u,t){return pdfjsLib.Util.transform(u,t)}render(u,t,g,f){var T;let k=this,y=u.length;for(let Z=0;Z<y;Z++){let L=document.createElement("div");L.className="pdf-page",L.id="page-"+Z,null===(T=document.getElementById(t))||void 0===T||T.appendChild(L),k.renderPage(u[Z],g,f)}}calculateSize(u){if(0==u.textObjs.length)return;u.textObjs.sort((S,E)=>1e6*Math.floor(S.transform[4])+S.transform[5]>1e6*Math.floor(E.transform[4])+E.transform[5]?1:-1),u.strLine="";let t=0,g=0,f=0,T=0,k=9999,y=0,Z=9999;for(const S of u.textObjs){let E=h.CanvasUtil.isObjIntersec(u.textObjs[0],S);f=S.transform[4];let H=f-g>O.CONST.SPLIT_MARGIN&&""!=S.str.trim()||T!=S.transform[5]?"|":"";u.strLine+=H+S.str,f<Z&&(Z=f);let G=S.transform[4]+S.width;E&&(g=G),G>t&&E&&(t=G),E&&(T=S.transform[5]),S.transform[5]<k&&(k=S.transform[5]),S.transform[5]+S.height>y&&(y=S.transform[5]+S.height)}u.transform[4]=Z,u.transform[5]=k,u.width=t-Z,u.height=y-k,u.transform[0]=k,u.transform[1]=y;let L=O.CONST.TVCN_CHAR,I=u.strLine;for(const S of L)I=I.replace(new RegExp(S[0],"g"),S[1]);u.strLine=I}renderPage(u,t,g){let f=u._pageIndex,T=u.getViewport({scale:t}),k=.8*T.width,y=document.createElement("canvas"),Z=document.getElementById("page-"+f);null==Z||Z.appendChild(y),y.id="canvas"+f;let L=y.getContext("2d",{alpha:!1});y.height=T.height,y.width=T.width,y.style.height=T.height*k/T.width+"px",y.style.width=k+"px",Z&&(Z.style.width=y.style.width,Z.style.height=y.style.height);const S={canvasContext:L,transform:[1,0,0,1,0,0],viewport:T,annotationMode:pdfjsLib.AnnotationMode.ENABLE_FORMS,optionalContentConfigPromise:this.optionalContentConfigPromise,annotationCanvasMap:new Map,pageColors:{background:"Canvas",foreground:"CanvasText"}};u.render(S).promise.then(function(){g&&g(L,u._pageIndex,T)})}}Q.PdfUtils=j},22161:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.Process=void 0;const O=b(25442),h=b(17585),j=b(82700),x=b(24363),u=b(95318);Q.Process=class t{constructor(f){var T,k;this.config=f,O.CONST.load(f);let y=JSON.parse(f);O.CONST.LINE_SMALL_HEIGHT=y.LINE_SMALL_HEIGHT*O.CONST.RENDER_SCALE,O.CONST.SPLIT_MARGIN=y.SPLIT_MARGIN*O.CONST.RENDER_SCALE,O.CONST.INTERSEC_MARGIN=y.INTERSEC_MARGIN*O.CONST.RENDER_SCALE,O.CONST.LINE_MAGIN=y.LINE_MAGIN*O.CONST.RENDER_SCALE,O.CONST.MARGIN_LEFT=y.MARGIN_LEFT*O.CONST.RENDER_SCALE,O.CONST.FOOTER_PATTERN=null!==(T=y.FOOTER_PATTERN)&&void 0!==T?T:["(trang\\s*\\d+)","(Page\\s*\\d+)","(Trang\\s*\\d+)","(TRANG\\s*\\d+)","(^\\d{1,4}$)"],O.CONST.HELP_ANS_PATTERN=null!==(k=y.HELP_ANS_PATTERN)&&void 0!==k?k:["([\\s\\.]*Ch\u1ecdn\\s*([ABCDEFGH]))"]}setUpdateStatusCallback(f){this.updateStatusCallback=f}setOncompleteCallback(f){this.onCompleteCallback=f}getOverview(f){let T=f.filter(E=>E.isGroup).length,k=f.filter(E=>!E.isGroup).length,y=f.filter(E=>E.answers.length>0).length,Z=f.filter(E=>!E.isGroup&&0==E.answers.length).length,L=f.filter(E=>E.answers.length>4),I=L.length+"|"+L.map(E=>E.num).join(",");return L=f.filter(E=>E.answers.length<4&&E.answers.length>0),{groupNum:T+"",questNum:k+"",tnNum:y+"",tlNum:Z+"",tnGt4:I,tnLt4:L.length+"|"+L.map(E=>E.num).join(",")}}parsePdf(f){let T=new u.PdfUtils;T.loadPdf(f,k=>{const y=k.length;let Z=[],L=[],I=document.createElement("div");I.id="hiddenWrapper",I.style.width="1px",I.style.height="1px",I.style.overflow="hidden",I.style.opacity="0",I.style.zIndex="-9999",I.style.position="fixed",I.style.top="0",I.style.left="0",document.body.appendChild(I);let S=document.createElement("div"),E="canvasWrapper";S.id=E,I.appendChild(S);const H=(new Date).getTime();let G=[];T.render(k,E,O.CONST.RENDER_SCALE,(Y,$,K)=>{if(null!=Y&&(Z[$]=Y,L[$]=K),G.push(1),this.updateStatusCallback&&this.updateStatusCallback(`Rendering: ${G.length}/${y}`),G.length==y){const nt=(new Date).getTime();this.updateStatusCallback&&this.updateStatusCallback("Render done: "+(nt-H)/1e3+" secs"),this.startAnalyze(Z,L,k)}})})}imgToTextObj(f,T){return{str:"img",fontName:T,width:f.paintWidth,height:f.paintHeight,transform:[-999,0,0,0,-f.left,-f.top-f.paintHeight]}}startAnalyze(f,T,k){const y=k.length;let Z=[],L=[],I=[],S=new u.PdfUtils;const E=(new Date).getTime();for(let H=0;H<y;H++){const G=H;let Y=S.getImages(k[H],G);k[H].getTextContent().then($=>{for(const nt of Y)$.items.push(this.imgToTextObj(nt,$.items.length>0?$.items[0].fontName:""));let K=S.getLines($,G,f[G],T[G]);if(L=L.concat(K),I[G]=$.styles,Z.push(1),Z.length==y){L.sort((Tt,jt)=>1e7*Tt.pageIndex+(Tt.transform.length>0?Tt.transform[5]:0)-(1e7*jt.pageIndex+(jt.transform.length>0?jt.transform[5]:0))),S.findAndSplitQuestAnsLine(L,I,f);let nt=new j.FooterParser,st=0;for(const Tt of L){if((L.length-1==st||st+1<L.length-1&&Tt.pageIndex!=L[st+1].pageIndex)&&(Tt.isLastLine=!0),Tt.isLastLine&&nt.parse(Tt.strLine).length>0){Tt.isFooter=!0;let jt=x.CanvasUtil.getBottomLine(S.imageCache[L[st-1].pageIndex],st-1,L);Tt.top=jt[0]+O.CONST.MARGIN_LEFT}st++}let ft=new h.ExamParser(this.config),ct=L.map(Tt=>Tt.strLine),_t=ft.parse(ct),Ct=this.getQuestionInfo(_t,L,I,f,S.imageCache);const Dt=(new Date).getTime();this.updateStatusCallback&&this.updateStatusCallback("Analyze done: "+(Dt-E)/1e3+" secs"),this.showOnCanvas(Ct,f,O.CONST.DRAW_RESULT),this.onCompleteCallback&&this.onCompleteCallback(Ct,f)}})}}getPosInfo(f,T,k,y,Z,L,I,S,E){if(!k.top){let Y=x.CanvasUtil.getTopLine(Z,L,y);k.top=Y[0],k.isIntersec=Y[1]}if(!k.bottom){let Y=x.CanvasUtil.getBottomLine(Z,L,y);k.bottom=Y[0],k.isIntersec=Y[1]}return{str:"",pageIndex:k.pageIndex,lineIndex:L,transform:"a"==f?x.CanvasUtil.calIndexPos2(k.textObjs,S,I,E?E-1:0):k.transform,startLeft:T>=0?x.CanvasUtil.calIndexPos2(k.textObjs,S,I,T-1):void 0,type:f}}getQuestionInfo(f,T,k,y,Z){let L=[];for(const I of f){let S=I.parts[0].lineIdx,E=T[S],H=this.getPosInfo("q",I.parts[0].s,E,T,Z[E.pageIndex],S,y[E.pageIndex],k[E.pageIndex]),G=null;if(S=I.parts[I.parts.length-1].lineIdx,I.answers.length>0){let Y=I.answers[I.answers.length-1];Y.parts.length>0&&(S=Y.parts[Y.parts.length-1].lineIdx)}if(S+=1,S<T.length&&(E=T[S],G=this.getPosInfo("q",-1,E,T,Z[E.pageIndex],S,y[E.pageIndex],k[E.pageIndex])),I.isGroup)L.push({num:I.label,answers:[],remove:this.getQuestRemoveBox(H,T),positions:this.getQuestBoxes(H,T,G,y[E.pageIndex].canvas.height),isGroup:!0,text:I.parts.map(Y=>T[Y.lineIdx])});else{let Y={num:I.label,answers:[],remove:this.getQuestRemoveBox(H,T),positions:this.getQuestBoxes(H,T,G,y[E.pageIndex].canvas.height),group:I.group,strAns:I.strAns,isFixAns:I.isFixAns,text:I.parts.map(K=>T[K.lineIdx])};L.push(Y);let $=0;for(const K of I.answers){let nt={pageIndex:Y.remove.pageIndex,top:Y.remove.top-1,left:Y.remove.left-1,width:1,heigh:1};if(K.parts.length>0){if(S=K.parts[0].lineIdx,E=T[S],1==E.isIntersec&&(Y.isFixAns=!0),K.parts.length>1&&(Y.isFixAns=!0),H=this.getPosInfo("a",K.parts[0].s,E,T,Z[E.pageIndex],S,y[E.pageIndex],k[E.pageIndex],K.parts[0].b),G=null,$<I.answers.length-1){let ct=I.answers[$+1];S=ct.parts[0].lineIdx,E=T[S],G=this.getPosInfo("a",ct.parts[0].s,E,T,Z[E.pageIndex],S,y[E.pageIndex],k[E.pageIndex],ct.parts[0].b)}else S=K.parts[K.parts.length-1].lineIdx+1,S<T.length-1&&(E=T[S],G=this.getPosInfo("q",-1,E,T,Z[E.pageIndex],S,y[E.pageIndex],k[E.pageIndex]));let st=this.getAnsRemoveBox(H,T),ft={label:K.label,remove:st,isCorrect:K.isCorrect,positions:K.isInline?[st]:this.getAnsBoxes(H,T,G,y[E.pageIndex].canvas.height)};Y.answers.push(ft)}else Y.answers.push({label:K.label,remove:nt,isCorrect:K.isCorrect,positions:[nt]});$++}I.help&&I.help.length>0&&(S=I.help[0].lineIdx,E=T[S],H=this.getPosInfo("q",I.help[0].s,E,T,Z[E.pageIndex],S,y[E.pageIndex],k[E.pageIndex]),G=null,S=I.help[I.help.length-1].lineIdx+1,S<T.length&&(E=T[S],G=this.getPosInfo("q",-1,E,T,Z[E.pageIndex],S,y[E.pageIndex],k[E.pageIndex])),Y.help={num:I.label,remove:this.getQuestRemoveBox(H,T),positions:this.getQuestBoxes(H,T,G,y[E.pageIndex].canvas.height),text:I.help.map(K=>T[K.lineIdx])})}}return L}showHidden(){let f=document.getElementById("hiddenWrapper");f&&(f.style.opacity="1",f.style.width="",f.style.height="",f.style.overflow="",f.style.position="")}showOnCanvas(f,T,k){const y=(new Date).getTime(),Z=new Map([["A","rgba(18, 0, 255, 0.4)"],["B","rgba(0, 158, 34, 0.4)"],["C","rgba(50, 50, 50, 0.4)"],["D","rgba(132, 0, 137, 0.4)"],["E","rgba(132, 0, 137, 0.4)"],["F","rgba(132, 0, 137, 0.4)"],["G","rgba(132, 0, 137, 0.4)"],["H","rgba(132, 0, 137, 0.4)"]]);if(k.indexOf("quest")>=0)for(const I of f){for(const S of I.positions)x.CanvasUtil.drawBox(T[S.pageIndex],I.isGroup?"black":"red",S);x.CanvasUtil.drawBox(T[I.remove.pageIndex],"yellow",I.remove);for(const S of I.answers){for(const E of S.positions)x.CanvasUtil.drawBox(T[E.pageIndex],Z.get(S.label)+"",E,!0);x.CanvasUtil.drawBox(T[S.remove.pageIndex],"yellow",S.remove),S.isCorrect&&x.CanvasUtil.drawPoint(T[S.positions[0].pageIndex],"green",S.positions[0])}if(I.help){for(const S of I.help.positions)x.CanvasUtil.drawBox(T[S.pageIndex],"orange",S);I.help.remove&&x.CanvasUtil.drawBox(T[I.help.remove.pageIndex],"yellow",I.help.remove)}}const L=(new Date).getTime();this.updateStatusCallback&&this.updateStatusCallback("Draw done: "+(L-y)/1e3+" secs")}getAnsRemoveBox(f,T){let k=f.startLeft?f.startLeft[5]-2:T[f.lineIndex].top,y=f.transform[4]-O.CONST.MARGIN_LEFT,Z=f.startLeft?f.startLeft[5]+f.startLeft[3]:T[f.lineIndex].bottom;return{pageIndex:f.pageIndex,top:k||20,left:y,heigh:Z&&k?Z-k:0,width:(f.startLeft?f.startLeft[4]:0)-y}}getAnsBoxes(f,T,k,y){const Z=y,L=O.CONST.MARGIN_LEFT;let I=[],S=T[f.lineIndex].top,E=T[f.lineIndex].bottom;if(!S||!E)return[];let G=E,Y=f.transform[4]-L,$=k&&f.lineIndex==k.lineIndex?k.transform[4]-L:T[f.lineIndex].transform[4]+T[f.lineIndex].width+L;if(I.push({pageIndex:f.pageIndex,top:S,left:Y,width:$-Y,heigh:E-S}),k&&k.lineIndex==f.lineIndex)return I;S=E,E=Z,$=0;let K=f.pageIndex,nt=0;for(nt=f.lineIndex+1;nt<T.length;nt++){if(E==Z&&x.CanvasUtil.isLastLineOfPage(nt,T)){let ft=T[nt].isFooter?T[nt-1]:T[nt];E=ft.transform[5]+ft.height+20}let st=T[nt].top;if(nt>f.lineIndex+1&&!T[nt-1].isFooter){let ft=T[nt-1].transform[4]+T[nt-1].width+L;ft>$&&($=ft);let ct=T[nt-1].transform[4]-L;ct<Y&&(Y=ct)}if(T[nt].isFooter&&st)nt-f.lineIndex>1?(E=T[nt-1].transform[5]+T[nt-1].height+O.CONST.LINE_MAGIN,Y=T[f.lineIndex+1].transform[4]-L):E=T[f.lineIndex].bottom;else if(T[nt].pageIndex>K&&(E&&E-S>O.CONST.LINE_SMALL_HEIGHT&&nt-f.lineIndex>1&&I.push({pageIndex:K,top:S,left:Y,width:$-Y,heigh:E-S}),S=20,G=S),K=T[nt].pageIndex,st){E=st;break}}if(nt>=T.length&&(nt=T.length-1),nt-f.lineIndex>1&&T[nt-1].transform[5]>G&&!x.CanvasUtil.isFirstLineOfPage(nt,T)){let st=20==S?T[nt].transform[4]:T[f.lineIndex+1].transform[4];if(20!=S)for(let ft=f.lineIndex+2;ft<=nt;ft++)T[ft].transform[4]<st&&(st=T[ft].transform[4]);E&&E-S>O.CONST.LINE_SMALL_HEIGHT&&I.push({pageIndex:K,top:S,left:st,width:$-st,heigh:E-S})}k&&"a"==k.type&&k.transform[4]>T[k.lineIndex].transform[4]+10*O.CONST.RENDER_SCALE&&($=k.transform[4]-L,S=T[k.lineIndex].top,Y=T[k.lineIndex].transform[4]-L,E=T[k.lineIndex].bottom,S&&E&&E-S>O.CONST.LINE_SMALL_HEIGHT&&I.push({pageIndex:K,top:S,left:Y,width:$-Y,heigh:E-S}));for(let st=I.length-1;st>=1;st--)I[st].left-(I[st-1].left+I[st-1].width)>=20*O.CONST.RENDER_SCALE&&I.splice(st,1);return I}getQuestRemoveBox(f,T){let k=f.startLeft?f.startLeft[5]:T[f.lineIndex].top,y=f.transform[4]-O.CONST.MARGIN_LEFT,Z=f.startLeft?f.startLeft[5]+f.startLeft[3]:T[f.lineIndex].bottom;return{pageIndex:f.pageIndex,top:k||20,left:y,heigh:Z&&k?Z-k:0,width:(f.startLeft?f.startLeft[4]:0)-y}}getQuestBoxes(f,T,k,y){let Z=y;for(let nt=f.lineIndex;nt<T.length;nt++)if(x.CanvasUtil.isLastLineOfPage(nt,T)){let st=T[nt].isFooter?T[nt-1]:T[nt];Z=st.transform[5]+st.height+20;break}let L=[],I=f.pageIndex,S=k?k.lineIndex:T.length-1,E=T[f.lineIndex].transform[4]-O.CONST.MARGIN_LEFT,H=T[f.lineIndex].top;if(!H)return[];let G=O.CONST.CROP_FULL_WIDTH?x.CanvasUtil.getMaxLineRight(-1,T)+2*O.CONST.MARGIN_LEFT:T[f.lineIndex].transform[4]+T[f.lineIndex].width+2*O.CONST.MARGIN_LEFT,Y=Z,$=I,K=f.lineIndex+1;for(;K<=S;K++){let nt=T[K].top;if(K==T.length-1&&!k&&(nt=T[K].bottom),!O.CONST.CROP_FULL_WIDTH){let ft=T[K-1].transform[4]+T[K-1].width+2*O.CONST.MARGIN_LEFT;ft>G&&(G=ft)}let st=T[K-1].transform[4]-O.CONST.MARGIN_LEFT;st<E&&(E=st),T[K].isFooter&&nt?Y=nt:(T[K].pageIndex>$&&(T[K-1].isFooter||(Y=Z),L.push({pageIndex:$,top:H,left:E,width:G-E,heigh:Y-H}),H=20,E=x.CanvasUtil.getMinLineLeft(T[K].pageIndex,T)-O.CONST.MARGIN_LEFT),$=T[K].pageIndex,nt&&(Y=nt))}if(K-=1,!k&&x.CanvasUtil.isLastLineOfPage(K,T)){let nt=T[K].isFooter?T[K-1]:T[K];Y=nt.transform[5]+nt.height+20}return x.CanvasUtil.isFirstLineOfPage(K,T)||L.push({pageIndex:$,top:H,left:E,width:G-E,heigh:Y-H}),L}}},70432:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.AnswerParser=void 0;const O=b(20430);class h extends O.Parser{constructor(x){super(),null!=x&&(this.isOn=x),this.TYPE=h.TYPE_NAME}do(x){let u=[],t="|"+x,g=/([\s\|\.\]]+\*?[A-H][\s\|]*[\.\)])/g,f=this.matchPos(t,g,!1);0==f.length&&(f=this.matchPos(t,g,!0));let T=!1;0==f.length&&/^\|?\s*\*?[A-H\s\|]+$/g.test(t)&&(T=!0,f=this.matchPos(t,/\*?[A-H]/g,!1));let k=!1;if(0==f.length&&(T=!0,k=!0,f=this.matchPos(t,/\[\*?[A-H]:[^\]]+\]/g,!1)),f.length>0)for(const y of f){let Z=y.index+y.value.length-1,L=-9999,I=y.value.replace(/\*?[\sA-H\|]/g,"");k&&(L=y.index+y.value.length-2,y.index=y.index+1,Z=y.index+1+(y.value.startsWith("[*")?1:0),I=".");let S={type:this.TYPE,pos:[y.index-1,Z,L]},E=x.substring(S.pos[0]);!T&&!/^\|?\s*\*?[A-Himg\s\|\.]+$/g.test(t)&&E.trim()==y.value.trim()||(S.label=x.substring(S.pos[0],S.pos[0]+1),"*"==S.label&&(S.label=x.substring(S.pos[0]+1,S.pos[0]+2),S.extInfo="*"),S.olabel=I,S.score=1,""==x.substring(0,S.pos[0]).replace(/[\s\|]/g,"")&&(S.score=2),u.push(S))}return u}matchPos(x,u,t){let g=t?x.toUpperCase():x,f=/[\s\|\.\]]/,T=g.matchAll(u),k=[];for(;;){let y=T.next();if(y.done)break;let Z=0;for(let I=y.value.index;I<g.length&&f.test(g[I]);I++)Z++;let L=y.value[0].substr(Z,1);"A"==L&&!g.replace(/\|/g,"").replace(/\[!info:\d+\]/g,"").trim().startsWith("A")||"*A"==L&&!g.replace(/\|/g,"").replace(/\[!info:\d+\]/g,"").trim().startsWith("*A")||k.push({value:y.value[0].substr(Z),index:y.value.index+Z})}return k}}Q.AnswerParser=h,h.TYPE_NAME="answer"},99739:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.DapAnChiTietParser=void 0;const O=b(25442),h=b(20430);class j extends h.Parser{constructor(u){super(),this.TYPE=j.TYPE_NAME,null!=u&&(this.isOn=u)}do(u){let g=this.cleanLine(u);return/^[0-9ABCDEFGHabcdefgh]+$/g.test(g)&&g.length>=2?[{type:j.TYPE_NAME,pos:[0,0]}]:[]}cleanLine(u){let t=[/\|/g,/[\s\.\-:,;!\[\]@\*\$\(\)]+/g,/C\xe2u/g,/\u0110\xe1p\xe1n/g,/\u0110\/A/g,/Question/g,/Questions/g,/question/g,/questions/g],g=u;g=g.replaceAll(/\[![!iucsbp]+:\$(([^\$]|\$[^\]])+)\$\]/g,"$1"),g=g.replaceAll(/\[![!iucsbp]+:!!\]/g,"");for(const f of t)g=g.replaceAll(f,"");return g=g.replaceAll("\\n"," "),g}getAnsMC(u,t){var g;let f=[];for(const L of t)f.push(u[null!==(g=L.lineIdx)&&void 0!==g?g:0]);let T=f.join(""),k=this.cleanLine(T),y=this.getResultMC(k.toUpperCase()),Z=new Map;for(const L of y)Z.set(L.num,L.str);return Z}getAnsStr(u){let t=u.join("\n");t=t.replaceAll(/\[![!iucsbp]+:\$(([^\$]|\$[^\]])+)\$\]/g,"$1"),t=t.replaceAll(/\[![!iucsbp]+:!!\]/g,""),t=t.replaceAll("[*","").replaceAll("*]","");let g=this.getResultStr(t),f=new Map;for(const T of g)f.set(T.num,T.str);return f}getAnsFromHelp(u,t){let g=[];for(const T of u){let k=t[T.lineIdx];k=k.replaceAll(/\[![!iucsbp]+:\$(([^\$]|\$[^\]])+)\$\]/g,"$1"),k=k.replaceAll(/\[![!iucsbp]+:!!\]/g,""),g.push(k)}let f=0;for(const T of g){let k=T.trim().match(O.CONST.HELP_ANS_PATTERN.join("|"));if(null!=k)for(const y of k)if(null!=y&&1==y.length)return u.splice(f,1),y;f++}return""}getResultStr(u){let t=[],g=u.replace(/\n/g,"\n"),f=O.CONST.QUESTION_PATTERN.join("|").replace(/\(\^/g,"("),T=g.matchAll(new RegExp(f,"ig"));for(;;){let I=T.next();if(I.done)break;let S=I.value[0],E=O.Utils.getNumberFromStr(S);g=g.replace(S,E+".")}let L,y=g.matchAll(/\d+[\.\-]/g),Z=-1;for(;;){let I=y.next();if(I.done)break;if(-1==Z)Z=I.value.index,L=I;else{let S=g.substr(Z,I.value.index-Z);t.push(this.toAns(S,L)),Z=I.value.index,L=I}}if(Z>=0&&L){let I=g.substr(Z);t.push(this.toAns(I,L))}return t}toAns(u,t){let g=t.value[0].length;return{num:+t.value[0].substr(0,g-1),str:u.substring(g).replace(/\s+/g," ").trim()}}getResultMC(u){let t=[],g="",f=[],T=!1;for(let k=0;k<u.length;k++){let y=u.charCodeAt(k),Z=y>=65&&y<=72;if(Z&&""==g)return[];Z!=T&&(f.push(g),g=""),T=Z,g+=u[k]}""!=g&&f.push(g);for(let k=1;k<f.length;k+=2){let y=0,Z=Math.floor(f[k-1].length/f[k].length),L=+f[k-1].substring(y,Z),I=L;for(let S=0;S<f[k].length;S++){if(S>=f[k-1].length)return[];if(L=+f[k-1].substring(y,y+Z),L!=I)return[];t.push({num:L,str:f[k][S]}),y+=Z,I=L+1,Z=I.toString().length}}return t}}Q.DapAnChiTietParser=j,j.TYPE_NAME="chitietdapan"},80983:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.DapAnParser=void 0;const O=b(25442),h=b(20430);class j extends h.Parser{constructor(u){super(),null!=u&&(this.isOn=u),this.TYPE=j.TYPE_NAME}do(u){return this.match(u,O.CONST.DAPAN_PATTERN)}static getAnsFromHelp(u){for(const t of u){let g=t.replace(/\|/g,"").trim().match(O.CONST.HELP_ANS_PATTERN.join("|"));if(null!=g)for(const f of g)if(null!=f&&1==f.length)return f}return""}}Q.DapAnParser=j,j.TYPE_NAME="dapan"},82700:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.FooterParser=void 0;const O=b(25442),h=b(20430);class j extends h.Parser{constructor(u){super(),null!=u&&(this.isOn=u),this.TYPE=j.TYPE_NAME}do(u){return this.match(u,O.CONST.FOOTER_PATTERN)}}Q.FooterParser=j,j.TYPE_NAME="footer"},65465:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.HetParser=void 0;const O=b(25442),h=b(20430);class j extends h.Parser{constructor(u){super(),null!=u&&(this.isOn=u),this.TYPE=j.TYPE_NAME}do(u){return this.match(u,O.CONST.HET_PATTERN)}}Q.HetParser=j,j.TYPE_NAME="end"},72687:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.HuongDanParser=void 0;const O=b(25442),h=b(20430);class j extends h.Parser{constructor(u){super(),null!=u&&(this.isOn=u),this.TYPE=j.TYPE_NAME}do(u){return this.match(u,O.CONST.HUONGDAN_PATTERN)}}Q.HuongDanParser=j,j.TYPE_NAME="huongdan"},29688:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.IncludeParser=void 0;const O=b(20430);class h extends O.Parser{constructor(x){super(),null!=x&&(this.isOn=x),this.TYPE=h.TYPE_NAME}do(x){let u=x.replace(/\|/g,"").trim(),g=/\[@([CTQG]\d+):[^\]]*\]/g,f=/\[@(F:[^\]]*)\]/g,T=/\[[^\]\d]+(\d+)[^\]\d]+\]/g,k=/\[[^\]]+\]/g;if(/^\[@[^!\]]+\]([\.,]\[[^\]!]+\])*$/.test(u)){let y=u;return y=y.replaceAll(g,"$1").replaceAll(f,"$1").replaceAll(T,"$1").replaceAll(k,""),[{type:this.TYPE,pos:[0,0],label:"@@."+y}]}return[]}}Q.IncludeParser=h,h.TYPE_NAME="include"},20430:(it,Q)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.Parser=void 0,Q.Parser=class b{constructor(){this.isOn=!0,this.TYPE="default"}on(){this.isOn=!0}off(){this.isOn=!1}parse(h){return this.isOn?this.do(h):[]}match(h,j){let x=h.replace(/\|/g,"").trim().match(j.join("|"));return null!=x&&x.length>0?[{type:this.TYPE,pos:[0,0]}]:[]}}},49362:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.QuestionParser=void 0;const O=b(25442),h=b(20430);class j extends h.Parser{constructor(u){super(),null!=u&&(this.isOn=u),this.TYPE=j.TYPE_NAME}do(u){let t=this.matchPos(u);if(t.value){let g=null;for(let L=t.value.length-1;L>=0;L--)if(t.value[L]){g=t.value[L];break}if(null==g)return[];let f=u.replace(/\|/g,"").toLowerCase().indexOf(g),T=f,k="",y=u.toLowerCase();for((g.endsWith("(")||g.endsWith("["))&&(g=g.substring(0,g.length-1));T<y.length&&("|"!=y[T]&&(k+=y[T]),T++,k!=g););let Z={type:this.TYPE,pos:[f,T]};return Z.label=this.getNumberFromStr(u.substring(Z.pos[0],Z.pos[1])),Z.olabel=g,[Z]}return[]}matchPos(u){let t=u.replace(/\|/g,"").toLowerCase().trim(),g=O.CONST.QUESTION_PATTERN.join("|"),f=t.matchAll(g).next();return f.value||(g=O.CONST.QUESTION_PATTERN2.join("|"),f=t.matchAll(g).next()),f}getNumberFromStr(u){let t=u.match(/(\d+)/);return t?t[0]:""}}Q.QuestionParser=j,j.TYPE_NAME="question"},50610:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.SectionParser=void 0;const O=b(25442),h=b(20430);class j extends h.Parser{constructor(u){super(),null!=u&&(this.isOn=u),this.TYPE=j.TYPE_NAME}do(u){let t=u.replace(/\|/g,"");t=t.replaceAll(/\[![!ibuc]+:\$(([^\$]|\$[^\]])+)\$\]/g,"$1");let g=t.toLowerCase().trim().match(O.CONST.SECTION_PATTERN_LOWER.join("|")),f=null!=g&&g.length>0;return f||(g=t.trim().match(O.CONST.SECTION_PATTERN_NORMAL.join("|")),f=null!=g&&g.length>0),f&&g?[{type:this.TYPE,pos:[0,0],label:t}]:[]}}Q.SectionParser=j,j.TYPE_NAME="section"},85215:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.ModifyAnsRule=void 0;const O=b(36994);class h extends O.Rule{constructor(x){super(null!=x?x:"","modify:")}load(x){let u=new h(x);return""!=u.pattern?u:null}run(x,u){if(""==this.pattern)return!1;if(this.getStack(x,u).endsWith(this.pattern)&&this.checkVal(x,u)){for(const g of this.data){let f=g.split(":"),T=u-+f[0],k=x[T].label;x[T].label=f[1],x[T].err=k+" -> "+f[1]}return!0}return!1}}Q.ModifyAnsRule=h},72617:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.RemoveDupRule=void 0;const O=b(36994);class h extends O.Rule{constructor(x){super(null!=x?x:"","rmdup:")}load(x){let u=new h(x);return""!=u.pattern?u:null}run(x,u){var t,g;if(""==this.pattern)return!1;if(this.getStack(x,u).endsWith(this.pattern)){let T=null!==(t=x[u].score)&&void 0!==t?t:0,k=null!==(g=x[u-1].score)&&void 0!==g?g:0;if(x[u].label==x[u-1].label)return x.splice(T>k?u-1:u,1),!0}return!1}}Q.RemoveDupRule=h},69504:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.RemoveRule=void 0;const O=b(36994);class h extends O.Rule{constructor(x){super(null!=x?x:"","remove:")}load(x){let u=new h(x);return""!=u.pattern?u:null}run(x,u){if(""==this.pattern)return!1;if(this.getStack(x,u).endsWith(this.pattern)&&this.checkVal(x,u)){for(const g of this.data)x.splice(u-+g,1);return!0}return!1}}Q.RemoveRule=h},36994:(it,Q)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.Rule=void 0,Q.Rule=class b{constructor(h,j){if(this.TYPE="",this.pattern="",this.valPattern="",this.data=[],this.TYPE=j,!h.startsWith(this.TYPE))return;let u=h.substring(this.TYPE.length).split("=>"),t=u[0].split(":");this.pattern=t[0].trim(),this.valPattern=t.length>1?t[1].trim():"",this.data=u[1].split(",").map(g=>g.trim())}checkVal(h,j){var x;if(""==this.valPattern)return!0;let t=[];for(let f=Math.ceil(this.pattern.length/2);f>0;f--)t.push(null===(x=h[j-f+1].label)||void 0===x?void 0:x.trim());let g=t.join("-");return new RegExp(this.valPattern).test(g)}getStack(h,j){let x="",u=j-10>=0?j-10:0;for(;u<=j;u++)x+="-"+h[u].type[0];return x}}},633:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.SameKindRule=void 0;const O=b(25442),h=b(80983),j=b(65465),x=b(72687),u=b(36994);class t extends u.Rule{constructor(f){super(null!=f?f:"","same:")}load(f){let T=new t(f);return""!=T.pattern?T:null}run(f,T){var k,y,Z;if(""==this.pattern)return!1;let L=f[T];if(L.type[0]!=this.pattern)return!1;let I=[],S=[],E="";for(let H=0;H<T;H++){let G=f[H];(G.type==j.HetParser.TYPE_NAME||G.type==h.DapAnParser.TYPE_NAME)&&(E="da"),G.type==x.HuongDanParser.TYPE_NAME&&"da"==E&&(E="hd")}if("da"==E)return!1;for(let H=T-1;H>=0;H--){let G=f[H];if(G.type==j.HetParser.TYPE_NAME||G.type==h.DapAnParser.TYPE_NAME||"hd"==E&&G.type==x.HuongDanParser.TYPE_NAME||(G.type[0]==this.pattern&&G.olabel&&(I.push(G.olabel),S.push(G.label)),2==I.length))break}if(I.length>=1){let H=I[0],G=2==I.length?I[1]:H,Y=null!==(k=L.olabel)&&void 0!==k?k:"";if("a"==this.pattern&&(""==H&&(H="."),""==G&&(G="."),""==Y&&(Y=".")),""==this.valPattern){if(H==G&&Y!=H)return f.splice(T,1),!0}else{let $=this.valPattern.split(",");for(const K of $){let nt=K.trim(),ft=new RegExp(O.CONST[nt].join("|"));if(ft.test(H)&&ft.test(G)&&!ft.test(Y)&&+(null!==(y=S[0])&&void 0!==y?y:"0")+1!=+(null!==(Z=L.label)&&void 0!==Z?Z:"0"))return f.splice(T,1),!0}}}return!1}}Q.SameKindRule=t},1164:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.AnswerParser=void 0;const O=b(51535),h=b(30479),j=b(71789);class x extends j.Parser{constructor(){super(),this.TYPE=x.TYPE_NAME}parse(t,g,f,T,k,y){var Z=[],L=this.matchPos(g.strLine,!1);if(0==L.length&&(L=this.matchPos(g.strLine,!0)),L.length>0)for(const I of L)Z.push({str:I.value,pageIndex:g.pageIndex,lineIndex:f,transform:O.CanvasUtil.calIndexPos(g.textObjs,k,y,I.index),startLeft:O.CanvasUtil.calIndexPos2(g.textObjs,k,y,I.index+1),type:this.TYPE});return Z}static getRemoveBox(t,g){let f=t.startLeft?t.startLeft[5]-2:g[t.lineIndex].top,T=t.transform[4]-h.CONST.MARGIN_LEFT,k=t.startLeft?t.startLeft[5]+t.startLeft[3]:g[t.lineIndex].bottom;return{pageIndex:t.pageIndex,top:f||20,left:T,heigh:k&&f?k-f:0,width:(t.startLeft?t.startLeft[4]:0)-T}}static getBoxes(t,g,f,T){const k=T,y=h.CONST.MARGIN_LEFT;let Z=[],L=g[t.lineIndex].top,I=g[t.lineIndex].bottom;if(!L||!I)return[];let E=I,H=t.transform[4]-y,G=f&&t.lineIndex==f.lineIndex?f.transform[4]-y:g[t.lineIndex].transform[4]+g[t.lineIndex].width+y;if(Z.push({pageIndex:t.pageIndex,top:L,left:H,width:G-H,heigh:I-L}),f&&f.lineIndex==t.lineIndex)return Z;L=I,I=k,G=0;let Y=t.pageIndex,$=0;for($=t.lineIndex+1;$<g.length;$++){if(I==k&&O.CanvasUtil.isLastLineOfPage($,g)){let nt=g[$].isFooter?g[$-1]:g[$];I=nt.transform[5]+nt.height+20}let K=g[$].top;if($>t.lineIndex+1&&!g[$-1].isFooter){let nt=g[$-1].transform[4]+g[$-1].width+y;nt>G&&(G=nt);let st=g[$-1].transform[4]-y;st<H&&(H=st)}if(g[$].isFooter&&K)$-t.lineIndex>1?(I=g[$-1].transform[5]+g[$-1].height+h.CONST.LINE_MAGIN,H=g[t.lineIndex+1].transform[4]-y):I=g[t.lineIndex].bottom;else if(g[$].pageIndex>Y&&(I&&I-L>h.CONST.LINE_SMALL_HEIGHT&&$-t.lineIndex>1&&Z.push({pageIndex:Y,top:L,left:H,width:G-H,heigh:I-L}),L=20,E=L),Y=g[$].pageIndex,K){I=K;break}}if($>=g.length&&($=g.length-1),$-t.lineIndex>1&&g[$-1].transform[5]>E&&!O.CanvasUtil.isFirstLineOfPage($,g)){let K=20==L?g[$].transform[4]:g[t.lineIndex+1].transform[4];I&&I-L>h.CONST.LINE_SMALL_HEIGHT&&Z.push({pageIndex:Y,top:L,left:K,width:G-K,heigh:I-L})}f&&f.type==x.TYPE_NAME&&f.transform[4]>g[f.lineIndex].transform[4]+25*h.CONST.RENDER_SCALE&&(G=f.transform[4]-y,L=g[f.lineIndex].top,H=g[f.lineIndex].transform[4]-y,I=g[f.lineIndex].bottom,L&&I&&I-L>h.CONST.LINE_SMALL_HEIGHT&&Z.push({pageIndex:Y,top:L,left:H,width:G-H,heigh:I-L}));for(let K=Z.length-1;K>=1;K--)Z[K].left-(Z[K-1].left+Z[K-1].width)>=20*h.CONST.RENDER_SCALE&&Z.splice(K,1);return Z}matchPos(t,g){for(var f=g?t.toUpperCase():t,T=h.CONST.ANS_PATTERN,k=new RegExp("[\\s\\|\\.]"),y=f.matchAll(T),Z=[];;){var L=y.next();if(L.done)break;for(var I=0,S=L.value.index;S<f.length&&k.test(f[S]);S++)I++;let E=L.value[0].substr(I,1);"A"==E&&!f.replace(/\|/g,"").trim().startsWith("A")||Z.push({value:E,index:L.value.index+I})}return Z}}Q.AnswerParser=x,x.TYPE_NAME="answer"},51535:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.CanvasUtil=void 0;const O=b(30479);class h{static drawPoint(x,u,t){null!=x&&(x.fillStyle=u,x.beginPath(),x.arc(t.left,t.top,5,0,2*Math.PI),x.fill())}static drawBox(x,u,t,g){null!=x&&(g?(x.fillStyle=u,x.beginPath(),x.rect(t.left,t.top,t.width,t.heigh),x.fill()):(x.strokeStyle=u,x.beginPath(),x.rect(t.left,t.top,t.width,t.heigh),x.stroke()))}static drawBox2(x,u,t,g,f){null!=x&&(x.strokeStyle=u,x.beginPath(),x.rect(f[4],f[5],t,g),x.stroke())}static drawLine(x,u,t,g){null!=x&&(x.strokeStyle=u,x.beginPath(),x.moveTo(t,g),x.lineTo(x.canvas.width-10,g),x.stroke())}static drawText(x,u,t,g){null!=x&&(x.font="11px Arial",x.fillStyle=u,x.fillText(g,t[4],t[5]))}static isLineIntersec(x,u){let t=x.transform[5]<=u.transform[5]&&u.transform[5]<=x.transform[5]+x.height,g=u.transform[5]<=x.transform[5]&&x.transform[5]<=u.transform[5]+u.height,f=x.transform[4]<=u.transform[4]&&u.transform[4]<=x.transform[4]+x.width+O.CONST.INTERSEC_MARGIN,T=u.transform[4]<=x.transform[4]&&x.transform[4]<=u.transform[4]+u.width+O.CONST.INTERSEC_MARGIN,k=this.isSameLine(x,u);return(t||g)&&(f||T)&&!k}static isLineVIntersec(x,u){return(x.transform[5]<=u.transform[5]&&u.transform[5]<=x.transform[5]+x.height||u.transform[5]<=x.transform[5]&&x.transform[5]<=u.transform[5]+u.height)&&(x.transform[4]<=u.transform[4]&&u.transform[4]<=x.transform[4]+x.width+O.CONST.INTERSEC_MARGIN||u.transform[4]<=x.transform[4]&&x.transform[4]<=u.transform[4]+u.width+O.CONST.INTERSEC_MARGIN)&&Math.abs(u.transform[4]-x.transform[4])>O.CONST.INTERSEC_MARGIN/2}static isSameLine(x,u){return Math.abs(x.transform[5]+x.height-(u.transform[5]+u.height))<=O.CONST.LINE_MAGIN}static isObjIntersec(x,u){return x.transform[5]<=u.transform[5]&&u.transform[5]<=x.transform[5]+x.height||u.transform[5]<=x.transform[5]&&x.transform[5]<=u.transform[5]+u.height}static isObjFullIntersec(x,u){return(x.transform[5]<=u.transform[5]&&u.transform[5]<=x.transform[5]+x.height||u.transform[5]<=x.transform[5]&&x.transform[5]<=u.transform[5]+u.height)&&(x.transform[4]<=u.transform[4]&&u.transform[4]<=x.transform[4]+x.width||u.transform[4]<=x.transform[4]&&x.transform[4]<=u.transform[4]+u.width)}static isFirstLineOfPage(x,u){return!(x<0||x>=u.length||0!=x&&u[x-1].pageIndex==u[x].pageIndex)}static isLastLineOfPage(x,u){return!(x<0||x>=u.length||x!=u.length-1&&u[x+1].pageIndex==u[x].pageIndex)}static getTopLine(x,u,t){let g=t[u],f=[[O.CONST.STEP_SIZE,O.CONST.OVERLAP],[1,O.CONST.OVERLAP],[1,.3]];for(const T of f){let k=T[0],y=T[1],Z=g.transform[5],L=0,I=3*k;if(!h.isFirstLineOfPage(u,t)){let E=h.isSameLine(t[u-1],g);h.isLineIntersec(t[u-1],g)?(Z=t[u-1].transform[5]+t[u-1].height,L=t[u-1].transform[5],t[u-1].transform[4]>t[u].transform[4]+2*O.CONST.MARGIN_LEFT?L-=2*O.CONST.MARGIN_LEFT:L+=t[u-1].height*y,k=1,I=t[u].transform[5]+t[u].height/2-Z):(L=E&&u-2>=0?t[u-2].transform[5]+t[u-2].height*y:t[u-1].transform[5]+t[u-1].height*y,E&&h.isFirstLineOfPage(u-1,t)&&(L=0))}if(!O.CONST.ENABLE_IMAGE_PROCESS)return[Z,0];let S=!1;for(;Z>L;){if(!h.hasColor(x,g.transform[4],Z,g.width,k))return[Z,0];S||(S=!0,Z+=I),Z-=k}}return[g.transform[5],1]}static arrContains(x,u){for(const t of u)if(t==x)return!0;return!1}static getBottomLine(x,u,t){let g=t[u],f=[[O.CONST.STEP_SIZE,O.CONST.OVERLAP],[1,O.CONST.OVERLAP],[1,.3]];for(const T of f){let k=T[0],y=T[1],Z=g.transform[5]+g.height,L=9999,I=3*k;if(!h.isLastLineOfPage(u,t)){let E=h.isSameLine(t[u+1],g);h.isLineIntersec(t[u+1],g)?(Z=t[u+1].transform[5],L=t[u+1].transform[5]+t[u+1].height,t[u+1].transform[4]>t[u].transform[4]+2*O.CONST.MARGIN_LEFT?L+=2*O.CONST.MARGIN_LEFT:L-=t[u+1].height*y,I=t[u].transform[5]+t[u].height/2-Z):(L=E&&u+2<t.length?t[u+2].transform[5]+t[u+2].height-t[u+2].height*y:t[u+1].transform[5]+t[u+1].height-t[u+1].height*y,E&&h.isLastLineOfPage(u+1,t)&&(L=9999));let H=t[u+1].top;if(H&&Z>=H&&!E)return[H,0]}if(!O.CONST.ENABLE_IMAGE_PROCESS)return[Z,0];let S=!1;for(;Z<L;){if(!h.hasColor(x,g.transform[4],Z,g.width,k))return[Z,0];S||(S=!0,Z-=I),Z+=k}}return[g.transform[5]+g.height,1]}static hasColor(x,u,t,g,f){let T=Math.round(u),k=Math.round(T+g),y=Math.round(t),Z=Math.round(y+f);for(let H=y;H<Z;H++)for(let G=T;G<k;G++){let Y=4*(H*x.width+G);if((x.data[Y]+x.data[Y+1]+x.data[Y+2])/3<150)return!0}return!1}static calIndexPos2(x,u,t,g,f){let T=[],k=0,y=0,Z=0,L=0,I=0,S=0,E=!0,H=!0;for(const K of x){H=this.isObjIntersec(x[0],K),L=K.transform[4],f||(k+=L-Z>O.CONST.SPLIT_MARGIN&&""!=K.str.trim()||I!=K.transform[5]?1:0),E=L+2*O.CONST.MARGIN_LEFT>=Z;let nt=K.transform[4]+K.width;if(H&&(Z=nt),nt>y&&H&&(y=nt),k+=K.str.length,k>g&&E&&H){K.transform.forEach(_t=>{T.push(_t)}),T[3]=K.height,T[2]=S,T[1]=K.str.length-k+g;let st=K.str.substr(0,K.str.length-k+g+1);if(st.length==K.str.length){T[4]=T[4]+K.width;break}var Y=u[K.fontName].fontFamily,$=Math.hypot(K.transform[2],K.transform[3]);t.font=`${$}px ${Y}`;let ft=t.measureText(st).width,ct=t.measureText(K.str).width;T[4]=T[4]+K.width*ft/ct;break}H&&(I=K.transform[5]),S++}return 0==T.length&&(T=[0,x[x.length-1].length-1,x.length-1,x[0].height,y,x[0].transform[5]]),T}static calIndexPos(x,u,t,g,f){let T=[],k=0,y=0,Z=0,L=0,I=0,S=0,E=!0,H=!0,G="";for(const nt of x){H=this.isObjIntersec(x[0],nt),L=nt.transform[4],f||(k+=L-Z>O.CONST.SPLIT_MARGIN&&""!=nt.str.trim()||I!=nt.transform[5]?1:0,G+=(L-Z>O.CONST.SPLIT_MARGIN&&""!=nt.str.trim()||I!=nt.transform[5]?"|":"")+nt.str),E=L+2*O.CONST.MARGIN_LEFT>=Z;let st=nt.transform[4]+nt.width;if(H&&(Z=st),st>y&&H&&(y=st),k+=nt.str.length,k>g&&E&&H){let ft=nt.str.substr(0,nt.str.length-k+g);var $=u[nt.fontName].fontFamily,K=Math.hypot(nt.transform[2],nt.transform[3]);t.font=`${K}px ${$}`;let ct=t.measureText(ft).width,_t=t.measureText(nt.str).width;nt.transform.forEach(Ct=>{T.push(Ct)}),T[4]=T[4]+nt.width*ct/_t,T[3]=nt.height,T[2]=S,T[1]=nt.str.length-k+g;break}H&&(I=nt.transform[5]),S++}return 0==T.length&&(T=[0,x[x.length-1].length-1,x.length-1,x[0].height,y,x[0].transform[5]]),T}static getTextBottom(x,u,t,g){let f=Math.atan2(x[1],x[0]);u.vertical&&(f+=Math.PI/2);const T=Math.hypot(x[2],x[3]),k=T*h.getAscent(u.fontFamily,t,g);let y=x[5],Z=0;Z=0===f?k:k*Math.cos(f);let L=0*Z;return y=x[5]-Z-L,[y,T+L]}static getAscent(x,u,t){const T=t.get(x);if(T)return T;u.save(),u.font=`30px ${x}`;const k=u.measureText("");let y=k.fontBoundingBoxAscent,Z=Math.abs(k.fontBoundingBoxDescent);if(y){u.restore();const I=y/(y+Z);return t.set(x,I),I}u.strokeStyle="red",u.clearRect(0,0,30,30),u.strokeText("g",0,0);let L=u.getImageData(0,0,30,30).data;Z=0;for(let I=L.length-1-3;I>=0;I-=4)if(L[I]>0){Z=Math.ceil(I/4/30);break}u.clearRect(0,0,30,30),u.strokeText("A",0,30),L=u.getImageData(0,0,30,30).data,y=0;for(let I=0,S=L.length;I<S;I+=4)if(L[I]>0){y=30-Math.floor(I/4/30);break}if(u.restore(),y){const I=y/(y+Z);return t.set(x,I),I}return t.set(x,.8),.8}static getMaxLineRight(x,u){let t=0;for(const g of u)if(g.pageIndex==x||-1==x){let f=g.transform[4]+g.width;f>t&&(t=f)}return t}static getMinLineLeft(x,u){let t=99999;for(const g of u)if(g.pageIndex==x||-1==x){let f=g.transform[4];f<t&&(t=f)}return t}}Q.CanvasUtil=h},30479:(it,Q)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.CONST=void 0;class b{}Q.CONST=b,b.RENDER_SCALE=2,b.LINE_SMALL_HEIGHT=7*b.RENDER_SCALE,b.SPLIT_MARGIN=3*b.RENDER_SCALE,b.INTERSEC_MARGIN=20*b.RENDER_SCALE,b.LINE_MAGIN=2*b.RENDER_SCALE,b.MARGIN_LEFT=2*b.RENDER_SCALE,b.ENABLE_IMAGE_PROCESS=!0,b.STEP_SIZE=2,b.CROP_FULL_WIDTH=!0,b.OVERLAP=.5,b.QUESTION_PATTERN=[],b.QUESTION_PATTERN2=[],b.BREAK_LINE_PATTERN=[],b.SECTION_PATTERN_LOWER=[],b.SECTION_PATTERN_NORMAL=[],b.KICK_PATTERN=[],b.TVCN_CHAR=[],b.HET_PATTERN=[],b.DAPAN_PATTERN=[],b.HUONGDAN_PATTERN=[],b.MULTIPLE_ANS_PATTERN=[],b.DRAW_RESULT="",b.SKIP_CHAR=[],b.FOOTER_PATTERN=[],b.HELP_ANS_PATTERN=[],b.ANS_PATTERN=[]},34283:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.DapAnChiTietParser=void 0;const O=b(71789);class h extends O.Parser{constructor(x,u){super(),this.firstLine=null,this.lineIdx=0,this.str="",this.TYPE=h.TYPE_NAME,null!=x&&(this.isOn=x),this.offCalback=u}parse(x,u,t,g,f,T){var y=u.strLine.replace(/\|/g,"").replace(/\s*\.*\-*:*,*;*/g,"");return y=(y=(y=(y=(y=y.replace(/C\xe2u/g,"")).replace(/\u0110\xe1p\xe1n/g,"")).replace(/\u0110\xe1p/g,"")).replace(/\xe1n/g,"")).replace(/\u0110\/A/g,""),/^[0-9ABCDEFGHabcdefgh]+$/g.test(y)&&y.length>=2&&(null==this.firstLine&&(this.firstLine=u,this.lineIdx=t),this.str+=y),[]}static getBoxes(x,u,t,g){return[]}getResult(x){let u=[],t="",g=[],f=!1;for(let T=0;T<x.length;T++){let k=x.charCodeAt(T),y=k>=65&&k<=72;if(y&&""==t)return[];y!=f&&(g.push(t),t=""),f=y,t+=x[T]}""!=t&&g.push(t);for(let T=1;T<g.length;T+=2){let k=0,y=Math.floor(g[T-1].length/g[T].length),Z=+g[T-1].substr(k,y),L=Z;for(let I=0;I<g[T].length;I++){if(I>=g[T-1].length)return[];if(Z=+g[T-1].substr(k,y),Z!=L)return[];u.push({num:Z,str:g[T][I]}),k+=y,L=Z+1,y=L.toString().length}}return u}on(){super.on(),this.firstLine=null,this.lineIdx=0,this.str=""}off(){if(super.off(),this.offCalback&&this.firstLine){var x=this.getResult(this.str.toUpperCase());if(x.length>0){let u=JSON.stringify({main:x,sub:[]});this.offCalback([{str:u,pageIndex:this.firstLine.pageIndex,lineIndex:this.lineIdx,transform:this.firstLine.transform,type:this.TYPE}])}}this.firstLine=null,this.str=""}}Q.DapAnChiTietParser=h,h.TYPE_NAME="dapanchitiet"},23076:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.DapAnDienTuParser=void 0;const O=b(30479),h=b(52311),j=b(79391),x=b(71789);class u extends x.Parser{constructor(g,f){super(),this.firstLine=null,this.lineIdx=0,this.str="",this.TYPE=u.TYPE_NAME,null!=g&&(this.isOn=g),this.offCalback=f}parse(g,f,T,k,y,Z){let L=[new h.FooterParser,new j.HuongDanParser];for(const S of L)if(S.parse(g,f,T,k,y,Z).length>0)return[];var I=f.strLine;return null==this.firstLine&&(this.firstLine=f,this.lineIdx=T),this.str+=I+"\n",[]}static getBoxes(g,f,T,k){return[]}getResult(g){let f=[],T=g.replace(/\n/g,"\n|"),k=O.CONST.QUESTION_PATTERN.join("|").replace(/\(\^/g,"(\\|"),y=T.matchAll(new RegExp(k,"ig"));for(;;){let E=y.next();if(E.done)break;let H=E.value[0],G=this.getNumberFromStr(H);T=T.replace(H,G+".")}let S,L=T.matchAll(/\d+[\.\-]/g),I=-1;for(;;){let E=L.next();if(E.done)break;if(-1==I)I=E.value.index,S=E;else{let H=T.substr(I,E.value.index-I);f.push(this.toAns(H,S)),I=E.value.index,S=E}}if(I>=0&&S){let E=T.substr(I);f.push(this.toAns(E,S))}return f}toAns(g,f){let T=f.value[0].length;return{num:+f.value[0].substr(0,T-1),str:g.substr(T).replace(/\|/g," ").replace(/ +/g," ").trim()}}getNumberFromStr(g){var f=g.match(/(\d+)/);return f?f[0]:""}on(){super.on(),this.firstLine=null,this.lineIdx=0,this.str=""}off(){if(super.off(),this.offCalback&&this.firstLine){var g=this.getResult(this.str);if(g.length>0){let f=JSON.stringify({main:[],sub:g});this.offCalback([{str:f,pageIndex:this.firstLine.pageIndex,lineIndex:this.lineIdx,transform:this.firstLine.transform,type:this.TYPE}])}}this.firstLine=null,this.str=""}}Q.DapAnDienTuParser=u,u.TYPE_NAME="dapandientu"},18932:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.DapAnParser=void 0;const O=b(30479),h=b(71789);class j extends h.Parser{constructor(u){super(),null!=u&&(this.isOn=u),this.TYPE=j.TYPE_NAME}parse(u,t,g,f,T,k){let y=t.strLine.replace(/\|/g,"").trim().match(O.CONST.DAPAN_PATTERN.join("|"));return null!=y&&y.length>0?[{str:t.strLine,pageIndex:t.pageIndex,lineIndex:g,transform:t.transform,type:this.TYPE}]:[]}static getBoxes(u,t,g,f){return[]}static getAnsFromHelp(u){for(const t of u){let g=t.strLine.replace(/\|/g,"").trim().match(O.CONST.HELP_ANS_PATTERN.join("|"));if(null!=g)for(let f=0;f<g.length;f++)if(null!=g[f]&&1==g[f].length)return g[f]}return""}strContains(u,t){var g=u;for(const f of t)if(g.indexOf(f)>=0)return!0;return!1}}Q.DapAnParser=j,j.TYPE_NAME="dapan"},52311:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.FooterParser=void 0;const O=b(30479),h=b(71789);class j extends h.Parser{constructor(){super(),this.TYPE=j.TYPE_NAME}parse(u,t,g,f,T,k){if(!t.isLastLine||f&&t.transform[5]<f.transform[5]+f.height)return[];var Z=t.strLine.replace(/\|/g,"").trim().match(O.CONST.FOOTER_PATTERN.join("|"));return null!=Z&&Z.length>0?[{str:Z[0],pageIndex:t.pageIndex,lineIndex:g,transform:t.transform,type:this.TYPE}]:[]}static getBoxes(u,t,g,f){return[]}}Q.FooterParser=j,j.TYPE_NAME="footer"},11843:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.HetParser=void 0;const O=b(30479),h=b(71789);class j extends h.Parser{constructor(u){super(),null!=u&&(this.isOn=u),this.TYPE=j.TYPE_NAME}parse(u,t,g,f,T,k){let y=t.strLine.replace(/\|/g,"").trim().match(O.CONST.HET_PATTERN.join("|"));return null!=y&&y.length>0?[{str:t.strLine,pageIndex:t.pageIndex,lineIndex:g,transform:t.transform,type:this.TYPE}]:[]}static getBoxes(u,t,g,f){return[]}strContains(u,t){for(const g of t)if(u.indexOf(g)>=0)return!0;return!1}}Q.HetParser=j,j.TYPE_NAME="het"},79391:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.HuongDanParser=void 0;const O=b(30479),h=b(71789),j=b(35677);class x extends h.Parser{constructor(){super(),this.TYPE=x.TYPE_NAME}parse(t,g,f,T,k,y){let Z=g.strLine.replace(/\|/g,"").trim().match(O.CONST.HUONGDAN_PATTERN.join("|"));return null!=Z&&Z.length>0?[{str:g.strLine,pageIndex:g.pageIndex,lineIndex:f,transform:g.transform,type:this.TYPE}]:[]}static getBoxes(t,g,f,T){return j.QuestionParser.getBoxes(t,g,f,T)}strContains(t,g){var f=t;for(const T of g)if(f.indexOf(T)>=0)return!0;return!1}}Q.HuongDanParser=x,x.TYPE_NAME="huongdan"},71789:(it,Q)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.Parser=void 0,Q.Parser=class b{constructor(){this.isOn=!0,this.TYPE="default"}on(){this.isOn=!0}off(){this.isOn=!1}process(h,j,x,u,t,g){return this.isOn?this.parse(h,j,x,u,t,g):[]}}},449:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.PdfRender=void 0;const O=b(51535),h=b(30479);class j{constructor(){let u=document.createElement("canvas");this.tempCanvas=u.getContext("2d"),this.ascentCache=new Map,this.imageCache=[]}loadPdf(u,t){var g=URL.createObjectURL(u);const T=pdfjsLib.getDocument({url:g,cMapPacked:!0,cMapUrl:"/assets/js/pdf-js-v2/cmaps/",disableAutoFetch:!1,disableFontFace:!1,disableRange:!1,disableStream:!1,docBaseUrl:"",enableXfa:!0,fontExtraProperties:!1,isEvalSupported:!0,maxImageSize:-1,pdfBug:!1,standardFontDataUrl:"/assets/js/pdf-js-v2/standard_fonts/",verbosity:1});var k=[];let y=this;T.promise.then(function(Z){y.optionalContentConfigPromise=Z.getOptionalContentConfig();for(var L=Z._pdfInfo.numPages,I=1;I<=L;I++)Z.getPage(I).then(S=>{k.push(S),k.length==L&&(k=k.sort((E,H)=>E._pageIndex>H._pageIndex?1:-1),t(k))})},function(Z){console.error(Z)})}getImages(u,t){let g=[];if("function"!=typeof u.objs.getAll)return console.log("Unable to read img"),g;let f=u.objs.getAll(),T=Object.keys(f);for(const k of T)f[k].data.pageIndex=t,g.push(f[k].data);return g}isImageObj(u){return-999==u.transform[0]&&"img"==u.str}getLines(u,t,g,f){let T=f.scale,k=u.items.length;for(let S=0;S<k;S++){let E=u.items[S];this.isImageObj(E)||(E.transform=j.transform(f.transform,E.transform),E.width=E.width*T),E.transform[4]+E.width>g.canvas.width&&(E.width=g.canvas.width-E.transform[4]-20);let H=this.isImageObj(E)?[E.transform[5],E.height]:O.CanvasUtil.getTextBottom(E.transform,u.styles[E.fontName],this.tempCanvas,this.ascentCache);E.height=H[1];let G=Math.ceil(H[0]);E.transform[5]=G}u.items.sort((S,E)=>1e6*Math.floor(S.transform[5])-S.transform[4]<1e6*Math.floor(E.transform[5])-E.transform[4]?-1:1);let L,y=[],Z=0;this.imageCache[t]?L=this.imageCache[t]:(L=g.getImageData(0,0,g.canvas.width,g.canvas.height),this.imageCache[t]=L);var I={strLine:"",transform:[],textObjs:[],pageIndex:t,width:0,height:0,txtLength:0};for(let S=0;S<k;S++){let E=u.items[S];if(this.isImageObj(E))for(let G=0;G<k;G++){let Y=u.items[G];if(S!=G&&O.CanvasUtil.isObjIntersec(E,Y)){E.str="";break}}if(O.CanvasUtil.arrContains(E.str.trim(),h.CONST.SKIP_CHAR))continue;let H=Math.floor(E.transform[5]+E.height);0!=Z?Z-H>=-h.CONST.LINE_MAGIN?this.addTxtToLine(I,E):0!=I.textObjs.length&&(y.push(I),I=this.newLine(E,t),Z=Math.floor(I.transform[5]+I.height)):(I=this.newLine(E,t),Z=Math.floor(I.transform[5]+I.height))}y.push(I);for(const S of y)this.calculateSize(S);this.findAndMergeAnsQuestBlock(y,"ans"),this.findAndMergeAnsQuestBlock(y,"quest"),this.findAndMergeBlock(y),this.mergeIntersecLine(y),this.mergeSmallLine(y,L);for(const S of y)this.calculateSize(S);return y}mergeIntersecLine(u){let t=0;for(;t<u.length;){let g=u[t];t++,t<u.length&&O.CanvasUtil.isLineVIntersec(g,u[t])&&(this.mergeLine(g,u[t]),u.splice(t,1),t--)}}findAndSplitQuestAnsLine(u,t,g){let f=0,T=[],k=h.CONST.BREAK_LINE_PATTERN.join("|");for(const Z of u){Z.top=void 0,Z.bottom=void 0;var y=Z.strLine.replace(/\|/g,"").trim().match(k);if(null!=y&&y.length>0){let L=/[\s\|\.]+[B\u0412][\s\|]*\./g,I=Z.strLine.trim().toUpperCase().match(L);if(null!=I&&I.length>0){let S=y[0].toUpperCase().indexOf("A");T.push({lineIndex:f,strIndex:S})}}f++}for(let Z=T.length-1;Z>=0;Z--){let L=T[Z].lineIndex;this.splitLine(L,t[u[L].pageIndex],g[u[L].pageIndex],T[Z].strIndex,u)}}mergeSmallLine(u,t){let g=0,f=1.2*h.CONST.LINE_SMALL_HEIGHT;for(;g<u.length;){let T=u[g];if(!T||!this.isSmallLine(T)){g++;continue}g-1>=0&&!u[g-1].bottom&&(u[g-1].bottom=O.CanvasUtil.getBottomLine(t,g-1,u)[0]),g+1<u.length&&!u[g+1].top&&(u[g+1].top=O.CanvasUtil.getTopLine(t,g+1,u)[0]);let k=g-1<0?-9999:this.getLineTop(T)-this.getLineBot(u[g-1]),y=g+1>=u.length?-9999:this.getLineTop(u[g+1])-this.getLineBot(T),Z=g-1>=0&&u[g-1].transform[4]<=T.transform[4]&&T.transform[4]<=u[g-1].transform[4]+u[g-1].width,L=g+1<u.length&&u[g+1].transform[4]<=T.transform[4]&&T.transform[4]<=u[g+1].transform[4]+u[g+1].width;if(0==g&&y<=f&&L){this.mergeLine(u[g+1],T),u.splice(g,1),g--;continue}if(g==u.length-1&&k<=f&&Z){this.mergeLine(u[g-1],T),u.splice(g,1),g--;continue}let I=-1;k>y&&L&&y<=f?I=g+1:k<=y&&Z&&k<=f?I=g-1:k<=y&&L&&y<=f?I=g+1:k>y&&Z&&k<=f&&(I=g-1),I>=0?(this.mergeLine(u[I],T),u.splice(g,1),g--):g++}}isSmallLine(u){return u.height<h.CONST.LINE_SMALL_HEIGHT}mergeLine(u,t){for(const g of t.textObjs)this.addTxtToLine(u,g)}findAndMergeAnsQuestBlock(u,t){let f=0;for(;f<u.length;){if("ans"==t&&this.isAnsLine(u[f])||"quest"==t&&this.isQuestLine(u[f])){let k=f,y=-1,Z=1,L=[];for(;Z<=10;){if(k=f+y*Z,k<0){y=1,Z=1;continue}if(k>=u.length)break;let I=this.isAnsLine(u[k]),S=I||this.isQuestLine(u[k]),E="ans"==t&&I&&O.CanvasUtil.isSameLine(u[f],u[k]),H=!S&&O.CanvasUtil.isLineIntersec(u[f],u[k])&&u[k].transform[4]>u[f].transform[4];if((E||H)&&L.push(k),Z++,S&&1==y)break;(Z>10||S)&&-1==y&&(y=1,Z=1)}L.sort((I,S)=>I<S?1:-1);for(const I of L)for(const S of u[I].textObjs)this.addTxtToLine(u[f],S);for(const I of L)u.splice(I,1),I<f&&f--}f++}}findAndMergeBlock(u){let t=0;for(;t<u.length;){if(this.isAnsLine(u[t])||this.isQuestLine(u[t])){t++;continue}let f=t+1;for(;f<u.length&&u[t].pageIndex==u[f].pageIndex;){let T=this.isAnsLine(u[f])||this.isQuestLine(u[f]);if(O.CanvasUtil.isLineIntersec(u[t],u[f])&&!T||O.CanvasUtil.isSameLine(u[t],u[f])){for(const k of u[f].textObjs)this.addTxtToLine(u[t],k);u.splice(f,1),f=t}f++}t++}}isAnsLine(u){let g=u.strLine.trim().match(/[\s\|\.]+[AB\u0412CDEFGHIJK]\s*\./g);return null!=g&&g.length>0}isQuestLine(u){let t=h.CONST.QUESTION_PATTERN.join("|"),g=u.strLine.replace(/\|/g,"").toLowerCase().trim().match(t);return null!=g&&g.length>0}encodeLines(u,t){let g="",f=0;for(const T of t){if(T.height<h.CONST.LINE_SMALL_HEIGHT){f-1>=0&&!t[f-1].bottom&&(t[f-1].bottom=O.CanvasUtil.getBottomLine(u,f-1,t)[0]),f+1<t.length&&!t[f+1].top&&(t[f+1].top=O.CanvasUtil.getTopLine(u,f+1,t)[0]);let k=f-1<0?-9999:this.getLineTop(T)-this.getLineBot(t[f-1]),y=f+1>=t.length?-9999:this.getLineTop(t[f+1])-this.getLineBot(T),Z=f-1>=0&&t[f-1].transform[4]<=T.transform[4]&&T.transform[4]+T.width<=t[f-1].transform[4]+t[f-1].width,L=f+1<t.length&&t[f+1].transform[4]<=T.transform[4]&&T.transform[4]+T.width<=t[f+1].transform[4]+t[f+1].width,I=1.2*h.CONST.LINE_SMALL_HEIGHT;Math.abs(k)>=I&&Math.abs(y)>=I?g+="L":g+=-9999==k?"3":-9999==y?"4":k>y&&L?"2":k<=y&&Z?"1":k<=y&&L?"2":k>y&&Z?"1":"L"}else g+="L";f++}return g}getLineTop(u){return u.top?u.top:u.transform[5]}getLineBot(u){return u.bottom?u.bottom:u.transform[5]+u.height}splitLine(u,t,g,f,T){let k=T[u],y=O.CanvasUtil.calIndexPos(k.textObjs,t,g,f,!0),Z=this.newLine(k.textObjs[0],k.pageIndex),L=y[2],I=y[1],S=k.textObjs[L],E=S.transform,H={str:S.str.substr(0,I),width:y[4]-E[4],height:S.height,fontName:S.fontName,transform:[E[0],E[1],E[2],E[3],E[4],E[5]]},G={str:S.str.substr(I),width:S.width-H.width,height:S.height,fontName:S.fontName,transform:[E[0],E[1],E[2],E[3],y[4],E[5]]},Y=k.textObjs;k.textObjs=[],Z.textObjs=[];for(let $=0;$<Y.length;$++)$<L?this.addTxtToLine(k,Y[$]):$>L?this.addTxtToLine(Z,Y[$]):(this.addTxtToLine(k,H),this.addTxtToLine(Z,G));return this.calculateSize(k),this.calculateSize(Z),u==T.length-1?T.push(Z):T.splice(u+1,0,Z),Z}findAndMergeSmallLine(u,t,g){let f=0,T=u.matchAll(g),k=[];for(;;){let y=T.next();if(y.done)break;let Z=y.value[0],L=y.value.index,I=0,S=[];for(let E=0;E<Z.length;E++)"L"==Z[E]?I=L+E:S.push(L+E);for(const E of S){for(const H of t[E].textObjs)this.addTxtToLine(t[I],H);t[I].top=void 0,t[I].bottom=void 0,k.push(E)}f++}k.sort((y,Z)=>y<Z?1:-1);for(const y of k)t.splice(y,1);return f}newLine(u,t){let g={strLine:"",transform:[],textObjs:[],pageIndex:t,width:0,height:0,txtLength:0};return g.transform[4]=u.transform[4],g.transform[5]=u.transform[5],g.height=u.height,g.width=u.width,g.txtLength=u.str.length,g.textObjs.push(u),g}addTxtToLine(u,t){t.transform[4]<u.transform[4]&&(u.transform[4]=t.transform[4]),t.transform[5]<u.transform[5]&&(u.transform[5]=t.transform[5]),t.transform[5]+t.height>u.transform[5]+u.height&&(u.height=t.transform[5]+t.height-u.transform[5]),t.transform[4]+t.width>u.transform[4]+u.width&&(u.width=t.transform[4]+t.width-u.transform[4]),u.txtLength+=t.str.length,u.textObjs.push(t);let g=u.transform[4]+u.width,f=u.height;for(const T of u.textObjs)T.transform[4]+T.width>g&&(g=T.transform[4]+T.width),T.transform[5]+T.height>u.transform[5]+f&&(f=T.transform[5]+T.height-u.transform[5]);u.width=g-u.transform[4],u.height=f}static transform(u,t){return pdfjsLib.Util.transform(u,t)}render(u,t,g,f){for(var T,y=u.length,Z=0;Z<y;Z++){var L=document.createElement("div");L.className="pdf-page",L.id="page-"+Z,null===(T=document.getElementById(t))||void 0===T||T.appendChild(L),this.renderPage(u[Z],g,f)}}calculateSize(u){if(0==u.textObjs.length)return;u.textObjs.sort((S,E)=>1e6*Math.floor(S.transform[4])+S.transform[5]>1e6*Math.floor(E.transform[4])+E.transform[5]?1:-1),u.strLine="";let t=0,g=0,f=0,T=0,k=9999,y=0,Z=9999;for(const S of u.textObjs){let E=O.CanvasUtil.isObjIntersec(u.textObjs[0],S);f=S.transform[4];let H=f-g>h.CONST.SPLIT_MARGIN&&""!=S.str.trim()||T!=S.transform[5]?"|":"";u.strLine+=H+S.str,f<Z&&(Z=f);let G=S.transform[4]+S.width;E&&(g=G),G>t&&E&&(t=G),E&&(T=S.transform[5]),S.transform[5]<k&&(k=S.transform[5]),S.transform[5]+S.height>y&&(y=S.transform[5]+S.height)}u.transform[4]=Z,u.transform[5]=k,u.width=t-Z,u.height=y-k,u.transform[0]=k,u.transform[1]=y;let L=h.CONST.TVCN_CHAR,I=u.strLine;for(const S of L)I=I.replace(new RegExp(S[0],"g"),S[1]);u.strLine=I}renderPage(u,t,g){var f=u._pageIndex,T=u.getViewport({scale:t});let k=.8*T.width;var y=document.createElement("canvas"),Z=document.getElementById("page-"+f);null==Z||Z.appendChild(y),y.id="canvas"+f;var L=y.getContext("2d",{alpha:!1});y.height=T.height,y.width=T.width,y.style.height=T.height*k/T.width+"px",y.style.width=k+"px",Z&&(Z.style.width=y.style.width,Z.style.height=y.style.height);const E={canvasContext:L,transform:[1,0,0,1,0,0],viewport:T,annotationMode:pdfjsLib.AnnotationMode.ENABLE_FORMS,optionalContentConfigPromise:this.optionalContentConfigPromise,annotationCanvasMap:new Map,pageColors:{background:"Canvas",foreground:"CanvasText"}};u.render(E).promise.then(function(){g&&g(L,u._pageIndex,T)})}}Q.PdfRender=j},38761:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.Process=void 0;const O=b(1164),h=b(51535),j=b(30479),x=b(34283),u=b(18932),t=b(52311),g=b(11843),f=b(79391),T=b(449),k=b(35677),y=b(22676),Z=b(23076);Q.Process=class L{constructor(S){var E,H,G;let Y=JSON.parse(S);j.CONST.RENDER_SCALE=Y.RENDER_SCALE,j.CONST.LINE_SMALL_HEIGHT=Y.LINE_SMALL_HEIGHT*j.CONST.RENDER_SCALE,j.CONST.SPLIT_MARGIN=Y.SPLIT_MARGIN*j.CONST.RENDER_SCALE,j.CONST.INTERSEC_MARGIN=Y.INTERSEC_MARGIN*j.CONST.RENDER_SCALE,j.CONST.LINE_MAGIN=Y.LINE_MAGIN*j.CONST.RENDER_SCALE,j.CONST.MARGIN_LEFT=Y.MARGIN_LEFT*j.CONST.RENDER_SCALE,j.CONST.ENABLE_IMAGE_PROCESS=Y.ENABLE_IMAGE_PROCESS,j.CONST.STEP_SIZE=Y.STEP_SIZE,j.CONST.CROP_FULL_WIDTH=Y.CROP_FULL_WIDTH,j.CONST.OVERLAP=Y.OVERLAP,j.CONST.QUESTION_PATTERN=Y.QUESTION_PATTERN,j.CONST.QUESTION_PATTERN2=Y.QUESTION_PATTERN2,j.CONST.BREAK_LINE_PATTERN=Y.BREAK_LINE_PATTERN,j.CONST.SECTION_PATTERN_LOWER=Y.SECTION_PATTERN_LOWER,j.CONST.SECTION_PATTERN_NORMAL=Y.SECTION_PATTERN_NORMAL,j.CONST.KICK_PATTERN=Y.KICK_PATTERN,j.CONST.TVCN_CHAR=Y.TVCN_CHAR,j.CONST.HET_PATTERN=Y.HET_PATTERN,j.CONST.DAPAN_PATTERN=Y.DAPAN_PATTERN,j.CONST.HUONGDAN_PATTERN=Y.HUONGDAN_PATTERN,j.CONST.MULTIPLE_ANS_PATTERN=Y.MULTIPLE_ANS_PATTERN,j.CONST.DRAW_RESULT=Y.DRAW_RESULT,j.CONST.SKIP_CHAR=Y.SKIP_CHAR,j.CONST.FOOTER_PATTERN=null!==(E=Y.FOOTER_PATTERN)&&void 0!==E?E:["(trang\\s*\\d+)","(Page\\s*\\d+)","(Trang\\s*\\d+)","(TRANG\\s*\\d+)","(^\\d{1,4}$)"],j.CONST.HELP_ANS_PATTERN=null!==(H=Y.HELP_ANS_PATTERN)&&void 0!==H?H:["([\\s\\.]*Ch\u1ecdn\\s*([ABCDEFGH]))"],j.CONST.ANS_PATTERN=null!==(G=Y.ANS_PATTERN)&&void 0!==G?G:["([\\s\\|\\.]+[ABCDEFGHIJK][\\s\\|]*[\\.\\)])"]}setUpdateStatusCallback(S){this.updateStatusCallback=S}setOncompleteCallback(S){this.onCompleteCallback=S}parsePdf(S){let E=new T.PdfRender;E.loadPdf(S,H=>{const G=H.length;let Y=[],$=[],K=document.createElement("div");K.id="hiddenWrapper",K.style.width="1px",K.style.height="1px",K.style.overflow="hidden",K.style.opacity="0",K.style.zIndex="-9999",K.style.position="fixed",K.style.top="0",K.style.left="0",document.body.appendChild(K);let nt=document.createElement("div"),st="canvasWrapper";nt.id=st,K.appendChild(nt);const ft=(new Date).getTime();let ct=[];E.render(H,st,j.CONST.RENDER_SCALE,(_t,Ct,Dt)=>{if(null!=_t&&(Y[Ct]=_t,$[Ct]=Dt),ct.push(1),this.updateStatusCallback&&this.updateStatusCallback(`Rendering: ${ct.length}/${G}`),ct.length==G){const Tt=(new Date).getTime();this.updateStatusCallback&&this.updateStatusCallback("Render done: "+(Tt-ft)/1e3+" secs"),this.startAnalyze(Y,$,H)}})})}showHidden(){let S=document.getElementById("hiddenWrapper");S&&(S.style.opacity="1",S.style.width="",S.style.height="",S.style.overflow="",S.style.position="")}imgToTextObj(S,E){return{str:"img",fontName:E,width:S.paintWidth,height:S.paintHeight,transform:[-999,0,0,0,-S.left,-S.top-S.paintHeight]}}startAnalyze(S,E,H){const G=H.length;let Y=[],$=[],K=[],nt=[],st=new T.PdfRender;const ft=(new Date).getTime();for(let ct=0;ct<G;ct++){const _t=ct;let Ct=st.getImages(H[ct],_t);for(const Dt of Ct)nt.push(Dt);H[ct].getTextContent().then(Dt=>{var Tt;for(const wt of Ct)Dt.items.push(this.imgToTextObj(wt,Dt.items.length>0?Dt.items[0].fontName:""));var jt=st.getLines(Dt,_t,S[_t],E[_t]);if($=$.concat(jt),K[_t]=Dt.styles,Y.push(1),Y.length==G){$.sort((St,zt)=>1e7*St.pageIndex+(St.transform.length>0?St.transform[5]:0)-(1e7*zt.pageIndex+(zt.transform.length>0?zt.transform[5]:0))),st.findAndSplitQuestAnsLine($,K,S),""!=j.CONST.DRAW_RESULT&&console.log($);let wt=this.findEntityPos($,K,S,st.imageCache,0);console.log("lstPos",wt);let It=!1;for(const St of wt)if(St.type==k.QuestionParser.TYPE_NAME){It=!0;break}if(It||(wt=this.findEntityPos($,K,S,st.imageCache,1)),0==wt.length)return void(this.onCompleteCallback&&this.onCompleteCallback([],S));let Lt=wt[0].type==x.DapAnChiTietParser.TYPE_NAME,Mt=Lt?JSON.parse(wt[0].str):null,Ht=new Map,ce=new Map;if(Lt){for(const St of Mt.main)Ht.set(St.num,St.str);for(const St of Mt.sub)ce.set(St.num,St.str)}let $e=this.getQuestionInfo(wt,$,S,Ht);$e.forEach(St=>{if(!Ht.has(St.num)&&!ce.has(St.num)&&St.help&&St.help.text){let zt=u.DapAnParser.getAnsFromHelp(St.help.text);""!=zt&&ce.set(St.num,zt)}});for(const St of $e){if(!St.isGroup&&0==St.answers.length&&Ht.has(St.num)){let zt={pageIndex:St.remove.pageIndex,top:St.remove.top-1,left:St.remove.left-1,width:1,heigh:1};for(const Xt of["A","B","C","D"]){let ln={label:Xt,remove:zt,positions:[zt]};Ht.get(St.num)==Xt&&(ln.isCorrect=!0),St.answers.push(ln)}St.isFixAns=!0}if(!St.isGroup&&0==St.answers.length&&!Ht.has(St.num)&&ce.has(St.num)&&(St.strAns=ce.get(St.num)),!St.isGroup&&St.answers.length>0&&!Ht.has(St.num)&&ce.has(St.num))for(const zt of St.answers)zt.label==(null===(Tt=ce.get(St.num))||void 0===Tt?void 0:Tt.toUpperCase().substring(0,1))&&(zt.isCorrect=!0)}const Te=(new Date).getTime();this.updateStatusCallback&&this.updateStatusCallback("Analyze done: "+(Te-ft)/1e3+" secs"),this.showOnCanvas($e,wt,$,S,nt,j.CONST.DRAW_RESULT),this.onCompleteCallback&&this.onCompleteCallback($e,S)}})}}findEntityPos(S,E,H,G,Y){let $=[],st=!1;var ct=[{parser:new y.SectionParser,on:[],off:[]},{parser:new k.QuestionParser(Y),on:[3,4],off:[6]},{parser:new O.AnswerParser,on:[3,6],off:[]},{parser:new g.HetParser(!1),on:[6,8],off:[0,2]},{parser:new u.DapAnParser(!1),on:[6,8],off:[0,2,4]},{parser:new f.HuongDanParser,on:[],off:[8]},{parser:new x.DapAnChiTietParser(!1,wt=>{for(const It of wt)$.unshift(It)}),on:[],off:[2]},{parser:new t.FooterParser,on:[],off:[]},{parser:new Z.DapAnDienTuParser(!1,wt=>{if(0!=wt.length)if($.length>0&&$[0].type==x.DapAnChiTietParser.TYPE_NAME){let It=JSON.parse(wt[0].str),Lt=JSON.parse($[0].str);Lt.sub=It.sub,$[0].str=JSON.stringify(Lt)}else wt[0].type=x.DapAnChiTietParser.TYPE_NAME,$.unshift(wt[0])}),on:[],off:[2]}],_t=[8,0,1,2,3,4,5,6,7],Ct=null;let Dt=0,Tt="";for(const wt of S){(Dt==S.length-1||wt.pageIndex<S[Dt+1].pageIndex)&&(wt.isLastLine=!0);for(const It of _t){let Lt=ct[It];var jt=Lt.parser.process($,wt,Dt,Ct,E[wt.pageIndex],H[wt.pageIndex]);if(jt.length>0){for(const Mt of jt){if(Mt.type!=O.AnswerParser.TYPE_NAME&&Mt.type!=t.FooterParser.TYPE_NAME&&(Tt=""),Mt.type==O.AnswerParser.TYPE_NAME){if(!"ABCDEFGH".startsWith(Tt+Mt.str))continue;Tt+=Mt.str;for(let Ht=$.length-1;Ht>=0&&$[Ht].type==y.SectionParser.TYPE_NAME;Ht--)$.splice(Ht,1)}Mt.type==t.FooterParser.TYPE_NAME&&(wt.isFooter=!0),Mt.type==u.DapAnParser.TYPE_NAME&&(st=!0),Mt.type==f.HuongDanParser.TYPE_NAME&&st&&ct[5].parser.off(),$.push(Mt)}for(const Mt of Lt.on)ct[Mt].parser.on();for(const Mt of Lt.off)ct[Mt].parser.off();break}}Ct=wt,Dt++}for(const wt of ct)wt.parser.off();return $.forEach(wt=>{if(!S[wt.lineIndex].top){let Lt=h.CanvasUtil.getTopLine(G[wt.pageIndex],wt.lineIndex,S);S[wt.lineIndex].top=Lt[0],1!=wt.isIntersec&&(wt.isIntersec=Lt[1])}}),$.forEach(wt=>{if(!S[wt.lineIndex].bottom){let Lt=h.CanvasUtil.getBottomLine(G[wt.pageIndex],wt.lineIndex,S);S[wt.lineIndex].bottom=Lt[0],1!=wt.isIntersec&&(wt.isIntersec=Lt[0])}}),$}showOnCanvas(S,E,H,G,Y,$){const K=(new Date).getTime(),nt=new Map([["A","rgba(18, 0, 255, 0.4)"],["B","rgba(0, 158, 34, 0.4)"],["C","rgba(50, 50, 50, 0.4)"],["D","rgba(132, 0, 137, 0.4)"],["E","rgba(132, 0, 137, 0.4)"],["F","rgba(132, 0, 137, 0.4)"],["G","rgba(132, 0, 137, 0.4)"],["H","rgba(132, 0, 137, 0.4)"]]),st=new Map([[k.QuestionParser.TYPE_NAME,"red"],[O.AnswerParser.TYPE_NAME,"blue"],[g.HetParser.TYPE_NAME,"gray"],[x.DapAnChiTietParser.TYPE_NAME,"green"],[u.DapAnParser.TYPE_NAME,"orange"],[f.HuongDanParser.TYPE_NAME,"pink"],[t.FooterParser.TYPE_NAME,"yellow"],[y.SectionParser.TYPE_NAME,"black"]]);if($.indexOf("quest")>=0)for(const ct of S){for(const _t of ct.positions)h.CanvasUtil.drawBox(G[_t.pageIndex],ct.isGroup?"black":"red",_t);h.CanvasUtil.drawBox(G[ct.remove.pageIndex],"yellow",ct.remove);for(const _t of ct.answers){for(const Ct of _t.positions)h.CanvasUtil.drawBox(G[Ct.pageIndex],nt.get(_t.label)+"",Ct,!0);h.CanvasUtil.drawBox(G[_t.remove.pageIndex],"yellow",_t.remove),_t.isCorrect&&h.CanvasUtil.drawPoint(G[_t.positions[0].pageIndex],"green",_t.positions[0])}if(ct.help){for(const _t of ct.help.positions)h.CanvasUtil.drawBox(G[_t.pageIndex],"orange",_t);ct.help.remove&&h.CanvasUtil.drawBox(G[ct.help.remove.pageIndex],"yellow",ct.help.remove)}}if($.indexOf("line")>=0)for(const ct of H)h.CanvasUtil.drawBox2(G[ct.pageIndex],ct.height<j.CONST.LINE_SMALL_HEIGHT?"red":"rgba(50, 58, 168, 0.4)",ct.width,ct.height,ct.transform);if($.indexOf("txt")>=0)for(const ct of H)for(const _t of ct.textObjs)""!=_t.str.trim()&&h.CanvasUtil.drawBox2(G[ct.pageIndex],ct.height<j.CONST.LINE_SMALL_HEIGHT?"red":"rgba(132, 0, 137, 0.2)",_t.width,_t.height,_t.transform);if($.indexOf("img")>=0)for(const ct of Y)h.CanvasUtil.drawBox2(G[ct.pageIndex],"green",ct.paintWidth,ct.paintHeight,[0,0,0,0,-ct.left,-ct.top-ct.paintHeight]);if($.indexOf("pos")>=0)for(const ct of E){let _t={top:ct.transform[5],left:ct.transform[4],width:0,heigh:0,pageIndex:ct.pageIndex};h.CanvasUtil.drawPoint(G[ct.pageIndex],st.get(ct.type)+"",_t)}const ft=(new Date).getTime();this.updateStatusCallback&&this.updateStatusCallback("Draw done: "+(ft-K)/1e3+" secs")}getQuestionInfo(S,E,H,G){if(0==S.length)return[];let Y=0,$=[],K=new Map,nt="",st=!1,ft=!1,ct=0;S.forEach((_t,Ct)=>{Ct>0&&null==S[Ct-1].text&&(S[Ct-1].text=E.slice(S[Ct-1].lineIndex,_t.lineIndex)),Ct==S.length-1&&(S[Ct].text=E.slice(S[Ct].lineIndex,E.length))}),S.forEach(_t=>{let Ct=":"+_t.type;!st&&(_t.type==g.HetParser.TYPE_NAME||_t.type==u.DapAnParser.TYPE_NAME)&&(st=!0);let Dt=null;for(let jt=Y+1;jt<S.length;jt++)if((_t.type!=k.QuestionParser.TYPE_NAME||S[jt].type!=O.AnswerParser.TYPE_NAME)&&S[jt].type!=t.FooterParser.TYPE_NAME){Dt=S[jt];break}let Tt=H[_t.pageIndex].canvas.height-20;if(!st&&_t.type==y.SectionParser.TYPE_NAME&&(ct++,$.push({num:ct,answers:[],remove:y.SectionParser.getRemoveBox(_t,E),positions:y.SectionParser.getBoxes(_t,E,Dt,Tt),isGroup:!0,text:_t.text})),!st&&_t.type==k.QuestionParser.TYPE_NAME&&$.push({num:+_t.str,answers:[],remove:k.QuestionParser.getRemoveBox(_t,E),positions:k.QuestionParser.getBoxes(_t,E,Dt,Tt),group:ct,text:_t.text}),!st&&_t.type==O.AnswerParser.TYPE_NAME&&$.length>0){let jt=$[$.length-1].num,wt={label:_t.str,remove:O.AnswerParser.getRemoveBox(_t,E),positions:O.AnswerParser.getBoxes(_t,E,Dt,Tt)};G.size>0&&G.get(jt)==wt.label&&(wt.isCorrect=!0),$[$.length-1].answers.push(wt);let It=E[_t.lineIndex].strLine.replace(/\|/g,"").trim().match(j.CONST.MULTIPLE_ANS_PATTERN.join("|"));null!=It&&It.length>0&&($[$.length-1].isFixAns=!0),1==_t.isIntersec&&($[$.length-1].isFixAns=!0)}if(!ft&&_t.type==f.HuongDanParser.TYPE_NAME&&1==$.length&&nt.endsWith(`:${k.QuestionParser.TYPE_NAME}:${O.AnswerParser.TYPE_NAME}`)&&(ft=!0),_t.type==f.HuongDanParser.TYPE_NAME&&ft){let jt=$[$.length-1].num;K.set(jt,{num:jt,positions:f.HuongDanParser.getBoxes(_t,E,Dt,Tt),text:_t.text})}if(_t.type==f.HuongDanParser.TYPE_NAME&&!ft&&(K.clear(),st=!0),st&&_t.type==k.QuestionParser.TYPE_NAME){let jt=+_t.str;K.get(jt)||K.set(jt,{num:jt,positions:k.QuestionParser.getBoxes(_t,E,Dt,Tt),remove:k.QuestionParser.getRemoveBox(_t,E),text:_t.text})}!nt.endsWith(Ct)&&_t.type!=t.FooterParser.TYPE_NAME&&(nt+=Ct),Y++});for(const _t of $)_t.isGroup||(_t.help=K.get(_t.num),1==_t.answers.length&&(_t.answers=[]));return $}}},35677:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.QuestionParser=void 0;const O=b(51535),h=b(30479),j=b(71789);class x extends j.Parser{constructor(t){super(),this.TYPE=x.TYPE_NAME,this.questType=t}parse(t,g,f,T,k,y){var Z=this.matchPos(g.strLine);if(Z.value){let L=null;for(let G=Z.value.length-1;G>=0;G--)if(Z.value[G]){L=Z.value[G];break}if(null==L)return[];let S=L.matchAll(/\d+/g).next(),E=L.length;!S.done&&!L.trim().endsWith(".")&&!L.trim().endsWith(":")&&(E=S.value.index+S.value[0].length);let H=g.strLine.replace(/\|/g,"").toLowerCase().indexOf(L)+E-1;return[{str:this.getNumberFromStr(L),pageIndex:g.pageIndex,lineIndex:f,transform:g.transform,startLeft:O.CanvasUtil.calIndexPos2(g.textObjs,k,y,H,!0),type:this.TYPE}]}return[]}matchPos(t){let g=t.replace(/\|/g,"").toLowerCase().trim();if(0==this.questType){let f=h.CONST.QUESTION_PATTERN.join("|");return g.matchAll(f).next()}{let f=h.CONST.QUESTION_PATTERN2.join("|");return g.matchAll(f).next()}}getNumberFromStr(t){var g=t.match(/(\d+)/);return g?g[0]:""}static getRemoveBox(t,g){let f=t.startLeft?t.startLeft[5]:g[t.lineIndex].top,T=t.transform[4]-h.CONST.MARGIN_LEFT,k=t.startLeft?t.startLeft[5]+t.startLeft[3]:g[t.lineIndex].bottom;return{pageIndex:t.pageIndex,top:f||20,left:T,heigh:k&&f?k-f:0,width:(t.startLeft?t.startLeft[4]:0)-T}}static getBoxes(t,g,f,T){let k=T;for(let $=t.lineIndex;$<g.length;$++)if(O.CanvasUtil.isLastLineOfPage($,g)){let K=g[$].isFooter?g[$-1]:g[$];k=K.transform[5]+K.height+20;break}let y=[],Z=t.pageIndex,L=f?f.lineIndex:g.length-1,I=g[t.lineIndex].transform[4]-h.CONST.MARGIN_LEFT,S=g[t.lineIndex].top;if(!S)return[];let E=h.CONST.CROP_FULL_WIDTH?O.CanvasUtil.getMaxLineRight(-1,g)+2*h.CONST.MARGIN_LEFT:g[t.lineIndex].transform[4]+g[t.lineIndex].width+2*h.CONST.MARGIN_LEFT,H=k,G=Z,Y=t.lineIndex+1;for(;Y<=L;Y++){let $=g[Y].top;if(Y==g.length-1&&!f&&($=g[Y].bottom),!h.CONST.CROP_FULL_WIDTH){let nt=g[Y-1].transform[4]+g[Y-1].width+2*h.CONST.MARGIN_LEFT;nt>E&&(E=nt)}let K=g[Y-1].transform[4]-h.CONST.MARGIN_LEFT;K<I&&(I=K),g[Y].isFooter&&$?H=$:(g[Y].pageIndex>G&&(g[Y-1].isFooter||(H=k),y.push({pageIndex:G,top:S,left:I,width:E-I,heigh:H-S}),S=20,I=O.CanvasUtil.getMinLineLeft(g[Y].pageIndex,g)-h.CONST.MARGIN_LEFT),G=g[Y].pageIndex,$&&(H=$))}if(Y-=1,!f&&O.CanvasUtil.isLastLineOfPage(Y,g)){let $=g[Y].isFooter?g[Y-1]:g[Y];H=$.transform[5]+$.height+20}return O.CanvasUtil.isFirstLineOfPage(Y,g)||y.push({pageIndex:G,top:S,left:I,width:E-I,heigh:H-S}),y}}Q.QuestionParser=x,x.TYPE_NAME="question"},22676:(it,Q,b)=>{Object.defineProperty(Q,"__esModule",{value:!0}),Q.SectionParser=void 0;const O=b(51535),h=b(30479),j=b(71789),x=b(35677);class u extends j.Parser{constructor(){super(),this.TYPE=u.TYPE_NAME}parse(g,f,T,k,y,Z){let L=f.strLine.replace(/\|/g,"").toLowerCase().trim().match(h.CONST.SECTION_PATTERN_LOWER.join("|")),I=null!=L&&L.length>0;if(I||(L=f.strLine.replace(/\|/g,"").trim().match(h.CONST.SECTION_PATTERN_NORMAL.join("|")),I=null!=L&&L.length>0),I&&L){let S=f.strLine.indexOf(L[0])+L[0].length+1,E=[L[0][0]];for(let H=g.length-1;H>=0;H--){if(g[H].type==x.QuestionParser.TYPE_NAME){E.push(".Q");break}E.push(g[H].str[0])}return"HGFEDCBA.Q".endsWith(E.join(""))?[]:[{str:L[0],pageIndex:f.pageIndex,lineIndex:T,transform:f.transform,startLeft:O.CanvasUtil.calIndexPos(f.textObjs,y,Z,S,!0),type:this.TYPE}]}return[]}static getRemoveBox(g,f){let T=f[g.lineIndex].top,k=g.transform[4]-h.CONST.MARGIN_LEFT,y=f[g.lineIndex].bottom;return{pageIndex:g.pageIndex,top:T||20,left:k,heigh:y&&T?y-T:0,width:k-k}}static getBoxes(g,f,T,k){const y=k;let Z=[],L=g.pageIndex,I=T?T.lineIndex:f.length-1,S=O.CanvasUtil.getMinLineLeft(-1,f)-h.CONST.MARGIN_LEFT,E=f[g.lineIndex].top;if(!E)return[];let H=O.CanvasUtil.getMaxLineRight(-1,f)+2*h.CONST.MARGIN_LEFT,G=y,Y=L,$=g.lineIndex+1;for(;$<=I;$++){let K=f[$].top;if(f[$].isFooter&&K)G=K;else if(f[$].pageIndex>Y&&(Z.push({pageIndex:Y,top:E,left:S,width:H-S,heigh:G-E}),E=20),Y=f[$].pageIndex,K){G=K;break}}return $>=f.length&&($=f.length-1),O.CanvasUtil.isFirstLineOfPage($,f)||Z.push({pageIndex:Y,top:E,left:S,width:H-S,heigh:G-E}),Z}}Q.SectionParser=u,u.TYPE_NAME="section"},39087:function(it,Q,b){var O=this&&this.__createBinding||(Object.create?function(j,x,u,t){void 0===t&&(t=u),Object.defineProperty(j,t,{enumerable:!0,get:function(){return x[u]}})}:function(j,x,u,t){void 0===t&&(t=u),j[t]=x[u]}),h=this&&this.__exportStar||function(j,x){for(var u in j)"default"!==u&&!Object.prototype.hasOwnProperty.call(x,u)&&O(x,j,u)};Object.defineProperty(Q,"__esModule",{value:!0}),h(b(38761),Q)},55372:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>QuestHeaderComponent});var _angular_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5e3),src_app_core_supers_mybase_component__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(55330),src_app_helpers_common_FileManagers__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(51442),src_app_core_services_common_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(35018),src_app_core_services_cdn_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(15043);const _c0=["markInput"],_c1=["inpAudioUpload"];function QuestHeaderComponent_div_3_common_tooltip_9_Template(it,Q){1&it&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"common-tooltip")(1,"em")(2,"mark"),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(3,"Ctr + Enter"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(4),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(5,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()),2&it&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(4),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(5,1,"lang_auto_de_tu_dong_nhap_diem_cho_cac_cau_con_lai_trong_nhom_bang_dot")," "))}const _c2=function(it){return{hide:it}};function QuestHeaderComponent_div_3_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"div",25)(1,"div",26)(2,"span",27),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(h.showMarkInput())}),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(3),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(4,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(5,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(6,"div",28)(7,"input",29,30),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("keyup",function(h){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const j=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(j.checkKeyup(h))})("focus",function(){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(h.enableTooltip())})("focusout",function(){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(h.disableTooltip())})("ngModelChange",function(h){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const j=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(j.q.point=h)}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(9,QuestHeaderComponent_div_3_common_tooltip_9_Template,6,3,"common-tooltip",17),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(10,"div"),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(11),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(12,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()()()}if(2&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();let O;_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngClass",_angular_core__WEBPACK_IMPORTED_MODULE_4__.VKq(13,_c2,b.showPointInput)),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",b.q.point&&+b.q.point>0?b.q.point+" "+_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(4,7,"lang_auto_diem"):_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(5,9,"lang_auto_nhap_diem")," "),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngClass",_angular_core__WEBPACK_IMPORTED_MODULE_4__.VKq(15,_c2,!b.showPointInput)),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("size",(null==b.q.point||null==(O=b.q.point.toString())?null:O.length)||2)("ngModel",b.q.point),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",b.isTooltipPoint),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(12,11,"lang_auto_diem")," ")}}function QuestHeaderComponent_div_4_div_1_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"div",36),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b),_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();const h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.MAs(4);return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(h.click())}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.O4$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(1,"svg",37),_angular_core__WEBPACK_IMPORTED_MODULE_4__._UZ(2,"path",38),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(3," Audio "),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()}}function QuestHeaderComponent_div_4_div_2_span_4_Template(it,Q){if(1&it&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"span",45),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()),2&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw(3);_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Oqu(b.audioName)}}function QuestHeaderComponent_div_4_div_2_span_5_Template(it,Q){if(1&it&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()),2&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw(3);_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Oqu(b.audioName)}}function QuestHeaderComponent_div_4_div_2_mat_icon_6_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"mat-icon",46),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw(3);return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(h.loadAudio())}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(1,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(2,"cached"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()}2&it&&_angular_core__WEBPACK_IMPORTED_MODULE_4__.s9C("matTooltip",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(1,1,"lang_auto_tai_lai_audio"))}function QuestHeaderComponent_div_4_div_2_mat_icon_7_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"mat-icon",47),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw(3);return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(h.stopAudio())}),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(1,"pause "),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()}}function QuestHeaderComponent_div_4_div_2_mat_icon_8_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"mat-icon",47),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw(3);return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(h.playAudio())}),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(1," play_circle"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()}}function QuestHeaderComponent_div_4_div_2_i_9_Template(it,Q){1&it&&_angular_core__WEBPACK_IMPORTED_MODULE_4__._UZ(0,"i",48)}function QuestHeaderComponent_div_4_div_2_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"div",6)(1,"span",39)(2,"span",40),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw(2);return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(h.removeAudio())}),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(3,"[X]"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(4,QuestHeaderComponent_div_4_div_2_span_4_Template,2,1,"span",41),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(5,QuestHeaderComponent_div_4_div_2_span_5_Template,2,1,"span",17),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(6,QuestHeaderComponent_div_4_div_2_mat_icon_6_Template,3,3,"mat-icon",42),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(7,QuestHeaderComponent_div_4_div_2_mat_icon_7_Template,2,0,"mat-icon",43),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(8,QuestHeaderComponent_div_4_div_2_mat_icon_8_Template,2,0,"mat-icon",43),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(9,QuestHeaderComponent_div_4_div_2_i_9_Template,1,0,"i",44),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()}if(2&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw(2);_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("matTooltip",b.audioName),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",b.isLoadFalseAudio),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",!b.isLoadFalseAudio),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",b.isLoadFalseAudio),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",!b.isLoadFalseAudio&&b.isLoadedAudio&&b.isPlayingAudio),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",!b.isLoadFalseAudio&&b.isLoadedAudio&&!b.isPlayingAudio),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",!b.isLoadedAudio)}}function QuestHeaderComponent_div_4_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"div",31),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(1,QuestHeaderComponent_div_4_div_1_Template,4,0,"div",32),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(2,QuestHeaderComponent_div_4_div_2_Template,10,7,"div",33),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(3,"input",34,35),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("input",function(h){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const j=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(j.selectFileAudio(h))}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()}if(2&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",!b.isHasAudio),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",b.isHasAudio)}}function QuestHeaderComponent_div_5_Template(it,Q){if(1&it&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"div",5)(1,"div",6)(2,"mat-select",49)(3,"mat-option",50),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(4),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(5,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(6,"mat-option",50),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(7),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(8,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(9,"mat-option",50),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(10),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(11,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()()()),2&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngModel",b.q.type)("disabled",!0),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("value",3),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(5,8,"lang_testbank_create_exam_width_file_docx_essay")," "),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("value",1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(8,10,"lang_auto_trac_nghiem")," "),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("value",4),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(11,12,"lang_auto_dien_tu")," ")}}function QuestHeaderComponent_div_6_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"div",5)(1,"div",6)(2,"mat-chip-list")(3,"mat-chip",51),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("removed",function(){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(h.setTag())}),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(4),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(5,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(6,"button",52)(7,"mat-icon",53),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(8,"cancel"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()()()()()}if(2&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw(),O=_angular_core__WEBPACK_IMPORTED_MODULE_4__.MAs(34);_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("matMenuTriggerFor",O),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(5,2,"azt_lang_tag_"+b.q.tag[0].code)," ")}}function QuestHeaderComponent_button_9_Template(it,Q){if(1&it&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"button",54),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(1,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.O4$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(2,"svg",10),_angular_core__WEBPACK_IMPORTED_MODULE_4__._UZ(3,"path",55)(4,"path",56),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()),2&it){_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.MAs(34);_angular_core__WEBPACK_IMPORTED_MODULE_4__.s9C("matTooltip",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(1,2,"lang_auto_gan_nhan_muc_do_nhan_biet")),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("matMenuTriggerFor",b)}}function QuestHeaderComponent_button_10_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"button",57),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(h.changeQuest())}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(1,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.O4$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(2,"svg",10),_angular_core__WEBPACK_IMPORTED_MODULE_4__._UZ(3,"path",58)(4,"path",59)(5,"path",60)(6,"path",61),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()}2&it&&_angular_core__WEBPACK_IMPORTED_MODULE_4__.s9C("matTooltip",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(1,1,"lang_auto_doi_cau_khac"))}function QuestHeaderComponent_li_20_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"li")(1,"a",62),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(h.setFixAns())}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.O4$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(2,"svg",19),_angular_core__WEBPACK_IMPORTED_MODULE_4__._UZ(3,"line",63)(4,"path",64),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.kcU(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(5,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(6),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(7,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(8,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(9,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()()}if(2&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(6),_angular_core__WEBPACK_IMPORTED_MODULE_4__.AsE("",b.q.quest.isFixAns?_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(7,2,"lang_auto_bo_co_dinh"):_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(8,4,"lang_auto_co_dinh")," ",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(9,6,"lang_auto_dap_an"),"")}}function QuestHeaderComponent_li_21_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"li")(1,"a",62),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(h){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const j=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(j.copyContent(h))}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.O4$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(2,"svg",65),_angular_core__WEBPACK_IMPORTED_MODULE_4__._UZ(3,"rect",66)(4,"path",67),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.kcU(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(5,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(6),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(7,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()()}2&it&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(6),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(7,1,"lang_auto_copy_noi_dung")," "))}function QuestHeaderComponent_li_22_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"li")(1,"a",62),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(h){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const j=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(j.cut(h))}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.O4$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(2,"svg",65),_angular_core__WEBPACK_IMPORTED_MODULE_4__._UZ(3,"circle",68)(4,"circle",69)(5,"line",70)(6,"line",71)(7,"line",72),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.kcU(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(8,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(9),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(10,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()()}2&it&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(9),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(10,1,"lang_auto_cat")," "))}function QuestHeaderComponent_li_23_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"li")(1,"a",62),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(h){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const j=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(j.del(h))}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.O4$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(2,"svg",65),_angular_core__WEBPACK_IMPORTED_MODULE_4__._UZ(3,"path",73)(4,"path",74)(5,"path",75),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.kcU(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(6,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(7),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(8,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()()}2&it&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(7),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(8,1,"lang_auto_xoa")," "))}function QuestHeaderComponent_li_37_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"li")(1,"a",62),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(){const j=_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b).$implicit,x=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(x.setTag(j))}),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()}if(2&it){const b=Q.$implicit,O=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();let h;_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",null!==(h=b[O.commonService.getCurrentLang()+"Name"])&&void 0!==h?h:b.enName," ")}}function QuestHeaderComponent_li_38_Template(it,Q){1&it&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"li"),_angular_core__WEBPACK_IMPORTED_MODULE_4__._UZ(1,"hr",76),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA())}function QuestHeaderComponent_li_39_Template(it,Q){if(1&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"li")(1,"button",77),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_4__.CHM(b);const h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();let j;return _angular_core__WEBPACK_IMPORTED_MODULE_4__.KtG(h.applyTagAll(null!==(j=h.q.tag)&&void 0!==j?j:[]))}),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(3,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()}if(2&it){const b=_angular_core__WEBPACK_IMPORTED_MODULE_4__.oxw();_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("disabled",!b.q.tag),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(3,2,"lang_auto_ap_dung_cho_cac_cau_con_lai")," ")}}let QuestHeaderComponent=(()=>{class QuestHeaderComponent extends src_app_core_supers_mybase_component__WEBPACK_IMPORTED_MODULE_0__.Q{constructor(it,Q){super(it),this.commonService=it,this.cdnService=Q,this.notOnlyQuestEdit=!0,this.showType=!0,this.questionTags=[],this.onLabelClick=new _angular_core__WEBPACK_IMPORTED_MODULE_4__.vpe,this.onHotKeyPointSync=new _angular_core__WEBPACK_IMPORTED_MODULE_4__.vpe,this.onApplyAllTag=new _angular_core__WEBPACK_IMPORTED_MODULE_4__.vpe,this.onError=new _angular_core__WEBPACK_IMPORTED_MODULE_4__.vpe,this.onCopy=new _angular_core__WEBPACK_IMPORTED_MODULE_4__.vpe,this.onCut=new _angular_core__WEBPACK_IMPORTED_MODULE_4__.vpe,this.onDel=new _angular_core__WEBPACK_IMPORTED_MODULE_4__.vpe,this.onChangeQuest=new _angular_core__WEBPACK_IMPORTED_MODULE_4__.vpe,this.onExtraInfo=new _angular_core__WEBPACK_IMPORTED_MODULE_4__.vpe,this.isHasAudio=!1,this.isLoadedAudio=!1,this.isLoadFalseAudio=!1,this.audioName="",this.audioMime="",this.audioUrl="",this.isTooltipPoint=!1,this.isPlayingAudio=!1,this.showPointInput=!1,this.isMobile=!1,this.q={label:"",quest:{label:0,answers:[],parts:[]},answers:[],renderedStr:""}}ngOnInit(){super.ngOnInit(),this.isMobile=this.commonService.isMobileOrTable();let it=this.commonService.willDeleteParseJson(this.q.attachments||"[]");this.q.audio?(this.isHasAudio=!0,this.audioName=this.q.audio.name,this.isLoadedAudio=!0,this.isLoadFalseAudio=!1):it.forEach(Q=>{(0,src_app_helpers_common_FileManagers__WEBPACK_IMPORTED_MODULE_1__.F0)(Q.mimes||"")&&(this.isHasAudio=!0,this.audioUrl=Q.url||"",this.audioName=Q.name||"",this.audioMime=Q.mimes||""),this.audioUrl&&this.loadAudio()})}loadAudio(){this.isLoadedAudio=!1,fetch(this.cdnService.getRawCdnLink(this.audioUrl)).then(it=>{if(!it.ok)throw new Error("Something went wrong");it.blob().then(Q=>{this.q.audio=new File([Q],this.audioName,{type:this.audioMime}),this.isLoadedAudio=!0,this.isLoadFalseAudio=!1})}).catch(()=>{this.isLoadedAudio=!0,this.isLoadFalseAudio=!0;let it=this.commonService.myTranslateIntance("lang_auto_khong_the_tai_tep_audio_cho"),Q=this.commonService.myTranslateIntance("lang_auto_vui_long_thu_lai");this.showErrorSnack(`${it} ${this.q.label} ${Q}`)})}ngOnDestroy(){super.ngOnDestroy(),this.stopAudio()}changeQuest(){this.onChangeQuest.emit(this.q)}removeAudio(){this.q.attachments=void 0,this.stopAudio(),this.q.audio=void 0,this.isHasAudio=!1,this.inpAudioUpload&&(this.inpAudioUpload.nativeElement.value=null)}selectFileAudio(it){var Q,b;(0,src_app_helpers_common_FileManagers__WEBPACK_IMPORTED_MODULE_1__.F0)(it.target.files[0].type)?(this.stopAudio(),this.q.audio=it.target.files[0],this.audioName=null!==(b=null===(Q=this.q.audio)||void 0===Q?void 0:Q.name)&&void 0!==b?b:"",this.isLoadedAudio=!0,this.isLoadFalseAudio=!1,this.isHasAudio=!0,this.onExtraInfo.emit({q:this.q,type:"audio",data:this.q.audio})):this.showErrorSnack("lang_auto_file_dinh_kem_phai_la_mot_audio")}showMarkInput(){this.showPointInput=!0,setTimeout(()=>{var it;null===(it=this.markInput)||void 0===it||it.nativeElement.focus()},50)}enableTooltip(){this.isTooltipPoint=!0}disableTooltip(){this.showPointInput&&this.onExtraInfo.emit({q:this.q,type:"point",data:this.q.point}),this.isTooltipPoint=!1,this.showPointInput=!1}setFixAns(){this.q.quest.isFixAns=!this.q.quest.isFixAns,this.onExtraInfo.emit({q:this.q,type:"fix",data:this.q.quest.isFixAns})}setTag(it){this.q.tag=it?[it]:[],this.onExtraInfo.emit({q:this.q,type:"tag",data:this.q.tag})}applyTagAll(it){this.onApplyAllTag.emit(it)}copyContent(it){this.onCopy.emit(this.q)}cut(it){this.onCut.emit(this.q)}del(it){this.onDel.emit(this.q)}getTagName(it){return it.toUpperCase().split(" ").map(Q=>{var b;return null!==(b=Q[0])&&void 0!==b?b:""}).join("")}checkKeyup(ev){var _a;if("Enter"==ev.code){let v=null===(_a=this.markInput)||void 0===_a?void 0:_a.nativeElement.value;if(!/^[\d\.\+\-\*\/\s\(\)]+$/.test(v)){let it=this.commonService.myTranslateIntance("lang_auto_du_lieu_diem_ban_nhap_khong_hop_le_dot");return void this.onError.emit(it)}if(v=eval(v),this.q.point=Math.round(100*v)/100,ev.ctrlKey)this.isTooltipPoint=!1,this.showPointInput=!1,this.onHotKeyPointSync.emit(this.q.point);else{window.focus();let it=document.activeElement;it&&it.blur()}}}isPlayAudio(){var it;return!(!window.playMedia||window.playMedia.id!==(null===(it=this.q)||void 0===it?void 0:it.quest.label)||!window.playMedia.played)}stopAudio(){window.playMedia&&(window.playMedia.pause(),window.playMedia=void 0,this.isPlayingAudio=!1)}playAudio(){var it;window.playMedia&&window.playMedia.pause(),this.q.audio&&(window.playMedia=new Audio(URL.createObjectURL(this.q.audio)),window.playMedia.id=null===(it=this.q)||void 0===it?void 0:it.quest.label,window.playMedia.play(),this.isPlayingAudio=!0)}labelClick(){var it;this.onLabelClick.emit(null===(it=this.q)||void 0===it?void 0:it.quest.parts)}}return QuestHeaderComponent.\u0275fac=function it(Q){return new(Q||QuestHeaderComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_4__.Y36(src_app_core_services_common_service__WEBPACK_IMPORTED_MODULE_2__.v),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Y36(src_app_core_services_cdn_service__WEBPACK_IMPORTED_MODULE_3__.U))},QuestHeaderComponent.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_4__.Xpm({type:QuestHeaderComponent,selectors:[["app-quest-header"]],viewQuery:function it(Q,b){if(1&Q&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.Gf(_c0,5),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Gf(_c1,5)),2&Q){let O;_angular_core__WEBPACK_IMPORTED_MODULE_4__.iGM(O=_angular_core__WEBPACK_IMPORTED_MODULE_4__.CRH())&&(b.markInput=O.first),_angular_core__WEBPACK_IMPORTED_MODULE_4__.iGM(O=_angular_core__WEBPACK_IMPORTED_MODULE_4__.CRH())&&(b.inpAudioUpload=O.first)}},inputs:{q:"q",notOnlyQuestEdit:"notOnlyQuestEdit",showType:"showType",questionTags:"questionTags"},outputs:{onLabelClick:"onLabelClick",onHotKeyPointSync:"onHotKeyPointSync",onApplyAllTag:"onApplyAllTag",onError:"onError",onCopy:"onCopy",onCut:"onCut",onDel:"onDel",onChangeQuest:"onChangeQuest",onExtraInfo:"onExtraInfo"},features:[_angular_core__WEBPACK_IMPORTED_MODULE_4__.qOj],decls:40,vars:19,consts:[[1,"box-service-question"],[1,"box-service-question-name",3,"click"],["class","box-service-inp-point",4,"ngIf"],["class","box-service-attach-files cursor-pointer",4,"ngIf"],["class","box-service-type",4,"ngIf"],[1,"box-service-type"],[1,"first-text"],["mat-icon-button","",3,"matMenuTriggerFor","matTooltip",4,"ngIf"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","12","r","1"],["cx","12","cy","5","r","1"],["cx","12","cy","19","r","1"],["menu","matMenu"],[1,"dropdown-menu","show","relative","w-56"],[1,"dropdown-content"],[4,"ngIf"],["mat-menu-item","",1,"dropdown-item",3,"matMenuTriggerFor"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-5","lucide","mr-2"],["d","M9 5H2v7l6.29 6.29c.94.94 2.48.94 3.42 0l3.58-3.58c.94-.94.94-2.48 0-3.42L9 5Z"],["d","M6 9.01V9"],["d","m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19"],["tags","matMenu"],[4,"ngFor","ngForOf"],[1,"box-service-inp-point"],[1,"first-text","cursor-pointer"],[3,"ngClass","click"],[1,"inp-point",3,"ngClass"],[3,"size","ngModel","keyup","focus","focusout","ngModelChange"],["markInput",""],[1,"box-service-attach-files","cursor-pointer"],["class","first-text","style","white-space: nowrap;",3,"click",4,"ngIf"],["class","first-text",4,"ngIf"],["type","file","accept","audio/ogg;audio/mpeg;audio/wav",1,"hide",3,"input"],["inpAudioUpload",""],[1,"first-text",2,"white-space","nowrap",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","14","height","14","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48"],[1,"name-audio",3,"matTooltip"],[1,"delete",3,"click"],["style","\n            color: #9e9e9e;\n            text-decoration: line-through;",4,"ngIf"],[3,"matTooltip","click",4,"ngIf"],[3,"click",4,"ngIf"],["class","fa fa-spinner fa-spin",4,"ngIf"],[2,"color","#9e9e9e","text-decoration","line-through"],[3,"matTooltip","click"],[3,"click"],[1,"fa","fa-spinner","fa-spin"],[3,"ngModel","disabled"],[3,"value"],[1,"tag-chip",3,"matMenuTriggerFor","removed"],["matChipRemove",""],[2,"font-size","15px"],["mat-icon-button","",3,"matMenuTriggerFor","matTooltip"],["d","M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z"],["d","M7 7h.01"],["mat-icon-button","",3,"matTooltip","click"],["d","M21 2v6h-6"],["d","M3 12a9 9 0 0 1 15-6.7L21 8"],["d","M3 22v-6h6"],["d","M21 12a9 9 0 0 1-15 6.7L3 16"],[1,"dropdown-item",3,"click"],["x1","12","y1","17","x2","12","y2","22"],["d","M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide","mr-2"],["x","9","y","9","width","13","height","13","rx","2","ry","2"],["d","M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"],["cx","6","cy","6","r","3"],["cx","6","cy","18","r","3"],["x1","20","y1","4","x2","8.12","y2","15.88"],["x1","14.47","y1","14.48","x2","20","y2","20"],["x1","8.12","y1","8.12","x2","12","y2","12"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],[1,"dropdown-divider","border-slate-200","dark:border-darkmode-400"],[1,"dropdown-item","w-full",3,"disabled","click"]],template:function it(Q,b){if(1&Q&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(0,"div",0)(1,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.NdJ("click",function(){return b.labelClick()}),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(3,QuestHeaderComponent_div_3_Template,13,17,"div",2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(4,QuestHeaderComponent_div_4_Template,5,2,"div",3),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(5,QuestHeaderComponent_div_5_Template,12,14,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(6,QuestHeaderComponent_div_6_Template,9,4,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(7,"div",5)(8,"div",6),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(9,QuestHeaderComponent_button_9_Template,5,4,"button",7),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(10,QuestHeaderComponent_button_10_Template,7,3,"button",8),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(11,"button",9),_angular_core__WEBPACK_IMPORTED_MODULE_4__.O4$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(12,"svg",10),_angular_core__WEBPACK_IMPORTED_MODULE_4__._UZ(13,"circle",11)(14,"circle",12)(15,"circle",13),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.kcU(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(16,"mat-menu",null,14)(18,"div",15)(19,"ul",16),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(20,QuestHeaderComponent_li_20_Template,10,8,"li",17),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(21,QuestHeaderComponent_li_21_Template,8,3,"li",17),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(22,QuestHeaderComponent_li_22_Template,11,3,"li",17),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(23,QuestHeaderComponent_li_23_Template,9,3,"li",17),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(24,"li")(25,"a",18),_angular_core__WEBPACK_IMPORTED_MODULE_4__.O4$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(26,"svg",19),_angular_core__WEBPACK_IMPORTED_MODULE_4__._UZ(27,"path",20)(28,"path",21)(29,"path",22),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.kcU(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(30,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_4__._uU(31),_angular_core__WEBPACK_IMPORTED_MODULE_4__.ALo(32,"mytranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()()()()(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.TgZ(33,"mat-menu",null,23)(35,"div",15)(36,"ul",16),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(37,QuestHeaderComponent_li_37_Template,3,1,"li",24),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(38,QuestHeaderComponent_li_38_Template,2,0,"li",17),_angular_core__WEBPACK_IMPORTED_MODULE_4__.YNc(39,QuestHeaderComponent_li_39_Template,4,4,"li",17),_angular_core__WEBPACK_IMPORTED_MODULE_4__.qZA()()()()()()),2&Q){const O=_angular_core__WEBPACK_IMPORTED_MODULE_4__.MAs(17),h=_angular_core__WEBPACK_IMPORTED_MODULE_4__.MAs(34);_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Oqu(b.q.label),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",b.notOnlyQuestEdit),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",!b.isMobile),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",!b.isMobile&&b.showType),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",b.q.tag&&b.q.tag.length>0),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",!b.q.tag||0==b.q.tag.length),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",b.q.changeable),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("matMenuTriggerFor",O),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(9),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",1===b.q.type),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",b.notOnlyQuestEdit),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",b.notOnlyQuestEdit),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",b.notOnlyQuestEdit),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("matMenuTriggerFor",h),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(6),_angular_core__WEBPACK_IMPORTED_MODULE_4__.hij(" ",_angular_core__WEBPACK_IMPORTED_MODULE_4__.lcZ(32,17,"lang_auto_gan_nhan")," "),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(6),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngForOf",b.questionTags),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",b.notOnlyQuestEdit),_angular_core__WEBPACK_IMPORTED_MODULE_4__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Q6J("ngIf",b.notOnlyQuestEdit)}},styles:[".box-service-name[_ngcontent-%COMP%], .box-service-question-name[_ngcontent-%COMP%]{outline:1px solid #ccc;padding:3px 10px!important;border-radius:3px;font-weight:500}.box-service-question-name[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}.box-service-question[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap}.box-service-question[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{border-right:none}.box-service-question[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{border-right:none}.box-service-question[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding:0 10px;cursor:pointer;color:#2462ae;border-right:1px solid #ccc}.box-service-pin-ans[_ngcontent-%COMP%]{cursor:pointer;color:#2462ae}.first-text[_ngcontent-%COMP%]{display:flex;align-items:center}.first-text[_ngcontent-%COMP%]   marquee[_ngcontent-%COMP%]{width:100px}.first-text[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;margin:0;padding:0;width:100%;display:flex;justify-content:center;align-items:center}.selection[_ngcontent-%COMP%]{border:1.5px solid #2462ae;box-shadow:#00000073 0 25px 20px -20px}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.inp-point[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:space-between;align-items:center}.inp-point[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:center;padding:5px;border-radius:5px;outline:1px solid #ccc;border:none}.inp-point[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:1px solid #2262ae;box-shadow:#11111a0d 0 1px,#11111a1a 0 0 8px}.inp-point[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .inp-point[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.inp-point[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.inp-point[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{border-right:none;text-align:left;padding:0 0 0 10px}.hide[_ngcontent-%COMP%]{display:none!important}  .mat-form-field-underline{display:none}.delete[_ngcontent-%COMP%]{color:red}  .mat-select-arrow-wrapper{margin-left:5px}button.menu[_ngcontent-%COMP%]{text-transform:none!important}.tag-chip[_ngcontent-%COMP%]{min-height:20px;font-size:12px}.name-audio[_ngcontent-%COMP%]{max-width:100px;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:1;line-clamp:1}.name-audio[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]{padding-right:5px}.no-wrap[_ngcontent-%COMP%]{white-space:nowrap}"]}),QuestHeaderComponent})()},43761:(it,Q,b)=>{b.r(Q),b.d(Q,{TestbankModule:()=>AT});var O=b(69808),h=b(93075),j=b(48966),x=b(74202),u=b(91314),t=b(5e3),g=b(15664),f=b(24096),T=b(8929),k=b(87224),y=b(47429);const Z=["menu"],L=["li"];function I(o,s){}const S=function(o){return{$implicit:o}};function E(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",7),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw();return t.KtG(r.onMenuItemSelect(a,i))})("mouseenter",function(i){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw();return t.KtG(r.onOpenSubMenu(a,i))}),t.YNc(1,I,0,0,"ng-template",8),t.qZA()}if(2&o){const e=t.oxw().$implicit,n=t.oxw();t.ekj("dropdown-item",n.useBootstrap4)("active",e.isActive&&n.isMenuItemEnabled(e))("disabled",n.useBootstrap4&&!n.isMenuItemEnabled(e))("hasSubMenu",!!e.subMenu),t.xp6(1),t.Q6J("ngTemplateOutlet",e.template)("ngTemplateOutletContext",t.VKq(10,S,n.item))}}function H(o,s){}function G(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"span",9),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.stopEvent(i))})("contextmenu",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.stopEvent(i))}),t.YNc(1,H,0,0,"ng-template",8),t.qZA()}if(2&o){const e=t.oxw().$implicit,n=t.oxw();t.ekj("dropdown-item",n.useBootstrap4)("disabled",n.useBootstrap4&&!n.isMenuItemEnabled(e)),t.xp6(1),t.Q6J("ngTemplateOutlet",e.template)("ngTemplateOutletContext",t.VKq(6,S,n.item))}}function Y(o,s){if(1&o&&(t.TgZ(0,"li",null,4),t.YNc(2,E,2,12,"a",5),t.YNc(3,G,2,8,"span",6),t.qZA()),2&o){const e=s.$implicit,n=t.oxw();t.ekj("disabled",!n.isMenuItemEnabled(e))("divider",e.divider)("dropdown-divider",n.useBootstrap4&&e.divider)("active",e.isActive&&n.isMenuItemEnabled(e)),t.uIk("role",e.divider?"separator":void 0),t.xp6(2),t.Q6J("ngIf",!e.divider&&!e.passive),t.xp6(1),t.Q6J("ngIf",!e.divider&&e.passive)}}const $=new t.OlP("CONTEXT_MENU_OPTIONS");let nt=(()=>{class o{constructor(e){this.options=e,this.menuItems=[],this.isLeaf=!1,this.execute=new t.vpe,this.openSubMenu=new t.vpe,this.closeLeafMenu=new t.vpe,this.closeAllMenus=new t.vpe,this.autoFocus=!1,this.useBootstrap4=!1,this.subscription=new f.w,e&&(this.autoFocus=e.autoFocus,this.useBootstrap4=e.useBootstrap4)}ngOnInit(){this.menuItems.forEach(n=>{n.currentItem=this.item,this.subscription.add(n.execute.subscribe(i=>this.execute.emit(Object.assign(Object.assign({},i),{menuItem:n}))))});const e=new t.n_E;e.reset(this.menuItems),this._keyManager=new g.s1(e).withWrap()}ngAfterViewInit(){var e;this.autoFocus&&setTimeout(()=>this.focus()),null===(e=this.overlay)||void 0===e||e.updatePosition()}ngOnDestroy(){this.subscription.unsubscribe()}focus(){this.autoFocus&&this.menuElement.nativeElement.focus()}stopEvent(e){e.stopPropagation()}isMenuItemEnabled(e){return this.evaluateIfFunction(e&&e.enabled)}isMenuItemVisible(e){return this.evaluateIfFunction(e&&e.visible)}evaluateIfFunction(e){return e instanceof Function?e(this.item):e}isDisabled(e){return!!e.enabled&&!e.enabled(this.item)}onKeyEvent(e){!this.isLeaf||this._keyManager.onKeydown(e)}keyboardOpenSubMenu(e){if(!this.isLeaf||null===this._keyManager.activeItemIndex)return;this.cancelEvent(e);const n=this.menuItems[this._keyManager.activeItemIndex];n&&this.onOpenSubMenu(n,e)}keyboardMenuItemSelect(e){if(!this.isLeaf||null===this._keyManager.activeItemIndex)return;this.cancelEvent(e);const n=this.menuItems[this._keyManager.activeItemIndex];n&&this.onMenuItemSelect(n,e)}onCloseLeafMenu(e){!this.isLeaf||(this.cancelEvent(e),this.closeLeafMenu.emit({exceptRootMenu:37===e.keyCode,event:e}))}closeMenu(e){"click"===e.type&&2===e.button||this.closeAllMenus.emit({event:e})}onOpenSubMenu(e,n){if(null===this._keyManager.activeItemIndex)return;const i=this.menuItemElements.toArray()[this._keyManager.activeItemIndex];this.openSubMenu.emit({anchorElement:i&&i.nativeElement,contextMenu:e.subMenu,event:n,item:this.item,parentContextMenu:this})}onMenuItemSelect(e,n){n.preventDefault(),n.stopPropagation(),this.onOpenSubMenu(e,n),e.subMenu||e.triggerExecute(this.item,n)}cancelEvent(e){if(!e||!e.target)return;const n=e.target;["INPUT","TEXTAREA","SELECT"].indexOf(n.tagName)>-1||n.isContentEditable||(e.preventDefault(),e.stopPropagation())}}return o.\u0275fac=function(e){return new(e||o)(t.Y36($,8))},o.\u0275cmp=t.Xpm({type:o,selectors:[["context-menu-content"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Z,7),t.Gf(L,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.menuElement=i.first),t.iGM(i=t.CRH())&&(n.menuItemElements=i)}},hostBindings:function(e,n){1&e&&t.NdJ("keydown.ArrowDown",function(a){return n.onKeyEvent(a)},!1,t.Jf7)("keydown.ArrowUp",function(a){return n.onKeyEvent(a)},!1,t.Jf7)("keydown.ArrowRight",function(a){return n.keyboardOpenSubMenu(a)},!1,t.Jf7)("keydown.Enter",function(a){return n.keyboardMenuItemSelect(a)},!1,t.Jf7)("keydown.Space",function(a){return n.keyboardMenuItemSelect(a)},!1,t.Jf7)("keydown.Escape",function(a){return n.onCloseLeafMenu(a)},!1,t.Jf7)("keydown.ArrowLeft",function(a){return n.onCloseLeafMenu(a)},!1,t.Jf7)("click",function(a){return n.closeMenu(a)},!1,t.evT)("contextmenu",function(a){return n.closeMenu(a)},!1,t.evT)},inputs:{menuItems:"menuItems",item:"item",event:"event",parentContextMenu:"parentContextMenu",menuClass:"menuClass",overlay:"overlay",isLeaf:"isLeaf"},outputs:{execute:"execute",openSubMenu:"openSubMenu",closeLeafMenu:"closeLeafMenu",closeAllMenus:"closeAllMenus"},decls:4,vars:2,consts:[["tabindex","0",1,"dropdown","open","show","ngx-contextmenu",3,"ngClass"],["tabindex","0",1,"dropdown-menu","show",2,"position","static","float","none"],["menu",""],[3,"disabled","divider","dropdown-divider","active",4,"ngFor","ngForOf"],["li",""],["href","",3,"dropdown-item","active","disabled","hasSubMenu","click","mouseenter",4,"ngIf"],["class","passive",3,"dropdown-item","disabled","click","contextmenu",4,"ngIf"],["href","",3,"click","mouseenter"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"passive",3,"click","contextmenu"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"ul",1,2),t.YNc(3,Y,4,11,"li",3),t.qZA()()),2&e&&(t.Q6J("ngClass",n.menuClass),t.xp6(3),t.Q6J("ngForOf",n.menuItems))},dependencies:[O.mk,O.sg,O.O5,O.tP],styles:['.passive[_ngcontent-%COMP%]{display:block;padding:3px 20px;clear:both;font-weight:400;line-height:@line-height-base;white-space:nowrap}.hasSubMenu[_ngcontent-%COMP%]:before{content:"\\25b6";float:right}']}),o})(),st=(()=>{class o{constructor(e,n){this.template=e,this.elementRef=n,this.divider=!1,this.enabled=!0,this.passive=!1,this.visible=!0,this.execute=new t.vpe,this.isActive=!1}get disabled(){return this.passive||this.divider||!this.evaluateIfFunction(this.enabled,this.currentItem)}evaluateIfFunction(e,n){return e instanceof Function?e(n):e}setActiveStyles(){this.isActive=!0}setInactiveStyles(){this.isActive=!1}triggerExecute(e,n){!this.evaluateIfFunction(this.enabled,e)||this.execute.emit({event:n,item:e})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.Rgc,8),t.Y36(t.SBq))},o.\u0275dir=t.lG2({type:o,selectors:[["","contextMenuItem",""]],inputs:{subMenu:"subMenu",divider:"divider",enabled:"enabled",passive:"passive",visible:"visible"},outputs:{execute:"execute"}}),o})(),ft=(()=>{class o{constructor(e,n){this.overlay=e,this.scrollStrategy=n,this.isDestroyingLeafMenu=!1,this.show=new T.xQ,this.triggerClose=new T.xQ,this.close=new T.xQ,this.overlays=[],this.fakeElement={height:0,width:0,x:0,y:0}}openContextMenu(e){const{anchorElement:n,event:i,parentContextMenu:a}=e;if(a){const r=this.overlay.position().flexibleConnectedTo(new t.SBq(i instanceof MouseEvent?i.target:n)).withPositions([{originX:"end",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"end",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"start",overlayY:"bottom"},{originX:"start",originY:"bottom",overlayX:"end",overlayY:"bottom"}]),l=this.overlay.create({positionStrategy:r,panelClass:"ngx-contextmenu",scrollStrategy:this.scrollStrategy.close()});this.destroySubMenus(a),this.overlays=this.overlays.concat(l),this.attachContextMenu(l,e)}else{this.fakeElement={height:0,width:0,x:i.clientX,y:i.clientY},this.closeAllContextMenus({eventType:"cancel",event:i});const l=this.overlay.position().flexibleConnectedTo(n?new t.SBq(n):this.fakeElement).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"end",overlayY:"top"},{originX:"end",originY:"center",overlayX:"start",overlayY:"center"},{originX:"start",originY:"center",overlayX:"end",overlayY:"center"}]);this.overlays=[this.overlay.create({positionStrategy:l,panelClass:"ngx-contextmenu",scrollStrategy:this.scrollStrategy.close()})],this.attachContextMenu(this.overlays[0],e)}}attachContextMenu(e,n){const{event:i,item:a,menuItems:r,menuClass:l}=n,c=e.attach(new y.C5(nt));c.instance.event=i,c.instance.item=a,c.instance.menuItems=r,c.instance.overlay=e,c.instance.isLeaf=!0,c.instance.menuClass=l,e.contextMenu=c.instance;const _=new f.w;_.add(c.instance.execute.asObservable().subscribe(d=>this.closeAllContextMenus(Object.assign({eventType:"execute"},d)))),_.add(c.instance.closeAllMenus.asObservable().subscribe(d=>this.closeAllContextMenus(Object.assign({eventType:"cancel"},d)))),_.add(c.instance.closeLeafMenu.asObservable().subscribe(d=>this.destroyLeafMenu(d))),_.add(c.instance.openSubMenu.asObservable().subscribe(d=>{this.destroySubMenus(c.instance),d.contextMenu?(c.instance.isLeaf=!1,this.show.next(d)):c.instance.isLeaf=!0})),c.onDestroy(()=>{r.forEach(d=>d.isActive=!1),_.unsubscribe()}),c.changeDetectorRef.detectChanges()}closeAllContextMenus(e){this.overlays&&(this.close.next(e),this.overlays.forEach((n,i)=>{n.detach(),n.dispose()})),this.overlays=[]}getLastAttachedOverlay(){let e=this.overlays[this.overlays.length-1];for(;this.overlays.length>1&&e&&!e.hasAttached();)e.detach(),e.dispose(),this.overlays=this.overlays.slice(0,-1),e=this.overlays[this.overlays.length-1];return e}destroyLeafMenu({exceptRootMenu:e,event:n}={}){this.isDestroyingLeafMenu||(this.isDestroyingLeafMenu=!0,setTimeout(()=>{const i=this.getLastAttachedOverlay();this.overlays.length>1&&i&&(i.detach(),i.dispose()),!e&&this.overlays.length>0&&i&&(this.close.next({eventType:"cancel",event:n}),i.detach(),i.dispose());const a=this.getLastAttachedOverlay();a&&a.contextMenu&&(a.contextMenu.isLeaf=!0),this.isDestroyingLeafMenu=!1}))}destroySubMenus(e){const i=this.overlays.indexOf(e.overlay);this.overlays.slice(i+1).forEach(a=>{a.detach(),a.dispose()})}isLeafMenu(e){const n=this.getLastAttachedOverlay();return e.overlay===n}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(u.aV),t.LFG(u.uw))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})(),ct=(()=>{class o{constructor(e,n){this.contextMenuService=e,this.options=n,this.menuClass="",this.autoFocus=!1,this.useBootstrap4=!1,this.disabled=!1,this.close=new t.vpe,this.open=new t.vpe,this.visibleMenuItems=[],this.links=[],this.subscription=new f.w,this.options&&(this.autoFocus=this.options.autoFocus||!1,this.useBootstrap4=this.options.useBootstrap4||!1),this.subscription.add(e.show.subscribe(i=>{this.onMenuEvent(i)}))}ngOnDestroy(){this.subscription.unsubscribe()}onMenuEvent(e){if(this.disabled)return;const{contextMenu:n,event:i,item:a}=e;n&&n!==this||(this.event=i,this.item=a,this.setVisibleMenuItems(),this.contextMenuService.openContextMenu(Object.assign(Object.assign({},e),{menuItems:this.visibleMenuItems,menuClass:this.menuClass})),this.contextMenuService.close.asObservable().pipe((0,k.P)()).subscribe(r=>this.close.emit(r)),this.open.next(e))}isMenuItemVisible(e){return this.evaluateIfFunction(e.visible)}setVisibleMenuItems(){this.visibleMenuItems=this.menuItems.filter(e=>this.isMenuItemVisible(e))}evaluateIfFunction(e){return e instanceof Function?e(this.item):e}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(ft),t.Y36($,8))},o.\u0275cmp=t.Xpm({type:o,selectors:[["context-menu"]],contentQueries:function(e,n,i){if(1&e&&t.Suo(i,st,4),2&e){let a;t.iGM(a=t.CRH())&&(n.menuItems=a)}},viewQuery:function(e,n){if(1&e&&t.Gf(Z,5),2&e){let i;t.iGM(i=t.CRH())&&(n.menuElement=i.first)}},inputs:{menuClass:"menuClass",autoFocus:"autoFocus",useBootstrap4:"useBootstrap4",disabled:"disabled"},outputs:{close:"close",open:"open"},decls:0,vars:0,template:function(e,n){},styles:[".cdk-overlay-container{position:fixed;z-index:1000;pointer-events:none;top:0;left:0;width:100%;height:100%}.ngx-contextmenu.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box}\n"],encapsulation:2}),o})(),_t=(()=>{class o{constructor(e){this.contextMenuService=e}onContextMenu(e){this.contextMenu&&!this.contextMenu.disabled&&(this.contextMenuService.show.next({contextMenu:this.contextMenu,event:e,item:this.contextMenuSubject}),e.preventDefault(),e.stopPropagation())}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(ft))},o.\u0275dir=t.lG2({type:o,selectors:[["","contextMenu",""]],hostBindings:function(e,n){1&e&&t.NdJ("contextmenu",function(a){return n.onContextMenu(a)})},inputs:{contextMenuSubject:"contextMenuSubject",contextMenu:"contextMenu"}}),o})(),Ct=(()=>{class o{static forRoot(e){return{ngModule:o,providers:[ft,{provide:$,useValue:e},{provide:u.Xj,useClass:u.YJ}]}}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[O.ez,u.U8]]}),o})();var Dt=b(51908),Tt=b(5029),jt=b(1737),wt=b(43189),It=b(63728),Lt=b(44841),Mt=b(47470),Ht=b(75658),ce=b(49088),$e=b(8785),Te=b(40520),St=b(37908),zt=b(25034),Xt=b(36053);class ln extends zt.EditorApiService{constructor(s,e,n,i,a){super(),this.questionHelper=s,this.apiUploadService=e,this.documentService=n,this.examService=i,this.questionService=a,this.treeData=[],this.treeQuestion=[],this.saveTreeData=[],this.saveTreeQuestion=[],this.saveTreeResponse=[]}loadData(s){return new Promise(e=>{this.saveTreeData.includes(s)?e():(this.saveTreeData.push(s),this.documentService.apiDocumentsGet(s,void 0,void 0,void 0,void 0,1,1,-1).subscribe(n=>{1===n.success&&n.data&&((n.data.categoryObjs||[]).forEach(r=>{this.treeData.push({id:r.id||0,name:r.name||"",type:"cat",pr:s})}),(n.data.documentObjs||[]).forEach(r=>{r.exam&&this.treeData.push({id:r.exam.id||0,name:r.exam.name||"",type:"test",pr:s})})),e()}))})}getTotalQuest(s){return this.treeQuestion.filter(e=>e.pr===s&&"quest"===e.type).length}loadQuestion(s){return new Promise(e=>{this.saveTreeQuestion.includes(s)?e():(this.saveTreeQuestion.push(s),this.examService.apiExamGetExamWithQuestionObjsIdGet(s).subscribe(n=>{if(1===n.success&&n.data){let a=[];(n.data.questionObjs||[]).forEach(r=>{var l;this.treeQuestion.push({id:r.id||0,label:(null!==(l=r.rawIndex)&&void 0!==l?l:0)+1,content:this.questionHelper.renderContent(r),groupId:r.groupId,type:"quest",pr:s}),a.includes(r.groupId||0)||a.push(r.groupId||0)}),a.length>1&&a.forEach(r=>{this.treeQuestion.push({id:r,label:r,content:"Nh\xf3m "+(r+1),type:"group",pr:s})}),e()}}))})}searchRes(s,e){return new Promise(n=>{this.loadData(e).then(()=>{n(this.treeData.filter(i=>i.name.includes(s)&&i.pr===e))})})}getQuestion(s){return new Promise(e=>{this.loadQuestion(s).then(()=>{e(this.treeQuestion.filter(n=>n.pr===s))})})}convertQuestionInfo(s){return{id:s.id||0,label:Number(s.label)||0,content:"C\xe2u"+s.label,type:"quest"}}apiQuestionsGet(s,e,n,i,a,r){return new Promise(l=>{const c=n+"_"+i+"_"+r+"_"+a+"_"+s,_=this.saveTreeResponse.find(d=>d.key===c);_&&e?l(_.questions):this.questionService.apiQuestionsGet(n+"",i+"",r+"","",void 0,a+"","",void 0,s).subscribe(d=>{if(1===d.success&&d.data&&d.data.questions&&d.data.questions.length>0){const m=this.saveTreeResponse.findIndex(p=>p.key===c);return-1===m?this.saveTreeResponse.push({key:c,questions:d.data.questions}):this.saveTreeResponse[m].questions=d.data.questions,void l(d.data.questions)}l([])})})}randomQuestToFull(s,e,n,i,a,r){return new Promise(l=>{this.apiQuestionsGet(s,e,n,i,a,r).then(c=>{l(c)})})}randomQuest(s,e,n,i,a,r){return new Promise(l=>{this.apiQuestionsGet(s,e,n,i,a,r).then(c=>{l(c.map(_=>this.convertQuestionInfo(_)))})})}uploadToCdnForHomework(s){return new Promise((e,n)=>{this.apiUploadService.uploadToCdnForHomework(s).subscribe(i=>{1==i.success&&i.data?e(JSON.stringify(i.data)):n(new Error("Not upload file"))})})}uploadToCdnProgressOldExamQuestion(s){return new Promise((e,n)=>{this.apiUploadService.uploadToCdnProgressOldExamQuestion(s).subscribe(i=>{1==i.success&&i.data?e(JSON.stringify(i.data)):n(new Error("Not upload file"))})})}uploadToCdnProgressForExamQuestionContent(s){return new Promise((e,n)=>{this.apiUploadService.uploadToCdnProgressForExamQuestionContent(s).subscribe(i=>{1==i.success&&i.data?e(JSON.stringify(i.data)):n(new Error("Not upload file"))})})}uploadToCdnProgressForTestbankQuestionResult(s){return new Promise((e,n)=>{this.apiUploadService.uploadToCdnProgressForTestbankQuestionResult(s).subscribe(i=>{1==i.success&&i.data?e(JSON.stringify(i.data)):n(new Error("Not upload file"))})})}uploadToCdnProgressForTestbankQuestionAttachment(s){return new Promise((e,n)=>{this.apiUploadService.uploadToCdnProgressForTestbankQuestionAttachment(s).subscribe(i=>{1==i.success&&i.data?e(JSON.stringify(i.data)):n(new Error("Not upload file"))})})}uploadToCdnProgressForTestbankPdf(s){return new Promise((e,n)=>{this.apiUploadService.uploadToCdnProgressForTestbankPdf(s).subscribe(i=>{1==i.success&&i.data?e(JSON.stringify(i.data)):n(new Error("Not upload file"))})})}uploadToCdnProgressForTestbankDocx(s){return new Promise((e,n)=>{this.apiUploadService.uploadToCdnProgressForTestbankDocx(s).subscribe(i=>{1==i.success&&i.data?e(JSON.stringify(i.data)):n(new Error("Not upload file"))})})}}var mt=b(55330),Et=b(81721),Ut=b(51442),qt=b(36221);class Rt{constructor(s,e){this.editorOutputDataService=s,this.commonService=e,this.startIndex=0,this.backToLink="",this.title="",this.editor={show:!0},this.examSave={},this.homeworkSave={},this.mathEditor={},this.imageEditor={},this.logConfig={},this.heightContent=600}showEditor(){this.disAll(),this.reSetBackToLink(),this.editor.show=!0}showHomework(){var s;this.disAll(),this.backToLink="",this.title=null!==(s=this.commonService.myTranslateIntance("lang_cms_config_homework_title"))&&void 0!==s?s:"",this.homeworkSave.show=!0}showExam(){var s;this.disAll(),this.title=null!==(s=this.commonService.myTranslateIntance("lang_auto_cau_hinh_de_thi"))&&void 0!==s?s:"",this.backToLink="",this.examSave.show=!0}disAll(){this.title="",this.examSave.show=!1,this.homeworkSave.show=!1,this.editor.show=!1}reSetBackToLink(){var s;this.title=null!==(s=this.commonService.myTranslateIntance("lang_auto_cong_cu_soan_thao_noi_dung"))&&void 0!==s?s:"",this.backToLink=this.sourceBackToLink?this.sourceBackToLink:"/admin/testbank/create-new-document/"+(null!=this.cur_cateId?this.cur_cateId:0)}getBackLink(){return this.matrix&&this.matrix.matrix.length>0?(this.editorOutputDataService.setMatrixData(this.matrix,!0),"/admin/testbank/mix-bank-template/"+(null!=this.cur_cateId?this.cur_cateId:0)):this.backToLink}}class ve{constructor(s,e){this.editorCommonService=s,this.commonService=e,this.wmf=new WMFConverter}readFileInputEventAsArrayBuffer(s,e){var n=new FileReader;n.onload=function(i){e(i.target.result)},n.readAsArrayBuffer(s)}handleFileSelect(s,e,n){let i=this,a=(c,_)=>{if(n){let d=this.commonService.myTranslateIntance("lang_auto_cong_thuc");n(c,_,d)}},l=new qt.Q(30,{function:n?(c,_)=>{if(n){let d=this.commonService.myTranslateIntance("lang_auto_image");n(c,_,d)}}:()=>{}});this.readFileInputEventAsArrayBuffer(s,function(c){azotaDocx.readDocx(c,a).then(function(_){for(let d of _.data)"img"==d.type&&("image/x-wmf"==d.contentType||"image/x-emf"==d.contentType?l.addTask(i,i.convert,[d]):d.value="data:"+d.contentType+";base64, "+d.value,!d.cssStyle&&d.height&&d.width&&"EMU"==d.measureUnit)&&(d.cssStyle=`width:${+d.width/12700}pt;height:${+d.height/12700}pt;margin-top:0px;`);l.start().then(()=>{let d=new Map,m=0;for(let p of _.data)"img"==p.type&&p.cropInfo&&d.set(m,1),m++;if(e&&0==d.size)e(_);else{m=0;for(let p of _.data){if("img"==p.type&&p.cropInfo){const w=m,C=document.createElement("img");C.src=p.value,C.onload=()=>{i.cropImage(p,C),d.delete(w),0==d.size&&e&&e(_)},C.onerror=()=>{d.delete(w),0==d.size&&e&&e(_)}}m++}}})})})}convert(s){return new Promise(e=>{if("image/x-wmf"==s.contentType)s.value=this.wmf.toPNG("data:"+s.contentType+";base64, "+s.value),e();else{let r=new ToContext2D(0,1),l=this.decodeBase64(s.value);try{FromEMF.Parse(l,r)}catch(c){}var n=this.scaleCanvas(r.canvas,200,200);s.value=n.toDataURL(),e()}})}decodeBase64(s){return Uint8Array.from(atob(s),function(e){return e.charCodeAt(0)})}scaleCanvas(s,e,n){let i=document.createElement("canvas");i.width=e,i.height=n;let a=i.getContext("2d");return null==a||a.drawImage(s,0,0,s.width,s.height,0,0,e,n),i}cropImage(s,e){if(!s.cropInfo)return;let n=s.cropInfo.left?+s.cropInfo.left:0,i=s.cropInfo.top?+s.cropInfo.top:0,a=s.cropInfo.right?+s.cropInfo.right:0,r=s.cropInfo.bottom?+s.cropInfo.bottom:0;if(n+i+a+r==0)return;let l=e.width,c=e.height,_=n*l/1e5,d=i*c/1e5,w=l-a*l/1e5-_,C=c-r*c/1e5-d;const A=document.createElement("canvas");A.width=w,A.height=C;const M=A.getContext("2d");null==M||M.drawImage(e,_,d,w,C,0,0,w,C),s.value=A.toDataURL()}}class pe{parse(s){let e=["NB_SOCH","TH_SOCH","VD_SOCH","VDC_SOCH","DIEM"],n=[],i=[];for(let l of s)for(let c of l.content){if(c.isMerge||""==c.value.trim()||e.indexOf(c.indexName)<0)continue;let _=s.filter(C=>C.obj.id==c.id).map(C=>({id:C.obj.id,type:C.obj.type[0].toUpperCase(),name:C.obj.item})),d=s.filter(C=>C.obj.id==c.id).map(C=>{var A,M,D;return{id:null===(A=C.obj.prNode)||void 0===A?void 0:A.id,type:null===(M=C.obj.prNode)||void 0===M?void 0:M.type[0].toUpperCase(),name:null===(D=C.obj.prNode)||void 0===D?void 0:D.item}}),m=c.value;m=m.replace(/\d+/g,"").trim();let p=[c.indexName.split("_")[0]];""!=m?p.push(...m.split(",").map(C=>C.trim())):p.push("TN","DT");let w={value:zt.Utils.getNumberFromStr(c.value),tag:p,parent:d.length>0&&d[0].id?d[0]:void 0,items:[..._],point:0};for(let C of c.mergeId){let A=s.filter(M=>M.index==C).map(M=>({id:M.obj.id,type:M.obj.type[0].toUpperCase(),name:M.obj.item}));w.items.push(...A)}"DIEM"==w.tag[0]?i.push(w):n.push(w)}for(let l of i){let c=0;for(let _ of n)l.items.filter(m=>_.items.filter(p=>p.id==m.id).length>0).length>0&&(c+=+_.value);c>0&&(l.point=Math.round(+l.value/10*100/c)/100);for(let _ of n)l.items.filter(m=>_.items.filter(p=>p.id==m.id).length>0).length>0&&(_.point=l.point)}let a=[],r=new Map;for(let l of n){let _=[l.parent?`[@${l.parent.type}${l.parent.id}:${l.parent.name}].`:""],d=l.items.map(w=>`[@${w.type}${w.id}:${w.name}]`).join(",")+".";_.push(d);let m=l.tag.map(w=>`[@F:azt_lang_tag_${w}]`).join(",");_.push(`${m}.`),_.push(`[azt_lang_sugg_random ${l.value} azt_lang_sugg_question]`);let p=_.join("");for(let w=0;w<+l.value;w++)r.set(p+"=>"+w,{d:l.point});a.push(p)}return{text:a.join("\n"),extra:r}}}class cn{process(s){let e=/^\s*#(\d)\s*\[[A-Z0-9\-\[\]\$!:b]+\]/g,n=["NB","TH","VD","VDC"],i=0,a=!1,r=1;for(let l of s){let _=l.matchAll(e).next();if(!_.done){let d=_.value[0],m=+_.value[1]-1;m<n.length&&(s[i]=l.replace(d,`C\xe2u ${r++}. (${n[m]})`)),a=!0}a&&"GY"==l.trim()&&(s[i]="L\u1eddi gi\u1ea3i"),i++}}}var Ee=b(86858),_e=b(13041);class vn extends _e.N{constructor(){super(...arguments),this.chemBase=["H","He","Li","Be","B","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br","Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I","Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At","Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Nh","Fl","Mc","Lv","Ts","Og"]}render(s,e,n){if(s.trim().startsWith("[@"))return s;let i=s,a=this.chemBase.join("|"),r=new RegExp(`(?:[\\s,.:;"'=\u2013\\-\\/\\+\\?<>]|^)\\(?(${a})+\\d*(${a}|\\d+|\\(|\\))*(?=[\\s,.:;"'=\u2013\\-\\/\\+\\?<>]|$)`,"g"),l=i.matchAll(r),c=[];for(;;){let d=l.next();if(d.done)break;let m=0==d.value.index?d.value[0]:d.value[0].substring(1);m.replace("(","").replace(")","").length<=1||c.push({s:0==d.value.index?0:d.value.index+1,len:m.length,val:this.autoFormat(m)})}if(c.sort((d,m)=>d.s>m.s?-1:1),c.filter(d=>/\d+/.test(d.val)).length>0)for(let d of c)i=i.substring(0,d.s)+"\\("+d.val+"\\)"+i.substring(d.s+d.len);return i}autoFormat(s){return s.replaceAll(/([^\(])(\d+)/g,"$1_{$2}")}}var We=b(76944);class Zn extends _e.N{constructor(s){super(),this.cdnService=s}render(s,e,n){var i;if(s.indexOf("[img:")<0)return s;let r=s,l=r.matchAll(/\[img:\$[a-zA-Z0-9_]+\$\]/g);for(;;){let c=l.next();if(c.done)break;let _=c.value[0];const d=_.replace("[img:$","").replace("$]","");if(e){const m=e.find(p=>p.id===d);if(m){const p=document.createElement("img");p.id=d,p.classList.add(0===d.indexOf("af")?"qv_full_a_img":0===d.indexOf("f")?"qv_full_img":"qv_img"),p.crossOrigin="anonymous",p.style.cssText=null!==(i=m.cssStyle)&&void 0!==i?i:"";let w=We.G.generateIdRequired(10),C=this.cdnService.getRawCdnLink(m.link);this.loadingManager.set(w,C),p.onload=()=>{this.loadingManager.delete(w)},p.onerror=()=>{this.loadingManager.delete(w)},p.src=C,r=r.replace(_,p.outerHTML)}}}return r}}var io=b(30345),ma=b(25442),ha=b(25482);class ki extends _e.N{constructor(s,e,n,i,a,r,l,c,_){super(),this.cdnService=s,this.commonService=e,this.callBack=n,this.apiCallbackCache=i,this.editor=a,this.onError=r,this.loadedQuestIds=l,this.apiDataCache=c,this.matrixData=_,this.getOne=!1}render(s,e,n){var i;let a=s.split("<br>")[0].trim(),r=a.split("=>"),l=r.length>1?+r[1].split("-")[1]:0,c=r.length>1?+r[1].split("-")[0]:0;if(!this.callBack||!/^\[@[CTG]\d+:[^\]]+\]([\.,]\[[^\]]+\])+$/.test(r[0].trim())&&!/^\[@Q\d+:[^\]]+\](\s*,\s*\[@Q\d+:[^\]]+\])*$/.test(r[0].trim()))return s;let m=r[0]+"=>"+c,p=ma.Utils.parseInclude(a);if(this.apiDataCache){let F=this.apiDataCache.get(a);if(F&&this.callBack)return setTimeout(()=>{F&&this.callBack&&this.callBack(F)},50),"Loading...|"+p.questId.join(",")}if(this.apiCallbackCache){let U={i:l,call:this.callBack,err:this.onError},F=this.apiCallbackCache.get(m);if(F)return F.push(U),"Loading...|"+p.questId.join(",");this.apiCallbackCache.set(m,[U])}let w=this.loadedQuestIds&&0==p.questId.length?this.loadedQuestIds.join(","):"",C=!1;0==p.getNum&&p.groupId.length>0&&(C=!0,p.getNum=1,w=p.questId.length>0?w:""),this.getOne&&p.getNum&&p.getNum>1&&(p.getNum=1);let A=p.tag.filter(U=>"TL"==U||"TN"==U||"\u0110T"==U).map(U=>{switch(U){case"TL":return"3";case"TN":return"1";case"\u0110T":return"4"}return U}),M=p.tag.filter(U=>"TL"!=U&&"TN"!=U&&"\u0110T"!=U),D=We.G.generateIdRequired(10),q=null===(i=this.matrixData)||void 0===i?void 0:i.filter(U=>U.key==m)[0];return q?setTimeout(()=>{var U;this.processApiResponse(null!==(U=null==q?void 0:q.questions)&&void 0!==U?U:[],m,C)},400):(this.loadingManager.set(D,a),null==n||n.apiQuestionsGet(p.catId.join(","),p.examId.join(","),p.groupId.join(","),A.join(","),M.join(","),p.questId.join(","),w,void 0,p.getNum).subscribe(U=>{let F=[];1===U.success&&U.data&&U.data.questions&&U.data.questions.length>0&&(F=U.data.questions),setTimeout(()=>{this.processApiResponse(F,m,C)},400),this.loadingManager.delete(D)})),"Loading...|"+p.questId}setGetOne(s){this.getOne=s}processApiResponse(s,e,n){var i,a,r,l,c,_,d,m;let p=null!=s?s:[],w=null===(i=this.apiCallbackCache)||void 0===i?void 0:i.get(e);if(w)for(const C of w){let A=this.getOne?0:C.i;if(p.length<=A){C.err&&C.err("Kh\xf4ng t\u1ea3i \u0111\u01b0\u1ee3c c\xe2u h\u1ecfi t\u1eeb ng\xe2n h\xe0ng. S\u1ed1 c\xe2u c\u1ea7n l\u1ea5y v\u01b0\u1ee3t qu\xe1 s\u1ed1 l\u01b0\u1ee3ng hi\u1ec7n c\xf3.");continue}let M=p[A];const D=this.commonService.willDeleteParseJson(null!==(a=M.content)&&void 0!==a?a:"[]"),q={type:"bank",sourceId:M.id};if(D&&D.length>0&&D[0].vMetaEditor&&(q.heightLabel=D[0].vMetaEditor.heightLabel),n){let tt=this.commonService.willDeleteParseJson(M.content||"[]"),W="",P={renderedStr:W,label:"",quest:{label:0,isGroup:!0,parts:[],answers:[]},answers:[],isFixGroup:"1"===M.groupType,meta:q};if(1==M.isImage&&tt[0].groupUrl){let R=We.G.generateIdRequired(10);this.loadingManager.set(R,tt[0].groupUrl),this.loadImage(tt[0].groupUrl,this.cdnService).then(N=>{var B;const z=document.createElement("canvas");z.width=N.width,z.height=N.height,null===(B=z.getContext("2d"))||void 0===B||B.drawImage(N,0,0,N.width,N.height);const X=document.createElement("img");X.src=z.toDataURL(),X.classList.add("qv_img-group-content"),P.renderedStr=X.outerHTML,C.call(P),this.loadingManager.delete(R)}).catch(N=>{P.renderedStr="Load image error",C.call(P),this.loadingManager.delete(R)})}else W=null!==(r=tt[0].groupContent)&&void 0!==r?r:"",P.renderedStr=W,C.call(P);this.apiDataCache&&this.apiDataCache.set(e+"-"+C.i,P);continue}let U=4==M.answerType&&M.answerResult?this.commonService.willDeleteParseJson(M.answerResult):[],F="text";if(1===M.isImage&&(F=this.commonService.willDeleteParseJson(M.content||"")[0].url?"image":F),"image"===F){let tt=this.commonService.willDeleteParseJson(M.content||""),W=tt[0].metaData,P={renderedStr:"",label:"",attachments:M.attachments,quest:{isFixAns:1==M.isFixAns,label:0,parts:[],answers:W&&W.answers?W.answers.map(N=>{var B;return{label:N.label,isCorrect:-1!==(null===(B=M.answerResult)||void 0===B?void 0:B.indexOf(N.label)),parts:[]}}):(null!==(c=this.commonService.willDeleteParseJson(null!==(l=M.answerConfig)&&void 0!==l?l:"").answer)&&void 0!==c?c:[]).map(N=>{var B;return{label:N,isCorrect:-1!==(null===(B=M.answerResult)||void 0===B?void 0:B.indexOf(N)),parts:[]}})},strAns:U.length>0?U:void 0,answers:[],v:W?"pdf-2-0":"pdf-1-0",id:M.id,meta:q};P.originCorrectAns=null===(_=P.quest.answers.find(N=>N.isCorrect))||void 0===_?void 0:_.label,M.tags&&(P.tag=M.tags.map(N=>({id:N.id,code:N.code,viName:N.viName,enName:N.enName})));let R=We.G.generateIdRequired(10);this.loadingManager.set(R,tt[0].url),this.loadImage(tt[0].url,this.cdnService).then(N=>{this.processImageQuestion(N,tt,P),M.answerMedia?this.loadImageToBase64(M.answerMedia,this.cdnService).then(B=>{P.helpRenderedStr=B,C.call(P)}):C.call(P),this.apiDataCache&&this.apiDataCache.set(e+"-"+C.i,P),this.loadingManager.delete(R)}).catch(N=>{P.renderedStr="Load image error",C.call(P),this.loadingManager.delete(R)})}else{let tt=this.commonService.willDeleteParseJson(M.content||"[]"),W=this.commonService.willDeleteParseJson(M.answerConfig||"[]"),P={renderedStr:"",label:"",attachments:M.attachments,quest:{isFixAns:1==M.isFixAns,label:0,parts:[],answers:W.map(R=>{var N;return{label:R.key,isCorrect:-1!==(null===(N=M.answerResult)||void 0===N?void 0:N.indexOf(R.key)),parts:[]}})},strAns:U.length>0?U:void 0,answers:[],v:"docx",id:M.id,meta:q};P.originCorrectAns=null===(d=P.quest.answers.find(R=>R.isCorrect))||void 0===d?void 0:d.label,tt.length>0&&(P.renderedStr=tt[0].content),M.answerMedia&&(P.helpRenderedStr=M.answerMedia),M.tags&&(P.tag=M.tags.map(R=>({id:R.id,code:R.code,viName:R.viName,enName:R.enName}))),P.answers=P.quest.answers.map((R,N)=>({renderedStr:W[N].content,ans:R})),this.apiDataCache&&this.apiDataCache.set(e+"-"+C.i,P),C.call(P)}}null===(m=this.apiCallbackCache)||void 0===m||m.delete(e)}setCallback(s){this.callBack=s}setApiCache(s){this.apiCallbackCache=s}processImageQuestion(s,e,n){const i=e[0].metaData;if(i){const a={x:0,y:0,w:i.question.width,h:i.question.height};let r=i.question.height;i.answers&&i.answers.forEach((c,_)=>{let d="";if(1!==c.width||1!==c.height){const m=this.cropImageWithPos({x:c.x,y:c.y,w:c.width,h:c.height},{x:c.remove.x,y:c.remove.y,w:c.remove.width,h:c.remove.height},s);m.classList.add("qv_ats_image"),r>c.y&&(a.h=c.y,r=c.y),d=m.outerHTML}n.answers.push({renderedStr:d,ans:n.quest.answers[_]})}),a.h<5&&(a.h=1,a.h=1);const l=this.cropImageWithPos(a,{x:i.question.remove.x,y:i.question.remove.y,w:i.question.remove.width,h:i.question.remove.height},s,!0);l.classList.add("qv_qts_image"),n.renderedStr=l.outerHTML,n.meta&&(n.meta.heightLabel=this.calculateHeightLabel(s,i.question.remove))}else n.renderedStr=s.outerHTML}cropImageWithPos(s,e,n,i,a){const r=document.createElement("canvas");r.width=s.w,r.height=s.h;const l=r.getContext("2d"),c=document.createElement("img");null==l||l.drawImage(n,s.x,s.y,s.w,s.h,0,0,s.w,s.h),l&&(l.fillStyle="#fff"),null==l||l.fillRect(e.x-s.x,e.y-s.y,e.w,e.h);const d=ha.rj.cropCanvas(r,void 0);return a?d:(c.src=d.toDataURL(),c.style.width=d.width*this.ratioImage+"px",c)}calculateHeightLabel(s,e){return this.cropImageWithPos({x:e.x,y:e.y,w:e.width,h:e.height},{x:0,y:0,w:0,h:0},s,!1,!0).height}}class pa extends _e.N{constructor(s){super(),this.mathMap=s}render(s,e,n){let i=s,r=i.matchAll(/\[!m:\$(([^\]]|[^\$]\])+)\$\]/g);for(;;){let l=r.next();if(l.done)break;let c=l.value[0],_=l.value[1],d=this.mathMap.get(_),m="";const p=document.createElement("span");p.classList.add("tex2jax_process"),p.classList.add("azt-mathml"),p.id=_,d&&(p.innerHTML=d.str,d.raw&&p.setAttribute("data-azt-math-raw",d.raw)),m=p.outerHTML,i=i.replace(c,m)}return i}}class ga extends _e.N{render(s,e,n){let i=this.bypassChild(s);return i=i.replaceAll(/\\\)\s*\\\(/g,""),i}bypassChild(s,e="\\(",n="\\)"){if(e.length!==n.length)return"";const i=[];let a=0;for(;;){let c=s.indexOf(e,a);if(-1===c)break;i.push("s_"+c),a=c+1}for(a=0;;){let c=s.indexOf(n,a);if(-1===c)break;i.push("e_"+c),a=c+1}i.sort(function(c,_){return parseInt(c.substr(2))-parseInt(_.substring(2))});let r=[];const l=[];return i.forEach(c=>{if("s"===c.substring(0,1))r.push(parseInt(c.substring(2)));else if(1==r.length)r=[];else{let _=r.pop();if(_){let d=parseInt(c.substring(2));l.push(_),l.push(d)}}}),l.sort(function(c,_){return c-_}).reverse().forEach(c=>{s=s.substring(0,c)+s.substring(c+e.length)}),s}}class fa extends _e.N{render(s){let e=s,n=e.split("<br>"),i=0,a=/\[![!ibucsbphl]+:!!\]/;for(let c of n){if(a.test(c)){let d=c.split(":!!]")[0].split("["),m=d[d.length-1].split(":")[0];n[i]=c.startsWith("[*")?"[* ["+m+":$"+c.replace(a,"$]").substring(2):"["+m+":$"+c.replace(a,"$]")}i++}e=n.join("<br>"),e=e.replaceAll(/\[![!ibucsbphl]+:\$\$\]/g,"");let l=e.matchAll(/\[![!ibucsbphl]+:\$(([^\$]|\$[^\]])+)\$\]/g);for(;;){let c=l.next();if(c.done)break;let _=c.value[0],d=c.value[1],m=_.split(":")[0].split("!");m.shift();for(let p=m.length-1;p>=0;p--){let w=m[p];d="hl"==w?d:`<${w}>${d}</${w}>`}e=e.replace(_,d)}return e}}class xa extends _e.N{render(s,e,n){let i=s,a=[[/([^<])-+([^\-><]+)-+>/g,"$1\\( \\xrightarrow[]{$2} \\)"],[/<-+([^\-><]+)-+([^>])/g,"\\( \\xleftarrow[]{$1} \\)$2"],[/([^<])--+>/g,"$1\\( \\longrightarrow \\)"],[/<--+([^>])/g,"\\( \\longleftarrow \\)$1"],[/<-+>/g,"\\( \\longleftrightarrow \\)"],[/([^<])->/g,"$1\\( \\rightarrow \\)"],[/<-([^>])/g,"\\( \\leftarrow \\)$1"]];for(let r of a)i=i.replaceAll(r[0],r[1]);return i}}class va extends _e.N{render(s,e,n){let a=s.split("<br>").map(c=>c.trim()),r=[],l=[];for(let c of a)if(c.startsWith("[*")&&c.endsWith("*]")){let _=c.replaceAll("\\n","<br>").replaceAll("[*","<tr><td>").replaceAll("*]","</td></tr>");_=_.replaceAll("|","</td><td>"),l.push(_)}else l.length>0&&(r.push('<table class="q-table">'+l.join("")+"</table>"),l=[]),r.push(c.replaceAll("\\n","<br>"));return l.length>0&&r.push('<table class="q-table">'+l.join("")+"</table>"),r.join("<br>")}}class oo extends _e.N{render(s,e,n){let i=s,r=i.matchAll(/\[\*?[A-H]:[^\]]+\]/g);for(;;){let _=r.next();if(_.done)break;let d=_.value[0],p=d.substring(1,d.length-1).split(":");2==p[0].length&&(p[0]=p[0].substring(1)),i=i.replace(d,`<span class="qv_string_eng_ans" style='cursor: pointer;padding: 0 5px;font-weight: bold;text-decoration: underline;position: relative;height: 40px;display: inline-block;'>${p[1]} <span style='position: absolute;top: 20px;left: 45%;'>${p[0]}</span></span>`)}return i}revert(s,e){let n=s;return n=n.replaceAll(/<span class="qv_string_eng_ans"[^>]+>([^><]+)<span[^>]+>([^><]+)<\/span><\/span>/g,"[$2:$1]"),n=n.replace("["+e+":","[*"+e+":"),n}}let ao=(()=>{class o{}return o.EXAM_FULL=["Ph\u1ea7n 1. TR\u1eaeC NGHI\u1ec6M\nC\xe2u 1. Trong cu\u1ed9c khai th\xe1c thu\u1ed9c \u0111\u1ecba l\u1ea7n th\u1ee9 hai \u1edf \u0110\xf4ng D\u01b0\u01a1ng 1919.1929, th\u1ef1c d\xe2n Ph\xe1p t\u1eadp trung \u0111\u1ea7u t\u01b0 v\xe0o\nA. Ng\xe0nh ch\u1ebf t\u1ea1o m\xe1y.      B. C\xf4ng nghi\u1ec7p luy\u1ec7n kim.\nC. \u0110\u1ed3n \u0111i\u1ec1n cao su.        D. C\xf4ng nghi\u1ec7p h\xf3a ch\u1ea5t.\n\nC\xe2u 2. N\u1ed9i dung n\xe0o sau \u0111\xe2y ph\u1ea3n \xe1nh \u0111\xfang t\xecnh h\xecnh Vi\u1ec7t Nam sau Hi\u1ec7p \u0111\u1ecbnh Gi\u01a1nev\u01a1 n\u0103m 1954 v\u1ec1 \u0110\xf4ng D\u01b0\u01a1ng?\nA. \u0110\u1ea5t n\u01b0\u1edbc t\u1ea1m th\u1eddi b\u1ecb chia c\u1eaft l\xe0m hai mi\u1ec1n Nam, B\u1eafc. \nB. Mi\u1ec1n B\u1eafc ch\u01b0a \u0111\u01b0\u1ee3c gi\u1ea3i ph\xf3ng. \nC. Mi\u1ec1n Nam \u0111\xe3 \u0111\u01b0\u1ee3c gi\u1ea3i ph\xf3ng.\nD. C\u1ea3 n\u01b0\u1edbc \u0111\u01b0\u1ee3c gi\u1ea3i ph\xf3ng v\xe0 ti\u1ebfn l\xean x\xe2y d\u1ef1ng ch\u1ee7 ngh\u0129a x\xe3 h\u1ed9i. \n\nC\xe2u 3. Trong \u0110\xf4ng . Xu\xe2n 1953.1954, b\u1ed9 \u0111\u1ed9i ch\u1ee7 l\u1ef1c Vi\u1ec7t Nam m\u1edf chi\u1ebfn d\u1ecbch ti\u1ebfn c\xf4ng qu\xe2n Ph\xe1p \u1edf\xa0\nA. \u0110\xf4ng Kh\xea.    B. Th\xe1i Nguy\xean.     C. Th\u1ecb x\xe3 Lai Ch\xe2u.     D. Qu\u1ea3ng Tr\u1ecb. \n\nPh\u1ea7n 2. T\u1ef0 LU\u1eacN\nC\xe2u 4. (VDC) T\u1eeb n\u0103m 1952 \u0111\u1ebfn n\u0103m 1973, khoa h\u1ecdc . k\u0129 thu\u1eadt v\xe0 c\xf4ng ngh\u1ec7 c\u1ee7a Nh\u1eadt B\u1ea3n ch\u1ee7 y\u1ebfu t\u1eadp trung v\xe0o l\u0129nh v\u1ef1c.\n\n------H\u1ebeT------\nB\u1ea2NG \u0110\xc1P \xc1N\n1A 2B 3C\nH\u01b0\u1edbng d\u1eabn gi\u1ea3i\nC\xe2u 1 (NB): \nPh\u01b0\u01a1ng ph\xe1p: SGK L\u1ecbch s\u1eed 12, trang 76 \u2013 77. \nC\xe1ch gi\u1ea3i: Trong cu\u1ed9c khai th\xe1c thu\u1ed9c \u0111\u1ecba l\u1ea7n th\u1ee9 hai \u1edf \u0110\xf4ng D\u01b0\u01a1ng (1919-1929), th\u1ef1c d\xe2n Ph\xe1p t\u1eadp trung \u0111\u1ea7u t\u01b0 v\xe0o \u0111\u1ed3n \u0111i\u1ec1n cao su. \nC\xe2u 2 (NB): \nPh\u01b0\u01a1ng ph\xe1p: SGK L\u1ecbch s\u1eed 12, trang 157 - 158. \nC\xe1ch gi\u1ea3i: \u0110\u1ea5t n\u01b0\u1edbc t\u1ea1m th\u1eddi b\u1ecb chia c\u1eaft l\xe0m hai mi\u1ec1n Nam, B\u1eafc l\xe0 n\u1ed9i dung ph\u1ea3n \xe1nh \u0111\xfang t\xecnh h\xecnh Vi\u1ec7t Nam sau Hi\u1ec7p \u0111\u1ecbnh Gi\u01a1nev\u01a1 n\u0103m 1954 v\u1ec1 \u0110\xf4ng D\u01b0\u01a1ng. \nC\xe2u 3 (NB): \nPh\u01b0\u01a1ng ph\xe1p: SGK L\u1ecbch s\u1eed 12, trang 147. \nC\xe1ch gi\u1ea3i: Trong \u0110\xf4ng - Xu\xe2n 1953-1954, b\u1ed9 \u0111\u1ed9i ch\u1ee7 l\u1ef1c Vi\u1ec7t Nam m\u1edf chi\u1ebfn d\u1ecbch ti\u1ebfn c\xf4ng qu\xe2n Ph\xe1p \u1edf th\u1ecb x\xe3 Lai Ch\xe2u. \nC\xe2u 4 (NB): \nPh\u01b0\u01a1ng ph\xe1p: SGK L\u1ecbch s\u1eed 12, trang 54. \nC\xe1ch gi\u1ea3i: T\u1eeb n\u0103m 1952 \u0111\u1ebfn n\u0103m 1973, khoa h\u1ecdc - k\u0129 thu\u1eadt v\xe0 c\xf4ng ngh\u1ec7 c\u1ee7a Nh\u1eadt B\u1ea3n ch\u1ee7 y\u1ebfu t\u1eadp trung v\xe0o l\u0129nh v\u1ef1c s\u1ea3n xu\u1ea5t \u1ee9ng d\u1ee5ng d\xe2n d\u1ee5ng.","Ph\u1ea7n 1. TR\u1eaeC NGHI\u1ec6M\nC\xe2u 1.(VD) Trong cu\u1ed9c khai th\xe1c thu\u1ed9c \u0111\u1ecba l\u1ea7n th\u1ee9 hai \u1edf \u0110\xf4ng D\u01b0\u01a1ng 1919.1929, th\u1ef1c d\xe2n Ph\xe1p t\u1eadp trung \u0111\u1ea7u t\u01b0 v\xe0o\nA. Ng\xe0nh ch\u1ebf t\u1ea1o m\xe1y.      B. C\xf4ng nghi\u1ec7p luy\u1ec7n kim.\nC. \u0110\u1ed3n \u0111i\u1ec1n cao su.        D. C\xf4ng nghi\u1ec7p h\xf3a ch\u1ea5t.\n\nL\u1eddi gi\u1ea3i\nPh\u01b0\u01a1ng ph\xe1p: SGK L\u1ecbch s\u1eed 12, trang 76 \u2013 77. \nC\xe1ch gi\u1ea3i: Trong cu\u1ed9c khai th\xe1c thu\u1ed9c \u0111\u1ecba l\u1ea7n th\u1ee9 hai \u1edf \u0110\xf4ng D\u01b0\u01a1ng (1919-1929), th\u1ef1c d\xe2n Ph\xe1p t\u1eadp trung \u0111\u1ea7u t\u01b0 v\xe0o \u0111\u1ed3n \u0111i\u1ec1n cao su. \nCh\u1ecdn C\n\nC\xe2u 2.(NB) N\u1ed9i dung n\xe0o sau \u0111\xe2y ph\u1ea3n \xe1nh \u0111\xfang t\xecnh h\xecnh Vi\u1ec7t Nam sau Hi\u1ec7p \u0111\u1ecbnh Gi\u01a1nev\u01a1 n\u0103m 1954 v\u1ec1 \u0110\xf4ng D\u01b0\u01a1ng?\nA. \u0110\u1ea5t n\u01b0\u1edbc t\u1ea1m th\u1eddi b\u1ecb chia c\u1eaft l\xe0m hai mi\u1ec1n Nam, B\u1eafc. \nB. Mi\u1ec1n B\u1eafc ch\u01b0a \u0111\u01b0\u1ee3c gi\u1ea3i ph\xf3ng. \nC. Mi\u1ec1n Nam \u0111\xe3 \u0111\u01b0\u1ee3c gi\u1ea3i ph\xf3ng.\nD. C\u1ea3 n\u01b0\u1edbc \u0111\u01b0\u1ee3c gi\u1ea3i ph\xf3ng v\xe0 ti\u1ebfn l\xean x\xe2y d\u1ef1ng ch\u1ee7 ngh\u0129a x\xe3 h\u1ed9i. \n\nL\u1eddi gi\u1ea3i\nPh\u01b0\u01a1ng ph\xe1p: SGK L\u1ecbch s\u1eed 12, trang 157 - 158. \nC\xe1ch gi\u1ea3i: \u0110\u1ea5t n\u01b0\u1edbc t\u1ea1m th\u1eddi b\u1ecb chia c\u1eaft l\xe0m hai mi\u1ec1n Nam, B\u1eafc l\xe0 n\u1ed9i dung ph\u1ea3n \xe1nh \u0111\xfang t\xecnh h\xecnh Vi\u1ec7t Nam sau Hi\u1ec7p \u0111\u1ecbnh Gi\u01a1nev\u01a1 n\u0103m 1954 v\u1ec1 \u0110\xf4ng D\u01b0\u01a1ng. \nCh\u1ecdn A\n\nC\xe2u 3. Trong \u0110\xf4ng . Xu\xe2n 1953.1954, b\u1ed9 \u0111\u1ed9i ch\u1ee7 l\u1ef1c Vi\u1ec7t Nam m\u1edf chi\u1ebfn d\u1ecbch ti\u1ebfn c\xf4ng qu\xe2n Ph\xe1p \u1edf\xa0\nA. \u0110\xf4ng Kh\xea.    B. Th\xe1i Nguy\xean.     C. Th\u1ecb x\xe3 Lai Ch\xe2u.     D. Qu\u1ea3ng Tr\u1ecb.\n\nL\u1eddi gi\u1ea3i\nPh\u01b0\u01a1ng ph\xe1p: SGK L\u1ecbch s\u1eed 12, trang 147. \nC\xe1ch gi\u1ea3i: Trong \u0110\xf4ng - Xu\xe2n 1953-1954, b\u1ed9 \u0111\u1ed9i ch\u1ee7 l\u1ef1c Vi\u1ec7t Nam m\u1edf chi\u1ebfn d\u1ecbch ti\u1ebfn c\xf4ng qu\xe2n Ph\xe1p \u1edf th\u1ecb x\xe3 Lai Ch\xe2u. \nCh\u1ecdn C\n\nPh\u1ea7n 2. T\u1ef0 LU\u1eacN\nC\xe2u 4. T\u1eeb n\u0103m 1952 \u0111\u1ebfn n\u0103m 1973, khoa h\u1ecdc . k\u0129 thu\u1eadt v\xe0 c\xf4ng ngh\u1ec7 c\u1ee7a Nh\u1eadt B\u1ea3n ch\u1ee7 y\u1ebfu t\u1eadp trung v\xe0o l\u0129nh v\u1ef1c.\n\nL\u1eddi gi\u1ea3i\nPh\u01b0\u01a1ng ph\xe1p: SGK L\u1ecbch s\u1eed 12, trang 54. \nC\xe1ch gi\u1ea3i: T\u1eeb n\u0103m 1952 \u0111\u1ebfn n\u0103m 1973, khoa h\u1ecdc - k\u0129 thu\u1eadt v\xe0 c\xf4ng ngh\u1ec7 c\u1ee7a Nh\u1eadt B\u1ea3n ch\u1ee7 y\u1ebfu t\u1eadp trung v\xe0o l\u0129nh v\u1ef1c s\u1ea3n xu\u1ea5t \u1ee9ng d\u1ee5ng d\xe2n d\u1ee5ng.","Mark the letter A, B, C, or D on your answer sheet to indicate the underlined part that needs correction in each of the following questions\n\nQuestion 1.(VD) Every [A:member] of the class [B:were] invited [C:to] the party by [D:the form teacher].\n\nQuestion 2.(NB) For [A:such] a demanding job, you [B:will need] [C:qualifications], soft skills and [D:having full commitment].\n\nQuestion 3. In a restaurant, [A:if we] want to call the water, we can raise our hand and [B:wave it] [C:slight to signal] that we need [D:assistance].\n\nQuestion 4. Manufacturers [A:may use] food additives [B:for preserving], to color, to flavor, or to [C:fortify] [D:foods].\n\n\nQuestion 5. The apple ___ the table.\n\nANSWER KEYS\n1b 2d 3a 4b\n5. on | On | ON","Ph\u1ea7n 1. TR\u1eaeC NGHI\u1ec6M\nC\xe2u 1. Trong cu\u1ed9c khai th\xe1c thu\u1ed9c \u0111\u1ecba l\u1ea7n th\u1ee9 hai \u1edf \u0110\xf4ng D\u01b0\u01a1ng 1919.1929, th\u1ef1c d\xe2n Ph\xe1p t\u1eadp trung \u0111\u1ea7u t\u01b0 v\xe0o\n*A. Ng\xe0nh ch\u1ebf t\u1ea1o m\xe1y.      B. C\xf4ng nghi\u1ec7p luy\u1ec7n kim.\nC. \u0110\u1ed3n \u0111i\u1ec1n cao su.        D. C\xf4ng nghi\u1ec7p h\xf3a ch\u1ea5t.\n\nC\xe2u 2. N\u1ed9i dung n\xe0o sau \u0111\xe2y ph\u1ea3n \xe1nh \u0111\xfang t\xecnh h\xecnh Vi\u1ec7t Nam sau Hi\u1ec7p \u0111\u1ecbnh Gi\u01a1nev\u01a1 n\u0103m 1954 v\u1ec1 \u0110\xf4ng D\u01b0\u01a1ng?\nA. \u0110\u1ea5t n\u01b0\u1edbc t\u1ea1m th\u1eddi b\u1ecb chia c\u1eaft l\xe0m hai mi\u1ec1n Nam, B\u1eafc. \n*B. Mi\u1ec1n B\u1eafc ch\u01b0a \u0111\u01b0\u1ee3c gi\u1ea3i ph\xf3ng. \nC. Mi\u1ec1n Nam \u0111\xe3 \u0111\u01b0\u1ee3c gi\u1ea3i ph\xf3ng.\nD. C\u1ea3 n\u01b0\u1edbc \u0111\u01b0\u1ee3c gi\u1ea3i ph\xf3ng v\xe0 ti\u1ebfn l\xean x\xe2y d\u1ef1ng ch\u1ee7 ngh\u0129a x\xe3 h\u1ed9i. \n\nC\xe2u 3. Trong \u0110\xf4ng . Xu\xe2n 1953.1954, b\u1ed9 \u0111\u1ed9i ch\u1ee7 l\u1ef1c Vi\u1ec7t Nam m\u1edf chi\u1ebfn d\u1ecbch ti\u1ebfn c\xf4ng qu\xe2n\nPh\xe1p \u1edf\xa0\nA. \u0110\xf4ng Kh\xea.    B. Th\xe1i Nguy\xean.     *C. Th\u1ecb x\xe3 Lai Ch\xe2u.     D. Qu\u1ea3ng Tr\u1ecb. \n\nPh\u1ea7n 2. T\u1ef0 LU\u1eacN\nC\xe2u 4. T\u1eeb n\u0103m 1952 \u0111\u1ebfn n\u0103m 1973, khoa h\u1ecdc . k\u0129 thu\u1eadt v\xe0 c\xf4ng ngh\u1ec7 c\u1ee7a Nh\u1eadt B\u1ea3n ch\u1ee7 y\u1ebfu t\u1eadp trung v\xe0o l\u0129nh v\u1ef1c."],o.EXAM_FULL_EN=["Question 1.I used to __________ in Germany when I was 7.\nA. to live \nB. live \nC. living \nD. lived\nQuestion 2.She\u2019s used to ____________ late at night.\nA. working \nB. work \nC. to work \nD. worked\nQuestion 3.Mr. Bean has lived in Vietnam for 4 years. He _____________ the hot climate here.\nA. are used to \nB. gets used to \nC. used to \nD. uses to\nQuestion 4.Mai is used to ___________ her house by herself.\nA. clean \nB. cleaning \nC. cleaned \nD. to clean\n------THE END------\nANSWER KEYS\n1B 2A 3B 4B\nInstructions\nQuestion 1. explain for q1\nQuestion 2. explain for q2\nQuestion 3. explain for q3\nQuestion 4. explain for q4","Part 1. Answer from 1 - 2\nQuestion 1.I used to __________ in Germany when I was 7.\nA. to live \nB. live \nC. living \nD. lived\nQuestion 2.She\u2019s used to ____________ late at night.\nA. working \nB. work \nC. to work \nD. worked\nPart 2. Answer from 2 - 4\nQuestion 3.Mr. Bean has lived in Vietnam for 4 years. He _____________ the hot climate here.\nA. are used to \nB. gets used to \nC. used to \nD. uses to\nQuestion 4.Mai is used to ___________ her house by herself.\nA. clean \nB. cleaning \nC. cleaned \nD. to clean\n------THE END------\nANSWER KEYS\n1B 2A 3B 4B\nInstructions\nQuestion 1. explain for q1\nQuestion 2. explain for q2\nQuestion 3. explain for q3\nQuestion 4. explain for q4","Mark the letter A, B, C, or D on your answer sheet to indicate the underlined part that needs correction in each of the following questions\n\nQuestion 1.(VD) Every [A:member] of the class [B:were] invited [C:to] the party by [D:the form teacher].\n\nQuestion 2.(NB) For [A:such] a demanding job, you [B:will need] [C:qualifications], soft skills and [D:having full commitment].\n\nQuestion 3. In a restaurant, [A:if we] want to call the water, we can raise our hand and [B:wave it] [C:slight to signal] that we need [D:assistance].\n\nQuestion 4. Manufacturers [A:may use] food additives [B:for preserving], to color, to flavor, or to [C:fortify] [D:foods].\n\nANSWER KEYS\n1b 2d 3a 4b","Question 1.I used to __________ in Germany when I was 7.\n*A. to live \nB. live \nC. living \nD. lived\nQuestion 2.She\u2019s used to ____________ late at night.\nA. working \n*B. work \nC. to work \nD. worked\nQuestion 3.Mr. Bean has lived in Vietnam for 4 years. He _____________ the hot climate here.\nA. are used to \nB. gets used to \n*C. used to \nD. uses to\nQuestion 4.Mai is used to ___________ her house by herself.\nA. clean \nB. cleaning \nC. cleaned \n*D. to clean\n------THE END------\nInstructions\nQuestion 1. explain for q1\nQuestion 2. explain for q2\nQuestion 3. explain for q3\nQuestion 4. explain for q4"],o})();var Ke=b(15043);let ba=(()=>{class o{constructor(e){this.cdnService=e}renderContent(e){const n=JSON.parse(e.questionContent||"{}");if("image"==(e.isImage&&n[0].url?"image":"text"))return`<img width="700" src="${this.cdnService.getRawCdnLink(n[0].url)}">`;{const a=/@\[\][^@\[\]]+@\[\]/g;let r=`<p>${n[0].content.replace(a,"[h\xecnh]")}</p>`;return JSON.parse(e.answerConfig||"[]").forEach(c=>{r+=`<p><b>${c.key}.</b>${c.content.replace(a,"[h\xecnh]")}</p>`}),r}}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(Ke.U))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var so=b(92340),zn=b(43147);let wa=(()=>{class o{constructor(e){this.baseApiService=e,this.apiLink=so.N.print_api+"/convert_img"}convertAction(e){return new Promise((n,i)=>{this.baseApiService.commonHttp(this.apiLink,{"Content-Type":"application/json"},e).subscribe(a=>{a&&a.success?n({id:e.id,base64:a.data}):i(new Error("No load image out"))})})}convertImageService(e){return new Promise((n,i)=>{const a=new qt.Q(10);e.forEach(r=>{a.addTask(this,this.convertAction,[r])}),a.start().then(r=>{0==r.errs.length?n(r.datas):i(new Error("L\u1ed7i convert"))})})}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(zn._))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Mn=b(12813),Ot=b(74693),Oi=b(60590),vt=b(35018),Be=b(34782);let bn=(()=>{class o{constructor(e,n){this.browserStorageService=e,this.commonService=n,this.data={}}setMode(e){this.browserStorageService.saveSimpleStorage("__editor:mode_open",e)}getMode(){var e=this.browserStorageService.getSimpleStorage("__editor:mode_open")||"editor";return this.browserStorageService.removeSimpleStorage("__editor:mode_open"),e}setFileProcess(e){this.file=e}getFirstFile(){let e=this.file;return this.file=void 0,e}setOutputData(e){this.data=e}getOutputData(){return this.data}redirectToConfig(e){this.data.homework&&e.showHomework(),(this.data.exam||this.data.examOffline)&&e.showExam()}setMatrixData(e,n){n?this.matrix=e:this.browserStorageService.saveSimpleStorage("__editor:matrix-data",JSON.stringify(e))}getMatrixData(){var e=this.browserStorageService.getSimpleStorage("__editor:matrix-data");return this.browserStorageService.removeSimpleStorage("__editor:matrix-data"),e?this.commonService.castJsonToObj(e):this.matrix}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(Be.z),t.LFG(vt.v))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var ai=b(88386);let ro=(()=>{class o{constructor(e,n){this.commonService=e,this.apiUploadService=n,this.sizeDefaultCanvas=1100,this.actionRunAfterConvert=[],this.imageMaps=[],this.pattern_base64=/data:image[^"'\\]+/i,this.pattern_image=/<img[^>]+data:image[^>]+>/g,this.taskConvertBase64ToCanvas=new qt.Q(50,{function:(i,a)=>{this.callbackBase64ToCanvas&&this.callbackBase64ToCanvas(i,a)}}),this.taskUploadImage=new qt.Q(3,{function:(i,a)=>{this.callbackUploadImage&&this.callbackUploadImage(i,a)}})}convertQuestions(e,n,i){return new Promise(a=>{e.forEach(r=>{var l,c,_,d;const m=this.commonService.willDeleteParseJson(r.answerConfig||"[]");!(null===(l=r.questionContent)||void 0===l)&&l.includes("<img ")&&this.replaceImageCdnInContent(r,"questionContent"),!(null===(c=r.questionText)||void 0===c)&&c.includes("<img ")&&this.replaceImageCdnInContent(r,"questionText"),!(null===(_=r.answerMedia)||void 0===_)&&_.includes("<img ")&&this.replaceImageCdnInContent(r,"answerMedia"),!(null===(d=r.mediaMeta)||void 0===d)&&d.includes("<img ")&&this.replaceImageCdnInContent(r,"mediaMeta"),m.forEach(p=>{p.content.includes("<img ")&&this.replaceImageCdnInContent(p,"content")}),this.actionRunAfterConvert.push(()=>{r.answerConfig=JSON.stringify(m)})}),this.imageMaps.forEach(r=>{this.taskConvertBase64ToCanvas.addTask(this,this.startConvertCanvas,[r])}),this.taskConvertBase64ToCanvas.start().then(r=>{if(r.errs.length>0)i(r.errs,void 0);else{let c=0;const _=[],d=()=>{const m=document.createElement("canvas");m.width=this.sizeDefaultCanvas,m.height=this.sizeDefaultCanvas;const p=m.getContext("2d");p&&(p.fillStyle="white",p.fillRect(0,0,this.sizeDefaultCanvas,this.sizeDefaultCanvas)),_.push({cdn:"",cX:0,cY:0,canvas:m,imgs:[]})};d(),r.datas.forEach((m,p)=>{var w=_[_.length-1];w.cX+m.canvas.width+4>this.sizeDefaultCanvas?(w.cX=4,w.cY+=c+4,c=0):w.cX+=4,w.cY+m.canvas.height>this.sizeDefaultCanvas&&(d(),w=_[_.length-1]);var C=w.canvas.getContext("2d");w.imgs.push({x:w.cX,y:w.cY,width:m.canvas.width,height:m.canvas.height,index:p}),null==C||C.drawImage(m.canvas,0,0,m.canvas.width,m.canvas.height,w.cX,w.cY,m.canvas.width,m.canvas.height),w.cX+=m.canvas.width,c=c<m.canvas.height?m.canvas.height:c}),_[0].imgs.length>0&&_.forEach(m=>{this.taskUploadImage.addTask(this,this.startUploadFile,[m])}),this.taskUploadImage.start().then(m=>{if(m.errs.length>0)i(r.errs,void 0);else{let p=!0;m.datas.forEach(w=>{w.imgs.forEach(C=>{const A=r.datas[C.index];if(A){const M={link:w.cdn,data:{x:C.x,y:C.y,width:C.width,height:C.height}};A.objs.forEach(D=>{if(D[A.path])if(this.commonService.isJson(D[A.path])){const U=this.commonService.willDeleteParseJson(D[A.path]);Object.prototype.hasOwnProperty.call(U,"renderedStr")?(U.renderedStr=U.renderedStr.replace(A.base,`@[]${JSON.stringify(M)}@[]`),D[A.path]=JSON.stringify(U)):D[A.path]=D[A.path].replace(A.base,`@[]${JSON.stringify(M)}@[]`)}else D[A.path]=D[A.path].replace(A.base,`@[]${JSON.stringify(M)}@[]`);else p=!1})}})}),p?(this.actionRunAfterConvert.forEach(w=>{w()}),e.forEach((w,C)=>{let A=this.commonService.willDeleteParseJson(w.mediaMeta||"{}"),M=n[C];const D={id:0,name:w.name,extension:"text",content:w.questionContent,groupContent:A.renderedStr,metaData:{isFixAns:Number(w.isFixAns),forcedFixAns:!1,groupType:w.groupType?Number(w.groupType):void 0}};M&&(D.vMetaEditor=M.meta),w.questionContent=JSON.stringify([D])}),a()):i(r.errs,void 0,!0)}})}})})}replaceImageCdnInContent(e,n){var i=e[n];if(this.commonService.isJson(e[n])){const l=this.commonService.willDeleteParseJson(e[n]);Object.prototype.hasOwnProperty.call(l,"renderedStr")&&(i=l.renderedStr)}let a=i.matchAll(this.pattern_image);for(;;){let l=a.next();if(l.done)break;let c=l.value[0];var r=this.imageMaps.findIndex(_=>_.base===c&&_.path===n);-1===r?this.imageMaps.push({base:c,cdn:"",data:null,objs:[e],path:n,canvas:document.createElement("canvas")}):this.imageMaps[r].objs.push(e)}}startConvertCanvas(e){return new Promise((n,i)=>{const a=new Image;a.crossOrigin="anonymous",a.onload=()=>{let l=1;a.width>this.sizeDefaultCanvas&&(l=a.width/this.sizeDefaultCanvas),e.canvas.width=a.width*l,e.canvas.height=a.height*l;const c=e.canvas.getContext("2d");null==c||c.drawImage(a,0,0,a.width,a.height,0,0,e.canvas.width,e.canvas.height),n(e)},a.onerror=()=>{i(new Error("l\u1ed7i load \u1ea3nh"))};let r=this.pattern_base64.exec(e.base);null!=r?a.src=r[0]:i(new Error("l\u1ed7i regex"))})}startUploadFile(e){return new Promise((n,i)=>{const a=this.dataURLtoFile(e.canvas.toDataURL("image/png",1));(0,Ut.hv)(a).then(r=>{this.apiUploadService.uploadToCdnProgressForExamQuestionContent(r).subscribe(l=>{l.type!=Te.dt.UploadProgress&&(1==l.success&&l.data?n(Object.assign(Object.assign({},e),{cdn:l.data.url||""})):i(new Error("lang_auto_khong_upload_duoc_anh_vui_long_thu_lai_sau_loi[SPLIT_LANG] [SPLIT_LANG]"+l.message)))})})})}dataURLtoFile(e){let n=this.getFileName(e);for(var i=e.split(","),a=i[0].match(/:(.*?);/),r=atob(i[1]),l=r.length,c=new Uint8Array(l);l--;)c[l]=r.charCodeAt(l);return new File([c],n,{type:a&&a.length>0?a[1]:"png"})}getFileName(e){var n=e.split("").reverse().join(""),i=n.indexOf(";"),a=n.indexOf("/",i);return n.substring(i,a).split("").reverse().join("")}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(vt.v),t.LFG(Mn.$))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const Ta=["popupConfirm"],Ca=["mobileEditor"],Aa=["popupOnlyImageEditor"];function ya(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",27)(2,"button",28),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw(4);return t.KtG(!!r.attachFiles&&r.attachFiles.splice(a,1))}),t.TgZ(3,"mat-icon",29),t._uU(4,"close"),t.qZA()(),t.TgZ(5,"span",30),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(4);return t.KtG(r.onShowFile(a,-1))}),t.TgZ(6,"span",31),t._uU(7),t.qZA()()()()}if(2&o){const e=s.$implicit;t.xp6(6),t.Q6J("title",e.name),t.xp6(1),t.Oqu(e.name)}}function ka(o,s){if(1&o&&(t.TgZ(0,"div",24)(1,"div",25),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.YNc(4,ya,8,2,"div",26),t.qZA()),2&o){const e=t.oxw(3);t.xp6(2),t.hij(" ",t.lcZ(3,2,"lang_auto_danh_sach_file_dinh_kem")+":"," "),t.xp6(2),t.Q6J("ngForOf",e.attachFiles)}}function Oa(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",32)(1,"question-dropper",33),t.NdJ("onDropFile",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.onDropFile(i))}),t.qZA()()}}function Sa(o,s){if(1&o&&(t.TgZ(0,"div",18)(1,"div",19)(2,"div",20),t._UZ(3,"div",21),t.ALo(4,"safeContentQuestion"),t.ALo(5,"mathJaxContent"),t.YNc(6,ka,5,4,"div",22),t.YNc(7,Oa,2,0,"div",23),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(3),t.Q6J("innerHTML",t.lcZ(4,3,t.lcZ(5,5,e.text)),t.oJD),t.xp6(3),t.Q6J("ngIf",e.attachFiles.length>0),t.xp6(1),t.Q6J("ngIf",0==e.editQuestId)}}function Ea(o,s){if(1&o&&(t.TgZ(0,"mat-icon",43),t.ALo(1,"mytranslate"),t.ALo(2,"mytranslate"),t._uU(3," push_pin"),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.s9C("matTooltip",e.isFixGroup?t.lcZ(1,1,"lang_auto_cau_hoi_trong_nhom_dang_duoc_co_dinh"):t.lcZ(2,3,"lang_auto_dap_an_trong_cau_hoi_dang_duoc_co_dinh"))}}function Ia(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",44)(1,"span",45),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"span",46),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw(2);return t.KtG(a.setFixGroup(i))}),t._uU(5),t.ALo(6,"mytranslate"),t.ALo(7,"mytranslate"),t.ALo(8,"mytranslate"),t.qZA()()}if(2&o){const e=t.oxw(2).$implicit;t.xp6(2),t.Oqu(t.lcZ(3,3,"tieu_de_nhom")),t.xp6(3),t.AsE(" ",e.isFixGroup?t.lcZ(6,5,"lang_auto_bo_co_dinh"):t.lcZ(7,7,"lang_auto_co_dinh")," ",t.lcZ(8,9,"lang_auto_cau_trong_nhom"),"")}}function Za(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",47)(1,"app-quest-header",48),t.NdJ("onChangeQuest",function(i){t.CHM(e);const a=t.oxw(2).index,r=t.oxw(2);return t.KtG(r.onChangeQuest(i,a))})("onApplyAllTag",function(i){t.CHM(e);const a=t.oxw(2).index,r=t.oxw(2);return t.KtG(r.onApplyAllTag(i,a))})("onError",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.commonService.snackError(i))})("onLabelClick",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.editorFocus(i))})("onHotKeyPointSync",function(i){t.CHM(e);const a=t.oxw(2).index,r=t.oxw(2);return t.KtG(r.setPointBelow(i,a))})("onExtraInfo",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.setExtra(i))})("onCut",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw(2);return t.KtG(a.onCut(i))})("onDel",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw(2);return t.KtG(a.onDel(i))})("onCopy",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw(2);return t.KtG(a.onCopy(i))}),t.qZA()()}if(2&o){const e=t.oxw(2).$implicit,n=t.oxw(2);t.xp6(1),t.Q6J("q",e)("notOnlyQuestEdit",!n.editQuestId)("questionTags",n.questionTags)}}function Ma(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.label)}}function Pa(o,s){if(1&o&&(t.TgZ(0,"span"),t.YNc(1,Ma,2,1,"span",51),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Q6J("ngIf",e.isCorrect)}}function La(o,s){if(1&o&&(t.TgZ(0,"div")(1,"span"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.YNc(4,Pa,2,1,"span",26),t.qZA()),2&o){const e=t.oxw(4).$implicit;t.xp6(2),t.Oqu(t.lcZ(3,2,"lang_auto_dap_an_dung")+":"),t.xp6(2),t.Q6J("ngForOf",e.quest.answers)}}function Na(o,s){if(1&o&&(t.TgZ(0,"span",57),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e)}}function Da(o,s){if(1&o&&(t.TgZ(0,"div",54)(1,"span",55),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.YNc(4,Na,2,1,"span",56),t.qZA()),2&o){const e=t.oxw(4).$implicit;t.xp6(2),t.Oqu(t.lcZ(3,2,"lang_auto_dap_an")+":"),t.xp6(2),t.Q6J("ngForOf",e.strAns)}}function ja(o,s){1&o&&(t.TgZ(0,"span",62),t._UZ(1,"div",63)(2,"div",64),t.qZA())}const lo=function(o){return{"an-true":o}};function qa(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",58),t.YNc(1,ja,3,0,"span",59),t.TgZ(2,"div",60),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(4).$implicit,l=t.oxw(2);return t.KtG(l.setCorrectAns(r,a.ans))}),t.ALo(3,"mytranslate"),t._uU(4),t.qZA(),t.TgZ(5,"div",61),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(6);return t.KtG(r.editorFocus(a.ans.parts))}),t.ALo(6,"safeContentQuestion"),t.ALo(7,"mathJaxContent"),t.qZA()()}if(2&o){const e=s.$implicit,n=t.oxw(6);t.xp6(1),t.Q6J("ngIf",e.ans.isCorrect),t.xp6(1),t.s9C("matTooltip",n.showTooltip?t.lcZ(3,7,"lang_auto_cick_de_chon_lam_dap_an_dung"):void 0),t.Q6J("matTooltipPosition","right")("ngClass",t.VKq(13,lo,e.ans.isCorrect)),t.xp6(2),t.hij(" ",e.ans.label,""),t.xp6(1),t.Q6J("innerHTML",t.lcZ(6,9,t.lcZ(7,11,e.renderedStr)),t.oJD)("ngClass",t.VKq(15,lo,e.ans.isCorrect))}}function Qa(o,s){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,La,5,4,"div",51),t.YNc(2,Da,5,4,"div",52),t.YNc(3,qa,8,17,"div",53),t.qZA()),2&o){const e=t.oxw(3).$implicit;t.Gre("box-ans quest-ans-ver-",e.v,""),t.xp6(1),t.Q6J("ngIf","pdf-1-0"==e.v),t.xp6(1),t.Q6J("ngIf",4==e.type&&e.strAns),t.xp6(1),t.Q6J("ngForOf",e.answers)}}function Ua(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",65)(2,"span"),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.TgZ(5,"div",66),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3).$implicit,a=t.oxw(2);return t.KtG(a.editorFocus(i.quest.help))}),t.ALo(6,"safeContentQuestion"),t.ALo(7,"mathJaxContent"),t.qZA()()}if(2&o){const e=t.oxw(3).$implicit;t.Gre("box-help quest-help-ver-",e.v,""),t.xp6(3),t.Oqu(t.lcZ(4,5,"lang_auto_huong_dan_giai_upper")),t.xp6(2),t.Q6J("innerHTML",t.lcZ(6,7,t.lcZ(7,9,e.helpRenderedStr)),t.oJD)}}function Fa(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",49)(1,"div",50),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw(2);return t.KtG(a.editorFocus(i.quest.parts))}),t.ALo(2,"safeContentQuestion"),t.ALo(3,"mathJaxContent"),t.qZA(),t.YNc(4,Qa,4,6,"div",17),t.YNc(5,Ua,8,11,"div",17),t.qZA()}if(2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.Gre("tex2jax_process box-content quest-ver-",e.v,""),t.Q6J("innerHTML",t.lcZ(2,6,t.lcZ(3,8,e.renderedStr)),t.oJD),t.xp6(3),t.Q6J("ngIf",!e.quest.isGroup),t.xp6(1),t.Q6J("ngIf",e.helpRenderedStr)}}function Ra(o,s){if(1&o&&(t._UZ(0,"div",67),t.ALo(1,"safeContentQuestion")),2&o){const e=t.oxw(2).$implicit;t.Q6J("innerHTML",t.lcZ(1,1,e.err),t.oJD)}}function Ba(o,s){if(1&o&&(t.TgZ(0,"div",19),t.YNc(1,Ea,4,5,"mat-icon",37),t._UZ(2,"div",38),t.ALo(3,"safeContentQuestion"),t.YNc(4,Ia,9,11,"div",39),t.YNc(5,Za,2,3,"div",40),t.TgZ(6,"div",20)(7,"div"),t.YNc(8,Fa,6,10,"div",41),t.YNc(9,Ra,2,3,"div",42),t.qZA()()()),2&o){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.isFixGroup||e.quest.isFixAns),t.xp6(1),t.Q6J("innerHTML",t.lcZ(3,6,n.errorQuestionView.makeErr(e,n.lstQuest)),t.oJD),t.xp6(2),t.Q6J("ngIf",e.quest.isGroup),t.xp6(1),t.Q6J("ngIf",!e.quest.isGroup),t.xp6(3),t.Q6J("ngIf",!e.err),t.xp6(1),t.Q6J("ngIf",e.err)}}function Ja(o,s){1&o&&t._UZ(0,"div",68)}const Ha=function(o){return{height:o}};function za(o,s){if(1&o&&(t.TgZ(0,"div",34),t.YNc(1,Ba,10,8,"div",35),t.YNc(2,Ja,1,0,"div",36),t.qZA()),2&o){const e=s.$implicit,n=s.index,i=t.oxw(2);t.hYB("id","quest",e.quest.isGroup?"-g":"","-",e.quest.label,""),t.Q6J("ngStyle",t.VKq(6,Ha,i.lstQuest.length<i.maxQuestEnableLazy?"auto":e.lazyQuestView&&e.lazyQuestView.curHeight?e.lazyQuestView.curHeight:"200px")),t.uIk("data-idx-quest",n),t.xp6(1),t.Q6J("ngIf",i.lstQuest.length<i.maxQuestEnableLazy||(null==e.lazyQuestView?null:e.lazyQuestView.show)),t.xp6(1),t.Q6J("ngIf",!(i.lstQuest.length<i.maxQuestEnableLazy||null!=e.lazyQuestView&&e.lazyQuestView.show))}}function Ya(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",72),t.NdJ("click",function(){t.CHM(e),t.oxw(3);const i=t.MAs(6);return t.KtG(i.click())}),t.O4$(),t.TgZ(1,"svg",73),t._UZ(2,"path",79)(3,"polyline",80)(4,"line",81),t.qZA(),t.kcU(),t.TgZ(5,"span",75),t._uU(6,"Upload File"),t.qZA()()}}function Ga(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",72),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.openLibrary())}),t.O4$(),t.TgZ(1,"svg",73),t._UZ(2,"line",82)(3,"line",83),t.qZA(),t.kcU(),t.TgZ(4,"span",75),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_auto_chon_tu_ngan_hang")," "))}function $a(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",72),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.saveLocal())}),t.O4$(),t.TgZ(1,"svg",73),t._UZ(2,"path",79)(3,"polyline",84)(4,"line",85),t.qZA(),t.kcU(),t.TgZ(5,"span",75),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()}2&o&&(t.xp6(6),t.hij(" ",t.lcZ(7,1,"lang_auto_luu_ve_may")," "))}function Wa(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",86)(1,"button",87),t.O4$(),t.TgZ(2,"svg",88),t._UZ(3,"circle",89)(4,"circle",90)(5,"circle",91),t.qZA()(),t.kcU(),t.TgZ(6,"mat-menu",null,92)(8,"div",93)(9,"ul",94)(10,"li")(11,"a",95),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.randomAllAgain())}),t.O4$(),t.TgZ(12,"svg",96),t._UZ(13,"path",97)(14,"path",98)(15,"path",99)(16,"path",100),t.qZA(),t.kcU(),t.TgZ(17,"span"),t._uU(18),t.ALo(19,"mytranslate"),t.qZA()()(),t.TgZ(20,"li")(21,"a",95),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.format())}),t.O4$(),t.TgZ(22,"svg",96),t._UZ(23,"rect",101)(24,"rect",102)(25,"path",103),t.qZA(),t.kcU(),t.TgZ(26,"span"),t._uU(27),t.ALo(28,"mytranslate"),t.qZA()()()()()()()}if(2&o){const e=t.MAs(7);t.xp6(1),t.Q6J("matMenuTriggerFor",e),t.xp6(17),t.hij(" ",t.lcZ(19,3,"lang_auto_lay_ngau_nhien_lai_toan_bo")," "),t.xp6(9),t.hij(" ",t.lcZ(28,5,"lang_auto_format")," ")}}function Ka(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",104)(1,"div",105),t._uU(2),t.ALo(3,"mytranslate"),t.TgZ(4,"a",106),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.loadExample(1,i.commonService.getCurrentLang()))}),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t._uU(7," | "),t.TgZ(8,"a",106),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.loadExample(2,i.commonService.getCurrentLang()))}),t._uU(9),t.ALo(10,"mytranslate"),t.qZA(),t._uU(11," | "),t.TgZ(12,"a",106),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.loadExample(3,i.commonService.getCurrentLang()))}),t._uU(13),t.ALo(14,"mytranslate"),t.qZA(),t._uU(15," | "),t.TgZ(16,"a",106),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.loadExample(4,i.commonService.getCurrentLang()))}),t._uU(17),t.ALo(18,"mytranslate"),t.qZA()()()}2&o&&(t.xp6(2),t.hij("",t.lcZ(3,5,"lang_auto_noi_dung_mau")+": "," "),t.xp6(3),t.Oqu(t.lcZ(6,7,"lang_auto_mau")+" 1"),t.xp6(4),t.Oqu(t.lcZ(10,9,"lang_auto_mau")+" 2"),t.xp6(4),t.Oqu(t.lcZ(14,11,"lang_auto_mau")+" 3"),t.xp6(4),t.Oqu(t.lcZ(18,13,"lang_auto_mau")+" 4"))}const Va=function(o){return{height:o}};function Xa(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",69)(2,"div",70),t.YNc(3,Ya,7,0,"div",71),t.YNc(4,Ga,7,3,"div",71),t.TgZ(5,"div",72),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.openMathEditor())}),t.O4$(),t.TgZ(6,"svg",73),t._UZ(7,"path",74),t.qZA(),t.kcU(),t.TgZ(8,"span",75),t._uU(9),t.ALo(10,"mytranslate"),t.qZA()(),t.YNc(11,$a,8,3,"div",71),t.YNc(12,Wa,29,7,"div",76),t.qZA()(),t.TgZ(13,"azt-monaco-editor",77),t.NdJ("onStartProcessFile",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.processFile(i))})("onInit",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.onEditorInitComplete(i))}),t.qZA(),t.YNc(14,Ka,19,15,"div",78),t.qZA()}if(2&o){const e=t.oxw(2);t.Gre("col-editor tex2jax_ignore ",e.isMobile?"azt-order-1":"",""),t.xp6(3),t.Q6J("ngIf",0==e.editQuestId),t.xp6(1),t.Q6J("ngIf",0==e.editQuestId),t.xp6(5),t.hij(" ",t.lcZ(10,13,"lang_auto_chen_cong_thuc")," "),t.xp6(2),t.Q6J("ngIf",0==e.editQuestId),t.xp6(1),t.Q6J("ngIf",0==e.editQuestId),t.xp6(1),t.Akn(t.VKq(15,Va,e.conf.heightContent+"px")),t.Q6J("config",e.aztLangConfig)("editorApiService",e.editorApiService),t.xp6(1),t.Q6J("ngIf",0==e.editQuestId)}}function ts(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",12)(1,"div",13),t.NdJ("scroll",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onScrollQuest())}),t.YNc(2,Sa,8,7,"div",14),t.YNc(3,za,3,8,"div",15),t._UZ(4,"div",16),t.qZA(),t.YNc(5,Xa,15,17,"div",17),t.qZA()}if(2&o){const e=t.oxw();t.xp6(1),t.Gre("col-questions box bg-slate-100 dark:bg-darkmode-400 rounded-none ",e.isMobile?"azt-order-2":"",""),t.xp6(1),t.Q6J("ngIf",""!=e.text||e.attachFiles.length>0),t.xp6(1),t.Q6J("ngForOf",e.lstQuest),t.xp6(2),t.Q6J("ngIf",""!=e.aztLangConfig)}}function es(o,s){if(1&o&&(t.TgZ(0,"div",107)(1,"div",108)(2,"div",109)(3,"span"),t._UZ(4,"span",110),t._uU(5,"\xa0"),t.qZA()(),t.TgZ(6,"div",111),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()()()),2&o){const e=t.oxw();t.xp6(7),t.Oqu(t.lcZ(8,1,e.conf.logConfig.msg))}}function ns(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",112)(1,"app-test-finder",113),t.NdJ("closeTestFinder",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.closeLibrary(i))}),t.qZA()()}if(2&o){const e=t.oxw();let n;t.xp6(1),t.Q6J("isFirstTime",null!==(n=e.conf.isFirstTime)&&void 0!==n&&n)}}function is(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"mathtype-editor",114),t.NdJ("onClose",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.conf.mathEditor.show=!1)})("onInsertLatex",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onInsertLatex(i))}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("inp",e.conf.mathEditor.latex)}}function os(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"only-image-editor",115),t.NdJ("onClose",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.conf.imageEditor.show=!1)})("onPushImage",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onPushImageAction(i))}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("el_target",e.conf.imageEditor.el)}}function as(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",116)(1,"main-config-homework",117),t.NdJ("onBack",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.conf.showEditor())}),t.qZA()()}}function ss(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",118)(1,"app-info-general",117),t.NdJ("onBack",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.conf.showEditor())}),t.qZA()()}}const rs=function(o){return{hidden:o}};class ls{constructor(s){this.commonService=s,this.check=!1}makeErr(s,e,n,i){if(!this.check)return;if(!s.quest.isGroup&&(!s.point||s.point<=0)&&!i){let r=this.commonService.myTranslateIntance("lang_auto_vui_long_nhap_diem_cho_cau_hoi"),l=this.commonService.myTranslateIntance("lang_auto_nay");return n?r:`<span class="quest-err">${r} ${l}</span>`}let a=s.answers.filter(r=>r.ans.isCorrect).length>0;if(1==s.type&&!a){let r=this.commonService.myTranslateIntance("lang_auto_vui_long_nhap_dap_an_cho_cau_hoi"),l=this.commonService.myTranslateIntance("lang_auto_nay");return n?r:`<span class="quest-err">${r} ${l}</span>`}}makeFirstErr(s,e){this.check=!0;for(const n of s)if(void 0!==this.makeErr(n,s,void 0,e))return n}isFullNoPoint(s){return s.filter(e=>!e.point).length===s.length}}let Si=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_,d,m,p,w,C,A){super(m),this.questionHelper=e,this.editorCommonService=n,this.apiUploadService=i,this.infoService=a,this.documentService=r,this.examService=l,this.cdnService=c,this.activeRoute=_,this.store=d,this.commonService=m,this.editorOutputDataService=p,this.userService=w,this.questionSaveService=C,this.questionService=A,this.images=[],this.editedImages=new Map,this.errorQuestionView=new ls(this.commonService),this.MATH_PAT=/\[!m:\$([^\$\]]+)\$\]/g,this.title=new h.p4,this.lstQuest=[],this.text="",this.attachFiles=[],this.aztLangConfig="",this.renderCache=new Map,this.apiCallbackCache=new Map,this.apiDataCache=new Map,this.fillQuestCache=new Map,this.loadingManager=new Map,this.errs=[],this.curMathId=1,this.curExtraId=1,this.mathMap=new Map,this.extraMap=new Map,this.showTooltip=!0,this.questionTags=[],this.mapEventElement=[],this.configRenderService=new Ee.B,this.maxQuestEnableLazy=20,this.isMobile=!1,this.lastMatrixHash="",this.editQuestId=0,this.conf=new Rt(this.editorOutputDataService,this.commonService),this.editorApiService=new ln(e,i,r,l,A),this.fileParser=new St.uD,this.setupEvent();let M=this.commonService.myTranslateIntance("lang_auto_dang_xu_ly_hinh_anh_cho_de_thi");this.questionSaveService.callbackBase64ToCanvas=(D,q)=>{this.conf.logConfig.msg=`${M} ${Math.floor(D/q*100*.7)}%`},this.questionSaveService.callbackUploadImage=(D,q)=>{this.conf.logConfig.msg=`${M} ${Math.floor(D/q*100*.3)+70}%`}}convertPartItem(e){var n,i;return 0===e.length?"":/^\[@((.)+)\]/g.test(null!==(n=e[0].text)&&void 0!==n?n:"")?e[0].lineIdx+"_____"+(null===(i=e[0].text)||void 0===i?void 0:i.split("]=>")[0])+"]":""}convertQuestion(e,n,i,a,r){return new Promise(l=>{var c,_,d,m;const p=[];i.answers.forEach(M=>{p.push({key:M.ans.label,content:M.renderedStr})});let w=i.answers.find(M=>!0===M.ans.isCorrect);const A={name:this.commonService.myTranslateIntance("lang_auto_cau_hoi_tu_editor")+" "+(a+1),answerType:i.type,categoryId:0,questionContent:i.renderedStr,questionText:i.renderedStr,answerConfig:JSON.stringify(p),groupId:r,answerResult:w?JSON.stringify([w.ans.label]):i.strAns&&(null===(c=i.strAns)||void 0===c?void 0:c.length)>0?JSON.stringify(i.strAns):void 0,totalQuestion:this.lstQuest.length,version:"4",isFixAns:i.quest.isFixAns?1:0,isImage:1,answerMedia:i.helpRenderedStr,mediaMeta:JSON.stringify(e),groupType:null!=e&&e.isFixGroup?"1":void 0,tags:i.tag&&i.tag.length?i.tag.map(M=>{var D;return null!==(D=M.code)&&void 0!==D?D:""}):[],__path:this.convertPartItem(i.quest.parts)};null===(d=null===(_=n.exam)||void 0===_?void 0:_.questionObj.listQuestions)||void 0===d||d.push(A),null===(m=n.exam)||void 0===m||m.rootQuests.push(i),i.audio&&(0,Ut.F0)(i.audio.type)?i.attachments?(A.attachments=i.attachments,l()):this.apiUploadService.uploadToCdnProgressForTestbankQuestionAttachment(i.audio).subscribe(M=>{M.type!=Te.dt.UploadProgress&&(1==M.success?A.attachments=JSON.stringify([M.data]):this.showErrorSnack("lang_auto_upload_file_audio_that_bai"),l())}):l()})}uploadAttHomeworkFile(e,n,i){return new Promise(a=>{this.apiUploadService.uploadToCdnForHomework(i).subscribe(r=>{1==r.success&&r.data&&(n.push(r.data),n.length===this.attachFiles.length&&e.homework&&(e.homework.files=JSON.stringify(n)),a())})})}uploadFileProcess(e){return new Promise(n=>{this.saveFileProcess?this.apiUploadService.uploadToCdnProgressForTestbankDocx(this.saveFileProcess).subscribe(i=>{var a,r;i.type!=Te.dt.UploadProgress&&(1==i.success&&e.exam&&(e.exam.examObj.cdnExamFile=null!==(r=null===(a=i.data)||void 0===a?void 0:a.url)&&void 0!==r?r:""),n())}):n()})}saveAction(){var e;if(this.errs.length>0){let n=this.commonService.myTranslateIntance("lang_auto_line"),i=this.errs.map(a=>a.split("|")).map(a=>`${n} ${a[0]}: ${a[1]}`).join(". ");this.commonService.snackError(i)}else{if(this.lstQuest.length>0){const n=this.errorQuestionView.isFullNoPoint(this.lstQuest),i=this.errorQuestionView.makeFirstErr(this.lstQuest,n);if(null!=i)return this.commonService.snackError(this.errorQuestionView.makeErr(i,this.lstQuest,!0,n)||""),void this.revealQuest(i.quest.label+"")}this.loadingManager.size>0?null===(e=this.popupConfirm)||void 0===e||e.startConfirm("lang_auto_msg_confirm_watting_loading").then(n=>{n&&(this.stopAudio(),this.save())}):(this.stopAudio(),this.save())}}parseAzt(e){let n=this;var i=new FileReader;i.readAsText(e,"UTF-8"),i.onload=a=>{var r,l;let c=null!==(r=i.result)&&void 0!==r?r:"",_=JSON.parse(c);if(!_.text)return n.showErrorSnack("lang_auto_file_khong_dung_dinh_dang"),this.conf.logConfig.status=!1,void(this.conf.logConfig.msg=void 0);n.images=_.imgs,n.mathMap=new Map;for(let d of _.maths)n.mathMap.set(d[0],d[1]);n.extraMap=new Map;for(let d of _.infos)n.extraMap.set(d[0],d[1]);null===(l=n.aztEditor)||void 0===l||l._editor.setValue(_.text),this.conf.logConfig.status=!1,this.conf.logConfig.msg=void 0},i.onerror=a=>{n.showErrorSnack("lang_auto_file_khong_dung_dinh_dang"),this.conf.logConfig.status=!1,this.conf.logConfig.msg=void 0}}saveCdn(e){return new Promise(n=>{var i;if(null!==(i=e.exam)&&void 0!==i&&i.examObj){let a=new Date,r=`user-${this.userService.getUserObj().id}-de-azota-${a.getDate()}${a.getMonth()+1}${a.getFullYear()}-${a.getTime()}.azt`;const l=this.generateFileAzt();if(l){const c=new File([l],r,{type:"text/plain"});this.apiUploadService.uploadToCdnForExamEditor(c).subscribe(_=>{var d,m;_.type!=Te.dt.UploadProgress&&(1==_.success&&_.data&&!(null===(d=e.exam)||void 0===d)&&d.examObj&&(e.exam.examObj.cdnEditorFile=null!==(m=_.data.url)&&void 0!==m?m:""),n())})}else n()}else n()})}saveLocal(){let e=new Date,n=`de-azota-${e.getDate()}${e.getMonth()+1}${e.getFullYear()}-${e.getTime()}.azt`;const i=this.generateFileAzt();if(i)if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(i,n);else{const a=window.document.createElement("a");a.href=window.URL.createObjectURL(i),a.download=n,document.body.appendChild(a),a.click(),document.body.removeChild(a)}}generateFileAzt(){var e,n;let i=null!==(n=null===(e=this.aztEditor)||void 0===e?void 0:e._editor.getValue().trim())&&void 0!==n?n:"";if(""!=i){let a=[],r=[];for(let _ of this.mathMap)a.push(_);for(let _ of this.extraMap)r.push(_);let c=JSON.stringify({text:i,imgs:this.images,maths:a,infos:r});return new Blob([c],{type:"text/plain"})}return null}save(){var e;if(this.lstQuest.length>0||""!==this.text){let n=this.commonService.myTranslateIntance("lang_auto_dang_xu_ly_du_lieu");this.conf.logConfig.msg=n,this.conf.logConfig.status=!0;const i=new qt.Q(10,{function:(r,l)=>{this.conf.logConfig.msg=`${n} ${Math.floor(r/l*100)}%`}}),a={};if(this.lstQuest.length>0){this.conf.logConfig.status=!0,this.conf.logConfig.msg="lang_auto_dang_chuan_bi_du_lieu_de_thi";const l=null!==(e=(this.lstQuest[0].quest.isGroup?this.lstQuest[1]:this.lstQuest[0]).quest.label)&&void 0!==e?e:1;let c,_=[],d=!0;a.exam={examObj:{categoryId:Number(this.conf.cur_cateId),name:this.title.value,startQuestionIndex:l},questionObj:{listQuestions:[]},examConfig:[],rootQuests:[]},i.addTask(this,this.uploadFileProcess,[a]);const m=this.errorQuestionView.isFullNoPoint(this.lstQuest);let p=10,w=Math.floor(this.lstQuest.length/1e3)+2;this.lstQuest.forEach((C,A)=>{var M;if(C.quest.isGroup)c=C,d=!1;else{d||(d=!0,_.push(A-(_.length+1)));const q={name:this.commonService.myTranslateIntance("lang_auto_cau_hoi_tu_editor")+" "+(A-_.length+1),point:C.point||1};m&&(q.point=this.evenlyDivideSequence(p,this.lstQuest.length-A,w),p-=q.point),null===(M=a.exam)||void 0===M||M.examConfig.push(q),i.addTask(this,this.convertQuestion,[c,a,C,A-_.length,_.length])}}),0==this.editQuestId&&i.addTask(this,this.saveCdn,[a]),a.exam.examObj.firstInGroupIndexes=JSON.stringify(_)}else if(a.homework={name:this.title.value,content:this.text,deadline:void 0,testbankExams:void 0,files:void 0,mustVerified:void 0,whenShowAnswer:void 0,categoryId:void 0,classroomIds:void 0},this.attachFiles.length>0){const r=[];this.attachFiles.forEach(l=>{i.addTask(this,this.uploadAttHomeworkFile,[a,r,l])})}i.start().then(()=>{this.editQuestId?this.questionService.apiQuestionsGet(void 0,void 0,void 0,void 0,void 0,this.editQuestId.toString()).subscribe(r=>{var l,c,_,d;if(1==r.success&&r.data&&r.data.questions&&1===r.data.questions.length){const m=null===(l=r.data)||void 0===l?void 0:l.questions[0];if((null===(c=a.exam)||void 0===c?void 0:c.questionObj.listQuestions)&&1==a.exam.questionObj.listQuestions.length){let p=null!==(_=this.commonService.myTranslateIntance("lang_auto_xay_ra_loi_trong_qua_trinh_xu_ly_hinh_anh_cua_de"))&&void 0!==_?_:"";this.questionSaveService.convertQuestions(a.exam.questionObj.listQuestions,a.exam.rootQuests,(w,C=p)=>{this.conf.logConfig.status=!1,this.conf.logConfig.msg=void 0,this.showErrorSnack(C)}).then(()=>{var w,C,A,M;if((null===(w=a.exam)||void 0===w?void 0:w.questionObj.listQuestions)&&1==a.exam.questionObj.listQuestions.length){const D=a.exam.questionObj.listQuestions[0],q=this.commonService.myParseJson(null!==(C=D.questionContent)&&void 0!==C?C:""),U=this.commonService.myParseJson(null!==(A=m.content)&&void 0!==A?A:"");if(!(q&&q[0]&&U&&U[0]))return this.conf.logConfig.msg=void 0,this.conf.logConfig.status=!1,void this.showErrorSnack(null!==(M=r.message)&&void 0!==M?M:"");Object.prototype.hasOwnProperty.call(U[0],"groupContent")&&(q[0].groupContent=U[0].groupContent),Object.prototype.hasOwnProperty.call(U[0],"groupUrl")&&(q[0].groupContent=`@[]{"link":"${U[0].groupUrl}","data":${JSON.stringify({x:0,y:0,width:-1,height:-1})}}@[]`),Object.prototype.hasOwnProperty.call(U[0],"name")&&(q[0].name=U[0].name),Object.prototype.hasOwnProperty.call(U[0],"id")&&(q[0].id=U[0].id),Object.prototype.hasOwnProperty.call(m,"groupId")&&(D.groupId=m.groupId),Object.prototype.hasOwnProperty.call(m,"groupType")&&(D.groupType=m.groupType),D.questionContent=JSON.stringify(q),delete D.__path,this.questionService.apiQuestionsIdPut(this.editQuestId,D).subscribe(F=>{var tt;this.conf.logConfig.msg=void 0,this.conf.logConfig.status=!1,1==F.success?(this.showSuccessSnack("lang_auto_chinh_sua_cau_hoi_thanh_cong"),this.commonService.myNavigation(this.conf.getBackLink())):this.showErrorSnack(null!==(tt=F.message)&&void 0!==tt?tt:"")})}})}}else this.showErrorSnack(null!==(d=r.message)&&void 0!==d?d:"")}):(this.conf.logConfig.status=!1,this.conf.logConfig.msg=void 0,this.editorOutputDataService.setOutputData(a),this.editorOutputDataService.redirectToConfig(this.conf))})}else this.showErrorSnack("lang_auto_khong_tim_thay_noi_dung_can_luu")}evenlyDivideSequence(e,n,i){return n<=1?e:this.takeDecimalNumber(e/n,i)}takeDecimalNumber(e,n){let i=Math.pow(10,n);return Math.floor(e*i)/i}lengthRealQuest(){return this.lstQuest.filter(e=>!e.quest.isGroup).length}cancelAction(){var e;null===(e=this.popupConfirm)||void 0===e||e.startConfirm("lang_auto_confirm_destroy_content").then(n=>{n&&location.reload()})}openLibrary(){this.conf.startLibrary=!0}switchFilePdfProcess(e){this.editorOutputDataService.setFileProcess(e),this.commonService.myNavigationWithQueryString("/admin/testbank/create-file-pdf-ver2/"+(null!=this.conf.cur_cateId?this.conf.cur_cateId:0),"?backto="+encodeURIComponent("/admin/testbank/azota-editor/"+(null!=this.conf.cur_cateId?this.conf.cur_cateId:0)))}switchFileXlsxProcess(e){this.editorOutputDataService.setFileProcess(e),this.commonService.myNavigationWithQueryString("/admin/testbank/create-exam-by-excel/"+(null!=this.conf.cur_cateId?this.conf.cur_cateId:0),"?backto="+encodeURIComponent("/admin/testbank/azota-editor/"+(null!=this.conf.cur_cateId?this.conf.cur_cateId:0)))}clearData(){this.images=[],this.editedImages=new Map,this.lstQuest=[],this.text="",this.attachFiles=[],this.renderCache=new Map,this.apiCallbackCache=new Map,this.apiDataCache=new Map,this.fillQuestCache=new Map,this.loadingManager=new Map,this.editorParsedData=void 0,this.curQuest=void 0,this.errs=[],this.curMathId=1,this.curExtraId=1,this.mathMap=new Map,this.extraMap=new Map,this.matrixLoadedData=void 0}processFile(e){if(this.editQuestId>0)return;this.conf.logConfig.status=!0,this.conf.logConfig.msg="lang_auto_dang_cho_xu_ly_file",this.title=new h.p4(e.name);let n=e.name.split(".").pop();return"docx"==(null==n?void 0:n.trim().toLowerCase())?(this.clearData(),void this.parseDocx(e)):"azt"==(null==n?void 0:n.trim().toLowerCase())?(this.clearData(),void this.parseAzt(e)):void((0,Ut.Or)(e.type)?this.attachImg(e):this.fileParser.start(e).then(i=>{"pdf"===i.type?this.switchFilePdfProcess(e):"docx"===i.type?(this.images=[],i.data.maps.forEach(a=>{this.images.push(a)}),this.aztEditor&&this.aztEditor._editor.setValue(i.data.str.join("\n"))):"xlsx"===i.type?this.switchFileXlsxProcess(e):(this.showErrorSnack("lang_auto_file_khong_duoc_ho_tro"),this.conf.logConfig.status=!1,this.conf.logConfig.msg=void 0)}).catch(()=>{this.showErrorSnack("lang_auto_file_khong_duoc_ho_tro"),this.conf.logConfig.status=!1,this.conf.logConfig.msg=void 0}))}attachImg(e){var n;let i=this.commonService.myTranslateIntance("lang_auto_nhap_noi_dung");null===(n=this.aztEditor)||void 0===n||n._editor.setValue(i),this.onDropFile(e),this.conf.logConfig.status=!1,this.conf.logConfig.msg=void 0}openFile(e){this.processFile(e.target.files[0]),e.target.value=null}parseDocx(e){new ve(this.editorCommonService,this.commonService).handleFileSelect(e,i=>{var a,r;this.saveFileProcess=e,this.images=[],this.mathMap.clear();let l=[];for(let p of i.data)if("img"==p.type)this.images.push({id:p.key,link:p.value,cssStyle:p.cssStyle}),p.cssStyle&&p.cssStyle.split(";").length>2&&l.push([`^\\[img:\\$${p.key}\\$\\]`,`[img:$${p.key}$]\n`]);else if("mathml"==p.type){let w=+p.key.split("_")[1];this.mathMap.set(p.key,{id:w,str:p.value,raw:p.docx,lineIdx:0,startCol:0,endCol:0}),w>this.curMathId&&(this.curMathId=w)}this.curMathId++;let c=[];for(let p of i.lines){if(0==p.length)continue;let w="";w=Array.isArray(p[0])&&Array.isArray(p[p.length-1])&&Array.isArray(p[Math.floor(p.length/2)])?"[* "+p.map(A=>A.map(M=>M.join("")).join("\\n")).join(" | ")+" *]":p.join("");for(let A of l)w=w.replaceAll(new RegExp(A[0],"g"),A[1]);let C=w.split("\n");for(let A of C)c.push(A)}(new cn).process(c);let d=this.processStyle(c);this.processMath(d),this.lstQuest=[],this.curQuest=void 0,null===(a=this.aztEditor)||void 0===a||a.setPosition(1,0);let m=d.join("\n");null===(r=this.aztEditor)||void 0===r||r._editor.setValue(m),this.conf.logConfig.status=!1,this.conf.logConfig.msg=void 0},(i,a,r)=>{let l=this.commonService.myTranslateIntance("lang_auto_dang_xu_ly");this.conf.logConfig.msg=`${l} ${r}...(${i}/${a})`})}format(){var e,n,i,a,r,l,c,_;let m=(null!==(n=null===(e=this.aztEditor)||void 0===e?void 0:e._editor.getValue())&&void 0!==n?n:"").split("\n"),p=m.length,w=m.length>0?m[m.length-1].length:0,C=null===(a=null===(i=this.aztEditor)||void 0===i?void 0:i.azotaIntel)||void 0===a?void 0:a.examIntel;null==C||C.setLines(m);let A=null!==(r=null==C?void 0:C.parse())&&void 0!==r?r:[],M=[],D=[],q=[],U=-999;for(let F of A){if(F.isGroup){let B=F.parts.map(z=>{var X;return null!==(X=z.text)&&void 0!==X?X:""}).join("\n");M.push(B);continue}-999==U&&(U=F.label-1),F.label-U>1&&(F.olabel=null===(l=F.olabel)||void 0===l?void 0:l.replace(F.label+"",U+1+""),F.label=U+1);let tt=zt.Utils.capitalizeFirstLetter(null!==(c=F.olabel)&&void 0!==c?c:F.label+"")+" ",W=tt+F.parts.map(B=>{var z;return null!==(z=B.text)&&void 0!==z?z:""}).join("\n"),P=0==F.answers.length||F.answers[0].isInline?void 0:F.answers.map(B=>(B.isCorrect?"   *":"    ")+B.label+". "+B.parts.map(z=>{var X;return null!==(X=z.text)&&void 0!==X?X:""}).join("\n").trim()).join("\n"),R=F.help?tt+F.help.map(B=>{var z;return null!==(z=B.text)&&void 0!==z?z:""}).join("\n"):void 0,N=F.strAns?tt+F.strAns:void 0;M.push(W),P&&M.push(P),R&&D.push(R),N&&q.push(N),U++}if(M.length>0){(q.length>0||D.length>0)&&M.push("----------------------"+this.commonService.myTranslateIntance("azt_lang_sugg_the_end")+"----------------------"),q.length>0&&(M.push(this.commonService.myTranslateIntance("azt_lang_sugg_ans_table")),M.push(...q)),D.length>0&&(M.push(this.commonService.myTranslateIntance("azt_lang_sugg_instruction")),M.push(...D));let F=M.join("\n"),tt={startLineNumber:0,endLineNumber:p+100,startColumn:0,endColumn:w+100};null===(_=this.aztEditor)||void 0===_||_._editor.executeEdits("",[{range:tt,text:F}])}}processMath(e){let n=0;for(let i of e){let a=i.matchAll(this.MATH_PAT);for(;;){let r=a.next();if(r.done)break;let l=r.value[0],_=this.mathMap.get(r.value[1]);_&&(_.lineIdx=n+1,_.startCol=r.value.index+1,_.endCol=_.startCol+l.length)}n++}}processStyle(e){var n,i,a,r;let l=/\[![!ibuchl]+:\$(([^\$]|\$[^\]])+)\$\]/g,c=/^\s*\[\*\s*[AC]\.[^\|]+\|\s*[BD]\..*\*\]\s*$/g,_=[],d=0;for(let D of e){c.test(e[d].replaceAll(l,"$1"))&&(e[d]=e[d].replaceAll("[*","").replaceAll("*]","").replaceAll("|"," ").trim(),D=e[d]);let F,q=D.matchAll(l),U=0;for(;;){let tt=q.next();if(tt.done)break;let W=tt.value[0],P=W.indexOf(":"),R=W.substring(1,P),B=tt.value.index-U,z=B+tt.value[1].length;F&&B==F.e&&F.style==R?F.e=z:(F={lineIdx:d,s:B,e:z,style:R},_.push(F)),U+=P+4}e[d]=D.replaceAll(l,"$1"),d++}let m=null===(i=null===(n=this.aztEditor)||void 0===n?void 0:n.azotaIntel)||void 0===i?void 0:i.examIntel;null==m||m.setLines(e);let p=null!==(a=null==m?void 0:m.parse())&&void 0!==a?a:[],w=[],C=new Map;for(let D of p){for(let q of D.parts)w.push(q);for(let q of D.answers){let U=this.hasStyleAns(e,q.parts[0],_);""!=U&&C.set(`${D.label}-${D.group}-${q.label}`,U);for(let F of q.parts)w.push(F)}}for(let D of p)if(D.help)for(let q of D.help)w.push(q);this.applyStyle(e,w,_),null==m||m.setLines(e),p=null!==(r=null==m?void 0:m.parse())&&void 0!==r?r:[];let A=[];for(let D of p){let q=new Map;if(!(D.answers.filter(U=>U.isCorrect).length>0)){for(let U of D.answers){let F=C.get(`${D.label}-${D.group}-${U.label}`);F&&""!=F&&q.set(F,q.has(F)?void 0:U.parts[0])}for(let U of q)if(U[1]){A.push(U[1]);break}}}for(let D=A.length-1;D>=0;D--){let q=A[D];e[q.lineIdx]=e[q.lineIdx].substring(0,q.b)+"*"+e[q.lineIdx].substring(q.b)}return e=this.processUnderlineAns(e),p.length>0?e.slice(p[0].parts[0].lineIdx):e}processUnderlineAns(e){let n=/\[[!bihl]*[!u]+[!bihl]*:\$(([^\$]|\$[^\]])+)\$\]/g,i=0,a=[];for(let r of e){if(/^[ABCD\.\s\t\*]+$/.test(r)&&""!=r.trim()&&i>0){let l=r;l=l.replaceAll(/[\s\t\.]+/g,"");let c=l.indexOf("*"),_=0;if(l=l.replaceAll(/[\*]+/g,""),"ABCDEFGH".indexOf(l)>=0){let d=e[i-1].match(n);if(d&&l.length==d.length){for(let p of d)e[i-1]=e[i-1].replace(p,p.replace(/\[[!bihl]*[!u]+[!bihl]*:\$/g,`[${c==_?"*":""}${l.substring(0,1)}:`).replace("$]","]")),a[a.length-1]=e[i-1],l=l.substring(1),_++;i++;continue}}}a.push(r),i++}return a}hasStyleAns(e,n,i){if(!n)return"";let a=i.filter(r=>r.lineIdx==n.lineIdx&&r.s<=n.b&&r.e>=n.b);for(let r of a)if(r.style.indexOf("!u")>=0||r.style.indexOf("!b")>=0||r.style.indexOf("!hl")>=0)return r.style;return""}applyStyle(e,n,i){var a;for(let r=n.length-1;r>=0;r--){let l=n[r],c=i.filter(_=>_.lineIdx==l.lineIdx&&_.e>=l.s);for(let _=c.length-1;_>=0;_--){let d=c[_].s>=l.s?c[_].s:l.s,m=c[_].e<=(null!==(a=l.e)&&void 0!==a?a:9999999)?c[_].e:l.e,p=c[_].style.replaceAll("!hl","");if(d<m&&""!=p){let w=e[l.lineIdx],C=w.substring(d,m);""!=C.trim()&&(e[l.lineIdx]=w.substring(0,d)+"["+p+":$"+C+"$]"+w.substring(m))}}}}setCorrectAns(e,n){var i,a;let r=[],l=0,c=0;this.editorFocus(n.parts);for(let _ of e.answers){let d=_.ans.parts[0];if(!d)continue;let m=null===(i=this.aztEditor)||void 0===i?void 0:i.getLineText(d.lineIdx+1);d.lineIdx!=c&&(l=0,c=d.lineIdx);let p=m.substring(d.b,d.b+1);"*"==p&&(r.push(`${d.lineIdx}|${d.b+l}|${d.b+l+1}|`),l--),_.ans.label==n.label&&"*"!=p&&(r.push(`${d.lineIdx}|${d.b+l}|${d.b+l}|*`),l++)}null===(a=this.aztEditor)||void 0===a||a.runEditAction(r,this.aztEditor._editor,!0),this.showTooltip=!1}closeLibrary(e){this.conf.startLibrary=!1,this.conf.isFirstTime||(this.conf.isFirstTime=!0),e&&this.aztEditor&&this.aztEditor.insertLine(e.join("\n"))}parseTag(e){let i=e.trim(),r=i.matchAll(/^(\[!info:\d+\]\s*)?(\[[iubhl!]+:\$\s*)?[\[\(]\s*(VD|TH|NB|VDC|EASY|MEDIUM|HARD|HARDEST)\s*\d*\s*[\)\]]/g).next();return r.done?["",i]:(i=i.replace(/[\[\(]\s*(VD|TH|NB|VDC|EASY|MEDIUM|HARD|HARDEST)\s*\d*\s*[\)\]]/g," "),[r.value[3],i])}parseExtra(e){if(e.startsWith("[@"))return{val:"",idx:0,id:e};let a=e.matchAll(/\[!info:\d+\]/g),r="",l=0;for(;;){let _=a.next();if(_.done)break;r=_.value[0],l=_.value.index;break}if(""==r)return{val:"",idx:0,id:"0"};let c=r.replace("[!info:","").replace("]","").trim();return{val:r,idx:l,id:c}}setExtra(e,n=!0){var i,a,r,l,c;let _=e.q.quest.parts[0],d=this.parseExtra(null!==(i=_.text)&&void 0!==i?i:"");"0"==d.id&&(d.id=this.curExtraId+"",this.curExtraId++);let m=this.extraMap.get(d.id);if(m||(m={d:e.q.point,audio:e.q.audio,file:void 0,fix:e.q.quest.isFixAns,tag:e.q.tag},this.extraMap.set(d.id,m)),"point"==e.type&&(m.d=e.data&&e.data>0?e.data:void 0),"audio"==e.type&&(m.audio=e.q.audio?e.q.audio:void 0),"fix"==e.type&&(m.fix=e.data?"fix":void 0),"tag"==e.type&&(m.tag=e.data),+d.id>0){let p=`[!info:${d.id}]`,w=_.s+d.idx,C=_.s+d.idx+d.val.length;e.q.quest.isGroup&&""==d.val&&(w=_.s+(null!==(r=null===(a=_.text)||void 0===a?void 0:a.length)&&void 0!==r?r:0),C=w),null===(l=this.aztEditor)||void 0===l||l.runEditAction([`${_.lineIdx}|${w}|${C}|${p}`],this.aztEditor._editor,n)}n&&(null===(c=this.aztEditor)||void 0===c||c.setPosition(_.lineIdx+1,0))}setFixGroup(e){e.isFixGroup=!e.isFixGroup,this.setExtra({q:e,type:"fix",data:e.isFixGroup})}randomAllAgain(){var e,n;this.apiDataCache.clear();let i=null===(e=this.aztEditor)||void 0===e?void 0:e._editor.getValue().split("\n"),a=null!==(n=this.editorParsedData)&&void 0!==n?n:[];this.onEditorChangeValue(i,a)}reRender(){this.editorParsedData&&(this.lstQuest=this.editorParsedData.map((e,n)=>this.renderQuest(e,n)),this.text="")}onApplyAllTag(e,n){this.lstQuest.forEach((i,a)=>{a<=n||i.quest.isGroup||(i.tag=e,this.setExtra({type:"tag",data:e,q:this.lstQuest[a]},a==this.lstQuest.length-1))})}showHover(e,n,i){if(this.lstQuest)for(let a of this.lstQuest){let r=i;if(a.quest.parts[0].lineIdx==e-1&&/\[!info:\d+\]/.test(i)){let l=r.indexOf("[")+1,c=r.indexOf("]")+1;if(l<=n&&n<=c){let _=[],d=this.commonService.myTranslateIntance("lang_auto_diem"),m=this.commonService.myTranslateIntance("lang_auto_audio_file"),p=this.commonService.myTranslateIntance("lang_auto_file_dinh_kem"),w=this.commonService.myTranslateIntance("lang_auto_nhan"),C=this.commonService.myTranslateIntance("lang_auto_co_dinh");return a.point&&_.push(`${a.point} ${d}`),a.audio&&_.push(m+": "+a.audio.name),a.attachments&&_.push(p+": "+a.attachments),a.tag&&a.tag.length>0&&_.push(w+": "+a.tag.map(A=>A[this.commonService.getCurrentLang()+"Name"]).join(",")),(a.isFixGroup||a.quest.isFixAns)&&_.push(C),{lineIdx:e,s:l,e:c,text:_.join(", ")}}}}}onEditorChangeValue(e,n){var i;if(n&&n.length>0){this.errs=[],null===(i=this.aztEditor)||void 0===i||i.setError([]),this.editorParsedData=n;let a=this.lstQuest.map((r,l)=>r.lazyQuestView&&r.lazyQuestView.show?{i:l,v:r.lazyQuestView}:{i:-1,v:void 0}).filter(r=>r.i>=0);this.lstQuest=[],this.matrixLoadedData=[],this.loadMatrixQuest(this.editorParsedData).then(r=>{var l;this.matrixLoadedData=r,this.lstQuest=n.map((_,d)=>this.renderQuest(_,d));for(let _ of a){if(_.i>=this.lstQuest.length)break;this.lstQuest[_.i].lazyQuestView=_.v}n.forEach((_,d)=>{var m;let p=null===(m=_.answers.find(w=>w.isCorrect))||void 0===m?void 0:m.label;p||(p=this.lstQuest[d].originCorrectAns),p||(p="");for(let w of this.lstQuest[d].answers)w.ans.isCorrect=w.ans.label==p}),this.text="",setTimeout(()=>{this.revealCurrentQuest()},200),this.validate();let c=null===(l=this.aztEditor)||void 0===l?void 0:l._editor.getValue().split("\n");this.processMath(c)})}else this.lstQuest=[],this.text=this.renderText(e.join("<br>"))}loadMatrixQuest(e){return new Promise((n,i)=>{var a,r,l,c;let _={exceptQuestionIds:[],matrix:[]},d=new Map;for(let p of e)if(null!==(a=p.parts[0].text)&&void 0!==a&&a.startsWith("[@")){let w=p.parts[0].text.split("=>"),C=w[0]+"=>"+w[1].split("-")[0];if(d.has(C))continue;d.set(C,!0);let A=zt.Utils.parseInclude(p.parts[0].text),M=this.commonService.myTranslateIntance("azt_lang_tag_TL"),D=this.commonService.myTranslateIntance("azt_lang_tag_TN"),q=this.commonService.myTranslateIntance("azt_lang_tag_DT");null===(r=_.matrix)||void 0===r||r.push({categoryIds:A.catId,examIds:A.examId,questionIds:A.questId,groupIds:A.groupId,tags:A.tag.filter(U=>[M,D,q].indexOf(U)<0),answerTypes:A.tag.filter(U=>[M,D,q].indexOf(U)>=0).map(U=>U==M?3:U==D?1:4),number:A.getNum,key:C})}let m=null!==(c=null===(l=_.matrix)||void 0===l?void 0:l.map(p=>p.key).join(":"))&&void 0!==c?c:"";m!=this.lastMatrixHash?(this.lastMatrixHash=m,this.apiDataCache.clear(),this.questionService.apiQuestionsMatrixPost(_).subscribe(p=>{n(1===p.success&&p.data?p.data:[])})):n(this.matrixLoadedData?this.matrixLoadedData:[])})}onMobileEditorChange(e){this.mobileEditorContent=e.lines.join("\n"),this.onEditorChangeValue(e.lines,e.data)}onEditorInitComplete(e){if(this.aztEditor=e.azotaEditor,this.aztEditor.setLang(this.commonService),this.aztEditor.setHoverCalback((a,r,l)=>this.showHover(a,r,l)),this.aztEditor.onChange((a,r)=>{var l;if(this.editQuestId>0&&r.length>0){r.length>1&&this.showErrorSnack("lang_auto_khong_the_them_cau_hoi_moi");let c=this.conf.startIndex+1;(r=[r[0]])[0].olabel=null===(l=r[0].olabel)||void 0===l?void 0:l.replace(r[0].label+"",c+""),r[0].label=c}this.onEditorChangeValue(a,r)}),this.aztEditor.onRefreshInclude((a,r)=>{var l;let c=0;this.matrixLoadedData=[];let _=this.lstQuest.filter(d=>{var m;return(null===(m=d.quest.parts[0].text)||void 0===m?void 0:m.startsWith(a))&&d.quest.parts[0].lineIdx==r-1}).map(d=>{var m;return null!==(m=d.id)&&void 0!==m?m:0});for(let d of this.lstQuest){if(d.quest.parts[0].lineIdx==r-1){const m=null!==(l=d.quest.parts[0].text)&&void 0!==l?l:"",p=c;let A=new ki(this.cdnService,this.commonService,M=>{this.fillQuest(p,M)},this.apiCallbackCache,this.aztEditor,M=>{this.fillError(p,M)},this.getIncludeIds(_),this.apiDataCache,this.matrixLoadedData);this.apiDataCache.delete(m),A.render(m,this.images,this.questionService)}c++}}),this.aztEditor.onInsertQuestText((a,r)=>{var l,c,_;let d=this.lstQuest.filter(m=>m.quest.parts[0].lineIdx==r-1)[0];if(d){let m=this.getQuestText(d);null===(l=this.aztEditor)||void 0===l||l.setPosition(r,0),null===(c=this.aztEditor)||void 0===c||c.removeText(r,0,999999,!1),null===(_=this.aztEditor)||void 0===_||_.insertAtCurPos(m)}}),this.aztEditor.onInsertDetails((a,r)=>{var l,c,_,d;let m=this.lstQuest.filter(q=>q.quest.parts[0].lineIdx==r-1);if(0==m.length)return;for(let q=0;q<m.length;q++)this.apiDataCache.delete(a+"=>"+q);let p=this.commonService.myTranslateIntance("lang_auto_cau"),w=m.map(q=>`${q.id}: ${p} ${q.quest.label}`),A=(null!==(l=m[0].quest.parts[0].text)&&void 0!==l?l:"").split("=>")[0],M=null===(c=m[0].quest.parts[0].text)||void 0===c?void 0:c.split("=>")[1],D=null===(_=m[m.length-1].quest.parts[0].text)||void 0===_?void 0:_.split("=>")[1];if(M&&D){let q=+M,U=+D,F=A.split("].["),tt=F[F.length-1],W=+zt.Utils.getNumberFromStr(tt),P=U-q+1;F[F.length-1]=tt.replace(" "+W+" "," "+(W-P)+" ");let N=F.join("].[");for(let B=U+1;B<W;B++){let z=this.apiDataCache.get(A+"=>"+B);z&&this.apiDataCache.set(N+"=>"+(B-P),z)}for(let B=0;B<q;B++){let z=this.apiDataCache.get(A+"=>"+B);z&&this.apiDataCache.set(N+"=>"+B,z)}}null===(d=this.aztEditor)||void 0===d||d.insertDetails(r,w)}),this.aztEditor.onChangePosition((a,r)=>{var l;this.revealCurrentQuest();let d=(null===(l=this.aztEditor)||void 0===l?void 0:l.getCurLineText()).matchAll(/\[(!m|img):\$([^\$\]]+)\$\]/g);for(;;){let m=d.next();if(m.done)break;let p=m.value[2],w=m.value[0];if(m.value.index+1<r&&r<m.value.index+m.value[0].length)if(w.startsWith("[!m:")){let C=this.mathMap.get(p);if(C){this.openMathEditor(C);break}}else this.actionEditImage(document.getElementById(p))}}),window.addEventListener("paste",a=>{var r;if((null===(r=this.aztEditor)||void 0===r?void 0:r._editor).hasTextFocus()){let c=a.clipboardData.getData("text/html")+"",_=a.clipboardData.files[0],m=c.matchAll(/<img [^>]*src="([^"]+)"/g);if(_&&_.type.startsWith("image"))return void this.insertImgFromFile(_);for(;;){let p=m.next();if(p.done)break;this.insertImgFromLink(p.value[1])}}}),this.editQuestId>0){this.aztEditor.setSingleMode(!0);let a=this.commonService.myTranslateIntance("lang_auto_cau_hoi");this.aztEditor._editor.setValue(`[@Q${this.editQuestId}:${a}]`)}const n=this.editorOutputDataService.getFirstFile(),i=this.editorOutputDataService.getMatrixData();n?this.processFile(n):i&&this.processMatrixData(i)}insertImgFromBase64(e){var n;let i=0;for(let a of this.images){let r=+a.id.split("_")[1];r>i&&(i=r)}i++,this.images.push({id:"img_"+i,link:e}),null===(n=this.aztEditor)||void 0===n||n.insertAtCurPos(`[img:$img_${i}$]`)}insertImgFromLink(e){(class re{static loadImageToBase64(s,e){return new Promise((n,i)=>{const a=new Image;a.crossOrigin="anonymous",a.setAttribute("count","1"),a.onload=()=>{const r=document.createElement("canvas");r.width=a.width,r.height=a.height;const l=r.getContext("2d");null==l||l.drawImage(a,0,0,a.width,a.height,0,0,r.width,r.height);let _=r.toDataURL();n(_)},a.onerror=()=>{const r=a.getAttribute("count");r&&1==Number(r)?(a.src=e.getMyCdn(s),a.setAttribute("count","2")):r&&Number(r)<5?(a.setAttribute("count",r+1),a.src=e.getRawCdnLink(s)+"?t="+(new Date).getTime()):i(new Error)},a.src=e.getRawCdnLink(s)})}}).loadImageToBase64(e,this.cdnService).then(n=>{this.insertImgFromBase64(n)})}insertImgFromFile(e){let n=new FileReader;n.onload=()=>{this.insertImgFromBase64(n.result+"")},n.readAsDataURL(e)}processMatrixData(e){var n;let i=new pe;this.conf.matrix=e;let a=i.parse(e.matrix);this.extraMap=a.extra,null===(n=this.aztEditor)||void 0===n||n._editor.setValue(this.commonService.translateString(a.text))}revealCurrentQuest(){var e;if(this.isMobile)return;let n=null===(e=this.aztEditor)||void 0===e?void 0:e.getCurQuest();n?(this.revealQuest((n.isGroup?"g-":"")+n.label),this.curQuest=n):this.revealQuest("1")}revealQuest(e){let n=document.getElementById("quest-"+e);null==n||n.scrollIntoView({behavior:"auto"}),this.onScrollQuest()}onScrollQuest(){clearTimeout(this.scrollId),this.scrollId=setTimeout(()=>{this.checkElementQuestionLazy()},100)}onChangeQuest(e,n){var i;this.matrixLoadedData=[];let a=this.lstQuest.map(m=>{var p;return null!==(p=m.id)&&void 0!==p?p:0});const r=null!==(i=e.quest.parts[0].text)&&void 0!==i?i:"",l=this.apiDataCache.get(r);let d=new ki(this.cdnService,this.commonService,m=>{this.fillQuest(n,m)},this.apiCallbackCache,this.aztEditor,m=>{this.showErrorSnack(m),l&&this.apiDataCache.set(r,l)},a,this.apiDataCache,this.matrixLoadedData);this.apiDataCache.delete(r),d.setGetOne(!0),d.render(r,this.images,this.questionService)}setPointBelow(e,n){for(let i=n;i<this.lstQuest.length;i++)this.lstQuest[i].quest.isGroup||(this.lstQuest[i].point=e,this.setExtra({type:"point",data:e,q:this.lstQuest[i]},i==this.lstQuest.length-1))}editorFocus(e){var n;e&&e.length>0&&(null===(n=this.aztEditor)||void 0===n||n.goToLine(e[0].lineIdx+1))}onCopy(e,n){let i=this;n||(n="Copy");let a=r=>{var l;let c=zt.Utils.capitalizeFirstLetter(null!==(l=e.quest.olabel)&&void 0!==l?l:"");navigator.clipboard.writeText(i.getQuestText(e));let _=this.commonService.myTranslateIntance("lang_auto_noi_dung"),d=this.commonService.myTranslateIntance("lang_auto_thanh_cong");i.showSuccessSnack(`${n} ${_} ${c} ${d}`)};document.addEventListener("copy",a),document.execCommand("copy"),document.removeEventListener("copy",a)}onCut(e){let n=this.commonService.myTranslateIntance("lang_auto_cat");this.onCopy(e,n),this.onDel(e,n)}onDel(e,n){var i,a,r,l,c,_;let d=[],m=zt.Utils.capitalizeFirstLetter(null!==(i=e.quest.olabel)&&void 0!==i?i:""),p=this.commonService.myTranslateIntance("lang_auto_xoa");if(n||(n=p),(null!==(r=null===(a=e.quest.parts[0].text)||void 0===a?void 0:a.indexOf(".[L\u1ea5y ng\u1eabu nhi\xean"))&&void 0!==r?r:-1)>0||(null!==(c=null===(l=e.quest.parts[0].text)||void 0===l?void 0:l.indexOf(".[Random"))&&void 0!==c?c:-1)>0){let w=this.commonService.myTranslateIntance("lang_auto_nam_trong_nhom_lay_ngau_nhien"),C=this.commonService.myTranslateIntance("lang_auto_khong_thanh_cong");this.showErrorSnack(`${m} ${w}, ${n} ${C}`)}else{d.push(...e.quest.parts.map(w=>w.lineIdx));for(let w of e.quest.answers)d.push(...w.parts.map(C=>C.lineIdx));e.quest.help&&d.push(...e.quest.help.map(w=>w.lineIdx)),d=d.filter((w,C,A)=>A.indexOf(w)===C),null===(_=this.aztEditor)||void 0===_||_.removeLines(d,!0)}}getQuestText(e){var n,i,a;let l=[`${zt.Utils.capitalizeFirstLetter(null!==(n=e.quest.olabel)&&void 0!==n?n:"")} ${e.tag&&e.tag.length>0?"("+e.tag[0].code+")":""}${this.formatContent(e.renderedStr)}`],c="";if(e.renderedStr.indexOf('class="qv_string_eng_ans"')<0)for(let d of e.answers)l.push((d.ans.isCorrect?"*":"")+d.ans.label+". "+this.formatContent(d.renderedStr));else c=e.answers.filter(d=>d.ans.isCorrect)[0].ans.label;if(e.quest.strAns){let d=null!==(i=this.commonService.myTranslateIntance("azt_lang_sugg_ans_table_upper"))&&void 0!==i?i:"";l.push(`${d}\n${e.quest.label}. ${e.quest.strAns}`)}if(e.helpRenderedStr){let d=null!==(a=this.commonService.myTranslateIntance("lang_auto_loi_giai"))&&void 0!==a?a:"";l.push(d),l.push(this.formatContent(e.helpRenderedStr))}return(new oo).revert(l.join("\n"),c)}formatContent(e){let n=document.createElement("div");n.innerHTML=e;let i=n.getElementsByClassName("azt-mathml"),a=n.getElementsByTagName("img");for(let l=i.length-1;l>=0;l--){let c=i[l];if(!c)continue;let _=this.curMathId;this.mathMap.set("mathtype_"+this.curMathId,{id:_,str:c.innerHTML,lineIdx:0,startCol:0,endCol:0}),this.curMathId++;let m=document.createTextNode(`[!m:$mathtype_${_}$]`);n.replaceChild(m,c)}for(let l=a.length-1;l>=0;l--){let c=a[l];if(!c)continue;let _=this.images.length>0?Math.max(...this.images.map(m=>+m.id.split("_")[1]))+1:1;this.images.push({id:"img_"+_,link:c.src,cssStyle:c.style.cssText});let d=document.createTextNode(`[img:$img_${_}$]`);n.replaceChild(d,c)}return n.innerHTML.replaceAll("<br>","\n")}upperFirst(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}validate(){var e;let n=new Map,i=0;this.errs=this.errs.filter(a=>a.indexOf("Tr\xf9ng c\xe2u h\u1ecfi")<0),null===(e=this.aztEditor)||void 0===e||e.setError(this.errs);for(let a of this.lstQuest)"Tr\xf9ng c\xe2u h\u1ecfi"==a.err&&(a.err=void 0),a.id&&(n.has(a.id)&&this.fillError(i,"Tr\xf9ng c\xe2u h\u1ecfi"),n.set(a.id,1),i++)}fillError(e,n){var i;this.lstQuest[e].err=`<span style='color:red'>${n}</span>`;let r=this.lstQuest[e].quest.parts[0].lineIdx+1+"|"+n;-1==this.errs.indexOf(r)&&this.errs.push(r),null===(i=this.aztEditor)||void 0===i||i.setError(this.errs)}fillImg(e,n,i,a){var r;let l=new RegExp("<div id='"+n+"'[^>]+></div>","g"),c=this.lstQuest[e];c.renderedStr=c.renderedStr.replace(l,null!=i?i:"");for(let _ of c.answers)_.renderedStr=_.renderedStr.replace(l,null!=i?i:"");if(c.helpRenderedStr&&(c.helpRenderedStr=c.helpRenderedStr.replace(l,null!=i?i:"")),a)for(let _ of a){let d=this.renderCache.get(_);d&&this.renderCache.set(_,d.replace(l,null!=i?i:""))}this.editQuestId>0&&this.getQuestText(c).indexOf("img-docx")<0&&(null===(r=this.aztEditor)||void 0===r||r._editor.setValue(this.getQuestText(c)))}fillQuest(e,n){var i,a,r,l;let c=this.commonService.myClone(n),_=this.lstQuest[e];if(_){c.label=_.label,c.point=_.point,c.audio=_.audio,c.lazyQuestView=_.lazyQuestView,c.isFixGroup=_.isFixGroup,(!c.tag||0==c.tag.length)&&(c.tag=_.tag);let d=_.quest.isFixAns||c.quest.isFixAns;if(this.editorParsedData){c.quest=this.editorParsedData[e];let C=null!==(i=c.originCorrectAns)&&void 0!==i?i:"";for(let A of c.quest.answers)if(A.isCorrect){C=A.label;break}for(let A of c.answers)A.ans.isCorrect=A.ans.label==C}c.quest.strAns?c.strAns=c.quest.strAns.split(/[\/\|]/).map(C=>C.trim()):c.strAns&&(c.quest.strAns=c.strAns.join("|"));let m=[];m.push(c.renderedStr),m.push(...c.answers.map(C=>C.renderedStr)),m.push(c.helpRenderedStr);let p=(C,A)=>{this.fillImg(e,C,A,m)};c.renderedStr=this.renderStr(c.renderedStr,"link",p);for(const C of c.answers)C.renderedStr=this.renderStr(C.renderedStr,"link",p);c.helpRenderedStr&&(c.helpRenderedStr=this.renderStr(c.helpRenderedStr,"link",p));let w=3;c.answers.length>0&&(w=1),0==c.answers.length&&c.quest.strAns&&(w=4),c.type=w,d&&(c.quest.isFixAns=d),c.changeable=/^\[@[CTG]\d+:[^\]]+\]([\.,]\[[^\]]+\])*\.\[[^@:\]]+\d+[^@:\]]+\]$/.test(null!==(r=null===(a=c.quest.parts[0].text)||void 0===a?void 0:a.split("=>")[0])&&void 0!==r?r:""),this.lstQuest[e]=c,this.editQuestId>0&&(this.editQuestAttach=c.attachments,this.editQuestFixed=c.quest.isFixAns,this.getQuestText(c).indexOf("img-docx")<0&&(null===(l=this.aztEditor)||void 0===l||l._editor.setValue(this.getQuestText(c)))),this.fillQuestCache.set(e+"-"+c.quest.parts[0].text,c),this.validate()}}renderText(e){let n=e;return n=this.renderStr(n,"help",(a,r)=>{let l=new RegExp("<div id='"+a+"'[^>]+></div>","g");n=n.replace(l,null!=r?r:"")}),n}getLoadedIds(){return this.lstQuest.filter(e=>e.id&&e.id>0).map(e=>{var n;return null!==(n=e.id)&&void 0!==n?n:0})}getIncludeIds(e){var n;let l=(null===(n=this.aztEditor)||void 0===n?void 0:n._editor.getValue()).matchAll(/\[@Q(\d+):[^\]]*\]/g),c=[];for(;;){let d=l.next();if(d.done)break;c.push(+d.value[1])}let _=this.getLoadedIds();return c.push(-1),c.push(..._),c.filter(d=>(null!=e?e:[]).indexOf(d)<0)}renderStr(e,n,i,a,r){let l=this.renderCache.get(e);if(l&&!l.startsWith("Loading...|"))return l;let c=e,_=[new vn,new Zn(this.cdnService),new oo,new fa,new xa,new va,new pa(this.mathMap),new ga,new io.$(this.cdnService,this.commonService,this.configRenderService,i),new ki(this.cdnService,this.commonService,a,this.apiCallbackCache,this.aztEditor,r,this.getIncludeIds(),this.apiDataCache,this.matrixLoadedData)];"link"==n&&(_=[new io.$(this.cdnService,this.commonService,this.configRenderService,i)]),"help"==n&&_.pop();for(const d of _)d.setLoadingManager(this.loadingManager),c=d.render(c,this.images,this.questionService);return this.renderCache.set(e,c),c}renderQuest(e,n){var i,a;let r=3;e.answers.length>0&&(r=1),0==e.answers.length&&e.strAns&&(r=4);let l=(M,D)=>{this.fillImg(n,M,D)},c=M=>{this.fillQuest(n,M)},_=M=>{this.fillError(n,M)},d=e.parts.map(M=>{var D;return null!==(D=M.text)&&void 0!==D?D:""}).join("<br>").trim(),m=this.parseTag(d);""!=m[0]?d=m[1]:e.help&&e.help.length>0&&(m=this.parseTag(null!==(i=e.help[0].text)&&void 0!==i?i:""));let p=this.parseExtra(d);""!=p.val&&(d=d.substring(0,p.idx)+d.substring(p.idx+p.val.length));let w=e.help?e.help.map(M=>{var D;return null!==(D=M.text)&&void 0!==D?D:""}).join("<br>").trim():void 0,C=this.lstQuest[n];this.editQuestFixed&&(e.isFixAns=this.editQuestFixed);let A={renderedStr:this.renderStr(d,"full",l,c,_),quest:e,type:r,tag:""==m[0]?void 0:[{code:zt.Utils.tagLang(m[0])}],lazyQuestView:C?C.lazyQuestView:void 0,strAns:e.strAns?e.strAns.split(/[\/\|]/).map(M=>M.trim()):void 0,label:this.upperFirst(null!==(a=e.olabel)&&void 0!==a?a:""),helpRenderedStr:w?this.renderStr(w,"full",l,c,_):void 0,answers:e.answers.map(M=>{let D=M.parts.map(q=>{var U;return null!==(U=q.text)&&void 0!==U?U:""}).join("<br>").trim();return{renderedStr:this.renderStr(D,"full",l,c,_),ans:M}})};if(A.renderedStr.startsWith("Loading...|")){let M=A.renderedStr.split("|");if(M[1].indexOf(",")<0){let q=+M[1];q>0&&(A.id=q)}A.renderedStr=M[0];let D=this.fillQuestCache.get(n+"-"+e.parts[0].text);D&&(A=D)}if("0"!=p.id){let M=this.extraMap.get(p.id);M&&(A.point=M.d,A.audio=M.audio,A.attachments=M.file,A.isFixGroup=A.quest.isGroup&&M.fix,A.tag=M.tag,A.quest.isFixAns||(A.quest.isFixAns=!A.quest.isGroup&&M.fix))}return this.editQuestAttach=void 0,this.editQuestFixed=void 0,A}openMathEditor(e){var n;if(!e){let i=null===(n=this.aztEditor)||void 0===n?void 0:n.getCurPos();e={id:this.curMathId,str:'<math xmlns="http://www.w3.org/1998/Math/MathML"/>',lineIdx:i.lineNumber,startCol:i.column,endCol:i.column}}this.conf.mathEditor.show=!0,this.conf.mathEditor.latex=e}onInsertLatex(e){if(this.conf.mathEditor.show=!1,this.aztEditor){let n="mathtype_"+this.curMathId,i=`[!m:$${n}$]`;this.mathMap.set(n,{id:this.curMathId,str:e.str,lineIdx:e.lineIdx,startCol:e.startCol,endCol:e.startCol+i.length}),this.aztEditor.removeText(e.lineIdx,e.startCol,e.endCol,!1),this.aztEditor.insertAtCurPos(i),this.curMathId++}}loadExample(e,n){var i,a;let r="vi"==n?ao.EXAM_FULL:ao.EXAM_FULL_EN;this.aztEditor&&""!=this.aztEditor._editor.getValue().trim()?null===(i=this.popupConfirm)||void 0===i||i.startConfirm("lang_auto_azt_edtor_confirm_chang_content").then(l=>{var c;l&&(null===(c=this.aztEditor)||void 0===c||c._editor.setValue(r[e-1]))}):this.aztEditor&&(null===(a=this.aztEditor)||void 0===a||a._editor.setValue(r[e-1]))}onShowFile(e,n){}onDropFile(e){(0,Ut.C0)(e.type)?(0,Ut.ml)(e.type)?this.showErrorSnack("lang_auto_chua_ho_tro_dinh_dang_video_vui_long_thu_lai"):(0,Ut.hv)(e).then(n=>{this.attachFiles.push(n)}):this.showErrorSnack("lang_auto_pleas_upload_file_support")}setupEvent(){this.mapEventElement.push({eventName:"click",className:"img-docx",action:this.actionEditImage,caller:this}),this.mapEventElement.push({eventName:"click",className:"qv_qts_image",action:this.actionEditImage,caller:this}),this.mapEventElement.push({eventName:"click",className:"qv_img-group-content",action:this.actionEditImage,caller:this}),this.mapEventElement.push({eventName:"click",className:"qv_ats_image",action:this.actionEditImage,caller:this}),this.mapEventElement.push({eventName:"click",className:"qv_img",action:this.actionEditImage,caller:this}),this.mapEventElement.push({eventName:"click",className:"azt-mathml",action:this.actionEditMathMl,caller:this})}actionEditImage(e){var n;if(e&&this.images.filter(i=>i.id==e.id).length>0){this.conf.imageEditor.show=!0,this.conf.imageEditor.el=e;let i=null===(n=this.aztEditor)||void 0===n?void 0:n._editor.getValue().split("\n"),a=0,r=0;for(let l of i)if(a++,r=l.indexOf(`[img:$${e.id}$]`),r>=0)break;setTimeout(()=>{var l;null===(l=this.aztEditor)||void 0===l||l.setPosition(a,r+1)},100)}}actionEditMathMl(e){var n;let i=e.id;const a=this.mathMap.get(i);a&&(null===(n=this.aztEditor)||void 0===n?void 0:n._editor.getValue().indexOf(`[!m:$${i}$]`))>=0&&setTimeout(()=>{var r;null===(r=this.aztEditor)||void 0===r||r.setPosition(a.lineIdx,a.startCol+1),this.openMathEditor(a)},100)}onPushImageAction(e){var n;if(this.conf.imageEditor.show=!1,e.element&&e.element.id&&this.aztEditor){let i=this.images.filter(_=>{var d;return _.id==(null===(d=e.element)||void 0===d?void 0:d.id)})[0];if(!i)return;let r="img_"+(this.images.length>0?Math.max(...this.images.map(_=>+_.id.split("_")[1]))+1:1),l=`[img:$${r}$]`;this.images.push({id:r,link:e.output,cssStyle:null==i?void 0:i.cssStyle});let c=null===(n=this.aztEditor)||void 0===n?void 0:n.getCurPos();this.aztEditor.removeText(c.lineNumber,c.column,c.column+i.id.length+8,!1),this.aztEditor.insertAtCurPos(l)}}checkElementQuestionLazy(){if(this.lstQuest.length>=this.maxQuestEnableLazy){let e=document.getElementsByClassName("question-content");for(let n=0;n<e.length;n++){const i=e[n],a=null!==i.getAttribute("start_loading")&&"true"===i.getAttribute("start_loading"),r=i.getAttribute("data-idx-quest"),l=this.lstQuest[Number(r)];l&&(l.lazyQuestView||(l.lazyQuestView={show:!1}),a&&null!==r?l.lazyQuestView.show||(l.lazyQuestView.show=!0,l.lazyQuestView.curHeight="auto"):(l.lazyQuestView.curHeight=i.getBoundingClientRect().height+"px",l.lazyQuestView.show=!1))}}}checkTypeActionService(){const e=document.getElementById("list-quest-panel");e&&this.mapEventElement.forEach(n=>{const i=e.getElementsByClassName(n.className);for(let a=0;a<i.length;a++){const r=i[a];r.getAttribute("event_"+n.eventName+"_target")||(r.setAttribute("event_"+n.eventName+"_target","true"),r.addEventListener(n.eventName,()=>{n.action.call(n.caller,r)}))}})}onResize(e){this.conf.isCalculatorHeight=!1,this.actionResize()}actionResize(){const e=document.getElementById("toolbar__editor");e&&(this.conf.heightContent=window.innerHeight-e.getBoundingClientRect().height-96,this.isMobile&&(this.conf.heightContent=this.conf.heightContent/2),this.conf.isCalculatorHeight=!0)}ngOnInit(){super.ngOnInit(),this.conf.logConfig.status=!0,this.conf.logConfig.msg="lang_auto_dang_tai_thu_vien",this.isMobile=this.commonService.isMobileOrTable(),(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var e,n;this.conf.cur_cateId=this.commonService.getMyParam(this.activeRoute,"cat_id"),this.editQuestId=+(null!==(e=this.commonService.getMyParam(this.activeRoute,"quest_id"))&&void 0!==e?e:"0"),this.conf.sourceBackToLink=this.commonService.getMyQueryParam("backto"),this.conf.startIndex=Number(null!==(n=this.commonService.getMyQueryParam("r"))&&void 0!==n?n:"0"),this.conf.reSetBackToLink()}),this.infoService.apiInfoGetConfigObjsGet("CROPPDF_PARAMS,EDITOR_TEMPLATE").subscribe(e=>{this.aztLangConfig=e.CROPPDF_PARAMS,this.fileParser.loadAllLibs([{link:this.cdnService.convertLinkCdn("azota_assets/js/mnpaint_bundle.js?v=0.3"),name:"mnpaint_bundle.js"},{link:this.cdnService.convertLinkCdn("azota_assets/azota.d7.min.js"),name:"azota.d7.min.js"},{link:this.cdnService.convertLinkCdn("azota_assets/js/SaxonJS2_v2.js"),name:"SaxonJS2_v2.js"},{link:this.cdnService.convertLinkCdn("azota_assets/sprintf.min.js"),name:"sprintf.min.js"},{link:this.cdnService.convertLinkCdn("azota_assets/bundle.js"),name:"bundle.js"},{link:this.cdnService.convertLinkCdn("azota_assets/wmf.v1.js"),name:"wmf.v1.js"},{link:this.cdnService.convertLinkCdn("azota_assets/pdf-js-v3/pdf.js"),name:"pdf-js-v2-pdf.js"},{link:this.cdnService.convertLinkCdn("azota_assets/js/pdf-js-v3/pdf.worker.js"),name:"pdf-js-v2-pdf.worker.js"},{link:this.cdnService.convertLinkCdn("azota_assets/math-editor/mathquill.min.js"),name:"mathquill.min.js"},{link:"https://cdnjs.cloudflare.com/ajax/libs/interact.js/1.10.11/interact.min.js",name:"interact.min.js"},{link:"https://www.wiris.net/demo/editor/editor",name:"math2.min.js"},{link:this.cdnService.convertLinkCdn("azota_assets/js/FromEMF.f1.js"),name:"FromEMF.js"},{link:this.cdnService.convertLinkCdn("azota_assets/js/ToContext2D.f1.js"),name:"ToContext2D.js"},{link:this.cdnService.convertLinkCdn("azota_assets/js/UDOC.f1.js"),name:"UDOC.js"}]).then(()=>{this.questionService.apiQuestionGetTagsGet().subscribe(n=>{var i;n.success&&n.data?this.questionTags=null!==(i=n.data.objs)&&void 0!==i?i:[]:this.showErrorSnack("lang_auto_tai_thu_vien_that_bao_vui_long_load_lai_trang_de_thu_lai"),this.conf.logConfig.status=!1,this.conf.logConfig.msg=void 0,this.fileParser.loadConf(this.aztLangConfig),this.fileParser.init(),this.conf.isConfigInit=!0,"bank"==this.editorOutputDataService.getMode()&&this.openLibrary(),setTimeout(()=>{this.actionResize()},100)})}).catch(()=>{this.showErrorSnack("lang_auto_tai_thu_vien_that_bao_vui_long_load_lai_trang_de_thu_lai")})})}ngDoCheck(){this.checkTypeActionService()}stopAudio(){window.playMedia&&(window.playMedia.pause(),window.playMedia=void 0)}ngOnDestroy(){super.ngOnDestroy(),this.stopAudio(),this.store.dispatch(Et.qs())}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(ba),t.Y36(wa),t.Y36(Mn.$),t.Y36(Ot.CM),t.Y36(Ot.Zg),t.Y36(Ot.Oe),t.Y36(Ke.U),t.Y36(x.gz),t.Y36(Oi.yh),t.Y36(vt.v),t.Y36(bn),t.Y36(ai.K),t.Y36(ro),t.Y36(Ot.aE))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-azota-editor"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Ta,5),t.Gf(Ca,5),t.Gf(Aa,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.popupConfirm=i.first),t.iGM(i=t.CRH())&&(n.mobileEditor=i.first),t.iGM(i=t.CRH())&&(n.popupOnlyImageEditor=i.first)}},hostBindings:function(e,n){1&e&&t.NdJ("resize",function(a){return n.onResize(a)},!1,t.Jf7)},features:[t.qOj],decls:13,vars:16,consts:[[3,"headerBackTolink","checkBackDialog","confirmTitle","showInput","examName","showConfirmButton","handleBackDialog","handleCancel","handleConfirm"],[1,"main__editor",3,"ngClass"],["class","app-editor",4,"ngIf"],["class","loading-mess",4,"ngIf"],["id","testFinderMask",4,"ngIf"],["type","file",1,"azt-hidden",3,"change"],["fileOpenProcess",""],["popupConfirm",""],[3,"inp","onClose","onInsertLatex",4,"ngIf"],[3,"el_target","onClose","onPushImage",4,"ngIf"],["class","main__homework-save",4,"ngIf"],["class","main__exam-save",4,"ngIf"],[1,"app-editor"],["id","list-quest-panel",3,"scroll"],["class","question-content",4,"ngIf"],["class","question-content","load_effect_lazy","",3,"id","ngStyle",4,"ngFor","ngForOf"],[2,"height","250px"],[3,"class",4,"ngIf"],[1,"question-content"],[1,"box-service","box","border","border-slate-400","dark:border-darkmode-400"],[1,"box-service-content"],[1,"mb-5","tex2jax_process",3,"innerHTML"],["class","box-show-files",4,"ngIf"],["class","box-input-file",4,"ngIf"],[1,"box-show-files"],[1,"box-line"],[4,"ngFor","ngForOf"],[1,"box-file"],[1,"btn","btn-sm",3,"click"],[2,"font-size","15px","padding-top","5px"],[3,"click"],[1,"line-file",3,"title"],[1,"box-input-file"],[3,"onDropFile"],["load_effect_lazy","",1,"question-content",3,"id","ngStyle"],["class","box-service box border border-slate-400 dark:border-darkmode-400",4,"ngIf"],["class","skeleton-box-loading h-100 w-100",4,"ngIf"],["class","fix-content",3,"matTooltip",4,"ngIf"],[1,"box-metadata",3,"innerHTML"],["class","group-box-header",4,"ngIf"],["class","box-service-header",4,"ngIf"],["class","exam-box",4,"ngIf"],["class","exam-box",3,"innerHTML",4,"ngIf"],[1,"fix-content",3,"matTooltip"],[1,"group-box-header"],[1,"title"],[1,"link-option",3,"click"],[1,"box-service-header"],[3,"q","notOnlyQuestEdit","questionTags","onChangeQuest","onApplyAllTag","onError","onLabelClick","onHotKeyPointSync","onExtraInfo","onCut","onDel","onCopy"],[1,"exam-box"],[3,"innerHTML","click"],[4,"ngIf"],["class","mt-4",4,"ngIf"],["class","box-an",4,"ngFor","ngForOf"],[1,"mt-4"],[1,"font-bold"],["class","bag-label",4,"ngFor","ngForOf"],[1,"bag-label"],[1,"box-an"],["class","checkmark",4,"ngIf"],[1,"box-an-label",3,"matTooltipPosition","matTooltip","ngClass","click"],[1,"tex2jax_process","box-an-content",3,"innerHTML","ngClass","click"],[1,"checkmark"],[1,"checkmark_stem"],[1,"checkmark_kick"],[1,"help-title"],[1,"tex2jax_process","help-content","text-slate-500",3,"innerHTML","click"],[1,"exam-box",3,"innerHTML"],[1,"skeleton-box-loading","h-100","w-100"],["id","toolbar__editor",1,"toolbar-editor","box","rounded-none"],[1,"toolbar-left"],["class","toolbar-btn",3,"click",4,"ngIf"],[1,"toolbar-btn",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-5","h-5","lucide","mr-2"],["d","M18 7V4H6l6 8-6 8h12v-3"],[1,"azt-hidden","md:block"],["class","toolbar-btn",4,"ngIf"],[3,"config","editorApiService","onStartProcessFile","onInit"],["class","footer-editor",4,"ngIf"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","17 8 12 3 7 8"],["x1","12","y1","3","x2","12","y2","15"],["x1","12","y1","5","x2","12","y2","19"],["x1","5","y1","12","x2","19","y2","12"],["points","7 10 12 15 17 10"],["x1","12","y1","15","x2","12","y2","3"],[1,"toolbar-btn"],[1,"btn-transpanrent",3,"matMenuTriggerFor"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-5","h-5","lucide"],["cx","12","cy","12","r","1"],["cx","12","cy","5","r","1"],["cx","12","cy","19","r","1"],["menu","matMenu"],[1,"dropdown-menu","show","w-56","relative"],[1,"dropdown-content"],[1,"dropdown-item",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide","mr-2"],["d","M21 2v6h-6"],["d","M3 12a9 9 0 0 1 15-6.7L21 8"],["d","M3 22v-6h6"],["d","M21 12a9 9 0 0 1-15 6.7L3 16"],["x","6","y","14","width","9","height","6","rx","2"],["x","6","y","4","width","16","height","6","rx","2"],["d","M2 2v20"],[1,"footer-editor"],[1,"footer-item"],[1,"text-primary",3,"click"],[1,"loading-mess"],[1,"loading-content"],[1,"icon-msg"],["role","status",1,"spinner-border","spinner-border-sm"],[1,"text-msg"],["id","testFinderMask"],[1,"box","border","border-slate-400","dark:border-darkmode-400",3,"isFirstTime","closeTestFinder"],[3,"inp","onClose","onInsertLatex"],[3,"el_target","onClose","onPushImage"],[1,"main__homework-save"],[3,"onBack"],[1,"main__exam-save"]],template:function(e,n){1&e&&(t.TgZ(0,"editor-layout",0),t.NdJ("handleBackDialog",function(){return n.conf.showEditor()})("handleCancel",function(){return n.cancelAction()})("handleConfirm",function(){return n.saveAction()}),t.TgZ(1,"div",1),t.YNc(2,ts,6,6,"div",2),t.qZA(),t.YNc(3,es,9,3,"div",3),t.YNc(4,ns,2,1,"div",4),t.TgZ(5,"input",5,6),t.NdJ("change",function(a){return n.openFile(a)}),t.qZA(),t._UZ(7,"editor-confirm",null,7),t.YNc(9,is,1,1,"mathtype-editor",8),t.YNc(10,os,1,1,"only-image-editor",9),t.YNc(11,as,2,0,"div",10),t.YNc(12,ss,2,0,"div",11),t.qZA()),2&e&&(t.Q6J("headerBackTolink",n.conf.getBackLink())("checkBackDialog",!n.conf.editor.show)("confirmTitle",0==n.editQuestId?"lang_auto_tiep_tuc":"lang_buttom_save")("showInput",n.conf.editor.show&&!n.editQuestId)("examName",n.title)("showConfirmButton",n.conf.editor.show),t.xp6(1),t.Q6J("ngClass",t.VKq(14,rs,!n.conf.editor.show)),t.xp6(1),t.Q6J("ngIf",n.conf.isConfigInit),t.xp6(1),t.Q6J("ngIf",n.conf.logConfig.status),t.xp6(1),t.Q6J("ngIf",n.conf.startLibrary),t.xp6(5),t.Q6J("ngIf",n.conf.mathEditor.show),t.xp6(1),t.Q6J("ngIf",n.conf.imageEditor.show),t.xp6(1),t.Q6J("ngIf",n.conf.homeworkSave.show),t.xp6(1),t.Q6J("ngIf",n.conf.examSave.show))},styles:['#testFinderMask[_ngcontent-%COMP%]{padding:15px;background-color:#00000085;position:fixed;top:0;bottom:0;left:0;right:0}#testFinderMask[_ngcontent-%COMP%]   app-test-finder[_ngcontent-%COMP%]{display:block;position:fixed;top:15px;right:15px;left:15px;bottom:15px;display:flex;flex-direction:column}.app-editor[_ngcontent-%COMP%]{display:flex;width:100%;height:calc(100vh - 55px);overflow:hidden}.col-questions[_ngcontent-%COMP%], .col-editor[_ngcontent-%COMP%]{width:50%}.col-editor[_ngcontent-%COMP%]{border-left:1px solid #e0e0e0}.toolbar-editor[_ngcontent-%COMP%]{display:flex;--tw-border-opacity: 1;border-bottom:1px solid rgb(var(--color-slate-200)/var(--tw-border-opacity));box-shadow:none;justify-content:space-between}.toolbar-btn[_ngcontent-%COMP%]{padding:10px;border-right:1px solid #e0e0e0;cursor:pointer;display:flex;align-items:center;-webkit-user-select:none;user-select:none;transition-property:color,background-color,border-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-text-decoration-color,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-text-decoration-color,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.2s}.toolbar-btn[_ngcontent-%COMP%]:hover{background-color:#ededed90}.toolbar-right[_ngcontent-%COMP%]   .toolbar-btn[_ngcontent-%COMP%]{border-right:none;border-left:1px solid #e0e0e0}.toolbar-right[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:0;margin-left:5px}.toolbar-left[_ngcontent-%COMP%], .toolbar-right[_ngcontent-%COMP%]{display:flex}.col-questions[_ngcontent-%COMP%]{overflow:auto;position:relative}.question-content[_ngcontent-%COMP%]{margin:10px}.loading-mess[_ngcontent-%COMP%]{width:100vw;height:100vh;position:fixed;z-index:9;top:0;left:0;display:flex;justify-content:center;align-items:center;background-color:#0006}.loading-content[_ngcontent-%COMP%]{text-align:center;color:#000}.loading-content[_ngcontent-%COMP%]   .text-msg[_ngcontent-%COMP%]{font-size:20px;margin-top:10px;background-color:#f0f8ffa3;padding:10px;border-radius:5px}.icon-msg[_ngcontent-%COMP%]{margin-bottom:10px}.text-msg[_ngcontent-%COMP%]{font-size:20px}.footer-editor[_ngcontent-%COMP%]{border-top:1px solid #e0e0e0;display:flex;align-items:center}.footer-editor[_ngcontent-%COMP%]   .footer-item[_ngcontent-%COMP%]{padding:10px}.footer-editor[_ngcontent-%COMP%]   .footer-link[_ngcontent-%COMP%]{color:#2361ae;cursor:pointer}.footer-editor[_ngcontent-%COMP%]   .footer-sp[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}.footer-editor[_ngcontent-%COMP%]   .footer-sp[_ngcontent-%COMP%]:hover   .footer-link-hover[_ngcontent-%COMP%]{display:block}.footer-editor[_ngcontent-%COMP%]   .footer-sp[_ngcontent-%COMP%]   .footer-link-hover[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;width:300px;left:0;top:calc(-25px - 100%);background:antiquewhite;padding:10px;border-radius:5px;box-shadow:#091e4240 0 4px 8px -2px,#091e4214 0 0 0 1px}.footer-editor[_ngcontent-%COMP%]   .footer-sp[_ngcontent-%COMP%]   .footer-link-hover[_ngcontent-%COMP%]:before{content:"";position:absolute;bottom:-6px;left:20px;border-left:10px solid transparent;border-right:10px solid transparent;border-top:10px solid #faebd7}.box-an[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative;cursor:pointer}.box-an[_ngcontent-%COMP%]:hover   .box-an-content[_ngcontent-%COMP%], .box-an[_ngcontent-%COMP%]:hover   .box-an-label[_ngcontent-%COMP%]{outline:1px solid #2462ae}.box-an-label[_ngcontent-%COMP%]{font-weight:700;margin-right:5px;min-width:25px;justify-content:center}.box-an-content[_ngcontent-%COMP%], .box-content[_ngcontent-%COMP%]{padding:5px;outline:1px solid #ccc;border-radius:3px;margin-bottom:5px;align-items:center;overflow-wrap:anywhere}.box-an-label[_ngcontent-%COMP%]{padding:5px;outline:1px solid #ccc;border-radius:3px;margin-bottom:5px;display:flex;align-items:center;overflow-wrap:anywhere}.an-true[_ngcontent-%COMP%]{outline:1px solid #2462ae;color:#2462ae;position:relative}.checkmark[_ngcontent-%COMP%]{position:absolute;left:-25px;display:inline-block;width:22px;height:22px;transform:rotate(45deg)}.checkmark_stem[_ngcontent-%COMP%]{position:absolute;width:3px;height:9px;background-color:#2462ae;left:11px;top:6px}.checkmark_kick[_ngcontent-%COMP%]{position:absolute;width:3px;height:3px;background-color:#2462ae;left:8px;top:12px}.link-tooltip[_ngcontent-%COMP%]{color:#2462ae;cursor:pointer}.box-service-name[_ngcontent-%COMP%], .box-service-question-name[_ngcontent-%COMP%]{outline:1px solid #ccc;padding:3px 10px!important;border-radius:3px;font-weight:500}.box-service-question-name[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}.box-service-question[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap}.box-service-question[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{border-right:none}.box-service-question[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{border-right:none}.box-service-question[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding:0 10px;cursor:pointer;color:#2462ae;border-right:1px solid #ccc}.first-text[_ngcontent-%COMP%]{display:flex;align-items:center}.first-text[_ngcontent-%COMP%]   marquee[_ngcontent-%COMP%]{width:100px}.first-text[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;margin-right:5px;display:flex;justify-content:center;align-items:center}.selection[_ngcontent-%COMP%]{border:1.5px solid #2462ae;box-shadow:#00000073 0 25px 20px -20px}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.inp-point[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:space-between;align-items:center}.inp-point[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:40px;text-align:center;padding:5px;border-radius:5px;outline:1px solid #ccc;border:none}.inp-point[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:1px solid #2262ae;box-shadow:#11111a0d 0 1px,#11111a1a 0 0 8px}.inp-point[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .inp-point[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.inp-point[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.inp-point[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{border-right:none;text-align:left;padding:0 0 0 10px}.hide[_ngcontent-%COMP%]{display:none!important}  .mat-form-field-underline{display:none}  .quest-err{color:#f44336;position:relative;padding-left:20px;display:flex;align-items:center;margin-bottom:10px}  .quest-err:before{content:"!";position:absolute;left:0;color:#fff;background:#f44336;width:15px;height:15px;text-align:center;border-radius:50%;font-size:smaller;display:flex;justify-content:center;align-items:center}.box-service[_ngcontent-%COMP%]{position:relative;margin:10px 0;padding:20px 30px;border-radius:5px;box-shadow:none}.box-service[_ngcontent-%COMP%]:first-child{margin:0 0 10px}.box-service-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:5px}  .img-docx,   .qv_qts_image,   .qv_img-group-content,   .qv_ats_image{cursor:pointer;max-width:100%}  .qv_img-group-content{width:100%}  .qv_full_a_img{cursor:pointer;width:60%}  .qv_full_img{cursor:pointer;width:100%}  .qv_img{cursor:pointer;margin-top:-1px}  .qv_none_image{display:inline-block;color:#2262ae;cursor:pointer}.box-help[_ngcontent-%COMP%]{border-top:1px solid #d7d7d7;margin:15px -30px 0;padding:10px 30px 0}.box-help[_ngcontent-%COMP%]   .help-title[_ngcontent-%COMP%]{text-align:center;font-size:11px;margin-top:-20px}.box-help[_ngcontent-%COMP%]   .help-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:#fff;padding:0 10px;color:#d58e0b}.box-help[_ngcontent-%COMP%]   .help-content[_ngcontent-%COMP%]{font-size:13px}.font-bold[_ngcontent-%COMP%]{font-weight:700}.bag-label[_ngcontent-%COMP%]{border-radius:5px;background:#c0c0c0;padding:4px;font-size:13px;margin-right:5px}.bag-label[_ngcontent-%COMP%]:last-child{margin-right:0}.mt-4[_ngcontent-%COMP%]{margin-top:4px}.mb-5[_ngcontent-%COMP%]{margin-bottom:5px}.box-show-files[_ngcontent-%COMP%]{background:#f0f0f0;border-radius:5px;padding:10px;margin-bottom:3px}@media screen and (max-width: 580px){.app-editor[_ngcontent-%COMP%]{flex-direction:column;height:auto;overflow:auto}.col-questions[_ngcontent-%COMP%], .col-editor[_ngcontent-%COMP%]{width:100%}.main__editor[_ngcontent-%COMP%]{overflow-x:hidden}}  .q-table td{border:1px solid #c0c0c0;padding:3px 10px}  .box-content img,   .box-an-content img{max-width:100%}.group-box-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;position:relative;cursor:pointer}.group-box-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{outline:1px solid #ccc;padding:3px 10px!important;border-radius:3px;font-weight:500}.group-box-header[_ngcontent-%COMP%]   .link-option[_ngcontent-%COMP%]{cursor:pointer;color:#2462ae;margin-left:10px}.fix-content[_ngcontent-%COMP%]{position:absolute;font-size:15px;color:#2361ae;top:0;left:5px;transform:rotate(-45deg)}.lazy_quest[_ngcontent-%COMP%]{width:100%;height:200px}  .skeleton-box-loading{display:inline-block;position:relative;overflow:hidden}  .skeleton-box-loading:after{position:absolute;top:0;right:0;bottom:0;left:0;transform:translate(-100%);animation:shimmer 2s infinite;content:""}@keyframes shimmer{to{transform:translate(100%)}}  .box-service-content .azt-mathml{cursor:pointer}  .box-service-content .azt-mathml:hover{background-color:#ebebeb}button.menu[_ngcontent-%COMP%]{text-transform:none!important}.header-file-name[_ngcontent-%COMP%]{width:100%;text-align:center;border:0}.w-100[_ngcontent-%COMP%]{width:100%}.h-100[_ngcontent-%COMP%]{height:100%}.azt-order-1[_ngcontent-%COMP%]{order:1}.azt-order-2[_ngcontent-%COMP%]{order:2}']}),o})();function cs(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),t._uU(4),t.ALo(5,"mytranslate"),t.qZA(),t.TgZ(6,"div",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.actionClose())}),t.TgZ(7,"mat-icon"),t._uU(8,"close"),t.qZA()()(),t.TgZ(9,"div",6),t._uU(10),t.ALo(11,"mytranslate"),t.qZA(),t.TgZ(12,"div",7),t._UZ(13,"div",8),t.TgZ(14,"div",9)(15,"span",10)(16,"button",11),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.actionClose())}),t._uU(17),t.ALo(18,"mytranslate"),t.qZA()(),t.TgZ(19,"button",12),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.actionClose(!0))}),t._uU(20),t.ALo(21,"mytranslate"),t.qZA()()()()()}if(2&o){const e=t.oxw();t.xp6(4),t.hij(" ",t.lcZ(5,4,"lang_auto_xac_nhan")," "),t.xp6(6),t.hij(" ",t.lcZ(11,6,e.msgConfirm)," "),t.xp6(7),t.hij(" ",t.lcZ(18,8,"lang_auto_huy")," "),t.xp6(3),t.hij(" ",t.lcZ(21,10,"lang_auto_xac_nhan")," ")}}let Ei=(()=>{class o extends mt.Q{constructor(e){super(e),this.commonService=e,this.showConfirm=!1,this.msgConfirm=""}actionClose(e){this.showConfirm=!1,this.callback&&this.callback(e||!1)}startConfirm(e){return new Promise(n=>{this.msgConfirm=e,this.showConfirm=!0,this.callback=i=>{n(i)}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v))},o.\u0275cmp=t.Xpm({type:o,selectors:[["editor-confirm"]],features:[t.qOj],decls:1,vars:1,consts:[["class","box-dialog",4,"ngIf"],[1,"box-dialog"],[1,"dialog","box"],[1,"dialog-header"],[1,"dialog-title"],[1,"dialog-close",3,"click"],[1,"dialog-body"],[1,"dialog-footer"],[1,"dialog-noti"],[1,"dialog-confirm"],[1,"mr-3"],[1,"btn","btn-secondary","mr-2","w-24",3,"click"],[1,"btn","btn-primary","w-24",3,"click"]],template:function(e,n){1&e&&t.YNc(0,cs,22,12,"div",0),2&e&&t.Q6J("ngIf",n.showConfirm)},styles:[".box-dialog[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;top:0;left:0;width:100vw;height:100vh;position:fixed;background-color:#0000004d;z-index:9999}.dialog[_ngcontent-%COMP%]{margin-top:7vh;width:550px;box-shadow:#0000003d 0 3px 8px}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px}.dialog-title[_ngcontent-%COMP%]{font-weight:700}.dialog-close[_ngcontent-%COMP%]{display:flex;align-items:center;border-radius:50%}.dialog-close[_ngcontent-%COMP%]:hover{background-color:#d0d0d04a;cursor:pointer}.dialog-footer[_ngcontent-%COMP%]{display:flex;padding:10px;justify-content:space-between;align-items:center}.dialog-body[_ngcontent-%COMP%]{padding:10px}"]}),o})(),co=(()=>{class o extends mt.Q{constructor(e,n){super(e),this.commonService=e,this.cdnService=n,this.onClose=new t.vpe,this.onPushImage=new t.vpe,this.el=null,this.src_source="",this.is_load_libs=!1}actionClose(){this.onClose.emit()}actionFinish(){this.onPushImage.emit({element:this.el_target,source:this.src_source,output:this.editor._imgCtx.canvas.toDataURL("image/png",1)})}startLoad(){this.is_load_libs=!1,this.commonService.loadScriptPromises([{source:this.cdnService.convertLinkCdn("azota_assets/js/mnpaint_bundle.js?v=0.3"),name:"mnpaint_bundle.js"}]).then(()=>{var e;if(this.is_load_libs=!0,this.el_target){this.src_source=this.el_target.getAttribute("src")||"";var n=document.createElement("img");null===(e=this.el)||void 0===e||e.appendChild(n),n.onload=()=>{var i,a;const r=mnpaint.getInstance();r.startSession(n),r.config.width=null===(i=this.el)||void 0===i?void 0:i.clientWidth,r.config.height=null===(a=this.el)||void 0===a?void 0:a.clientHeight,r.config.resizable=!1,r.config.stopWhenClickOutsize=!1,r.config.stopWhenClickOutside=!1,r.config.autoUpdateSource="change",this.editor=r},n.src=this.src_source}})}uploadImageAction(){this.editor._fileInput.click()}addTextAction(){this.editor._addText()}cropAction(){this.editor._setSelectionType("crop")}undoAction(){this.editor._undo()}redoAction(){this.editor._redo()}zoomAction(e){e?this.editor.zoomIn():this.editor.zoomOut()}ngAfterViewInit(){this.el=document.getElementById("only-image-editor_image__process"),this.startLoad()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Ke.U))},o.\u0275cmp=t.Xpm({type:o,selectors:[["only-image-editor"]],inputs:{el_target:"el_target"},outputs:{onClose:"onClose",onPushImage:"onPushImage"},features:[t.qOj],decls:66,vars:6,consts:[[1,"box-dialog"],[1,"dialog-overlay",3,"click"],[1,"dialog","box"],[1,"dialog-body"],[1,"img-editor-bx"],[1,"bx-content"],[1,"az-editor"],[1,"az-editor-top-bar"],[1,"top-bar-tool",2,"width","55px"],[1,"top-bar-tool"],[1,"top-bar-tool-item"],["matTooltip","Undo",1,"btn-az-text","mr-3",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"icon"],["d","M3 7v6h6"],["d","M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"],["matTooltip","Redo",1,"btn-az-text",3,"click"],["d","M21 7v6h-6"],["d","M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"],["matTooltip","Zoom +",1,"btn-az-text","mr-2",3,"click"],["cx","11","cy","11","r","8"],["x1","21","y1","21","x2","16.65","y2","16.65"],["x1","11","y1","8","x2","11","y2","14"],["x1","8","y1","11","x2","14","y2","11"],["matTooltip","Zoom -",1,"btn-az-text",3,"click"],[1,"az-editor-body"],[1,"az-editor-slide-bar"],[1,"az-tool"],[1,"az-tool-item",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"az-tool-icon"],["d","M6 2v14a2 2 0 0 0 2 2h14"],["d","M18 22V8a2 2 0 0 0-2-2H2"],["points","4 7 4 4 20 4 20 7"],["x1","9","y1","20","x2","15","y2","20"],["x1","12","y1","4","x2","12","y2","20"],["d","M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"],["d","M12 12v9"],["d","m16 16-4-4-4 4"],[1,"az-editor-main"],["id","only-image-editor_image__process",1,"az-editor-content"],[1,"dialog-footer"],[1,"dialog-noti"],[1,"dialog-ok"],[1,"btn","btn-secondary","mr-2","w-20",3,"click"],[1,"btn","btn-primary","w-20",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return n.actionClose()}),t.qZA(),t.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),t._UZ(8,"div",8),t.TgZ(9,"div",9)(10,"div",10)(11,"button",11),t.NdJ("click",function(){return n.undoAction()}),t.O4$(),t.TgZ(12,"svg",12),t._UZ(13,"path",13)(14,"path",14),t.qZA()(),t.kcU(),t.TgZ(15,"button",15),t.NdJ("click",function(){return n.redoAction()}),t.O4$(),t.TgZ(16,"svg",12),t._UZ(17,"path",16)(18,"path",17),t.qZA()()()(),t.kcU(),t.TgZ(19,"div",9)(20,"div",10)(21,"button",18),t.NdJ("click",function(){return n.zoomAction(!0)}),t.O4$(),t.TgZ(22,"svg",12),t._UZ(23,"circle",19)(24,"line",20)(25,"line",21)(26,"line",22),t.qZA()(),t.kcU(),t.TgZ(27,"button",23),t.NdJ("click",function(){return n.zoomAction()}),t.O4$(),t.TgZ(28,"svg",12),t._UZ(29,"circle",19)(30,"line",20)(31,"line",22),t.qZA()()()()(),t.kcU(),t.TgZ(32,"div",24)(33,"div",25)(34,"nav",26)(35,"button",27),t.NdJ("click",function(){return n.cropAction()}),t.O4$(),t.TgZ(36,"svg",28),t._UZ(37,"path",29)(38,"path",30),t.qZA(),t.kcU(),t.TgZ(39,"span"),t._uU(40,"Crop"),t.qZA()(),t.TgZ(41,"button",27),t.NdJ("click",function(){return n.addTextAction()}),t.O4$(),t.TgZ(42,"svg",28),t._UZ(43,"polyline",31)(44,"line",32)(45,"line",33),t.qZA(),t.kcU(),t.TgZ(46,"span"),t._uU(47,"Text"),t.qZA()(),t.TgZ(48,"button",27),t.NdJ("click",function(){return n.uploadImageAction()}),t.O4$(),t.TgZ(49,"svg",28),t._UZ(50,"path",34)(51,"path",35)(52,"path",36),t.qZA(),t.kcU(),t.TgZ(53,"span"),t._uU(54,"Upload"),t.qZA()()()(),t.TgZ(55,"div",37),t._UZ(56,"div",38),t.qZA()()()()()(),t.TgZ(57,"div",39),t._UZ(58,"div",40),t.TgZ(59,"div",41)(60,"button",42),t.NdJ("click",function(){return n.actionClose()}),t._uU(61),t.ALo(62,"mytranslate"),t.qZA(),t.TgZ(63,"button",43),t.NdJ("click",function(){return n.actionFinish()}),t._uU(64),t.ALo(65,"mytranslate"),t.qZA()()()()()),2&e&&(t.xp6(61),t.hij(" ",t.lcZ(62,2,"lang_auto_huy")," "),t.xp6(3),t.hij(" ",t.lcZ(65,4,"lang_auto_luu")," "))},styles:[".box-dialog[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;top:0;left:0;width:100vw;height:100vh;position:fixed;z-index:9999}.box-dialog[_ngcontent-%COMP%]   .dialog-overlay[_ngcontent-%COMP%]{top:0;left:0;width:100vw;height:100vh;position:fixed;background-color:#0000004d}.dialog[_ngcontent-%COMP%]{position:absolute;margin-top:5vh;width:90vw;box-shadow:#0000003d 0 3px 8px}.dialog-title[_ngcontent-%COMP%]{font-weight:700}.dialog-close[_ngcontent-%COMP%]{display:flex;align-items:center;border-radius:50%;color:#5d647b}.dialog-close[_ngcontent-%COMP%]:hover{background-color:#d0d0d04a;cursor:pointer}.dialog-footer[_ngcontent-%COMP%]{display:flex;padding:10px;border-top:1px solid #dfe0e5;justify-content:space-between;align-items:center}.az-editor[_ngcontent-%COMP%]{width:100%}.az-editor-top-bar[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid #dfe0e5;padding:10px}.az-editor-body[_ngcontent-%COMP%]{display:flex}.az-editor-slide-bar[_ngcontent-%COMP%]{border-right:1px solid #dfe0e5;border-top:0px;flex-direction:column;flex-shrink:0;height:70vh;width:80px;overflow:hidden auto}.az-editor-main[_ngcontent-%COMP%]{background:#f7f7f8;width:100%}.az-editor-content[_ngcontent-%COMP%]{width:100%;height:100%}.az-editor-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.top-bar-tool[_ngcontent-%COMP%]{display:flex;margin-right:20px}.top-bar-tool-item[_ngcontent-%COMP%]{display:flex;align-items:center;color:#5d647b;font-size:12px}.top-bar-tool-input[_ngcontent-%COMP%]{border:1px solid #dfe0e5;border-radius:5px;width:50px;color:#5d647b;margin-left:5px;padding-left:3px;padding-right:3px}.az-tool[_ngcontent-%COMP%]{display:flex;flex-direction:column}.az-tool-item[_ngcontent-%COMP%]{padding:10px 24px;position:relative;display:flex;justify-content:center;align-items:center;flex-direction:column;color:#5d647b;background:transparent;border:none;-webkit-user-select:none;user-select:none;text-transform:initial;transition:all .5s}.az-tool-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-top:5px}.az-tool-item[_ngcontent-%COMP%]:hover{color:#1e41af;font-weight:500}.az-tool-icon[_ngcontent-%COMP%]{width:24px;height:24px}.az-tool[_ngcontent-%COMP%]   .active-tool[_ngcontent-%COMP%]{color:#1e41af;font-weight:500}.btn-az-text[_ngcontent-%COMP%]{border:none;background:transparent;color:#5d647b;transition:all .5s}.btn-az-text[_ngcontent-%COMP%]:hover:not([disabled]){color:#1e41af}.btn-az-text[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:24px;height:24px}.btn-az-text[_ngcontent-%COMP%]:disabled{opacity:.5}@media screen and (max-width: 768px){.top-bar-tool[_ngcontent-%COMP%]{margin-right:10px}.top-bar-tool[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}}"]}),o})();var _o=b(55372);const _s=function(o,s){return{left:o,bottom:s}},ds=function(){return{}},us=["*"];let ms=(()=>{class o extends mt.Q{constructor(){super(...arguments),this.isConfig=!0,this.bottom=-60,this.left=-5}}return o.\u0275fac=function(){let s;return function(n){return(s||(s=t.n5z(o)))(n||o)}}(),o.\u0275cmp=t.Xpm({type:o,selectors:[["common-tooltip"]],inputs:{isConfig:"isConfig",bottom:"bottom",left:"left"},features:[t.qOj],ngContentSelectors:us,decls:3,vars:6,consts:[[1,"qv_tooltip"],[1,"content_tooltip"]],template:function(e,n){1&e&&(t.F$t(),t.TgZ(0,"span",0)(1,"span",1),t.Hsn(2),t.qZA()()),2&e&&t.Akn(n.isConfig?t.WLB(2,_s,n.left+"px",n.bottom+"px"):t.DdM(5,ds))},styles:['.qv_tooltip[_ngcontent-%COMP%]{white-space:break-spaces;font-size:11px;position:absolute;z-index:999;width:400px;background:#faebd7;padding:5px 10px;border-radius:5px;font-weight:500;color:#000;box-shadow:#091e4240 0 4px 8px -2px,#091e4214 0 0 0 1px}.qv_tooltip[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-6px;left:20px;border-left:10px solid transparent;border-right:10px solid transparent;border-bottom:10px solid #faebd7}']}),o})();var wn=b(90508),tn=b(47423),ke=b(26688),ge=b(25245),he=b(92181),uo=b(74107),Wt=b(87238),at=b(1033);let hs=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[O.ez,ce.j,h.u5,h.UX,Ht.Z,Dt.Z_]}),o})();t.B6R(_o.X,[O.mk,O.sg,O.O5,wn.ey,tn.lW,ke.qn,ke.HS,ke.qH,ge.Hw,he.VK,he.OP,he.p6,uo.gD,Wt.gM,h.Fj,h.JJ,h.On,ms],[at.bT]),t.B6R(Ei,[O.O5,ge.Hw],[at.bT]),t.B6R(co,[Wt.gM],[at.bT]);var Ii=b(60139),Ve=b(70024),Zi=b(53170),Mi=b(96551),Pi=b(60703),en=b(85053),Li=b(1574),Pn=b(41303),Tn=b(72491),Ni=b(79001),mo=b(50136),De=b(67322),si=b(77531),te=b(91350),oe=b(49692),ri=b(16883),li=b(73727);function ps(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function gs(o,s){1&o&&(t.TgZ(0,"div",70),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_ten_bai_tap")," "))}function fs(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1,"OK"),t.qZA())}function xs(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1,"OK"),t.qZA())}function vs(o,s){1&o&&(t.TgZ(0,"div",71),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_test_config_end_time_bigger_time_star"),". "))}function bs(o,s){1&o&&(t.TgZ(0,"div",84),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_test_config_you_not_yet_class")," "))}function ws(o,s){if(1&o&&(t.TgZ(0,"div",82),t.YNc(1,bs,3,3,"div",83),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",e.form.controls.classroomIds.errors.checkboxValidator)}}const Ts=function(o){return{suppressScrollX:!0,suppressScrollY:o}};function Cs(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"div",72)(2,"div",73)(3,"div",74)(4,"h3",75),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"div",76),t._UZ(8,"azt-list-classroom-checkall",77),t.qZA()(),t.TgZ(9,"div",78)(10,"perfect-scrollbar",79),t.ALo(11,"isMobileOrTable"),t._UZ(12,"azt-list-classroom-checkbox",80),t.qZA()()()(),t.YNc(13,ws,2,1,"div",81),t.BQk()),2&o){const e=t.oxw(2);t.xp6(5),t.hij(" ",t.lcZ(6,11,"lang_auto_danh_sach_cac_lop")," "),t.xp6(3),t.Q6J("form",e.form)("objs",e.classroomObjs)("permissionName",e.permissionTypes.homework),t.xp6(2),t.Q6J("config",t.VKq(15,Ts,t.lcZ(11,13,"")))("scrollIndicators",!0),t.xp6(2),t.Q6J("form",e.form)("objs",e.classroomObjs)("homeworkObj",e.homeworkObj)("permissionName",e.permissionTypes.homework),t.xp6(1),t.Q6J("ngIf",e.form.controls.classroomIds.errors)}}function As(o,s){if(1&o&&(t.TgZ(0,"div",85)(1,"div",86)(2,"span",87),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.TgZ(5,"span",88),t._uU(6),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(3),t.hij(" ",t.lcZ(4,2,"lang_auto_da_giao_bai_tap_cho_lop")+": "," "),t.xp6(3),t.hij(" ",e.classroomObj.name," ")}}function ys(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",89),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.saveNewOrConfigHomework(0))}),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("disabled",e.form.invalid||e.checkDeadLineValid(e.form.controls.homeworkStartDate.value,e.form.controls.homeworkDeadline.value)<0),t.xp6(1),t.hij(" ",t.lcZ(2,2,"lang_auto_luu_nhap")," ")}}function ks(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",2)(1,"form",3)(2,"div",4)(3,"div",5)(4,"h3",6),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"div",7)(8,"div",8)(9,"div",9)(10,"label",10),t._uU(11),t.ALo(12,"mytranslate"),t.qZA()(),t.TgZ(13,"div",9)(14,"div",11),t._UZ(15,"input",12),t.ALo(16,"mytranslate"),t.qZA(),t.YNc(17,gs,3,3,"div",13),t.qZA()(),t.TgZ(18,"div",14)(19,"div",15)(20,"label",16),t._uU(21),t.ALo(22,"mytranslate"),t.O4$(),t.TgZ(23,"svg",17),t.ALo(24,"mytranslate"),t._UZ(25,"circle",18)(26,"line",19)(27,"line",20),t.qZA()()(),t.kcU(),t.TgZ(28,"div",15)(29,"div",21)(30,"div",22)(31,"mat-form-field",23)(32,"input",24),t.NdJ("click",function(){t.CHM(e);const i=t.MAs(43);return t.KtG(i.open())}),t.ALo(33,"mytranslate"),t.qZA(),t.TgZ(34,"button",25),t.NdJ("click",function(i){return t.CHM(e),t.MAs(43).open(),t.KtG(i.stopPropagation())}),t.O4$(),t.TgZ(35,"svg",26),t._UZ(36,"path",27)(37,"path",28)(38,"path",29)(39,"path",30)(40,"path",31)(41,"path",32),t.qZA()(),t.kcU(),t.TgZ(42,"ngx-mat-datetime-picker",null,33),t.YNc(44,fs,2,0,"ng-template"),t.qZA()()(),t.TgZ(45,"div",22)(46,"mat-form-field",23)(47,"input",34),t.NdJ("click",function(){t.CHM(e);const i=t.MAs(58);return t.KtG(i.open())}),t.ALo(48,"mytranslate"),t.qZA(),t.TgZ(49,"button",25),t.NdJ("click",function(i){return t.CHM(e),t.MAs(58).open(),t.KtG(i.stopPropagation())}),t.O4$(),t.TgZ(50,"svg",26),t._UZ(51,"path",27)(52,"path",28)(53,"path",29)(54,"path",30)(55,"path",31)(56,"path",32),t.qZA()(),t.kcU(),t.TgZ(57,"ngx-mat-datetime-picker",null,35),t.YNc(59,xs,2,0,"ng-template"),t.qZA()()(),t.TgZ(60,"div",36)(61,"button",37),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.clearTime())}),t.O4$(),t.TgZ(62,"svg",38),t._UZ(63,"path",39)(64,"path",40)(65,"path",41)(66,"path",42),t.qZA(),t._uU(67),t.ALo(68,"mytranslate"),t.qZA()()(),t.kcU(),t.TgZ(69,"div",43)(70,"div",44),t._uU(71),t.ALo(72,"mytranslate"),t.qZA(),t.YNc(73,vs,3,3,"div",45),t.qZA()()(),t.TgZ(74,"div",46)(75,"div",47)(76,"label",48),t._uU(77),t.ALo(78,"mytranslate"),t.qZA()(),t.TgZ(79,"div",49)(80,"div",50)(81,"div",51),t._UZ(82,"input",52),t.TgZ(83,"label",53),t._uU(84),t.ALo(85,"mytranslate"),t.qZA()(),t.TgZ(86,"div",54),t._UZ(87,"input",55),t.TgZ(88,"label",56),t._uU(89),t.ALo(90,"mytranslate"),t.qZA()()()()(),t.TgZ(91,"div",57)(92,"div",47)(93,"label",48),t._uU(94),t.ALo(95,"mytranslate"),t.qZA()(),t.TgZ(96,"div",49)(97,"div",50)(98,"div",51),t._UZ(99,"input",58),t.TgZ(100,"label",59),t._uU(101),t.ALo(102,"mytranslate"),t.qZA()(),t.TgZ(103,"div",54),t._UZ(104,"input",60),t.TgZ(105,"label",61),t._uU(106),t.ALo(107,"mytranslate"),t.qZA()()()()(),t.TgZ(108,"div",62)(109,"div",63)(110,"div",64),t._uU(111),t.ALo(112,"mytranslate"),t.qZA()(),t.YNc(113,Cs,14,17,"ng-container",0),t.YNc(114,As,7,4,"ng-template",null,65,t.W1O),t.qZA()(),t.TgZ(116,"div",66)(117,"div",67),t.YNc(118,ys,3,4,"button",68),t.TgZ(119,"button",69),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.saveNewOrConfigHomework(1))}),t._uU(120),t.ALo(121,"mytranslate"),t.qZA()()()()()()()}if(2&o){const e=t.MAs(43),n=t.MAs(58),i=t.MAs(115),a=t.oxw();t.xp6(1),t.Q6J("formGroup",a.form),t.xp6(4),t.hij(" ",t.lcZ(6,26,"lang_auto_cau_hinh_chung")," "),t.xp6(6),t.hij(" ",t.lcZ(12,28,"lang_auto_ten")," "),t.xp6(4),t.s9C("placeholder",t.lcZ(16,30,"lang_auto_nhap_ten")+" ..."),t.xp6(2),t.Q6J("ngIf",a.form.controls.homeworkName.errors),t.xp6(4),t.hij(" ",t.lcZ(22,32,"lang_testbank_test_config_time_assigne_homework")," "),t.xp6(2),t.s9C("matTooltip",t.lcZ(24,34,"lang_homework_add_home_work_startDate_introduce")),t.xp6(9),t.s9C("placeholder",t.lcZ(33,36,"lang_auto_tu")),t.Q6J("ngxMatDatetimePicker",e),t.xp6(15),t.s9C("placeholder",t.lcZ(48,38,"lang_auto_den")),t.Q6J("ngxMatDatetimePicker",n),t.xp6(20),t.hij(" ",t.lcZ(68,40,"lang_auto_dat_lai")," "),t.xp6(4),t.hij(" ",t.lcZ(72,42,"lang_auto_bo_trong_neu_khong_muon_gioi_han_thoi_gian"),". "),t.xp6(2),t.Q6J("ngIf",a.calculatorTimeValidate(a.form.controls.homeworkDeadline.value,a.form.controls.homeworkStartDate.value)<0),t.xp6(4),t.hij(" ",t.lcZ(78,44,"lang_auto_cho_xem_ket_qua")," "),t.xp6(7),t.hij(" ",t.lcZ(85,46,"lang_auto_khong")," "),t.xp6(5),t.hij(" ",t.lcZ(90,48,"lang_auto_co")," "),t.xp6(5),t.hij(" ",t.lcZ(95,50,"lang_auto_dang_nhap_de_nop_bai")," "),t.xp6(7),t.hij(" ",t.lcZ(102,52,"lang_auto_khong")," "),t.xp6(5),t.hij(" ",t.lcZ(107,54,"lang_auto_co")," "),t.xp6(5),t.hij(" ",t.lcZ(112,56,"lang_auto_giao_cho_lop")," "),t.xp6(2),t.Q6J("ngIf","2"==a.form.controls.whoAllow.value)("ngIfElse",i),t.xp6(5),t.Q6J("ngIf",1!=a.homeworkObj.isPublished),t.xp6(1),t.Q6J("disabled",a.form.invalid||a.checkDeadLineValid(a.form.controls.homeworkStartDate.value,a.form.controls.homeworkDeadline.value)<0),t.xp6(1),t.hij(" ",t.lcZ(121,58,"lang_auto_xuat_ban")," ")}}let ho=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_,d,m){super(e),this.commonService=e,this.formBuilder=n,this.activeRoute=i,this.timeService=a,this.documentConfigService=r,this.editorOutputDataService=l,this.homeworkService=c,this.userService=_,this.sEAztClassroomCheckboxService=d,this.uploadImageOfHomeworkService=m,this.onBack=new t.vpe,this.form=new h.nJ({}),this.permissionTypes=en.$,this.homeworkId=0,this.homeworkHashId="",this.classroomObjs=[],this.classroomObj={},this.homeworkObj={},this.isUpdate=!1,this.homeWorkContent="",this.createHomeworkEditorData={}}redirectBackTo(){this.onBack.emit()}clearTime(){this.form.controls.homeworkDeadline.setValue(""),this.form.controls.homeworkStartDate.setValue("")}clearTimeStart(){this.form.controls.homeworkStartDate.setValue("")}calculatorTimeValidate(e,n){return""!=e&&""!=n?this.timeService.calculationHomeworkTime(e,n):0}checkDeadLineValid(e,n){return""!=e&&""!=n?this.timeService.getDiffFromTwoDate(n,e):0}saveNewOrConfigHomework(e){var n,i;this.isUpdate?this.updateHomework(e):(this.initStatusObj(),this.homeWorkContent=null!==(i=null===(n=this.createHomeworkEditorData.homework)||void 0===n?void 0:n.content)&&void 0!==i?i:"",this.uploadImageOfHomeworkService.replaceImageInContent(this.homeWorkContent).subscribe(a=>{null==a.errorMessage?(this.homeWorkContent=a.content,this.createHomework(e)):(this.showErrorSnack(a.errorMessage),this.stopStatusObj())}))}updateHomework(e){let n=this.commonService.getFormObj(this.form);n.homeworkStartDate=""===n.homeworkStartDate||null===n.homeworkStartDate?null:(0,O.p6)(n.homeworkStartDate,"yyyy-MM-ddTHH:mm:00","en_vn"),n.homeworkDeadline=""===n.homeworkDeadline||null===n.homeworkDeadline?null:(0,O.p6)(n.homeworkDeadline,"yyyy-MM-ddTHH:mm:00","en_vn");var i=this.sEAztClassroomCheckboxService.findClassroomWithNoPermission(this.classroomObjs,en.$.homework);const a=this.sEAztClassroomCheckboxService.getClassroomIdsChecked(this.classroomObjs,i,n.classroomIds);this.initStatusObj();let r={name:n.homeworkName,startDate:n.homeworkStartDate,deadline:n.homeworkDeadline,mustVerified:n.mustVerified,whenShowAnswer:parseInt(n.whenShowAnswer),enableUpdateDeadLine:1,classroomIds:2==n.whoAllow?a:void 0,isPublished:e||(null!=this.homeworkObj?this.homeworkObj.isPublished:0)};this.subscriptions.add(this.documentConfigService.apiDocumentConfigSaveHomeworkConfigPost(r,this.homeworkHashId).subscribe(l=>{var c,_,d,m;if(1==l.success){let C=null!==(c=this.commonService.getMyParam(this.activeRoute,"cat_id"))&&void 0!==c?c:"";var p=[];if(null!==(_=l.data)&&void 0!==_&&_.objs)for(var w=0;w<l.data.objs.length;w++)p.push(null===(d=l.data)||void 0===d?void 0:d.objs[w].hashId);let A=`/admin/testbank/config-homework/${null!=C?C:0}/${this.homeworkHashId}`;this.myNavigationWithQueryString(`/admin/testbank/publish-document/1/${null!=C?C:0}/${JSON.stringify(p)}`,`?backto=${A}`),this.successStatusObj(r.isPublished?"lang_auto_xuat_ban_thanh_cong":"lang_auto_luu_thanh_cong_chua_xuat_ban",!0)}else this.errorStatusObj(null!==(m=l.message)&&void 0!==m?m:"",!0)}))}createHomework(e){var n,i;let a=this.commonService.getFormObj(this.form);a.homeworkStartDate=""===a.homeworkStartDate||null===a.homeworkStartDate?null:(0,O.p6)(a.homeworkStartDate,"yyyy-MM-ddTHH:mm:00","en_vn"),a.homeworkDeadline=""===a.homeworkDeadline||null===a.homeworkDeadline?null:(0,O.p6)(a.homeworkDeadline,"yyyy-MM-ddTHH:mm:00","en_vn");var r=this.sEAztClassroomCheckboxService.findClassroomWithNoPermission(this.classroomObjs,en.$.homework);const l=this.sEAztClassroomCheckboxService.getClassroomIdsChecked(this.classroomObjs,r,a.classroomIds);if(this.form.invalid)this.showErrorSnack(l.length<=0?"lang_auto_please_select_classroom":"lang_auto_vui_long_nhap_day_du_thong_tin");else{this.initStatusObj();let c=this.userService.getUserObj(),_=JSON.stringify({type:"homework",id:this.homeworkId,user:c.id}),d={name:a.homeworkName,content:this.homeWorkContent,files:null!==(i=null===(n=this.createHomeworkEditorData.homework)||void 0===n?void 0:n.files)&&void 0!==i?i:"",startDate:a.homeworkStartDate,deadline:a.homeworkDeadline,mustVerified:a.mustVerified,whenShowAnswer:parseInt(a.whenShowAnswer),classroomIds:l,isPublished:e,categoryId:this.commonService.getMyParam(this.activeRoute,"cat_id")?Number(this.commonService.getMyParam(this.activeRoute,"cat_id")):0};this.subscriptions.add(this.homeworkService.apiHomeworkSaveObjPost(d,_).subscribe(m=>{var p,w,C,A;if(1==m.success){let q=null!==(p=this.commonService.getMyParam(this.activeRoute,"cat_id"))&&void 0!==p?p:"";if(d.isPublished){this.successStatusObj("lang_auto_xuat_ban_thanh_cong",!0);var M=[];if(null!==(w=m.data)&&void 0!==w&&w.objs)for(var D=0;D<m.data.objs.length;D++)M.push(null===(C=m.data)||void 0===C?void 0:C.objs[D].hashId);let U=`/admin/testbank/config-homework/${null!=q?q:0}/${this.homeworkHashId}`;this.myNavigationWithQueryString(`/admin/testbank/publish-document/1/${null!=q?q:0}/${JSON.stringify(M)}`,`?backto=${U}`)}else this.myNavigationWithQueryString("/admin/testbank/document-management/1/0/1",`?backto=/admin/testbank/config-homework/${null!=q?q:0}/${this.homeworkHashId}`),this.successStatusObj("lang_auto_luu_thanh_cong_chua_xuat_ban",!0);this.successStatusObj()}else this.errorStatusObj(null!==(A=m.message)&&void 0!==A?A:"",!0)}))}}getHomework(e){this.initStatusObj(),this.subscriptions.add(this.documentConfigService.apiDocumentConfigGetHomeworkConfigDataPost([],e).subscribe(n=>{var i,a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt;if(1==n.success){this.classroomObjs=null!==(a=null===(i=null==n?void 0:n.data)||void 0===i?void 0:i.classroomObjs)&&void 0!==a?a:new Array,this.homeworkObj=null!==(l=null===(r=null==n?void 0:n.data)||void 0===r?void 0:r.homeworkObj)&&void 0!==l?l:{};let W=null!==(_=null===(c=this.homeworkObj)||void 0===c?void 0:c.classroomId)&&void 0!==_?_:0;if(W){for(let R=0;R<this.classroomObjs.length;R++)if(this.classroomObjs[R].id==W){this.classroomObj=this.classroomObjs[R];break}}else this.classroomObj=this.classroomObjs.length>0?this.classroomObjs[0]:{};this.createHomeworkEditorData=this.isUpdate?this.createHomeworkEditorData:this.editorOutputDataService.getOutputData();let P=null!==(w=null!==(m=null===(d=this.createHomeworkEditorData.homework)||void 0===d?void 0:d.name)&&void 0!==m?m:null===(p=this.homeworkObj)||void 0===p?void 0:p.name)&&void 0!==w?w:"";this.form.patchValue({homeworkName:P,homeworkStartDate:null!=(null===(C=this.homeworkObj)||void 0===C?void 0:C.startDate)?null===(A=this.homeworkObj)||void 0===A?void 0:A.startDate:"",homeworkDeadline:null!=(null===(M=this.homeworkObj)||void 0===M?void 0:M.deadline)?null===(D=this.homeworkObj)||void 0===D?void 0:D.deadline:"",mustVerified:1==(null===(q=this.homeworkObj)||void 0===q?void 0:q.mustVerified)?"1":"0",whenShowAnswer:1==(null===(U=this.homeworkObj)||void 0===U?void 0:U.whenShowAnswer)?"1":"0",whoAllow:null!==(F=n.data)&&void 0!==F&&F.hasStudentAnswers&&this.isUpdate?"1":"2"}),this.successStatusObj()}else this.errorStatusObj(null!==(tt=n.message)&&void 0!==tt?tt:"",!0)}))}ngOnInit(){(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var e;this.homeworkHashId=null!==(e=this.commonService.getMyParam(this.activeRoute,"hash_id"))&&void 0!==e?e:"",this.homeworkHashId?(this.isUpdate=!0,this.getHomework(this.homeworkHashId)):(this.isUpdate=!1,this.getHomework("add_new")),this.form=this.formBuilder.group({homeworkName:new h.p4("",[h.kI.required,Pn._.noWhiteSpace]),homeworkStartDate:new h.p4(""),homeworkDeadline:new h.p4(""),mustVerified:new h.p4("0"),whoAllow:new h.p4(this.isUpdate?"1":"2"),whenShowAnswer:new h.p4("1"),classroomIds:this.formBuilder.array([])},{validators:[Li.h.classroomCheckBoxValidator]})}),this.commonService.translateMetaData({title:"lang_cms__config_title",description:"lang_cms_config_homework_description",image:""}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(h.QS),t.Y36(x.gz),t.Y36(Tn.O),t.Y36(Ot.Cq),t.Y36(bn),t.Y36(Ot.Lk),t.Y36(ai.K),t.Y36(Ni.L),t.Y36(mo.J))},o.\u0275cmp=t.Xpm({type:o,selectors:[["main-config-homework"]],outputs:{onBack:"onBack"},features:[t._Bn([{provide:Ve.fM,useClass:Pi.HF,deps:[wn.Ad,Zi.o8]},{provide:Ve.ab,useValue:Mi.O}]),t.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"intro-y","mt-5"],[3,"formGroup"],[1,"azt-config-document","mx-auto","p-5",2,"max-width","1000px"],[1,"setting-basic"],[1,"text-md","uppercase","font-medium"],[1,"box","mt-2","p-5"],["id","azt-config-name",1,"grid","grid-cols-12"],[1,"col-span-12","lg:col-span-12"],["for","homework-name",1,"form-label","mb-0","font-medium","flex","items-center"],[1,"setting-input"],["id","homework-name","formControlName","homeworkName","type","text",1,"form-control",3,"placeholder"],["class","text-xs text-danger mt-2",4,"ngIf"],["id","azt-config-time-assignment",1,"grid","grid-cols-12","mt-4"],[1,"col-span-12"],["for","regular-form-1",1,"form-label","mb-0","font-medium","flex","items-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","ml-2",3,"matTooltip"],["cx","12","cy","12","r","10"],["x1","12","y1","16","x2","12","y2","12"],["x1","12","y1","8","x2","12.01","y2","8"],[1,"grid","grid-cols-12","gap-3"],[1,"col-span-12","md:col-span-5"],["appearance","outline"],["matInput","","formControlName","homeworkStartDate","readonly","",3,"placeholder","ngxMatDatetimePicker","click"],["matSuffix","",2,"font-size","18px",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide"],["d","M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5"],["d","M16 2v4"],["d","M8 2v4"],["d","M3 10h5"],["d","M17.5 17.5 16 16.25V14"],["d","M22 16a6 6 0 1 1-12 0 6 6 0 0 1 12 0Z"],["startTime",""],["matInput","","formControlName","homeworkDeadline","readonly","",3,"placeholder","ngxMatDatetimePicker","click"],["endTime",""],[1,"col-span-6","md:col-span-2"],[1,"btn","btn-outline-secondary","w-full",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["d","M10 2h4"],["d","M12 14v-4"],["d","M4 13a8 8 0 0 1 8-7 8 8 0 1 1-5.3 14L4 17.6"],["d","M9 17H4v5"],[1,"text-xs","mt-2"],[1,"text-slate-500","mt-1"],["class","text-danger mt-1",4,"ngIf"],["id","azt-config-when-result",1,"grid","grid-cols-12","mt-4"],[1,"col-span-12","lg:col-span-5"],[1,"form-label","mb-0","font-medium","flex","items-center"],[1,"col-span-12","lg:col-span-7"],[1,"flex","flex-col","sm:flex-row"],[1,"form-check","mr-8"],["id","whenShowAnswer-off","type","radio","formControlName","whenShowAnswer","value","1",1,"form-check-input"],["for","whenShowAnswer-off",1,"form-check-label"],[1,"form-check","mr-8","mt-2","sm:mt-0"],["id","whenShowAnswer-tested","type","radio","formControlName","whenShowAnswer","value","0",1,"form-check-input"],["for","whenShowAnswer-tested",1,"form-check-label","flex","items-center"],["id","azt-config-login-require",1,"grid","grid-cols-12","mt-4"],["id","mustVerified-off","type","radio","formControlName","mustVerified","value","0",1,"form-check-input"],["for","mustVerified-off",1,"form-check-label"],["id","mustVerified-tested","type","radio","formControlName","mustVerified","value","1",1,"form-check-input"],["for","mustVerified-tested",1,"form-check-label","flex","items-center"],["id","azt-config-who-allow",1,"grid","grid-cols-12","mt-4"],[1,"col-span-12","lg:col-span-5","pr-5"],[1,"mb-0","font-medium","flex","items-center"],["elseAllowed",""],[1,"my-5"],[1,"text-right"],["class","btn btn-pending w-24 mr-2",3,"disabled","click",4,"ngIf"],[1,"btn","w-24","btn-primary",3,"disabled","click"],[1,"text-xs","text-danger","mt-2"],[1,"text-danger","mt-1"],[1,"col-span-12","mt-4","intro-y"],[1,"border","border-slate-200/60","dark:border-darkmode-400","rounded-md","pb-1"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","items-center"],[1,"mr-auto"],[1,"flex"],["formArrayName","classroomIds",3,"form","objs","permissionName"],[1,"classroom_list"],[3,"config","scrollIndicators"],["formArrayName","classroomIds",3,"form","objs","homeworkObj","permissionName"],["class","col-span-12 mt-2 intro-y",4,"ngIf"],[1,"col-span-12","mt-2","intro-y"],["class","text-xs text-danger",4,"ngIf"],[1,"text-xs","text-danger"],[1,"col-span-12","mt-4"],[1,"bg-slate-100","dark:bg-darkmode-600","rounded-md","p-3"],[1,"text-md"],[1,"text-md","font-medium"],[1,"btn","btn-pending","w-24","mr-2",3,"disabled","click"]],template:function(e,n){if(1&e&&(t.YNc(0,ps,1,0,"azt-loading-effect",0),t.YNc(1,ks,122,60,"ng-template",null,1,t.W1O)),2&e){const i=t.MAs(2);t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.O5,De.KE,De.R9,si.Nt,Wt.gM,Ve.AB,Ve.g2,Lt.Vv,h._Y,h.Fj,h._,h.JJ,h.JL,h.sg,h.u,h.CE,te.Q,oe.M,ri.o,li.g,at.bT,at.bd],encapsulation:2}),o})();var po=b(85003),Os=b(90649),Cn=b(44262);function Ss(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",12),t._UZ(1,"path",13)(2,"polyline",14)(3,"line",15)(4,"line",16)(5,"line",17),t.qZA())}function Es(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",12),t._UZ(1,"path",13)(2,"polyline",14),t.qZA())}function Is(o,s){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,Ss,6,0,"svg",11),t.YNc(2,Es,3,0,"svg",11),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",1==(null==e.dataObj.homework?null:e.dataObj.homework.isPublished)),t.xp6(1),t.Q6J("ngIf",1!=(null==e.dataObj.homework?null:e.dataObj.homework.isPublished))}}function Zs(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",20),t.ALo(1,"mytranslate"),t._UZ(2,"path",13)(3,"polyline",14)(4,"path",21),t.qZA()),2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_testbank_folder_and_file_published"))}function Ms(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",22),t.ALo(1,"mytranslate"),t._UZ(2,"path",13)(3,"polyline",14),t.qZA()),2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_testbank_folder_and_file_Unpublished"))}function Ps(o,s){if(1&o&&(t.YNc(0,Zs,5,3,"svg",18),t.YNc(1,Ms,4,3,"svg",19)),2&o){const e=t.oxw();t.Q6J("ngIf",1==(null==e.dataObj.exam?null:e.dataObj.exam.isPublished)),t.xp6(1),t.Q6J("ngIf",1!=(null==e.dataObj.exam?null:e.dataObj.exam.isPublished))}}function Ls(o,s){if(1&o&&(t.TgZ(0,"div",7),t._uU(1),t.ALo(2,"mytranslate"),t.ALo(3,"date"),t.ALo(4,"mytranslate"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.AsE(" ",t.lcZ(2,2,"lang_auto_thoi_gian_nop_bai"),": ",e.dataObj.deadline?t.xi3(3,4,e.dataObj.deadline,"dd/MM/yyyy HH:mm"):t.lcZ(4,7,"lang_auto_khong_thoi_han")," ")}}function Ns(o,s){if(1&o&&(t.TgZ(0,"div",7),t._uU(1),t.ALo(2,"mytranslate"),t.ALo(3,"mytranslate"),t.ALo(4,"mytranslate"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.AsE(" ",t.lcZ(2,2,"lang_auto_thoi_gian_lam_bai"),": ",null!=e.dataObj.exam&&e.dataObj.exam.minutes?(null==e.dataObj.exam?null:e.dataObj.exam.minutes)+" "+t.lcZ(3,4,"lang_auto_phut"):t.lcZ(4,6,"lang_auto_khong_thoi_han")," ")}}function Ds(o,s){if(1&o&&(t.TgZ(0,"span",23),t.ALo(1,"mytranslate"),t._uU(2),t.TgZ(3,"span",24),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()()),2&o){const e=t.oxw();t.s9C("matTooltip",t.lcZ(1,3,"lang_auto_luot_lam")),t.xp6(2),t.hij(" ",e.dataObj.submited+" "," "),t.xp6(2),t.Oqu(t.lcZ(5,5,"lang_auto_luot_lam"))}}function js(o,s){if(1&o&&(t.TgZ(0,"span",23),t.ALo(1,"mytranslate"),t._uU(2),t.TgZ(3,"span",24),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()()),2&o){const e=t.oxw();t.s9C("matTooltip",t.lcZ(1,3,"lang_auto_da_nop")),t.xp6(2),t.hij(" ",e.dataObj.submited+"/"+e.dataObj.total+" "," "),t.xp6(2),t.Oqu(t.lcZ(5,5,"lang_auto_da_nop"))}}const qs=function(o){return{"bg-slate-100 dark:bg-darkmode-400":o}};let Di=(()=>{class o extends mt.Q{constructor(e){super(e),this.commonService=e,this.dataObj={},this.showByClass=!1,this.viewType=""}ngOnInit(){super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v))},o.\u0275cmp=t.Xpm({type:o,selectors:[["azt-file-item"]],inputs:{dataObj:"dataObj",showByClass:"showByClass",viewType:"viewType"},features:[t.qOj],decls:19,vars:20,consts:[[1,"box","p-3","flex","items-center","zoom-in",2,"min-height","102px",3,"ngClass"],[1,"flex-none","image-fit","rounded-md","overflow-hidden"],[4,"ngIf","ngIfElse"],["ExamIcon",""],[1,"ml-4","mr-auto","w-2/3"],[1,"font-medium","truncate",3,"matTooltip","isDisabledTooltip","matTooltipDisabled"],["c","isDisabled"],[1,"text-slate-500","text-xs","mt-0.5"],["class","text-slate-500 text-xs mt-0.5",4,"ngIf"],[1,"py-1","px-2","rounded-full","text-xs","bg-success","text-white","cursor-pointer","font-medium"],[3,"matTooltip",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","class","w-10 h-10 lucide text-primary","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-10","h-10","lucide","text-primary"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["x1","16","y1","13","x2","8","y2","13"],["x1","16","y1","17","x2","8","y2","17"],["x1","10","y1","9","x2","8","y2","9"],["class","w-10 h-10 text-pending lucide","xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",3,"matTooltip",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","class","w-10 h-10 lucide text-pending","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",3,"matTooltip",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-10","h-10","text-pending","lucide",3,"matTooltip"],["d","m9 15 2 2 4-4"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-10","h-10","lucide","text-pending",3,"matTooltip"],[3,"matTooltip"],[1,"azt-hidden","md:inline-block"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,Is,3,2,"div",2),t.YNc(3,Ps,2,2,"ng-template",null,3,t.W1O),t.qZA(),t.TgZ(5,"div",4)(6,"div",5,6),t._uU(8),t.qZA(),t.TgZ(9,"div",7)(10,"span"),t._uU(11),t.ALo(12,"mytranslate"),t.ALo(13,"date"),t.qZA()(),t.YNc(14,Ls,5,9,"div",8),t.YNc(15,Ns,5,8,"div",8),t.qZA(),t.TgZ(16,"div",9),t.YNc(17,Ds,6,7,"span",10),t.YNc(18,js,6,7,"span",10),t.qZA()()),2&e){const i=t.MAs(4),a=t.MAs(7);t.Q6J("ngClass",t.VKq(18,qs,"classroom"==n.viewType)),t.xp6(2),t.Q6J("ngIf","homework"==n.dataObj.type)("ngIfElse",i),t.xp6(4),t.s9C("matTooltip",n.dataObj.name),t.Q6J("isDisabledTooltip",!1)("matTooltipDisabled",a.isDisabled),t.xp6(2),t.hij(" ",n.dataObj.name," "),t.xp6(3),t.AsE("",t.lcZ(12,13,"lang_auto_ngay_tao"),": ",t.xi3(13,15,n.dataObj.createdAt,"dd/MM/yyyy HH:mm"),""),t.xp6(3),t.Q6J("ngIf","homework"==n.dataObj.type),t.xp6(1),t.Q6J("ngIf","exam"==n.dataObj.type),t.xp6(2),t.Q6J("ngIf","exam"==n.dataObj.type),t.xp6(1),t.Q6J("ngIf","homework"==n.dataObj.type)}},dependencies:[O.mk,O.O5,Wt.gM,Cn.Q,O.uU,at.bT],encapsulation:2}),o})();function Qs(o,s){1&o&&(t.TgZ(0,"span",14),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_chia_se")))}function Us(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",17)(1,"a",18),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.handleClick(a))}),t._UZ(2,"azt-file-item",19),t.qZA()()}if(2&o){const e=s.$implicit,n=t.oxw(3);t.xp6(2),t.Q6J("curCateId",n.currentCategoryId)("dataObj",e)("showDeliver",!1)("showByClass",!0)("viewType","classroom")}}function Fs(o,s){if(1&o&&(t.TgZ(0,"div")(1,"div",15),t.YNc(2,Us,3,5,"div",16),t.qZA()()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngForOf",e.recommendDataObjs)}}function Rs(o,s){1&o&&(t.TgZ(0,"div",20),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_homework_classroom_list_not_found_homework")," "))}const Bs=function(o){return{cursor:o}};function Js(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"a",6,7),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.goToClass(a))}),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.YNc(7,Qs,3,3,"span",8),t.ALo(8,"fullPermission"),t.TgZ(9,"div",9)(10,"button",10),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.viewAllDocumentClass(a))}),t._uU(11),t.ALo(12,"mytranslate"),t.qZA()()(),t.TgZ(13,"div",11),t.YNc(14,Fs,3,1,"div",12),t.YNc(15,Rs,3,3,"ng-template",null,13,t.W1O),t.qZA()()()}if(2&o){const e=s.$implicit,n=t.MAs(4),i=t.MAs(16),a=t.oxw();t.xp6(3),t.s9C("matTooltip",e.name),t.Q6J("ngStyle",t.VKq(16,Bs,e.id?"pointer":"default"))("isDisabledTooltip",!1)("matTooltipDisabled",n.isDisabled),t.xp6(2),t.hij(" ",t.lcZ(6,9,e.name)," "),t.xp6(2),t.Q6J("ngIf",0==a.checkPermissionObj(t.xi3(8,11,e.permissionObj,"classroom"))),t.xp6(4),t.hij(" ",t.lcZ(12,14,"lang_auto_xem_tat_ca")," "),t.xp6(3),t.Q6J("ngIf",e.recommendDataObjs&&e.recommendDataObjs.length>0)("ngIfElse",i)}}const Hs=function(){return["name"]};let zs=(()=>{class o extends mt.Q{constructor(e,n,i,a){super(e),this.commonService=e,this.activeRoute=n,this.dialog=i,this.documentService=a,this.cateObjs=[],this.classroomWithDocument=[],this.viewType=1,this.isOnLib=0,this.ExistClipboard=!1,this.searchKey="",this.isShowContextmenu=!1,this.isSort=!1,this.isSortByPublish=!1,this.isSortByPrice=!1,this.isSortByDateUpdated=!1,this.isSortByAttended=!1,this.currentCategoryId=0,this.page=0,this.dataDialogWarning={isShow:!1,content:""},this.demoData=[]}checkPermissionObj(e){return e}goToClass(e){e.id&&this.commonService.myNavigationWithQueryString("/admin/student/class-details/"+e.id,"?backto="+encodeURIComponent(`/admin/testbank/document-management/1/${this.currentCategoryId}/${this.page}`))}viewAllDocumentClass(e){this.commonService.myNavigationWithQueryString("/admin/testbank/all-documents-in-class/"+e.id+"/1","?backto="+encodeURIComponent(`/admin/testbank/document-management/1/${this.currentCategoryId}/${this.page}`))}handleClick(e){var n,i,a,r;"exam"==e.type?this.commonService.myNavigationWithQueryString("/admin/testbank/exam-results-list/"+this.currentCategoryId+"/"+(null===(n=e.exam)||void 0===n?void 0:n.id)+"/0","?backto="+encodeURIComponent("/admin/testbank/document-management/0/"+this.currentCategoryId+"/1")):"homework"==e.type&&this.commonService.myNavigationWithQueryString("/admin/testbank/homework-results-list/"+(null===(i=e.homework)||void 0===i?void 0:i.classroomId)+"/"+(null===(a=e.homework)||void 0===a?void 0:a.id)+"/"+(null===(r=e.homework)||void 0===r?void 0:r.hashId),"?backto="+encodeURIComponent("/admin/testbank/document-management/1/"+this.currentCategoryId+"/1"))}getDataForClasses(){this.initStatusObj(),this.documentService.apiDocumentsGet(this.currentCategoryId,"category").subscribe(e=>{var n,i,a;1==e.success?(this.cateObjs=null!==(i=null===(n=e.data)||void 0===n?void 0:n.categoryObjs)&&void 0!==i?i:[],this.successStatusObj()):this.errorStatusObj(null!==(a=e.message)&&void 0!==a?a:"",!0)})}ngOnInit(){(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{this.currentCategoryId=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")),this.page=Number(this.commonService.getMyParam(this.activeRoute,"page"))}),this.commonService.translateMetaData({title:"lang_testbank_document_list_header_title",description:"lang_testbank_document_list_header_description",image:"lang_cms_test_image"})}ngOnDestroy(){super.ngOnDestroy()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(x.gz),t.Y36(j.uw),t.Y36(Os.Z))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-folder-and-classes"]],inputs:{classroomWithDocument:"classroomWithDocument",viewType:"viewType",isOnLib:"isOnLib",ExistClipboard:"ExistClipboard",searchKey:"searchKey"},features:[t.qOj],decls:4,vars:7,consts:[["id","contentent-view-2"],[1,"grid","grid-cols-12","gap-6"],["class","col-span-12 sm:col-span-6 lg:col-span-4 2xl:col-span-3",4,"ngFor","ngForOf"],[1,"col-span-12","sm:col-span-6","lg:col-span-4","2xl:col-span-3"],[1,"box",2,"min-height","300px"],[1,"flex","items-center","p-3","border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"font-medium","truncate","text-md",2,"max-width","40%",3,"ngStyle","matTooltip","isDisabledTooltip","matTooltipDisabled","click"],["c","isDisabled"],["class","ml-2 py-0.5 px-2 rounded-full text-xs bg-primary text-white cursor-pointer font-medium",4,"ngIf"],[1,"ml-auto"],[1,"btn","btn-outline-primary","btn-transparent","p-2",3,"click"],[1,"p-3"],[4,"ngIf","ngIfElse"],["noDocumentData",""],[1,"ml-2","py-0.5","px-2","rounded-full","text-xs","bg-primary","text-white","cursor-pointer","font-medium"],[1,"grid","grid-cols-12","gap-3"],["class","col-span-12 intro-y",4,"ngFor","ngForOf"],[1,"col-span-12","intro-y"],[3,"click"],[3,"curCateId","dataObj","showDeliver","showByClass","viewType"],[1,"box","py-3","text-center"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,Js,17,18,"div",2),t.ALo(3,"appFilter"),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngForOf",t.gM2(3,1,n.classroomWithDocument,n.searchKey,t.DdM(6,Hs),!0)))},dependencies:[O.sg,O.O5,O.PC,Wt.gM,Di,Cn.Q,at.bT,at.gB,at.Gf],encapsulation:2}),o})(),Ys=(()=>{class o{constructor(e,n){this.dialogRef=e,this.data=n}onNoClick(){this.dialogRef.close(!1)}onAccept(){this.dialogRef.close(!0)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(j.so),t.Y36(j.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["multiple-delete-confirm"]],decls:35,vars:22,consts:[[1,"box",2,"max-width","500px"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-5"],[1,"text-md","font-medium","flex","items-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-6","h-6","mr-2","text-danger"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],[1,"font-medium"],[1,"mt-2"],[1,"text-xs","text-slate-500","dark:text-slate-400"],[2,"text-transform","lowercase"],[1,"p-3","text-right"],[1,"btn","btn-secondary","w-24","mr-2",3,"click"],[1,"btn","w-24","btn-danger",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t.O4$(),t.TgZ(4,"svg",4),t._UZ(5,"path",5)(6,"path",6)(7,"path",7)(8,"line",8)(9,"line",9),t.qZA(),t.kcU(),t.TgZ(10,"span"),t._uU(11),t.ALo(12,"mytranslate"),t.TgZ(13,"span",10),t._uU(14),t.qZA(),t._uU(15),t.ALo(16,"mytranslate"),t.qZA()(),t.TgZ(17,"div",11)(18,"p",12)(19,"span"),t._uU(20),t.ALo(21,"mytranslate"),t.qZA(),t.TgZ(22,"span",13),t._uU(23),t.ALo(24,"mytranslate"),t.qZA(),t.TgZ(25,"span"),t._uU(26),t.ALo(27,"mytranslate"),t.qZA()()()()(),t.TgZ(28,"div",14)(29,"button",15),t.NdJ("click",function(){return n.onNoClick()}),t._uU(30),t.ALo(31,"mytranslate"),t.qZA(),t.TgZ(32,"button",16),t.NdJ("click",function(){return n.onAccept()}),t._uU(33),t.ALo(34,"mytranslate"),t.qZA()()()),2&e&&(t.xp6(11),t.hij(" ",t.lcZ(12,8,"lang_auto_ban_co_chac_chan_muon_xoa")," "),t.xp6(3),t.Oqu(n.data.totalSelected+" "),t.xp6(1),t.hij(" ",t.lcZ(16,10,"lang_auto_tai_lieu_vua_chon")," "),t.xp6(5),t.Oqu(t.lcZ(21,12,"lang_auto_khi_xac_nhan")+", "),t.xp6(3),t.Oqu(t.lcZ(24,14,"lang_auto_tai_lieu")),t.xp6(3),t.Oqu(t.lcZ(27,16,"lang_auto_se_duoc_chuyen_vao_thung_rac_ban_co_the_dot")),t.xp6(4),t.hij(" ",t.lcZ(31,18,"lang_cms_common_close_btn")," "),t.xp6(3),t.hij(" ",t.lcZ(34,20,"lang_cms_common_confirm_btn")," "))},dependencies:[at.bT],encapsulation:2}),o})();const Gs=["class","html"];let $s=(()=>{class o{constructor(e,n){this.dialogRef=e,this.data=n}onNoClick(){this.dialogRef.close()}redirectToYTB(){window.open("https://www.youtube.com/watch?v=FpcOtHNGMCQ")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(j.so),t.Y36(j.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["notice-dialog",8,"html"]],attrs:Gs,decls:18,vars:12,consts:[[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],[1,"intro-y"],[1,"text-base","font-medium","mr-auto"],[1,"clickable","ytb--button","clickable",3,"click"],["alt","",1,"img",3,"src"],[1,"text-right","mt-3"],[1,"btn","w-24","btn-secondary",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()(),t._UZ(7,"br"),t.TgZ(8,"div",3)(9,"div",5),t.NdJ("click",function(){return n.redirectToYTB()}),t._UZ(10,"img",6),t.ALo(11,"convertCdn"),t._uU(12),t.ALo(13,"mytranslate"),t.qZA()(),t.TgZ(14,"div",7)(15,"button",8),t.NdJ("click",function(){return n.onNoClick()}),t._uU(16),t.ALo(17,"mytranslate"),t.qZA()()()()()),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,4,"lang_testbank_folder_and_file_note_tutorial")),t.xp6(5),t.Q6J("src",t.lcZ(11,6,"azota_assets/images/iconYoutube.svg"),t.LSH),t.xp6(2),t.hij(" ",t.lcZ(13,8,"lang_testbank_folder_and_file_see_tutorial")," "),t.xp6(4),t.hij("",t.lcZ(17,10,"lang_buttom_close")," "))},dependencies:[at.bT,at.BI],styles:[".img[_ngcontent-%COMP%]{\n    display: initial;\n    vertical-align: middle;\n    margin-right: 5px;\n  }"]}),o})();var Ws=b(51541),Ln=b(69287),ci=b(90167);function Ks(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.name)," ")}}function Vs(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," ")}}const Xs=function(o){return{active:o}},tr=function(o){return{clickable:o}},er=function(o){return{"truncate-bread":o}};function nr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li",21)(1,"a",22),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.goBackParent(a))}),t.TgZ(2,"span",23,24),t.ALo(4,"mytranslate"),t.YNc(5,Ks,3,3,"span",10),t.YNc(6,Vs,2,1,"span",10),t.qZA()()()}if(2&o){const e=s.$implicit,n=t.MAs(3),i=t.oxw();t.Q6J("ngClass",t.VKq(10,Xs,e.id==i.categoryId)),t.xp6(1),t.Q6J("ngClass",t.VKq(12,tr,e.id!=i.categoryId)),t.xp6(1),t.s9C("matTooltip",t.lcZ(4,8,e.name)),t.Q6J("ngClass",t.VKq(14,er,e.id!=i.categoryId))("isDisabledTooltip",!1)("matTooltipDisabled",n.isDisabled),t.xp6(3),t.Q6J("ngIf",-1==e.id),t.xp6(1),t.Q6J("ngIf",-1!=e.id)}}function ir(o,s){if(1&o&&(t.TgZ(0,"span",29),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.AsE("",t.lcZ(2,2,"lang_auto_da_chon")," ",e.totalSelectCopyOrCut,"")}}function or(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.acceptCopyDocument())}),t.O4$(),t.TgZ(1,"svg",31),t._UZ(2,"rect",32)(3,"path",33),t.qZA(),t._uU(4," Copy "),t.qZA()}}function ar(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.acceptCutDocument())}),t.O4$(),t.TgZ(1,"svg",31),t._UZ(2,"polyline",34)(3,"polyline",35)(4,"polyline",36)(5,"polyline",37)(6,"line",38)(7,"line",39),t.qZA(),t._uU(8," Cut "),t.qZA()}}function sr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",40),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.acceptDeleteDocument())}),t.O4$(),t.TgZ(1,"svg",31),t._UZ(2,"path",41)(3,"path",42)(4,"path",43)(5,"line",44)(6,"line",45),t.qZA(),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()}2&o&&(t.xp6(7),t.hij(" ",t.lcZ(8,1,"lang_auto_xoa")," "))}function rr(o,s){if(1&o&&(t.TgZ(0,"div",25),t.YNc(1,ir,3,4,"span",26),t.YNc(2,or,5,0,"button",27),t.YNc(3,ar,9,0,"button",27),t.YNc(4,sr,9,3,"button",28),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.totalSelectCopyOrCut>0),t.xp6(1),t.Q6J("ngIf",0==e.isOnLib),t.xp6(1),t.Q6J("ngIf",0==e.isOnLib&&!e.shareType),t.xp6(1),t.Q6J("ngIf",0==e.isOnLib&&!e.shareType)}}function lr(o,s){1&o&&(t.TgZ(0,"div",46)(1,"div",47),t.O4$(),t.TgZ(2,"svg",48),t._UZ(3,"path",49)(4,"path",50)(5,"path",51)(6,"path",52),t.qZA(),t.kcU(),t.TgZ(7,"p",53),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()()()),2&o&&(t.xp6(8),t.hij("",t.lcZ(9,1,"lang_not_found_search"),"!"))}function cr(o,s){if(1&o){const e=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"input",82),t.NdJ("change",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.selectAllDocument())}),t.qZA()}}function _r(o,s){1&o&&(t.O4$(),t.kcU(),t._UZ(0,"input",83)),2&o&&t.Q6J("disabled",!0)}function dr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"span",54)(1,"input",102),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw(3).$implicit,r=t.oxw(2);return t.KtG(r.selectDocument(i,a.id,0))}),t.qZA()()}if(2&o){const e=t.oxw().$implicit;t.Q6J("formGroup",e)}}function ur(o,s){if(1&o&&(t.TgZ(0,"span"),t.YNc(1,dr,2,1,"span",101),t.qZA()),2&o){const e=s.$implicit,n=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf",0==e.controls.type.value&&e.controls.id.value==n.id)}}function mr(o,s){if(1&o&&(t.O4$(),t.kcU(),t.TgZ(0,"span",100),t.YNc(1,ur,2,1,"span",80),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.form.controls.clipboardObjs.controls)}}function hr(o,s){1&o&&(t.O4$(),t.kcU(),t._UZ(0,"input",103))}function pr(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",104),t.ALo(2,"mytranslate"),t._UZ(3,"path",105)(4,"path",106)(5,"path",107),t.qZA()()),2&o&&(t.xp6(1),t.s9C("matTooltip",t.lcZ(2,1,"lang_auto_da_chia_se")))}function gr(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",108),t._UZ(1,"path",109),t.qZA())}function fr(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function xr(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.name)," ")}}function vr(o,s){1&o&&(t.TgZ(0,"span",110),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_chia_se")))}function br(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",84)(1,"div",85)(2,"div",86)(3,"div",87)(4,"div",88)(5,"button",89),t.NdJ("click",function(i){const r=t.CHM(e).$implicit,l=t.oxw(2),c=t.MAs(19);return t.KtG(l.onContextMenu(i,r,c))}),t.O4$(),t.TgZ(6,"svg",60),t._UZ(7,"circle",61)(8,"circle",62)(9,"circle",63),t.qZA()(),t.YNc(10,mr,2,1,"span",90),t.ALo(11,"fullPermission"),t.YNc(12,hr,1,0,"ng-template",null,91,t.W1O),t.kcU(),t.TgZ(14,"div",92),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.handleOpenFolder(a))}),t.YNc(15,pr,6,3,"span",93),t.YNc(16,gr,2,0,"ng-template",null,94,t.W1O),t.qZA(),t.TgZ(18,"div",95,24),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.handleOpenFolder(a))}),t.YNc(20,fr,2,1,"span",10),t.YNc(21,xr,3,3,"span",10),t.qZA(),t.YNc(22,vr,3,3,"span",96),t.qZA()(),t.TgZ(23,"div",72),t._UZ(24,"div",97),t.qZA(),t.TgZ(25,"div",72),t._UZ(26,"div",74),t.qZA(),t.TgZ(27,"div",72),t._UZ(28,"div",98),t.qZA(),t.TgZ(29,"div",72)(30,"div",99),t._uU(31),t.ALo(32,"date"),t.qZA()()()()()}if(2&o){const e=s.$implicit,n=t.MAs(13),i=t.MAs(17),a=t.MAs(19);t.oxw(2);const r=t.MAs(35),l=t.MAs(19);t.s9C("id","folder_"+e.id),t.Q6J("contextMenu",!e.id||e.id<0||"user"==e.shareType?r:l)("contextMenuSubject",e),t.xp6(5),t.Q6J("disabled",!e.id||e.id<0||"user"==e.shareType),t.xp6(5),t.Q6J("ngIf",-1!=e.id&&t.xi3(11,15,e.permissionObj,"exam"))("ngIfElse",n),t.xp6(5),t.Q6J("ngIf",e.shared)("ngIfElse",i),t.xp6(3),t.s9C("matTooltip",e.name),t.Q6J("isDisabledTooltip",!1)("matTooltipDisabled",a.isDisabled),t.xp6(2),t.Q6J("ngIf",-1!=e.id),t.xp6(1),t.Q6J("ngIf",-1==e.id),t.xp6(1),t.Q6J("ngIf",-1==e.id),t.xp6(9),t.hij(" ",t.xi3(32,18,e.updatedAt,"dd/MM/yyyy HH:mm:00")," ")}}function wr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",59),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw(2).$implicit,r=t.oxw(2),l=t.MAs(22);return t.KtG(r.onContextMenu(i,a.exam,l))}),t.O4$(),t.TgZ(1,"svg",60),t._UZ(2,"circle",61)(3,"circle",62)(4,"circle",63),t.qZA()()}}function Tr(o,s){if(1&o){const e=t.EpF();t.ynx(0,54),t.TgZ(1,"input",123),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw(4).$implicit,r=t.oxw(2);return t.KtG(r.selectDocument(i,a.exam.id,1))}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw().$implicit;t.Q6J("formGroup",e)}}function Cr(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Tr,2,1,"ng-container",101),t.BQk()),2&o){const e=s.$implicit,n=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngIf",1==e.controls.type.value&&e.controls.id.value==n.exam.id)}}function Ar(o,s){if(1&o&&(t.TgZ(0,"span",100),t.YNc(1,Cr,2,1,"ng-container",80),t.qZA()),2&o){const e=t.oxw(4);t.xp6(1),t.Q6J("ngForOf",e.form.controls.clipboardObjs.controls)}}function yr(o,s){1&o&&t._UZ(0,"input",124),2&o&&t.Q6J("disabled",!0)}function kr(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",125),t.ALo(1,"mytranslate"),t._UZ(2,"path",126)(3,"polyline",127)(4,"path",128),t.qZA()),2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_testbank_folder_and_file_published"))}function Or(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",125),t.ALo(1,"mytranslate"),t._UZ(2,"path",126)(3,"polyline",127),t.qZA()),2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_testbank_folder_and_file_Unpublished"))}function Sr(o,s){if(1&o&&(t.TgZ(0,"span",129,24),t._uU(2),t.ALo(3,"slice"),t.qZA()),2&o){const e=t.MAs(1),n=t.oxw(2).$implicit,i=t.oxw(2);t.Q6J("matTooltip",i.getClassName(n.exam.classrooms).join(", "))("isDisabledTooltip",!1)("matTooltipDisabled",e.isDisabled),t.xp6(2),t.Oqu(i.getClassName(n.exam.classrooms).join(", ").length>100?t.Dn7(3,4,i.getClassName(n.exam.classrooms).join(", "),0,100)+"..":i.getClassName(n.exam.classrooms).join(", "))}}function Er(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_tat_ca_moi_nguoi")))}function Ir(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",112)(1,"div",85)(2,"div",86)(3,"div",87)(4,"div",88),t.YNc(5,wr,5,0,"button",113),t.YNc(6,Ar,2,1,"span",90),t.ALo(7,"fullPermission"),t.ALo(8,"copyPermission"),t.YNc(9,yr,1,1,"ng-template",null,114,t.W1O),t.TgZ(11,"div",115),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.handleListTestedExam(i.exam))}),t.YNc(12,kr,5,3,"svg",116),t.YNc(13,Or,4,3,"svg",117),t.qZA(),t.TgZ(14,"div",95,24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.handleListTestedExam(i.exam))}),t.TgZ(16,"span",118),t._uU(17),t.qZA()()()(),t.TgZ(18,"div",72)(19,"div",97)(20,"span",119),t._uU(21),t.qZA()()(),t.TgZ(22,"div",72)(23,"div",120)(24,"span",119)(25,"span"),t._uU(26),t.ALo(27,"mytranslate"),t.ALo(28,"mytranslate"),t.qZA()()()(),t.TgZ(29,"div",72)(30,"div",121)(31,"span",119),t.YNc(32,Sr,4,8,"span",122),t.YNc(33,Er,3,3,"span",10),t.qZA()()(),t.TgZ(34,"div",72)(35,"div",99),t._uU(36),t.ALo(37,"date"),t.qZA()()()()()}if(2&o){const e=t.MAs(10),n=t.MAs(15),i=t.oxw().$implicit,a=t.oxw(2),r=t.MAs(35),l=t.MAs(22);t.s9C("id","exam_"+i.exam.id),t.Q6J("contextMenu",!i.exam.permissionObj||a.isEmptyObj(i.exam.permissionObj)?r:l)("contextMenuSubject",i.exam),t.xp6(5),t.Q6J("ngIf",null!=i.exam.permissionObj),t.xp6(1),t.Q6J("ngIf",t.xi3(7,17,i.exam.permissionObj,"exam")||t.xi3(8,20,i.exam.permissionObj,"exam"))("ngIfElse",e),t.xp6(6),t.Q6J("ngIf",1==i.exam.isPublished),t.xp6(1),t.Q6J("ngIf",1!=i.exam.isPublished),t.xp6(1),t.s9C("matTooltip",i.exam.name),t.Q6J("isDisabledTooltip",!1)("matTooltipDisabled",n.isDisabled),t.xp6(3),t.Oqu(i.exam.name),t.xp6(4),t.hij(" ",i.exam.attended," "),t.xp6(5),t.Oqu(1==i.exam.isPublished?t.lcZ(27,23,"lang_testbank_folder_and_file_published"):t.lcZ(28,25,"lang_testbank_folder_and_file_Unpublished")),t.xp6(6),t.Q6J("ngIf",i.exam.classrooms&&i.exam.classrooms.length>0),t.xp6(1),t.Q6J("ngIf",!i.exam.classrooms||0==i.exam.classrooms.length),t.xp6(3),t.hij(" ",t.xi3(37,27,i.exam.updatedAt,"dd/MM/yyyy HH:mm:00")," ")}}function Zr(o,s){if(1&o){const e=t.EpF();t.ynx(0,54),t.TgZ(1,"input",102),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw(4).$implicit,r=t.oxw(2);return t.KtG(r.selectDocument(i,a.homework.id,2))}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw().$implicit;t.Q6J("formGroup",e)}}function Mr(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Zr,2,1,"ng-container",101),t.BQk()),2&o){const e=s.$implicit,n=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngIf",2==e.controls.type.value&&e.controls.id.value==n.homework.id)}}function Pr(o,s){if(1&o&&(t.O4$(),t.kcU(),t.TgZ(0,"span",100),t.YNc(1,Mr,2,1,"ng-container",80),t.qZA()),2&o){const e=t.oxw(4);t.xp6(1),t.Q6J("ngForOf",e.form.controls.clipboardObjs.controls)}}function Lr(o,s){1&o&&(t.O4$(),t.kcU(),t._UZ(0,"input",137))}function Nr(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",138),t._UZ(1,"path",139),t.qZA())}function Dr(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",140),t._UZ(1,"path",126)(2,"path",141)(3,"path",142),t.qZA())}function jr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",112)(1,"div",85)(2,"div",86)(3,"div",87)(4,"div",130),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.handleHomeworkScoreList(i.homework))}),t.TgZ(5,"button",59),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw(2),l=t.MAs(29);return t.KtG(r.onContextMenu(i,a.homework,l))}),t.O4$(),t.TgZ(6,"svg",60),t._UZ(7,"circle",61)(8,"circle",62)(9,"circle",63),t.qZA()(),t.YNc(10,Pr,2,1,"span",90),t.ALo(11,"fullPermission"),t.ALo(12,"copyPermission"),t.YNc(13,Lr,1,0,"ng-template",null,131,t.W1O),t.kcU(),t.TgZ(15,"div",132),t.YNc(16,Nr,2,0,"svg",133),t.YNc(17,Dr,4,0,"svg",134),t.qZA(),t.TgZ(18,"div",135,24),t._uU(20),t.qZA()()(),t.TgZ(21,"div",72)(22,"div",97)(23,"span",119),t._uU(24),t.qZA()()(),t.TgZ(25,"div",72)(26,"div",120)(27,"span"),t._uU(28),t.ALo(29,"mytranslate"),t.ALo(30,"mytranslate"),t.qZA()()(),t.TgZ(31,"div",72)(32,"div",136)(33,"span",119)(34,"span"),t._uU(35),t.ALo(36,"mytranslate"),t.qZA()()()(),t.TgZ(37,"div",72)(38,"div",99),t._uU(39),t.ALo(40,"date"),t.qZA()()()()()}if(2&o){const e=t.MAs(14),n=t.MAs(19),i=t.oxw().$implicit;t.oxw(2);const a=t.MAs(29);t.s9C("id","homework_"+i.homework.id),t.Q6J("contextMenu",a)("contextMenuSubject",i.homework),t.xp6(10),t.Q6J("ngIf",t.xi3(11,16,i.homework.permissionObj,"homework")||t.xi3(12,19,i.homework.permissionObj,"homework"))("ngIfElse",e),t.xp6(6),t.Q6J("ngIf",1==i.homework.isPublished),t.xp6(1),t.Q6J("ngIf",1!=i.homework.isPublished),t.xp6(1),t.s9C("matTooltip",i.homework.name),t.Q6J("isDisabledTooltip",!1)("matTooltipDisabled",n.isDisabled),t.xp6(2),t.hij(" ",i.homework.name," "),t.xp6(4),t.AsE(" ",i.homework.count,"/",i.homework.totalStudent," "),t.xp6(4),t.Oqu(1==i.homework.isPublished?t.lcZ(29,22,"lang_testbank_folder_and_file_published"):t.lcZ(30,24,"lang_testbank_folder_and_file_Unpublished")),t.xp6(7),t.hij(" ",i.homework.className?i.homework.className:t.lcZ(36,26,"lang_auto_tat_ca_moi_nguoi"),""),t.xp6(4),t.hij(" ",t.xi3(40,28,i.homework.updatedAt,"dd/MM/yyyy HH:mm:00")," ")}}function qr(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Ir,38,30,"div",111),t.YNc(2,jr,41,31,"div",111),t.BQk()),2&o){const e=s.$implicit;t.xp6(1),t.Q6J("ngIf","exam"==e.type&&e.exam),t.xp6(1),t.Q6J("ngIf","homework"==e.type&&e.homework)}}const _n=function(o){return{"text-primary stroke-width-2.5":o}},dn=function(){return["name"]};function Qr(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",54)(2,"div",55)(3,"div",56)(4,"div",57)(5,"div",58)(6,"button",59),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw(),r=t.MAs(32);return t.KtG(a.onContextMenu(i,a.currentObj,r))}),t.O4$(),t.TgZ(7,"svg",60),t._UZ(8,"circle",61)(9,"circle",62)(10,"circle",63),t.qZA()(),t.YNc(11,cr,1,0,"input",64),t.YNc(12,_r,1,1,"ng-template",null,65,t.W1O),t.kcU(),t.TgZ(14,"div",66),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleSort(i.isSort))}),t._uU(15),t.ALo(16,"mytranslate"),t.TgZ(17,"div",67),t.O4$(),t.TgZ(18,"svg",68),t._UZ(19,"polyline",69),t.qZA(),t.TgZ(20,"svg",70),t._UZ(21,"polyline",71),t.qZA()()()(),t.kcU(),t.TgZ(22,"div",72)(23,"div",73),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleSortByAttended(i.isSortByAttended))}),t._uU(24),t.ALo(25,"mytranslate"),t.TgZ(26,"div",67),t.O4$(),t.TgZ(27,"svg",68),t._UZ(28,"polyline",69),t.qZA(),t.TgZ(29,"svg",70),t._UZ(30,"polyline",71),t.qZA()()()(),t.kcU(),t.TgZ(31,"div",72)(32,"div",74)(33,"div",73),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleSortByPublish(i.isSortByPublish))}),t._uU(34),t.ALo(35,"mytranslate"),t.TgZ(36,"div",67),t.O4$(),t.TgZ(37,"svg",68),t._UZ(38,"polyline",69),t.qZA(),t.TgZ(39,"svg",70),t._UZ(40,"polyline",71),t.qZA()()()()(),t.kcU(),t.TgZ(41,"div",72)(42,"div",75),t._uU(43),t.ALo(44,"mytranslate"),t.qZA()(),t.TgZ(45,"div",72)(46,"div",76),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleSortByDateUpdated(i.isSortByDateUpdated))}),t.TgZ(47,"div",77),t._uU(48),t.ALo(49,"mytranslate"),t.qZA(),t.TgZ(50,"div",67),t.O4$(),t.TgZ(51,"svg",68),t._UZ(52,"polyline",69),t.qZA(),t.TgZ(53,"svg",70),t._UZ(54,"polyline",71),t.qZA()()()()()(),t.kcU(),t.TgZ(55,"div",78),t.YNc(56,br,33,21,"div",79),t.ALo(57,"appFilter"),t.YNc(58,qr,3,2,"ng-container",80),t.ALo(59,"appFilter"),t.qZA(),t._UZ(60,"div",81),t.qZA()(),t.BQk()}if(2&o){const e=t.MAs(13),n=t.oxw();t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(10),t.Q6J("ngIf",-1!=n.currentCategoryId&&!n.shareType)("ngIfElse",e),t.xp6(4),t.hij(" ",t.lcZ(16,18,"lang_testbank_folder_and_file_name")," "),t.xp6(3),t.Q6J("ngClass",t.VKq(36,_n,n.isSort)),t.xp6(2),t.Q6J("ngClass",t.VKq(38,_n,!n.isSort)),t.xp6(4),t.hij(" ",t.lcZ(25,20,"lang_testbank_folder_and_file_number_attended")," "),t.xp6(3),t.Q6J("ngClass",t.VKq(40,_n,n.isSortByAttended)),t.xp6(2),t.Q6J("ngClass",t.VKq(42,_n,!n.isSortByAttended)),t.xp6(5),t.hij(" ",t.lcZ(35,22,"lang_testbank_folder_and_file_status")," "),t.xp6(3),t.Q6J("ngClass",t.VKq(44,_n,n.isSortByPublish)),t.xp6(2),t.Q6J("ngClass",t.VKq(46,_n,!n.isSortByPublish)),t.xp6(4),t.hij(" ",t.lcZ(44,24,"lang_testbank_folder_and_file_delivery_for")," "),t.xp6(5),t.hij(" ",t.lcZ(49,26,"lang_testbank_folder_and_file_time_update")," "),t.xp6(3),t.Q6J("ngClass",t.VKq(48,_n,n.isSortByDateUpdated)),t.xp6(2),t.Q6J("ngClass",t.VKq(50,_n,!n.isSortByDateUpdated)),t.xp6(3),t.Q6J("ngForOf",t.Dn7(57,28,n.cateObjs,n.searchKey,t.DdM(52,dn))),t.xp6(2),t.Q6J("ngForOf",t.Dn7(59,32,n.documentObjs,n.searchKey,t.DdM(53,dn)))}}function Ur(o,s){if(1&o&&t._UZ(0,"azt-share",147),2&o){const e=t.oxw(2).$implicit;t.Q6J("type",4)("typeObj","CATEGORY")("id",e.id)("permissionObj",e.permissionObj)}}function Fr(o,s){1&o&&(t.TgZ(0,"li"),t._UZ(1,"hr",148),t.qZA())}function Rr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleEditFolder(i))}),t.O4$(),t.TgZ(2,"svg",150),t._UZ(3,"path",151)(4,"path",152),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_buttom_edit")," "))}function Br(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleCopyFolder(i))}),t.O4$(),t.TgZ(2,"svg",153),t._UZ(3,"path",154)(4,"path",155),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_auto_copy")," "))}function Jr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleCutFolder(i))}),t.O4$(),t.TgZ(2,"svg",153),t._UZ(3,"polyline",34)(4,"polyline",35)(5,"polyline",36)(6,"polyline",37)(7,"line",38)(8,"line",39),t.qZA(),t._uU(9),t.ALo(10,"mytranslate"),t.qZA()()}2&o&&(t.xp6(9),t.hij(" ",t.lcZ(10,1,"lang_auto_cut")," "))}function Hr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handlePasteFolder(i.id))}),t.O4$(),t.TgZ(2,"svg",153),t._UZ(3,"rect",156)(4,"path",157),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_auto_paste")," "))}function zr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.removeAllCutOrCopy())}),t.O4$(),t.TgZ(2,"svg",153),t._UZ(3,"circle",158)(4,"line",159)(5,"line",160),t.qZA(),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()}2&o&&(t.xp6(6),t.hij(" ",t.lcZ(7,1,"lang_auto_huy_copycut")," "))}function Yr(o,s){1&o&&(t.TgZ(0,"li"),t._UZ(1,"hr",148),t.qZA())}function Gr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleDeleteFolder(i,0))}),t.O4$(),t.TgZ(2,"svg",161),t._UZ(3,"path",41)(4,"path",42)(5,"path",43)(6,"line",44)(7,"line",45),t.qZA(),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()()}2&o&&(t.xp6(8),t.hij(" ",t.lcZ(9,1,"lang_buttom_delete")," "))}function $r(o,s){if(1&o&&(t.TgZ(0,"div",144)(1,"ul",145)(2,"li"),t.YNc(3,Ur,1,4,"azt-share",146),t.ALo(4,"sharePermission"),t.qZA(),t.YNc(5,Fr,2,0,"li",10),t.ALo(6,"fullPermission"),t.YNc(7,Rr,7,3,"li",10),t.ALo(8,"editPermission"),t.YNc(9,Br,7,3,"li",10),t.ALo(10,"copyPermission"),t.YNc(11,Jr,11,3,"li",10),t.ALo(12,"deletePermission"),t.YNc(13,Hr,7,3,"li",10),t.ALo(14,"editPermission"),t.YNc(15,zr,8,3,"li",10),t.ALo(16,"editPermission"),t.YNc(17,Yr,2,0,"li",10),t.ALo(18,"fullPermission"),t.YNc(19,Gr,10,3,"li",10),t.ALo(20,"deletePermission"),t.qZA()()),2&o){const e=t.oxw().$implicit,n=t.oxw();t.xp6(3),t.Q6J("ngIf",t.xi3(4,9,e.permissionObj,"category")),t.xp6(2),t.Q6J("ngIf",t.xi3(6,12,e.permissionObj,"category")),t.xp6(2),t.Q6J("ngIf",t.xi3(8,15,e.permissionObj,"category")),t.xp6(2),t.Q6J("ngIf",t.xi3(10,18,e.permissionObj,"category")),t.xp6(2),t.Q6J("ngIf",t.xi3(12,21,e.permissionObj,"category")),t.xp6(2),t.Q6J("ngIf",t.xi3(14,24,1==n.hasClipBoard()&&!n.checkPasteFunc(e.id)&&e.permissionObj,"category")),t.xp6(2),t.Q6J("ngIf",t.xi3(16,27,n.hasClipBoard()&&e.permissionObj,"category")),t.xp6(2),t.Q6J("ngIf",t.xi3(18,30,e.permissionObj,"category")),t.xp6(2),t.Q6J("ngIf",t.xi3(20,33,e.permissionObj,"category"))}}function Wr(o,s){if(1&o&&t.YNc(0,$r,21,36,"div",143),2&o){const e=t.oxw();t.Q6J("ngIf",0==e.isOnLib)}}function Kr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleShowExam(i))}),t.O4$(),t.TgZ(2,"svg",161),t._UZ(3,"circle",158)(4,"line",164)(5,"line",165),t.qZA(),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()}2&o&&(t.xp6(6),t.hij(" ",t.lcZ(7,1,"lang_auto_xem_noi_dung_de")," "))}function Vr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleListTestedExam(i))}),t.O4$(),t.TgZ(2,"svg",161),t._UZ(3,"path",166)(4,"circle",167)(5,"path",168)(6,"path",169),t.qZA(),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()()}2&o&&(t.xp6(7),t.hij(" ",t.lcZ(8,1,"lang_auto_danh_sach_da_lam")," "))}function Xr(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",170),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleCopyLinkExam(i))}),t.O4$(),t.TgZ(2,"svg",161),t._UZ(3,"path",171)(4,"path",172),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}if(2&o){const e=t.oxw(2).$implicit,n=t.oxw();t.xp6(1),t.Q6J("cdkCopyToClipboard",n.copyLink(e)),t.xp6(4),t.hij(" ",t.lcZ(6,2,"lang_auto_copy_link")," ")}}function tl(o,s){1&o&&(t.TgZ(0,"li"),t._UZ(1,"hr",148),t.qZA())}function el(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleConfigExam(i))}),t.O4$(),t.TgZ(2,"svg",153),t._UZ(3,"path",173)(4,"path",174)(5,"path",175)(6,"path",176)(7,"path",177)(8,"path",178)(9,"path",179)(10,"path",180)(11,"path",181)(12,"path",182)(13,"path",183)(14,"path",184)(15,"path",185)(16,"path",186),t.qZA(),t._uU(17),t.ALo(18,"mytranslate"),t.qZA()()}2&o&&(t.xp6(17),t.hij(" ",t.lcZ(18,1,"lang_auto_cai_dat")," "))}function nl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleEditExam(i.id))}),t.O4$(),t.TgZ(2,"svg",153),t._UZ(3,"path",187)(4,"path",188),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_testbank_folder_and_file_edit")," "))}function il(o,s){1&o&&(t.ynx(0),t.O4$(),t.TgZ(1,"svg",153),t._UZ(2,"polyline",189),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.BQk()),2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"lang_testbank_folder_and_file_publish")," "))}function ol(o,s){1&o&&(t.ynx(0),t.O4$(),t.TgZ(1,"svg",153),t._UZ(2,"line",190)(3,"line",191),t.qZA(),t._uU(4),t.ALo(5,"mytranslate"),t.BQk()),2&o&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"lang_auto_huy_xuat_ban")," "))}function al(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handlePublishExam(i))}),t.YNc(2,il,5,3,"ng-container",10),t.YNc(3,ol,6,3,"ng-container",10),t.qZA()()}if(2&o){const e=t.oxw(2).$implicit;t.xp6(2),t.Q6J("ngIf",0==e.isPublished),t.xp6(1),t.Q6J("ngIf",1==e.isPublished)}}function sl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleStatisticalExam(i))}),t.O4$(),t.TgZ(2,"svg",153),t._UZ(3,"path",192)(4,"path",193),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_auto_thong_ke")," "))}function rl(o,s){1&o&&(t.TgZ(0,"li"),t._UZ(1,"hr",148),t.qZA())}function ll(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleCopyExam(i))}),t.O4$(),t.TgZ(2,"svg",31),t._UZ(3,"rect",32)(4,"path",33),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_auto_copy")," "))}function cl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleCutExam(i))}),t.O4$(),t.TgZ(2,"svg",31),t._UZ(3,"polyline",34)(4,"polyline",35)(5,"polyline",36)(6,"polyline",37)(7,"line",38)(8,"line",39),t.qZA(),t._uU(9),t.ALo(10,"mytranslate"),t.qZA()()}2&o&&(t.xp6(9),t.hij(" ",t.lcZ(10,1,"lang_auto_cut")," "))}function _l(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleDeleteExam(i,1))}),t.O4$(),t.TgZ(2,"svg",31),t._UZ(3,"path",41)(4,"path",42)(5,"path",43)(6,"line",44)(7,"line",45),t.qZA(),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()()}2&o&&(t.xp6(8),t.hij(" ",t.lcZ(9,1,"lang_buttom_delete")," "))}function dl(o,s){1&o&&(t.TgZ(0,"li"),t._UZ(1,"hr",148),t.qZA())}function ul(o,s){if(1&o&&(t.TgZ(0,"div",163)(1,"ul",145),t.YNc(2,Kr,8,3,"li",10),t.ALo(3,"viewPermission"),t.YNc(4,Vr,9,3,"li",10),t.ALo(5,"configAndViewPermission"),t.ALo(6,"configAndMarkPermission"),t.ALo(7,"viewPermission"),t.ALo(8,"configPermission"),t.YNc(9,Xr,7,4,"li",10),t.ALo(10,"viewPermission"),t.ALo(11,"configPermission"),t.YNc(12,tl,2,0,"li",10),t.ALo(13,"editPermission"),t.ALo(14,"configPermission"),t.YNc(15,el,19,3,"li",10),t.ALo(16,"editPermission"),t.YNc(17,nl,7,3,"li",10),t.ALo(18,"editPermission"),t.YNc(19,al,4,2,"li",10),t.ALo(20,"editPermission"),t.YNc(21,sl,7,3,"li",10),t.ALo(22,"statisticalPermission"),t.YNc(23,rl,2,0,"li",10),t.ALo(24,"copyPermission"),t.ALo(25,"fullPermission"),t.ALo(26,"deletePermission"),t.YNc(27,ll,7,3,"li",10),t.ALo(28,"copyPermission"),t.YNc(29,cl,11,3,"li",10),t.ALo(30,"fullPermission"),t.YNc(31,_l,10,3,"li",10),t.ALo(32,"deletePermission"),t.YNc(33,dl,2,0,"li",10),t.ALo(34,"configPermission"),t.qZA()()),2&o){const e=t.oxw().$implicit,n=t.oxw();t.xp6(2),t.Q6J("ngIf",t.xi3(3,13,e.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",0==n.isOnLib&&(t.xi3(5,16,e.permissionObj,"exam")||t.xi3(6,19,e.permissionObj,"exam")||t.xi3(7,22,e.permissionObj,"exam")||t.xi3(8,25,e.permissionObj,"exam"))),t.xp6(5),t.Q6J("ngIf",0==n.isOnLib&&(t.xi3(10,28,e.permissionObj,"exam")||t.xi3(11,31,e.permissionObj,"exam"))),t.xp6(3),t.Q6J("ngIf",0==n.isOnLib&&(t.xi3(13,34,e.permissionObj,"exam")||t.xi3(14,37,e.permissionObj,"exam"))),t.xp6(3),t.Q6J("ngIf",t.xi3(16,40,0==n.isOnLib&&e.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(18,43,0==n.isOnLib&&e.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(20,46,0==n.isOnLib&&e.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(22,49,0==n.isOnLib&&e.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",0==n.isOnLib&&(t.xi3(24,52,e.permissionObj,"exam")||t.xi3(25,55,e.permissionObj,"exam")||t.xi3(26,58,e.permissionObj,"exam"))),t.xp6(4),t.Q6J("ngIf",t.xi3(28,61,0==n.isOnLib&&e.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(30,64,0==n.isOnLib&&e.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(32,67,0==n.isOnLib&&e.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",0==n.isOnLib&&t.xi3(34,70,e.permissionObj,"exam"))}}function ml(o,s){if(1&o&&t.YNc(0,ul,35,73,"div",162),2&o){const e=s.$implicit,n=t.oxw();t.Q6J("ngIf",null!=e.permissionObj||1==n.isOnLib)}}function hl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleShowExam(i))}),t._uU(2),t.ALo(3,"mytranslate"),t.O4$(),t.TgZ(4,"svg",196),t._UZ(5,"polyline",197),t.qZA()()()}2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_auto_xem_them")," "))}function pl(o,s){if(1&o&&(t.TgZ(0,"div",195)(1,"ul",145),t.YNc(2,hl,6,3,"li",10),t.ALo(3,"configPermission"),t.qZA()()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngIf",t.xi3(3,1,e.permissionObj,"exam"))}}function gl(o,s){if(1&o&&(t.YNc(0,pl,4,4,"div",194),t.ALo(1,"configPermission")),2&o){const e=s.$implicit,n=t.oxw();t.Q6J("ngIf",0==n.isOnLib&&t.xi3(1,1,e.permissionObj,"exam"))}}function fl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw();return t.KtG(a.handleGoToPowerPoint(i))}),t.O4$(),t.TgZ(2,"svg",161),t._UZ(3,"path",199)(4,"polygon",200),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_testbank_folder_and_file_insert_into_powerpoint")," "))}function xl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw();return t.KtG(a.handleConfigClassroom(i))}),t.O4$(),t.TgZ(2,"svg",161),t._UZ(3,"rect",201)(4,"path",202),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_testbank_folder_and_file_configuration_class")," "))}function vl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw();return t.KtG(a.handleReturnOfflineShare(i))}),t.O4$(),t.TgZ(2,"svg",161),t._UZ(3,"path",203)(4,"polyline",127)(5,"path",204)(6,"path",205),t.qZA(),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()()}2&o&&(t.xp6(7),t.hij(" ",t.lcZ(8,1,"lang_auto_tra_ket_qua_thi_offline")," "))}function bl(o,s){if(1&o&&(t.TgZ(0,"div",198)(1,"ul",145),t.YNc(2,fl,7,3,"li",10),t.ALo(3,"fullPermission"),t.YNc(4,xl,7,3,"li",10),t.ALo(5,"configPermission"),t.YNc(6,vl,9,3,"li",10),t.ALo(7,"fullPermission"),t.qZA()()),2&o){const e=s.$implicit,n=t.oxw();t.xp6(2),t.Q6J("ngIf",0==n.isOnLib&&t.xi3(3,3,e.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(5,6,0==n.isOnLib&&e.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(7,9,0==n.isOnLib&&e.permissionObj,"exam"))}}function wl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleHomeworkScoreList(i))}),t.O4$(),t.TgZ(2,"svg",161),t._UZ(3,"path",166)(4,"circle",167)(5,"path",168)(6,"path",169),t.qZA(),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()()}2&o&&(t.xp6(7),t.hij(" ",t.lcZ(8,1,"lang_auto_danh_sach_da_lam")," "))}function Tl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",170),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleCopyLinkHomework(i))}),t.O4$(),t.TgZ(2,"svg",161),t._UZ(3,"path",171)(4,"path",172),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}if(2&o){const e=t.oxw(2).$implicit,n=t.oxw();t.xp6(1),t.Q6J("cdkCopyToClipboard",n.copyLinkHomework(e)),t.xp6(4),t.hij(" ",t.lcZ(6,2,"lang_auto_copy_link")," ")}}function Cl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleConfigHomework(i))}),t.O4$(),t.TgZ(2,"svg",153),t._UZ(3,"path",173)(4,"path",174)(5,"path",175)(6,"path",176)(7,"path",177)(8,"path",178)(9,"path",179)(10,"path",180)(11,"path",181)(12,"path",182)(13,"path",183)(14,"path",184)(15,"path",185)(16,"path",186),t.qZA(),t._uU(17),t.ALo(18,"mytranslate"),t.qZA()()}2&o&&(t.xp6(17),t.hij(" ",t.lcZ(18,1,"lang_auto_cai_dat")," "))}function Al(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleEditHomework(i))}),t.O4$(),t.TgZ(2,"svg",153),t._UZ(3,"path",187)(4,"path",188),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_testbank_folder_and_file_edit")," "))}function yl(o,s){1&o&&(t.ynx(0),t.O4$(),t.TgZ(1,"svg",153),t._UZ(2,"polyline",189),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.BQk()),2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"lang_testbank_folder_and_file_publish")," "))}function kl(o,s){1&o&&(t.ynx(0),t.O4$(),t.TgZ(1,"svg",153),t._UZ(2,"line",190)(3,"line",191),t.qZA(),t._uU(4),t.ALo(5,"mytranslate"),t.BQk()),2&o&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"lang_auto_huy_xuat_ban")," "))}function Ol(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handlePublishHomework(i))}),t.YNc(2,yl,5,3,"ng-container",10),t.YNc(3,kl,6,3,"ng-container",10),t.qZA()()}if(2&o){const e=t.oxw(2).$implicit;t.xp6(2),t.Q6J("ngIf",0==e.isPublished),t.xp6(1),t.Q6J("ngIf",1==e.isPublished)}}function Sl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleCopyHomework(i))}),t.O4$(),t.TgZ(2,"svg",31),t._UZ(3,"rect",32)(4,"path",33),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_auto_copy")," "))}function El(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleCutHomework(i))}),t.O4$(),t.TgZ(2,"svg",31),t._UZ(3,"polyline",34)(4,"polyline",35)(5,"polyline",36)(6,"polyline",37)(7,"line",38)(8,"line",39),t.qZA(),t._uU(9),t.ALo(10,"mytranslate"),t.qZA()()}2&o&&(t.xp6(9),t.hij(" ",t.lcZ(10,1,"lang_auto_cut")," "))}function Il(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleDeleteHomework(i,2))}),t.O4$(),t.TgZ(2,"svg",31),t._UZ(3,"path",41)(4,"path",42)(5,"path",43)(6,"line",44)(7,"line",45),t.qZA(),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()()}2&o&&(t.xp6(8),t.hij(" ",t.lcZ(9,1,"lang_buttom_delete")," "))}function Zl(o,s){if(1&o&&(t.TgZ(0,"div",163)(1,"ul",145),t.YNc(2,wl,9,3,"li",10),t.ALo(3,"configAndViewPermission"),t.ALo(4,"configAndMarkPermission"),t.ALo(5,"viewPermission"),t.ALo(6,"configPermission"),t.YNc(7,Tl,7,4,"li",10),t.ALo(8,"viewPermission"),t.ALo(9,"configPermission"),t.TgZ(10,"li"),t._UZ(11,"hr",148),t.qZA(),t.YNc(12,Cl,19,3,"li",10),t.ALo(13,"editPermission"),t.YNc(14,Al,7,3,"li",10),t.ALo(15,"editPermission"),t.YNc(16,Ol,4,2,"li",10),t.ALo(17,"editPermission"),t.TgZ(18,"li"),t._UZ(19,"hr",148),t.qZA(),t.YNc(20,Sl,7,3,"li",10),t.ALo(21,"copyPermission"),t.YNc(22,El,11,3,"li",10),t.ALo(23,"fullPermission"),t.YNc(24,Il,10,3,"li",10),t.ALo(25,"deletePermission"),t.qZA()()),2&o){const e=t.oxw().$implicit,n=t.oxw();t.xp6(2),t.Q6J("ngIf",0==n.isOnLib&&(t.xi3(3,8,e.permissionObj,"homework")||t.xi3(4,11,e.permissionObj,"homework")||t.xi3(5,14,e.permissionObj,"homework")||t.xi3(6,17,e.permissionObj,"homework"))),t.xp6(5),t.Q6J("ngIf",0==n.isOnLib&&(t.xi3(8,20,e.permissionObj,"homework")||t.xi3(9,23,e.permissionObj,"homework"))),t.xp6(5),t.Q6J("ngIf",t.xi3(13,26,0==n.isOnLib&&e.permissionObj,"homework")),t.xp6(2),t.Q6J("ngIf",t.xi3(15,29,0==n.isOnLib&&e.permissionObj,"homework")),t.xp6(2),t.Q6J("ngIf",t.xi3(17,32,0==n.isOnLib&&e.permissionObj,"homework")),t.xp6(4),t.Q6J("ngIf",t.xi3(21,35,0==n.isOnLib&&e.permissionObj,"homework")),t.xp6(2),t.Q6J("ngIf",t.xi3(23,38,0==n.isOnLib&&e.permissionObj,"homework")),t.xp6(2),t.Q6J("ngIf",t.xi3(25,41,0==n.isOnLib&&e.permissionObj,"homework"))}}function Ml(o,s){if(1&o&&t.YNc(0,Zl,26,44,"div",162),2&o){const e=s.$implicit,n=t.oxw();t.Q6J("ngIf",null!=e.permissionObj||1==n.isOnLib)}}function Pl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.handlePasteFolder(i.currentCategoryId))}),t.O4$(),t.TgZ(2,"svg",153),t._UZ(3,"rect",156)(4,"path",157),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_auto_paste")," "))}function Ll(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",149),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.removeAllCutOrCopy())}),t.O4$(),t.TgZ(2,"svg",153),t._UZ(3,"circle",158)(4,"line",159)(5,"line",160),t.qZA(),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()}2&o&&(t.xp6(6),t.hij(" ",t.lcZ(7,1,"lang_auto_huy_copycut")," "))}function Nl(o,s){if(1&o&&(t.TgZ(0,"div",144)(1,"ul",145),t.YNc(2,Pl,7,3,"li",10),t.YNc(3,Ll,8,3,"li",10),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.hasClipBoard()),t.xp6(1),t.Q6J("ngIf",e.hasClipBoard())}}const Dl=function(){return{hidden:"isShowContextmenu == false"}};let jl=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c){super(e),this.commonService=e,this.contextMenuService=n,this.activeRoute=i,this.dialog=a,this.clipboardService=r,this.browserStorageService=l,this.fb=c,this.viewType=0,this.isOnLib=0,this.categoryId=0,this.ExistClipboard=!1,this.searchKey="",this.listBreadcrumb=[],this.totalExam=0,this.openFolder=new t.vpe,this.editFolder=new t.vpe,this.cutFolder=new t.vpe,this.deleteFolder=new t.vpe,this.pasteFolder=new t.vpe,this.checkClipboard=new t.vpe,this.backToAllCategory=new t.vpe,this.backToParentCategory=new t.vpe,this.showExamDetail=new t.vpe,this.tryExam=new t.vpe,this.offlineExam=new t.vpe,this.copyExam=new t.vpe,this.cutExam=new t.vpe,this.copyLinkExam=new t.vpe,this.listTestedExam=new t.vpe,this.publishExam=new t.vpe,this.configExam=new t.vpe,this.configExamClassroom=new t.vpe,this.editExam=new t.vpe,this.deleteExam=new t.vpe,this.goToPowerPoint=new t.vpe,this.statisticalExam=new t.vpe,this.supervisingCandidatesExam=new t.vpe,this.returnOfflineShare=new t.vpe,this.sort=new t.vpe,this.sortByPublish=new t.vpe,this.sortByPrice=new t.vpe,this.sortByDateUpdated=new t.vpe,this.sortByAttended=new t.vpe,this.previewHomework=new t.vpe,this.homeworkScoreList=new t.vpe,this.homeworkCopyLink=new t.vpe,this.configHomework=new t.vpe,this.editHomework=new t.vpe,this.publishHomework=new t.vpe,this.copyHomework=new t.vpe,this.cutHomework=new t.vpe,this.deleteHomework=new t.vpe,this.deleteMultipleDocument=new t.vpe,this.form=new h.nJ({}),this.totalSelectCopyOrCut=0,this.isShowContextmenu=!1,this.isSort=!1,this.isSortByPublish=!1,this.isSortByPrice=!1,this.isSortByDateUpdated=!1,this.isSortByAttended=!1,this.currentCategoryId=0,this.shareType="",this.isMobile=this.commonService.isMobileDevice(),this.dataDialogWarning={isShow:!1,content:""},this.documentSortSaver={isSort:!1,isSortByPublish:!1,isSortByPrice:!1,isSortByDateUpdated:!1,isSortByAttended:!1},this.demoData=[]}get ClipboardObjsFormControls(){return this.form.get("clipboardObjs").controls}hasClipBoard(){return this.clipboardService.checkClipboard().length>0}isEmptyObj(e){for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}checkPasteFunc(e){return this.clipboardService.checkSelfPasteFolder(e)}handleSort(e){this.isSort=!this.isSort,this.documentSortSaver.isSort=this.isSort,this.browserStorageService.saveSimpleSessionStorage("documentSort",JSON.stringify(this.documentSortSaver)),this.sort.emit(this.isSort)}handleSortByPublish(e){this.isSortByPublish=!this.isSortByPublish,this.documentSortSaver.isSortByPublish=this.isSortByPublish,this.browserStorageService.saveSimpleSessionStorage("documentSort",JSON.stringify(this.documentSortSaver)),this.sortByPublish.emit(this.isSortByPublish)}handleSortByPrice(e){this.isSortByPrice=!this.isSortByPrice,this.documentSortSaver.isSortByPrice=this.isSortByPrice,this.browserStorageService.saveSimpleSessionStorage("documentSort",JSON.stringify(this.documentSortSaver)),this.sortByPrice.emit(this.isSortByPrice)}handleSortByDateUpdated(e){this.isSortByDateUpdated=!this.isSortByDateUpdated,this.documentSortSaver.isSortByDateUpdated=this.isSortByDateUpdated,this.browserStorageService.saveSimpleSessionStorage("documentSort",JSON.stringify(this.documentSortSaver)),this.sortByDateUpdated.emit(this.isSortByDateUpdated)}handleSortByAttended(e){this.isSortByAttended=!this.isSortByAttended,this.documentSortSaver.isSortByAttended=this.isSortByAttended,this.browserStorageService.saveSimpleSessionStorage("documentSort",JSON.stringify(this.documentSortSaver)),this.sortByAttended.emit(this.isSortByAttended)}handleOpenFolder(e){this.openFolder.emit(e)}handleEditFolder(e){this.editFolder.emit(e)}handleCutFolder(e){let n=document.getElementById("folder_"+e.id);n&&(n.style.opacity="0.6"),this.changeStageClipboardControl(e.id,0),this.acceptCutDocument()}handleCopyFolder(e){let n=document.getElementById("folder_"+e.id);n&&(n.style.opacity="0.6"),this.changeStageClipboardControl(e.id,0),this.acceptCopyDocument()}handleDeleteFolder(e,n){let i=this.commonService.getFormObj(this.form.get("clipboardObjs")),a=0;for(let r=0;r<i.length;r++)i[r].id==e.id&&i[r].type==n&&!i[r].checked&&(i[r].checked=!0,this.totalSelectCopyOrCut++),i[r].checked&&("delete"!=i[r].action&&(i[r].action="delete"),a++);if(this.form.controls.clipboardObjs.setValue(i),a>1){let r=document.getElementById("folder_"+e.id);r&&(r.style.opacity="0.6"),this.acceptDeleteDocument()}else this.deleteFolder.emit(e)}handlePasteFolder(e){this.removeStyleOpacity(),this.pasteFolder.emit(e)}handleCheckClipboard(){this.checkClipboard.emit(!0)}handleStatisticalExam(e){this.statisticalExam.emit(e)}handleSupervisingCandidatesExam(e){this.supervisingCandidatesExam.emit(e)}handleReturnOfflineShare(e){this.returnOfflineShare.emit(e)}handleGoToPowerPoint(e){this.goToPowerPoint.emit(e.id)}handleShowExam(e){this.showExamDetail.emit(e)}handleTryExam(e){this.tryExam.emit(e)}handleOfflineExam(e){this.offlineExam.emit(e)}handleCopyExam(e){let n=document.getElementById("exam_"+e.id);n&&(n.style.opacity="0.6"),this.changeStageClipboardControl(e.id,1),this.acceptCopyDocument()}handleCutExam(e){let n=document.getElementById("exam_"+e.id);n&&(n.style.opacity="0.6"),this.changeStageClipboardControl(e.id,1),this.acceptCutDocument()}handleCopyLinkExam(e){this.copyLinkExam.emit(this.copyLink(e))}copyLink(e){return`${this.commonService.getCurrentDomain()}/de-thi/${e.hashId}`}handleListTestedExam(e){this.listTestedExam.emit(e)}handlePublishExam(e){this.publishExam.emit(e)}handleConfigExam(e){this.configExam.emit(e)}handleEditExam(e){this.editExam.emit(e)}handleGoToShare(e){this.configExam.emit(e)}handleDeleteExam(e,n){let i=this.commonService.getFormObj(this.form.get("clipboardObjs")),a=0;for(let l=0;l<i.length;l++)i[l].id==e.id&&i[l].type==n&&!i[l].checked&&(i[l].checked=!0,this.totalSelectCopyOrCut++),i[l].checked&&("delete"!=i[l].action&&(i[l].action="delete"),a++);this.form.controls.clipboardObjs.setValue(i);let r=document.getElementById("exam_"+e.id);r&&(r.style.opacity="0.6"),a>1?this.acceptDeleteDocument():this.deleteExam.emit(e)}handleConfigClassroom(e){this.configExamClassroom.emit(e)}handleHomeworkScoreList(e){this.homeworkScoreList.emit(e)}handleCopyLinkHomework(e){this.homeworkCopyLink.emit(this.copyLinkHomework(e))}copyLinkHomework(e){return`${this.commonService.getCurrentDomain()}/bai-tap/${e.hashId}`}handleConfigHomework(e){this.configHomework.emit(e)}handleEditHomework(e){this.editHomework.emit(e)}handlePublishHomework(e){this.publishHomework.emit(e)}handleCopyHomework(e){let n=document.getElementById("homework_"+e.id);n&&(n.style.opacity="0.6"),this.changeStageClipboardControl(e.id,2),this.acceptCopyDocument()}handleCutHomework(e){let n=document.getElementById("homework_"+e.id);n&&(n.style.opacity="0.6"),this.changeStageClipboardControl(e.id,2),this.acceptCutDocument()}handleDeleteHomework(e,n){let i=this.commonService.getFormObj(this.form.get("clipboardObjs")),a=0;for(let r=0;r<i.length;r++)i[r].id==e.id&&i[r].type==n&&!i[r].checked&&(i[r].checked=!0,this.totalSelectCopyOrCut++),i[r].checked&&("delete"!=i[r].action&&(i[r].action="delete"),a++);if(this.form.controls.clipboardObjs.setValue(i),a>1){let r=document.getElementById("homework_"+e.id);r&&(r.style.opacity="0.6"),this.acceptDeleteDocument()}else this.deleteHomework.emit(e)}openDialog(){this.dialog.open($s,{width:"70vh"}).afterClosed().subscribe(n=>{})}openDialogWaring(){this.commonService.getTranslate("lang_auto_hien_tinh_nang_thi_offline_chua_ho_tro_de_thi_docx").subscribe(e=>{this.dataDialogWarning={isShow:!0,content:e}})}getClassName(e){let n=[];return e.forEach(i=>{i.name&&!this.commonService.filterArray(n,i.name)&&n.push(i.name)}),n}onContextMenu(e,n,i){e&&(this.contextMenuService.show.next({anchorElement:null!=e&&e.target?e.target:void 0,contextMenu:i,event:e,item:n}),null==e||e.preventDefault(),null==e||e.stopPropagation())}getHeightParent(e,n){let i=document.getElementById(n+"_"+e);return i?i.offsetHeight+"px":"auto"}changeStageClipboardControl(e,n){let i=this.commonService.getFormObj(this.form.get("clipboardObjs"));for(let a=0;a<i.length;a++)i[a].type==n&&i[a].id==e&&(i[a].checked||(i[a].checked=!0,this.totalSelectCopyOrCut++));this.form.controls.clipboardObjs.setValue(i)}createFormArrayCopyOrCut(){this.cateObjs&&this.cateObjs.length>0&&this.cateObjs.forEach(e=>{if(e.id&&e.id>0){let n=this.clipboardService.checkChooseDocumentClipboard(e.id,0),i=new h.nJ({id:new h.p4(e.id),name:new h.p4(e.name),type:new h.p4(0),action:new h.p4(this.clipboardService.getActionDocument(e.id,0)),documentType:new h.p4(""),checked:new h.p4(n)});n&&this.totalSelectCopyOrCut++,this.form.get("clipboardObjs").push(i)}}),this.documentObjs&&this.documentObjs.length>0&&this.documentObjs.forEach(e=>{var n,i,a,r,l,c,_,d,m,p,w,C;if("exam"==e.type&&e.exam){let A=this.clipboardService.checkChooseDocumentClipboard(null!==(i=null===(n=e.exam)||void 0===n?void 0:n.id)&&void 0!==i?i:0,1),M=new h.nJ({id:new h.p4(null===(a=e.exam)||void 0===a?void 0:a.id),name:new h.p4(null===(r=e.exam)||void 0===r?void 0:r.name),type:new h.p4(1),action:new h.p4(this.clipboardService.getActionDocument(null!==(c=null===(l=e.exam)||void 0===l?void 0:l.id)&&void 0!==c?c:0,1)),documentType:new h.p4(""),checked:new h.p4(A)});A&&this.totalSelectCopyOrCut++,this.form.get("clipboardObjs").push(M)}else if("homework"==e.type&&e.homework){let A=this.clipboardService.checkChooseDocumentClipboard(null!==(d=null===(_=e.homework)||void 0===_?void 0:_.id)&&void 0!==d?d:0,2),M=new h.nJ({id:new h.p4(null===(m=e.homework)||void 0===m?void 0:m.id),name:new h.p4(null===(p=e.homework)||void 0===p?void 0:p.name),type:new h.p4(2),action:new h.p4(this.clipboardService.getActionDocument(null!==(C=null===(w=e.homework)||void 0===w?void 0:w.id)&&void 0!==C?C:0,2)),documentType:new h.p4("homework"),checked:new h.p4(A)});A&&this.totalSelectCopyOrCut++,this.form.get("clipboardObjs").push(M)}})}selectDocument(e,n,i){let r=document.getElementById((0==i?"folder_":1==i?"exam_":"homework_")+n);e.target.checked?(r&&(r.classList.add("bg-slate-100"),r.classList.add("dark:bg-darkmode-400/70"),r.style.opacity="0.6"),this.totalSelectCopyOrCut++):(this.totalSelectCopyOrCut>0&&this.totalSelectCopyOrCut--,this.clipboardService.removeDocumentOnClipboard(null!=n?n:0,i),r&&(r.classList.remove("bg-slate-100"),r.classList.remove("dark:bg-darkmode-400/70"),r.style.opacity="1"))}selectAllDocument(){let e=this.commonService.getFormObj(this.form.get("clipboardObjs"));if(this.commonService.getFormObj(this.form).isSelectAll){this.totalSelectCopyOrCut=0;for(let i=0;i<e.length;i++){let a=0==e[i].type?"folder_":1==e[i].type?"exam_":"homework_";e[i].checked=!0,this.totalSelectCopyOrCut++;let r=document.getElementById(a+e[i].id);r&&(r.style.opacity="0.6")}}else{this.totalSelectCopyOrCut=0;for(let i=0;i<e.length;i++)e[i].checked=!1,this.clipboardService.removeDocumentOnClipboard(e[i].id,e[i].type);this.removeStyleOpacity()}this.form.controls.clipboardObjs.setValue(e)}acceptCopyDocument(){var e;let n=this.commonService.getFormObj(this.form.get("clipboardObjs")),i=0;for(let a=0;a<n.length;a++)n[a].checked&&(this.clipboardService.cutOrCopyObj(n[a].id,n[a].type,"copy",null!==(e=n[a].name)&&void 0!==e?e:void 0),i++);this.commonService.getTranslate("lang_auto_copy_thanh_cong").subscribe(a=>{this.commonService.getTranslate("lang_auto_tai_lieu").subscribe(r=>{this.showSuccessSnack(a+" "+i+" "+r)})})}acceptCutDocument(){let e=this.commonService.getFormObj(this.form.get("clipboardObjs")),n=0;for(let i=0;i<e.length;i++)e[i].checked&&(this.clipboardService.cutOrCopyObj(e[i].id,e[i].type,"cut"),n++);this.commonService.getTranslate("lang_auto_cut_thanh_cong").subscribe(i=>{this.commonService.getTranslate("lang_auto_tai_lieu").subscribe(a=>{this.showSuccessSnack(i+" "+n+" "+a)})})}acceptDeleteDocument(){let e=this.commonService.getFormObj(this.form.get("clipboardObjs")),n=0;for(let a=0;a<e.length;a++)e[a].checked&&(this.clipboardService.cutOrCopyObj(e[a].id,e[a].type,"delete"),n++);this.dialog.open(Ys,{data:{totalSelected:n}}).afterClosed().subscribe(a=>{!0===a&&this.deleteMultipleDocument.emit(!0)})}removeAllCutOrCopy(){let e=this.commonService.getFormObj(this.form.get("clipboardObjs"));this.totalSelectCopyOrCut=0;for(let n=0;n<e.length;n++)e[n].checked=!1;this.removeStyleOpacity(),this.form.controls.clipboardObjs.setValue(e),this.clipboardService.donePasteClipboard()}closeDialogWarning(e){this.dataDialogWarning.isShow=!1}checkCupOrCopyItem(){let e=this.commonService.getFormObj(this.form.get("clipboardObjs"));for(let n=0;n<e.length;n++)if(e[n].checked){let a=document.getElementById((1==e[n].type?"exam_":2==e[n].type?"homework_":"folder_")+e[n].id);a&&(a.style.opacity="0.6")}}removeStyleOpacity(){let e=document.getElementsByClassName("folder-item"),n=document.getElementsByClassName("exam-item"),i=document.getElementsByClassName("homework-item");for(let a=0;a<e.length;a++)e[a].removeAttribute("style");for(let a=0;a<n.length;a++)n[a].removeAttribute("style");for(let a=0;a<i.length;a++)i[a].removeAttribute("style")}backToAllCate(){this.backToAllCategory.emit()}goBackParent(e){this.backToParentCategory.emit(e)}ngOnChanges(){this.currentObj=this.cateObjs,this.isShowContextmenu=this.ExistClipboard}ngOnInit(){this.form=this.fb.group({clipboardObjs:new h.vC([]),isSelectAll:new h.p4(!1)}),(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var n;this.currentCategoryId=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")),this.shareType=null!==(n=this.commonService.getMyQueryParam("shareType"))&&void 0!==n?n:"",this.createFormArrayCopyOrCut()});let e=this.browserStorageService.getSimpleSessionStorage("documentSort");if(e){let n=this.commonService.myParseJson(e);n&&(this.documentSortSaver=n,this.documentSortSaver.isSort&&this.handleSort(!0),this.documentSortSaver.isSortByPublish&&this.handleSortByPublish(!0),this.documentSortSaver.isSortByDateUpdated&&this.handleSortByDateUpdated(!0),this.documentSortSaver.isSortByAttended&&this.handleSortByAttended(!0))}}ngAfterViewInit(){this.contextMenuService.closeAllContextMenus({eventType:"cancel"}),this.checkCupOrCopyItem()}ngOnDestroy(){super.ngOnDestroy()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(ft),t.Y36(x.gz),t.Y36(j.uw),t.Y36(Ws.Y),t.Y36(Be.z),t.Y36(h.QS))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-folder-and-file-new"]],viewQuery:function(e,n){if(1&e&&(t.Gf(ct,5),t.Gf(ct,5),t.Gf(ct,5),t.Gf(ct,5),t.Gf(ct,5),t.Gf(ct,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.basicMenuCate=i.first),t.iGM(i=t.CRH())&&(n.basicMenuFile=i.first),t.iGM(i=t.CRH())&&(n.basicMenuAll=i.first),t.iGM(i=t.CRH())&&(n.basicMenuCateGrid=i.first),t.iGM(i=t.CRH())&&(n.basicMenuFileGrid=i.first),t.iGM(i=t.CRH())&&(n.basicMenuAllGrid=i.first)}},inputs:{cateObjs:"cateObjs",documentObjs:"documentObjs",viewType:"viewType",isOnLib:"isOnLib",categoryId:"categoryId",ExistClipboard:"ExistClipboard",searchKey:"searchKey",listBreadcrumb:"listBreadcrumb",totalExam:"totalExam"},outputs:{openFolder:"openFolder",editFolder:"editFolder",cutFolder:"cutFolder",deleteFolder:"deleteFolder",pasteFolder:"pasteFolder",checkClipboard:"checkClipboard",backToAllCategory:"backToAllCategory",backToParentCategory:"backToParentCategory",showExamDetail:"showExamDetail",tryExam:"tryExam",offlineExam:"offlineExam",copyExam:"copyExam",cutExam:"cutExam",copyLinkExam:"copyLinkExam",listTestedExam:"listTestedExam",publishExam:"publishExam",configExam:"configExam",configExamClassroom:"configExamClassroom",editExam:"editExam",deleteExam:"deleteExam",goToPowerPoint:"goToPowerPoint",statisticalExam:"statisticalExam",supervisingCandidatesExam:"supervisingCandidatesExam",returnOfflineShare:"returnOfflineShare",sort:"sort",sortByPublish:"sortByPublish",sortByPrice:"sortByPrice",sortByDateUpdated:"sortByDateUpdated",sortByAttended:"sortByAttended",previewHomework:"previewHomework",homeworkScoreList:"homeworkScoreList",homeworkCopyLink:"homeworkCopyLink",configHomework:"configHomework",editHomework:"editHomework",publishHomework:"publishHomework",copyHomework:"copyHomework",cutHomework:"cutHomework",deleteHomework:"deleteHomework",deleteMultipleDocument:"deleteMultipleDocument"},features:[t.qOj,t.TTD],decls:36,vars:40,consts:[[1,"azt-file-manager"],[1,"mt-3","mb-3","h-auto","sm:h-10","flex","flex-col","sm:flex-row","items-center"],[1,"mr-auto"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"click"],["class","breadcrumb-item active",3,"ngClass",4,"ngFor","ngForOf"],["class","flex items-center mt-3 sm:mt-0 mr-auto sm:mr-0",4,"ngIf"],[1,"table-zone",2,"overflow-x","auto",3,"contextMenu"],["class","box p-5 flex items-center","style","height: 300px; ",4,"ngIf"],[4,"ngIf"],["basicMenuCate",""],["contextMenuItem",""],["basicMenuFile",""],["contextMenuItem","",3,"subMenu"],["subMenuMove",""],["basicMenuHomeworkFile",""],[3,"ngClass","disabled"],["basicMenuAll",""],[3,"disabled"],["disableMenu",""],[1,"breadcrumb-item","active",3,"ngClass"],[3,"ngClass","click"],[3,"ngClass","matTooltip","isDisabledTooltip","matTooltipDisabled"],["c","isDisabled"],[1,"flex","items-center","mt-3","sm:mt-0","mr-auto","sm:mr-0"],["class","inline-block mr-2",4,"ngIf"],["class","btn btn-sm btn-primary mr-2",3,"click",4,"ngIf"],["class","btn btn-sm btn-primary",3,"click",4,"ngIf"],[1,"inline-block","mr-2"],[1,"btn","btn-sm","btn-primary","mr-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["x","9","y","9","width","13","height","13","rx","2","ry","2"],["d","M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"],["points","5 9 2 12 5 15"],["points","9 5 12 2 15 5"],["points","15 19 12 22 9 19"],["points","19 9 22 12 19 15"],["x1","2","y1","12","x2","22","y2","12"],["x1","12","y1","2","x2","12","y2","22"],[1,"btn","btn-sm","btn-primary",3,"click"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],[1,"box","p-5","flex","items-center",2,"height","300px"],[1,"text-center","mx-auto"],["width","84","height","84","viewBox","0 0 84 84","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M38.5 70H14C12.1435 70 10.363 69.2625 9.05025 67.9497C7.7375 66.637 7 64.8565 7 63V17.5C7 13.65 10.15 10.5 14 10.5H27.755C28.9079 10.506 30.0416 10.7966 31.0552 11.3462C32.0687 11.8957 32.9309 12.6871 33.565 13.65L36.435 17.85C37.0691 18.8129 37.9313 19.6043 38.9448 20.1538C39.9584 20.7034 41.092 20.994 42.245 21H70C71.8565 21 73.637 21.7375 74.9497 23.0503C76.2625 24.363 77 26.1435 77 28V42","stroke","#1F64E7","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["d","M59.5 70C65.299 70 70 65.299 70 59.5C70 53.701 65.299 49 59.5 49C53.701 49 49 53.701 49 59.5C49 65.299 53.701 70 59.5 70Z","stroke","#1F64E7","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["d","M73.5 73.5L68.25 68.25","stroke","#1F64E7","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["d","M16 26V44.3184M16 50V54.7432V50Z","stroke","#75A4FE","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],[1,"font-medium","mt-2"],[3,"formGroup"],[1,"inbox","box","overflow-x-auto",2,"scroll-snap-type","x mandatory"],[1,"p-5","text-slate-500","border-b","border-slate-200/60",2,"min-width","1100px"],[1,"grid","grid-cols-12","gap-3","items-center","-mx-5","px-5"],[1,"col-span-4","flex","items-center"],[1,"btn","btn-transparent","btn-outline-secondary","p-1","mr-2","-ml-4","md:hidden",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-5","h-5","lucide"],["cx","12","cy","12","r","1"],["cx","12","cy","5","r","1"],["cx","12","cy","19","r","1"],["class","form-check-input","type","checkbox","formControlName","isSelectAll",3,"change",4,"ngIf","ngIfElse"],["onShareFolder",""],[1,"inbox__item--sender","ml-5","flex","items-center","cursor-pointer",3,"click"],[1,"flex","items-center","flex-col","ml-2"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4",3,"ngClass"],["points","18 15 12 9 6 15"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","-mt-2",3,"ngClass"],["points","6 9 12 15 18 9"],[1,"col-span-2"],[1,"flex-none","flex","items-center","mr-5","cursor-pointer",3,"click"],[1,"w-40"],[1,"lg:w-auto","ml-auto"],[1,"flex","items-center","cursor-pointer","pl-10",3,"click"],[1,"whitespace-nowrap"],[1,"azt-table-body",2,"min-height","50vh","min-width","1100px"],["class","folder-item",3,"id","contextMenu","contextMenuSubject",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"p-5","flex","flex-col","sm:flex-row","items-center","text-center","sm:text-left","text-slate-500"],["type","checkbox","formControlName","isSelectAll",1,"form-check-input",3,"change"],["type","checkbox","formControlName","isSelectAll",1,"form-check-input",3,"disabled"],[1,"folder-item",3,"id","contextMenu","contextMenuSubject"],[1,"inbox__item","inline-block","sm:block","text-slate-600","dark:text-slate-500","border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"grid","grid-cols-12","gap-3","items-center","px-5","py-3"],[1,"col-span-4"],[1,"flex-none","flex","items-center","mr-10"],[1,"btn","btn-transparent","btn-outline-secondary","p-1","mr-2","-ml-4","md:hidden",3,"disabled","click"],["formArrayName","clipboardObjs",4,"ngIf","ngIfElse"],["shareFolder",""],[1,"flex-none","image-fit","relative","ml-5",3,"click"],[4,"ngIf","ngIfElse"],["noShare",""],[1,"inbox__item--sender","truncate","ml-3",3,"matTooltip","isDisabledTooltip","matTooltipDisabled","click"],["class","whitespace-nowrap ml-2 py-0.5 px-2 rounded-full text-xs bg-primary text-white cursor-pointer font-medium",4,"ngIf"],[1,"flex-none","flex","items-center","mr-5"],[1,"w-80"],[1,"inbox__item--time","whitespace-nowrap","ml-auto","pl-10"],["formArrayName","clipboardObjs"],[3,"formGroup",4,"ngIf"],["type","checkbox","formControlName","checked",1,"form-check-input","flex-none",3,"change"],["type","checkbox","disabled","",1,"form-check-input"],["width","16","height","16","viewBox","0 0 16 16","fill","currentColor","xmlns","http://www.w3.org/2000/svg",1,"w-6","h-6","bi","bi-folder-fill",3,"matTooltip"],["d","M9.63852 2H13.62C14.7961 2 15.7183 3.00984 15.6118 4.18107L14.9755 11.1811C14.8818 12.2112 14.0181 13 12.9837 13H2.63653C1.60212 13 0.738391 12.2112 0.64474 11.1811L0.00837643 4.18107C-0.0356793 3.69646 0.0963746 3.23948 0.349653 2.87023L0.310097 2C0.310097 0.895431 1.20553 0 2.3101 0H5.98167C6.5121 0 7.02081 0.210714 7.39588 0.585787L8.22431 1.41421C8.59938 1.78929 9.10809 2 9.63852 2ZM1.31657 2.11964C1.52937 2.04231 1.75945 2 2.00016 2H7.39588L6.68878 1.29289C6.50124 1.10536 6.24689 1 5.98167 1H2.3101C1.76412 1 1.32033 1.43755 1.31027 1.98112L1.31657 2.11964Z","fill","currentColor"],["d","M2.5 12C2.5 12 2 12 2 11.5C2 11 2.5 9.5 5 9.5C7.5 9.5 8 11 8 11.5C8 12 7.5 12 7.5 12H2.5Z","fill","white"],["d","M5 9C5.82843 9 6.5 8.32843 6.5 7.5C6.5 6.67157 5.82843 6 5 6C4.17157 6 3.5 6.67157 3.5 7.5C3.5 8.32843 4.17157 9 5 9Z","fill","white"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"w-6","h-6","bi","bi-folder-fill"],["d","M9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.825a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31L.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3zm-8.322.12C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139z"],[1,"whitespace-nowrap","ml-2","py-0.5","px-2","rounded-full","text-xs","bg-primary","text-white","cursor-pointer","font-medium"],["class","exam-item",3,"id","contextMenu","contextMenuSubject",4,"ngIf"],[1,"exam-item",3,"id","contextMenu","contextMenuSubject"],["class","btn btn-transparent btn-outline-secondary p-1 mr-2 -ml-4 md:hidden",3,"click",4,"ngIf"],["shareExam",""],[1,"w-6","h-6","flex-none","image-fit","relative","ml-5",3,"click"],["class","w-6 h-6 text-pending","xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",3,"matTooltip",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","class","w-6 h-6 text-pending","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",3,"matTooltip",4,"ngIf"],[1,"mb-0","d-block"],[1,"inbox__item--highlight"],[1,"flex-none","flex","items-center"],[1,"lg:w-auto","truncate"],[3,"matTooltip","isDisabledTooltip","matTooltipDisabled",4,"ngIf"],["formControlName","checked","type","checkbox",1,"form-check-input","flex-none",3,"change"],["type","checkbox",1,"form-check-input","flex-none",3,"disabled"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-6","h-6","text-pending",3,"matTooltip"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["d","m9 15 2 2 4-4"],[3,"matTooltip","isDisabledTooltip","matTooltipDisabled"],[1,"flex-none","flex","items-center","mr-5",3,"click"],["shareHomework",""],[1,"w-6","h-6","flex-none","image-fit","relative","ml-5"],["class","w-6 h-6 text-primary bi bi-file-text-fill","xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",4,"ngIf"],["class","text-primary bi bi-file-earmark-check-fill","xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],[1,"inbox__item--sender","truncate","ml-3",3,"matTooltip","isDisabledTooltip","matTooltipDisabled"],[1,"lg:w-auto"],["type","checkbox","disabled","",1,"form-check-input","flex-none"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"w-6","h-6","text-primary","bi","bi-file-text-fill"],["d","M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM5 4h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zM5 8h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1zm0 2h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1z"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"text-primary","bi","bi-file-earmark-check-fill"],["d","M12 9v4"],["d","M12 17h.01"],["class","dropdown-menu show w-60 relative p-3",4,"ngIf"],[1,"dropdown-menu","show","w-60","relative","p-3"],[1,"dropdown-content"],[3,"type","typeObj","id","permissionObj",4,"ngIf"],[3,"type","typeObj","id","permissionObj"],[1,"dropdown-divider","border-slate-200","dark:border-darkmode-400"],[1,"dropdown-item",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2"],["d","M8.42 10.61a2.1 2.1 0 1 1 2.97 2.97L5.95 19 2 20l.99-3.95 5.43-5.44Z"],["d","M2 11.5V5c0-1.1.9-2 2-2h3.93a2 2 0 0 1 1.66.9l.82 1.2a2 2 0 0 0 1.66.9H20a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-9.5"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2","lucide"],["d","M8 17h12a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3.93a2 2 0 0 1-1.66-.9l-.82-1.2a2 2 0 0 0-1.66-.9H8a2 2 0 0 0-2 2v9c0 1.1.9 2 2 2Z"],["d","M2 8v11c0 1.1.9 2 2 2h14"],["x","8","y","2","width","8","height","4","rx","1","ry","1"],["d","M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"],["cx","12","cy","12","r","10"],["x1","15","y1","9","x2","9","y2","15"],["x1","9","y1","9","x2","15","y2","15"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide","mr-2"],["class","dropdown-menu w-60 show relative p-3",4,"ngIf"],[1,"dropdown-menu","w-60","show","relative","p-3"],["x1","12","y1","16","x2","12","y2","12"],["x1","12","y1","8","x2","12.01","y2","8"],["d","M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"],["cx","9","cy","7","r","4"],["d","M22 21v-2a4 4 0 0 0-3-3.87"],["d","M16 3.13a4 4 0 0 1 0 7.75"],[1,"dropdown-item",3,"cdkCopyToClipboard","click"],["d","M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"],["d","M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"],["d","M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z"],["d","M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"],["d","M12 2v2"],["d","M12 22v-2"],["d","m17 20.66-1-1.73"],["d","M11 10.27 7 3.34"],["d","m20.66 17-1.73-1"],["d","m3.34 7 1.73 1"],["d","M14 12h8"],["d","M2 12h2"],["d","m20.66 7-1.73 1"],["d","m3.34 17 1.73-1"],["d","m17 3.34-1 1.73"],["d","m11 13.73-4 6.93"],["d","M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"],["d","M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"],["points","20 6 9 17 4 12"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],["d","M3 3v18h18"],["d","m19 9-5 5-4-4-3 3"],["class","dropdown-menu show relative p-3","style","margin-top: -38px",4,"ngIf"],[1,"dropdown-menu","show","relative","p-3",2,"margin-top","-38px"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide","ml-auto"],["points","9 18 15 12 9 6"],[1,"dropdown-menu","show","w-56","relative",2,"margin-left","-5px"],["d","M5 17H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-1"],["points","12 15 17 21 7 21 12 15"],["x","2","y","7","width","20","height","14","rx","2","ry","2"],["d","M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"],["d","M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"],["d","M2 15h10"],["d","m9 18 3-3-3-3"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"ol",3)(4,"li",4)(5,"a",5),t.NdJ("click",function(){return n.backToAllCate()}),t._uU(6,"All"),t.qZA()(),t.YNc(7,nr,7,16,"li",6),t.qZA()(),t.YNc(8,rr,5,4,"div",7),t.ALo(9,"appFilter"),t.ALo(10,"appFilter"),t.qZA(),t.TgZ(11,"div",8),t.YNc(12,lr,10,3,"div",9),t.ALo(13,"appFilter"),t.ALo(14,"appFilter"),t.YNc(15,Qr,61,54,"ng-container",10),t.ALo(16,"appFilter"),t.ALo(17,"appFilter"),t.qZA()(),t.TgZ(18,"context-menu",null,11),t.YNc(20,Wr,1,1,"ng-template",12),t.qZA(),t.TgZ(21,"context-menu",null,13),t.YNc(23,ml,1,1,"ng-template",12),t.YNc(24,gl,2,4,"ng-template",14),t.TgZ(25,"context-menu",null,15),t.YNc(27,bl,8,12,"ng-template",12),t.qZA()(),t.TgZ(28,"context-menu",null,16),t.YNc(30,Ml,1,1,"ng-template",12),t.qZA(),t.TgZ(31,"context-menu",17,18),t.YNc(33,Nl,4,2,"ng-template",12),t.qZA(),t._UZ(34,"context-menu",19,20)),2&e){const i=t.MAs(26),a=t.MAs(32);let r,l,c;t.xp6(7),t.Q6J("ngForOf",n.listBreadcrumb),t.xp6(1),t.Q6J("ngIf",(0!=(null==(r=t.Dn7(9,9,n.cateObjs,n.searchKey,t.DdM(33,dn)))?null:r.length)||0!=(null==(r=t.Dn7(10,13,n.documentObjs,n.searchKey,t.DdM(34,dn)))?null:r.length))&&-1!=n.currentCategoryId&&n.totalSelectCopyOrCut>0),t.xp6(3),t.Q6J("contextMenu",a),t.xp6(1),t.Q6J("ngIf",0==(null==(l=t.Dn7(13,17,n.cateObjs,n.searchKey,t.DdM(35,dn)))?null:l.length)&&0==(null==(l=t.Dn7(14,21,n.documentObjs,n.searchKey,t.DdM(36,dn)))?null:l.length)),t.xp6(3),t.Q6J("ngIf",0!=(null==(c=t.Dn7(16,25,n.cateObjs,n.searchKey,t.DdM(37,dn)))?null:c.length)||0!=(null==(c=t.Dn7(17,29,n.documentObjs,n.searchKey,t.DdM(38,dn)))?null:c.length)),t.xp6(9),t.Q6J("subMenu",i),t.xp6(7),t.Q6J("ngClass",t.DdM(39,Dl))("disabled",!n.hasClipBoard()),t.xp6(3),t.Q6J("disabled",!0)}},dependencies:[O.mk,O.sg,O.O5,Ln.i3,Wt.gM,h._Y,h.Wl,h.JJ,h.JL,h.sg,h.u,h.CE,_t,ct,st,ci.I,oe.M,Cn.Q,O.OU,O.uU,at.bT,at.gB,at.Gf,at.BU,at.vL,at.Pz,at.Jx,at.I$,at.El,at.cW,at.QE,at._W],encapsulation:2}),o})();var ql=b(295);function Ql(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function Ul(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",3)(1,"form",4)(2,"div",5)(3,"div",6)(4,"h3",7),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"div",8)(8,"div",9)(9,"div",10)(10,"label",11),t._uU(11),t.ALo(12,"mytranslate"),t.qZA()(),t.TgZ(13,"div",10)(14,"div",12),t._UZ(15,"input",13),t.ALo(16,"mytranslate"),t.qZA()()(),t.TgZ(17,"div",14)(18,"div",10)(19,"label",15),t._uU(20),t.ALo(21,"mytranslate"),t.qZA()(),t.TgZ(22,"div",10)(23,"div",12),t._UZ(24,"textarea",16),t.ALo(25,"mytranslate"),t.qZA()()()(),t.TgZ(26,"div",17)(27,"div",18)(28,"button",19),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleDestroy())}),t._uU(29),t.ALo(30,"mytranslate"),t.qZA(),t.TgZ(31,"button",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleSubmitData())}),t._uU(32),t.ALo(33,"mytranslate"),t.qZA()()()()()()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(4),t.hij(" ",t.lcZ(6,9,"lang_auto_cau_hinh_chung")," "),t.xp6(6),t.hij(" ",t.lcZ(12,11,"lang_auto_ten")," "),t.xp6(4),t.s9C("placeholder",t.lcZ(16,13,"lang_auto_nhap_ten")+" ..."),t.xp6(5),t.hij(" ",t.lcZ(21,15,"lang_auto_mo_ta")," "),t.xp6(4),t.s9C("placeholder",t.lcZ(25,17,"lang_auto_nhap_ten")+" ..."),t.xp6(5),t.hij(" ",t.lcZ(30,19,"lang_auto_huy")," "),t.xp6(2),t.Q6J("disabled",e.form.invalid),t.xp6(1),t.hij(" ",t.lcZ(33,21,"lang_auto_luu")," ")}}function Fl(o,s){if(1&o&&(t.TgZ(0,"div",21)(1,"div",22)(2,"div",23)(3,"span"),t._UZ(4,"span",24),t._uU(5,"\xa0"),t.qZA(),t.TgZ(6,"div",25),t._uU(7),t.qZA()()()()),2&o){const e=t.oxw();t.xp6(7),t.Oqu(e.logConfig.msg)}}let Rl=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_){super(e),this.commonService=e,this.formBuilder=n,this.editorOutputDataService=i,this.activeRoute=a,this.questionService=r,this.examService=l,this.userService=c,this.questionSaveService=_,this.onBack=new t.vpe,this.logConfig={},this.cur_cateId=0,this.backToLink="",this.form=new h.nJ({}),this.dataSave={},this.newListUrls=[],this.contentBase64Count=0,this.countProcess=0,this.actionRunAfterConvert=[],this.saveParts=[],this.questionSaveService.callbackBase64ToCanvas=(d,m)=>{let p=this.commonService.myTranslateIntance("lang_auto_dang_xu_ly_hinh_anh_cho_de_thi");this.logConfig.msg=`${p} ${Math.floor(d/m*100*.7)}%`},this.questionSaveService.callbackUploadImage=(d,m)=>{let p=this.commonService.myTranslateIntance("lang_auto_dang_xu_ly_hinh_anh_cho_de_thi");this.logConfig.msg=`${p} ${Math.floor(d/m*100*.3)+70}%`}}ngOnInit(){var e,n,i,a;this.cur_cateId=this.commonService.getMyParam(this.activeRoute,"cat_id"),this.dataSave=this.editorOutputDataService.getOutputData();let r=null!==(a=null!==(n=null===(e=this.dataSave.exam)||void 0===e?void 0:e.examObj.name)&&void 0!==n?n:null===(i=this.dataSave.homework)||void 0===i?void 0:i.name)&&void 0!==a?a:"";this.form=this.formBuilder.group({generalTitle:new h.p4(r,[h.kI.required,Pn._.noWhiteSpace]),generalDescription:new h.p4("")}),super.ngOnInit()}processSaveQuestions(e,n,i){var a,r,l,c,_;if((null===(a=this.dataSave.exam)||void 0===a?void 0:a.questionObj)&&(null===(r=this.dataSave.exam)||void 0===r?void 0:r.questionObj.listQuestions)){var d=null===(l=this.dataSave.exam)||void 0===l?void 0:l.questionObj.listQuestions.length;let m=e+100>d?d:e+100,p=null!==(_=null===(c=this.dataSave.exam)||void 0===c?void 0:c.questionObj.listQuestions.slice(e,m))&&void 0!==_?_:[];p.length>0?this.saveQuestionObjs(p,n).then(w=>{if(w.examConfigs&&w.examConfigs.length>0){let C=i.concat(w.examConfigs);this.processSaveQuestions(m,w.indexSaved,C)}else this.countProcess=0,this.logConfig.status=!1,this.logConfig.msg="",this.showErrorSnack("lang_auto_khong_luu_duoc_noi_dung_cau_hoi_trong_de_vui_long_kiem_tra_lai")}):this.saveExamObj(i)}}saveExamObj(e){if(this.dataSave.exam){let n=!1;this.saveParts=this.saveParts.map(l=>{const c=l.split("_____");return-1!==l.indexOf("ng\u1eabu nhi\xean")&&(n=!0),1===c.length?c[0]:c[1]});let i=this.commonService.getFormObj(this.form),a=this.userService.getUserObj(),r=JSON.stringify({type:"exam",id:0,user:a.id});this.dataSave.exam.examObj.scoringMethod="1",this.dataSave.exam.examObj.name=i.generalTitle,this.dataSave.exam.examObj.examConfigs=JSON.stringify(e),this.dataSave.exam.examObj.description=i.generalDescription,this.dataSave.exam.examObj.editorStatus=2,this.dataSave.exam.examObj.metadata=JSON.stringify(this.saveParts),this.dataSave.exam.examObj.isRandomExam=n,this.examService.apiExamSaveObjPost(this.dataSave.exam.examObj,r).subscribe(l=>{var c;if(this.logConfig.status=!1,this.logConfig.msg=void 0,1===l.success){const _=null===(c=l.data)||void 0===c?void 0:c.obj;this.backToLink=`/admin/testbank/azota-editor/${null!=this.cur_cateId?this.cur_cateId:0}`,this.myNavigationWithQueryString(`/admin/testbank/action-online-offline/${null!=this.cur_cateId?this.cur_cateId:0}/${null==_?void 0:_.hashId}`,`?backto=${this.backToLink}&isNewDocument=1`)}})}}saveQuestionObjs(e,n){return new Promise(i=>{this.questionService.apiQuestionSaveObjsV2Post({listQuestions:e}).subscribe(a=>{var r,l,c;if(this.dataSave.exam&&1===a.success&&(null===(r=a.data)||void 0===r?void 0:r.objs)){const _=[];a.data.objs.forEach((d,m)=>{var p;const w=null===(p=this.dataSave.exam)||void 0===p?void 0:p.examConfig.find(A=>A.name==d.name);if(_.push({id:d.id,name:d.name,groupId:d.groupId,scorePerQuestion:(null==w?void 0:w.point)||1,totalQuestion:1,sort:m+n}),e[m]){const A=e[m];A.__path&&A.__path.length>0?this.saveParts.includes(A.__path)||this.saveParts.push(A.__path):this.saveParts.push(`[@Q${d.id}: C\xe2u ${m+n+1}]`)}}),i({indexSaved:(null===(c=null===(l=a.data)||void 0===l?void 0:l.objs)||void 0===c?void 0:c.length)+n,examConfigs:_})}else i({indexSaved:n,examConfigs:[]})})})}startMainProcessSave(){this.dataSave.exam&&this.dataSave.exam.questionObj&&this.processSaveQuestions(0,0,[])}handleSubmitData(){var e;if(this.countProcess=0,this.commonService.getTranslate("lang_auto_dang_luu_du_lieu_de_thi").subscribe(n=>{this.logConfig.status=!0,this.logConfig.msg=n}),this.dataSave.exam&&this.dataSave.exam.questionObj.listQuestions){const n=this.dataSave.exam.questionObj.listQuestions;let i=null!==(e=this.commonService.myTranslateIntance("lang_auto_xay_ra_loi_trong_qua_trinh_xu_ly_hinh_anh_cua_de_thi"))&&void 0!==e?e:"";this.questionSaveService.convertQuestions(n,this.dataSave.exam.rootQuests,(a,r=i,l)=>{this.logConfig.status=!1,this.logConfig.msg="",this.showErrorSnack(r),l&&this.stopStatusObj()}).then(()=>{this.startMainProcessSave()})}}handleDestroy(){this.onBack.emit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(h.QS),t.Y36(bn),t.Y36(x.gz),t.Y36(Ot.aE),t.Y36(Ot.Oe),t.Y36(ai.K),t.Y36(ro))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-info-general"]],outputs:{onBack:"onBack"},features:[t.qOj],decls:4,vars:3,consts:[[4,"ngIf","ngIfElse"],["doneLoading",""],["style","\n  \twidth: 100vw;\n    height: 100vh;\n    position: fixed;\n    z-index: 9999;\n    top: 0;\n    left: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: rgba(0, 0, 0, 0.4);\n",4,"ngIf"],[1,"intro-y","mt-8"],[3,"formGroup"],[1,"mx-auto",2,"max-width","1000px"],[1,"setting-block"],[1,"text-md","uppercase","font-medium"],[1,"box","mt-2","p-5"],["id","azt-config-name",1,"grid","grid-cols-12"],[1,"col-span-12","lg:col-span-12"],["for","general-name",1,"form-label","mb-0","font-medium","flex","items-center"],[1,"setting-input"],["id","general-name","formControlName","generalTitle","type","text",1,"form-control",3,"placeholder"],["id","azt-config-desc",1,"grid","grid-cols-12","mt-4"],["for","general-desc",1,"form-label","mb-0","font-medium","flex","items-center"],["id","general-desc","formControlName","generalDescription",1,"form-control","w-full",2,"height","150px",3,"placeholder"],[1,"mt-5"],[1,"text-right"],[1,"btn","btn-secondary","w-24","mr-2",3,"click"],[1,"btn","w-24","btn-primary",3,"disabled","click"],[2,"width","100vw","height","100vh","position","fixed","z-index","9999","top","0","left","0","display","flex","justify-content","center","align-items","center","background-color","rgba(0, 0, 0, 0.4)"],[2,"text-align","center","color","#000000"],[2,"margin-bottom","10px"],["role","status",1,"spinner-border","spinner-border-sm"],[2,"font-size","20px","margin-top","10px","background-color","#f0f8ffa3","padding","10px","border-radius","5px"]],template:function(e,n){if(1&e&&(t.YNc(0,Ql,1,0,"azt-loading-effect",0),t.YNc(1,Ul,34,23,"ng-template",null,1,t.W1O),t.YNc(3,Fl,8,1,"div",2)),2&e){const i=t.MAs(2);t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i),t.xp6(3),t.Q6J("ngIf",n.logConfig.status)}},dependencies:[O.O5,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,te.Q,oe.M,at.bT],encapsulation:2}),o})();var ji=b(37389),Bl=b(6834),Oe=b(70655),An=b(17489),Jl=b(39087),Hl=b(30567),fo=b(1059),qi=b(24850),_i=b(81319),xo=b(45646);const vo={a:"rgb(0, 0, 255, 0.2)",b:"rgb(255, 165, 0, 0.2)",c:"rgb(0, 128, 0, 0.2)",d:"rgb(128, 0, 128, 0.2)",e:"rgb(255, 255, 0, 0.2)",f:"rgb(0, 0, 255, 0.2)",g:"rgb(0, 128, 0, 0.2)",h:"rgb(128, 0, 128, 0.2)"},bo={A:"B",B:"C",C:"D",D:"E",E:"F",F:"G",G:"H"},Ie=100;let zl=(()=>{class o{constructor(e,n){this.commonService=e,this.http=n,this.fillColor=(i,a,r,l,c,_)=>{a.fillStyle=i,a.fillRect(Math.round(r),Math.round(l),Math.round(c),Math.round(_))},this.drawRect=(i,a,r,l,c,_)=>{a.beginPath(),a.lineWidth=1,a.strokeStyle=i,a.rect(Math.round(r),Math.round(l),Math.round(c),Math.round(_)),a.stroke()},this.getSingleImgData=(i,a)=>{var r;if(i.inactive){let l=null!==(r=this.commonService.myTranslateIntance("lang_auto_khong_xac_dinh_duoc_vung_thong_tin"))&&void 0!==r?r:"";throw this.commonService.snackError(l,""),new Error(l)}try{let l=document.createElement("canvas");l.width=0==i.width?2:Math.round(i.width),l.height=0==i.heigh?2:Math.round(i.heigh);let c=l.getContext("2d");return null==c||c.drawImage(a[i.pageIndex].canvas,Math.round(i.left),Math.round(i.top),l.width,l.height,0,0,l.width,l.height),l.toDataURL("image/png")}catch(l){return console.log(l),"https://via.placeholder.com/300"}},this.getScatteredImgData=(i,a)=>{var r;const l=i.filter(_=>!_.inactive);if(i.filter(_=>_.inactive).length==i.length){let _=null!==(r=this.commonService.myTranslateIntance("lang_auto_khong_xac_dinh_duoc_vung_thong_tin"))&&void 0!==r?r:"";throw this.commonService.snackError(_,""),new Error(_)}try{let _=document.createElement("canvas"),d=l.map(w=>w.width);_.width=Math.round(Math.max(...d));let m=0;for(let w=0;w<l.length;w++)m+=l[w].heigh;_.height=Math.round(m);let p=_.getContext("2d");for(let w=0;w<l.length;w++)0==w?null==p||p.drawImage(a[l[w].pageIndex].canvas,Math.round(l[w].left),Math.round(l[w].top),Math.round(l[w].width),Math.round(l[w].heigh),0,0,Math.round(l[w].width),Math.round(l[w].heigh)):null==p||p.drawImage(a[l[w].pageIndex].canvas,Math.round(l[w].left),Math.round(l[w].top),Math.round(l[w].width),Math.round(l[w].heigh),0,this.sumHighTo(w,l),Math.round(l[w].width),Math.round(l[w].heigh));return _.toDataURL("image/png")}catch(_){return console.log(_),"https://via.placeholder.com/300"}}}getErrorQtns(e){var n=[];for(let i=0;i<e.length;i++)!e[i].isGroup&&0==e[i].answers.length&&(e[i].strAns&&void 0!==e[i].strAns||n.push(e[i].num));return n}sumHighTo(e,n){let i=0,a=n.filter(r=>!r.inactive);for(let r=0;r<e;r++)i+=Math.round(a[r].heigh);return i}maxWidthTo(e,n){let i=[],a=n.filter(r=>!r.inactive);for(let r=0;r<e;r++)i.push(a[r].width);return Math.round(Math.max(...i))}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(vt.v),t.LFG(Te.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Yl=b(69091),Gl=b(58914),nn=b(88161),To=b(42873),ui=b(91079),Co=b(77446),Qi=b(20773);let $l=(()=>{class o{constructor(e){this.ref=e}onInput(e){if(""!=e.target.value){let n=e.target.selectionStart,i=e.target.selectionEnd;if(e.target.value=e.target.value.replace(/[^\d.,]/g,""),""==e.target.value&&(e.target.value="0"),e.target.value.includes(",")&&(e.target.value=e.target.value.replace(",",".")),e.target.setSelectionRange(n,i),e.preventDefault(),!this.lastValue||this.lastValue&&e.target.value.length>0&&this.lastValue!==e.target.value){this.lastValue=this.ref.nativeElement.value=e.target.value;const a=document.createEvent("HTMLEvents");a.initEvent("input",!1,!0),e.target.dispatchEvent(a)}}else e.target.value=""}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.SBq))},o.\u0275dir=t.lG2({type:o,selectors:[["","appReplaceCommas",""]],hostBindings:function(e,n){1&e&&t.NdJ("input",function(a){return n.onInput(a)})}}),o})();var un=b(44944);const Wl=["myDialogSplitPoint"];function Kl(o,s){if(1&o&&(t.TgZ(0,"div",26)(1,"div",11)(2,"div",15)(3,"div",16)(4,"label",17),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()(),t.TgZ(7,"div",18),t._UZ(8,"input",27),t.qZA()()(),t.TgZ(9,"div",11)(10,"div",15)(11,"div",16)(12,"label",20),t._uU(13),t.ALo(14,"mytranslate"),t.qZA()(),t.TgZ(15,"div",18),t._UZ(16,"input",28),t.qZA()()()()),2&o){const e=t.oxw(2);t.xp6(5),t.Oqu(t.lcZ(6,4,"lang_auto_tong_diem_tu_luan")),t.xp6(3),t.Q6J("decimal",!0),t.xp6(5),t.Oqu(t.lcZ(14,6,"lang_auto_so_cau_tu_luan")),t.xp6(3),t.Q6J("value",null==e.data||null==e.data.obj?null:e.data.obj.essayQuestion)}}function Vl(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",4),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onGlobalClick(i))}),t.TgZ(1,"div",5,6)(3,"div",7)(4,"h2",8),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()(),t.TgZ(7,"div",7)(8,"div",9)(9,"div",10)(10,"div",11)(11,"p",12),t._uU(12),t.ALo(13,"mytranslate"),t.ALo(14,"numberFloat"),t.ALo(15,"numberFloat"),t.qZA()()(),t.TgZ(16,"form",13)(17,"div",14)(18,"div",11)(19,"div",15)(20,"div",16)(21,"label",17),t._uU(22),t.ALo(23,"mytranslate"),t.qZA()(),t.TgZ(24,"div",18),t._UZ(25,"input",19),t.qZA()()(),t.TgZ(26,"div",11)(27,"div",15)(28,"div",16)(29,"label",20),t._uU(30),t.ALo(31,"mytranslate"),t.qZA()(),t.TgZ(32,"div",18),t._UZ(33,"input",21),t.qZA()()()(),t.YNc(34,Kl,17,8,"div",22),t.qZA()()(),t.TgZ(35,"div",23)(36,"button",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.btnCloseDialog(!1))}),t._uU(37),t.ALo(38,"mytranslate"),t.qZA(),t.TgZ(39,"button",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.setPointData())}),t._uU(40),t.ALo(41,"mytranslate"),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,12,"lang_auto_chia_diem")),t.xp6(7),t.AsE("",t.lcZ(13,14,"lang_auto_tong_diem"),": ",t.lcZ(14,16,e.form.controls.multiplePoint.value)+t.lcZ(15,18,e.form.controls.essayPoint.value),""),t.xp6(4),t.Q6J("formGroup",e.form),t.xp6(6),t.Oqu(t.lcZ(23,20,"lang_auto_tong_diem_trac_nghiem")),t.xp6(3),t.Q6J("decimal",!0),t.xp6(5),t.Oqu(t.lcZ(31,22,"lang_auto_so_cau_trac_nghiem")),t.xp6(3),t.Q6J("value",null==e.data||null==e.data.obj?null:e.data.obj.multipleQuestion),t.xp6(1),t.Q6J("ngIf",null==e.data||null==e.data.obj?null:e.data.obj.essayQuestion),t.xp6(3),t.hij(" ",t.lcZ(38,24,"lang_auto_dong")," "),t.xp6(2),t.Q6J("disabled",e.form.invalid),t.xp6(1),t.hij(" ",t.lcZ(41,26,"lang_auto_chia")," ")}}let Ao=(()=>{class o extends mt.Q{constructor(e,n){super(e),this.commonService=e,this.fb=n,this.closeDialog=new t.vpe,this.setPoint=new t.vpe,this.form=new h.nJ({}),this.essayPoint="",this.multiplePoint=""}onKeydownHandler(e){this.closeDialog.emit()}onGlobalClick(e){var n;null!==(n=this.myDialog)&&void 0!==n&&n.nativeElement.contains(e.target)||this.closeDialog.emit()}btnCloseDialog(e){e?this.closeDialog.emit(e):this.closeDialog.emit()}changeMultipPoint(e){this.multiplePoint=e.target.value}changeEssayPoint(e){this.essayPoint=e.target.value}setPointData(){let e=this.commonService.getFormObj(this.form),n=Number(e.multiplePoint),i=Number(e.essayPoint);isNaN(n)&&(n=0),isNaN(i)&&(i=0);let a={multiplePoint:n.toString(),essayPoint:i.toString()};this.setPoint.emit(a)}ngOnInit(){var e,n,i,a,r,l;this.form=null!==(n=null===(e=this.data)||void 0===e?void 0:e.obj)&&void 0!==n&&n.essayQuestion?this.fb.group({multiplePoint:new h.p4(10,[h.kI.required,h.kI.pattern(/^-?\d*[.,]?\d{0,4}$/)]),essayPoint:new h.p4(0,[h.kI.required,h.kI.pattern(/^-?\d*[.,]?\d{0,4}$/)])}):this.fb.group({multiplePoint:new h.p4(10,[h.kI.required,h.kI.pattern(/^-?\d*[.,]?\d{0,4}$/)]),essayPoint:new h.p4(0)}),this.form.patchValue({multiplePoint:null===(a=null===(i=this.data)||void 0===i?void 0:i.obj)||void 0===a?void 0:a.multiplePoint,essayPoint:null===(l=null===(r=this.data)||void 0===r?void 0:r.obj)||void 0===l?void 0:l.essayPoint}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(h.QS))},o.\u0275cmp=t.Xpm({type:o,selectors:[["azt-split-point"]],viewQuery:function(e,n){if(1&e&&t.Gf(Wl,5),2&e){let i;t.iGM(i=t.CRH())&&(n.myDialog=i.first)}},hostBindings:function(e,n){1&e&&t.NdJ("keydown.escape",function(a){return n.onKeydownHandler(a)},!1,t.evT)},inputs:{data:"data"},outputs:{closeDialog:"closeDialog",setPoint:"setPoint"},features:[t.qOj],decls:4,vars:1,consts:[[1,"school-info_bg"],[1,"school-info","p-4",2,"border-radius","0.375rem"],[1,"modal-dialog","modal-lg"],["class","modal-content",3,"click",4,"ngIf"],[1,"modal-content",3,"click"],[1,"modal-body"],["myDialogSplitPoint",""],[1,"intro"],[1,"text-base","font-medium","mr-auto"],[1,"block-body"],[1,"row","mt-2"],[1,"col-md-12"],["for","total-point",1,"mr-2"],[1,"form-horizontal",3,"formGroup"],[1,"row"],[1,"flex","mt-2",2,"justify-content","space-between"],[1,"col-9"],["for","multiple-point"],[1,"col-3"],["type","text","appOnlyNumber","","id","multiple-point","formControlName","multiplePoint",1,"input-point",3,"decimal"],["for",""],["type","number","readonly","",1,"input-point",3,"value"],["class","row mt-3",4,"ngIf"],[1,"text-right","mt-4"],[1,"btn","w-24","btn-secondary","mr-3",3,"click"],[1,"btn","w-24","btn-primary",3,"disabled","click"],[1,"row","mt-3"],["type","text","appOnlyNumber","","id","multiple-point","formControlName","essayPoint",1,"input-point",3,"decimal"],["type","text","readonly","",1,"input-point",3,"value"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t.YNc(3,Vl,42,28,"div",3),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("ngIf",null==n.data?null:n.data.isShow))},dependencies:[O.O5,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,un.Y,oe.M,at.bT,at.Hb],styles:[".school-info_bg[_ngcontent-%COMP%]{z-index:1000;width:100%;display:flex;left:0;top:0;position:fixed;height:100%;min-height:100vh;background-color:#3c3c3c80}.school-info[_ngcontent-%COMP%]{z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);position:fixed;max-width:800px;background:#fff;margin-left:auto;margin-right:auto;box-shadow:0 0 13px 3px #00000094}.block-title[_ngcontent-%COMP%]{text-align:center;font-weight:600}.block-body[_ngcontent-%COMP%]{text-align:left}.btn-close[_ngcontent-%COMP%]{transition:all .5s}.btn-close[_ngcontent-%COMP%]:hover{background:#dfe6e9}.input-point[_ngcontent-%COMP%]{margin-left:10px;max-width:100px;border:1px solid #000;border-radius:3px;text-align:center;color:#000;padding:0!important}.btn-config[_ngcontent-%COMP%]{transition:all .5s}.btn-config[_ngcontent-%COMP%]:hover{background:#133864}@media only screen and (max-width: 1024px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:800px}}@media only screen and (max-width: 768px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:700px}}@media only screen and (max-width: 576px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:400px}}@media only screen and (max-width: 380px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:300px}}@media only screen and (max-width: 290px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:250px}}"]}),o})();const Xl=["myDialogExamInfo"];function tc(o,s){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,3,"lang_auto_tong_so_cau_trac_nghiem")),t.xp6(3),t.Oqu(null==e.examInfo.listMultiple?null:e.examInfo.listMultiple.length),t.xp6(2),t.Oqu(null==e.examInfo.listMultiple?null:e.examInfo.listMultiple.join(", "))}}function ec(o,s){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,3,"lang_auto_tong_so_cau_tu_luan")),t.xp6(3),t.Oqu(null==e.examInfo.listEssay?null:e.examInfo.listEssay.length),t.xp6(2),t.Oqu(null==e.examInfo.listEssay?null:e.examInfo.listEssay.join(", "))}}function nc(o,s){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,3,"lang_auto_cau_trac_nghiem_dien_tu")),t.xp6(3),t.Oqu(null==e.examInfo.listFill?null:e.examInfo.listFill.length),t.xp6(2),t.Oqu(null==e.examInfo.listFill?null:e.examInfo.listFill.join(", "))}}function ic(o,s){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA()()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(t.lcZ(3,3,"lang_auto_cau_trac_nghiem_co_"+e.key+"_dap_an")),t.xp6(3),t.Oqu(e.value.length),t.xp6(2),t.Oqu(e.value.join(", "))}}function oc(o,s){if(1&o&&(t.ynx(0),t.YNc(1,ic,8,5,"tr",10),t.BQk()),2&o){const e=s.$implicit;t.xp6(1),t.Q6J("ngIf",null==e.value?null:e.value.length)}}function ac(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",1),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onGlobalClick(i))}),t.TgZ(1,"div",2,3)(3,"div")(4,"h2",4),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()(),t.TgZ(7,"div",5)(8,"div",6)(9,"p",7),t._uU(10),t.ALo(11,"mytranslate"),t.TgZ(12,"span"),t._uU(13),t.ALo(14,"mytranslate"),t.qZA()(),t.TgZ(15,"div",8)(16,"table",9)(17,"tr")(18,"th"),t._uU(19),t.ALo(20,"mytranslate"),t.qZA(),t.TgZ(21,"th"),t._uU(22),t.ALo(23,"mytranslate"),t.qZA(),t.TgZ(24,"th"),t._uU(25),t.ALo(26,"mytranslate"),t.qZA()(),t.YNc(27,tc,8,5,"tr",10),t.YNc(28,ec,8,5,"tr",10),t.YNc(29,nc,8,5,"tr",10),t.YNc(30,oc,2,1,"ng-container",11),t.ALo(31,"keyvalue"),t.qZA()(),t.TgZ(32,"div",12)(33,"div",13)(34,"button",14),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.btnCloseDialog(!1))}),t._uU(35),t.ALo(36,"mytranslate"),t.qZA()()()()()()()}if(2&o){const e=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,12,"lang_auto_chi_tiet_de_thi")),t.xp6(5),t.hij(" ",t.lcZ(11,14,"lang_auto_tong_so_cau_cua_de")," : "),t.xp6(3),t.AsE("",e.examInfo.totalQuestion," ",t.lcZ(14,16,"lang_auto_cau"),""),t.xp6(6),t.Oqu(t.lcZ(20,18,"lang_auto_thong_tin")),t.xp6(3),t.Oqu(t.lcZ(23,20,"lang_auto_so_cau")),t.xp6(3),t.Oqu(t.lcZ(26,22,"lang_auto_danh_sach_cac_cau")),t.xp6(2),t.Q6J("ngIf",null==e.examInfo.listMultiple?null:e.examInfo.listMultiple.length),t.xp6(1),t.Q6J("ngIf",null==e.examInfo.listEssay?null:e.examInfo.listEssay.length),t.xp6(1),t.Q6J("ngIf",null==e.examInfo.listFill?null:e.examInfo.listFill.length),t.xp6(1),t.Q6J("ngForOf",t.lcZ(31,24,e.examInfo.listQuestionWithTotalAnswer)),t.xp6(5),t.Oqu(t.lcZ(36,26,"lang_auto_dong"))}}let yo=(()=>{class o extends mt.Q{constructor(e,n){super(e),this.commonService=e,this.answerTypeService=n,this.startIndexQuestion=1,this.data={},this.type="edit",this.closeDialog=new t.vpe,this.questionObjs=[],this.examInfo={}}onKeydownHandler(e){this.closeDialog.emit()}onGlobalClick(e){var n;null!==(n=this.myDialog)&&void 0!==n&&n.nativeElement.contains(e.target)||this.closeDialog.emit()}btnCloseDialog(e){this.closeDialog.emit(e)}initData(){var e;this.questionObjs=null!==(e=this.data.obj)&&void 0!==e?e:[],this.filterQuestion()}filterQuestion(){if(this.examInfo.listEssay=[],this.examInfo.listMultiple=[],this.examInfo.listFill=[],this.examInfo.listQuestionWithTotalAnswer={},"edit"==this.type){let e=0;this.questionObjs.forEach(n=>{var i,a,r;e++,this.answerTypeService.isEssayAnswer(n.answerType)?null!=n.rawIndex&&(null===(i=this.examInfo.listEssay)||void 0===i||i.push(n.rawIndex+this.startIndexQuestion)):null!=n.rawIndex&&!this.answerTypeService.isFillAnswer(n.answerType)&&(null===(a=this.examInfo.listMultiple)||void 0===a||a.push(n.rawIndex+this.startIndexQuestion)),this.answerTypeService.isFillAnswer(n.answerType)&&null!=n.rawIndex&&(null===(r=this.examInfo.listFill)||void 0===r||r.push(n.rawIndex+this.startIndexQuestion)),(this.answerTypeService.isOneChoiceAnswer(n.answerType)||this.answerTypeService.isMultipleChoiceAnswer(n.answerType))&&n.answers&&null!=n.rawIndex&&this.countTotalAnswerOfQuestion(n.answers.length,n.rawIndex+this.startIndexQuestion)}),this.examInfo.totalQuestion=e}if("createPDF"==this.type){let e=0;this.questionObjs.forEach(n=>{var i,a,r;1==n.tempData.isSelect&&(e++,this.answerTypeService.isEssayAnswer(n.tempData.answerType)?null!=n.index&&(null===(i=this.examInfo.listEssay)||void 0===i||i.push(n.index+this.startIndexQuestion)):null!=n.index&&!this.answerTypeService.isFillAnswer(n.tempData.answerType)&&(null===(a=this.examInfo.listMultiple)||void 0===a||a.push(n.index+this.startIndexQuestion)),this.answerTypeService.isFillAnswer(n.tempData.answerType)&&null!=n.index&&(null===(r=this.examInfo.listFill)||void 0===r||r.push(n.index+this.startIndexQuestion)),(this.answerTypeService.isOneChoiceAnswer(n.tempData.answerType)||this.answerTypeService.isMultipleChoiceAnswer(n.tempData.answerType))&&n.answers&&null!=n.index&&this.countTotalAnswerOfQuestion(n.answers.length,n.index+this.startIndexQuestion))}),this.examInfo.totalQuestion=e}if("createDocx"==this.type){let e=0;this.questionObjs.forEach(n=>{var i,a,r;e++,this.answerTypeService.isEssayAnswer(n.typeQuestion)?null!=n.numberQuestion&&(null===(i=this.examInfo.listEssay)||void 0===i||i.push(n.numberQuestion)):null!=n.numberQuestion&&!this.answerTypeService.isFillAnswer(n.typeQuestion)&&(null===(a=this.examInfo.listMultiple)||void 0===a||a.push(n.numberQuestion)),this.answerTypeService.isFillAnswer(n.typeQuestion)&&null!=n.numberQuestion&&(null===(r=this.examInfo.listFill)||void 0===r||r.push(n.numberQuestion)),(this.answerTypeService.isOneChoiceAnswer(n.typeQuestion)||this.answerTypeService.isMultipleChoiceAnswer(n.typeQuestion))&&n.answers&&null!=n.numberQuestion&&this.countTotalAnswerOfQuestion(n.answers.length,n.numberQuestion)}),this.examInfo.totalQuestion=e}}countTotalAnswerOfQuestion(e,n){var i;this.examInfo.listQuestionWithTotalAnswer&&(!(null===(i=this.examInfo.listQuestionWithTotalAnswer)||void 0===i)&&i.hasOwnProperty(e)||(this.examInfo.listQuestionWithTotalAnswer[e]=[]),this.examInfo.listQuestionWithTotalAnswer[e].push(n))}ngOnInit(){this.initData(),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(nn.T))},o.\u0275cmp=t.Xpm({type:o,selectors:[["azt-exam-info"]],viewQuery:function(e,n){if(1&e&&t.Gf(Xl,5),2&e){let i;t.iGM(i=t.CRH())&&(n.myDialog=i.first)}},hostBindings:function(e,n){1&e&&t.NdJ("keydown.escape",function(a){return n.onKeydownHandler(a)},!1,t.evT)},inputs:{startIndexQuestion:"startIndexQuestion",data:"data",type:"type"},outputs:{closeDialog:"closeDialog"},features:[t.qOj],decls:1,vars:1,consts:[["class","school-info_bg",3,"click",4,"ngIf"],[1,"school-info_bg",3,"click"],[1,"school-info","box","px-4","py-4"],["myDialogExamInfo",""],[1,"text-base","font-medium","mr-auto"],[1,"intro"],[1,"block-main"],[1,"text-right","mb-2"],[1,"table-responsive","table-height"],["id","tracktable",1,"table","table-bordered"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"flex","mt-3",2,"justify-content","flex-end"],[1,"azt-block-button"],[1,"btn","btn-secondary",3,"click"]],template:function(e,n){1&e&&t.YNc(0,ac,37,28,"div",0),2&e&&t.Q6J("ngIf",null==n.data?null:n.data.isShow)},dependencies:[O.sg,O.O5,O.Nd,at.bT],styles:[".school-info_bg[_ngcontent-%COMP%]{z-index:1000;width:100%;display:flex;left:0;top:0;position:fixed;height:100%;min-height:100vh;background-color:#3c3c3c80}.school-info[_ngcontent-%COMP%]{z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);position:fixed;max-width:600px;width:950px;margin-left:auto;margin-right:auto}.btn-close[_ngcontent-%COMP%]{transition:all .5s}.btn-close[_ngcontent-%COMP%]:hover{background:#dfe6e9}.block-text[_ngcontent-%COMP%]{margin-bottom:15px}.title[_ngcontent-%COMP%]{font-size:16px;font-weight:500}.btn-icon[_ngcontent-%COMP%]{background:transparent;color:#333;border:none;display:flex;align-items:center;text-transform:inherit;padding:0;transition:all .3s}.btn-icon[_ngcontent-%COMP%]:hover{color:#2361ae}.block-show[_ngcontent-%COMP%]{background:#f4f5f7;border-radius:5px;margin-top:5px;padding:10px;max-width:100%;height:0;transition:opacity .3s;overflow:hidden;opacity:0;visibility:hidden;display:none}.show-active[_ngcontent-%COMP%]{display:block;height:auto;overflow:auto;opacity:1;visibility:visible}.table-height[_ngcontent-%COMP%]{height:350px;overflow:auto}@media only screen and (max-width: 1024px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:800px}}@media only screen and (max-width: 768px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:700px}}@media only screen and (max-width: 576px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:400px}}@media only screen and (max-width: 380px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:300px}}@media only screen and (max-width: 290px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:250px}}"]}),o})();var sc=b(60284),rc=b(75477),lc=b(74650),cc=b(76224);function _c(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.goBack())}),t.O4$(),t.TgZ(1,"svg",25),t._UZ(2,"polyline",26),t.qZA()()}}function dc(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.goBackDialog())}),t.O4$(),t.TgZ(1,"svg",25),t._UZ(2,"polyline",26),t.qZA()()}}function uc(o,s){1&o&&t._UZ(0,"div",27)}function mc(o,s){if(1&o&&(t.ynx(0),t._UZ(1,"input",28),t.ALo(2,"mytranslate"),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.s9C("placeholder",t.lcZ(2,2,"lang_auto_nhap_ten")+" ..."),t.Q6J("formControl",e.examName)}}function hc(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",27)(1,"button",29),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.clickHandelCancel())}),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"button",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.clickHandelConfirm())}),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(2),t.hij(" ",t.lcZ(3,2,"lang_auto_huy")," "),t.xp6(3),t.hij(" ",t.lcZ(6,4,e.confirmTitle)," ")}}function pc(o,s){if(1&o&&(t.ynx(0),t._UZ(1,"input",31),t.ALo(2,"mytranslate"),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.s9C("placeholder",t.lcZ(2,2,"lang_auto_nhap_ten")+" ..."),t.Q6J("formControl",e.examName)}}function gc(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",32)(1,"button",33),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.clickHandelCancel())}),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.clickHandelConfirm())}),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,2,"lang_auto_huy")," "),t.xp6(3),t.hij(" ",t.lcZ(6,4,"lang_auto_tiep_tuc")," "))}const fc=function(o){return[o]};function xc(o,s){if(1&o&&(t.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",3)(7,"div",7)(8,"a",8),t.ALo(9,"mylocalize"),t._UZ(10,"img",9),t.ALo(11,"convertCdn"),t.qZA()(),t.YNc(12,_c,3,0,"button",10),t.YNc(13,dc,3,0,"button",10),t.qZA()(),t.TgZ(14,"div",11)(15,"div",12),t.YNc(16,uc,1,0,"div",13),t.TgZ(17,"div",14),t.YNc(18,mc,3,4,"ng-container",15),t.qZA(),t.YNc(19,hc,7,6,"div",13),t.qZA()(),t.TgZ(20,"div",6)(21,"div",16)(22,"div",17),t._UZ(23,"azt-switch-language"),t.qZA(),t.TgZ(24,"div",17),t._UZ(25,"header-notice-box"),t.qZA(),t.TgZ(26,"div",18),t._UZ(27,"header-account-menu",19),t.qZA()()(),t.TgZ(28,"div",20)(29,"div",12)(30,"div",21),t.YNc(31,pc,3,4,"ng-container",15),t.qZA(),t.YNc(32,gc,7,6,"div",22),t.qZA()()(),t.TgZ(33,"div",23),t.Hsn(34),t.qZA()()()()()),2&o){const e=t.oxw();t.xp6(8),t.Q6J("routerLink",t.VKq(14,fc,t.lcZ(9,10,"/admin/dashboard"))),t.xp6(2),t.Q6J("src",t.lcZ(11,12,"azota_assets/images/logo.svg"),t.LSH),t.xp6(2),t.Q6J("ngIf",""!=e.headerBackTolink),t.xp6(1),t.Q6J("ngIf",e.checkBackDialog),t.xp6(3),t.Q6J("ngIf",e.showConfirmButton),t.xp6(2),t.Q6J("ngIf",e.showInput),t.xp6(1),t.Q6J("ngIf",e.showConfirmButton),t.xp6(8),t.Q6J("isTeacherDashboard",!0),t.xp6(4),t.Q6J("ngIf",e.showInput),t.xp6(1),t.Q6J("ngIf",e.showConfirmButton)}}const vc=["*"];let Ui=(()=>{class o extends mt.Q{constructor(e,n,i){super(i),this.processNoticeService=e,this.baseApiService=n,this.commonService=i,this.headerBackTolink="",this.headerTitle="",this.confirmTitle="lang_auto_tiep_tuc",this.checkBackDialog=!1,this.showConfirmButton=!1,this.showInput=!1,this.examName=new h.p4,this.handleConfirm=new t.vpe,this.handleCancel=new t.vpe,this.handleBackDialog=new t.vpe,this.isLogin=!1,this.isMobileWebView=!1}goBack(){this.commonService.myNavigationBySpecialQueryString(this.headerBackTolink)}clickHandelCancel(){this.handleCancel.emit()}clickHandelConfirm(){this.handleConfirm.emit()}goBackDialog(){this.handleBackDialog.emit()}openMenuMobile(){let e=document.getElementById("toggle-menu");null==e||e.classList.add("mobile-menu--active")}closeMenuMobile(){let e=document.getElementById("toggle-menu");null==e||e.classList.remove("mobile-menu--active")}ngOnInit(){super.ngOnInit(),this.isLogin=this.baseApiService.isLogin(),this.isMobileWebView=this.commonService.isMobileWebview()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(sc.e),t.Y36(zn._),t.Y36(vt.v))},o.\u0275cmp=t.Xpm({type:o,selectors:[["editor-layout"]],inputs:{headerBackTolink:"headerBackTolink",headerTitle:"headerTitle",confirmTitle:"confirmTitle",checkBackDialog:"checkBackDialog",showConfirmButton:"showConfirmButton",showInput:"showInput",examName:"examName"},outputs:{handleConfirm:"handleConfirm",handleCancel:"handleCancel",handleBackDialog:"handleBackDialog"},features:[t.qOj],ngContentSelectors:vc,decls:1,vars:1,consts:[["id","azt-layout","class","azt-layout",4,"ngIf"],["id","azt-layout",1,"azt-layout"],[1,"azt-body",2,"padding","0"],[1,"flex"],[1,"content","relative",2,"padding","0","border-radius","0"],[1,"top-bar","py-2","bg-white","dark:bg-darkmode-600","px-3","grid","grid-cols-12","gap-3",2,"height","auto","z-index","0","display","grid"],[1,"col-span-6","md:col-span-2"],[1,"mr-3"],[3,"routerLink"],["width","95px",3,"src"],["class","btn btn-transparent",3,"click",4,"ngIf"],[1,"col-span-12","md:col-span-8","azt-hidden","md:block"],[1,"flex","items-center"],["class","mr-2","style","width: 25%;",4,"ngIf"],[1,"mr-auto",2,"width","50%","padding-right","10px"],[4,"ngIf"],[1,"flex","items-center","justify-end","pr-4"],[1,"dropdown","mr-2","sm:mr-4"],[1,"dropdown","w-8","h-8"],[3,"isTeacherDashboard"],[1,"col-span-12","md:col-span-8","block","md:hidden"],[1,"mr-auto",2,"width","55%"],["class","mr-2",4,"ngIf"],[1,"azt-content"],[1,"btn","btn-transparent",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-5","h-5"],["points","15 18 9 12 15 6"],[1,"mr-2",2,"width","25%"],["type","text",1,"form-control",2,"text-align","center","border","0","box-shadow","none",3,"formControl","placeholder"],[1,"btn","btn-secondary","w-20","mr-2",3,"click"],[1,"btn","btn-primary","w-20",3,"click"],["type","text",1,"form-control",3,"formControl","placeholder"],[1,"mr-2"],[1,"btn","btn-secondary","mr-2",3,"click"],[1,"btn","btn-primary",3,"click"]],template:function(e,n){1&e&&(t.F$t(),t.YNc(0,xc,35,16,"div",0)),2&e&&t.Q6J("ngIf",n.isLogin)},dependencies:[x.yS,O.O5,h.Fj,h.JJ,h.oH,rc.x,lc.H,cc.y,at.mp,at.bT,at.BI],encapsulation:2}),o})();function bc(o,s){1&o&&(t.TgZ(0,"div",10),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_create_exam_width_file_pdf_cropper_edit_explain_error"),"\n"))}function wc(o,s){1&o&&t._UZ(0,"azt-loading-effect")}let Tc=(()=>{class o{constructor(e,n,i){this.commonService=e,this.activeRoute=n,this.dialog=i,this.headerPosition={},this.listQuestion=[],this.listCanvas=[],this.applyEdit=new t.vpe,this.listOriginalQuestion=[],this.originalHeaderPostion={},this.loadingAssets=!1,this.isApplying=!1}addHeaderPiece(){let e=document.createElement("div");e.setAttribute("class","box-crop-info header-piece"),e.dataInfo=this.headerPosition,e.style.width=this.headerPosition.width+"px",e.style.height=this.headerPosition.heigh+"px",e.style.left=this.headerPosition.left+"px",e.style.top=this.headerPosition.top+"px";let i=document.getElementById("canvas_edit_page_"+this.headerPosition.pageIndex);null==i||i.appendChild(e),this.addInteractiveElement(e)}processInfo(){this.addHeaderPiece();for(let e=0;e<this.listQuestion.length;e++){for(let r=0;r<this.listQuestion[e].positions.length;r++){const l=this.listQuestion[e].positions[r];let c=document.createElement("div");if(c.setAttribute("class",`box-crop-info question-piece question-piece-of-${e}`),l.inactive&&c.classList.add("inactive"),c.dataInfo=l,c.style.width=l.width+"px",c.style.height=l.heigh+"px",c.style.left=l.left+"px",c.style.top=l.top+"px",0==r){let m=document.createElement("div");if(m.setAttribute("class",`question-stt question-stt-${e} clickable`),m.textContent=`#${e+1}`,c.appendChild(m),!this.listQuestion[e].isGroup){let p=document.createElement("div");p.setAttribute("class",`question-ans-add question-ans-add-${e} clickable`),p.textContent="+",p.addEventListener("click",()=>{const w=this.listQuestion[e].answers[this.listQuestion[e].answers.length-1].label;let C=document.createElement("div");C.setAttribute("class",`answer-append box-crop-info answer-piece answer-piece-${bo[w].toLowerCase()}`);let A=this.commonService.myTranslateIntance("lang_auto_nhap_dup_chuot_de_an_hien_vung_thong_tin_nay");C.setAttribute("tittle",A);let M=Object.assign(Object.assign({},this.listQuestion[e].answers[this.listQuestion[e].answers.length-1].positions[0]),{left:this.listQuestion[e].answers[this.listQuestion[e].answers.length-1].positions[0].left+this.listQuestion[e].answers[this.listQuestion[e].answers.length-1].positions[0].width});C.style.width=M.width+"px",C.style.height=M.heigh+"px",C.style.top=M.top+"px",C.style.left=M.left+"px",C.style.backgroundColor=vo[bo[w].toLowerCase()],C.dataInfo=M;let D=document.getElementById("canvas_edit_page_"+M.pageIndex);null==D||D.appendChild(C),this.addInteractiveElement(C);let q=document.createElement("div");q.setAttribute("class","box-crop-info answer-label"),q.setAttribute("tittle",A);let U=Object.assign(Object.assign({},this.listQuestion[e].answers[this.listQuestion[e].answers.length-1].remove),{left:M.left,top:M.top});q.style.width=U.width+"px",q.style.height=U.heigh+"px",q.style.top=U.top+"px",q.style.left=U.left+"px",q.dataInfo=U,null==D||D.appendChild(q),this.addInteractiveElement(q)}),c.appendChild(p)}}let d=document.getElementById("canvas_edit_page_"+l.pageIndex);null==d||d.appendChild(c),this.addInteractiveElement(c)}let n=document.createElement("div");n.setAttribute("class","box-crop-info question-label"),n.dataInfo=this.listQuestion[e].remove,n.style.width=this.listQuestion[e].remove.width+"px",n.style.height=this.listQuestion[e].remove.heigh+"px",n.style.left=this.listQuestion[e].remove.left+"px",n.style.top=this.listQuestion[e].remove.top+"px",this.listQuestion[e].answers.forEach(r=>{r.positions.forEach(d=>{let m=document.createElement("div");m.setAttribute("class",`box-crop-info ${!0===d.inactive?"inactive":""} answer-piece answer-piece-${r.label.toLowerCase()}`);let p=this.commonService.myTranslateIntance("lang_auto_nhap_dup_chuot_de_an_hien_vung_thong_tin_nay");m.setAttribute("tittle",p),m.inactive&&m.classList.add("inactive"),m.dataInfo=d,m.style.width=d.width+"px",m.style.height=d.heigh+"px",m.style.left=d.left+"px",m.style.top=d.top+"px",m.style.backgroundColor=vo[r.label.toLowerCase()];let C=document.getElementById("canvas_edit_page_"+d.pageIndex);null==C||C.appendChild(m),this.addInteractiveElement(m)});let l=document.createElement("div");l.setAttribute("class","box-crop-info answer-label"),l.dataInfo=r.remove,l.style.width=r.remove.width+"px",l.style.height=r.remove.heigh+"px",l.style.left=r.remove.left+"px",l.style.top=r.remove.top+"px";let _=document.getElementById("canvas_edit_page_"+r.remove.pageIndex);null==_||_.appendChild(l),this.addInteractiveElement(l)});let a=document.getElementById("canvas_edit_page_"+this.listQuestion[e].remove.pageIndex);null==a||a.appendChild(n),this.addInteractiveElement(n)}}processRender(){var e;for(let n=0;n<this.listCanvas.length;n++){const i=this.listCanvas[n];let a=document.createElement("div");a.setAttribute("id","canvas_edit_page_"+n),a.classList.add("mb-3"),a.style.width=i.width+"px",a.style.height=i.height+"px",a.style.position="relative",a.style.margin="0 auto",a.style.boxShadow="3px 2px 3px 2px #ccc";let r=document.createElement("canvas"),l=document.createElement("span");l.textContent=`Page ${n+1} of ${this.listCanvas.length}`,l.style.position="absolute",l.style.bottom="10px",l.style.right="10px",l.style.fontSize="12px",l.style.color="#ccc",r.width=i.width,r.height=i.height,a.appendChild(r),a.appendChild(l);let c=r.getContext("2d");null==c||c.drawImage(i,0,0,i.width,i.height,0,0,i.width,i.height),null===(e=document.getElementById("boxEdit"))||void 0===e||e.appendChild(a);let _=document.getElementById("tipsTrick");_&&(_.style.width=i.width+"px")}}dragMoveListener(e){let n=e.target,i=(parseFloat(n.getAttribute("data-x"))||0)+e.dx,a=(parseFloat(n.getAttribute("data-y"))||0)+e.dy;n.style.top=a+"px",n.style.left=i+"px",n.setAttribute("data-x",i),n.setAttribute("data-y",a),n.dataInfo.left=parseInt(n.style.left),n.dataInfo.top=parseInt(n.style.top)}get invalidPositionsData(){let e=!1;for(let n=0;n<this.listQuestion.length;n++){if(this.listQuestion[n].remove.inactive){e=!0;break}if(this.listQuestion[n].positions.length==this.listQuestion[n].positions.filter(l=>l.inactive).length){e=!0;break}for(let l=0;l<this.listQuestion[n].answers.length;l++)if(this.listQuestion[n].answers[l].positions.length==this.listQuestion[n].answers[l].positions.filter(d=>d.inactive).length){e=!0;break}}return e}addInteractiveElement(e){e.setAttribute("data-x",parseInt(e.style.left)),e.setAttribute("data-y",parseInt(e.style.top)),interact(e).resizable({edges:{left:!0,right:!0,bottom:!0,top:!0},listeners:{move(n){var i=n.target,a=parseFloat(i.getAttribute("data-x"))||0,r=parseFloat(i.getAttribute("data-y"))||0;i.style.width=n.rect.width+"px",i.style.height=n.rect.height+"px",a+=n.deltaRect.left,i.style.top=(r+=n.deltaRect.top)+"px",i.style.left=a+"px",i.setAttribute("data-x",a),i.setAttribute("data-y",r),i.dataInfo.width=parseInt(i.style.width),i.dataInfo.heigh=parseInt(i.style.height),i.dataInfo.left=parseInt(i.style.left),i.dataInfo.top=parseInt(i.style.top)}},modifiers:[interact.modifiers.restrictEdges({outer:"parent"}),interact.modifiers.restrictSize({min:{width:10,height:10}})],inertia:!0}).draggable({listeners:{move:window.dragMoveListener},inertia:!0,modifiers:[interact.modifiers.restrictRect({restriction:"parent",endOnly:!0})]}).on("doubletap",function(n){n.currentTarget.dataInfo.inactive?(n.currentTarget.dataInfo.inactive=!1,n.currentTarget.classList.remove("inactive")):(n.currentTarget.dataInfo.inactive=!0,n.currentTarget.classList.add("inactive")),console.log(n.currentTarget.dataInfo),n.preventDefault()})}handleApply(){this.isApplying=!0,setTimeout(()=>{this.applyEdit.emit({headerPos:this.headerPosition,listQuestion:this.listQuestion})},2e3)}handleCancel(){confirm("Nh\u1eefng \u0111i\u1ec1u ch\u1ec9nh c\u1ee7a b\u1ea1n s\u1ebd b\u1ecb m\u1ea5t, b\u1ea1n c\xf3 ch\u1eafc ch\u1eafn?")&&this.applyEdit.emit("")}ngOnInit(){this.listQuestion.length>0&&(this.listOriginalQuestion=An.cloneDeep(this.listQuestion),this.originalHeaderPostion=An.cloneDeep(this.headerPosition)),this.processRender(),this.processInfo(),this.loadingAssets=!0}ngAfterViewInit(){window.dragMoveListener=this.dragMoveListener}ngOnDestroy(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(x.gz),t.Y36(j.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-cropper-edit"]],inputs:{headerPosition:"headerPosition",listQuestion:"listQuestion",listCanvas:"listCanvas",examHeader:"examHeader"},outputs:{applyEdit:"applyEdit"},decls:19,vars:18,consts:[["style","position: fixed; top: 5px; left: 5px; right: 5px; font-size: 20px; z-index: 9999;","class","alert alert-danger p-2 text-center",4,"ngIf"],["id","mainEditArea",3,"hidden"],["id","buttonArea"],[1,"bb-holder","p-3"],["id","buttonApplys",1,"btn","btn-primary","mr-2",3,"disabled","click"],["id","buttonCancels",1,"btn","btn-secondary",3,"click"],["id","tipsTrick",1,"alert","box","p-2","mt-2","text-center",2,"margin-left","auto","margin-right","auto"],[2,"font-weight","500"],["id","boxEdit"],[4,"ngIf"],[1,"alert","alert-danger","p-2","text-center",2,"position","fixed","top","5px","left","5px","right","5px","font-size","20px","z-index","9999"]],template:function(e,n){1&e&&(t.YNc(0,bc,3,3,"div",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),t.NdJ("click",function(){return n.handleApply()}),t._uU(5),t.ALo(6,"mytranslate"),t.ALo(7,"mytranslate"),t.qZA(),t.TgZ(8,"button",5),t.NdJ("click",function(){return n.handleCancel()}),t._uU(9),t.ALo(10,"mytranslate"),t.qZA()()(),t.TgZ(11,"div",6)(12,"b",7),t._uU(13),t.ALo(14,"mytranslate"),t.qZA(),t._uU(15),t.ALo(16,"mytranslate"),t.qZA(),t._UZ(17,"div",8),t.qZA(),t.YNc(18,wc,1,0,"azt-loading-effect",9)),2&e&&(t.Q6J("ngIf",n.invalidPositionsData),t.xp6(1),t.Q6J("hidden",!n.loadingAssets),t.xp6(3),t.Q6J("disabled",n.isApplying),t.xp6(1),t.hij(" ",n.isApplying?t.lcZ(6,8,"lang_testbank_create_exam_width_file_pdf_cropper_edit_loading_apply"):t.lcZ(7,10,"lang_testbank_create_exam_width_file_pdf_cropper_edit_apply")," "),t.xp6(4),t.Oqu(t.lcZ(10,12,"lang_buttom_cancel")),t.xp6(4),t.hij("",t.lcZ(14,14,"lang_testbank_create_exam_width_file_pdf_cropper_edit_tips"),": "),t.xp6(2),t.hij("",t.lcZ(16,16,"lang_testbank_create_exam_width_file_pdf_cropper_edit_note_tip")," "),t.xp6(3),t.Q6J("ngIf",!n.loadingAssets))},dependencies:[O.O5,te.Q,at.bT],styles:["#mainEditArea[_ngcontent-%COMP%]{width:1200px;margin:0 auto}#mainEditArea[_ngcontent-%COMP%]   #buttonArea[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),o})();var ko=b(85736);const Cc=["hiddenInput"],Ac=["iframePdf"],yc=["resizeBar"],kc=["boxLeftFile"],Oc=["parentResize"],Sc=["maskLayer"],mi=function(o){return{color:o}};function Ec(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",48)(1,"div"),t._uU(2,"Trang "),t.TgZ(3,"input",49),t.NdJ("keyup.enter",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.handleEnterPage(i))})("ngModelChange",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.currentPage=i)}),t.qZA(),t._uU(4),t.qZA(),t.TgZ(5,"mat-icon",50),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.changePage("prev"))}),t.ALo(6,"mytranslate"),t._uU(7,"chevron_left"),t.qZA(),t.TgZ(8,"span"),t._uU(9),t.qZA(),t.TgZ(10,"mat-icon",50),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.changePage("next"))}),t.ALo(11,"mytranslate"),t._uU(12,"chevron_right"),t.qZA()()}if(2&o){const e=t.oxw(3);t.xp6(3),t.Q6J("ngModel",e.currentPage),t.xp6(1),t.hij(" / ",e.totalPage,""),t.xp6(1),t.s9C("matTooltip",t.lcZ(6,8,"lang_auto_trang_truoc")),t.Q6J("ngStyle",t.VKq(12,mi,e.topLazyLoad?"inherit":"#595959")),t.xp6(4),t.AsE("",e.startChunkIndex+1,"-",e.startChunkIndex+e.lazyLoadSize>e.questionList.length-1?e.questionList.length:e.startChunkIndex+e.lazyLoadSize,""),t.xp6(1),t.s9C("matTooltip",t.lcZ(11,10,"lang_auto_trang_sau")),t.Q6J("ngStyle",t.VKq(14,mi,e.bottomLazyLoad?"inherit":"#595959"))}}function Ic(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"mat-icon",51),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.showAllHelp())}),t.ALo(1,"mytranslate"),t._uU(2," help "),t.qZA()}2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_testbank_create_exam_width_file_pdf_show_view_all_explain"))}function Zc(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"mat-icon",51),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.showAllHelp())}),t.ALo(1,"mytranslate"),t._uU(2," help_outlined "),t.qZA()}2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_testbank_create_exam_width_file_pdf_hide_view_all_explain"))}function Mc(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"mat-option",52),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.handleClickOption(a.index))}),t._uU(1),t.qZA()}if(2&o){const e=s.$implicit,n=t.oxw(3);t.Q6J("value",e.index+n.startQuestion),t.xp6(1),t.hij(" ",e.index+n.startQuestion," ")}}function Pc(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",31)(1,"div",32)(2,"mat-checkbox",33),t.ALo(3,"mytranslate"),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()(),t.YNc(6,Ec,13,16,"div",34),t.TgZ(7,"div")(8,"button",35),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.openDialogSpitPoint())}),t._uU(9),t.ALo(10,"mytranslate"),t.qZA()(),t.TgZ(11,"div",36),t.YNc(12,Ic,3,3,"mat-icon",37),t.YNc(13,Zc,3,3,"mat-icon",37),t.TgZ(14,"mat-icon",38),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.openExamInfoDialog())}),t.ALo(15,"mytranslate"),t._uU(16,"info_outline"),t.qZA()(),t.TgZ(17,"div",39)(18,"span"),t._uU(19),t.ALo(20,"mytranslate"),t.qZA(),t.TgZ(21,"form",40)(22,"input",41),t.NdJ("keyup.enter",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.handleEnterQuestion(i))}),t.qZA(),t.TgZ(23,"mat-autocomplete",42,43),t.YNc(25,Mc,2,2,"mat-option",44),t.ALo(26,"async"),t.qZA()()(),t._UZ(27,"input",45,46),t.TgZ(29,"button",47),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.editting=!0)}),t._uU(30),t.ALo(31,"mytranslate"),t.qZA()()}if(2&o){const e=t.MAs(24),n=t.oxw(2);t.xp6(2),t.MGl("matTooltip","",t.lcZ(3,13,"lang_testbank_create_exam_width_file_pdf_note_tutorial_Proofreading"),"."),t.Q6J("formControl",n.debuggingMode),t.xp6(2),t.Oqu(t.lcZ(5,15,"lang_testbank_create_exam_width_file_pdf_Proofreading")),t.xp6(2),t.Q6J("ngIf",n.questionList.length>n.limitLazyLoad),t.xp6(3),t.Oqu(t.lcZ(10,17,"lang_split_points")),t.xp6(3),t.Q6J("ngIf",!n.isShowAllHelp),t.xp6(1),t.Q6J("ngIf",n.isShowAllHelp),t.xp6(1),t.s9C("matTooltip",t.lcZ(15,19,"lang_auto_chi_tiet_de_thi")),t.xp6(5),t.hij("",t.lcZ(20,21,"lang_testbank_create_exam_width_file_pdf_go_to"),": "),t.xp6(3),t.Q6J("formControl",n.myControl)("matAutocomplete",e),t.xp6(3),t.Q6J("ngForOf",t.lcZ(26,23,n.filteredOptions)),t.xp6(5),t.Oqu(t.lcZ(31,25,"lang_buttom_edit"))}}function Lc(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"b"),t._uU(2),t.qZA(),t.BQk()),2&o){const e=s.$implicit;t.xp6(2),t.hij("",e,"\xa0")}}function Nc(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",53)(1,"mat-icon",54),t._uU(2,"info_outlined"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.TgZ(5,"div",55),t.YNc(6,Lc,3,1,"ng-container",56),t.qZA(),t._uU(7),t.ALo(8,"mytranslate"),t.TgZ(9,"div",57)(10,"button",58),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.showNote=!1)}),t._uU(11),t.ALo(12,"mytranslate"),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(3),t.hij(" ",t.lcZ(4,4,"lang_testbank_create_exam_width_file_pdf_unrecognizable_one")," "),t.xp6(3),t.Q6J("ngForOf",e.errorQuestions),t.xp6(1),t.hij(" ",t.lcZ(8,6,"lang_testbank_create_exam_width_file_pdf_unrecognizable_twe"),". "),t.xp6(4),t.Oqu(t.lcZ(12,8,"lang_testbank_create_exam_width_file_pdf_understood"))}}function Dc(o,s){1&o&&(t.TgZ(0,"span",62),t._uU(1,",\xa0"),t.qZA())}function jc(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"b",60),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(4);let l;return t.KtG(r.goToQuestionAll(null!==(l=a.index)&&void 0!==l?l:0))}),t.ALo(2,"mytranslate"),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.YNc(5,Dc,2,0,"span",61),t.BQk()}if(2&o){const e=s.$implicit,n=s.index,i=t.oxw(4);t.xp6(1),t.s9C("matTooltip",t.lcZ(2,4,"lang_testbank_create_exam_width_file_pdf_click_roll")),t.xp6(2),t.AsE("",t.lcZ(4,6,"lang_testbank_create_exam_width_file_pdf_question")," ",e.question.label,""),t.xp6(2),t.Q6J("ngIf",n<i.invalidTypeQuestionConfig.length-1)}}function qc(o,s){if(1&o&&(t.ynx(0),t._uU(1),t.ALo(2,"mytranslate"),t.TgZ(3,"div",55),t.YNc(4,jc,6,8,"ng-container",56),t.qZA(),t.BQk()),2&o){const e=t.oxw(3);t.xp6(1),t.hij(" ",t.lcZ(2,2,"lang_testbank_create_exam_width_file_pdf_check_configuration")," "),t.xp6(3),t.Q6J("ngForOf",e.invalidTypeQuestionConfig)}}function Qc(o,s){if(1&o&&(t.TgZ(0,"div",59)(1,"mat-icon",54),t._uU(2,"info_outlined"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.YNc(5,qc,5,4,"ng-container",3),t.qZA()),2&o){const e=t.oxw(2);t.xp6(3),t.hij(" ",t.lcZ(4,2,"lang_testbank_create_exam_width_file_pdf_cant_save")," "),t.xp6(2),t.Q6J("ngIf",e.invalidTypeQuestionConfig.length>0)}}function Uc(o,s){1&o&&(t.ynx(0),t._uU(1),t.ALo(2,"mytranslate"),t.BQk()),2&o&&(t.xp6(1),t.hij("",t.lcZ(2,1,"lang_testbank_create_exam_width_file_pdf_cont_save"),"."))}function Fc(o,s){if(1&o&&(t.TgZ(0,"div",59)(1,"mat-icon",54),t._uU(2,"info_outlined"),t.qZA(),t.YNc(3,Uc,3,3,"ng-container",3),t.qZA()),2&o){const e=t.oxw(2);t.xp6(3),t.Q6J("ngIf",!e.nameExamInp.value||""==e.nameExamInp.value.trim())}}function Rc(o,s){1&o&&(t.TgZ(0,"div",63)(1,"div",64)(2,"div")(3,"mat-icon",65),t._uU(4,"cloud_upload"),t.qZA()(),t.TgZ(5,"div"),t._uU(6),t.ALo(7,"mytranslate"),t.qZA(),t.TgZ(8,"div")(9,"a",66),t.NdJ("click",function(n){return n.stopPropagation()}),t.ALo(10,"convertCdn"),t.ALo(11,"mytranslate"),t._uU(12),t.ALo(13,"mytranslate"),t.qZA()(),t.TgZ(14,"div")(15,"a",67),t.NdJ("click",function(n){return n.stopPropagation()}),t.ALo(16,"convertCdn"),t.ALo(17,"mytranslate"),t._uU(18),t.ALo(19,"mytranslate"),t.qZA()()()()),2&o&&(t.xp6(6),t.Oqu(t.lcZ(7,7,"lang_tutorial_upload_file_exam")),t.xp6(3),t.s9C("download",t.lcZ(11,11,"lang_auto_de_mau_azota_pdf")),t.Q6J("href",t.lcZ(10,9,"azota_assets/medias/de_mau_azota.zip"),t.LSH),t.xp6(3),t.Oqu(t.lcZ(13,13,"lang_auto_click_vao_day_de_download_de_mau")),t.xp6(3),t.s9C("download",t.lcZ(17,17,"lang_auto_de_mau_azota_pdf")),t.Q6J("href",t.lcZ(16,15,"azota_assets/medias/de_mau_azota.zip"),t.LSH),t.xp6(3),t.Oqu(t.lcZ(19,19,"lang_auto_de_mau_azota_pdf")))}function Bc(o,s){1&o&&(t.TgZ(0,"div",76),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_testbank_create_exam_width_file_pdf_exam_header_not_select")))}function Jc(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",72),t.YNc(1,Bc,3,3,"div",73),t.TgZ(2,"mat-icon",74),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.useHeader=!i.useHeader)}),t.ALo(3,"mytranslate"),t.ALo(4,"mytranslate"),t._uU(5,"clear"),t.qZA(),t._UZ(6,"img",75),t.qZA()}if(2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",!e.useHeader),t.xp6(1),t.Q6J("matTooltip",e.useHeader?t.lcZ(3,3,"lang_auto_xoa"):t.lcZ(4,5,"lang_auto_bo_xoa")),t.xp6(4),t.Q6J("src",e.examHeader,t.LSH)}}function Hc(o,s){1&o&&(t.TgZ(0,"div",99)(1,"mat-icon",54),t._uU(2,"error"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()),2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"lang_auto_cau_hoi_nay_khong_co_noi_dung_cac_dap_an_abcd_nen_dot")+"!"," "))}function zc(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"mat-icon",74),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3).$implicit,a=t.oxw(3);return t.KtG(a.toggleRemoveAllGroup(i.group))}),t.ALo(1,"mytranslate"),t._uU(2,"clear"),t.qZA()}2&o&&t.Q6J("matTooltip",t.lcZ(1,1,"lang_auto_xoa_toan_bo_cau_hoi_trong_nhom"))}function Yc(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"mat-icon",74),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3).$implicit,a=t.oxw(3);return t.KtG(a.toggleRemoveAllGroup(i.group))}),t.ALo(1,"mytranslate"),t._uU(2,"clear"),t.qZA()}2&o&&t.Q6J("matTooltip",t.lcZ(1,1,"lang_auto_bo_xoa_toan_bo_cau_hoi_trong_nhom"))}function Gc(o,s){1&o&&t._UZ(0,"div",76)}function $c(o,s){1&o&&(t.TgZ(0,"div",106),t.ALo(1,"mytranslate"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()),2&o&&(t.s9C("matTooltip",t.lcZ(1,2,"lang_testbank_create_exam_width_file_pdf_question_not_mix")),t.xp6(2),t.Oqu(t.lcZ(3,4,"lang_testbank_create_exam_width_file_pdf_not_mix")))}function Wc(o,s){1&o&&(t.TgZ(0,"div",107),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij("",t.lcZ(2,1,"lang_testbank_create_exam_width_file_pdf_not_mix"),"?"))}function Kc(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",100),t.YNc(1,zc,3,3,"mat-icon",101),t.YNc(2,Yc,3,3,"mat-icon",101),t.YNc(3,Gc,1,0,"div",73),t.TgZ(4,"div",102),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw(3);return t.KtG(a.toggleMixInGroup(i.group))}),t.YNc(5,$c,4,6,"div",103),t.YNc(6,Wc,3,3,"div",104),t._UZ(7,"img",105),t.ALo(8,"mytranslate"),t.ALo(9,"mytranslate"),t.qZA()()}if(2&o){const e=t.oxw(2),n=e.index,i=e.$implicit,a=t.oxw(3);t.Q6J("hidden",!a.firstInGroupIndexes.includes(n)),t.xp6(1),t.Q6J("ngIf",a.atLeastOneUse(i.group)),t.xp6(1),t.Q6J("ngIf",!a.atLeastOneUse(i.group)),t.xp6(1),t.Q6J("ngIf",!a.atLeastOneUse(i.group)),t.xp6(1),t.Gre("mb-2 img-group image_group_",i.group,""),t.xp6(1),t.Q6J("ngIf",i.groupType),t.xp6(1),t.Q6J("ngIf",!i.groupType),t.xp6(1),t.s9C("matTooltip",i.groupType?t.lcZ(8,11,"lang_testbank_create_exam_width_file_pdf_click_mix_question"):t.lcZ(9,13,"lang_testbank_create_exam_width_file_pdf_click_pin_question")),t.s9C("src",i.groupUrl,t.LSH)}}function Vc(o,s){1&o&&(t.TgZ(0,"div",76),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_testbank_create_exam_width_file_pdf_question_not_select")))}const Fi=function(o,s){return{"width.%":o,"height.%":s}};function Xc(o,s){if(1&o&&(t.TgZ(0,"div",115)(1,"div",116),t._UZ(2,"img",117)(3,"img",110),t.qZA()()),2&o){const e=s.$implicit,n=t.oxw(3).$implicit;t.xp6(2),t.Q6J("ngStyle",t.WLB(4,Fi,e.remove.width/n.question.width*100,e.remove.height/n.question.height*100))("src",e.remove.url,t.LSH),t.xp6(1),t.Q6J("ngStyle",t.WLB(7,Fi,e.width/n.question.width*100,e.height/n.question.height*100))("src",e.url,t.LSH)}}function t_(o,s){if(1&o&&(t.TgZ(0,"div",108)(1,"div",109),t._UZ(2,"img",110),t.qZA(),t.TgZ(3,"div",111),t._UZ(4,"img",112),t.qZA(),t.TgZ(5,"div",113),t.YNc(6,Xc,4,10,"div",114),t.qZA()()),2&o){const e=t.oxw(2).$implicit;t.xp6(2),t.Q6J("ngStyle",t.WLB(6,Fi,e.question.remove.width/e.question.width*100,e.question.remove.height/e.question.height*100))("src",e.question.remove.url,t.LSH),t.xp6(2),t.Q6J("width",e.question.width)("height",e.question.height)("src",e.question.url,t.LSH),t.xp6(2),t.Q6J("ngForOf",e.answers)}}function e_(o,s){1&o&&t._UZ(0,"div",76)}function n_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"span",120),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(3).$implicit,l=t.oxw(3);return t.KtG(l.changeAnswerResult(r,a.label))}),t._uU(1),t.qZA()}if(2&o){const e=s.$implicit,n=t.oxw(3).$implicit;t.Q6J("ngClass",n.tempData.answerResult.includes(e.label)?"btn-ans-result":""),t.xp6(1),t.Oqu(e.label)}}function i_(o,s){if(1&o&&(t.TgZ(0,"div",118)(1,"span",92),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.YNc(4,n_,2,2,"span",119),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(2),t.hij("",t.lcZ(3,2,"lang_testbank_create_exam_width_file_pdf_answer"),": "),t.xp6(2),t.Q6J("ngForOf",e.answers)}}function o_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",121)(1,"span",122),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).index,a=t.oxw(3);return t.KtG(a.setupFillAnswersQuestion(i))}),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()}2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_testbank_create_exam_width_file_pdf_enter_add_answer")," "))}function a_(o,s){1&o&&(t.TgZ(0,"b"),t._uU(1,"\u25b2"),t.qZA())}function s_(o,s){1&o&&(t.TgZ(0,"mat-icon",95),t.ALo(1,"mytranslate"),t._uU(2,"shuffle"),t.qZA()),2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_testbank_create_exam_width_file_pdf_keep_stable_answer"))}function r_(o,s){1&o&&(t.TgZ(0,"mat-icon",95),t.ALo(1,"mytranslate"),t._uU(2,"shuffle_on"),t.qZA()),2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_testbank_create_exam_width_file_pdf_tutorial_click_mix_question"))}function l_(o,s){1&o&&(t.ynx(0),t._uU(1,"\xa0|\xa0"),t.BQk())}function c_(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"b"),t._uU(2),t.qZA(),t.YNc(3,l_,2,0,"ng-container",3),t.BQk()),2&o){const e=s.$implicit,n=s.index,i=t.oxw(4).$implicit;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",n<i.tempData.answerResult.length-1)}}function __(o,s){if(1&o&&(t.TgZ(0,"div",125),t._uU(1),t.ALo(2,"mytranslate"),t.YNc(3,c_,4,2,"ng-container",56),t.qZA()),2&o){const e=t.oxw(3).$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,2,"lang_testbank_create_exam_width_file_pdf_list_answer"),": "),t.xp6(2),t.Q6J("ngForOf",e.tempData.answerResult)}}function d_(o,s){1&o&&(t.TgZ(0,"div",126)(1,"mat-icon",54),t._uU(2,"info_outlined"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()),2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"lang_testbank_create_exam_width_file_pdf_please_enter_answer")," "))}function u_(o,s){1&o&&(t.TgZ(0,"div",125)(1,"mat-icon",54),t._uU(2,"info_outlined"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.TgZ(5,"a",127),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()),2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,2,"lang_testbank_create_exam_width_file_pdf_not_identification_answer"),". "),t.xp6(3),t.hij(" ",t.lcZ(7,4,"lang_auto_xem_huong_dan")," "))}function m_(o,s){1&o&&(t.TgZ(0,"div",126)(1,"mat-icon",54),t._uU(2,"info_outlined"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()),2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"lang_testbank_create_exam_width_file_pdf_note_quizzes")," "))}function h_(o,s){1&o&&(t.TgZ(0,"div",126)(1,"mat-icon",54),t._uU(2,"info_outlined"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()),2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"lang_testbank_create_exam_width_file_pdf_enter_max_point")," "))}function p_(o,s){1&o&&(t.TgZ(0,"div",126)(1,"mat-icon",54),t._uU(2,"info_outlined"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()),2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"lang_testbank_create_exam_width_file_pdf_please_select_answer")," "))}function g_(o,s){if(1&o&&(t.TgZ(0,"div",130),t._UZ(1,"img",131),t.qZA()),2&o){const e=t.oxw(4).$implicit;t.xp6(1),t.Q6J("src",e.help.url,t.LSH)}}function f_(o,s){1&o&&(t.TgZ(0,"div",132),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_testbank_create_exam_width_file_pdf_not_data_explain")))}function x_(o,s){if(1&o&&(t.ynx(0),t.YNc(1,g_,2,1,"div",128),t.YNc(2,f_,3,3,"ng-template",null,129,t.W1O),t.BQk()),2&o){const e=t.MAs(3),n=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngIf",n.help.url)("ngIfElse",e)}}function v_(o,s){if(1&o&&(t.ynx(0),t.YNc(1,__,4,4,"div",123),t.ALo(2,"isFillAnswer"),t.YNc(3,d_,5,3,"div",124),t.ALo(4,"isFillAnswer"),t.YNc(5,u_,8,6,"div",123),t.YNc(6,m_,5,3,"div",124),t.ALo(7,"isOneChoiceAnswer"),t.YNc(8,h_,5,3,"div",124),t.YNc(9,p_,5,3,"div",124),t.ALo(10,"isOneChoiceAnswer"),t.YNc(11,x_,4,2,"ng-container",3),t.BQk()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf",e.tempData.answerResult.length>0&&t.lcZ(2,7,e.tempData.answerType)),t.xp6(2),t.Q6J("ngIf",0==e.tempData.answerResult.length&&t.lcZ(4,9,e.tempData.answerType)),t.xp6(2),t.Q6J("ngIf",e.answers.length>0&&1==e.answers[0].width&&1==e.answers[0].height),t.xp6(1),t.Q6J("ngIf",e.answers.length<2&&t.lcZ(7,11,e.tempData.answerType)),t.xp6(2),t.Q6J("ngIf",e.tempData.point<0),t.xp6(1),t.Q6J("ngIf",0==e.tempData.answerResult.length&&t.lcZ(10,13,e.tempData.answerType)),t.xp6(2),t.Q6J("ngIf",e.tempData.isShowHelp)}}function b_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",137),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3).index,a=t.oxw(3);return t.KtG(a.clickUploadFile(i))}),t.TgZ(1,"div",121)(2,"mat-icon",65),t._uU(3,"cloud_upload"),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"p"),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()()()}2&o&&(t.xp6(5),t.Oqu(t.lcZ(6,2,"lang_testbank_create_exam_width_file_pdf_attach_file_audio")),t.xp6(3),t.hij("",t.lcZ(9,4,"lang_testbank_create_exam_width_file_docx_click_choose_audio"),"."))}function w_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",140)(1,"audio",141),t._UZ(2,"source",142),t.ALo(3,"mycdn"),t._uU(4," Your browser does not support the audio element. "),t.qZA(),t.TgZ(5,"span",143),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(4).$implicit;return t.KtG(i.tempData.questionMedia=[])}),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()}if(2&o){const e=s.$implicit;t.xp6(2),t.Q6J("src",t.lcZ(3,2,e.url),t.LSH),t.xp6(4),t.hij(" ",t.lcZ(7,4,"lang_auto_xoa")," ")}}function T_(o,s){if(1&o&&(t.TgZ(0,"div",138),t.YNc(1,w_,8,6,"div",139),t.qZA()),2&o){const e=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngForOf",e.tempData.questionMedia)}}function C_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",133)(1,"input",134),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw(2).$implicit,r=t.oxw(3);return t.KtG(r.uploadFileQuestion(a,i))}),t.qZA(),t.YNc(2,b_,10,6,"div",135),t.YNc(3,T_,2,1,"div",136),t.qZA()}if(2&o){const e=t.oxw(2),n=e.index,i=e.$implicit;t.xp6(1),t.Q6J("id","inputFileQuestion_"+n),t.xp6(1),t.Q6J("ngIf",0===i.tempData.questionMedia.length),t.xp6(1),t.Q6J("ngIf",i.tempData.questionMedia.length>0)}}function A_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",79),t.YNc(1,Hc,5,3,"div",80),t.ALo(2,"isOneChoiceAnswer"),t.YNc(3,Kc,10,15,"div",81),t.TgZ(4,"div",82)(5,"mat-icon",74),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,a=t.oxw(3);return t.KtG(a.changeSelectTempData(i))}),t.ALo(6,"mytranslate"),t.ALo(7,"mytranslate"),t._uU(8,"clear"),t.qZA(),t.YNc(9,Vc,3,3,"div",73),t.YNc(10,t_,7,9,"div",83),t.qZA(),t.TgZ(11,"div",84)(12,"div",85),t.YNc(13,e_,1,0,"div",73),t.TgZ(14,"div",86)(15,"span",87),t._uU(16),t.ALo(17,"mytranslate"),t.qZA(),t.TgZ(18,"select",88),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw(3);return t.KtG(r.changeTypeQuestion(a,i))}),t.TgZ(19,"option",89),t.ALo(20,"isOneChoiceAnswer"),t._uU(21),t.ALo(22,"mytranslate"),t.qZA(),t.TgZ(23,"option",89),t.ALo(24,"isFillAnswer"),t._uU(25),t.ALo(26,"mytranslate"),t.qZA(),t.TgZ(27,"option",89),t.ALo(28,"isEssayAnswer"),t._uU(29),t.ALo(30,"mytranslate"),t.qZA()()(),t.YNc(31,i_,5,4,"div",90),t.ALo(32,"isOneChoiceAnswer"),t.YNc(33,o_,4,3,"div",91),t.ALo(34,"isFillAnswer"),t.TgZ(35,"div",86)(36,"span",92),t._uU(37),t.ALo(38,"mytranslate"),t.qZA(),t.TgZ(39,"input",93),t.NdJ("input",function(i){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw(3);return t.KtG(r.changeQuestionPoint(a,i))}),t.qZA()(),t.TgZ(40,"mat-icon",51),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(3);return t.KtG(a.toggleViewHelp(i))}),t.ALo(41,"mytranslate"),t._uU(42),t.qZA(),t.TgZ(43,"span",94),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.KtG(i.tempData.isShowAttach=!i.tempData.isShowAttach)}),t.TgZ(44,"mat-icon",95),t.ALo(45,"mytranslate"),t._uU(46,"attachment"),t.qZA(),t.YNc(47,a_,2,0,"b",3),t.qZA(),t.TgZ(48,"span",96),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(3);return t.KtG(a.toogleMixAns(i))}),t.YNc(49,s_,3,3,"mat-icon",97),t.YNc(50,r_,3,3,"mat-icon",97),t.qZA()()(),t.YNc(51,v_,12,15,"ng-container",3),t.YNc(52,C_,4,3,"div",98),t.qZA()}if(2&o){const e=t.oxw(),n=e.index,i=e.$implicit,a=t.oxw(3);t.uIk("id","box-questions-item-"+n),t.xp6(1),t.Q6J("ngIf",0==i.answers.length&&t.lcZ(2,31,i.tempData.answerType)),t.xp6(2),t.Q6J("ngIf",i.groupUrl),t.xp6(2),t.Q6J("matTooltip",i.tempData.isSelect?t.lcZ(6,33,"lang_auto_xoa"):t.lcZ(7,35,"lang_auto_bo_xoa")),t.xp6(4),t.Q6J("ngIf",!i.tempData.isSelect),t.xp6(1),t.Q6J("ngIf",a.debuggingMode.value),t.xp6(2),t.Q6J("ngClass","")("ngClass","border-result"),t.xp6(1),t.Q6J("ngIf",!i.tempData.isSelect),t.xp6(3),t.Oqu(t.lcZ(17,37,"lang_testbank_create_exam_width_file_pdf_question")+" "+i.question.label),t.xp6(3),t.Q6J("value",1)("selected",t.lcZ(20,39,i.tempData.answerType)),t.xp6(2),t.Oqu(t.lcZ(22,41,"lang_testbank_create_exam_width_file_pdf_select_answer")),t.xp6(2),t.Q6J("value",4)("selected",t.lcZ(24,43,i.tempData.answerType)),t.xp6(2),t.Oqu(t.lcZ(26,45,"lang_testbank_create_exam_width_file_pdf_enter_blank")),t.xp6(2),t.Q6J("value",3)("selected",t.lcZ(28,47,i.tempData.answerType)),t.xp6(2),t.Oqu(t.lcZ(30,49,"lang_testbank_create_exam_width_file_docx_essay")),t.xp6(2),t.Q6J("ngIf",t.lcZ(32,51,i.tempData.answerType)),t.xp6(2),t.Q6J("ngIf",t.lcZ(34,53,i.tempData.answerType)),t.xp6(4),t.hij("",t.lcZ(38,55,"lang_point"),": "),t.xp6(2),t.Q6J("value",i.tempData.point.toString().length>8?i.tempData.point.toFixed(8):i.tempData.point),t.xp6(1),t.s9C("matTooltip",t.lcZ(41,57,"lang_testbank_create_exam_width_file_pdf_hide_view_explain")),t.xp6(2),t.hij(" ",i.tempData.isShowHelp?"help":"help_outlined"," "),t.xp6(2),t.s9C("matTooltip",t.lcZ(45,59,"lang_testbank_create_exam_width_file_pdf_attach_file_question")),t.xp6(3),t.Q6J("ngIf",i.tempData.isShowAttach),t.xp6(2),t.Q6J("ngIf",1==i.isFixAns),t.xp6(1),t.Q6J("ngIf",0==i.isFixAns),t.xp6(1),t.Q6J("ngIf",i.tempData.isSelect),t.xp6(1),t.Q6J("ngIf",!0===i.tempData.isShowAttach)}}function y_(o,s){if(1&o&&(t.TgZ(0,"div",77),t.YNc(1,A_,53,61,"div",78),t.qZA()),2&o){const e=s.index,n=t.oxw(3);t.xp6(1),t.Q6J("ngIf",n.questionList.length<=n.limitLazyLoad||e>=n.startChunkIndex&&e<n.startChunkIndex+n.lazyLoadSize)}}function k_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",144)(1,"div"),t._uU(2,"Trang "),t.TgZ(3,"input",49),t.NdJ("keyup.enter",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.handleEnterPage(i))})("ngModelChange",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.currentPage=i)}),t.qZA(),t._uU(4),t.qZA(),t.TgZ(5,"mat-icon",50),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.changePage("prev"))}),t.ALo(6,"mytranslate"),t._uU(7,"chevron_left"),t.qZA(),t.TgZ(8,"span"),t._uU(9),t.qZA(),t.TgZ(10,"mat-icon",50),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.changePage("next"))}),t.ALo(11,"mytranslate"),t._uU(12,"chevron_right"),t.qZA()()}if(2&o){const e=t.oxw(3);t.xp6(3),t.Q6J("ngModel",e.currentPage),t.xp6(1),t.hij(" / ",e.totalPage,""),t.xp6(1),t.s9C("matTooltip",t.lcZ(6,8,"lang_auto_trang_truoc")),t.Q6J("ngStyle",t.VKq(12,mi,e.topLazyLoad?"inherit":"#595959")),t.xp6(4),t.AsE("",e.startChunkIndex+1,"-",e.startChunkIndex+e.lazyLoadSize>e.questionList.length-1?e.questionList.length:e.startChunkIndex+e.lazyLoadSize,""),t.xp6(1),t.s9C("matTooltip",t.lcZ(11,10,"lang_auto_trang_sau")),t.Q6J("ngStyle",t.VKq(14,mi,e.bottomLazyLoad?"inherit":"#595959"))}}function O_(o,s){if(1&o&&(t.TgZ(0,"div",68),t.YNc(1,Jc,7,7,"div",69),t.YNc(2,y_,2,1,"div",70),t.YNc(3,k_,13,16,"div",71),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.examHeader),t.xp6(1),t.Q6J("ngForOf",e.questionList),t.xp6(1),t.Q6J("ngIf",e.questionList.length>e.limitLazyLoad)}}function S_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",145),t._uU(1),t.ALo(2,"mytranslate"),t._UZ(3,"br"),t._uU(4),t.ALo(5,"mytranslate"),t._UZ(6,"br"),t.TgZ(7,"mat-icon",146),t._uU(8,"report"),t.qZA(),t._UZ(9,"br"),t.TgZ(10,"span",147),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.resetBoxExamQuestions("tryOther"))}),t._uU(11),t.ALo(12,"mytranslate"),t.qZA()()}2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,3,"lang_testbank_create_exam_width_file_pdf_not_analysis_exam"),". "),t.xp6(3),t.hij(" ",t.lcZ(5,5,"lang_testbank_create_exam_width_file_pdf_contact_admin"),". "),t.xp6(7),t.Oqu(t.lcZ(12,7,"lang_testbank_create_exam_width_file_pdf_create_exam")))}function E_(o,s){if(1&o&&(t.TgZ(0,"div",153)(1,"span",154),t._uU(2),t.qZA()()),2&o){const e=s.$implicit;t.xp6(2),t.Oqu(e)}}function I_(o,s){if(1&o&&(t.TgZ(0,"div",148)(1,"div",149)(2,"div",150),t._UZ(3,"mat-spinner",151),t.qZA(),t.YNc(4,E_,3,1,"div",152),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(3),t.Q6J("strokeWidth",2)("diameter",30),t.xp6(1),t.Q6J("ngForOf",e.arrStatusFileExam)}}function Z_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",155)(1,"app-cropper-edit",156),t.NdJ("applyEdit",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.applyEditEvent(i))}),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("listQuestion",e.rootQuestionInfo)("headerPosition",e.rootHeaderPosition)("listCanvas",e.rootCanvases)}}const M_=function(o){return{width:o}};function P_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",4)(1,"editor-layout",5),t.NdJ("handleConfirm",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.rxjsHandleSaveExam())})("handleCancel",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.resetBoxExamQuestions())}),t.TgZ(2,"div",6)(3,"div",7)(4,"div",8,9)(6,"div",10,11),t._UZ(8,"input",12),t.YNc(9,Pc,32,27,"div",13),t.YNc(10,Nc,13,10,"div",14),t.YNc(11,Qc,6,4,"div",15),t.YNc(12,Fc,4,1,"div",15),t.TgZ(13,"div",16),t.YNc(14,Rc,20,21,"div",17),t._UZ(15,"div",18)(16,"div",19),t.YNc(17,O_,4,3,"div",20),t.YNc(18,S_,13,9,"div",21),t.qZA()(),t.TgZ(19,"div",22,23),t.NdJ("mousedown",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.handleMouseDown(i))}),t.qZA(),t.TgZ(21,"div",24,25),t._UZ(23,"div",26,27)(25,"iframe",28),t.ALo(26,"safe"),t.qZA()()(),t.YNc(27,I_,5,3,"div",29),t.qZA()()(),t.YNc(28,Z_,2,3,"ng-template",30)}if(2&o){const e=t.oxw();t.Q6J("hidden",e.editting),t.xp6(1),t.Q6J("headerBackTolink",e.backToLink)("showInput",!0)("showConfirmButton",!0)("examName",e.nameExamInp),t.xp6(5),t.Q6J("ngStyle",t.VKq(19,M_,e.notShowSourceFile?"100%":"calc(60% - 5px)")),t.xp6(3),t.Q6J("ngIf",e.questionList.length>0),t.xp6(1),t.Q6J("ngIf",e.errorQuestions.length>0&&e.showNote),t.xp6(1),t.Q6J("ngIf",e.invalidTypeQuestionConfig.length>0),t.xp6(1),t.Q6J("ngIf",!e.nameExamInp.value||""==e.nameExamInp.value.trim()),t.xp6(2),t.Q6J("ngIf",!e.doneAllProccessTasks),t.xp6(3),t.Q6J("ngIf",e.questionList.length>0&&e.cropperDone),t.xp6(1),t.Q6J("ngIf",e.errAnalyzingPdf),t.xp6(3),t.Q6J("hidden",e.notShowSourceFile),t.xp6(4),t.Q6J("src",t.lcZ(26,17,e.examFileUrl),t.uOi),t.xp6(2),t.Q6J("ngIf",e.isShowLoadingFileExam),t.xp6(1),t.Q6J("ngIf",e.editting)}}function L_(o,s){1&o&&(t.TgZ(0,"div",157),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_no_support_browser"),"\n"))}function N_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"azt-split-point",158),t.NdJ("closeDialog",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeDialogSpitPoint())})("setPoint",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.setPointTest(i))}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("data",e.dataSpitPoint)}}function D_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"azt-exam-info",159),t.NdJ("closeDialog",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeDialogExamInfo())}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("startIndexQuestion",e.startQuestion)("data",e.dataExamInfo)("type","createPDF")}}const Yn="exam_questions";let j_=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_,d,m,p,w,C,A,M){super(n),this.cropperService=e,this.commonService=n,this.activeRoute=i,this.dialog=a,this.questionService=r,this.apiUploadService=l,this.userService=c,this.infoService=_,this.examService=d,this.configService=m,this.cdnService=p,this.answerTypeService=w,this.redirectService=C,this.editorOutputDataService=A,this.browserStorageService=M,this.x=0,this.y=0,this.leftWidth=0,this.cropperDone=!1,this.startChunkIndex=0,this.currentPage=1,this.editting=!1,this.errAnalyzingPdf=!1,this.categoriesIdParram=+this.commonService.getMyParam(this.activeRoute,"cat_id"),this.examFileUrl=this.cdnService.convertLinkCdn("azota_assets/images/file_placeholder.jpg"),this.version="v2.0",this.cur_cateId=0,this.backToLink="",this.nameExamInp=new h.p4(""+Date.now()),this.totalPoint=new h.p4(10),this.isChangePoint=!1,this.isMixture=!1,this.confirmTotalQuestionChange=!1,this.examConfigs=[],this.newQuestionArrSave=[],this.isChangeQuestionPoint=!1,this.isShowLoadingFileExam=!1,this.arrStatusFileExam=[],this.isShowAllHelp=!1,this.curGotoIndex=new h.p4(0),this.showNote=!0,this.debuggingMode=new h.p4(!0),this.message=[],this.errorQuestions=[],this.doneAllProccessTasks=!1,this.notShowSourceFile=!0,this.questionList=[],this.questionConfigList=[],this.rootQuestionInfo=[],this.rootCanvases=[],this.clonedCtxForCreate=[],this.labelHolderSize={width:3500,height:3500},this.labelsBase64s=[],this.labelsUrls=[],this.resultUploadBase64Labels=[],this.abcdLabelPos={},this.questionLabelMap=[],this.maxQuestionLabelHeight=0,this.examHeader="",this.useHeader=!0,this.selects=[],this.nextIndex=0,this.countGroup=0,this.groupImages={},this.groupLengths=[],this.firstInGroupIndexes=[],this.totalInGroupTracking=0,this.countSaveQuestion=0,this.cropPdfConfigParam="",this.countClickApplyEdit=0,this.dataSpitPoint={isShow:!1},this.countTrueFalseQuestion=0,this.multiplePoint=10,this.essayPoint=0,this.dataExamInfo={isShow:!1},this.startQuestion=1,this.handleMouseUp=D=>{var q,U,F,tt,W;this.maskLayer&&(this.maskLayer.nativeElement.style.width="0px"),this.resizeBar&&this.resizeBar.nativeElement.classList.remove("hover"),null===(q=this.resizeBar)||void 0===q||q.nativeElement.style.removeProperty("cursor"),document.body.style.removeProperty("cursor"),null===(U=this.iframePdf)||void 0===U||U.nativeElement.style.removeProperty("user-select"),null===(F=this.iframePdf)||void 0===F||F.nativeElement.style.removeProperty("pointer-events"),null===(tt=this.boxLeftFile)||void 0===tt||tt.nativeElement.style.removeProperty("user-select"),null===(W=this.boxLeftFile)||void 0===W||W.nativeElement.style.removeProperty("pointer-events"),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp)},this.handleMouseMove=D=>{if(this.parentResize&&this.iframePdf&&this.boxLeftFile){let q=this.iframePdf.nativeElement,U=this.boxLeftFile.nativeElement;const tt=100*(this.leftWidth+(D.clientX-this.x))/this.parentResize.nativeElement.getBoundingClientRect().width;U.style.width=`${tt}%`,document.body.style.cursor="col-resize",q.style.userSelect="none",q.style.pointerEvents="none",U.style.userSelect="none",U.style.pointerEvents="none"}},this.myControl=new h.p4(this.startQuestion),this.handleSaveAllExam=()=>{var D,q;let U=null!==(D=this.commonService.myTranslateIntance("lang_auto_luu_xong_tat_ca_cau_hoi_vao_he_thong"))&&void 0!==D?D:"",F=null!==(q=this.commonService.myTranslateIntance("lang_auto_dang_luu_thong_tin_de_thi"))&&void 0!==q?q:"";this.arrStatusFileExam=[U,`${F} ...`];let tt=this.userService.getUserObj(),W=JSON.stringify({type:"exam",id:0,user:tt.id});var P={categoryId:this.categoriesIdParram,scoringMethod:"1",name:this.nameExamInp.value,examConfigs:JSON.stringify(this.examConfigs),suggestions:JSON.stringify([]),labelsUrl:JSON.stringify(this.labelsUrls),abcdLabelPos:JSON.stringify(this.abcdLabelPos),questionLabelMap:JSON.stringify(this.questionLabelMap),firstInGroupIndexes:JSON.stringify(this.firstInGroupIndexes),totalExam:1,cdnExamFile:this.examFileUrl,trackEdit:this.countClickApplyEdit>0?JSON.stringify({countClickApplyEdit:this.countClickApplyEdit}):"",examHeader:this.examHeader,cutData:this.rootQuestionInfo,editorStatus:4,startQuestionIndex:this.questionList.length>0&&this.questionList[0].question.label>0?this.questionList[0].question.label:1};this.examService.apiExamSaveObjPost(P,W).subscribe(R=>{var N;if(1==R.success){let B=null!==(N=this.commonService.myTranslateIntance("lang_auto_luu_de_thi_thanh_cong_dang_chuyen_huong"))&&void 0!==N?N:"";this.arrStatusFileExam=[`${B} ...`],setTimeout(()=>{var z,X;jQuery("html").css("overflow","auto"),this.commonService.myNavigationWithQueryString("/admin/testbank/action-online-offline/"+this.categoriesIdParram+"/"+(null===(X=null===(z=R.data)||void 0===z?void 0:z.obj)||void 0===X?void 0:X.hashId),"?backto="+encodeURIComponent(`/admin/testbank/document-management/0/${this.categoriesIdParram}/1`))},1500)}else this.showErrorSnack("lang_auto_tao_de_thi_khong_thanh_cong_vui_long_thu_lai"),this.isShowLoadingFileExam=!1})}}get isSupportedBrowser(){var r,a,l;let n=(a=navigator.userAgent,l=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],/trident/i.test(l[1])?"IE "+((r=/\brv[ :]+(\d+)/g.exec(a)||[])[1]||""):"Chrome"===l[1]&&null!=(r=a.match(/\b(OPR|Edge)\/(\d+)/))?r.slice(1).join(" ").replace("OPR","Opera"):(l=l[2]?[l[1],l[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(r=a.match(/version\/(\d+)/i))&&l.splice(1,1,r[1]),l.join(" "))).toString();return!(!["chrome","firefox"].includes(n.split(" ")[0].toLowerCase())||parseInt(n.split(" ")[1])<75)}atLeastOneUse(e){return this.questionList.filter(n=>n.group===e&&n.tempData.isSelect).length>0}changePage(e){"prev"==e&&(this.topLazyLoad?(this.startChunkIndex-=Ie,this.currentPage--):(this.startChunkIndex=0,this.currentPage=1)),"next"==e&&this.bottomLazyLoad&&(this.startChunkIndex+=Ie,this.currentPage++)}handleMouseDown(e){this.boxLeftFile&&(this.x=e.clientX,this.y=e.clientY,this.leftWidth=this.boxLeftFile.nativeElement.getBoundingClientRect().width,this.maskLayer&&(this.maskLayer.nativeElement.style.width="100%"),this.resizeBar&&this.resizeBar.nativeElement.classList.add("hover"),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp))}_filter(e){return this.questionList}handleEnterQuestion(e){let n=e.target,i=parseInt(n.value);(i<1||i>this.questionList.length)&&(i=1,this.myControl.setValue(this.startQuestion)),this.questionList.length<=500?this.goToQuestionAll(i-1):1==i?(this.startChunkIndex=0,this.currentPage=1,setTimeout(()=>{this.goToQuestionAll(i-1)},1e3)):(this.currentPage=Math.ceil(i/Ie),this.startChunkIndex=(this.currentPage-1)*Ie,setTimeout(()=>{this.goToQuestionAll(i-1)},1e3)),n.blur(),this.hiddenInput&&this.hiddenInput.nativeElement.click()}handleEnterPage(e){let n=e.target,i=parseInt(n.value);i<1||i>this.totalPage?(this.startChunkIndex=0,this.currentPage=1):(this.startChunkIndex=(i-1)*Ie,this.currentPage=i),n.blur()}handleClickOption(e){if(e>=this.startChunkIndex&&e<this.startChunkIndex+Ie)this.goToQuestionAll(e);else{let n=e+1;1==n?(this.startChunkIndex=0,this.currentPage=1,setTimeout(()=>{this.goToQuestionAll(n-1)},1e3)):(this.currentPage=Math.ceil(n/Ie),this.startChunkIndex=(this.currentPage-1)*Ie,setTimeout(()=>{this.goToQuestionAll(n-1)},1e3))}}get totalPage(){return Math.ceil(this.questionList.length/this.lazyLoadSize)}get topLazyLoad(){return this.questionList.length>500&&this.startChunkIndex-Ie>=0}get bottomLazyLoad(){return this.questionList.length>500&&this.startChunkIndex+Ie<=this.questionList.length-1}get placeholderLink(){return this.cdnService.convertLinkCdn("azota_assets/svgs/Img2_dat-01.svg")}get lazyLoadSize(){return Ie}get limitLazyLoad(){return 500}openManualDialog(e){this.dialog.open(q_,{width:"1000px",data:{fromButton:e}}).afterClosed().subscribe(i=>{i&&this.browserStorageService.saveStorage("_DONT_SHOW_MANUAL","OK")})}startProcessFile(e){this.nameExamInp.setValue(e.name),this.uploadFilePdf(e),this.processPdf(e)}ngOnInit(){this.isSupportedBrowser&&((0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{this.cur_cateId=this.commonService.getMyParam(this.activeRoute,"cat_id");var e=this.commonService.getMyQueryParam("backto");this.backToLink=null!=e?e:"/admin/testbank/create-new-document/"+(null!=this.cur_cateId?this.cur_cateId:0),this.infoService.apiInfoGetConfigObjsGet("CROPPDF_PARAMS").subscribe(n=>{this.cropPdfConfigParam=n.CROPPDF_PARAMS,this.loadingFileJs().then(i=>{if(i){const a=this.editorOutputDataService.getFirstFile();a?this.startProcessFile(a):this.redirectService.redirectByUrl(this.commonService.getLocalRouter(this.backToLink)),this.listeningDropFileExam()}})})}),this.filteredOptions=this.myControl.valueChanges.pipe((0,fo.O)(""),(0,qi.U)(e=>this._filter(e||""))))}ngOnDestroy(){jQuery("#hiddenWrapper").remove()}get totalNumberQuestion(){return this.questionList.filter(e=>e.tempData.isSelect&&!this.answerTypeService.isEssayAnswer(e.tempData.answerType)).length}get invalidTypeQuestionConfig(){return this.questionList.filter(e=>e.tempData.isSelect&&(e.tempData.point<0||!isFinite(e.tempData.point)||0==e.tempData.answerResult.length&&this.answerTypeService.isFillAnswer(e.tempData.answerType)||0==e.tempData.answerResult.length&&this.answerTypeService.isOneChoiceAnswer(e.tempData.answerType)||e.answers.length<2&&this.answerTypeService.isOneChoiceAnswer(e.tempData.answerType)))}changePointQuestionClick(){for(let e=0;e<this.questionList.length;e++)this.answerTypeService.isEssayAnswer(this.questionList[e].tempData.answerType)||(this.questionList[e].tempData.point=this.totalPoint.value/this.totalNumberQuestion);this.isChangeQuestionPoint=!0,this.showSuccessSnack("lang_auto_chia_diem_thanh_cong")}changeQuestionPoint(e,n){for(let i=0;i<this.questionList.length;i++)this.questionList[i].question.label===e.question.label&&(this.questionList[i].tempData.point=Number(n.target.value))}changeAnswerResult(e,n){e.tempData.answerResult=[n]}changeTypeQuestion(e,n){e.tempData.answerType=Number(n.target.value),4==Number(n.target.value)&&(e.tempData.answerResult=[])}uploadFileQuestion(e,n){var i,a=n.target.files[0];let r=this.commonService.myTranslateIntance("lang_auto_dang_tai_len_tep_tin_dinh_kem_cho_cau_hoi");if(!0===(0,Ut.Wg)(a.type))this.arrStatusFileExam=[`${r}  (0%)`],this.isShowLoadingFileExam=!0,this.apiUploadService.uploadToCdnProgressOldExamQuestion(a).subscribe(l=>{var c;if(l.type!=Te.dt.UploadProgress)if(1==l.success){e.tempData.questionMedia.push(l.data);let _=null!==(c=this.commonService.myTranslateIntance("lang_auto_tai_len_thanh_cong"))&&void 0!==c?c:"";this.arrStatusFileExam=[_],this.isShowLoadingFileExam=!1}else this.showErrorSnack("lang_auto_upload_that_bai");else if(l.loaded&&l.total){let _=Math.round(l.loaded/l.total*100);this.arrStatusFileExam=[`${r} (${_}%)`]}});else{let l=null!==(i=this.commonService.myTranslateIntance("lang_auto_chi_duoc_dinh_kem_tep_tin_mp_3_hoac_wav"))&&void 0!==i?i:"";this.showErrorSnack(l)}}uploadFilePdf(e){this.apiUploadService.uploadToCdnProgressForTestbankPdf(e).subscribe(n=>{var i,a;n.type!=Te.dt.UploadProgress&&(1==n.success?(this.examFileUrl=null!==(a=null===(i=n.data)||void 0===i?void 0:i.url)&&void 0!==a?a:"",this.notShowSourceFile=!1):this.showErrorSnack("lang_auto_upload_that_bai"))})}clickUploadFile(e){jQuery(`#inputFileQuestion_${e}`).trigger("click")}changeIsSelect(e,n){e.tempData.isSelect=n}setupFillAnswersQuestion(e){var n=this.questionList[e];const i=[...n.tempData.answerResult];this.dialog.open(xo.P,{width:"50%",data:{answers:n.tempData.answerResult}}).afterClosed().subscribe(r=>{!1===r&&(n.tempData.answerResult=i)})}listeningDropFileExam(){var e=this,n=jQuery("#box-left-file-drop");n.on("drag dragstart dragend dragover dragenter dragleave drop",function(i){i.preventDefault(),i.stopPropagation()}).on("dragover dragenter",function(){n.addClass("is-dragover")}).on("dragleave dragend drop",function(){n.removeClass("is-dragover")}).on("drop",function(i){e.nameExamInp.setValue(i.originalEvent.dataTransfer.files[0].name),e.uploadFilePdf(i.originalEvent.dataTransfer.files[0]),e.processPdf(i.originalEvent.dataTransfer.files[0])}),jQuery("#box-left-file-input").change(()=>{e.nameExamInp.setValue(jQuery("#box-left-file-input").get(0).files[0].name),e.uploadFilePdf(jQuery("#box-left-file-input").get(0).files[0]),e.processPdf(jQuery("#box-left-file-input").get(0).files[0])}),jQuery(n).click(()=>{jQuery("#box-left-file-input").trigger("click")})}processPdf(e){let n=this.commonService.myTranslateIntance("lang_auto_dang_tien_hanh_phan_tich");window.startLoading=()=>{this.arrStatusFileExam=[`${n} ...`],this.isShowLoadingFileExam=!0},this.arrStatusFileExam=[`${n} ...`],this.isShowLoadingFileExam=!0,jQuery("#box-left-file-drop").hide();var a=new Jl.Process(this.cropPdfConfigParam);a.setUpdateStatusCallback(c=>{c.startsWith("Rendering")?0==this.message.length?this.message.push(c):this.message[this.message.length-1]=c:this.message.push(c)}),a.setOncompleteCallback((c,_)=>{c.length>0?(this.startQuestion=c[0].num,this.myControl.setValue(this.startQuestion),this.labelHolderSize.width=2*_[0].canvas.width,this.rootQuestionInfo=c,this.rootCanvases=_.map(d=>d.canvas),this.rootHeaderPosition={pageIndex:0,top:1,left:c[0].positions[0].left,width:c[0].positions[0].left+c[0].positions[0].width<_[0].canvas.width?c[0].positions[0].width:_[0].canvas.width-c[0].positions[0].left,heigh:c[0].positions[0].top-1},(0,t.X6Q)(),a.showHidden(),this.errorQuestions=this.cropperService.getErrorQtns(c),this.processData()):(this.errAnalyzingPdf=!0,this.isShowLoadingFileExam=!1)}),a.parsePdf(e)}applyEditEvent(e){if(this.questionConfigList=An.cloneDeep(this.questionList),e){this.countClickApplyEdit++,this.rootQuestionInfo=e.listQuestion,this.rootHeaderPosition=e.headerPos,this.processData();for(let n=0;n<this.questionList.length;n++)this.questionList[n].isFixAns=this.questionConfigList[n].isFixAns,this.questionList[n].groupType=this.questionConfigList[n].groupType,this.questionList[n].tempData.point=this.questionConfigList[n].tempData.point,this.questionList[n].tempData.answerType=this.questionConfigList[n].tempData.answerType,this.questionList[n].tempData.answerResult=this.questionConfigList[n].tempData.answerResult,this.questionList[n].tempData.isSelect=this.questionConfigList[n].tempData.isSelect,this.questionList[n].tempData.isShowHelp=this.questionConfigList[n].tempData.isShowHelp,this.questionList[n].tempData.isShowAttach=this.questionConfigList[n].tempData.isShowAttach,this.questionList[n].tempData.questionMedia=this.questionConfigList[n].tempData.questionMedia;this.editting=!1,this.showSuccessSnack("lang_auto_chinh_sua_thanh_cong")}else this.editting=!1}cloneCanvas(){let e=this.rootCanvases;for(let n=0;n<e.length;n++){const i=e[n];let a=document.createElement("canvas");a.width=i.width,a.height=i.height;let r=document.createElement("canvas");r.width=i.width,r.height=i.height;let l=a.getContext("2d");null==l||l.drawImage(i,0,0,i.width,i.height,0,0,i.width,i.height);let c=r.getContext("2d");null==c||c.drawImage(i,0,0,i.width,i.height,0,0,i.width,i.height),l&&c&&this.clonedCtxForCreate.push(c)}}processData(){this.questionList=[],this.abcdLabelPos={},this.groupImages={},this.totalInGroupTracking=0,this.questionLabelMap=[],this.groupLengths=[],this.countGroup=0,this.labelsUrls=[],this.labelsBase64s=[],this.firstInGroupIndexes=[],this.clonedCtxForCreate=[],this.cloneCanvas();const e=this.clonedCtxForCreate[0].canvas.width;this.rootQuestionInfo.forEach(P=>{P.positions.forEach(R=>{R.width+R.left>e&&(R.width=e-R.left)})});let n=this.rootQuestionInfo,i=this.clonedCtxForCreate;n.forEach(P=>{P.remove.heigh=Math.round(P.remove.heigh),P.remove.width=Math.round(P.remove.width),P.remove.top=Math.round(P.remove.top),P.remove.left=Math.round(P.remove.left),P.positions.forEach(R=>{R.heigh=Math.round(R.heigh),R.width=Math.round(R.width),R.top=Math.round(R.top),R.left=Math.round(R.left)}),P.help&&(P.help.remove&&(P.help.remove.heigh=Math.round(P.help.remove.heigh),P.help.remove.width=Math.round(P.help.remove.width),P.help.remove.left=Math.round(P.help.remove.left),P.help.remove.top=Math.round(P.help.remove.top)),P.help.positions.forEach(R=>{R.heigh=Math.round(R.heigh),R.width=Math.round(R.width),R.top=Math.round(R.top),R.left=Math.round(R.left)})),P.answers.length>0&&P.answers.forEach(R=>{R.remove.heigh=Math.round(R.remove.heigh),R.remove.width=Math.round(R.remove.width),R.remove.top=Math.round(R.remove.top),R.remove.left=Math.round(R.remove.left),R.positions.forEach(N=>{N.heigh=Math.round(N.heigh),N.width=Math.round(N.width),N.top=Math.round(N.top),N.left=Math.round(N.left)})})});let a=document.createElement("canvas");a.width=this.labelHolderSize.width,a.height=this.labelHolderSize.height;let r=a.getContext("2d"),l=0,c=r;const _=()=>{r&&(this.labelsBase64s[l]=r.canvas.toDataURL("image/png"),l++,r.clearRect(0,0,r.canvas.width,r.canvas.height)),m.left=0,m.top=0};let d=0,m={left:0,top:0,locate:0};const p=P=>{m.left=0,m.top+=P};let w=[];const C=P=>{let R=!0;for(let N=0;N<P.length;N++)if(1==P[N].remove.width||1==P[N].remove.heigh){R=!1;break}return R};n.forEach(P=>{w.push(P.answers.length)});for(let P=0;P<n.length;P++)if(C(n[P].answers)&&n[P].answers.length==Math.max(...w)){n[P].answers.forEach(R=>{null==c||c.drawImage(i[R.remove.pageIndex].canvas,R.remove.left,R.remove.top,R.remove.width,R.remove.heigh,m.left,m.top,R.remove.width,R.remove.heigh),this.abcdLabelPos[R.label]={left:m.left,top:m.top},m.left=m.left+R.remove.width+5});break}this.examHeader=this.cropperService.getSingleImgData(this.rootHeaderPosition,i);for(let P=0;P<n.length;P++){let R={isFixAns:n[P].isFixAns?1:0,forcedFixAns:!!n[P].isFixAns,groupType:0,original:"",debugView:"",group:n[P].group,groupUrl:this.groupImages[`image_group_${n[P].group}`]?this.groupImages[`image_group_${n[P].group}`]:"",question:{label:n[P].num,posit:{top:0,left:0,locate:0},url:"",urlExcludeLabelOnly:"",width:1,height:1,remove:{x:1,y:1,width:1,height:1,url:this.cropperService.getSingleImgData(n[P].remove,i),left:0,top:0}},answers:[],help:{num:n[P].num,url:""},tempData:{sort:P,point:0,answerType:1,answerConfig:{},answerResult:[],isShowAttach:!1,questionMedia:[],isSelect:!0,isShowHelp:!1},rootIndex:P},N=n[P].positions;if(R.original=this.cropperService.getScatteredImgData(N,i),n[P].isGroup){this.groupLengths.push(this.totalInGroupTracking),this.totalInGroupTracking=0,this.countGroup++,R.isGroup=!0;var A=this.cropperService.getScatteredImgData(n[P].positions,i);this.groupImages[`image_group_${n[P].num}`]=A}else{d++,this.totalInGroupTracking++,c&&0!=d&&m.left+n[P].remove.width>c.canvas.width?(m.left=0,m.top=m.top+this.maxQuestionLabelHeight+5,this.maxQuestionLabelHeight=0,c&&m.top+n[P].remove.heigh>c.canvas.height&&_(),null==c||c.drawImage(i[n[P].remove.pageIndex].canvas,n[P].remove.left,n[P].remove.top,n[P].remove.width,n[P].remove.heigh,m.left,m.top,n[P].remove.width,n[P].remove.heigh),R.question.remove.left=m.left,R.question.remove.top=m.top,this.questionLabelMap.push({locate:l,left:m.left,top:m.top,width:n[P].remove.width,height:n[P].remove.heigh}),m.left=m.left+n[P].remove.width+5):(c&&m.top+n[P].remove.heigh>c.canvas.height&&_(),null==c||c.drawImage(i[n[P].remove.pageIndex].canvas,n[P].remove.left,n[P].remove.top,n[P].remove.width,n[P].remove.heigh,m.left,m.top,n[P].remove.width,n[P].remove.heigh),R.question.remove.left=m.left,R.question.remove.top=m.top,this.questionLabelMap.push({locate:l,left:m.left,top:m.top,width:n[P].remove.width,height:n[P].remove.heigh}),m.left=m.left+n[P].remove.width+5,n[P].remove.heigh>this.maxQuestionLabelHeight&&(this.maxQuestionLabelHeight=n[P].remove.heigh)),this.cropperService.fillColor("#ffffff",i[n[P].remove.pageIndex],n[P].remove.left,n[P].remove.top,n[P].remove.width,n[P].remove.heigh),R.question.urlExcludeLabelOnly=1==N.length?this.cropperService.getSingleImgData(N[0],i):this.cropperService.getScatteredImgData(N,i),R.question.remove.x=n[P].remove.left-N[0].left,R.question.remove.y=n[P].remove.top-N[0].top,R.question.remove.width=n[P].remove.width,R.question.remove.height=n[P].remove.heigh,n[P].answers.length>0?n[P].answers.forEach(z=>{let X={label:z.label,posit:{left:0,top:0,locate:0},url:"",x:z.positions[0].left-N[0].left,y:z.positions[0].top-N[0].top,width:1,height:1,remove:{x:z.remove.left-N[0].left,y:z.remove.top-N[0].top,xAns:z.remove.left-z.positions[0].left,yAns:z.remove.top-z.positions[0].top,width:z.remove.width,height:z.remove.heigh,url:this.cropperService.getSingleImgData(z.remove,i),left:0,top:0}};if(N.length>1&&N[0].pageIndex!==z.remove.pageIndex&&(X.remove.y=z.remove.top-N[1].top+N[0].heigh),this.cropperService.fillColor("#ffffff",i[z.remove.pageIndex],z.remove.left,z.remove.top,z.remove.width,z.remove.heigh),N.length>1)for(let V=0;V<N.length;V++)if(N[V].pageIndex==z.positions[0].pageIndex){X.y=0==V?z.positions[0].top-N[V].top:z.positions[0].top-N[V].top+N[0].heigh;break}if(z.isCorrect&&(R.tempData.answerResult=[z.label]),1==z.positions.length)X.url=this.cropperService.getSingleImgData(z.positions[0],i),X.width=z.positions[0].width,X.height=z.positions[0].heigh;else{X.url=this.cropperService.getScatteredImgData(z.positions,i);let V=z.positions.filter(J=>!J.inactive);X.width=this.cropperService.maxWidthTo(V.length,z.positions),X.height=this.cropperService.sumHighTo(V.length,z.positions)}R.answers.push(X),z.positions.forEach(V=>{this.cropperService.fillColor("#ffffff",i[V.pageIndex],V.left,V.top,V.width,V.heigh)})}):n[P].strAns&&void 0!==n[P].strAns?(R.tempData.answerType=4,R.tempData.answerResult.push(n[P].strAns||"")):R.tempData.answerType=3;let B=n[P].help;if(B&&(B.remove&&this.cropperService.fillColor("#ffffff",i[B.remove.pageIndex],B.remove.left,B.remove.top,B.remove.width,B.remove.heigh),B.positions&&B.positions.length>0&&(R.help.url=this.cropperService.getScatteredImgData(B.positions,i))),1==N.length)R.question.url=this.cropperService.getSingleImgData(N[0],i),R.question.width=N[0].width,R.question.height=N[0].heigh;else{R.question.url=this.cropperService.getScatteredImgData(N,i);let z=N.filter(X=>!X.inactive);R.question.width=this.cropperService.maxWidthTo(z.length,N),R.question.height=this.cropperService.sumHighTo(z.length,N)}this.questionList.push(R)}}for(let P=0;P<this.questionList.length;P++)this.questionList[P].tempData.point=this.totalNumberQuestion?Number(this.totalPoint.value/this.totalNumberQuestion):0,this.questionList[P].index=P;let M=0;for(let P=0;P<this.groupLengths.length;P++)this.firstInGroupIndexes.push(M+this.groupLengths[P]),M+=this.groupLengths[P];const D=()=>{let P=0,R=[];for(let N=0;N<this.questionList.length;N++)if(this.questionList[N].answers.length>0)for(let B=0;B<this.questionList[N].answers.length;B++){let z=new Image;z.crossOrigin="anonymous",z.setAttribute("indexMap",N.toString()),z.setAttribute("ansIndexMap",B.toString()),R.push(z),z.onload=()=>{if(P++,P==R.length){let X=[],V=[],J=0;for(let et=0;et<R.length;et++){const ot=R[et];J+=ot.width+5,J<=this.labelHolderSize.width?V.push(ot):(X.push(V),V=[],V.push(ot),J=ot.width),et==R.length-1&&X.push(V)}for(let et=0;et<X.length;et++){const ot=X[et];let ut=ot.map(rt=>rt.height),lt=Math.max(...ut);for(let rt=0;rt<ot.length;rt++){const xt=ot[rt];c&&m.top+xt.height>(null==c?void 0:c.canvas.height)&&_(),null==c||c.drawImage(xt,m.left,m.top);let ht=parseInt(null==xt?void 0:xt.getAttribute("indexMap")),gt=parseInt(null==xt?void 0:xt.getAttribute("ansIndexMap"));this.questionList[ht].answers[gt].posit.left=m.left,this.questionList[ht].answers[gt].posit.top=m.top,this.questionList[ht].answers[gt].posit.locate=l,m.left+=xt.width+5,rt==ot.length-1&&et==X.length-1&&(this.labelsBase64s[l]=null==r?void 0:r.canvas.toDataURL("image/png"))}p(lt+5)}}},z.src=this.questionList[N].answers[B].url}};let q=this.questionList.filter(P=>!this.answerTypeService.isOneChoiceAnswer(P.tempData.answerType)).length;m.left=0,m.top+=this.questionList[this.questionList.length-1].question.remove.height+5;let U=[];for(let P=0;P<this.questionList.length;P++)U.push(P);let F=[];F=An.shuffle(U);let tt=0,W=[];F.forEach(P=>{let R=new Image;R.crossOrigin="anonymous",R.setAttribute("indexMap",P.toString()),W.push(R),R.onload=()=>{if(tt++,tt==F.length){let N=An.chunk(W,2);for(let B=0;B<N.length;B++){const z=N[B];let X=z.map(J=>J.height),V=Math.max(...X);for(let J=0;J<z.length;J++){const et=z[J];c&&m.top+et.height>(null==c?void 0:c.canvas.height)&&_(),null==c||c.drawImage(et,m.left,m.top);let ot=parseInt(null==et?void 0:et.getAttribute("indexMap"));this.questionList[ot].question.posit.left=m.left,this.questionList[ot].question.posit.top=m.top,this.questionList[ot].question.posit.locate=l,m.left+=et.width+5}p(V+5)}q==this.questionList.length?this.labelsBase64s[l]=null==r?void 0:r.canvas.toDataURL("image/png"):D()}},R.src=this.questionList[P].question.url}),this.completeCropper()}completeCropper(){this.isShowLoadingFileExam=!1,this.cropperDone=!0,jQuery("#hiddenWrapper").remove();try{this.browserStorageService.getStorage("_DONT_SHOW_MANUAL")||setTimeout(()=>{this.openManualDialog(!1)},2e3)}catch(e){console.log(e)}}toggleViewHelp(e){e.tempData.isShowHelp=!e.tempData.isShowHelp}toogleMixAns(e){e.forcedFixAns?this.commonService.snackError("lang_auto_cau_hoi_nay_phai_co_dinh_dap_an_ban_khong_the_thay_doi"):e.isFixAns=0==e.isFixAns?1:0}toggleMixInGroup(e){for(let n=0;n<this.questionList.length;n++)this.questionList[n].group&&this.questionList[n].group==e&&(1==this.questionList[n].groupType?(this.questionList[n].groupType=0,this.showErrorSnack("lang_auto_nhung_cau_trong_nhom_nay_se_bi_dao_thu_tu_khi_de_thi_bi_dao")):(this.questionList[n].groupType=1,this.showErrorSnack("lang_auto_nhung_cau_trong_nhom_nay_van_giu_nguyen_thu_tukhi_de_thi_bi_dao")))}toggleRemoveAllGroup(e){let n=this.questionList.filter(i=>i.group&&i.group==e);n.filter(i=>i.tempData.isSelect).length>0?n.forEach(i=>{var a;i.tempData.isSelect=!1,this.changePointWhenDeleteQuestion(null!==(a=i.index)&&void 0!==a?a:0)}):n.forEach(i=>{var a;i.tempData.isSelect=!0,this.changePointWhenDeleteQuestion(null!==(a=i.index)&&void 0!==a?a:0)})}loadingFileJs(){let e=this.commonService.myTranslateIntance("lang_auto_dang_khoi_tao_cong_cu");this.arrStatusFileExam=[`${e} ...`],this.isShowLoadingFileExam=!0;let n=this.configService.getConfig("dynamicJsVersion");return new Promise(i=>{var a=[{source:this.cdnService.convertLinkCdn(`azota_assets/js/pdf-js-v3/pdf.js?ver=${n}`),name:"pdf-js-v2-pdf.js"},{source:this.cdnService.convertLinkCdn(`azota_assets/js/pdf-js-v3/pdf.worker.js?ver=${n}`),name:"pdf-js-v2-pdf.worker.js"},{source:"https://cdnjs.cloudflare.com/ajax/libs/interact.js/1.10.11/interact.min.js",name:"interact.min.js"}];this.commonService.loadScriptPromises(a).then(r=>{r?(i(!0),this.isShowLoadingFileExam=!1):i(!1)})})}setHeightFullScreen(){var a=jQuery(window).height()-(jQuery("#bxControl").height()+jQuery("#header-app-component").height()+10);jQuery(".box-file-content").height(a)}resetBoxExamQuestions(e){var n,i;let a=null!==(n=this.commonService.myTranslateIntance("lang_auto_xac_nhan_tao_lai_de_thi"))&&void 0!==n?n:"",r=null!==(i=this.commonService.myTranslateIntance("lang_auto_hanh_dong_khong_the_hoan_tac"))&&void 0!==i?i:"";this.confirmDialog(a,r,"400px",()=>{this.commonService.myNavigation("/admin/testbank/create-new-document/"+this.cur_cateId)})}confirmDialog(e,n,i,a){this.dialog.open(_i.D,{width:i,data:{title:e,msg:n}}).afterClosed().subscribe(l=>{!0===l&&a()})}handleSaveQuestionError(e){console.log(e),this.isShowLoadingFileExam=!1,this.showErrorSnack("lang_auto_tao_de_khong_thanh_cong_vui_long_thu_lai")}showAllHelp(){this.isShowAllHelp=!this.isShowAllHelp,this.questionList.forEach(e=>{e.tempData.isShowHelp=this.isShowAllHelp})}goToQuestionAll(e,n=150){var i=document.getElementById("box-questions-item-"+e),a=document.getElementById("box-questions-viewer");a&&i&&a.scrollTo({top:Number(i.offsetTop-n)})}rxjsHandleSaveExam(){this.isShowLoadingFileExam=!0;let n,e=this.commonService.myTranslateIntance("lang_auto_dang_luu_cau_hoi_vao_he_thong");if(this.selects=this.questionList.filter(r=>r.tempData.isSelect),this.arrStatusFileExam=[`${e}: 0/${this.selects.length}`],!An.isEmpty(this.groupImages)){let r={};for(const l in this.groupImages)r[l]=this.apiUploadService.reactiveUploadBase64ToCDN(Yn,this.groupImages[l]);n=(0,Hl.D)(r)}const i=()=>{this.rxjsConstructQuestionInfo()},a=()=>{this.uploadParallelLabelsImage(0,5,r=>{r.success?(this.labelsUrls=r.urls,n?n.subscribe(l=>{var c,_,d="",m={};for(var p in l){var w=l[p];1==w.success?m[p]=null!==(c=w.data)&&void 0!==c?c:"":d=null!==(_=w.message)&&void 0!==_?_:"Unkown error"}""==d?(this.groupImages=m,i()):this.handleSaveQuestionError(d)}):i()):this.handleSaveQuestionError(r.message)})};this.useHeader&&this.examHeader?this.apiUploadService.reactiveUploadBase64ToCDN(Yn,this.examHeader).subscribe(r=>{var l;1==r.success?(this.examHeader=null!==(l=r.data)&&void 0!==l?l:"",a()):this.handleSaveQuestionError(r.message)}):(this.examHeader="",a())}rxjsConstructQuestionInfo(){this.rxJsCallSaveParallelQuestion(0,5,this.selects,e=>{e&&this.rxJsCallApiSaveQuestions(n=>{n&&this.handleSaveAllExam()})})}rxJsCallApiSaveQuestions(e){if(this.newQuestionArrSave.length<=this.limitLazyLoad){var n={listQuestions:this.newQuestionArrSave.sort((i,a)=>i.sortByIndex-a.sortByIndex)};this.questionService.apiQuestionSaveObjsV2Post(n).subscribe(i=>{var a,r,l,c,_;1==i.success&&(null!==(l=null===(r=null===(a=i.data)||void 0===a?void 0:a.objs)||void 0===r?void 0:r.length)&&void 0!==l?l:0)>0?(null===(_=null===(c=i.data)||void 0===c?void 0:c.objs)||void 0===_||_.forEach((d,m)=>{this.examConfigs.push({id:d.id,name:d.name,groupId:d.groupId,scorePerQuestion:this.selects[m].tempData.point,totalQuestion:1,sort:m})}),e(!0)):(this.handleSaveQuestionError(i.message),e(!1))})}else this.saveVeryLongListQuestions(this.newQuestionArrSave,e)}saveVeryLongListQuestions(e,n){var i,a,r,l,c;return(0,Oe.mG)(this,void 0,void 0,function*(){this.newQuestionArrSave.sort((m,p)=>m.sortByIndex-p.sortByIndex);var _=An.chunk(this.newQuestionArrSave,Ie);let d=0;try{for(const m of _){let p=yield this.questionService.apiQuestionSaveObjsV2Post({listQuestions:m}).toPromise();if(!(1==p.success&&(null!==(r=null===(a=null===(i=p.data)||void 0===i?void 0:i.objs)||void 0===a?void 0:a.length)&&void 0!==r?r:0)>0))throw p.message;null===(c=null===(l=p.data)||void 0===l?void 0:l.objs)||void 0===c||c.forEach((w,C)=>{let A=Ie*d+C;this.examConfigs.push({id:w.id,name:w.name,groupId:w.groupId,scorePerQuestion:this.selects[A].tempData.point,totalQuestion:1,sort:A})}),d++}n(!0)}catch(m){this.handleSaveQuestionError(m),n(!1)}})}rxJsCallSaveParallelQuestion(e,n,i,a){for(var r=0,l=0,c=0;c<n;c++){var _=e+c;_<i.length&&(r+=1,this.rxjsProcessSaveOneQuestion(i[_],_,m=>{m?(l+=1)>=r&&this.rxJsCallSaveParallelQuestion(e+r,n,i,a):a(!1)}))}r<=0&&a(!0)}uploadParallelLabelsImage(e,n,i){for(var a=0,r=0,l=0;l<n;l++){var c=e+l;c<this.labelsBase64s.length&&(a+=1,this.uploadOneLabelsImage(this.labelsBase64s[c],c,d=>{d.success?(this.resultUploadBase64Labels.push({index:d.index,url:d.url}),(r+=1)>=a&&this.uploadParallelLabelsImage(e+a,n,i)):i({success:!1,message:"Fail to upload labels image to cdn"})}))}a<=0&&(this.resultUploadBase64Labels.sort((d,m)=>d.index-m.index),i({success:!0,urls:this.resultUploadBase64Labels.map(d=>d.url)}))}uploadOneLabelsImage(e,n,i){this.apiUploadService.reactiveUploadBase64ToCDN(Yn,null!=e?e:"").subscribe(a=>{var r;i(a.success?{success:!0,index:n,url:null!==(r=a.data)&&void 0!==r?r:""}:{success:!1})})}rxjsProcessSaveOneQuestion(e,n,i){let a=e;this.apiUploadService.reactiveUploadBase64ToCDN(Yn,a.original).subscribe(r=>{var l;1==r.success?(a.original=null!==(l=r.data)&&void 0!==l?l:"",this.apiUploadService.reactiveUploadBase64ToCDN(Yn,a.help.url).subscribe(c=>{var _;if(1==c.success){a.help.url=null!==(_=c.data)&&void 0!==_?_:"";let m=this.answerTypeService.isOneChoiceAnswer(e.tempData.answerType)?e.answers.map(C=>({key:C.label,content:JSON.stringify(Object.assign(Object.assign({},C),{label:null,url:null,x:null,y:null,isCorrect:null,remove:null}))})):e.tempData.answerConfig,p="";e.answers.length>0&&(p=e.answers.map(C=>Object.assign(Object.assign({},C),{url:null,remove:Object.assign(Object.assign({},C.remove),{url:null})})));let w={name:`[PDFv2] C\xe2u h\u1ecfi t\u1ea1o t\u1ef1 \u0111\u1ed9ng ${e.question.label}`,version:"2",isFixAns:e.isFixAns,groupType:e.groupType.toString(),answerConfig:JSON.stringify(m),answerResult:JSON.stringify(e.tempData.answerResult),answerType:e.tempData.answerType,questionText:"",metaData:"",answerMedia:e.help.url,questionMedia:"",attachments:JSON.stringify(e.tempData.questionMedia),questionContent:JSON.stringify(new Array({$id:0,id:0,name:`[PDFv2] C\xe2u h\u1ecfi t\u1ea1o t\u1ef1 \u0111\u1ed9ng ${e.question.label}`,path:e.original,extension:"png",pimes:null,url:e.original,groupUrl:e.group?this.groupImages[`image_group_${e.group}`]:"",firstInGroupIndexes:null,abcdLabelPos:null,questionLabelMap:null,metaData:Object.assign(Object.assign({},e),{question:Object.assign(Object.assign({},e.question),{url:null,urlExcludeLabelOnly:this.answerTypeService.isOneChoiceAnswer(e.tempData.answerType)?null:e.question.urlExcludeLabelOnly,remove:Object.assign(Object.assign({},e.question.remove),{url:null})}),answers:p,tempData:null,original:null,debugView:null,isGroup:null,help:null,group:null,groupUrl:null,groupType:null})})),questionTags:JSON.stringify(new Array),tags:[],categoryId:0,groupId:e.group,coordinates:"{}",totalQuestion:1,sortByIndex:n};var d=this.newQuestionArrSave.filter(C=>C.name==w.name);if(!d||0==d.length){this.newQuestionArrSave.push(w),this.countSaveQuestion++;let C=this.commonService.myTranslateIntance("lang_auto_dang_luu_cau_hoi_vao_he_thong");this.arrStatusFileExam=[`${C}: ${this.countSaveQuestion}/${this.selects.length}`]}i(!0)}else this.handleSaveQuestionError(c.message),i(!1)})):(this.handleSaveQuestionError(r.message),i(!1))})}openDialogSpitPoint(){let e=0,n=0,i=0,a=0;for(let r=0;r<this.questionList.length;r++)this.questionList[r].tempData.isSelect&&(this.answerTypeService.isOneChoiceAnswer(this.questionList[r].tempData.answerType)||this.answerTypeService.isFillAnswer(this.questionList[r].tempData.answerType)?(e++,n+=this.questionList[r].tempData.point):(i++,a+=this.questionList[r].tempData.point));if(this.countTrueFalseQuestion=e,this.dataSpitPoint){let r={multipleQuestion:e,multiplePoint:n.toFixed(2),essayQuestion:i,essayPoint:a.toFixed(2)};this.dataSpitPoint={isShow:!0,obj:r}}}closeDialogSpitPoint(){this.dataSpitPoint&&(this.dataSpitPoint.isShow=!1)}setPointTest(e){var n,i;this.multiplePoint=null!==(n=e.multiplePoint)&&void 0!==n?n:0,this.essayPoint=null!==(i=e.essayPoint)&&void 0!==i?i:0;let a=Number(this.parseNumberFixed(Number(e.multiplePoint)/this.totalNumberQuestion,8)),r=0,l=this.questionList.filter(c=>c.tempData.isSelect).length;l-this.totalNumberQuestion>0&&(r=Number(e.essayPoint)/(l-this.totalNumberQuestion));for(let c=0;c<this.questionList.length;c++)this.questionList[c].tempData.isSelect&&(this.questionList[c].tempData.point=this.answerTypeService.isOneChoiceAnswer(this.questionList[c].tempData.answerType)||this.answerTypeService.isFillAnswer(this.questionList[c].tempData.answerType)?a.toString().length>8?Number(this.parseNumberFixed(a,8)):a:r.toString().length>8?Number(this.parseNumberFixed(r,8)):r);this.dataSpitPoint&&(this.dataSpitPoint.isShow=!1),this.showSuccessSnack("lang_auto_chia_diem_thanh_cong")}parseNumberFixed(e,n){let i=Number(parseFloat(e.toString()).toFixed(n));return isNaN(i)?"0":parseFloat(e.toString()).toFixed(n)}changeSelectTempData(e){this.questionList[e].tempData.isSelect=!this.questionList[e].tempData.isSelect,this.changePointWhenDeleteQuestion(e)}changePointWhenDeleteQuestion(e){let n=Number(this.multiplePoint)/this.totalNumberQuestion,i=0,a=this.questionList.filter(r=>r.tempData.isSelect).length;0==this.essayPoint&&(this.essayPoint=(a-this.totalNumberQuestion)*this.questionList[e].tempData.point),a-this.totalNumberQuestion>0&&(i=Number(this.essayPoint)/(a-this.totalNumberQuestion));for(let r=0;r<this.questionList.length;r++)this.questionList[r].tempData.isSelect&&(this.questionList[r].tempData.point=this.answerTypeService.isOneChoiceAnswer(this.questionList[r].tempData.answerType)||this.answerTypeService.isFillAnswer(this.questionList[r].tempData.answerType)?n.toString().length>8?Number(this.parseNumberFixed(n,8)):n:i.toString().length>8?Number(this.parseNumberFixed(i,8)):i)}openExamInfoDialog(){this.dataExamInfo={isShow:!0,obj:this.questionList}}closeDialogExamInfo(){this.dataExamInfo.isShow=!1}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(zl),t.Y36(vt.v),t.Y36(x.gz),t.Y36(j.uw),t.Y36(Ot.aE),t.Y36(Mn.$),t.Y36(ai.K),t.Y36(Yl.C),t.Y36(Ot.Oe),t.Y36(Gl.E),t.Y36(Ke.U),t.Y36(nn.T),t.Y36(To.V),t.Y36(bn),t.Y36(Be.z))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-cropper"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Cc,5),t.Gf(Ac,5),t.Gf(yc,5),t.Gf(kc,5),t.Gf(Oc,5),t.Gf(Sc,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.hiddenInput=i.first),t.iGM(i=t.CRH())&&(n.iframePdf=i.first),t.iGM(i=t.CRH())&&(n.resizeBar=i.first),t.iGM(i=t.CRH())&&(n.boxLeftFile=i.first),t.iGM(i=t.CRH())&&(n.parentResize=i.first),t.iGM(i=t.CRH())&&(n.maskLayer=i.first)}},features:[t.qOj],decls:5,vars:4,consts:[["browserSupported",""],["class","alert alert-danger alert-danger-note p-5","style","font-size: 18px",4,"ngIf","ngIfElse"],[3,"data","closeDialog","setPoint",4,"ngIf"],[4,"ngIf"],[3,"hidden"],[3,"headerBackTolink","showInput","showConfirmButton","examName","handleConfirm","handleCancel"],["id","box-create-action"],[1,"container-fluid","mt-3"],[1,"flex","w-full"],["parentResize",""],["id","box-left-file",3,"ngStyle"],["boxLeftFile",""],["id","box-left-file-input","type","file","accept","application/pdf",1,"azt-hidden"],["class","flex justify-between items-center dt-header",4,"ngIf"],["class","p-2 mt-2 mb-2 text-center alert alert-info",4,"ngIf"],["class","p-2 mt-2 mb-2 alert alert-danger text-center alert-danger-note",4,"ngIf"],[1,"box-file-content"],["id","box-left-file-drop","class","box-file-content-file_drop",4,"ngIf"],["id","box-left-file-pdf",1,"box-file-content--viewer",2,"display","none"],["id","box-left-file-canvas",1,"box-file-content--viewer",2,"display","none"],["class","box-questions","id","box-questions-viewer","style","width: 100%",4,"ngIf"],["style","width: 100%","class","m-3 pt-5 p-3 alert text-center alert-danger",4,"ngIf"],["id","resizeBar",3,"mousedown"],["resizeBar",""],["id","iframePdf",3,"hidden"],["iframePdf",""],[1,"maskLayer"],["maskLayer",""],["frameBorder","0","scrolling","auto","height","100%","width","100%",3,"src"],["class","box-file-content-file_preview--blur_status","style","\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100vh;\n            background: #2632386b;\n            color: white;\n            z-index: 999;\n          ",4,"ngIf"],[3,"ngIf"],[1,"flex","justify-between","items-center","dt-header"],[1,"box-control"],["color","primary",1,"example-margin",3,"matTooltip","color","formControl"],["class","pagination",4,"ngIf"],[1,"btnTotal",3,"click"],[1,"flex"],["class","clickable",3,"matTooltip","click",4,"ngIf"],[1,"clickable","ml-3",3,"matTooltip","click"],[1,"flex","justify-between","items-center"],[1,"form-enter-question","ml-1"],["id","inputQuestionNum","type","number",2,"padding","0",3,"formControl","matAutocomplete","keyup.enter"],["id","cropperFilterQuestion"],["auto","matAutocomplete"],[3,"value","click",4,"ngFor","ngForOf"],["type","hidden"],["hiddenInput",""],["id","btnEdits","mat-raised-button","",3,"click"],[1,"pagination"],["type","number","name","inputPage","id","",3,"ngModel","keyup.enter","ngModelChange"],[1,"clickable",3,"ngStyle","matTooltip","click"],[1,"clickable",3,"matTooltip","click"],[3,"value","click"],[1,"p-2","mt-2","mb-2","text-center","alert","alert-info"],[2,"vertical-align","bottom"],[1,"error-block"],[4,"ngFor","ngForOf"],[1,"text-right","mt-1"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"p-2","mt-2","mb-2","alert","alert-danger","text-center","alert-danger-note"],[1,"clickable","mt-1",3,"matTooltip","click"],["class","mt-1",4,"ngIf"],[1,"mt-1"],["id","box-left-file-drop",1,"box-file-content-file_drop"],[1,"box-file-content-file_drop--input"],[1,"box-file-content-file_drop--input-icon"],["target","_self",2,"color","#5c5c5c",3,"href","download","click"],["target","_self",3,"href","download","click"],["id","box-questions-viewer",1,"box-questions",2,"width","100%"],["id","examHeader","class","mb-4","style","padding: 15px; padding-top: 0",4,"ngIf"],["class","box-questions-item",4,"ngFor","ngForOf"],["class","pagination mb-5",4,"ngIf"],["id","examHeader",1,"mb-4",2,"padding","15px","padding-top","0"],["class","remove-layer",4,"ngIf"],[1,"clear-icon",3,"matTooltip","click"],["alt","",2,"width","100%",3,"src"],[1,"remove-layer"],[1,"box-questions-item"],["class","w-100 question-wrapper",4,"ngIf"],[1,"w-100","question-wrapper"],["class","alert alert-danger alert-danger-note","style","margin-bottom: -2px",4,"ngIf"],["class","box-questions-item__img group pt-4 mb-2",3,"hidden",4,"ngIf"],[1,"box-questions-item__img"],["class","cr-question-pieces",4,"ngIf"],[1,"box-questions-item__control"],[1,"box-questions-item__control_flex","position-relative","bg-slate-300","dark:bg-darkmode-400",3,"ngClass"],[1,"flex","items-center"],[2,"font-size","16px","margin-right","10px"],[1,"form-select","form-select-sm",2,"width","110px",3,"change"],[3,"value","selected"],["class","text-center flex items-center",4,"ngIf"],["class","text-center",4,"ngIf"],[2,"font-size","16px"],["appReplaceCommas","","type","text",1,"form-control","inp",3,"value","input"],[1,"attch-icon","clickable","flex",3,"click"],[1,"box-file-content-file_drop--input-icon",3,"matTooltip"],[1,"clickable","flex",3,"click"],["class","box-file-content-file_drop--input-icon",3,"matTooltip",4,"ngIf"],["style","margin-top: -5px; margin-bottom: 5px; border-radius: 5px",4,"ngIf"],[1,"alert","alert-danger","alert-danger-note",2,"margin-bottom","-2px"],[1,"box-questions-item__img","group","pt-4","mb-2",3,"hidden"],["class","clear-icon",3,"matTooltip","click",4,"ngIf"],[3,"click"],["class","mixInGroup",3,"matTooltip",4,"ngIf"],["class","mixInGroupNotif",4,"ngIf"],["loading","lazy","clickable","","alt","",3,"matTooltip","src"],[1,"mixInGroup",3,"matTooltip"],[1,"mixInGroupNotif"],[1,"cr-question-pieces"],[1,"cr-question-label","mb-2"],["loading","lazy","alt","",3,"ngStyle","src"],[1,"cr-question","mb-2"],["loading","lazy","alt","",2,"width","100%","height","auto",3,"width","height","src"],[1,"cr-answers"],["class","cr-aswr",4,"ngFor","ngForOf"],[1,"cr-aswr"],[1,"mb-2"],["loading","lazy","alt","",2,"margin-right","10px","margin-bottom","5px",3,"ngStyle","src"],[1,"text-center","flex","items-center"],["class","btn btn-ans",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"btn","btn-ans",3,"ngClass","click"],[1,"text-center"],[1,"btnAttQuestion",3,"click"],["class","box p-2 mt-2",4,"ngIf"],["class","alert alert-danger alert-danger-note",4,"ngIf"],[1,"box","p-2","mt-2"],[1,"alert","alert-danger","alert-danger-note"],["href","https://docs.azota.vn/docs/trung-tam-tro-giup/tao-de-thi/tao-de-thi-khi-cau-hoi-khong-co-dap-an-de-chon/","target","_blank"],["style","margin-bottom: 50px; opacity: 0.8","class","box-questions-item__img_result",4,"ngIf","ngIfElse"],["noHelp",""],[1,"box-questions-item__img_result",2,"margin-bottom","50px","opacity","0.8"],[3,"src"],[2,"color","rgb(219, 219, 219)","padding","8px 20px"],[2,"margin-top","-5px","margin-bottom","5px","border-radius","5px"],["type","file","name","",1,"azt-hidden",3,"id","change"],["class","dropFileAttachQuestion",3,"click",4,"ngIf"],["class","dropFileAttachQuestion bg-white",4,"ngIf"],[1,"dropFileAttachQuestion",3,"click"],[1,"dropFileAttachQuestion","bg-white"],["class","preview",4,"ngFor","ngForOf"],[1,"preview"],["controls",""],["type","audio/mpeg",3,"src"],[2,"margin-left","10px","background","#f06292","color","white","padding","0 10px","border-radius","5px","font-size","10px",3,"click"],[1,"pagination","mb-5"],[1,"m-3","pt-5","p-3","alert","text-center","alert-danger",2,"width","100%"],[2,"font-size","50px","width","50px","height","50px"],[1,"btn","btn-primary",3,"click"],[1,"box-file-content-file_preview--blur_status",2,"position","fixed","top","0","left","0","width","100%","height","100vh","background","#2632386b","color","white","z-index","999"],[1,"text-center","box-file-content-file_preview--blur_status-frame"],[2,"display","flex","justify-content","center","margin-top","5rem"],["color","accent",3,"strokeWidth","diameter"],["class","span-status","style","font-size: 20px; margin-top: 30px;",4,"ngFor","ngForOf"],[1,"span-status",2,"font-size","20px","margin-top","30px"],[2,"background","#607d8b","padding","10px","border-radius","5px"],[1,"content","relative",2,"border-radius","0"],[3,"listQuestion","headerPosition","listCanvas","applyEdit"],[1,"alert","alert-danger","alert-danger-note","p-5",2,"font-size","18px"],[3,"data","closeDialog","setPoint"],[3,"startIndexQuestion","data","type","closeDialog"]],template:function(e,n){if(1&e&&(t.YNc(0,P_,29,21,"ng-template",null,0,t.W1O),t.YNc(2,L_,3,3,"div",1),t.YNc(3,N_,1,1,"azt-split-point",2),t.YNc(4,D_,2,3,"div",3)),2&e){const i=t.MAs(1);t.xp6(2),t.Q6J("ngIf",!n.isSupportedBrowser)("ngIfElse",i),t.xp6(1),t.Q6J("ngIf",null==n.dataSpitPoint?null:n.dataSpitPoint.isShow),t.xp6(1),t.Q6J("ngIf",n.dataExamInfo.isShow)}},dependencies:[O.mk,O.sg,O.O5,O.PC,ui.XC,ui.ZL,wn.ey,tn.lW,Co.oG,ge.Hw,Qi.Ou,Wt.gM,h._Y,h.YN,h.Kr,h.Fj,h.wV,h.JJ,h.JL,h.On,h.F,h.oH,$l,Ao,yo,Ui,Tc,O.Ov,at.bT,at.GT,at.yl,at.BI,at.DC,at.Tf,at.UG],styles:[".span-status[_ngcontent-%COMP%]{font-size:18px;color:#fff}.box-file-content-file_preview--blur_status[_ngcontent-%COMP%]{left:0;position:absolute;top:0;width:100%;background:rgba(0,0,0,.5882352941);height:100%;padding-top:20%}mat-icon.clear-icon[_ngcontent-%COMP%]{font-size:15px;color:#999;position:absolute;right:5px;z-index:10;top:5px;height:unset;width:unset}mat-icon.clear-icon[_ngcontent-%COMP%]:hover{cursor:pointer}.remove-layer[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;top:0;left:0;z-index:8;background-color:#000000d1;display:flex;justify-content:center;align-items:center;color:#fff;font-size:1em}@keyframes animatefadeIn{0%{top:0;opacity:0}to{top:0;opacity:1}}#examHeader[_ngcontent-%COMP%]{background:#fff;border-radius:7px;overflow:hidden;position:relative}#box-create-action[_ngcontent-%COMP%]   .box-file[_ngcontent-%COMP%]   .box-control[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:45px;margin-top:-15px}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]{background:inherit;box-shadow:none;height:calc(100vh - 110px);display:flex}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_drop[_ngcontent-%COMP%]{cursor:pointer;width:100%;display:flex;justify-content:center;align-items:center;color:#5c5c5c}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_drop--input[_ngcontent-%COMP%]{text-align:center}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .is-dragover[_ngcontent-%COMP%]{background:#e4e4e4!important}#box-create-action[_ngcontent-%COMP%]   .box-file-content--viewer[_ngcontent-%COMP%]{overflow:auto;position:relative;width:100%}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions[_ngcontent-%COMP%]{overflow-y:scroll;scroll-behavior:smooth;overflow-x:hidden;background:#323639;padding:4px}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item[_ngcontent-%COMP%]{margin-bottom:20px}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__img[_ngcontent-%COMP%]{position:relative;padding:10px;border-radius:5px 5px 0 0;overflow:hidden;background-color:#fff}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__img.group[_ngcontent-%COMP%]{border-radius:5px}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;cursor:default;border:1px solid #c0c0c0}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__img_result[_ngcontent-%COMP%]{padding:5px 0;background:white;border-radius:0 0 5px 5px;border:1px solid #414548}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__img_result[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;cursor:default}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]{display:flex;align-items:center;border-radius:0 0 5px 5px;padding:8px 20px;justify-content:space-between}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .btn-ans[_ngcontent-%COMP%]{background:white;height:25px;width:25px;border-radius:50%;display:inline-block;padding:0!important;margin-left:5px;color:rgb(var(--color-slate-800)/var(--tw-text-opacity))}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .btn-ans-result[_ngcontent-%COMP%]{display:inline-flex!important;color:#fff;background-color:#f39c12}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]{background:red;color:#fff;box-shadow:inset 0 0 58px 8px #00000012}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]{background:#f59c12;color:#fff}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .inp[_ngcontent-%COMP%]{margin-left:10px;width:70px;text-align:center;border:none;height:25px}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]{border:none;height:25px;background-color:#e0e0e0;border-radius:5px;background-position:right 0rem center!important;color:#000;padding:0 5px;padding-right:20px!important;font-size:revert!important}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]:focus-visible{outline:none}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .inp-result[_ngcontent-%COMP%]{margin-left:10px;width:-moz-fit-content;width:fit-content;height:25px;padding:3px 10px;color:#949494;font-size:small}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item[_ngcontent-%COMP%]   .link-merge-image-control[_ngcontent-%COMP%]{margin-bottom:10px;text-align:center;margin-top:-10px}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item[_ngcontent-%COMP%]   .link-merge-image-control[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:pointer}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item[_ngcontent-%COMP%]   .link-merge-image-control[_ngcontent-%COMP%]:hover{color:#f06292}#box-create-action[_ngcontent-%COMP%]   .inp-name-root[_ngcontent-%COMP%]{position:fixed;top:0;width:55%;left:170px;display:flex;justify-content:center;align-items:center;height:45px}#box-create-action[_ngcontent-%COMP%]   .inp-name-root[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-width:1px;border-style:solid;border-radius:5px;border-color:#d6d6d6;font-weight:500;font-size:13px;text-align:center;width:85%;padding:4px}#box-create-action[_ngcontent-%COMP%]   .inp-name-root[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus-visible{outline:none}#box-create-action[_ngcontent-%COMP%]   .btnAttQuestion[_ngcontent-%COMP%]{background:#f59c12;height:25px;display:flex;align-items:center;padding:0 10px;border-radius:3px;cursor:pointer}#box-create-action[_ngcontent-%COMP%]   .dropFileAttachQuestion[_ngcontent-%COMP%]{display:flex;height:88px;background:#ececec;justify-content:center;align-items:center;border-bottom:1px solid #44beb5;cursor:pointer;border-radius:5px 5px 0 0}#box-create-action[_ngcontent-%COMP%]   .dropFileAttachQuestion[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}#box-create-action[_ngcontent-%COMP%]   .dropFileAttachQuestion[_ngcontent-%COMP%]   audio[_ngcontent-%COMP%]{height:40px}#box-create-action[_ngcontent-%COMP%]   .dropFileAttachQuestion[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{height:80px;background:white;padding:5px;display:flex;justify-content:center;align-items:center;border-radius:3px;margin-left:5px}#box-create-action[_ngcontent-%COMP%]   .dropFileAttachQuestion[_ngcontent-%COMP%]   .preview-box[_ngcontent-%COMP%]{text-align:center}.isShowHelp[_ngcontent-%COMP%]{display:block!important}.question-wrapper[_ngcontent-%COMP%]{position:relative}.question-wrapper[_ngcontent-%COMP%]   .ox-questions-item__control-sub[_ngcontent-%COMP%]{position:absolute;top:2px;right:2px;z-index:10;color:#fff!important;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center}.question-wrapper[_ngcontent-%COMP%]   .ox-questions-item__control-sub[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;font-size:15px}.img-group[_ngcontent-%COMP%]{position:relative}.img-group[_ngcontent-%COMP%]   .mixInGroupNotif[_ngcontent-%COMP%]{display:none}.img-group[_ngcontent-%COMP%]:hover   .mixInGroupNotif[_ngcontent-%COMP%]{display:block;background-color:#d63031}.mixInGroup[_ngcontent-%COMP%], .mixInGroupNotif[_ngcontent-%COMP%]{position:absolute;width:80px;height:50px;top:-30px;left:-46px;background-color:#d63031d4;transform:rotate(-45deg);color:#fff;font-size:9px;text-align:center;padding-top:30px}.dt-header[_ngcontent-%COMP%]{background:#323639;color:#fff;padding:12px}#examNameInput[_ngcontent-%COMP%]{position:absolute;width:110%;left:-10%;top:-18px;border:1px solid #e0e0e0;border-radius:3px;padding:0 5px;height:36px}#examSaveBtns[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;position:absolute;z-index:9;width:50%;right:-50%;top:-18px}#examSaveBtns[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]{padding-left:50px;padding-right:50px;background-color:#2361ae}#examSaveBtns[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]:hover{background-color:#1e5395}#examSaveBtns[_ngcontent-%COMP%]   .btn-save.mat-button-disabled[_ngcontent-%COMP%]{background-color:#0000001f}#examSaveBtns[_ngcontent-%COMP%]   .btn-reload[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px}#box-manual[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;position:absolute;z-index:9;width:50%;right:100%;top:-16px}#box-manual[_ngcontent-%COMP%]   #buttonHD[_ngcontent-%COMP%]{color:#2361ae;border:none}.error-block[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center}#btnEdits[_ngcontent-%COMP%]:hover{background-color:#e7e7e7}.pagination[_ngcontent-%COMP%]{min-width:130px;display:flex;align-items:center;justify-content:space-between;max-width:230px;color:#fff}.pagination[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:25px;text-align:center;border:none;background-color:#414548;color:#fff}.pagination.mb-5[_ngcontent-%COMP%]{margin:0 auto}.alert-danger-note[_ngcontent-%COMP%]{display:revert!important;border:1px solid transparent!important;border-radius:.25rem!important;color:#721c24!important;background-color:#f8d7da!important;border-color:#f5c6cb!important}#inputQuestionNum[_ngcontent-%COMP%]{height:22px;width:100%;text-align:center;border:none;margin-left:5px;min-width:30px;max-width:50px;border-radius:3px;color:rgb(var(--color-slate-800)/var(--tw-text-opacity))}#resizeBar[_ngcontent-%COMP%]{width:5px;transition:background-color .5s}#resizeBar[_ngcontent-%COMP%]:hover{background-color:#2262ae;cursor:col-resize}#resizeBar.hover[_ngcontent-%COMP%]{background-color:#2262ae}#iframePdf[_ngcontent-%COMP%]{position:relative;flex:auto}#iframePdf[_ngcontent-%COMP%]   .maskLayer[_ngcontent-%COMP%]{position:absolute;width:0;height:100%;left:0}span.attch-icon[_ngcontent-%COMP%]{position:relative}span.attch-icon[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{position:absolute;bottom:-12px;left:50%;margin-left:-7px;color:#ececec}"]}),o})(),q_=(()=>{class o{constructor(e,n){this.dialogRef=e,this.data=n,this.isNotShowAgain=new h.p4}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(j.so),t.Y36(j.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["user-manual"]],decls:41,vars:32,consts:[[1,"box","p-5"],[2,"min-height","55vh"],[1,"text-center","mb-2"],[1,"font-medium","text-lg"],[1,"mt-2"],[2,"list-style","inherit","margin","inherit","padding","auto"],["src","assets/images/pdf-debug-v2.png","alt","",1,"mb-2",2,"max-width","100%"],[1,"mb-0"],["align","end"],[1,"flex","items-center","w-full",2,"justify-content","space-between"],[1,"form-check"],["id","is-not-show-again","type","checkbox",1,"form-check-input",3,"formControl"],["for","is-not-show-again",1,"form-check-label"],[1,"btn","btn-primary","w-24",3,"mat-dialog-close"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"azt-mat-dialog-content")(2,"div",1)(3,"div",2)(4,"span",3),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()(),t.TgZ(7,"div",4)(8,"p"),t._uU(9),t.ALo(10,"mytranslate"),t.qZA(),t.TgZ(11,"p"),t._uU(12),t.ALo(13,"mytranslate"),t.qZA(),t.TgZ(14,"ul",5)(15,"li"),t._uU(16),t.ALo(17,"mytranslate"),t.qZA(),t.TgZ(18,"li"),t._uU(19),t.ALo(20,"mytranslate"),t.qZA(),t.TgZ(21,"li"),t._uU(22),t.ALo(23,"mytranslate"),t.qZA()(),t._UZ(24,"img",6),t.TgZ(25,"p"),t._uU(26),t.ALo(27,"mytranslate"),t.qZA(),t.TgZ(28,"p",7),t._uU(29),t.ALo(30,"mytranslate"),t.qZA()()()(),t.TgZ(31,"mat-dialog-actions",8)(32,"div",9)(33,"div",10),t._UZ(34,"input",11),t.TgZ(35,"label",12),t._uU(36),t.ALo(37,"mytranslate"),t.qZA()(),t.TgZ(38,"button",13),t._uU(39),t.ALo(40,"mytranslate"),t.qZA()()()()),2&e&&(t.xp6(5),t.hij(" ",t.lcZ(6,12,"lang_testbank_create_exam_width_file_pdf_tutorial_pdf")," "),t.xp6(4),t.hij("",t.lcZ(10,14,"lang_testbank_create_exam_width_file_pdf_note_one"),"."),t.xp6(3),t.hij("",t.lcZ(13,16,"lang_testbank_create_exam_width_file_pdf_note_two"),":"),t.xp6(4),t.Oqu(t.lcZ(17,18,"lang_testbank_create_exam_width_file_pdf_label_question")),t.xp6(3),t.Oqu(t.lcZ(20,20,"lang_testbank_create_exam_width_file_pdf_lable_answer")),t.xp6(3),t.Oqu(t.lcZ(23,22,"lang_testbank_create_exam_width_file_pdf_content_area")),t.xp6(4),t.hij("",t.lcZ(27,24,"lang_testbank_create_exam_width_file_pdf_note_three")," "),t.xp6(3),t.hij("",t.lcZ(30,26,"lang_testbank_create_exam_width_file_pdf_note_four"),"."),t.xp6(5),t.Q6J("formControl",n.isNotShowAgain),t.xp6(2),t.hij(" ",t.lcZ(37,28,"lang_testbank_create_exam_width_file_pdf_not_view")," "),t.xp6(2),t.Q6J("mat-dialog-close",n.isNotShowAgain.value),t.xp6(1),t.Oqu(t.lcZ(40,30,"lang_buttom_close")))},dependencies:[j.ZT,j.H8,h.Wl,h.JJ,h.oH,ko.O,at.bT],encapsulation:2}),o})();const Q_=function(o){return{paddingCustomQuestion:o}};function U_(o,s){if(1&o&&(t.TgZ(0,"div",11)(1,"p",12),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o){const e=t.oxw(2);t.Q6J("ngClass",t.VKq(4,Q_,1==e.form.controls.isCreateSubTest.value&&e.isGroupMixQuestion&&e.examGroupInfos.length>1)),t.xp6(2),t.hij(" ",t.lcZ(3,2,"lang_auto_nhap_so_luong_cau")," ")}}const F_=function(o){return{"is-invalid":o}};function R_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",13)(1,"div",14)(2,"div",15)(3,"div",16)(4,"input",17),t.NdJ("input",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.validWhenChangeLimitMixquestionValue())}),t.qZA()(),t.TgZ(5,"div",18)(6,"button",19),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.changesMixQuestionGroupType())}),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()()()()()}if(2&o){const e=t.oxw(2);t.xp6(4),t.Q6J("ngClass",t.VKq(5,F_,e.formControlLimitMixQuestion.invalid||e.checkValidateCountQuestion)),t.xp6(2),t.Q6J("disabled",e.examGroupInfos.length<=1),t.xp6(1),t.hij(" ",t.lcZ(8,3,"lang_testbank_test_config_get_with_group")," ")}}const Oo=function(o){return{"border-danger":o}};function B_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"input",38),t.NdJ("input",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(3);return t.KtG(a.validateWhenChangeGroupValue(i.controls.groupId))})("focus",function(){t.CHM(e),t.oxw();const i=t.MAs(10);return t.KtG(i.show())})("keydown",function(i){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw(3);return t.KtG(r.triggerCtrlEnter(i,a.controls.groupId))}),t.qZA()}if(2&o){const e=t.oxw().$implicit,n=t.oxw(3);t.Q6J("ngClass",t.VKq(1,Oo,!e.valid||!n.totalTakeQuestion))}}function J_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"input",39),t.NdJ("input",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(3);return t.KtG(a.validateWhenChangeGroupValue(i.controls.groupId))}),t.qZA()}if(2&o){const e=t.oxw().$implicit,n=t.oxw(3);t.Q6J("ngClass",t.VKq(1,Oo,!e.valid||!n.totalTakeQuestion))}}function H_(o,s){1&o&&t._UZ(0,"input",40),2&o&&t.uIk("disabled",!0)}function z_(o,s){if(1&o&&(t.TgZ(0,"div",31),t.ynx(1,1),t.TgZ(2,"p",32),t._uU(3),t.ALo(4,"mytranslate"),t.ALo(5,"mytranslate"),t.qZA(),t.YNc(6,B_,1,3,"input",33),t.YNc(7,J_,1,3,"input",34),t.YNc(8,H_,1,1,"input",35),t.BQk(),t._UZ(9,"div",36,37),t.ALo(11,"mytranslate"),t.qZA()),2&o){const e=s.$implicit,n=s.index;t.xp6(1),t.Q6J("formGroup",e),t.xp6(2),t.HOy(" ",t.lcZ(4,9,"lang_testbank_test_config_group")," ",n+1," (",e.controls.maxQuestion.value," ",t.lcZ(5,11,"lang_testbank_test_config_question"),") "),t.xp6(3),t.Q6J("ngIf",1!=e.controls.isFixed.value),t.xp6(1),t.Q6J("ngIf",1!=e.controls.isFixed.value),t.xp6(1),t.Q6J("ngIf",1==e.controls.isFixed.value),t.xp6(1),t.s9C("matTooltip","Ctrl + Enter "+t.lcZ(11,13,"lang_auto_de_tu_dong_dien_so_luong_cau_cho_cac_nhom_con_lai"))}}const Y_=function(){return{suppressScrollX:!0}};function G_(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",20)(1,"div",21)(2,"div",22),t._uU(3),t.ALo(4,"mytranslate"),t.TgZ(5,"span"),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()(),t.TgZ(8,"div",23)(9,"a",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.changesMixQuestionGroupType())}),t._uU(10),t.ALo(11,"mytranslate"),t.qZA(),t.TgZ(12,"a",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.resetFormQuestionGroup())}),t._uU(13),t.ALo(14,"mytranslate"),t.qZA()()(),t.TgZ(15,"div",26)(16,"perfect-scrollbar",27)(17,"div",28),t.ynx(18,29),t.YNc(19,z_,12,15,"div",30),t.BQk(),t.qZA()()()()}if(2&o){const e=t.oxw(2);t.xp6(3),t.hij(" ",t.lcZ(4,9,"lang_auto_so_luong_cau_hoi_can_lay")," "),t.xp6(3),t.lnq("(",e.totalTakeQuestion,"/",e.obj.countQuestion," ",t.lcZ(7,11,"lang_auto_cau_brackets"),""),t.xp6(4),t.hij(" ",t.lcZ(11,13,"lang_testbank_test_config_cancel_get_with_group")," "),t.xp6(3),t.hij(" ",t.lcZ(14,15,"lang_testbank_test_config_split_auto")," "),t.xp6(3),t.Q6J("config",t.DdM(17,Y_))("scrollIndicators",!0),t.xp6(3),t.Q6J("ngForOf",e.formArrayGroupInfos.controls)}}function $_(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t._UZ(3,"br"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_khong_bo_trong")," "))}function W_(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t._UZ(3,"br"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_lon_hon_0")," "))}function K_(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.ALo(3,"mytranslate"),t._UZ(4,"br"),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.lnq(" ",t.lcZ(2,3,"lang_auto_vui_long_nhap_nho_hon_tong_so_cau")," (",e.obj.countQuestion," ",t.lcZ(3,5,"lang_auto_cau_brackets")," ")}}function V_(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t._UZ(3,"br"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_nho_hon_hoac_bang_120")," "))}function X_(o,s){if(1&o&&(t.TgZ(0,"div",41),t.YNc(1,$_,4,3,"span",42),t.YNc(2,W_,4,3,"span",42),t.YNc(3,K_,5,7,"span",42),t.YNc(4,V_,4,3,"span",42),t.qZA()),2&o){const e=t.oxw(2);let n;t.xp6(1),t.Q6J("ngIf",""==e.form.controls.limitMixQuestion.value),t.xp6(1),t.Q6J("ngIf",""!=e.form.controls.limitMixQuestion.value&&e.form.controls.limitMixQuestion.value<=0),t.xp6(1),t.Q6J("ngIf",e.form.controls.limitMixQuestion.value>(null!==(n=e.obj.countQuestion)&&void 0!==n?n:0)),t.xp6(1),t.Q6J("ngIf",e.fromPrintOffline&&e.form.controls.limitMixQuestion.value<e.totalTakeQuestion&&e.form.controls.limitMixQuestion.value>120)}}function td(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t._UZ(3,"br"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_khong_nhap_qua_so_cau_toi_da_trong_nhom")," "))}function ed(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t._UZ(3,"br"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_tong_so_cau_cua_cac_nhom_lon_hon_0")," "))}function nd(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t._UZ(3,"br"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_tong_so_cac_cau_cua_cac_nhom_lon_hon_tong_so_cau")," "))}function id(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_tong_so_cau_cua_cac_nhom_nho_nhon_hoac_bang_120")," "))}function od(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t._UZ(3,"br"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_khong_bo_trong")," "))}function ad(o,s){if(1&o&&(t.TgZ(0,"div",41),t.YNc(1,td,4,3,"span",42),t.YNc(2,ed,4,3,"span",42),t.YNc(3,nd,4,3,"span",42),t.YNc(4,id,3,3,"span",42),t.YNc(5,od,4,3,"span",42),t.qZA()),2&o){const e=t.oxw(2);let n,i,a;t.xp6(1),t.Q6J("ngIf",e.totalTakeQuestion&&!(e.totalTakeQuestion>(null!==(n=e.obj.countQuestion)&&void 0!==n?n:0))),t.xp6(1),t.Q6J("ngIf",!e.totalTakeQuestion),t.xp6(1),t.Q6J("ngIf",e.totalTakeQuestion>(null!==(i=e.obj.countQuestion)&&void 0!==i?i:0)),t.xp6(1),t.Q6J("ngIf",e.fromPrintOffline&&e.totalTakeQuestion<(null!==(a=e.obj.countQuestion)&&void 0!==a?a:0)&&(null!==(a=e.obj.countQuestion)&&void 0!==a?a:0)>120),t.xp6(1),t.Q6J("ngIf",e.checkEmpty)}}function sd(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.ALo(3,"mytranslate"),t.ALo(4,"mytranslate"),t.ALo(5,"mytranslate"),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.gL8(" ",t.lcZ(2,6,"lang_testbank_test_config_enter_bigger_number_question_permanent")," (",e.minLimitMixQuestion," ",t.lcZ(3,8,"lang_testbank_test_config_question"),"), ",t.lcZ(4,10,"lang_testbank_test_config_less_number_question_upload")," (",e.obj.countQuestion," ",t.lcZ(5,12,"lang_testbank_test_config_question"),") ")}}function rd(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.ALo(3,"mytranslate"),t.ALo(4,"mytranslate"),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.HOy(" ",t.lcZ(2,4,"lang_testbank_test_config_enter_repuest_bigger_0"),", ",t.lcZ(3,6,"lang_testbank_test_config_less_number_question_upload")," (",e.obj.countQuestion," ",t.lcZ(4,8,"lang_testbank_test_config_question"),") ")}}function ld(o,s){if(1&o&&(t.TgZ(0,"span",45),t._uU(1),t.ALo(2,"mytranslate"),t.ALo(3,"mytranslate"),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.lnq(" ",t.lcZ(2,3,"lang_testbank_test_config_validate_number_question_enter")," (",e.obj.countQuestion," ",t.lcZ(3,5,"lang_testbank_test_config_question"),"). ")}}function cd(o,s){if(1&o&&(t.TgZ(0,"div",43),t.YNc(1,sd,6,14,"span",42),t.YNc(2,rd,5,10,"span",42),t.YNc(3,ld,4,7,"span",44),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf","1"==e.form.controls.mixQuestion.value&&e.minLimitMixQuestion>1&&!e.isGroupMixQuestion),t.xp6(1),t.Q6J("ngIf","1"==e.form.controls.mixQuestion.value&&1==e.minLimitMixQuestion&&!e.isGroupMixQuestion),t.xp6(1),t.Q6J("ngIf","1"==e.form.controls.mixQuestion.value&&e.isGroupMixQuestion)}}function _d(o,s){1&o&&(t.TgZ(0,"div",46)(1,"p",47),t._uU(2),t.ALo(3,"mytranslate"),t.ALo(4,"mytranslate"),t.TgZ(5,"a",48),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()()),2&o&&(t.xp6(2),t.AsE(" ",t.lcZ(3,3,"lang_auto_de_con_duoc_tao_tu_mot_luong_cau_hoi_duoc_lay_ngau_nhien_trong_de_goc_vi_du_de_goc_co_1000_cau_hoi")," ",t.lcZ(4,5,"lang_auto_ban_co_the_chi_in_40_cau_ngau_nhien_trong_1000_cau_hoi_do")," "),t.xp6(4),t.hij(" ",t.lcZ(7,7,"lang_auto_tim_hieu_them")," "))}const dd=function(o,s){return{"md:col-span-9 setting-form-input-default-style":o,"col-md-12 setting-form-input-with-no-left-column":s}};function ud(o,s){if(1&o&&(t.ynx(0,1),t.TgZ(1,"div",2),t.YNc(2,U_,4,6,"div",3),t.TgZ(3,"div",4)(4,"div",5),t.YNc(5,R_,9,7,"div",6),t.YNc(6,G_,20,18,"div",7),t.YNc(7,X_,5,4,"div",8),t.YNc(8,ad,6,5,"div",8),t.YNc(9,cd,4,3,"div",9),t.YNc(10,_d,8,9,"div",10),t.qZA()()(),t.BQk()),2&o){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(2),t.Q6J("ngIf",!e.fromPrintOffline),t.xp6(1),t.Q6J("ngClass",t.WLB(9,dd,!e.fromPrintOffline,e.fromPrintOffline)),t.xp6(2),t.Q6J("ngIf",!e.isGroupMixQuestion),t.xp6(1),t.Q6J("ngIf",e.isGroupMixQuestion&&e.examGroupInfos.length>1),t.xp6(1),t.Q6J("ngIf",e.checkValidateCountQuestion&&!e.isGroupMixQuestion),t.xp6(1),t.Q6J("ngIf",e.checkValidateCountQuestion&&e.isGroupMixQuestion),t.xp6(1),t.Q6J("ngIf",!e.fromPrintOffline),t.xp6(1),t.Q6J("ngIf",e.fromPrintOffline)}}let So=(()=>{class o extends mt.Q{constructor(e){super(e),this.commonService=e,this.fromPrintOffline=!1,this.formArrayGroupInfosName="",this.formControlLimitMixQuestionName="",this.isGroupMixQuestion=!1,this.isGroupMixQuestionChange=new t.vpe,this.checkValidateCountQuestion=!1,this.checkValidateCountQuestionChange=new t.vpe,this.totalTakeQuestion=0,this.totalTakeQuestionChange=new t.vpe,this.isNotNullData=!1,this.isTooltipPoint=!1,this.checkEmpty=!1}emitDataToparent(){this.isGroupMixQuestionChange.emit(this.isGroupMixQuestion),this.checkValidateCountQuestionChange.emit(this.checkValidateCountQuestion),this.totalTakeQuestionChange.emit(this.totalTakeQuestion)}changeIsGroupMixQuestion(e){this.isGroupMixQuestion=e,this.emitDataToparent()}changeCheckValidateCountQuestion(e){this.checkValidateCountQuestion=e,this.emitDataToparent()}changeTotalTakeQuestion(e){this.totalTakeQuestion=e}changesMixQuestionGroupType(){this.changeIsGroupMixQuestion(!this.isGroupMixQuestion),this.isGroupMixQuestion?this._validGroupMixquestionValue():this.validWhenChangeLimitMixquestionValue()}setFormQuestion(e,n){let i=this.commonService.getFormObj(this.formArrayGroupInfos),a=this._getGroupMixquestionValue(e),r=this._countNullMixquestionValue();if(null!=a){if(this.commonService.isMobileOrTable())for(let l=0;l<i.length;l++)0==i[l].isFixed&&i[l].groupId!=e&&r>0&&(i[l].totalQuestion=Number(a>i[l].maxQuestion?i[l].maxQuestion:a));else for(let l=0;l<i.length;l++)0==i[l].isFixed&&i[l].groupId!=e&&n&&(i[l].totalQuestion=Number(a>i[l].maxQuestion?i[l].maxQuestion:a));this.formArrayGroupInfos.setValue(i),this.changeTotalTakeQuestion(this._countTotalQuestionInMixGroup())}this.isGroupMixQuestion&&this._validGroupMixquestionValue()}validateWhenChangeGroupValue(e){setTimeout(()=>{this.setFormQuestion(e.value,!1)},1500),this.isGroupMixQuestion&&this._validGroupMixquestionValue()}_validGroupMixquestionValue(){var e,n;let i=this._countNullMixquestionValue();if(this.changeTotalTakeQuestion(this._countTotalQuestionInMixGroup()),this.checkEmpty=!1,i)return this.changeCheckValidateCountQuestion(!0),this.checkEmpty=!0,!1;if(this.isGroupMixQuestion){let a=this.commonService.getFormObj(this.formArrayGroupInfos);for(let r=0;r<a.length;r++)if(a[r].totalQuestion>a[r].maxQuestion)return this.changeCheckValidateCountQuestion(!0),!1}return this.totalTakeQuestion>(null!==(e=this.obj.countQuestion)&&void 0!==e?e:0)||this.fromPrintOffline&&this.totalTakeQuestion>120||this.totalTakeQuestion<1||this.totalTakeQuestion<this.minLimitMixQuestion?(this.changeCheckValidateCountQuestion(!0),!1):!(this.totalTakeQuestion>=this.minLimitMixQuestion&&this.totalTakeQuestion<=(null!==(n=this.obj.countQuestion)&&void 0!==n?n:0)&&(this.changeCheckValidateCountQuestion(!1),1))}validWhenChangeLimitMixquestionValue(){var e,n,i=this.form.controls.limitMixQuestion.value;return null!=i&&Number.isInteger(Number(i))?i>(null!==(e=this.obj.countQuestion)&&void 0!==e?e:0)||this.fromPrintOffline&&i>120||i<1||i<this.minLimitMixQuestion?(this.changeCheckValidateCountQuestion(!0),!1):(i>=this.minLimitMixQuestion&&i<=(null!==(n=this.obj.countQuestion)&&void 0!==n?n:0)&&this.changeCheckValidateCountQuestion(!1),!0):(this.changeCheckValidateCountQuestion(!0),!1)}resetFormQuestionGroup(){let e=this.commonService.getFormObj(this.formArrayGroupInfos);for(let n=0;n<e.length;n++)0===e[n].isFixed&&(e[n].totalQuestion=null);this.changeCheckValidateCountQuestion(!0),this.formArrayGroupInfos.setValue(e)}triggerCtrlEnter(e,n){e.ctrlKey&&"Enter"===e.code&&(this.setFormQuestion(n.value,!0),e.preventDefault())}enableTooltip(){this.isTooltipPoint=!0}disableTooltip(){this.isTooltipPoint=!1}_createMixGroupFormArray(e){this.formArrayGroupInfos.clear(),e.forEach(n=>{var i,a,r;let l=new h.cw({groupId:new h.p4(n.groupId),isFixed:new h.p4(n.isFixed),totalQuestion:new h.p4(n.limitQuestion,[h.kI.min(0),h.kI.max(null!==(i=n.totalQuestion)&&void 0!==i?i:0)]),maxQuestion:new h.p4(n.totalQuestion),error:new h.p4(!1)});null===(a=this.formArrayGroupInfos)||void 0===a||a.push(l),this.totalTakeQuestion+=null!==(r=Number(n.limitQuestion))&&void 0!==r?r:0})}_convertExamGroupInfos(e,n,i){let a=[];return e.forEach(r=>{var l,c;i?a.push(Object.assign(Object.assign({},r),{limitQuestion:r.totalQuestion})):n&&n.hasOwnProperty(null!==(l=r.groupId)&&void 0!==l?l:-1)&&a.push(Object.assign(Object.assign({},r),{limitQuestion:n[null!==(c=r.groupId)&&void 0!==c?c:-1]}))}),a}_getGroupMixquestionValue(e){let n=this.commonService.getFormObj(this.formArrayGroupInfos),i=null;for(let a=0;a<n.length;a++)n[a].groupId==e&&(i=n[a].totalQuestion);return i}_countNullMixquestionValue(){let e=this.commonService.getFormObj(this.formArrayGroupInfos),n=0;for(let i=0;i<e.length;i++)null==e[i].totalQuestion&&n++;return n}_countTotalQuestionInMixGroup(){let e=this.commonService.getFormObj(this.formArrayGroupInfos);var n=0;for(let i=0;i<e.length;i++)e[i].totalQuestion&&e[i].totalQuestion>0&&(n+=Number(e[i].totalQuestion));return n}_checkNullData(){var e,n;return this.form&&(this.formArrayGroupInfos=null===(e=this.form)||void 0===e?void 0:e.get(this.formArrayGroupInfosName),this.formControlLimitMixQuestion=null===(n=this.form)||void 0===n?void 0:n.get(this.formControlLimitMixQuestionName)),!!(this.form&&this.formArrayGroupInfos&&this.formControlLimitMixQuestion&&null!=this.obj&&null!=this.minLimitMixQuestion&&null!=this.examGroupInfos&&null!=this.isGroupMixQuestion&&null!=this.checkValidateCountQuestion)}_initGroupData(){var e,n;this.examGroupInfos.length>0&&(1==(null===(e=this.obj.limitQuestionGroupsParse)||void 0===e?void 0:e.status)?(this.changeIsGroupMixQuestion(!0),this._createMixGroupFormArray(this._convertExamGroupInfos(this.examGroupInfos,this.obj.limitQuestionGroupsParse.objs,!1))):null!=this.obj.limitQuestionGroups&&0==(null===(n=this.obj.limitQuestionGroupsParse)||void 0===n?void 0:n.status)?(this.changeIsGroupMixQuestion(!1),this._createMixGroupFormArray(this._convertExamGroupInfos(this.examGroupInfos,this.obj.limitQuestionGroupsParse.objs,!1))):this._createMixGroupFormArray(this._convertExamGroupInfos(this.examGroupInfos,{},!0)),this.isGroupMixQuestion?this._validGroupMixquestionValue():this.validWhenChangeLimitMixquestionValue())}ngOnInit(){super.ngOnInit(),this.isNotNullData=this._checkNullData(),this.isNotNullData&&this._initGroupData()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v))},o.\u0275cmp=t.Xpm({type:o,selectors:[["test-config-online-mix-question"]],inputs:{fromPrintOffline:"fromPrintOffline",form:"form",formArrayGroupInfosName:"formArrayGroupInfosName",formControlLimitMixQuestionName:"formControlLimitMixQuestionName",obj:"obj",minLimitMixQuestion:"minLimitMixQuestion",examGroupInfos:"examGroupInfos"},outputs:{isGroupMixQuestionChange:"isGroupMixQuestionChange",checkValidateCountQuestionChange:"checkValidateCountQuestionChange",totalTakeQuestionChange:"totalTakeQuestionChange"},features:[t.qOj],decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],["id","exam-get-mix-question",1,"grid","grid-cols-12","grap-5"],["class","col-span-12 md:col-span-3",3,"ngClass",4,"ngIf"],[1,"col-span-12","mt-2",3,"ngClass"],[1,"setting-block-create-sub","w-100"],["class","setting-block-mix-v1",4,"ngIf"],["class","border border-slate-200/60 dark:border-darkmode-400 rounded-md pb-1",4,"ngIf"],["class","col-span-12 mt-2 text-xs text-danger fade",4,"ngIf"],["class","col-span-12 leading-relaxed text-slate-500 text-xs px-0 mt-1",4,"ngIf"],["class","col-span-12 px-0 mt-2",4,"ngIf"],[1,"col-span-12","md:col-span-3",3,"ngClass"],[1,"font-medium","mt-5"],[1,"setting-block-mix-v1"],[1,"not-group"],[1,"grid","grid-cols-12","gap-3"],[1,"col-span-6","md:col-span-8","lg:col-span-9"],["type","text","appOnlyNumber","","formControlName","limitMixQuestion",1,"form-control",3,"ngClass","input"],[1,"col-span-6","md:col-span-4","lg:col-span-3"],[1,"btn","btn-secondary","px-1","w-full",3,"disabled","click"],[1,"border","border-slate-200/60","dark:border-darkmode-400","rounded-md","pb-1"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","flex-col","md:flex-row","md:items-center"],[1,"mr-auto"],[1,"flex"],[1,"btn","btn-sm","btn-outline-danger","mt-2","md:mt-0",3,"click"],[1,"btn","btn-sm","btn-outline-secondary","ml-2","mt-2","md:mt-0","block","md:hidden",3,"click"],[2,"height","160px"],[3,"config","scrollIndicators"],[1,"grid","grid-cols-12","gap-5","mb-5","p-3"],["formArrayName","groupInfos"],["class","col-span-6 md:col-md-4 lg:col-span-3 mt-1",4,"ngFor","ngForOf"],[1,"col-span-6","md:col-md-4","lg:col-span-3","mt-1"],[1,"mb-0","pb-0","text-left",2,"font-size","13.5px"],["class","azt-hidden md:block form-control","type","text","appOnlyNumber","","onwheel","return false;","formControlName","totalQuestion",3,"ngClass","input","focus","keydown",4,"ngIf"],["class","block md:hidden form-control","type","text","appOnlyNumber","","onwheel","return false;","formControlName","totalQuestion",3,"ngClass","input",4,"ngIf"],["type","text","class","form-control","formControlName","totalQuestion",4,"ngIf"],["matTooltipPosition","below","matTooltipClass","my-tooltip",1,"azt-hidden","md:block",3,"matTooltip"],["tooltip","matTooltip"],["type","text","appOnlyNumber","","onwheel","return false;","formControlName","totalQuestion",1,"azt-hidden","md:block","form-control",3,"ngClass","input","focus","keydown"],["type","text","appOnlyNumber","","onwheel","return false;","formControlName","totalQuestion",1,"block","md:hidden","form-control",3,"ngClass","input"],["type","text","formControlName","totalQuestion",1,"form-control"],[1,"col-span-12","mt-2","text-xs","text-danger","fade"],[4,"ngIf"],[1,"col-span-12","leading-relaxed","text-slate-500","text-xs","px-0","mt-1"],["class","clearfix pt-1 text-left",4,"ngIf"],[1,"clearfix","pt-1","text-left"],[1,"col-span-12","px-0","mt-2"],[1,"text-slate-500","text-xs"],["href","https://docs.azota.vn/","target","_blank",1,"text-primary"]],template:function(e,n){1&e&&t.YNc(0,ud,11,12,"ng-container",0),2&e&&t.Q6J("ngIf",n.isNotNullData)},dependencies:[O.mk,O.sg,O.O5,Wt.gM,Lt.Vv,h.Fj,h.JJ,h.JL,h.sg,h.u,h.CE,un.Y,oe.M,at.bT],encapsulation:2}),o})();var Ri=b(30502);function md(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",4),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.previewResultImage())}),t._UZ(1,"img",2),t.ALo(2,"convertCdn"),t.qZA()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("src",t.lcZ(2,1,e.curSampleResultImage),t.LSH)}}let hd=(()=>{class o extends mt.Q{constructor(e,n,i){super(e),this.commonService=e,this.dialog=n,this.cdnService=i,this.answersheetTemplate=0,this.curPreviewImage="",this.curSampleResultImage=""}getSampleResultForTemplate(e){switch(e.toString()){case"1":case"0":case"5":case"4":return"";case"6":case"2":return"azota_assets/medias/sample_result/no_student_code_result.jpg"}return""}getImageForTemplate(e){switch(e.toString()){case"1":return"azota_assets/medias/preview_images/answersheet_mau_a4_bo_giao_duc_120.jpg";case"0":return"azota_assets/medias/preview_images/answersheet_mau_a4_120.jpg";case"5":return"azota_assets/medias/preview_images/answersheet_mau_a6_full_a4_20.jpg";case"6":return"azota_assets/medias/preview_images/answersheet_mau_a6_full_a4_50.jpg";case"2":return"azota_assets/medias/preview_images/answersheet_mau_a8_full_a4_20.jpg";case"4":return"azota_assets/medias/preview_images/answersheet_mau_a4_hon_hop_35.jpg"}return""}previewImage(){var e={name:"",mimes:"image/jpeg",url:this.cdnService.convertLinkCdn(this.getImageForTemplate(this.answersheetTemplate))};let i=Object.assign(Object.assign({},e),{index:0});this.dialog.open(Ri.F,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",data:{fileOption:i,viewFullImageWithScroll:!0,showDownloadIcon:!1}})}previewResultImage(){var e={name:"",mimes:"image/jpeg",url:this.cdnService.convertLinkCdn(this.getSampleResultForTemplate(this.answersheetTemplate))};let i=Object.assign(Object.assign({},e),{index:0});this.dialog.open(Ri.F,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",data:{fileOption:i,viewFullImageWithScroll:!0,showDownloadIcon:!1}})}ngOnChanges(){this.curPreviewImage=this.getImageForTemplate(this.answersheetTemplate),this.curSampleResultImage=this.getSampleResultForTemplate(this.answersheetTemplate)}ngOnInit(){this.curPreviewImage=this.getImageForTemplate(this.answersheetTemplate),this.curSampleResultImage=this.getSampleResultForTemplate(this.answersheetTemplate),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(j.uw),t.Y36(Ke.U))},o.\u0275cmp=t.Xpm({type:o,selectors:[["preview-answersheet-dialog"]],inputs:{answersheetTemplate:"answersheetTemplate"},features:[t.qOj,t.TTD],decls:5,vars:4,consts:[[1,"flex"],[1,"w-32","h-32","flex-none","image-fit","rounded-md","overflow-hidden","mt-3","clickable","mr-5",3,"click"],[3,"src"],["class","w-32 h-32 flex-none image-fit rounded-md overflow-hidden mt-3 clickable",3,"click",4,"ngIf"],[1,"w-32","h-32","flex-none","image-fit","rounded-md","overflow-hidden","mt-3","clickable",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return n.previewImage()}),t._UZ(2,"img",2),t.ALo(3,"convertCdn"),t.qZA(),t.YNc(4,md,3,3,"div",3),t.qZA()),2&e&&(t.xp6(2),t.Q6J("src",t.lcZ(3,2,n.curPreviewImage),t.LSH),t.xp6(2),t.Q6J("ngIf",n.curSampleResultImage))},dependencies:[O.O5,at.BI],encapsulation:2}),o})();function pd(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_so_luong_de_dao")," "))}function gd(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_so_luong_de_phai_lon_hon_0")," "))}function fd(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.AsE(" ",t.lcZ(2,2,"lang_auto_so_luong_de_phai_nho_hon"),"\xa0",e.limitMaxMixQuestionHashId," ")}}function xd(o,s){if(1&o&&(t.TgZ(0,"div",28),t.YNc(1,pd,3,3,"span",29),t.YNc(2,gd,3,3,"span",29),t.YNc(3,fd,3,4,"span",29),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.form.controls.numberExam.errors.required),t.xp6(1),t.Q6J("ngIf",e.form.controls.numberExam.errors.min),t.xp6(1),t.Q6J("ngIf",e.form.controls.numberExam.errors.max)}}function vd(o,s){1&o&&(t.TgZ(0,"div",28)(1,"small",30),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_testbank_offline_test_cannot_be_reversed"),". "))}function bd(o,s){1&o&&(t.TgZ(0,"div",28)(1,"span"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_auto_de_thi_qua_120_cau_vui_long_tao_de_con_duoi_120_cau_de_in_de"),". "))}function wd(o,s){if(1&o&&(t.TgZ(0,"div",28)(1,"span"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_testbank_offline_test_not_print_exam_have_answer")+" "+e.dataConfigDocument.allowMaxAnswerChoices,". ")}}let Td=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l){super(e),this.commonService=e,this.formBuilder=n,this.offlineExamService=i,this.documentConfigService=a,this.dialogRef=r,this.form=new h.nJ({}),this.examObj={},this.obj={},this.backToLink="",this.dataConfigDocument={},this.isLoadingPrintTest=!1,this.isGroupMixQuestion=!1,this.checkValidateCountQuestion=!1,this.totalTakeQuestion=0,this.hasGroupQuestion=!1,this.examGroupInfos=[],this.minLimitMixQuestion=0,this.maxAllowMixQuestionHashId=0,this.defaultMaxMixQuestionHashId=999,this.defaultMaxCreateMixExamOneTime=100,this.limitMaxMixQuestionHashId=999,this.dataConfigDocument=l.dataConfigDocument,this.backToLink=l.backToLink}btnCloseDialog(e){this.dialogRef.close(e)}getGroupMixInfosSubmit(e){let n={};return e.forEach(i=>{var a;n.hasOwnProperty(i.groupId)||(n[i.groupId]=null!==(a=i.totalQuestion)&&void 0!==a?a:0)}),JSON.stringify({status:this.isGroupMixQuestion?1:0,objs:n})}printExam(){this.isLoadingPrintTest=!0;let e=Number(this.form.controls.numberExam.value),i=this.form.controls.answersheetTemplate?Number(this.form.controls.answersheetTemplate.value):0;this.subscriptions.add(this.offlineExamService.apiOfflineExamCreateExamObjGet(this.examObj.hashId,e,0,i).subscribe(a=>{var r,l,c;if(1===a.success){if(null!==(r=a.data)&&void 0!==r&&r.obj){let _=a.data.obj;this.dialogRef.close(),this.myNavigationWithQueryString(`/admin/testbank/download-file-print/${null!==(l=this.examObj.categoryId)&&void 0!==l?l:0}/${_.examHashId}/${_.hashId}`,`?backto=${this.backToLink}`)}this.isLoadingPrintTest=!1}else this.errorStatusObj(null!==(c=a.message)&&void 0!==c?c:"",!0),this.isLoadingPrintTest=!1}))}savePrintExam(){var e;this.initStatusObj();let n=this.commonService.getFormObj(this.form);n.limitMixQuestion=n.limitMixQuestion>0?n.limitMixQuestion:0;let i=n.isCreateSubTest?2:2==(null===(e=this.dataConfigDocument.examObj)||void 0===e?void 0:e.mixQuestion)?1:void 0,a=this.getGroupMixInfosSubmit(n.groupInfos);this.subscriptions.add(this.documentConfigService.apiDocumentConfigSaveExamConfigPost({mixQuestion:i,limitMixQuestion:n.limitMixQuestion,limitQuestionGroups:a},this.examObj.hashId).subscribe(l=>{var c;1==l.success?this.printExam():this.errorStatusObj(null!==(c=l.message)&&void 0!==c?c:"",!0)}))}initData(e){var n,i,a,r,l,c,_,d;let m=null!==(n=null==e?void 0:e.examObj)&&void 0!==n?n:{},p={};p=null!==(i=this.castObj(m))&&void 0!==i?i:{},p.limitQuestionGroupsParse=this.commonService.myParseJson(null!==(a=m.limitQuestionGroups)&&void 0!==a?a:""),this.obj=p,this.examObj=null!==(r=e.examObj)&&void 0!==r?r:{},this.maxAllowMixQuestionHashId=this.defaultMaxMixQuestionHashId-(null!==(l=null==e?void 0:e.totalUsedMixQuestionHashId)&&void 0!==l?l:0),this.limitMaxMixQuestionHashId=this.maxAllowMixQuestionHashId>this.defaultMaxCreateMixExamOneTime?this.defaultMaxCreateMixExamOneTime:this.maxAllowMixQuestionHashId,console.log(this.limitMaxMixQuestionHashId),this.form.controls.limitMixQuestion.setValue(this.obj.limitMixQuestion),this.form.controls.isCreateSubTest.setValue(2==this.obj.mixQuestion),this.form.controls.numberExam.addValidators(h.kI.max(this.limitMaxMixQuestionHashId)),this.form.controls.answersheetTemplate.setValue(null!==(_=null===(c=e.offlineExamObj)||void 0===c?void 0:c.answersheetTemplate)&&void 0!==_?_:0),this.hasGroupQuestion=!!e.hasGroupQuestion,this.minLimitMixQuestion=null!==(d=e.minLimitMixQuestion)&&void 0!==d?d:0,this.examGroupInfos=e.examGroupInfos&&e.examGroupInfos.length>0?e.examGroupInfos:this.examGroupInfos}ngOnInit(){this.form=this.formBuilder.group({numberExam:new h.p4(1,[h.kI.required,h.kI.min(1)]),isCreateSubTest:new h.p4(!1),mixQuestion:new h.p4("1"),groupInfos:new h.vC([]),limitMixQuestion:new h.p4(""),answersheetTemplate:new h.p4("0",[h.kI.required])}),this.initData(this.dataConfigDocument),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(h.QS),t.Y36(Ot.vv),t.Y36(Ot.Cq),t.Y36(j.so,8),t.Y36(j.WI,8))},o.\u0275cmp=t.Xpm({type:o,selectors:[["print-exam-direct"]],features:[t.qOj],decls:59,vars:53,consts:[[1,"box"],[3,"formGroup"],[3,"defaultHeight"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"azt-print-dialog"],[1,"p-3","border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"text-md","font-bold","flex","items-center"],[1,"p-3"],[1,"form-label","font-medium"],["type","text","appOnlyNumber","","formControlName","numberExam",1,"form-control",3,"placeholder"],["class","text-xs text-danger fade mt-2",4,"ngIf"],[1,"mt-3"],["formControlName","answersheetTemplate",1,"form-select"],["value","1"],["value","0"],["value","5"],["value","6"],["value","2"],["value","4"],[3,"answersheetTemplate"],[1,"form-check","form-switch"],["for","create-sub-exam",1,"form-check-label","ml-0"],["id","create-sub-exam","formControlName","isCreateSubTest","type","checkbox",1,"show-code","form-check-input","mr-0","ml-3"],[1,"mt-3",3,"hidden"],["formArrayGroupInfosName","groupInfos","formControlLimitMixQuestionName","limitMixQuestion",3,"fromPrintOffline","form","obj","minLimitMixQuestion","examGroupInfos","isGroupMixQuestionChange","checkValidateCountQuestionChange","totalTakeQuestionChange"],[1,"p-3","text-right"],[1,"btn","btn-secondary","w-24","mr-2",3,"click"],[1,"btn","btn-primary","mt-2",3,"disabled","click"],[1,"text-xs","text-danger","fade","mt-2"],[4,"ngIf"],[1,"text-note","text-danger"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"form",1)(2,"azt-mat-dialog-content",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h3",6),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()(),t.TgZ(9,"div",7)(10,"div")(11,"label",8),t._uU(12),t.ALo(13,"mytranslate"),t.qZA(),t._UZ(14,"input",9),t.ALo(15,"mytranslate"),t.YNc(16,xd,4,3,"div",10),t.YNc(17,vd,4,3,"div",10),t.YNc(18,bd,4,3,"div",10),t.YNc(19,wd,4,3,"div",10),t.qZA(),t.TgZ(20,"div",11)(21,"label",8),t._uU(22),t.ALo(23,"mytranslate"),t.qZA(),t.TgZ(24,"select",12)(25,"option",13),t._uU(26),t.ALo(27,"mytranslate"),t.qZA(),t.TgZ(28,"option",14),t._uU(29),t.ALo(30,"mytranslate"),t.qZA(),t.TgZ(31,"option",15),t._uU(32),t.ALo(33,"mytranslate"),t.qZA(),t.TgZ(34,"option",16),t._uU(35),t.ALo(36,"mytranslate"),t.qZA(),t.TgZ(37,"option",17),t._uU(38),t.ALo(39,"mytranslate"),t.qZA(),t.TgZ(40,"option",18),t._uU(41),t.ALo(42,"mytranslate"),t.qZA()(),t._UZ(43,"preview-answersheet-dialog",19),t.qZA(),t.TgZ(44,"div",11)(45,"div",20)(46,"label",21),t._uU(47),t.ALo(48,"mytranslate"),t.qZA(),t._UZ(49,"input",22),t.qZA()(),t.TgZ(50,"div",23)(51,"test-config-online-mix-question",24),t.NdJ("isGroupMixQuestionChange",function(a){return n.isGroupMixQuestion=a})("checkValidateCountQuestionChange",function(a){return n.checkValidateCountQuestion=a})("totalTakeQuestionChange",function(a){return n.totalTakeQuestion=a}),t.qZA()()()()()(),t.TgZ(52,"div",25)(53,"button",26),t.NdJ("click",function(){return n.btnCloseDialog(!1)}),t._uU(54),t.ALo(55,"mytranslate"),t.qZA(),t.TgZ(56,"button",27),t.NdJ("click",function(){return n.savePrintExam()}),t._uU(57),t.ALo(58,"mytranslate"),t.qZA()()()()),2&e&&(t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("defaultHeight",85),t.xp6(5),t.hij(" ",t.lcZ(8,27,"lang_auto_in_de_co_phieu_tra_loi_trac_nghiem_rieng")," "),t.xp6(5),t.hij(" ",t.lcZ(13,29,"lang_auto_so_luong_de_dao")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(15,31,"lang_auto_nhap_so_luong_de_dao")),t.xp6(2),t.Q6J("ngIf",n.form.controls.numberExam.dirty&&n.form.controls.numberExam.errors),t.xp6(1),t.Q6J("ngIf",0===(null==n.dataConfigDocument?null:n.dataConfigDocument.canMixQuestion)&&n.form.controls.numberExam.value>1),t.xp6(1),t.Q6J("ngIf",1===(null==n.dataConfigDocument?null:n.dataConfigDocument.exceedMaxQuestions)),t.xp6(1),t.Q6J("ngIf",n.dataConfigDocument.maxAnswerChoices&&n.dataConfigDocument.maxAnswerChoices>4),t.xp6(3),t.hij(" ",t.lcZ(23,33,"lang_auto_chon_mau_phieu_tra_loi")," "),t.xp6(4),t.Oqu(t.lcZ(27,35,"lang_auto_answersheet_mau_a4_bo_giao_duc_120")),t.xp6(3),t.Oqu(t.lcZ(30,37,"lang_auto_answersheet_mau_a4_120")),t.xp6(3),t.Oqu(t.lcZ(33,39,"lang_auto_answersheet_mau_a6_full_a4_20")),t.xp6(3),t.Oqu(t.lcZ(36,41,"lang_auto_answersheet_mau_a6_full_a4_50")),t.xp6(3),t.Oqu(t.lcZ(39,43,"lang_auto_answersheet_mau_a8_full_a4_20")),t.xp6(3),t.Oqu(t.lcZ(42,45,"lang_auto_answersheet_mau_a4_hon_hop_35")),t.xp6(2),t.Q6J("answersheetTemplate",n.form.controls.answersheetTemplate.value),t.xp6(4),t.hij(" ",t.lcZ(48,47,"lang_auto_tao_de_con")," "),t.xp6(3),t.Q6J("hidden",!(1==n.form.controls.isCreateSubTest.value&&1==n.form.controls.mixQuestion.value)),t.xp6(1),t.Q6J("fromPrintOffline",!0)("form",n.form)("obj",n.obj)("minLimitMixQuestion",n.minLimitMixQuestion)("examGroupInfos",n.examGroupInfos),t.xp6(3),t.hij(" ",t.lcZ(55,49,"lang_auto_dong")," "),t.xp6(2),t.Q6J("disabled",n.checkValidateCountQuestion&&1==n.form.controls.isCreateSubTest.value||1==n.form.controls.isCreateSubTest.value&&n.isGroupMixQuestion&&n.totalTakeQuestion>120||1==n.form.controls.isCreateSubTest.value&&n.isGroupMixQuestion&&0==n.totalTakeQuestion||void 0!==n.dataConfigDocument.maxAnswerChoices&&n.dataConfigDocument.maxAnswerChoices>4),t.xp6(1),t.hij(" ",t.lcZ(58,51,"lang_auto_in_de_and_phieu")," "))},dependencies:[O.O5,h._Y,h.YN,h.Kr,h.Fj,h.Wl,h.EJ,h.JJ,h.JL,h.sg,h.u,un.Y,oe.M,ko.O,So,hd,at.bT],encapsulation:2}),o})();var mn=b(50336),de=b(20371),hi=b(94327),on=b(20259),pi=b(79695),Nn=b(34202),Cd=b(53583);class Ad{initPdfData(s){return this.PDF_DATA=new yd(s.NUMBER_QUESTION,s.START_QUESTION_COUNTER,s.EXAM_CODE_LENGTH,s.DRAW_LOGO),this}createAnswerSheet(){return new Nn.y(s=>{new Promise(n=>{try{this._makeResetItem();const i=this.PDF_DATA.CANVAS_ELEMENT.getContext("2d");i&&(this._makeRootDetachRanges(i),this._makeHeader(i),this._makeBody(i,this.PDF_DATA.START_QUESTION_COUNTER),this._makeNote(i),this._makeDrawLogo(i).then(()=>{n("SUCCESS")}))}catch(i){n("Exception:"+i)}}).then(n=>{"SUCCESS"==n?(s.next({success:1,message:"successful",data:this}),s.complete()):(s.next({success:0,message:n,data:this}),s.complete())})})}_stockRectContext(s,e,n,i,a,r){s.beginPath(),s.lineWidth=this.PDF_DATA.WRAPPER_SCALL/3*2,s.strokeStyle=r,s.rect(e,n,i,a),s.stroke(),s.closePath()}_makeResetItem(){this.PDF_DATA.resetSetting()}_makeRootDetachRanges(s){this.PDF_DATA.POINTER_WRAPPER.root_detach_ranges.push(new gi({x:this.PDF_DATA.WRAPPER_MARGIN,y:this.PDF_DATA.WRAPPER_MARGIN,w:this.PDF_DATA.ROOT_SQUARE_WIDTH,h:this.PDF_DATA.ROOT_SQUARE_WIDTH})),this.PDF_DATA.POINTER_WRAPPER.root_detach_ranges.push(new gi({x:this.PDF_DATA.WRAPPER_SIZE_WIDTH-this.PDF_DATA.WRAPPER_MARGIN-this.PDF_DATA.ROOT_SQUARE_WIDTH,y:this.PDF_DATA.WRAPPER_MARGIN,w:this.PDF_DATA.ROOT_SQUARE_WIDTH,h:this.PDF_DATA.ROOT_SQUARE_WIDTH}));let e=1038/720*(this.PDF_DATA.WRAPPER_SIZE_WIDTH-this.PDF_DATA.WRAPPER_MARGIN-this.PDF_DATA.ROOT_SQUARE_WIDTH-this.PDF_DATA.WRAPPER_MARGIN+this.PDF_DATA.ROOT_SQUARE_WIDTH)-this.PDF_DATA.ROOT_SQUARE_WIDTH;this.PDF_DATA.POINTER_WRAPPER.root_detach_ranges.push(new gi({x:this.PDF_DATA.WRAPPER_MARGIN,y:e,w:this.PDF_DATA.ROOT_SQUARE_WIDTH,h:this.PDF_DATA.ROOT_SQUARE_WIDTH})),this.PDF_DATA.POINTER_WRAPPER.root_detach_ranges.push(new gi({x:this.PDF_DATA.WRAPPER_SIZE_WIDTH-this.PDF_DATA.WRAPPER_MARGIN-this.PDF_DATA.ROOT_SQUARE_WIDTH,y:e,w:this.PDF_DATA.ROOT_SQUARE_WIDTH,h:this.PDF_DATA.ROOT_SQUARE_WIDTH})),this.PDF_DATA.POINTER_WRAPPER.root_detach_ranges.forEach((n,i)=>{n.drawReact(s,i>3?"white":"black")}),this.PDF_DATA.POINTER_WRAPPER.getRootDetachRange(),this.PDF_DATA.CURSOR_POINTER_Y=this.PDF_DATA.POINTER_WRAPPER.root_detach_range.y}_makeDotWithSize(s,e,n){let a=0,r=s.measureText(e);for(;r.width<n;){if(a++,a>1e3){Bi.IS_DEBUG&&console.log("breack char whille");break}r=s.measureText(e+=".")}return{in:e,size:s.measureText(e)}}_drawHeaderTitle(s){s.beginPath();const e=2*this.PDF_DATA.MAIN_FONT_SIZE,n=1.5*this.PDF_DATA.MAIN_FONT_SIZE;s.font=`bold ${n}px ${this.PDF_DATA.ST_FONT}`,s.fillStyle="black";const i=s.measureText(this.PDF_DATA.ST_BIG_TITLE.toUpperCase());return s.textAlign="center",s.fillText(this.PDF_DATA.ST_BIG_TITLE.toUpperCase(),this.PDF_DATA.getCenterPointer(),this.PDF_DATA.CURSOR_POINTER_Y+n),{x:this.PDF_DATA.getCenterPointer()-i.width/2,y:this.PDF_DATA.CURSOR_POINTER_Y,w:i.width,h:e}}_drawHeaderBoxInfomation(s,e){const n={x:0,y:0,w:0,h:0},i=this.PDF_DATA.POINTER_WRAPPER.root_detach_range.x-this.PDF_DATA.ROOT_SQUARE_WIDTH/3*2;e-=this.PDF_DATA.ROOT_SQUARE_WIDTH/3*2,s.beginPath(),s.beginPath(),s.font=`${this.PDF_DATA.MAIN_FONT_SIZE}px ${this.PDF_DATA.ST_FONT}`,s.textAlign="left";let a=this._makeDotWithSize(s,this.PDF_DATA.ST_SUB_TITLE,e-10);s.fillText(a.in,i,this.PDF_DATA.CURSOR_POINTER_Y+this.PDF_DATA.MAIN_FONT_SIZE),s.closePath(),this.PDF_DATA.CURSOR_POINTER_Y+=this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT,s.beginPath(),s.textAlign="left";const r=Math.ceil(e/3*1.8),l=e-r-this.PDF_DATA.WRAPPER_LINE_HEIGHT/2;s.font=`${this.PDF_DATA.MAIN_FONT_SIZE}px ${this.PDF_DATA.ST_FONT}`;let c=this._makeDotWithSize(s,this.PDF_DATA.ST_BAI_THI,r-this.PDF_DATA.WRAPPER_LINE_HEIGHT/2);s.fillText(c.in,i,this.PDF_DATA.CURSOR_POINTER_Y+this.PDF_DATA.MAIN_FONT_SIZE),n.x=i,n.y=this.PDF_DATA.CURSOR_POINTER_Y;let _=this._makeDotWithSize(s,this.PDF_DATA.ST_NGAY_THI,l-50);s.fillText(_.in,i+c.size.width+this.PDF_DATA.WRAPPER_LINE_HEIGHT,this.PDF_DATA.CURSOR_POINTER_Y+this.PDF_DATA.MAIN_FONT_SIZE),s.closePath(),this.PDF_DATA.CURSOR_POINTER_Y+=this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT;const d=Math.ceil(e/3*2.2),m=e-d-this.PDF_DATA.WRAPPER_LINE_HEIGHT/2,p=this.PDF_DATA.CURSOR_POINTER_Y;s.beginPath();let w=this._makeDotWithSize(s,this.PDF_DATA.ST_HDT,d-this.PDF_DATA.WRAPPER_LINE_HEIGHT);s.fillText(w.in,i+m+this.PDF_DATA.WRAPPER_LINE_HEIGHT,this.PDF_DATA.CURSOR_POINTER_Y+this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT),s.closePath(),this.PDF_DATA.CURSOR_POINTER_Y+=this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT,s.beginPath();let C=this._makeDotWithSize(s,this.PDF_DATA.ST_DT,d-this.PDF_DATA.WRAPPER_LINE_HEIGHT);s.fillText(C.in,i+m+this.PDF_DATA.WRAPPER_LINE_HEIGHT,this.PDF_DATA.CURSOR_POINTER_Y+this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT),s.closePath(),this.PDF_DATA.CURSOR_POINTER_Y+=this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT,s.beginPath();let A=this._makeDotWithSize(s,this.PDF_DATA.ST_PTS,d-this.PDF_DATA.WRAPPER_LINE_HEIGHT);s.fillText(A.in,i+m+this.PDF_DATA.WRAPPER_LINE_HEIGHT,this.PDF_DATA.CURSOR_POINTER_Y+this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT),s.closePath(),this.PDF_DATA.CURSOR_POINTER_Y+=this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT,s.beginPath();let M=this._makeDotWithSize(s,this.PDF_DATA.ST_HVTTS,d-this.PDF_DATA.WRAPPER_LINE_HEIGHT);s.fillText(M.in,i+m+this.PDF_DATA.WRAPPER_LINE_HEIGHT,this.PDF_DATA.CURSOR_POINTER_Y+this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT),s.closePath(),this.PDF_DATA.CURSOR_POINTER_Y+=this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT,s.beginPath();let D=s.measureText(this.PDF_DATA.ST_NS);for(;D.width<d-2*this.PDF_DATA.WRAPPER_LINE_HEIGHT;)this.PDF_DATA.ST_NS=this.PDF_DATA.ST_NS.replace("[]",".[]"),D=s.measureText(this.PDF_DATA.ST_NS);this.PDF_DATA.ST_NS=this.PDF_DATA.ST_NS.replace("[]","..."),s.fillText(this.PDF_DATA.ST_NS+"...",i+m+this.PDF_DATA.WRAPPER_LINE_HEIGHT,this.PDF_DATA.CURSOR_POINTER_Y+this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT),s.closePath(),this.PDF_DATA.CURSOR_POINTER_Y+=this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT,s.beginPath();let q=this._makeDotWithSize(s,this.PDF_DATA.ST_CKCTT,d-this.PDF_DATA.WRAPPER_LINE_HEIGHT);s.fillText(q.in,i+m+this.PDF_DATA.WRAPPER_LINE_HEIGHT,this.PDF_DATA.CURSOR_POINTER_Y+this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT),s.closePath(),this.PDF_DATA.CURSOR_POINTER_Y+=this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT;const U=this.PDF_DATA.CURSOR_POINTER_Y+this.PDF_DATA.WRAPPER_LINE_HEIGHT-p;this._stockRectContext(s,i+m+this.PDF_DATA.WRAPPER_LINE_HEIGHT/2,p,d,U,"black");const F={x:i,y:p,w:m,h:U/2},tt={x:i,y:p+U/2,w:m,h:U/2};return s.beginPath(),this._stockRectContext(s,F.x,F.y,F.w,F.h,"black"),this._stockRectContext(s,tt.x,tt.y,tt.w,tt.h,"black"),s.font=`${this.PDF_DATA.MAIN_FONT_SIZE}px ${this.PDF_DATA.ST_FONT}`,s.textAlign="center",s.fillText(this.PDF_DATA.ST_HVTCK,F.x+F.w/2,F.y+(this.PDF_DATA.MAIN_FONT_SIZE+20)),s.fillText(this.PDF_DATA.ST_HVTCK_LINE_2+" 1",F.x+F.w/2,F.y+this.PDF_DATA.MAIN_FONT_SIZE+20+10+this.PDF_DATA.MAIN_FONT_SIZE),s.fillText(this.PDF_DATA.ST_HVTCK,tt.x+tt.w/2,tt.y+(this.PDF_DATA.MAIN_FONT_SIZE+20)),s.fillText(this.PDF_DATA.ST_HVTCK_LINE_2+" 2",tt.x+tt.w/2,tt.y+this.PDF_DATA.MAIN_FONT_SIZE+20+10+this.PDF_DATA.MAIN_FONT_SIZE),s.closePath(),n.w=e,n.h=tt.y+tt.h-n.y,n}_sizeTableMatrixDetach(s,e,n){return{x:0,y:0,w:s*(e+1),h:s*(n+1)+this.PDF_DATA.ITEM_SQUARE_WIDTH}}_drawTableLineItem(s,e,n,i,a,r,l){const c=[];for(let _=1;_<=i;_++)c.push({x:_*r+a.x,y:l*r+a.y,w:this.PDF_DATA.ITEM_DRAW_DIAMETER,h:this.PDF_DATA.ITEM_DRAW_DIAMETER}),1===_&&(s.beginPath(),s.font=n?`${this.PDF_DATA.MAIN_FONT_SIZE}px ${this.PDF_DATA.ST_FONT}`:`${this.PDF_DATA.MAIN_FONT_SIZE/3*2}px ${this.PDF_DATA.ST_FONT}`,s.textAlign="center",s.strokeStyle="black",s.textBaseline="middle",s.fillText(e.toString(),a.x,l*r+a.y),s.closePath(),e++);c.forEach(_=>{s.beginPath(),s.lineWidth=this.PDF_DATA.WRAPPER_SCALL/3*1,s.strokeStyle="black",s.arc(_.x,_.y,_.w/2,0,2*Math.PI),s.stroke(),s.closePath()})}_drawTableMatrixDetach(s,e,n,i,a,r,l,c){const _={x:l+this.PDF_DATA.ITEM_SQUARE_WIDTH/2,y:c+this.PDF_DATA.ITEM_SQUARE_WIDTH/2,w:e*(n+1),h:e*(i+1)};if(r&&this.PDF_DATA.REAL_NUMBER_QUESTION>0)for(let d=1;d<=n;d++)s.beginPath(),s.font=`bold ${this.PDF_DATA.MAIN_FONT_SIZE/3*2}px ${this.PDF_DATA.ST_FONT}`,s.lineWidth=this.PDF_DATA.WRAPPER_SCALL/3*1,s.strokeStyle="black",s.arc(d*e+_.x,_.y,this.PDF_DATA.ITEM_CHAR_DIAMETER/2,0,2*Math.PI),s.stroke(),s.textAlign="center",s.textBaseline="middle",s.fillText(String.fromCharCode(64+d),d*e+_.x,_.y),s.closePath();for(let d=1;d<=i;d++)this.PDF_DATA.REAL_NUMBER_QUESTION>0&&this._drawTableLineItem(s,a,r,n,_,e,d),a+=1,r&&this.PDF_DATA.REAL_NUMBER_QUESTION--;return s.beginPath(),s.fillStyle="black",s.fillRect(l,c,this.PDF_DATA.ITEM_SQUARE_WIDTH,this.PDF_DATA.ITEM_SQUARE_WIDTH),s.fillRect(l,c+_.h,this.PDF_DATA.ITEM_SQUARE_WIDTH,this.PDF_DATA.ITEM_SQUARE_WIDTH),s.closePath(),_}_drawMatrixCodex10(s,e,n,i,a){const r={x:n,y:i,w:e*this.PDF_DATA.DISTANCE_CODE_CIRCLE,h:0};s.beginPath(),s.font=`${this.PDF_DATA.MAIN_FONT_SIZE}px ${this.PDF_DATA.ST_FONT}`,s.textAlign="left",s.textBaseline="bottom",s.strokeStyle="black",s.fillText(a,n,i+this.PDF_DATA.MAIN_FONT_SIZE);for(let _=0;_<e;_++)s.lineWidth=this.PDF_DATA.WRAPPER_SCALL/3*1,s.strokeRect(n+_*this.PDF_DATA.DISTANCE_CODE_CIRCLE,i+this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT/2,this.PDF_DATA.DISTANCE_CODE_CIRCLE,this.PDF_DATA.DISTANCE_CODE_CIRCLE+this.PDF_DATA.WRAPPER_LINE_HEIGHT/2);let c=this._drawTableMatrixDetach(s,this.PDF_DATA.DISTANCE_CODE_CIRCLE,e,10,0,!1,n-this.PDF_DATA.DISTANCE_CODE_CIRCLE,i+this.PDF_DATA.MAIN_FONT_SIZE+this.PDF_DATA.WRAPPER_LINE_HEIGHT+this.PDF_DATA.DISTANCE_CODE_CIRCLE+this.PDF_DATA.WRAPPER_LINE_HEIGHT/2);return s.closePath(),r.h=c.h+c.y-i,r}_drawHeaderBoxCode(s,e){const n={x:0,y:0,w:0,h:0},a=this._drawMatrixCodex10(s,4,this.PDF_DATA.POINTER_WRAPPER.box_infomation.x+this.PDF_DATA.POINTER_WRAPPER.box_infomation.w+this.PDF_DATA.WRAPPER_LINE_HEIGHT+.8*this.PDF_DATA.ROOT_SQUARE_WIDTH-this.PDF_DATA.ROOT_SQUARE_WIDTH/2+this.PDF_DATA.WRAPPER_LINE_HEIGHT,this.PDF_DATA.CURSOR_POINTER_Y,this.PDF_DATA.ST_SBD),l=this._drawMatrixCodex10(s,3,a.x+a.w+2*this.PDF_DATA.WRAPPER_MARGIN+.8*this.PDF_DATA.ROOT_SQUARE_WIDTH,this.PDF_DATA.CURSOR_POINTER_Y,this.PDF_DATA.ST_MDT);return n.x=a.x,n.y=a.y,n.w=l.x+l.w-a.x,n.h=l.y+l.h-a.y,n}_makeHeader(s){this.PDF_DATA.POINTER_WRAPPER.title=this._drawHeaderTitle(s);const e=(this.PDF_DATA.POINTER_WRAPPER.root_detach_range.w-this.PDF_DATA.ROOT_SQUARE_WIDTH)/10*7.2,n=this.PDF_DATA.POINTER_WRAPPER.root_detach_range.w+this.PDF_DATA.ROOT_SQUARE_WIDTH-e;this.PDF_DATA.CURSOR_POINTER_Y+=this.PDF_DATA.POINTER_WRAPPER.title.h+this.PDF_DATA.WRAPPER_LINE_HEIGHT+200,this.PDF_DATA.POINTER_WRAPPER.box_infomation=this._drawHeaderBoxInfomation(s,e),this.PDF_DATA.CURSOR_POINTER_Y=this.PDF_DATA.POINTER_WRAPPER.title.y+this.PDF_DATA.POINTER_WRAPPER.title.h+this.PDF_DATA.WRAPPER_LINE_HEIGHT+200,this.PDF_DATA.POINTER_WRAPPER.code=this._drawHeaderBoxCode(s,n-this.PDF_DATA.WRAPPER_LINE_HEIGHT)}_makeBody(s,e){const n=Math.ceil(this.PDF_DATA.NUMBER_QUESTION/24),i=this._sizeTableMatrixDetach(this.PDF_DATA.DISTANCE_ANSWERS_CIRCLE,4,24),a=this.PDF_DATA.POINTER_WRAPPER.root_detach_range.x+this.PDF_DATA.DISTANCE_CORNER_SQUARE_X,r=this.PDF_DATA.POINTER_WRAPPER.root_detach_range.y+this.PDF_DATA.POINTER_WRAPPER.root_detach_range.h-this.PDF_DATA.DISTANCE_CORNER_SQUARE_Y-i.h,l=(this.PDF_DATA.POINTER_WRAPPER.root_detach_range.w-2*this.PDF_DATA.DISTANCE_CORNER_SQUARE_X-i.w*n)/(n-1);for(let c=1;c<=n;c++)this._drawTableMatrixDetach(s,this.PDF_DATA.DISTANCE_ANSWERS_CIRCLE,4,24,e+24*(c-1)+1,!0,c>1?a+i.w*(c-1)+l*(c-1):a+i.w*(c-1),r)}_makeDrawLogo(s){return new Promise(e=>{e(!1)})}_makeNote(s){let e=this.PDF_DATA.POINTER_WRAPPER.box_infomation.y+this.PDF_DATA.POINTER_WRAPPER.box_infomation.h+25*this.PDF_DATA.WRAPPER_SCALL,n=this.PDF_DATA.POINTER_WRAPPER.root_detach_range.x+this.PDF_DATA.DISTANCE_CORNER_SQUARE_X;s.beginPath(),s.textAlign="left",s.fillStyle="black",s.font=`bold ${.8*this.PDF_DATA.MAIN_FONT_SIZE}px ${this.PDF_DATA.ST_FONT}`,s.fillText(this.PDF_DATA.ST_NOTE_L_1,n,e),s.font=`${.8*this.PDF_DATA.MAIN_FONT_SIZE}px ${this.PDF_DATA.ST_FONT}`,s.fillText(this.PDF_DATA.ST_NOTE_L_2,n,e+.8*this.PDF_DATA.MAIN_FONT_SIZE+.3*this.PDF_DATA.WRAPPER_LINE_HEIGHT),s.fillText(this.PDF_DATA.ST_NOTE_L_3,n,e+2*(.8*this.PDF_DATA.MAIN_FONT_SIZE+.3*this.PDF_DATA.WRAPPER_LINE_HEIGHT)),s.closePath()}exportPdf(s){if(!1===Bi.IS_DEBUG){var e=new Cd.default("p","px","a4",!0),n=e.internal.pageSize.getWidth(),i=e.internal.pageSize.getHeight();e.addImage(this.PDF_DATA.CANVAS_ELEMENT,"JPEG",0,0,n,i),e.save(s)}}}class yd{constructor(s,e,n,i){this.WRAPPER_SCALL=10,this.WRAPPER_SIZE_WIDTH=595,this.WRAPPER_SIZE_HEIGHT=842,this.R_WRAPPER_SIZE_WIDTH=595,this.R_WRAPPER_SIZE_HEIGHT=842,this.WRAPPER_MARGIN=15,this.WRAPPER_LINE_HEIGHT=12,this.MAIN_FONT_SIZE=10,this.ROOT_SQUARE_WIDTH=20,this.ITEM_SQUARE_WIDTH=15,this.ITEM_DRAW_DIAMETER=10,this.ITEM_CHAR_DIAMETER=9,this.DISTANCE_ANSWERS_CIRCLE=17,this.DISTANCE_CODE_CIRCLE=13,this.DISTANCE_CORNER_SQUARE_X=5,this.DISTANCE_CORNER_SQUARE_Y=24,this.isNextDraw=!0,this.numberDrawed=0,this.NUMBER_QUESTION=120,this.REAL_NUMBER_QUESTION=120,this.START_QUESTION_COUNTER=0,this.EXAM_CODE_LENGTH=4,this.CURSOR_POINTER_Y=0,this.DRAW_LOGO=!0,this.ST_FONT="Arial",this.ST_BIG_TITLE="Phi\u1ebfu tr\u1ea3 l\u1eddi tr\u1eafc nghi\u1ec7m",this.ST_SUB_TITLE="K\u1ef3 thi: ",this.ST_BAI_THI="B\xe0i thi: ",this.ST_NGAY_THI="Ng\xe0y thi: ",this.ST_HDT="1. H\u1ed9i \u0111\u1ed3ng thi: ",this.ST_DT="2. \u0110i\u1ec3m thi: ",this.ST_PTS="3. Ph\xf2ng thi s\u1ed1: ",this.ST_HVTTS="4. H\u1ecd v\xe0 t\xean: ",this.ST_NS="5. Ng\xe0y sinh [] (Nam/N\u1eef) .............",this.ST_CKCTT="6. Ch\u1eef k\xfd c\u1ee7a th\xed sinh: ",this.ST_HVTCK="H\u1ecd t\xean v\xe0 ch\u1eef k\xfd",this.ST_HVTCK_LINE_2="c\xe1n b\u1ed9 coi thi",this.ST_SBD="7. S\u1ed1 b\xe1o danh",this.ST_MDT="8. M\xe3 \u0111\u1ec1 thi",this.ST_NOTE_L_1="L\u01b0u \xfd:",this.ST_NOTE_L_2="- Gi\u1eef phi\u1ebfu ph\u1eb3ng, kh\xf4ng b\xf4i b\u1ea9n, t\u1ea7y xo\xe1, nh\xe0u n\xe1t, l\xe0m r\xe1ch, ghi \u0111\xe8 l\xean c\xe1c \xf4 Vu\xf4ng \u0111en \u0111\u1ec3 ph\u1ea7n m\u1ec1m ch\u1ea5m t\u1ef1 \u0111\u1ed9ng.",this.ST_NOTE_L_3="- D\xf9ng b\xfat ch\xec (ho\u1eb7c b\xfat t\u1ed1i m\xe0u) t\xf4 \u0111\u1eadm v\xe0 k\xedn m\u1ed9t \xf4 tr\xf2n t\u01b0\u01a1ng \u1ee9ng M\xe3 \u0111\u1ec1, S\u1ed1 b\xe1o danh, v\xe0 \u0110\xe1p \xe1n \u0111\xfang cho t\u1eebng c\xe2u tr\u1eafc nghi\u1ec7m.",this.__makeScall(),this.REAL_NUMBER_QUESTION=null!=s?s:this.NUMBER_QUESTION,this.START_QUESTION_COUNTER=null!=e?e:this.START_QUESTION_COUNTER,this.EXAM_CODE_LENGTH=null!=n?n:this.EXAM_CODE_LENGTH,this.DRAW_LOGO=null!=i?i:this.DRAW_LOGO,this.POINTER_WRAPPER=new kd}__makeScall(){this.WRAPPER_SIZE_WIDTH*=this.WRAPPER_SCALL,this.WRAPPER_SIZE_HEIGHT*=this.WRAPPER_SCALL,this.WRAPPER_MARGIN*=this.WRAPPER_SCALL,this.WRAPPER_LINE_HEIGHT*=this.WRAPPER_SCALL,this.MAIN_FONT_SIZE*=this.WRAPPER_SCALL,this.ROOT_SQUARE_WIDTH*=this.WRAPPER_SCALL,this.ITEM_SQUARE_WIDTH*=this.WRAPPER_SCALL,this.ITEM_DRAW_DIAMETER*=this.WRAPPER_SCALL,this.ITEM_CHAR_DIAMETER*=this.WRAPPER_SCALL,this.DISTANCE_ANSWERS_CIRCLE*=this.WRAPPER_SCALL,this.DISTANCE_CODE_CIRCLE*=this.WRAPPER_SCALL,this.DISTANCE_CORNER_SQUARE_X*=this.WRAPPER_SCALL,this.DISTANCE_CORNER_SQUARE_Y*=this.WRAPPER_SCALL}getCenterPointer(){return this.WRAPPER_SIZE_WIDTH/2}resetSetting(){this.CANVAS_ELEMENT=document.createElement("canvas"),this.CANVAS_ELEMENT.width=this.WRAPPER_SIZE_WIDTH,this.CANVAS_ELEMENT.height=this.WRAPPER_SIZE_HEIGHT,Bi.IS_DEBUG&&(this.CANVAS_ELEMENT.style.width="100%",document.body.appendChild(this.CANVAS_ELEMENT));const s=this.CANVAS_ELEMENT.getContext("2d");this.CURSOR_POINTER_Y=0,s&&(s.beginPath(),s.fillStyle="white",s.fillRect(0,0,this.CANVAS_ELEMENT.width,this.CANVAS_ELEMENT.height),s.closePath())}}class kd{constructor(){this.root_detach_ranges=new Array,this.root_detach_range={x:0,y:0,w:0,h:0},this.title={x:0,y:0,w:0,h:0},this.box_infomation={x:0,y:0,w:0,h:0},this.code={x:0,y:0,w:0,h:0}}getRootDetachRange(){this.root_detach_range={x:this.root_detach_ranges[0].x+this.root_detach_ranges[0].w,y:this.root_detach_ranges[0].y,w:this.root_detach_ranges[1].x-this.root_detach_ranges[0].x-this.root_detach_ranges[0].w,h:this.root_detach_ranges[2].y-this.root_detach_ranges[0].y}}}let Bi=(()=>{class o{}return o.IS_DEBUG=!1,o})();class gi{constructor(s){this.x=s.x,this.y=s.y,this.w=s.w,this.h=s.h}drawReact(s,e){s.beginPath(),s.fillStyle=e,s.fillRect(this.x,this.y,this.w,this.h),s.closePath()}}class Dn{constructor(){this.linkDataFile=""}initPdfData(s){return this.linkDataFile=s,this}createAnswerSheet(){return new Nn.y(s=>{s.next({success:1,message:"success"}),s.complete()})}exportPdf(s){hi.saveAs(this.linkDataFile,s)}}let Ji=(()=>{class o{constructor(e){this.cdnService=e}createAzoAnswerSheet(e){const n=new Ad;return this.creator=n.initPdfData(e),this}createAnswerSheet(){return new Nn.y(e=>{this.creator?this.creator.createAnswerSheet().subscribe(n=>{1===n.success?(e.next({success:1,message:"successful"}),e.complete()):(e.next({success:0,message:n.message}),e.complete())}):(e.next({success:0,message:"Not find creator"}),e.complete())})}createMinistryAnswerSheet(){const e=new Dn;return this.creator=e.initPdfData(this.cdnService.convertLinkCdn("azota_assets/medias/answer_sheet_pdf/answersheet_mau_a4_bo_giao_duc_120.pdf")),this}createAzotaAnswerSheet_A4_120(){const e=new Dn;return this.creator=e.initPdfData(this.cdnService.convertLinkCdn("azota_assets/medias/answer_sheet_pdf/answersheet_mau_a4_120.pdf")),this}createSmallAzotaAnswerSheet_A6_50(){const e=new Dn;return this.creator=e.initPdfData(this.cdnService.convertLinkCdn("azota_assets/medias/answer_sheet_pdf/answersheet_mau_a6_full_a4_50.pdf")),this}createSmallAzotaAnswerSheet_A6_20(){const e=new Dn;return this.creator=e.initPdfData(this.cdnService.convertLinkCdn("azota_assets/medias/answer_sheet_pdf/answersheet_mau_a6_full_a4_20.pdf")),this}createSmallAzotaAnswerSheet_A8_20(){const e=new Dn;return this.creator=e.initPdfData(this.cdnService.convertLinkCdn("azota_assets/medias/answer_sheet_pdf/answersheet_mau_a8_full_a4_20.pdf")),this}createThirtyFiveMultipleAndEssayAzotaAnswerSheet_35(){const e=new Dn;return this.creator=e.initPdfData(this.cdnService.convertLinkCdn("azota_assets/medias/answer_sheet_pdf/answersheet_mau_a4_hon_hop_35.pdf")),this}exportPdf(e){this.creator&&this.creator.exportPdf(e+".pdf")}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(Ke.U))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var hn=b(2366),Od=b(15816),Gn=b(28293);function Sd(o,s){1&o&&(t.TgZ(0,"div"),t.O4$(),t.TgZ(1,"svg",2)(2,"g",3)(3,"g",4),t._UZ(4,"circle",5),t.TgZ(5,"path",6),t._UZ(6,"animateTransform",7),t.qZA()()()()())}function Ed(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",13)(1,"p",14),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"p",15),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"button",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.clickNumbering())}),t.O4$(),t.TgZ(8,"svg",17),t._UZ(9,"path",18)(10,"polyline",19)(11,"path",20),t.qZA(),t._uU(12),t.ALo(13,"mytranslate"),t.qZA()()}2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,3,"lang_auto_ban_co_muon_danh_so_bao_danh_cho_hoc_sinh")," "),t.xp6(3),t.hij(" ",t.lcZ(6,5,"lang_auto_neu_hoc_sinh_duoc_danh_so_bao_danh_khi_azota_cham_bai_tu_phieu_tra_loi_diem_se_duoc_tu_dong_ghep_vao_dung_hoc_sinh_trong_danh_sach_lop_cua_ban")," "),t.xp6(7),t.hij(" ",t.lcZ(13,7,"lang_auto_danh_so_bao_danh")," "))}function Id(o,s){1&o&&(t.TgZ(0,"div",47),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_test_config_you_not_yet_class")," "))}function Zd(o,s){if(1&o&&(t.TgZ(0,"div",45),t.YNc(1,Id,3,3,"div",46),t.qZA()),2&o){const e=t.oxw(4);t.xp6(1),t.Q6J("ngIf",e.form.controls.classroomIds.errors.checkboxValidator)}}function Md(o,s){if(1&o&&(t.TgZ(0,"div",48)(1,"span"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o){const e=t.oxw(4);t.xp6(2),t.AsE("",t.lcZ(3,2,"lang_auto_yeu_cau_nhap_so_va_be_nhat_la_1_max_999999")," ",e.calcMaxIndexInput(),"")}}function Pd(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",49)(2,"g",3)(3,"g",4),t._UZ(4,"circle",5),t.TgZ(5,"path",6),t._UZ(6,"animateTransform",7),t.qZA()()()()())}const Ld=function(o){return{suppressScrollX:!0,suppressScrollY:o}};function Nd(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",21)(1,"div",22)(2,"h3",23),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.TgZ(5,"div",24),t._UZ(6,"azt-list-classroom-checkall",25),t.qZA()(),t.TgZ(7,"div",26)(8,"div",27)(9,"perfect-scrollbar",28),t.ALo(10,"isMobileOrTable"),t._UZ(11,"azt-list-classroom-checkbox",29),t.qZA()(),t.YNc(12,Zd,2,1,"div",30),t.qZA()(),t.TgZ(13,"div",31)(14,"div",32)(15,"label",33),t._uU(16),t.ALo(17,"mytranslate"),t.O4$(),t.TgZ(18,"svg",34),t.ALo(19,"mytranslate"),t._UZ(20,"circle",35)(21,"line",36)(22,"line",37),t.qZA()(),t.kcU(),t.TgZ(23,"div",38)(24,"input",39),t.NdJ("input",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.checkValidFormIdentify(i))}),t.ALo(25,"mytranslate"),t.qZA()(),t.YNc(26,Md,4,4,"div",40),t.qZA(),t.TgZ(27,"div",41)(28,"button",42),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.checkNumbering=!1)}),t._uU(29),t.ALo(30,"mytranslate"),t.qZA(),t.TgZ(31,"button",43),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.savePrintExam())}),t.YNc(32,Pd,7,0,"span",44),t._uU(33),t.ALo(34,"mytranslate"),t.qZA()()()}if(2&o){const e=t.oxw(3);t.xp6(3),t.hij(" ",t.lcZ(4,19,"lang_auto_danh_so_bao_danh")," "),t.xp6(3),t.Q6J("form",e.form)("objs",e.classroomObjs)("permissionName",e.permissionTypes.exam),t.xp6(3),t.Q6J("config",t.VKq(33,Ld,t.lcZ(10,21,"")))("scrollIndicators",!0),t.xp6(2),t.Q6J("form",e.form)("objs",e.classroomObjs)("examClassroomObjs",e.examClassroomObjs)("permissionName",e.permissionTypes.exam),t.xp6(1),t.Q6J("ngIf",e.form.controls.classroomIds.errors),t.xp6(4),t.hij(" ",t.lcZ(17,23,"lang_auto_nhap_so_bao_danh_bat_dau")," "),t.xp6(2),t.s9C("matTooltip",t.lcZ(19,25,"lang_tooltip_input_identification_numbering")),t.xp6(6),t.s9C("placeholder",t.lcZ(25,27,"lang_auto_nhap_so_bao_danh_bat_dau")),t.xp6(2),t.Q6J("ngIf",e.form.controls.startIdentifyIndex.errors||e.form.controls.startIdentifyIndex.invalid||!e.validFormIdentify),t.xp6(3),t.hij(" ",t.lcZ(30,29,"lang_auto_huy")," "),t.xp6(2),t.Q6J("disabled",e.form.invalid||!e.validFormIdentify),t.xp6(1),t.Q6J("ngIf",e.loadingConfig),t.xp6(1),t.hij(" ",t.lcZ(34,31,"lang_auto_tiep_tuc")," ")}}function Dd(o,s){if(1&o&&(t.TgZ(0,"div",10),t.YNc(1,Ed,14,9,"div",11),t.YNc(2,Nd,35,35,"ng-template",null,12,t.W1O),t.qZA()),2&o){const e=t.MAs(3),n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!n.checkNumbering)("ngIfElse",e)}}function jd(o,s){1&o&&(t.TgZ(0,"p",53),t.O4$(),t.TgZ(1,"svg",54),t._UZ(2,"path",18)(3,"polyline",19)(4,"path",55)(5,"rect",56)(6,"path",57),t.qZA(),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()),2&o&&(t.xp6(7),t.hij(" ",t.lcZ(8,1,"lang_auto_file_danh_sach_so_bao_danh")," "))}function qd(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",49)(2,"g",3)(3,"g",4),t._UZ(4,"circle",5),t.TgZ(5,"path",6),t._UZ(6,"animateTransform",7),t.qZA()()()()())}function Qd(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",17),t._UZ(1,"path",62)(2,"polyline",63)(3,"line",64),t.qZA())}function Ud(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",58),t._UZ(1,"input",59),t.TgZ(2,"button",60),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.printStudentCode())}),t.YNc(3,qd,7,0,"span",0),t.YNc(4,Qd,4,0,"ng-template",null,61,t.W1O),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()}if(2&o){const e=t.MAs(5),n=t.oxw(3);t.xp6(1),t.s9C("value",n.createExportStudentCodeName(!1)),t.xp6(2),t.Q6J("ngIf",n.isLoadingPrintCodeStudent)("ngIfElse",e),t.xp6(3),t.hij(" ",t.lcZ(7,4,"lang_auto_tai_ve")," ")}}const Fd=function(o){return{"text-left":o}};function Rd(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",65)(1,"button",66),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.clickNumbering())}),t.O4$(),t.TgZ(2,"svg",17),t._UZ(3,"path",67)(4,"path",68)(5,"path",69)(6,"path",70),t.qZA(),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()()}if(2&o){const e=t.oxw(3);t.Q6J("ngClass",t.VKq(4,Fd,1==e.styleView)),t.xp6(7),t.hij(" ",t.lcZ(8,2,"lang_auto_danh_lai_sbd")," ")}}function Bd(o,s){if(1&o&&(t.TgZ(0,"div",10),t.YNc(1,jd,9,3,"p",50),t.YNc(2,Ud,8,6,"div",51),t.YNc(3,Rd,9,6,"div",52),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.checkNumbering),t.xp6(1),t.Q6J("ngIf",!e.checkNumbering),t.xp6(1),t.Q6J("ngIf",!e.checkNumbering)}}function Jd(o,s){if(1&o&&(t.TgZ(0,"form",8),t.YNc(1,Dd,4,2,"div",9),t.YNc(2,Bd,4,3,"div",9),t.qZA()),2&o){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(1),t.Q6J("ngIf",!e.checkDownloadSBD&&!e.checkStudentCode||e.checkNumbering),t.xp6(1),t.Q6J("ngIf",e.checkDownloadSBD||e.checkStudentCode)}}let Eo=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l){super(e),this.commonService=e,this.documentConfigService=n,this.formBuilder=i,this.offlineStudentCodeService=a,this.printAnswersheetService=r,this.sEAztClassroomCheckboxService=l,this.form=new h.nJ({}),this.hashId="",this.styleView=0,this.checkStudentCode=!1,this.examObj=void 0,this.permissionTypes=en.$,this.checkNumbering=!1,this.checkDownloadSBD=!1,this.classroomObjs=[],this.examClassroomObjs=[],this.isLoadingPrintCodeStudent=!1,this.loadingConfig=!1,this.showAdvanceSetting=!1,this.validFormIdentify=!0}createExportStudentCodeName(e){var n,i,a,r,l,c=this.printAnswersheetService.exportFileNameOfStudentCode(1,null!==(i=null===(n=this.examObj)||void 0===n?void 0:n.name)&&void 0!==i?i:"",null!==(r=null===(a=this.examObj)||void 0===a?void 0:a.hashId)&&void 0!==r?r:"");return e&&(c=null!==(l=this.commonService.replaceAll(c,"_","-"))&&void 0!==l?l:""),c}clickNumbering(){this.checkNumbering=!0}showInputAdvanceSetting(){this.showAdvanceSetting=!this.showAdvanceSetting}savePrintExam(){this.loadingConfig=!0;let e=this.commonService.getFormObj(this.form);var n=this.sEAztClassroomCheckboxService.findClassroomWithNoPermission(this.classroomObjs,en.$.exam);const i=this.sEAztClassroomCheckboxService.getClassroomIdsChecked(this.classroomObjs,n,e.classroomIds);let a=e.startIdentifyIndex>0?e.startIdentifyIndex:1;this.subscriptions.add(this.documentConfigService.apiDocumentConfigSaveExamConfigPost({whoAllow:2,classroomIds:i},this.hashId).subscribe(l=>{var c;1==l.success?this.offlineStudentCodeService.apiOfflineStudentCodeResetStudentCodesGet(this.hashId,a).subscribe(_=>{var d,m;1==_.success?(this.checkDownloadSBD=!0,this.checkNumbering=!1,this.loadingConfig=!1,this.getExamDataByHashId(null!==(d=this.hashId)&&void 0!==d?d:"")):(this.errorStatusObj(null!==(m=_.message)&&void 0!==m?m:"",!0),this.loadingConfig=!1)}):(this.errorStatusObj(null!==(c=l.message)&&void 0!==c?c:"",!0),this.loadingConfig=!1)}))}printStudentCode(){this.isLoadingPrintCodeStudent=!0,this.subscriptions.add(this.offlineStudentCodeService.apiOfflineStudentCodeCreateStudentCodesGet(this.hashId).subscribe(e=>{var n,i,a;1==e.success?(this.printAnswersheetService.printStudentCode(this.examObj,null!==(i=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.objs)&&void 0!==i?i:[]),this.isLoadingPrintCodeStudent=!1):(this.isLoadingPrintCodeStudent=!1,this.errorStatusObj(null!==(a=e.message)&&void 0!==a?a:"",!0))}))}calcMaxIndexInput(){let e=this.commonService.getFormObj(this.form);var n=this.sEAztClassroomCheckboxService.findClassroomWithNoPermission(this.classroomObjs,en.$.exam);const i=this.sEAztClassroomCheckboxService.getClassroomIdsChecked(this.classroomObjs,n,e.classroomIds);let a=999999;return this.classroomObjs.forEach(r=>{var l;this.commonService.filterArray(i,r.id)&&(a-=null!==(l=r.countStudents)&&void 0!==l?l:0)}),a}checkValidFormIdentify(e){this.validFormIdentify=e.target instanceof HTMLInputElement&&Number(e.target.value)<=this.calcMaxIndexInput()}getExamDataByHashId(e){this.initStatusObj(),this.subscriptions.add(this.documentConfigService.apiDocumentConfigGetExamConfigDataGet(e).subscribe(n=>{var i,a,r;1==n.success?null!=n.data&&(this.examObj=n.data.examObj,this.classroomObjs=null!==(i=n.data.classroomObjs)&&void 0!==i?i:new Array,this.examClassroomObjs=null!==(a=n.data.examClassroomObjs)&&void 0!==a?a:[],this.successStatusObj()):this.errorStatusObj(null!==(r=n.message)&&void 0!==r?r:"",!0)}))}ngOnInit(){this.hashId&&this.getExamDataByHashId(this.hashId),this.form=this.formBuilder.group({classroomIds:this.formBuilder.array([]),startIdentifyIndex:new h.p4(1,[h.kI.min(1),h.kI.max(999999),h.kI.pattern(/^[0-9]*$/)]),whoAllow:new h.p4(2)},{validators:[Li.h.classroomCheckBoxValidator]}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Ot.Cq),t.Y36(h.qu),t.Y36(Ot.MH),t.Y36(pi.Y),t.Y36(Ni.L))},o.\u0275cmp=t.Xpm({type:o,selectors:[["numbering-identification"]],inputs:{hashId:"hashId",styleView:"styleView",checkStudentCode:"checkStudentCode"},features:[t.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["doneLoading",""],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","rgb(30, 41, 59)",1,"w-8","h-8"],["fill","none","fill-rule","evenodd"],["transform","translate(1 1)","stroke-width","4"],["stroke-opacity",".5","cx","18","cy","18","r","18"],["d","M36 18c0-9.94-8.06-18-18-18"],["attributeName","transform","type","rotate","from","0 18 18","to","360 18 18","dur","1s","repeatCount","indefinite"],[3,"formGroup"],["class","app",4,"ngIf"],[1,"app"],["class","p-3 bg-slate-100 dark:bg-darkmode-600 rounded-md",4,"ngIf","ngIfElse"],["numbering",""],[1,"p-3","bg-slate-100","dark:bg-darkmode-600","rounded-md"],[1,"text-md","font-medium"],[1,"text-xs","text-slate-700","mt-1"],[1,"btn","btn-outline-primary","mt-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["d","M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"],["points","14 2 14 8 20 8"],["d","m3 15 2 2 4-4"],[1,"border","border-slate-200/60","dark:border-darkmode-400","rounded-md","pb-1"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","items-center"],[1,"mr-auto"],[1,"flex"],["formArrayName","classroomIds",3,"form","objs","permissionName"],[1,"main-numbering"],[2,"height","250px"],[3,"config","scrollIndicators"],["formArrayName","classroomIds",3,"form","objs","examClassroomObjs","permissionName"],["class","w-full p-2",4,"ngIf"],[1,"grid","grid-cols-12","gap-2","justify-between","numbering-identification"],[1,"col-span-12","md:col-span-6","mt-3"],["for","regular-form-1",1,"form-label","mb-0","font-medium","flex","items-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","ml-2",3,"matTooltip"],["cx","12","cy","12","r","10"],["x1","12","y1","16","x2","12","y2","12"],["x1","12","y1","8","x2","12.01","y2","8"],[1,"flex","items-center"],["type","text","step","1","min","1","max","999999","formControlName","startIdentifyIndex",1,"intro-x","login__input","form-control","py-2","px-2","block","w-4/5",3,"placeholder","input"],["class","text-danger text-xs mt-2 font-medium",4,"ngIf"],[1,"col-span-12","md:col-span-6","items-center","text-right","mt-3"],[1,"btn","btn-secondary","mr-2",3,"click"],[1,"btn","btn-primary-soft",3,"disabled","click"],[4,"ngIf"],[1,"w-full","p-2"],["class","text-left text-danger",4,"ngIf"],[1,"text-left","text-danger"],[1,"text-danger","text-xs","mt-2","font-medium"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","white",1,"w-4","h-4","mr-2"],["class","font-medium flex items-center intro-x",4,"ngIf"],["class","relative mt-2 intro-x",4,"ngIf"],["class","mt-3",3,"ngClass",4,"ngIf"],[1,"font-medium","flex","items-center","intro-x"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2","text-success"],["d","M10 12h2v6"],["x","2","y","12","width","4","height","6"],["d","M10 18h4"],[1,"relative","mt-2","intro-x"],["type","text","readonly","",1,"form-control","py-3","px-4","border-transparent","bg-slate-100","pr-10",2,"padding-right","120px",3,"value"],[1,"btn","btn-primary","absolute","my-auto","inset-y-0","right-0",2,"border-top-left-radius","0","border-bottom-left-radius","0",3,"click"],["donePrintCodeLoading",""],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","7 10 12 15 17 10"],["x1","12","y1","15","x2","12","y2","3"],[1,"mt-3",3,"ngClass"],[1,"btn","btn-outline-secondary",3,"click"],["d","M21 2v6h-6"],["d","M3 12a9 9 0 0 1 15-6.7L21 8"],["d","M3 22v-6h6"],["d","M21 12a9 9 0 0 1-15 6.7L3 16"]],template:function(e,n){if(1&e&&(t.YNc(0,Sd,7,0,"div",0),t.YNc(1,Jd,3,3,"ng-template",null,1,t.W1O)),2&e){const i=t.MAs(2);t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.mk,O.O5,Wt.gM,Lt.Vv,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,h.CE,oe.M,ri.o,li.g,at.bT,at.bd],encapsulation:2}),o})();const Hd=["table"];function zd(o,s){if(1&o&&(t.TgZ(0,"td",6),t._uU(1),t.ALo(2,"formatOfflineExamHashIdToNumber"),t.qZA()),2&o){const e=s.$implicit,n=s.index;t.uIk("excelRow",1)("excelColumn",n+1),t.xp6(1),t.hij(" ",t.lcZ(2,3,e.offlineMixquestionHashId)," ")}}function Yd(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",null==e.rightAnswers?null:e.rightAnswers[n]," ")}}function Gd(o,s){if(1&o&&(t.TgZ(0,"td",6),t.YNc(1,Yd,2,1,"span",7),t.qZA()),2&o){const e=s.$implicit,n=s.index,i=t.oxw().$implicit;let a;t.uIk("excelRow",i+2)("excelColumn",n+1),t.xp6(1),t.Q6J("ngIf",(null!==(a=null==e.rightAnswers?null:e.rightAnswers.length)&&void 0!==a?a:0)>i)}}function $d(o,s){if(1&o&&(t.TgZ(0,"tr")(1,"td",3),t._uU(2),t.qZA(),t.YNc(3,Gd,2,3,"td",4),t.qZA()),2&o){const e=s.$implicit,n=t.oxw();t.xp6(1),t.uIk("excelRow",e+2)("excelColumn",0),t.xp6(1),t.hij(" ",e+1," "),t.xp6(1),t.Q6J("ngForOf",n.objs)}}let Wd=(()=>{class o extends mt.Q{constructor(e,n){super(e),this.commonService=e,this.exportExcelService=n,this.exportDataDone=new t.vpe,this.maxQuestionIndex=0,this.totalExamCode=0}calculateMaxQuestion(){let e=0;return this.objs.forEach(n=>{var i,a,r,l;e<(null!==(a=null===(i=n.rightAnswers)||void 0===i?void 0:i.length)&&void 0!==a?a:0)&&(e=null!==(l=null===(r=n.rightAnswers)||void 0===r?void 0:r.length)&&void 0!==l?l:0)}),e}ngOnChanges(){this.maxQuestionIndex=this.calculateMaxQuestion(),this.totalExamCode=this.objs.length}ngAfterViewChecked(){this.objs.length>0&&(this.exportDataDone.emit(this.exportExcelService.exportHtmlTableToExcelBlob(this.table,!0)),this.objs=[])}ngOnInit(){super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Gn.O))},o.\u0275cmp=t.Xpm({type:o,selectors:[["azt-export-excel-for-answersheet"]],viewQuery:function(e,n){if(1&e&&t.Gf(Hd,5),2&e){let i;t.iGM(i=t.CRH())&&(n.table=i.first)}},inputs:{objs:"objs"},outputs:{exportDataDone:"exportDataDone"},features:[t.qOj,t.TTD],decls:14,vars:15,consts:[[1,"table","table-bordered",2,"display","none"],["table",""],["rowspan","2","excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true},"font":{"bold":true}}',1,"text-center","azt-excel-cell"],["excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true},"font":{"bold":true}}',1,"text-center","azt-excel-cell"],["class","text-center azt-excel-cell","excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true}}',4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true}}',1,"text-center","azt-excel-cell"],[4,"ngIf"]],template:function(e,n){1&e&&(t.TgZ(0,"table",0,1)(2,"tbody")(3,"tr")(4,"td",2),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"td",3),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()(),t.TgZ(10,"tr"),t.YNc(11,zd,3,5,"td",4),t.qZA(),t.YNc(12,$d,4,4,"tr",5),t.ALo(13,"createEmptyArray"),t.qZA()()),2&e&&(t.xp6(4),t.uIk("excelRow",0)("excelColumn",0),t.xp6(1),t.hij(" ",t.lcZ(6,9,"lang_testbank_answersheet_question_title")," "),t.xp6(2),t.uIk("colspan",n.totalExamCode)("excelRow",0)("excelColumn",1),t.xp6(1),t.hij(" ",t.lcZ(9,11,"lang_auto_ma_de_thi")," "),t.xp6(3),t.Q6J("ngForOf",n.objs),t.xp6(1),t.Q6J("ngForOf",t.lcZ(13,13,n.maxQuestionIndex)))},dependencies:[O.sg,O.O5,at.bT,at.q7,at.Pr],encapsulation:2}),o})();function Kd(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function Vd(o,s){1&o&&(t.TgZ(0,"span",33),t.O4$(),t.TgZ(1,"svg",34)(2,"g",35)(3,"g",36),t._UZ(4,"circle",37),t.TgZ(5,"path",38),t._UZ(6,"animateTransform",39),t.qZA()()()()())}function Xd(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",40),t._UZ(1,"path",41)(2,"polyline",42)(3,"line",43),t.qZA())}function tu(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.printPdfExam(i.offlineExamObj.hashId,""))}),t.YNc(1,Vd,7,0,"span",22),t.YNc(2,Xd,4,0,"ng-template",null,32,t.W1O),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()}if(2&o){const e=t.MAs(3),n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",n.loadingObj.downloadExam)("ngIfElse",e),t.xp6(3),t.hij(" ",t.lcZ(5,3,"lang_auto_tai_ve")," ")}}function eu(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",44),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.showFormAddInformation=!0)}),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()}2&o&&(t.xp6(1),t.hij("+ ",t.lcZ(2,1,"lang_core_them_thong_tin"),""))}function nu(o,s){1&o&&(t.TgZ(0,"span",33),t.O4$(),t.TgZ(1,"svg",34)(2,"g",35)(3,"g",36),t._UZ(4,"circle",37),t.TgZ(5,"path",38),t._UZ(6,"animateTransform",39),t.qZA()()()()())}function iu(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",40),t._UZ(1,"path",41)(2,"polyline",42)(3,"line",43),t.qZA())}function ou(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"form",45),t._UZ(2,"input",46),t.ALo(3,"mytranslate"),t._UZ(4,"input",47),t.ALo(5,"mytranslate"),t.qZA(),t.TgZ(6,"span",48),t._uU(7),t.ALo(8,"mytranslate"),t.qZA(),t.TgZ(9,"div",49)(10,"button",50),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.printPdfExam(i.offlineExamObj.hashId,""))}),t.YNc(11,nu,7,0,"span",22),t.YNc(12,iu,4,0,"ng-template",null,32,t.W1O),t._uU(14),t.ALo(15,"mytranslate"),t.qZA(),t.TgZ(16,"button",51),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.closeChangeInformation())}),t._uU(17),t.ALo(18,"mytranslate"),t.qZA()()()}if(2&o){const e=t.MAs(13),n=t.oxw(2);t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(1),t.s9C("placeholder",t.lcZ(3,8,"lang_auto_ten_truong")),t.xp6(2),t.s9C("placeholder",t.lcZ(5,10,"lang_auto_mon_hoc_form")),t.xp6(3),t.Oqu(t.lcZ(8,12,"lang_auto_cac_thong_tin_khong_bat_buoc")),t.xp6(4),t.Q6J("ngIf",n.loadingObj.downloadExam)("ngIfElse",e),t.xp6(3),t.hij(" ",t.lcZ(15,14,"lang_auto_tai_ve")," "),t.xp6(3),t.hij(" ",t.lcZ(18,16,"lang_cms_common_close_btn")," ")}}function au(o,s){1&o&&(t.TgZ(0,"span",33),t.O4$(),t.TgZ(1,"svg",34)(2,"g",35)(3,"g",36),t._UZ(4,"circle",37),t.TgZ(5,"path",38),t._UZ(6,"animateTransform",39),t.qZA()()()()())}function su(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",40),t._UZ(1,"path",41)(2,"polyline",42)(3,"line",43),t.qZA())}function ru(o,s){1&o&&(t.TgZ(0,"span",33),t.O4$(),t.TgZ(1,"svg",34)(2,"g",35)(3,"g",36),t._UZ(4,"circle",37),t.TgZ(5,"path",38),t._UZ(6,"animateTransform",39),t.qZA()()()()())}function lu(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",40),t._UZ(1,"path",41)(2,"polyline",42)(3,"line",43),t.qZA())}function cu(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"azt-export-excel-for-answersheet",52),t.NdJ("exportDataDone",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.exportDataDone(i))}),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("objs",e.exportExcelData)}}function _u(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"p",4),t.O4$(),t.TgZ(3,"svg",5),t._UZ(4,"path",6)(5,"polyline",7)(6,"path",8),t.qZA(),t._uU(7),t.ALo(8,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(9,"div",9),t._UZ(10,"input",10),t.YNc(11,tu,6,5,"button",11),t.qZA(),t.TgZ(12,"div",12),t.YNc(13,eu,3,3,"a",13),t.YNc(14,ou,19,18,"div",14),t.qZA()(),t.TgZ(15,"div",15)(16,"p",4),t.O4$(),t.TgZ(17,"svg",16),t._UZ(18,"path",6)(19,"polyline",7)(20,"path",17)(21,"path",18)(22,"path",19)(23,"path",20),t.qZA(),t._uU(24),t.ALo(25,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(26,"div",9),t._UZ(27,"input",10),t.TgZ(28,"button",21),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.printExamAnswersheet(i.offlineExamObj.hashId))}),t.YNc(29,au,7,0,"span",22),t.YNc(30,su,4,0,"ng-template",null,23,t.W1O),t._uU(32),t.ALo(33,"mytranslate"),t.qZA()()(),t.TgZ(34,"div",15)(35,"p",4),t.O4$(),t.TgZ(36,"svg",24),t._UZ(37,"path",6)(38,"polyline",7)(39,"line",25)(40,"line",26)(41,"line",27),t.qZA(),t._uU(42),t.ALo(43,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(44,"div",9),t._UZ(45,"input",10),t.TgZ(46,"button",21),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.exportExcelForAnswerSheet())}),t.YNc(47,ru,7,0,"span",22),t.YNc(48,lu,4,0,"ng-template",null,28,t.W1O),t._uU(50),t.ALo(51,"mytranslate"),t.qZA()()(),t.TgZ(52,"div",15)(53,"div",29),t._UZ(54,"numbering-identification",30),t.ALo(55,"mustInClassroom"),t.qZA()()(),t.YNc(56,cu,1,1,"azt-export-excel-for-answersheet",31)}if(2&o){const e=t.MAs(31),n=t.MAs(49),i=t.oxw();let a;t.xp6(7),t.hij(" ",t.lcZ(8,18,"lang_auto_file_de_thi")," "),t.xp6(3),t.s9C("value",i.createNameExam("exam",!0)),t.xp6(1),t.Q6J("ngIf",0==i.showFormAddInformation),t.xp6(2),t.Q6J("ngIf",0==i.showFormAddInformation),t.xp6(1),t.Q6J("ngIf",1==i.showFormAddInformation),t.xp6(10),t.hij(" ",t.lcZ(25,20,"lang_auto_file_phieu_tra_loi")," "),t.xp6(3),t.s9C("value",i.createNameExam("answersheet",!0)),t.xp6(2),t.Q6J("ngIf",i.loadingObj.downloadAnswerSheet)("ngIfElse",e),t.xp6(3),t.hij(" ",t.lcZ(33,22,"lang_auto_tai_ve")," "),t.xp6(10),t.hij(" ",t.lcZ(43,24,"lang_auto_file_answer_list")," "),t.xp6(3),t.s9C("value",i.createNameExam("answerexcel",!0)),t.xp6(2),t.Q6J("ngIf",i.isLoadingPrintAnswer)("ngIfElse",n),t.xp6(3),t.hij(" ",t.lcZ(51,26,"lang_auto_tai_ve")," "),t.xp6(4),t.Q6J("hashId",i.examObj.hashId)("checkStudentCode",t.lcZ(55,28,null!==(a=i.examObj.whoAllow)&&void 0!==a?a:0)),t.xp6(2),t.Q6J("ngIf",i.exportExcelData)}}let Io=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_,d,m,p,w){super(e),this.commonService=e,this.activeRoute=n,this.fb=i,this.dialog=a,this.printAnswersheetService=r,this.offlineMixquestionService=l,this.answerSheetHelper=c,this.zipdataService=_,this.cdnService=d,this.exportDocxService=m,this.offlineExamExportService=p,this.exportExcelService=w,this.form=new h.nJ({}),this.loadingObj={},this.isLoadingLib=!0,this.isLoadingPrintAnswer=!1,this.showFormAddInformation=!1,this.nameSchool="{TH\xd4NG TIN TR\u01af\u1edcNG}",this.nameSubject="{M\xd4N THI}",this.year="{N\u0102M H\u1eccC}"}closeChangeInformation(){this.showFormAddInformation=!1,this.form=this.fb.group({schoolName:new h.NI(""),subjectName:new h.NI(""),year:new h.NI("")})}createNameExam(e,n){var i,a,r,l,c,_,d,m,p,w,C="";C="answersheet"==e?this.printAnswersheetService.exportFileNameOfAnswerSheet(0,null!==(i=this.examObj.name)&&void 0!==i?i:"",null!==(r=null===(a=this.offlineExamObj)||void 0===a?void 0:a.hashId)&&void 0!==r?r:""):"answerexcel"==e?this.printAnswersheetService.exportFileNameOfAnswerExcelOffline(0,null!==(l=this.examObj.name)&&void 0!==l?l:"",null!==(_=null===(c=this.offlineExamObj)||void 0===c?void 0:c.hashId)&&void 0!==_?_:""):this.printAnswersheetService.exportFileNameOfExamOffline(0,null!==(d=this.examObj.name)&&void 0!==d?d:"",null!==(p=null===(m=this.offlineExamObj)||void 0===m?void 0:m.hashId)&&void 0!==p?p:"",void 0),n&&(C=null!==(w=this.commonService.replaceAll(C,"_","-"))&&void 0!==w?w:"");var A=".docx";return A="answersheet"==e?".pdf":A,C+("answerexcel"==e?".xlsx":A)}printExamAnswersheet(e){var n;this.loadingObj.downloadAnswerSheet=!0,this.subscriptions.add(this.offlineMixquestionService.apiOfflineMixquestionGetObjsGet(null===(n=null==this?void 0:this.examObj)||void 0===n?void 0:n.hashId,e,"").subscribe(i=>{var a,r,l,c,_,d,m,p,w,C;if(1===i.success){let A=this.getTotalQuestionInMixQuestionObjs(null!==(r=null===(a=i.data)||void 0===a?void 0:a.mixQuestionObjs)&&void 0!==r?r:[],null!==(c=null===(l=i.data)||void 0===l?void 0:l.questionObjs)&&void 0!==c?c:[]);if(A){let D=null!==(m=null===(d=null===(_=i.data)||void 0===_?void 0:_.offlineExamObj)||void 0===d?void 0:d.answersheetTemplate)&&void 0!==m?m:0;this.answerSheetHelper=this.printAnswersheetService.chooseAnswerSheetTemplate(this.answerSheetHelper,D,A,0,null===(p=i.data)||void 0===p?void 0:p.maxOfflineMixQuestionHashId);let q=this.createNameExam("answersheet",!1);this.answerSheetHelper.createAnswerSheet().subscribe(U=>{var F;1==U.success?this.answerSheetHelper.exportPdf(q):this.errorStatusObj(null!==(F=i.message)&&void 0!==F?F:"",!0),this.loadingObj.downloadAnswerSheet=!1})}else this.errorStatusObj(null!==(w=i.message)&&void 0!==w?w:"",!0),this.loadingObj.downloadAnswerSheet=!1}else this.errorStatusObj(null!==(C=i.message)&&void 0!==C?C:"",!0),this.loadingObj.downloadAnswerSheet=!1}))}getTotalQuestionInMixQuestionObjs(e,n){if(e.length>0){let i=0;return e.forEach(a=>{var r,l,c;let _=this.zipdataService.decodeContentGzip(null!==(r=null==a?void 0:a.mixDatas)&&void 0!==r?r:""),d=this.castJsonToObj(_);i<(null!==(l=null==d?void 0:d.length)&&void 0!==l?l:0)&&(i=null!==(c=null==d?void 0:d.length)&&void 0!==c?c:0)}),i}return n.length>0?n.length:void 0}printPdfExam(e,n){let i="";this.commonService.myTranslate(["lang_auto_dang_lay_du_lieu_tu_he_thong"]).subscribe(a=>{i=a.lang_auto_dang_lay_du_lieu_tu_he_thong,mn.G.openLoadingEffect(i)}),this.subscriptions.add(this.offlineMixquestionService.apiOfflineMixquestionListMixExamQuestionsGet(this.examObj.hashId,e).subscribe(a=>{var r,l,c,_,d,m,p,w,C,A,M,D;if(1===a.success)if(this.commonService.myTranslate(["lang_auto_dang_xu_ly_du_lieu"]).subscribe(U=>{i=U.lang_auto_dang_xu_ly_du_lieu,mn.G.changeMsgLoadingEffect(i)}),null!==(r=a.data)&&void 0!==r&&r.offlineExamMixQuestions){let U=this.commonService.getFormObj(this.form);var q={nameSchool:U.schoolName,nameSubject:U.subjectName};if(1==(null===(l=a.data)||void 0===l?void 0:l.offlineExamMixQuestions.length)){let F=null!==(d=this.commonService.castJsonToClassObjs(on.v,JSON.stringify(null!==(_=null===(c=a.data)||void 0===c?void 0:c.offlineExamMixQuestions[0].mixQuestions)&&void 0!==_?_:[])))&&void 0!==d?d:[];this.exportDocxService.downloadExam(null!==(m=a.data.exam)&&void 0!==m?m:{},null===(p=a.data)||void 0===p?void 0:p.offlineExam,null===(w=a.data)||void 0===w?void 0:w.offlineExamMixQuestions[0],F,q).catch(tt=>{this.showErrorSnack(tt.message)})}else this.exportDocxService.downloadExamObjs(null!==(C=a.data.exam)&&void 0!==C?C:{},null===(A=a.data)||void 0===A?void 0:A.offlineExam,null===(M=a.data)||void 0===M?void 0:M.offlineExamMixQuestions,q).catch(F=>{this.showErrorSnack(F.message)})}else mn.G.closeLoadingEffect(10),this.showErrorSnack("lang_auto_khong_co_du_lieu_dao_de");else this.errorStatusObj(null!==(D=a.message)&&void 0!==D?D:"",!0),mn.G.closeLoadingEffect(10)}))}exportExcelForAnswerSheet(){var e;this.isLoadingPrintAnswer=!0;let n=null!==(e=this.commonService.getMyParam(this.activeRoute,"hash_id"))&&void 0!==e?e:"";this.subscriptions.add(this.offlineExamExportService.apiOfflineExamExportExportExcelGet(n).subscribe(i=>{var a,r;if(1==i.success){let l=null===(a=i.data)||void 0===a?void 0:a.objs;l&&l.length>0?this.exportExcelData=l:(this.showErrorSnack("lang_auto_chua_co_du_lieu_dap_an_de_offline"),this.isLoadingPrintAnswer=!1)}else this.showErrorSnack(null!==(r=i.message)&&void 0!==r?r:""),this.isLoadingPrintAnswer=!1}))}exportDataDone(e){let n=this.createNameExam("answerexcel",!1);hi.saveAs(e,n),this.isLoadingPrintAnswer=!1}ngOnInit(){var e=[{source:this.cdnService.convertLinkCdn("almo/opencv.js"),name:"opencv_crop_white.js"}];this.commonService.loadScriptPromises(e).then(()=>{this.isLoadingLib=!1}),this.form=this.fb.group({schoolName:new h.NI(""),subjectName:new h.NI(""),year:new h.NI("")}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(x.gz),t.Y36(h.QS),t.Y36(j.uw),t.Y36(pi.Y),t.Y36(Ot.cP),t.Y36(Ji),t.Y36(hn.n),t.Y36(Ke.U),t.Y36(Od.m),t.Y36(Ot.qr),t.Y36(Gn.O))},o.\u0275cmp=t.Xpm({type:o,selectors:[["print-history-box"]],inputs:{examObj:"examObj",offlineExamObj:"offlineExamObj"},features:[t.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"action-history"],[1,"action-file","mt-4"],[1,"font-medium","flex","items-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2","text-pending"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["d","m9 15 2 2 4-4"],[1,"relative","mt-2","intro-x"],["type","text","readonly","",1,"form-control","py-3","px-4","border-transparent","bg-slate-100","pr-10",2,"padding-right","120px",3,"value"],["class","btn btn-primary absolute my-auto inset-y-0 right-0","style"," border-top-left-radius: 0; border-bottom-left-radius: 0; ",3,"click",4,"ngIf"],[1,"mt-2"],["style","display: flex; justify-content: end; color: blue;",3,"click",4,"ngIf"],[4,"ngIf"],[1,"action-file","mt-3"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2","text-danger"],["d","M8 13h2"],["d","M8 17h2"],["d","M14 13h2"],["d","M14 17h2"],[1,"btn","btn-primary","absolute","my-auto","inset-y-0","right-0",2,"border-top-left-radius","0","border-bottom-left-radius","0",3,"click"],["class","azt-loading",4,"ngIf","ngIfElse"],["doneAnswerSheetLoading",""],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2","text-success"],["x1","16","y1","13","x2","8","y2","13"],["x1","16","y1","17","x2","8","y2","17"],["x1","10","y1","9","x2","8","y2","9"],["doneLoadingPrintAnswer",""],[1,"intro-x"],[3,"hashId","checkStudentCode"],[3,"objs","exportDataDone",4,"ngIf"],["doneExamLoading",""],[1,"azt-loading"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","white",1,"w-4","h-4","mr-2"],["fill","none","fill-rule","evenodd"],["transform","translate(1 1)","stroke-width","4"],["stroke-opacity",".5","cx","18","cy","18","r","18"],["d","M36 18c0-9.94-8.06-18-18-18"],["attributeName","transform","type","rotate","from","0 18 18","to","360 18 18","dur","1s","repeatCount","indefinite"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","7 10 12 15 17 10"],["x1","12","y1","15","x2","12","y2","3"],[2,"display","flex","justify-content","end","color","blue",3,"click"],[3,"formGroup"],["id","school-name","type","text","formControlName","schoolName",1,"form-control","mt-1",3,"placeholder"],["id","subject-name","type","text","formControlName","subjectName",1,"form-control","mt-1",3,"placeholder"],[1,"mt-2","font-medium","text-xs","text-slate-500"],[1,"flex","mt-2"],[1,"btn","btn-primary","mr-2",2,"border-radius","5px","width","100%",3,"click"],[1,"btn","btn-Secondary",3,"click"],[3,"objs","exportDataDone"]],template:function(e,n){if(1&e&&(t.YNc(0,Kd,1,0,"azt-loading-effect",0),t.YNc(1,_u,57,30,"ng-template",null,1,t.W1O)),2&e){const i=t.MAs(2);t.Q6J("ngIf",n.isLoadingLib&&null!=n.examObj&&null!=n.offlineExamObj)("ngIfElse",i)}},dependencies:[O.O5,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,te.Q,oe.M,Eo,Wd,at.bT,at.Bm],encapsulation:2}),o})();function du(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function uu(o,s){1&o&&(t.TgZ(0,"div",51)(1,"h3",52),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"span",53),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,2,"lang_auto_tao_de_thanh_cong")," \u{1f44f} "),t.xp6(3),t.hij(" ",t.lcZ(6,4,"lang_auto_vui_long_chon_cac_hinh_thuc_ben_duoi")," "))}function mu(o,s){if(1&o&&(t.TgZ(0,"div",13)(1,"h3",54),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t._UZ(4,"print-history-box",55),t.qZA()),2&o){const e=t.oxw(2);t.xp6(2),t.hij(" ",t.lcZ(3,3,"lang_auto_du_lieu_gan_nhat")," "),t.xp6(2),t.Q6J("examObj",e.examObj)("offlineExamObj",e.offlineExamObj)}}const Zo=function(o){return[o]};function hu(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",3),t.YNc(1,uu,7,6,"div",4),t.TgZ(2,"div",5)(3,"h3",6),t._uU(4),t.ALo(5,"mytranslate"),t.qZA(),t.TgZ(6,"div",7),t.O4$(),t.TgZ(7,"svg",8),t._UZ(8,"circle",9)(9,"line",10)(10,"line",11),t.qZA(),t._uU(11),t.ALo(12,"mytranslate"),t.kcU(),t.TgZ(13,"a",12),t._uU(14),t.ALo(15,"mytranslate"),t.qZA()(),t.TgZ(16,"div",13)(17,"button",14),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.redirectConfigTestOnline())}),t.O4$(),t.TgZ(18,"svg",15),t._UZ(19,"path",16)(20,"path",17)(21,"path",18)(22,"path",19)(23,"path",20)(24,"path",21)(25,"path",22)(26,"path",23)(27,"path",24)(28,"path",25)(29,"path",26)(30,"path",27)(31,"path",28)(32,"path",29),t.qZA(),t._uU(33),t.ALo(34,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(35,"p",30),t._uU(36),t.ALo(37,"mytranslate"),t.TgZ(38,"a",12),t._uU(39),t.ALo(40,"mytranslate"),t.qZA()()()(),t.TgZ(41,"div",31)(42,"h3",6),t._uU(43),t.ALo(44,"mytranslate"),t.qZA(),t.TgZ(45,"div",7),t.O4$(),t.TgZ(46,"svg",8),t._UZ(47,"circle",9)(48,"line",10)(49,"line",11),t.qZA(),t._uU(50),t.ALo(51,"mytranslate"),t.kcU(),t.TgZ(52,"a",32),t._uU(53),t.ALo(54,"mytranslate"),t.qZA()(),t.TgZ(55,"div",13)(56,"div",33)(57,"button",14),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.openDialogExamPrintTicket())}),t.O4$(),t.TgZ(58,"svg",15),t._UZ(59,"polyline",34)(60,"path",35)(61,"rect",36),t.qZA(),t.kcU(),t.TgZ(62,"span",37),t._uU(63),t.ALo(64,"mytranslate"),t.ALo(65,"mytranslate"),t.qZA()(),t.TgZ(66,"p",30),t._uU(67),t.ALo(68,"mytranslate"),t.qZA()()(),t.YNc(69,mu,5,5,"div",38),t.qZA(),t.TgZ(70,"div",39)(71,"div",40)(72,"a",41),t.ALo(73,"mylocalize"),t.O4$(),t.TgZ(74,"svg",42),t._UZ(75,"path",43)(76,"polyline",44)(77,"path",45)(78,"path",46)(79,"path",47)(80,"path",48),t.qZA(),t._uU(81),t.ALo(82,"mytranslate"),t.qZA()(),t.kcU(),t.TgZ(83,"div",49)(84,"a",41),t.ALo(85,"mylocalize"),t.O4$(),t.TgZ(86,"svg",42),t._UZ(87,"path",50),t.qZA(),t._uU(88),t.ALo(89,"mytranslate"),t.qZA()()()()}if(2&o){const e=t.oxw();let n,i;t.xp6(1),t.Q6J("ngIf",e.isNewDocument),t.xp6(3),t.hij(" ",t.lcZ(5,18,"lang_auto_online")," "),t.xp6(7),t.hij(" ",t.lcZ(12,20,"lang_auto_copy_link_gui_cho_hoc_sinh_hoc_sinh_truy_cap_link_de_lam_bai_va_nop_bai_online_ho_tro_ca_trac_nghiem_va_tu_luan")," "),t.xp6(3),t.Oqu(t.lcZ(15,22,"lang_auto_tim_hieu_them")),t.xp6(19),t.hij(" ",t.lcZ(34,24,"lang_auto_cai_dat_lam_bai_online")," "),t.xp6(3),t.hij(" ",t.lcZ(37,26,"lang_auto_thiet_lap_thoi_gian_lam_bai_giam_sat_tu_dong_tao_de_con_cho_phep_xem_diem_doing_xuat_ban_de_tao_link_gui_cho_hoc_sinh_lam_bai_va_nop_bai")," "),t.xp6(3),t.Oqu(t.lcZ(40,28,"lang_auto_tim_hieu_them")),t.xp6(4),t.hij(" ",t.lcZ(44,30,"lang_auto_offline")," "),t.xp6(7),t.hij(" ",t.lcZ(51,32,"lang_auto_in_de_cho_hoc_sinh_lam_tren_giay_scan_hoac_chup_anh_bai_lam_cua_hoc_sinh_va_upload_len_azota_de_cham_tu_dong_hoc_sinh_cung_co_the_tu_chup_lai_bai_lam_cua_minh_va_nop_tren_azota")," "),t.xp6(3),t.Oqu(t.lcZ(54,34,"lang_auto_tim_hieu_them")),t.xp6(10),t.AsE("",t.lcZ(64,36,"lang_auto_in_de_upper")," ",t.lcZ(65,38,"lang_auto_-_co_phieu_tra_loi_trac_nghiem_rieng"),""),t.xp6(4),t.hij(" ",t.lcZ(68,40,"lang_auto_xuat_file_pdf_chua_cac_de_thi_da_duoc_dao_thu_tu_cau_hoi_va_dap_an_tu_de_goc_kem_theo_mot_file_pdf_chua_mau_phieu_tra_loi_trac_nghiem_theo_mau_tuy_chon")," "),t.xp6(2),t.Q6J("ngIf",e.offlineExamObj.hashId),t.xp6(3),t.Q6J("routerLink",t.VKq(50,Zo,t.lcZ(73,42,"/admin/testbank/exam-results-list/"+(null!==(n=e.examObj.categoryId)&&void 0!==n?n:0)+"/"+e.examObj.id+"/0"))),t.xp6(9),t.hij(" ",t.lcZ(82,44,"lang_auto_quan_ly_danh_sach_da_thi")," "),t.xp6(3),t.Q6J("routerLink",t.VKq(52,Zo,t.lcZ(85,46,"/admin/testbank/document-management/0/"+(null!==(i=e.examObj.categoryId)&&void 0!==i?i:0)+"/1"))),t.xp6(4),t.hij(" ",t.lcZ(89,48,"lang_auto_ve_trang_quan_ly_file")," ")}}let pu=(()=>{class o extends mt.Q{constructor(e,n,i,a){super(e),this.commonService=e,this.activeRoute=n,this.dialog=i,this.documentConfigService=a,this.backToLink="",this.paramBackToLink="",this.returnToLink="",this.examObj={},this.examHashId="",this.isNewDocument=!1,this.dataConfigDocument={},this.offlineExamObj={}}redirectConfigTestOnline(){var e,n;let i=`/admin/testbank/action-online-offline/${null!==(e=this.examObj.categoryId)&&void 0!==e?e:0}/${this.examObj.hashId}?backto=`+this.paramBackToLink;this.myNavigationWithQueryString(`/admin/testbank/config-exam-online/${null!==(n=this.examObj.categoryId)&&void 0!==n?n:0}/${this.examObj.hashId}`,`?backto=${i}`)}openDialogExamPrintTicket(){this.dialog.open(Td,{width:"650px",data:{dataConfigDocument:this.dataConfigDocument,backToLink:this.returnToLink}})}getExamInfoByHashId(e){this.initStatusObj(),this.subscriptions.add(this.documentConfigService.apiDocumentConfigGetExamConfigDataGet(e).subscribe(n=>{var i,a,r,l;1==n.success?(this.dataConfigDocument=null!==(i=n.data)&&void 0!==i?i:{},!(null===(a=n.data)||void 0===a)&&a.examObj&&(this.examObj=n.data.examObj,this.offlineExamObj=null!==(r=n.data.offlineExamObj)&&void 0!==r?r:{}),this.successStatusObj()):this.errorStatusObj(null!==(l=n.message)&&void 0!==l?l:"",!0)}))}ngOnInit(){var e,n,i,a;let r=null!==(e=this.commonService.getMyQueryParam("isNewDocument"))&&void 0!==e?e:"";this.isNewDocument="1"==r.toString();var l=null!==(n=this.commonService.getMyParam(this.activeRoute,"cat_id"))&&void 0!==n?n:"";this.paramBackToLink=null!==(i=this.commonService.getMyQueryParam("backto"))&&void 0!==i?i:"",this.examHashId=null!==(a=this.commonService.getMyParam(this.activeRoute,"hash_id"))&&void 0!==a?a:"",this.backToLink=this.paramBackToLink?this.paramBackToLink:`/admin/testbank/document-management/0/${null!=l?l:0}/1`,this.returnToLink=`/admin/testbank/action-online-offline/${null!=l?l:0}/${this.examHashId}?backto=`+this.paramBackToLink,this.getExamInfoByHashId(this.examHashId),this.commonService.translateMetaData({title:"lang_cms_action_online_offline_title",description:"lang_cms_action_online_offline_description",image:""}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(x.gz),t.Y36(j.uw),t.Y36(Ot.Cq))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-action-online-offline"]],features:[t.qOj],decls:5,vars:3,consts:[[3,"headerBackTolink"],[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"intro-y","action-document","mx-auto","mt-8",2,"max-width","700px"],["class","action-heading mb-4",4,"ngIf"],[1,"action-online"],[1,"text-md","uppercase","font-medium"],[1,"text-md","mt-1"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","inline-block","w-4","h-4","mr-1"],["cx","12","cy","12","r","10"],["x1","12","y1","16","x2","12","y2","12"],["x1","12","y1","8","x2","12.01","y2","8"],["href","https://docs.azota.vn/docs/huong-dan-su-dung/thi-online/cau-hinh-thi-online/","target","_blank","rel","noopener noreferrer",1,"text-primary","font-medium"],[1,"box","mt-3","p-5"],[1,"btn","btn-outline-primary",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-5","h-5","mr-2"],["d","M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z"],["d","M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"],["d","M12 2v2"],["d","M12 22v-2"],["d","m17 20.66-1-1.73"],["d","M11 10.27 7 3.34"],["d","m20.66 17-1.73-1"],["d","m3.34 7 1.73 1"],["d","M14 12h8"],["d","M2 12h2"],["d","m20.66 7-1.73 1"],["d","m3.34 17 1.73-1"],["d","m17 3.34-1 1.73"],["d","m11 13.73-4 6.93"],[1,"text-xs","mt-2","text-slate-500"],[1,"action-offline","mt-8"],["href","https://docs.azota.vn/docs/huong-dan-su-dung/thi-offline/gioi-thieu-tinh-nang-thi-offline/","target","_blank","rel","noopener noreferrer",1,"text-primary","font-medium"],[1,"azt-offline-print"],["points","6 9 6 2 18 2 18 9"],["d","M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"],["x","6","y","14","width","12","height","8"],[1,"mr-1"],["class","box mt-3 p-5",4,"ngIf"],[1,"mt-5","flex","flex-col","sm:flex-row","justify-center","items-center"],[1,"mr-2"],[1,"btn","btn-outline-primary","btn-transparent",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["d","M8 13h2"],["d","M8 17h2"],["d","M14 13h2"],["d","M14 17h2"],[1,"w-30"],["d","M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"],[1,"action-heading","mb-4"],[1,"text-md","font-medium","mb-1"],[1,"text-md"],[1,"text-md","font-medium","flex","items-center"],[3,"examObj","offlineExamObj"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0),t.YNc(1,du,1,0,"azt-loading-effect",1),t.YNc(2,hu,90,54,"ng-template",null,2,t.W1O),t._UZ(4,"azt-status-loading-effect"),t.qZA()),2&e){const i=t.MAs(3);t.Q6J("headerBackTolink",n.backToLink),t.xp6(1),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[x.yS,O.O5,te.Q,mn.G,de._,Io,at.mp,at.bT],encapsulation:2}),o})();var pn=b(86317),Hi=b(51176);function gu(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function fu(o,s){1&o&&(t.TgZ(0,"span",24),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_chia_se")))}function xu(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",25)(2,"g",26)(3,"g",27),t._UZ(4,"circle",28),t.TgZ(5,"path",29),t._UZ(6,"animateTransform",30),t.qZA()()()()())}function vu(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",31),t._UZ(2,"path",32)(3,"polyline",33)(4,"line",34),t.qZA()())}function bu(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",37)(1,"a",38),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.handleClick(a))}),t._UZ(2,"azt-file-item",39),t.qZA()()}if(2&o){const e=s.$implicit;t.xp6(2),t.Q6J("dataObj",e)("showByClass",!0)("viewType","classroom")}}const wu=function(){return["name"]};function Tu(o,s){if(1&o&&(t.TgZ(0,"div")(1,"div",35),t.YNc(2,bu,3,3,"div",36),t.ALo(3,"appFilter"),t.qZA()()),2&o){const e=t.oxw(2);let n;t.xp6(2),t.Q6J("ngForOf",t.Dn7(3,1,e.documentData,null==(n=e.form.get("searchContent"))?null:n.value,t.DdM(5,wu)))}}function Cu(o,s){1&o&&(t.TgZ(0,"div",40),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_homework_homework_list_not_found")," "))}function Au(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",4)(1,"div",5)(2,"a",6),t._uU(3),t.ALo(4,"mytranslate"),t.YNc(5,fu,3,3,"span",7),t.ALo(6,"fullPermission"),t.qZA(),t.TgZ(7,"div",8)(8,"form",9),t.O4$(),t.TgZ(9,"svg",10),t._UZ(10,"circle",11)(11,"line",12),t.qZA(),t.kcU(),t._UZ(12,"input",13),t.ALo(13,"mytranslate"),t.qZA()(),t.TgZ(14,"div",14)(15,"button",15),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.exportExcelForScoreHomeworkOfClassroom())}),t.YNc(16,xu,7,0,"span",16),t.YNc(17,vu,5,0,"span",16),t._uU(18),t.ALo(19,"mytranslate"),t.qZA()()(),t.TgZ(20,"div",17),t.YNc(21,Tu,4,6,"div",2),t.YNc(22,Cu,3,3,"ng-template",null,18,t.W1O),t.qZA()(),t.TgZ(24,"div",19)(25,"div",20)(26,"azt-paging",21),t.NdJ("SendPage",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.goToPage(i))}),t.qZA()(),t.TgZ(27,"div",22)(28,"p",23),t._uU(29),t.ALo(30,"number"),t.ALo(31,"mytranslate"),t.qZA()()()}if(2&o){const e=t.MAs(23),n=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,12,n.classroomObj.name)," "),t.xp6(2),t.Q6J("ngIf",0==n.checkPermissionObj(t.xi3(6,14,n.classroomObj.permissionObj,"classroom"))),t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(4),t.s9C("placeholder",t.lcZ(13,17,"lang_homework_homework_list_search")),t.xp6(4),t.Q6J("ngIf",n.loadingExport),t.xp6(1),t.Q6J("ngIf",!n.loadingExport),t.xp6(1),t.hij(" ",t.lcZ(19,19,"lang_auto_xuat_bang_diem")," "),t.xp6(3),t.Q6J("ngIf",n.documentData.length>0)("ngIfElse",e),t.xp6(5),t.Q6J("lengthPage",n.total_page)("paging",n.cur_page),t.xp6(3),t.Oqu(t.lcZ(30,21,n.totalDocument)+" "+t.lcZ(31,23,"lang_testbank_test_list_document"))}}let yu=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_,d){super(e),this.commonService=e,this.activeRoute=n,this.documentService=i,this.fb=a,this.classroomService=r,this.zipdataService=l,this.timeService=c,this.sortService=_,this.exportExcelService=d,this.form=new h.nJ({}),this.backToLink="",this.classId=0,this.cur_page=1,this.totalDocument=0,this.item_per_page_admin=24,this.limit_page=5,this.start_page=1,this.end_page=1,this.show_pages=[],this.total_page=1,this.totalObjs=1,this.classroomObj={},this.documentData=[],this.loadingExport=!1}exportExcelForScoreHomeworkOfClassroom(){var e;this.loadingExport=!0;let n=null!==(e=this.commonService.myTranslateIntance("lang_auto_tong_ket_diem_lop"))&&void 0!==e?e:"";this.subscriptions.add(this.classroomService.apiClassroomExportDataGet(Number(this.classId)).subscribe(i=>{var a,r,l,c;if(1==i.success){let _=this.commonService.createFileNameExportFile([n,null!==(a=this.classroomObj.name)&&void 0!==a?a:""]);const d=this.exportExcelService.exportExcelForScoreHomeworkOfClassroom(this.classroomObj,null!==(l=null===(r=i.data)||void 0===r?void 0:r.objs)&&void 0!==l?l:[]);hi.saveAs(d,_+".xlsx")}else this.errorStatusObj(null!==(c=i.message)&&void 0!==c?c:"",!0);this.loadingExport=!1}))}handleClick(e){var n,i,a,r,l,c;let _="/admin/testbank/all-documents-in-class/"+this.classId+"/"+this.cur_page;"exam"==e.type?this.commonService.myNavigationWithQueryString("/admin/testbank/exam-results-list/"+(null!==(i=null===(n=e.exam)||void 0===n?void 0:n.categoryId)&&void 0!==i?i:0)+"/"+(null===(a=e.exam)||void 0===a?void 0:a.id)+"/0","?backto="+encodeURIComponent(_)):"homework"==e.type&&this.commonService.myNavigationWithQueryString("/admin/testbank/homework-results-list/"+(null===(r=e.homework)||void 0===r?void 0:r.classroomId)+"/"+(null===(l=e.homework)||void 0===l?void 0:l.id)+"/"+(null===(c=e.homework)||void 0===c?void 0:c.hashId),"?backto="+encodeURIComponent(_))}getClassName(e){var n=[];return e.forEach(i=>{i.name&&!this.commonService.filterArray(n,i.name)&&n.push(i.name)}),n}checkPermissionObj(e){return e}convertIAztTestbankDocumentRecommendData(e){var n=[];return e.forEach(i=>{var a;if(i.exam){var r={id:i.exam.id,hashId:i.exam.hashId,name:i.exam.name,deadline:i.exam.endTime,type:"exam",createdAt:i.exam.createdAt,submited:i.exam.attended,delivery:this.getClassName(null!==(a=i.exam.classrooms)&&void 0!==a?a:[]),exam:i.exam};n.push(r)}else i.homework&&(r={id:i.homework.id,hashId:i.homework.hashId,classroomId:i.homework.classroomId,name:i.homework.name,type:"homework",createdAt:i.homework.createdAt,deadline:i.homework.deadline,submited:i.homework.count,total:i.homework.totalStudent,delivery:i.homework.className?[i.homework.className]:new Array,homework:i.homework},n.push(r))}),n}goToPage(e){this.commonService.myNavigationWithQueryString("/admin/testbank/all-documents-in-class/"+this.classId+"/"+e,"?backto="+this.backToLink)}getClassObj(){this.subscriptions.add(this.classroomService.apiClassroomGetObjGet(this.classId).subscribe(e=>{var n,i,a;1==e.success?(this.classroomObj=null!==(i=null===(n=e.data)||void 0===n?void 0:n.obj)&&void 0!==i?i:{},this.successStatusObj()):this.errorStatusObj(null!==(a=e.message)&&void 0!==a?a:"",!0)}))}getData(){this.initStatusObj(),this.subscriptions.add(this.documentService.apiDocumentsGet(void 0,"file",void 0,"homework",this.classId,void 0,this.cur_page).subscribe(e=>{var n,i,a,r,l,c,_;if(1==e.success){this.documentData=this.convertIAztTestbankDocumentRecommendData(null!==(i=null===(n=e.data)||void 0===n?void 0:n.documentObjs)&&void 0!==i?i:[]),this.totalDocument=null!==(r=null===(a=e.data)||void 0===a?void 0:a.totalDocument)&&void 0!==r?r:0,this.totalObjs=null!==(c=null===(l=e.data)||void 0===l?void 0:l.total)&&void 0!==c?c:0,this.total_page=this.totalObjs%this.item_per_page_admin>0?(this.totalObjs-this.totalObjs%this.item_per_page_admin)/this.item_per_page_admin+1:this.totalObjs>0?this.totalObjs/this.item_per_page_admin:1,-1==this.classId&&(this.total_page=this.totalDocument%this.item_per_page_admin>0?(this.totalDocument-this.totalDocument%this.item_per_page_admin)/this.item_per_page_admin+1:this.totalDocument>0?this.totalDocument/this.item_per_page_admin:1),this.start_page=this.cur_page-this.limit_page>=1?this.cur_page-this.limit_page:1,this.end_page=this.start_page+2*this.limit_page>this.total_page?this.total_page:this.start_page+2*this.limit_page;for(var d=[],m=this.start_page;m<=this.end_page;m++)d.push(m);if(this.show_pages=d,this.classId>0)this.getClassObj();else{let p=this.commonService.myTranslateIntance("lang_auto_tu_do");this.classroomObj={id:this.classId,name:p},this.successStatusObj()}}else this.errorStatusObj(null!==(_=e.message)&&void 0!==_?_:"",!0)}))}ngOnInit(){this.form=this.fb.group({searchContent:new h.p4("",h.kI.required)}),(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var e;this.backToLink=null!==(e=this.commonService.getMyQueryParam("backto"))&&void 0!==e?e:"/admin/testbank/document-management/1/0/1",this.classId=Number(this.commonService.getMyParam(this.activeRoute,"class_id")),this.cur_page=Number(this.commonService.getMyParam(this.activeRoute,"page")),this.getData()}),this.commonService.translateMetaData({title:"lang_cms_all_document_class_title",description:"lang_cms_all_document_class_description",image:""}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(x.gz),t.Y36(Ot.Zg),t.Y36(h.QS),t.Y36(Ot.um),t.Y36(hn.n),t.Y36(Tn.O),t.Y36(pn.K),t.Y36(Gn.O))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-all-document-class"]],features:[t.qOj],decls:5,vars:3,consts:[[3,"headerBackTolink"],[1,"mb-2","mt-3"],[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"box",2,"min-height","300px"],[1,"flex","lg:items-center","flex-col","lg:flex-row","p-5","border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"font-medium","truncate","text-md","mr-2"],["class","ml-2 py-0.5 px-2 rounded-full text-xs bg-primary text-white cursor-pointer font-medium",4,"ngIf"],[1,"ml-0","lg:ml-auto","relative","mt-2","lg:mt-0","mr-2"],[3,"formGroup"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","absolute","my-auto","inset-y-0","ml-3","left-0","z-10","text-slate-500"],["cx","11","cy","11","r","8"],["x1","21","y1","21","x2","16.65","y2","16.65"],["type","text","formControlName","searchContent",1,"form-control","w-full","sm:w-72","box","px-10","bg-slate-200","dark:bg-darkmode-400",3,"placeholder"],[1,"ml-0"],[1,"btn","btn-primary","mt-2","lg:mt-0",3,"click"],[4,"ngIf"],[1,"p-5"],["noDocumentData",""],[1,"flex","items-center","flex-col-reverse","sm:flex-row","mt-3"],[1,"mr-0","sm:mr-auto","mt-2"],[3,"lengthPage","paging","SendPage"],[1,"text-right","mt-2"],[1,"text-md"],[1,"ml-2","py-0.5","px-2","rounded-full","text-xs","bg-primary","text-white","cursor-pointer","font-medium"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","white",1,"w-4","h-4","mr-2"],["fill","none","fill-rule","evenodd"],["transform","translate(1 1)","stroke-width","4"],["stroke-opacity",".5","cx","18","cy","18","r","18"],["d","M36 18c0-9.94-8.06-18-18-18"],["attributeName","transform","type","rotate","from","0 18 18","to","360 18 18","dur","1s","repeatCount","indefinite"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide","mr-2"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","7 10 12 15 17 10"],["x1","12","y1","15","x2","12","y2","3"],[1,"grid","grid-cols-12","gap-5"],["class","col-span-12 md:col-span-6 xl:col-span-4 2xl:col-span-3 intro-y",4,"ngFor","ngForOf"],[1,"col-span-12","md:col-span-6","xl:col-span-4","2xl:col-span-3","intro-y"],[3,"click"],[3,"dataObj","showByClass","viewType"],[1,"box","py-5","text-center"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0)(1,"div",1),t.YNc(2,gu,1,0,"azt-loading-effect",2),t.YNc(3,Au,32,25,"ng-template",null,3,t.W1O),t.qZA()()),2&e){const i=t.MAs(4);t.Q6J("headerBackTolink",n.backToLink),t.xp6(2),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.sg,O.O5,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,te.Q,Hi.L,oe.M,Di,de._,O.JJ,at.bT,at.gB,at.Gf],encapsulation:2}),o})();function ku(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function Ou(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",23),t._UZ(2,"path",24)(3,"polyline",25)(4,"line",26),t.qZA()())}function Su(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",27)(2,"g",28)(3,"g",29),t._UZ(4,"circle",30),t.TgZ(5,"path",31),t._UZ(6,"animateTransform",32),t.qZA()()()()())}function Eu(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"h3",6),t._uU(4),t.ALo(5,"mytranslate"),t.qZA(),t.TgZ(6,"div",7)(7,"div",8)(8,"label",9),t._uU(9),t.ALo(10,"mytranslate"),t.qZA(),t.TgZ(11,"select",10)(12,"option",11),t._uU(13),t.ALo(14,"mytranslate"),t.qZA(),t.TgZ(15,"option",12),t._uU(16),t.ALo(17,"mytranslate"),t.qZA(),t.TgZ(18,"option",13),t._uU(19),t.ALo(20,"mytranslate"),t.qZA(),t.TgZ(21,"option",14),t._uU(22),t.ALo(23,"mytranslate"),t.qZA(),t.TgZ(24,"option",15),t._uU(25),t.ALo(26,"mytranslate"),t.qZA(),t.TgZ(27,"option",16),t._uU(28),t.ALo(29,"mytranslate"),t.qZA()()(),t.TgZ(30,"div",17)(31,"button",18),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.printExamAnswersheet(null==i.dataConfigDocument.offlineExamObj?null:i.dataConfigDocument.offlineExamObj.hashId))}),t.YNc(32,Ou,5,0,"span",19),t.YNc(33,Su,7,0,"span",19),t.TgZ(34,"span"),t._uU(35),t.ALo(36,"mytranslate"),t.qZA()()()()(),t.TgZ(37,"div",20)(38,"h3",6),t._uU(39),t.ALo(40,"mytranslate"),t.qZA(),t.TgZ(41,"div",7)(42,"div",21),t._UZ(43,"numbering-identification",22),t.ALo(44,"mustInClassroom"),t.qZA()()()()()}if(2&o){const e=t.oxw();let n;t.xp6(4),t.hij(" ",t.lcZ(5,16,"lang_auto_in_phieu_tra_loi")," "),t.xp6(5),t.hij(" ",t.lcZ(10,18,"lang_auto_chon_mau_phieu_tra_loi")," "),t.xp6(2),t.Q6J("formControl",e.templateAnswerSheet),t.xp6(2),t.Oqu(t.lcZ(14,20,"lang_auto_answersheet_mau_a4_bo_giao_duc_120")),t.xp6(3),t.Oqu(t.lcZ(17,22,"lang_auto_answersheet_mau_a4_120")),t.xp6(3),t.Oqu(t.lcZ(20,24,"lang_auto_answersheet_mau_a6_full_a4_20")),t.xp6(3),t.Oqu(t.lcZ(23,26,"lang_auto_answersheet_mau_a6_full_a4_50")),t.xp6(3),t.Oqu(t.lcZ(26,28,"lang_auto_answersheet_mau_a8_full_a4_20")),t.xp6(3),t.Oqu(t.lcZ(29,30,"lang_auto_answersheet_mau_a4_hon_hop_35")),t.xp6(4),t.Q6J("ngIf",!e.isLoadingPrintTicket),t.xp6(1),t.Q6J("ngIf",e.isLoadingPrintTicket),t.xp6(2),t.Oqu(t.lcZ(36,32,"lang_auto_tai_phieu_tra_loi")),t.xp6(4),t.hij(" ",t.lcZ(40,34,"lang_auto_danh_so_bao_danh")," "),t.xp6(4),t.Q6J("hashId",null==e.dataConfigDocument.examObj?null:e.dataConfigDocument.examObj.hashId)("checkStudentCode",t.lcZ(44,36,null!==(n=null==e.dataConfigDocument.examObj?null:e.dataConfigDocument.examObj.whoAllow)&&void 0!==n?n:0))("styleView",1)}}let Iu=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c){super(e),this.commonService=e,this.offlineMixquestionService=n,this.zipdataService=i,this.answerSheetHelper=a,this.printAnswersheetService=r,this.documentConfigService=l,this.activeRoute=c,this.backLink="",this.templateAnswerSheet=new h.NI("0"),this.isLoadingPrintTicket=!1,this.dataConfigDocument={},this.examHashId=""}printExamAnswersheet(e){var n;this.isLoadingPrintTicket=!0,this.subscriptions.add(this.offlineMixquestionService.apiOfflineMixquestionGetObjsGet(null===(n=this.dataConfigDocument.examObj)||void 0===n?void 0:n.hashId,e,"").subscribe(i=>{var a,r,l,c,_,d,m,p,w,C,A,M,D;if(1===i.success){let q=this.getTotalQuestionInMixQuestionObjs(null!==(r=null===(a=i.data)||void 0===a?void 0:a.mixQuestionObjs)&&void 0!==r?r:[],null!==(c=null===(l=i.data)||void 0===l?void 0:l.questionObjs)&&void 0!==c?c:[]);if(q){let F=null!==(_=this.templateAnswerSheet.value)&&void 0!==_?_:0;this.answerSheetHelper=this.printAnswersheetService.chooseAnswerSheetTemplate(this.answerSheetHelper,F,q,0,null===(d=i.data)||void 0===d?void 0:d.maxOfflineMixQuestionHashId);let tt=this.printAnswersheetService.exportFileNameOfAnswerSheet(0,null!==(p=null===(m=this.dataConfigDocument.examObj)||void 0===m?void 0:m.name)&&void 0!==p?p:"",null!==(A=null===(C=null===(w=i.data)||void 0===w?void 0:w.offlineExamObj)||void 0===C?void 0:C.hashId)&&void 0!==A?A:"");this.answerSheetHelper.createAnswerSheet().subscribe(W=>{1==W.success?this.answerSheetHelper.exportPdf(tt):this.errorStatusObj("lang_auto_tao_phieu_loi_vui_long_thu_lai_split_lang"+i.message,!0),this.isLoadingPrintTicket=!1})}else this.errorStatusObj(null!==(M=i.message)&&void 0!==M?M:"",!0),this.isLoadingPrintTicket=!1}else this.errorStatusObj(null!==(D=i.message)&&void 0!==D?D:"",!0),this.isLoadingPrintTicket=!1}))}getTotalQuestionInMixQuestionObjs(e,n){if(e.length>0){let i=0;return e.forEach(a=>{var r,l,c;let _=this.zipdataService.decodeContentGzip(null!==(r=null==a?void 0:a.mixDatas)&&void 0!==r?r:""),d=this.castJsonToObj(_);i<(null!==(l=null==d?void 0:d.length)&&void 0!==l?l:0)&&(i=null!==(c=null==d?void 0:d.length)&&void 0!==c?c:0)}),i}return n.length>0?n.length:void 0}getExamInfoByHashId(e){var n;this.initStatusObj(),this.subscriptions.add(this.documentConfigService.apiDocumentConfigGetExamConfigDataGet(e).subscribe(i=>{var a,r;1==i.success?(this.dataConfigDocument=null!==(a=i.data)&&void 0!==a?a:{},this.successStatusObj()):this.errorStatusObj(null!==(r=i.message)&&void 0!==r?r:"",!0)})),this.examHashId=null!==(n=this.commonService.getMyParam(this.activeRoute,"hash_id"))&&void 0!==n?n:""}ngOnInit(){var e,n,i;this.examHashId=null!==(e=this.commonService.getMyParam(this.activeRoute,"hash_id"))&&void 0!==e?e:"";let a=null!==(n=Number(this.activeRoute.snapshot.paramMap.get("cat_id")))&&void 0!==n?n:0,r=null!==(i=this.commonService.getMyQueryParam("backto"))&&void 0!==i?i:"";this.backLink=r||"/admin/testbank/document-management/0/"+(null!=a?a:0)+"/1",this.examHashId&&this.getExamInfoByHashId(this.examHashId)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Ot.cP),t.Y36(hn.n),t.Y36(Ji),t.Y36(pi.Y),t.Y36(Ot.Cq),t.Y36(x.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-config-exam-offline"]],features:[t.qOj],decls:4,vars:3,consts:[[3,"headerBackTolink"],[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"intro-y","mt-8"],[1,"mx-auto",2,"max-width","1000px"],[1,"setting-block"],[1,"text-md","uppercase","font-medium"],[1,"box","mt-2","p-5"],[1,"intro-y"],[1,"form-label","font-medium"],[1,"form-select",3,"formControl"],["value","1"],["value","0"],["value","5"],["value","6"],["value","2"],["value","4"],[1,"mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"],[1,"setting-block","mt-5"],[1,"mt-2","intro-y"],[3,"hashId","checkStudentCode","styleView"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide","mr-2"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","7 10 12 15 17 10"],["x1","12","y1","15","x2","12","y2","3"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","white",1,"w-4","h-4","mr-2"],["fill","none","fill-rule","evenodd"],["transform","translate(1 1)","stroke-width","4"],["stroke-opacity",".5","cx","18","cy","18","r","18"],["d","M36 18c0-9.94-8.06-18-18-18"],["attributeName","transform","type","rotate","from","0 18 18","to","360 18 18","dur","1s","repeatCount","indefinite"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0),t.YNc(1,ku,1,0,"azt-loading-effect",1),t.YNc(2,Eu,45,38,"ng-template",null,2,t.W1O),t.qZA()),2&e){const i=t.MAs(3);t.Q6J("headerBackTolink",n.backLink),t.xp6(1),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.O5,h.YN,h.Kr,h.EJ,h.JJ,h.oH,te.Q,de._,Eo,at.bT,at.Bm],encapsulation:2}),o})();var Mo=b(15439);class Zu{static customDateTimeValidator(s){const e=s.get("startTime"),n=s.get("endTime");return null!==e&&null!==n&&""!=e.value&&""!=n.value&&null!==e.value&&null!==n.value&&e.value>=n.value?(null==n||n.setErrors({customDateTimeValidator:!0}),{identityRevealed:!0}):(null==n||n.setErrors(null),null)}}var Mu=b(40291),zi=b(91159);const Pu=["tagInput"];function Lu(o,s){1&o&&(t.TgZ(0,"mat-icon",12),t._uU(1,"cancel"),t.qZA())}function Nu(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"mat-chip",10),t.NdJ("removed",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.removeTagName(a))}),t._uU(1),t.YNc(2,Lu,2,0,"mat-icon",11),t.qZA()}if(2&o){const e=s.$implicit;t.Q6J("selectable",!0)("removable",!0),t.xp6(1),t.hij(" ",e," "),t.xp6(1),t.Q6J("ngIf",!0)}}function Du(o,s){if(1&o&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}let ju=(()=>{class o extends mt.Q{constructor(e){super(e),this.commonService=e,this.form=new h.nJ({}),this.allTagNames=[],this.tagNames=[],this.tagNamesChange=new t.vpe,this.separatorKeysCodes=[zi.K5,zi.OC]}addTagName(e){const n=e.input,i=e.value;(i||"").trim()&&this.tagNames.push(i.trim()),n&&(n.value=""),this.tagNameCtrl.setValue(null)}removeTagName(e){const n=this.tagNames.indexOf(e);n>=0&&this.tagNames.splice(n,1)}selectedTagName(e){this.tagNames.push(e.option.viewValue),this.tagInput&&(this.tagInput.nativeElement.value=""),this.tagNameCtrl.setValue(null)}_filterTagName(e){const n=e.toLowerCase();return this.allTagNames.filter(i=>0===i.toLowerCase().indexOf(n))}ngOnInit(){super.ngOnInit(),this.filteredTags=this.tagNameCtrl.valueChanges.pipe((0,fo.O)(null),(0,qi.U)(e=>e?this._filterTagName(e):this.allTagNames.slice()))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v))},o.\u0275cmp=t.Xpm({type:o,selectors:[["test-config-online-tag"]],viewQuery:function(e,n){if(1&e&&t.Gf(Pu,5),2&e){let i;t.iGM(i=t.CRH())&&(n.tagInput=i.first)}},inputs:{form:"form",tagNameCtrl:"tagNameCtrl",allTagNames:"allTagNames",tagNames:"tagNames"},outputs:{tagNamesChange:"tagNamesChange"},features:[t.qOj],decls:11,vars:9,consts:[[3,"formGroup"],["appearance","outline",1,"my-chip-list"],["aria-label"," 'lang_cms_utils_choose_tag_name' | mytranslate "],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],[3,"formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["tagInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],[3,"value"]],template:function(e,n){if(1&e&&(t.TgZ(0,"form",0)(1,"mat-form-field",1)(2,"mat-chip-list",2,3),t.YNc(4,Nu,3,4,"mat-chip",4),t.TgZ(5,"input",5,6),t.NdJ("matChipInputTokenEnd",function(a){return n.addTagName(a)}),t.qZA()(),t.TgZ(7,"mat-autocomplete",7,8),t.NdJ("optionSelected",function(a){return n.selectedTagName(a)}),t.YNc(9,Du,2,2,"mat-option",9),t.ALo(10,"async"),t.qZA()()()),2&e){const i=t.MAs(3),a=t.MAs(8);t.Q6J("formGroup",n.form),t.xp6(4),t.Q6J("ngForOf",n.tagNames),t.xp6(1),t.Q6J("formControl",n.tagNameCtrl)("matAutocomplete",a)("matChipInputFor",i)("matChipInputSeparatorKeyCodes",n.separatorKeysCodes),t.xp6(4),t.Q6J("ngForOf",t.lcZ(10,7,n.filteredTags))}},dependencies:[O.sg,O.O5,ui.XC,ui.ZL,wn.ey,ke.qn,ke.HS,ke.oH,ke.qH,ge.Hw,De.KE,h._Y,h.Fj,h.JJ,h.JL,h.oH,h.sg,O.Ov],encapsulation:2}),o})();function qu(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw().index;t.xp6(1),t.hij("",e+1,".")}}function Qu(o,s){1&o&&(t.TgZ(0,"span"),t._UZ(1,"input",56),t.qZA())}function Uu(o,s){1&o&&(t.TgZ(0,"span"),t._UZ(1,"input",57),t.qZA())}function Fu(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",48)(1,"div",49),t.YNc(2,qu,2,1,"span",37),t.YNc(3,Qu,2,0,"span",37),t.YNc(4,Uu,2,0,"span",37),t.TgZ(5,"span",50)(6,"input",51),t.NdJ("change",function(i){const r=t.CHM(e).index,l=t.oxw(2).index,c=t.oxw();return t.KtG(c.changeInfoContent(i,l,r))}),t.ALo(7,"mytranslate"),t.qZA()(),t.TgZ(8,"a",52),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw(2).index,l=t.oxw();return t.KtG(l.removeContent(r,a))}),t.O4$(),t.TgZ(9,"svg",53),t._UZ(10,"line",54)(11,"line",55),t.qZA()()()()}if(2&o){const e=s.$implicit,n=t.oxw(2).$implicit;t.xp6(2),t.Q6J("ngIf",3==n.type),t.xp6(1),t.Q6J("ngIf",2==n.type),t.xp6(1),t.Q6J("ngIf",1==n.type),t.xp6(2),t.s9C("placeholder",""==e?t.lcZ(7,5,"lang_testbank_test_config_request_enter_name"):""),t.s9C("value",""!=e&&null!=e?e:"")}}function Ru(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",39),t._UZ(2,"rect",58)(3,"line",59)(4,"line",60),t.qZA()())}function Bu(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",39),t._UZ(2,"circle",61)(3,"line",59)(4,"line",60),t.qZA()())}function Ju(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.contents?e.contents.length+1:1,". ")}}function Hu(o,s){if(1&o){const e=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"div",33),t.YNc(1,Fu,12,7,"div",34),t.TgZ(2,"div",35)(3,"button",36),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,a=t.oxw();return t.KtG(a.addMoreContent(i))}),t.YNc(4,Ru,5,0,"span",37),t.YNc(5,Bu,5,0,"span",37),t.YNc(6,Ju,2,1,"span",37),t._uU(7),t.ALo(8,"mytranslate"),t.qZA(),t.TgZ(9,"button",38),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,a=t.oxw();return t.KtG(a.addFastContent(i))}),t.O4$(),t.TgZ(10,"svg",39),t._UZ(11,"line",8)(12,"line",9),t.qZA(),t._uU(13),t.ALo(14,"mytranslate"),t.qZA()(),t.kcU(),t.TgZ(15,"div",40)(16,"div",41)(17,"div",42)(18,"textarea",43),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw().index,r=t.oxw();return t.KtG(r.changeDataFastContent(i,a))}),t.qZA()(),t.TgZ(19,"div",44),t._uU(20),t.ALo(21,"mytranslate"),t.qZA(),t.TgZ(22,"div",45)(23,"button",46),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.closeDialogFastContent())}),t._uU(24),t.ALo(25,"mytranslate"),t.qZA(),t.TgZ(26,"button",47),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,a=t.oxw();return t.KtG(a.changeInfoFastContent(a.infoContentFast[i],i))}),t._uU(27),t.ALo(28,"mytranslate"),t.qZA()()()()()}if(2&o){const e=t.oxw(),n=e.$implicit,i=e.index,a=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.contents),t.xp6(3),t.Q6J("ngIf",1==n.type),t.xp6(1),t.Q6J("ngIf",2==n.type),t.xp6(1),t.Q6J("ngIf",3==n.type),t.xp6(1),t.hij(" ",t.lcZ(8,10,"lang_testbank_test_config_more_options")," "),t.xp6(6),t.hij(" ",t.lcZ(14,12,"lang_testbank_test_config_quick_add")," "),t.xp6(2),t.Q6J("ngClass",a.checkDialogFastContent[i]?"":"hidden"),t.xp6(5),t.hij(" * ",t.lcZ(21,14,"lang_testbank_test_config_note")," "),t.xp6(4),t.hij(" ",t.lcZ(25,16,"lang_buttom_cancel")," "),t.xp6(3),t.hij(" ",t.lcZ(28,18,"lang_buttom_confirm")," ")}}const zu=function(o){return{"mb-5":o}},Yu=function(o){return{"border-danger":o}};function Gu(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14)(4,"div",15),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"input",16),t.NdJ("change",function(i){const r=t.CHM(e).index,l=t.oxw();return t.KtG(l.changeInfoTitle(i,r))}),t.ALo(8,"mytranslate"),t.ALo(9,"mytranslate"),t.qZA()()(),t.TgZ(10,"div",17)(11,"mat-form-field",18)(12,"mat-select",19),t.NdJ("selectionChange",function(i){const r=t.CHM(e).index,l=t.oxw();return t.KtG(l.changeTypeField(i,r))}),t.TgZ(13,"mat-option",20),t._uU(14),t.ALo(15,"mytranslate"),t.qZA(),t.TgZ(16,"mat-option",21),t._uU(17),t.ALo(18,"mytranslate"),t.qZA(),t.TgZ(19,"mat-option",22),t._uU(20),t.ALo(21,"mytranslate"),t.qZA(),t.TgZ(22,"mat-option",23),t._uU(23),t.ALo(24,"mytranslate"),t.qZA()()()(),t.TgZ(25,"div",24)(26,"button",25),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw();return t.KtG(r.removeFields(a))}),t.ALo(27,"mytranslate"),t.O4$(),t.TgZ(28,"svg",26),t._UZ(29,"path",27)(30,"path",28)(31,"path",29)(32,"line",30)(33,"line",31),t.qZA()()()(),t.YNc(34,Hu,29,20,"div",32),t.qZA()}if(2&o){const e=s.$implicit,n=s.index,i=t.oxw();t.xp6(1),t.Q6J("ngClass",t.VKq(29,zu,n!==i.infoFields.length-1)),t.xp6(4),t.AsE(" ",t.lcZ(6,13,"lang_testbank_test_config_Information")," ",n+1," "),t.xp6(2),t.s9C("placeholder",e.error?t.lcZ(8,15,"lang_testbank_test_config_request_enter_name"):t.lcZ(9,17,"lang_testbank_test_config_enter_Information_you_want_student_enter")),t.Q6J("ngClass",t.VKq(31,Yu,e.error))("value",e.title),t.xp6(5),t.s9C("value",e.type),t.xp6(2),t.hij(" ",t.lcZ(15,19,"lang_testbank_test_config_reply_short"),""),t.xp6(3),t.hij("",t.lcZ(18,21,"lang_testbank_test_config_Checkbox")," "),t.xp6(3),t.Oqu(t.lcZ(21,23,"lang_testbank_test_config_quiz")),t.xp6(3),t.hij(" ",t.lcZ(24,25,"lang_testbank_test_config_drop_down_menu"),""),t.xp6(3),t.s9C("matTooltip",t.lcZ(27,27,"lang_testbank_test_config_delete_information")),t.xp6(8),t.Q6J("ngIf",0!=e.type)}}let $u=(()=>{class o extends mt.Q{constructor(e){super(e),this.commonService=e,this.infoFields=[],this.formInfoInvalid=!1,this.infoFieldsChange=new t.vpe,this.formInfoInvalidChange=new t.vpe,this.infoContentFast=[],this.indexContent=0,this.checkDialogFastContent=[]}removeFields(e){this.infoFields.splice(e,1)}addNewFields(e){let n="";this.commonService.myTranslate(["lang_auto_thong_tin"]).subscribe(a=>{n=a.lang_auto_thong_tin}),this.infoFields.push({type:0,title:n+" "+((this.infoFields?this.infoFields.length:0)+1),contents:[]})}changeTypeField(e,n){this.infoFields[n].type!=e.value&&(this.infoFields[n].type=Number(e.value),this.infoFields[n].error=!1)}changeInfoTitle(e,n){e.target.value&&""==e.target.value?(this.formInfoInvalid=!0,this.infoFields[n].error=!0,this.infoFields[n].title=e.target.value):(this.formInfoInvalid=!1,this.infoFields[n].error=!1,this.infoFields[n].title=e.target.value)}changeInfoContent(e,n,i){e.target.value&&""!=e.target.value?(this.infoFields[n].contents[i]=e.target.value,this.formInfoInvalid=!1):(this.infoFields[n].contents[i]=e.target.value,this.formInfoInvalid=!0)}removeContent(e,n){var i;null===(i=this.infoFields[e].contents)||void 0===i||i.splice(n,1)}addMoreContent(e,n){let i="";this.commonService.myTranslate(["lang_auto_tuy_chon"]).subscribe(r=>{i=r.lang_auto_tuy_chon});let a=this.infoFields[e].contents?this.infoFields[e].contents.length:0;this.infoFields[e].contents&&Array.isArray(this.infoFields[e].contents)||(this.infoFields[e].contents=new Array),this.infoFields[e].contents.push(i+" "+(a+1))}addFastContent(e){this.indexContent=e,this.checkDialogFastContent[this.indexContent]=!0}changeDataFastContent(e,n){e.target.value&&(this.infoContentFast[n]=e.target.value,e.target.value="")}closeDialogFastContent(){this.checkDialogFastContent[this.indexContent]=!1}changeInfoFastContent(e,n){if(""!=e){let i=e.split("\n");i=i.map(a=>a.trim()),i=i.filter(a=>""!=a),this.infoFields[n].contents||(this.infoFields[n].contents=new Array),this.infoFields[n].contents=this.infoFields[n].contents.concat(i)}this.checkDialogFastContent[n]=!1}ngOnInit(){super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v))},o.\u0275cmp=t.Xpm({type:o,selectors:[["test-config-online-student-info"]],inputs:{infoFields:"infoFields",formInfoInvalid:"formInfoInvalid"},outputs:{infoFieldsChange:"infoFieldsChange",formInfoInvalidChange:"formInfoInvalidChange"},features:[t.qOj],decls:17,vars:10,consts:[[1,"border","border-slate-200/60","dark:border-darkmode-400","rounded-md","pb-1"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","items-center"],[1,"mr-auto"],[1,"p-5"],["class","info-field",4,"ngFor","ngForOf"],[1,"mt-3"],[1,"btn","btn-primary","mr-3",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr2","lucide"],["x1","12","y1","5","x2","12","y2","19"],["x1","5","y1","12","x2","19","y2","12"],[1,"inline-block","ml-3","leading-relaxed","text-slate-500","text-xs"],[1,"info-field"],[1,"grid","grid-cols-12","gap-5",3,"ngClass"],[1,"col-span-12","md:col-span-7"],[1,"input-group"],[1,"input-group-text","whitespace-nowrap"],["type","text",1,"form-control",3,"ngClass","placeholder","value","change"],[1,"col-span-8","md:col-span-3"],["appearance","outline"],[3,"value","selectionChange"],["value","0"],["value","1"],["value","2"],["value","3"],[1,"col-span-4","md:col-span-2","text-right"],[1,"btn","btn-secondary",3,"matTooltip","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],["class","info-content",4,"ngIf"],[1,"info-content"],["class","py-2",4,"ngFor","ngForOf"],[1,"py-2","flex","mb-3"],[1,"btn","btn-secondary","btn-sm","mr-2",3,"click"],[4,"ngIf"],[1,"btn","btn-secondary","btn-sm",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2"],[1,"azt-fast-content",3,"ngClass"],[1,"azt-fast","p-4"],[1,"dialog-content"],["rows","4",1,"form-control",3,"change"],[1,"leading-relaxed","text-slate-500","text-xs","mt-2"],[1,"text-right","my-4"],[1,"btn","btn-outline-secondary","btn-sm","mr-2",3,"click"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"py-2"],[1,"flex","items-center"],[1,"w-full","mx-2"],["type","text",1,"form-control",2,"border","none","box-shadow","none",3,"placeholder","value","change"],[1,"btn","btn-primary","rounded-full",2,"padding","2px",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],["type","radio","disabled","",1,"form-check-input","cursor-default"],["type","checkbox","disabled","",1,"form-check-input","cursor-default"],["x","3","y","3","width","18","height","18","rx","2","ry","2"],["x1","12","y1","8","x2","12","y2","16"],["x1","8","y1","12","x2","16","y2","12"],["cx","12","cy","12","r","10"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.TgZ(5,"div",3),t.YNc(6,Gu,35,33,"div",4),t.qZA()(),t.TgZ(7,"div",5)(8,"button",6),t.NdJ("click",function(){return n.addNewFields("")}),t.O4$(),t.TgZ(9,"svg",7),t._UZ(10,"line",8)(11,"line",9),t.qZA(),t._uU(12),t.ALo(13,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(14,"span",10),t._uU(15),t.ALo(16,"mytranslate"),t.qZA()()),2&e&&(t.xp6(3),t.hij(" ",t.lcZ(4,4,"lang_testbank_test_config_configuration")," "),t.xp6(3),t.Q6J("ngForOf",n.infoFields),t.xp6(6),t.hij(" ",t.lcZ(13,6,"lang_testbank_test_config_Information")," "),t.xp6(3),t.hij(" *",t.lcZ(16,8,"lang_testbank_test_config_click_add_infomation"),". "))},dependencies:[O.mk,O.sg,O.O5,wn.ey,De.KE,uo.gD,Wt.gM,at.bT],encapsulation:2}),o})();function Wu(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function Ku(o,s){if(1&o&&(t.TgZ(0,"option",90),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=s.$implicit,n=t.oxw(2);t.Q6J("value",e.id)("selected",e.id==n.form.controls.schoolLevel.value),t.xp6(1),t.hij(" ",t.lcZ(2,3,e.key)," ")}}function Vu(o,s){1&o&&(t.TgZ(0,"div",91),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_chon_khoi_hoc_va_mon_hoc")," "))}function Xu(o,s){if(1&o&&(t.TgZ(0,"option",90),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=s.$implicit,n=t.oxw(2);t.Q6J("value",e.id)("selected",e.id==n.form.controls.schoolSubject.value),t.xp6(1),t.hij(" ",t.lcZ(2,3,e.key)," ")}}function tm(o,s){1&o&&(t.TgZ(0,"div",92),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_thoi_gian")," "))}function em(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1,"OK"),t.qZA())}function nm(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1,"OK"),t.qZA())}function im(o,s){1&o&&(t.TgZ(0,"div",93),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_test_config_end_time_bigger_time_star"),". "))}function om(o,s){1&o&&(t.TgZ(0,"div",94),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_lua_chon_nay_cho_phep_nhung_hoc_sinh_khong_dang_ky_dang_nhap_tai_khoang_van_co_the_tham_gia_thi")," "))}function am(o,s){1&o&&(t.TgZ(0,"div",97),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_test_config_you_not_yet_class")," "))}function sm(o,s){if(1&o&&(t.TgZ(0,"div",95),t.YNc(1,am,3,3,"div",96),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.form.controls.classroomIds.errors.checkboxValidator)}}function rm(o,s){1&o&&(t.O4$(),t.kcU(),t.TgZ(0,"div",98),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_tao_de_con_giam_sat_tu_dong_an_hien_dap_an_doing")," "))}function lm(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",151)(1,"test-config-online-student-info",152),t.NdJ("infoFieldsChange",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.infoFields=i)})("formInfoInvalidChange",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.formInfoInvalid=i)}),t.qZA()()}if(2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("infoFields",e.infoFields)("formInfoInvalid",e.formInfoInvalid)}}function cm(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",156)(1,"test-config-online-mix-question",157),t.NdJ("isGroupMixQuestionChange",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.isGroupMixQuestion=i)})("checkValidateCountQuestionChange",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.checkValidateCountQuestion=i)}),t.qZA()()}if(2&o){const e=t.oxw(4);t.xp6(1),t.Q6J("form",e.form)("obj",e.obj)("minLimitMixQuestion",e.minLimitMixQuestion)("examGroupInfos",e.examGroupInfos)}}function _m(o,s){if(1&o&&(t.TgZ(0,"div",106)(1,"div",101)(2,"label",153),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.TgZ(5,"div",103)(6,"div",104),t._UZ(7,"input",154),t.qZA()(),t.YNc(8,cm,2,4,"div",155),t.qZA()),2&o){const e=t.oxw(3);t.xp6(3),t.hij(" ",t.lcZ(4,3,"lang_auto_tao_de_con")," "),t.xp6(4),t.Q6J("disabled",0==e.form.controls.mixQuestion.value),t.xp6(1),t.Q6J("ngIf",1==e.form.controls.isCreateSubTest.value&&1==e.form.controls.mixQuestion.value)}}function dm(o,s){if(1&o&&(t.TgZ(0,"div",110)(1,"div",101)(2,"label",158),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.TgZ(5,"div",121),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()(),t.TgZ(8,"div",103)(9,"div",104),t._UZ(10,"input",159),t.qZA()()()),2&o){const e=t.oxw(3);t.xp6(3),t.hij(" ",t.lcZ(4,3,"lang_auto_co_dinh_cau_hoi_dao")," "),t.xp6(3),t.hij(" ",t.lcZ(7,5,"lang_auto_khi_bat_chuc_nang_nay_he_thong_se_tu_dong_dao_cac_cau_hoi_dot")," "),t.xp6(4),t.Q6J("disabled",!e.form.controls.isCreateSubTest.value)}}function um(o,s){1&o&&(t.TgZ(0,"span",160),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_test_config_note_validate_show_point")," "))}function mm(o,s){if(1&o&&(t.TgZ(0,"span",160),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.AsE(" ",t.lcZ(2,2,"lang_testbank_test_config_all_done"),": ",e.calculateTime(e.form.controls.endTime.value,e.form.controls.minutes.value)," ")}}function hm(o,s){1&o&&(t.TgZ(0,"span",160),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_test_config_note_validate_show_point")," "))}function pm(o,s){if(1&o&&(t.TgZ(0,"span",160),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.AsE(" ",t.lcZ(2,2,"lang_testbank_test_config_all_done"),": ",e.calculateTime(e.form.controls.endTime.value,e.form.controls.minutes.value)," ")}}function gm(o,s){1&o&&(t.TgZ(0,"div",161)(1,"div",61)(2,"label",162),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.TgZ(5,"div",121)(6,"span"),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()()(),t.TgZ(9,"div",108)(10,"div",25),t._UZ(11,"input",163),t.ALo(12,"mytranslate"),t.qZA()()()),2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,3,"lang_testbank_test_config_limit_listing_audio")," "),t.xp6(4),t.Oqu(t.lcZ(8,5,"lang_testbank_test_config_empty_if_not_limit_listen")),t.xp6(4),t.MGl("placeholder"," ",t.lcZ(12,7,"lang_auto_nhap_so_luot_nghe")+" ...",""))}function fm(o,s){if(1&o){const e=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"div",99)(1,"div",100)(2,"div",101)(3,"label",102),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()(),t.TgZ(6,"div",103)(7,"div",104),t._UZ(8,"input",105),t.qZA()()(),t.TgZ(9,"div",106)(10,"div",61)(11,"label",107),t._uU(12),t.ALo(13,"mytranslate"),t.qZA()(),t.TgZ(14,"div",108)(15,"div",25),t._UZ(16,"input",109),t.ALo(17,"mytranslate"),t.qZA()()(),t.TgZ(18,"div",110)(19,"div",61)(20,"label",111),t._uU(21),t.ALo(22,"mytranslate"),t.qZA()(),t.TgZ(23,"div",108)(24,"div",62)(25,"div",112),t._UZ(26,"input",113),t.TgZ(27,"label",114),t._uU(28),t.ALo(29,"mytranslate"),t.qZA()(),t.TgZ(30,"div",115),t._UZ(31,"input",116),t.TgZ(32,"label",117),t._uU(33),t.ALo(34,"mytranslate"),t.O4$(),t.TgZ(35,"svg",21),t.ALo(36,"mytranslate"),t._UZ(37,"circle",22)(38,"line",23)(39,"line",24),t.qZA()()(),t.kcU(),t.TgZ(40,"div",66),t._UZ(41,"input",118),t.TgZ(42,"label",119),t._uU(43),t.ALo(44,"mytranslate"),t.O4$(),t.TgZ(45,"svg",21),t.ALo(46,"mytranslate"),t._UZ(47,"circle",22)(48,"line",23)(49,"line",24),t.qZA()()()()()(),t.kcU(),t.TgZ(50,"div",106)(51,"div",101)(52,"label",120),t._uU(53),t.ALo(54,"mytranslate"),t.qZA(),t.TgZ(55,"div",121),t._uU(56),t.ALo(57,"mytranslate"),t.qZA()(),t.TgZ(58,"div",103)(59,"div",122),t._UZ(60,"input",123),t.qZA()(),t.YNc(61,lm,2,2,"div",124),t.qZA(),t.TgZ(62,"div",106)(63,"div",101)(64,"label",125),t._uU(65),t.ALo(66,"mytranslate"),t.qZA(),t.TgZ(67,"div",121),t._uU(68),t.ALo(69,"mytranslate"),t.TgZ(70,"a",126),t._uU(71),t.ALo(72,"mytranslate"),t.qZA()()(),t.TgZ(73,"div",103)(74,"div",62)(75,"div",104),t._UZ(76,"input",127),t.qZA()()()(),t.YNc(77,_m,9,5,"div",128),t.YNc(78,dm,11,7,"div",129),t.TgZ(79,"div",106)(80,"div",101)(81,"label",130),t._uU(82),t.ALo(83,"mytranslate"),t.qZA(),t.TgZ(84,"div",121),t._uU(85),t.ALo(86,"mytranslate"),t.qZA()(),t.TgZ(87,"div",103)(88,"div",104),t._UZ(89,"input",131),t.qZA()()(),t.TgZ(90,"div",132)(91,"div",61)(92,"label",111),t._uU(93),t.ALo(94,"mytranslate"),t.qZA(),t.TgZ(95,"div",121),t.YNc(96,um,3,3,"span",133),t.YNc(97,mm,3,4,"span",133),t.qZA()(),t.TgZ(98,"div",108)(99,"div",62)(100,"div",112),t._UZ(101,"input",134),t.TgZ(102,"label",135),t._uU(103),t.ALo(104,"mytranslate"),t.qZA()(),t.TgZ(105,"div",115),t._UZ(106,"input",136),t.TgZ(107,"label",137),t._uU(108),t.ALo(109,"mytranslate"),t.qZA()(),t.TgZ(110,"div",66),t._UZ(111,"input",138),t.TgZ(112,"label",139),t._uU(113),t.ALo(114,"mytranslate"),t.qZA()()()()(),t.TgZ(115,"div",140)(116,"div",61)(117,"label",111),t._uU(118),t.ALo(119,"mytranslate"),t.qZA(),t.TgZ(120,"div",121),t.YNc(121,hm,3,3,"span",133),t.YNc(122,pm,3,4,"span",133),t.qZA()(),t.TgZ(123,"div",108)(124,"div",62)(125,"div",112),t._UZ(126,"input",141),t.TgZ(127,"label",142),t._uU(128),t.ALo(129,"mytranslate"),t.qZA()(),t.TgZ(130,"div",115),t._UZ(131,"input",143),t.TgZ(132,"label",144),t._uU(133),t.ALo(134,"mytranslate"),t.qZA()(),t.TgZ(135,"div",66),t._UZ(136,"input",145),t.TgZ(137,"label",146),t._uU(138),t.ALo(139,"mytranslate"),t.qZA()()()()(),t.TgZ(140,"div",147)(141,"div",61)(142,"label",148),t._uU(143),t.ALo(144,"mytranslate"),t.qZA()(),t.TgZ(145,"div",108)(146,"test-config-online-tag",149),t.NdJ("tagNamesChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.tagNames=i)}),t.qZA()()(),t.YNc(147,gm,13,9,"div",150),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(4),t.hij(" ",t.lcZ(5,37,"lang_auto_chi_cho_phep_thi_mot_lan")," "),t.xp6(8),t.hij(" ",t.lcZ(13,39,"lang_testbank_test_config_password_exam")," "),t.xp6(4),t.s9C("placeholder",t.lcZ(17,41,"lang_auto_nhap_mat_khau")+" ..."),t.xp6(5),t.hij(" ",t.lcZ(22,43,"lang_testbank_test_config_automatic_monitoring")," "),t.xp6(7),t.hij(" ",t.lcZ(29,45,"lang_testbank_test_config_off")," "),t.xp6(5),t.hij(" ",t.lcZ(34,47,"lang_auto_giam_sat_thoat_man_hinh")," "),t.xp6(2),t.s9C("matTooltip",t.lcZ(36,49,"lang_auto_azota_se_ghi_lai_cac_lan_hoc_sinh_thoat_dot")),t.xp6(8),t.hij(" ",t.lcZ(44,51,"lang_auto_giam_sat_nang_cao")," "),t.xp6(2),t.s9C("matTooltip",t.lcZ(46,53,"lang_auto_thuong_su_dung_cho_cac_ky_thi_doi_hoi_bao_mat_cao_hoc_sinh_can_dot")),t.xp6(8),t.hij(" ",t.lcZ(54,55,"lang_testbank_test_config_verify_profile_student")," "),t.xp6(3),t.hij(" ",t.lcZ(57,57,"lang_auto_khi_hoc_sinh_vao_lam_bai_se_phai_khai_bao_them_cac_thong_tin_dot")," "),t.xp6(5),t.Q6J("ngIf",1==e.form.controls.enterInfo.value),t.xp6(4),t.hij(" ",t.lcZ(66,59,"lang_auto_dao_cau_hoi_va_dap_an")," "),t.xp6(3),t.hij(" ",t.lcZ(69,61,"lang_auto_system_auto_mix_question_by_group")," "),t.xp6(3),t.hij(" ",t.lcZ(72,63,"lang_auto_xem_them")," "),t.xp6(6),t.Q6J("ngIf",0!=e.form.controls.mixQuestion.value),t.xp6(1),t.Q6J("ngIf",0!=e.form.controls.mixQuestion.value&&e.form.controls.isCreateSubTest.value),t.xp6(4),t.hij(" ",t.lcZ(83,65,"lang_auto_an_cau_hoi_nhom")," "),t.xp6(3),t.hij(" ",t.lcZ(86,67,"lang_auto_he_thong_se_an_di_phan_tieu_de_cua_moi_nhom_cau_hoi_co_trong_de_thi")," "),t.xp6(8),t.hij(" ",t.lcZ(94,69,"lang_auto_cho_xem_dap_an")," "),t.xp6(3),t.Q6J("ngIf",1==e.form.controls.whenShowAnswer.value&&(!e.form.controls.endTime.value||e.form.controls.minutes.value<=0)),t.xp6(1),t.Q6J("ngIf",1==e.form.controls.whenShowAnswer.value&&e.form.controls.endTime.value&&e.form.controls.minutes.value>0),t.xp6(6),t.hij(" ",t.lcZ(104,71,"lang_auto_khong")," "),t.xp6(5),t.hij(" ",t.lcZ(109,73,"lang_auto_khi_lam_bai_xong")," "),t.xp6(5),t.hij(" ",t.lcZ(114,75,"lang_auto_khi_tat_ca_thi_xong")," "),t.xp6(5),t.hij(" ",t.lcZ(119,77,"lang_auto_cho_xem_diem")," "),t.xp6(3),t.Q6J("ngIf",1==e.form.controls.whenShowResult.value&&(!e.form.controls.endTime.value||e.form.controls.minutes.value<=0)),t.xp6(1),t.Q6J("ngIf",1==e.form.controls.whenShowResult.value&&e.form.controls.endTime.value&&e.form.controls.minutes.value>0),t.xp6(6),t.hij(" ",t.lcZ(129,79,"lang_auto_khong")," "),t.xp6(5),t.hij(" ",t.lcZ(134,81,"lang_auto_khi_lam_bai_xong")," "),t.xp6(5),t.hij(" ",t.lcZ(139,83,"lang_auto_khi_tat_ca_thi_xong")," "),t.xp6(5),t.hij(" ",t.lcZ(144,85,"lang_testbank_test_config_add_tag")," "),t.xp6(3),t.Q6J("form",e.form)("tagNameCtrl",e.tagNameCtrl)("tagNames",e.tagNames)("allTagNames",e.allTagNames),t.xp6(1),t.Q6J("ngIf",e.isHasAudio)}}function xm(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",165)(1,"g",166)(2,"g",167),t._UZ(3,"circle",168),t.TgZ(4,"path",169),t._UZ(5,"animateTransform",170),t.qZA()()()())}function vm(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",164),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.savePublishExam(0))}),t.YNc(1,xm,6,0,"svg",89),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("disabled",e.checkValidateCountQuestion||e.formInfoInvalid||e.form.controls.classroomIds.errors),t.xp6(1),t.Q6J("ngIf",e.statusObj.loading),t.xp6(1),t.hij(" ",t.lcZ(3,3,"lang_auto_luu_nhap")," ")}}function bm(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",165)(1,"g",166)(2,"g",167),t._UZ(3,"circle",168),t.TgZ(4,"path",169),t._UZ(5,"animateTransform",170),t.qZA()()()())}const wm=function(o){return{suppressScrollX:!0,suppressScrollY:o}};function Tm(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"form",6)(4,"div",7)(5,"h3",8),t._uU(6),t.ALo(7,"mytranslate"),t.qZA(),t.TgZ(8,"div",9)(9,"div",10)(10,"div",11)(11,"div",12)(12,"label",13),t._uU(13),t.ALo(14,"mytranslate"),t.qZA()(),t.TgZ(15,"select",14),t.NdJ("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.filterSchoolSubject(i.form.controls.schoolLevel.value))}),t.TgZ(16,"option",15),t._uU(17),t.ALo(18,"mytranslate"),t.qZA(),t.YNc(19,Ku,3,5,"option",16),t.qZA(),t.YNc(20,Vu,3,3,"div",17),t.qZA(),t.TgZ(21,"div",11)(22,"div",12)(23,"label",13),t._uU(24),t.ALo(25,"mytranslate"),t.qZA()(),t.TgZ(26,"select",18)(27,"option",15),t._uU(28),t.ALo(29,"mytranslate"),t.qZA(),t.YNc(30,Xu,3,5,"option",16),t.qZA()()(),t.TgZ(31,"div",19)(32,"div",5)(33,"label",20),t._uU(34),t.ALo(35,"mytranslate"),t.O4$(),t.TgZ(36,"svg",21),t.ALo(37,"mytranslate"),t._UZ(38,"circle",22)(39,"line",23)(40,"line",24),t.qZA()()(),t.kcU(),t.TgZ(41,"div",5)(42,"div",25),t._UZ(43,"input",26),t.ALo(44,"mytranslate"),t.TgZ(45,"div",27),t._uU(46),t.ALo(47,"mytranslate"),t.qZA(),t.YNc(48,tm,3,3,"div",28),t.qZA()()(),t.TgZ(49,"div",29)(50,"div",5)(51,"label",30),t._uU(52),t.ALo(53,"mytranslate"),t.O4$(),t.TgZ(54,"svg",21),t.ALo(55,"mytranslate"),t._UZ(56,"circle",22)(57,"line",23)(58,"line",24),t.qZA()()(),t.kcU(),t.TgZ(59,"div",5)(60,"div",31)(61,"div",32)(62,"mat-form-field",33)(63,"input",34),t.NdJ("click",function(){t.CHM(e);const i=t.MAs(74);return t.KtG(i.open())}),t.ALo(64,"mytranslate"),t.qZA(),t.TgZ(65,"button",35),t.NdJ("click",function(i){return t.CHM(e),t.MAs(74).open(),t.KtG(i.stopPropagation())}),t.O4$(),t.TgZ(66,"svg",36),t._UZ(67,"path",37)(68,"path",38)(69,"path",39)(70,"path",40)(71,"path",41)(72,"path",42),t.qZA()(),t.kcU(),t.TgZ(73,"ngx-mat-datetime-picker",null,43),t.YNc(75,em,2,0,"ng-template"),t.qZA()()(),t.TgZ(76,"div",32)(77,"mat-form-field",33)(78,"input",44),t.NdJ("click",function(){t.CHM(e);const i=t.MAs(89);return t.KtG(i.open())}),t.ALo(79,"mytranslate"),t.qZA(),t.TgZ(80,"button",35),t.NdJ("click",function(i){return t.CHM(e),t.MAs(89).open(),t.KtG(i.stopPropagation())}),t.O4$(),t.TgZ(81,"svg",36),t._UZ(82,"path",37)(83,"path",38)(84,"path",39)(85,"path",40)(86,"path",41)(87,"path",42),t.qZA()(),t.kcU(),t.TgZ(88,"ngx-mat-datetime-picker",null,45),t.YNc(90,nm,2,0,"ng-template"),t.qZA()()(),t.TgZ(91,"div",46)(92,"button",47),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.clearTime())}),t.O4$(),t.TgZ(93,"svg",48),t._UZ(94,"path",49)(95,"path",50)(96,"path",51)(97,"path",52),t.qZA(),t._uU(98),t.ALo(99,"mytranslate"),t.qZA()()(),t.kcU(),t.TgZ(100,"div",53)(101,"div",54),t._uU(102),t.ALo(103,"mytranslate"),t.qZA(),t.TgZ(104,"div",55),t._uU(105),t.ALo(106,"mytranslate"),t.qZA(),t.YNc(107,im,3,3,"div",56),t.qZA()()(),t.TgZ(108,"div",57)(109,"div",58)(110,"div",59),t._uU(111),t.ALo(112,"mytranslate"),t.qZA(),t.YNc(113,om,3,3,"div",60),t.qZA(),t.TgZ(114,"div",61)(115,"div",62)(116,"div",63)(117,"input",64),t.NdJ("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.clearAllCheckBox(0))}),t.qZA(),t.TgZ(118,"label",65),t._uU(119),t.ALo(120,"mytranslate"),t.qZA()(),t.TgZ(121,"div",66)(122,"input",67),t.NdJ("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.clearAllCheckBox(2))}),t.qZA(),t.TgZ(123,"label",68),t._uU(124),t.ALo(125,"mytranslate"),t.qZA()()()(),t.TgZ(126,"div",69)(127,"div",70)(128,"div",71)(129,"h3",72),t._uU(130),t.ALo(131,"mytranslate"),t.qZA(),t.TgZ(132,"div",73),t._UZ(133,"azt-list-classroom-checkall",74),t.qZA()(),t.TgZ(134,"div",75)(135,"perfect-scrollbar",76),t.ALo(136,"isMobileOrTable"),t.TgZ(137,"azt-list-classroom-checkbox",77),t.NdJ("objsChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.classroomObjs=i)}),t.qZA()()()()(),t.YNc(138,sm,2,1,"div",78),t.qZA()()(),t.TgZ(139,"div",79)(140,"h3",80),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.toggleAdvancedSetting())}),t.TgZ(141,"span",81),t._uU(142),t.ALo(143,"mytranslate"),t.qZA(),t.O4$(),t.TgZ(144,"svg",82),t._UZ(145,"polyline",83),t.qZA(),t.YNc(146,rm,3,3,"div",84),t.qZA(),t.YNc(147,fm,148,87,"div",85),t.qZA(),t.kcU(),t.TgZ(148,"div",86),t.YNc(149,vm,4,5,"button",87),t.TgZ(150,"button",88),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.savePublishExam(1))}),t.YNc(151,bm,6,0,"svg",89),t._uU(152),t.ALo(153,"mytranslate"),t.qZA()()()()()()}if(2&o){const e=t.MAs(74),n=t.MAs(89),i=t.oxw();t.xp6(3),t.Q6J("formGroup",i.form),t.xp6(3),t.hij(" ",t.lcZ(7,50,"lang_auto_cau_hinh_chung")," "),t.xp6(7),t.hij(" ",t.lcZ(14,52,"lang_auto_khoi_hoc")," "),t.xp6(3),t.Q6J("selected",0==i.form.controls.schoolLevel.value),t.xp6(1),t.hij("",t.lcZ(18,54,"lang_auto_---chon_khoi"),"---"),t.xp6(2),t.Q6J("ngForOf",i.schoolLevelObjs),t.xp6(1),t.Q6J("ngIf",0==i.form.controls.schoolLevel.value||0==i.form.controls.schoolSubject.value),t.xp6(4),t.hij(" ",t.lcZ(25,56,"lang_auto_mon_hoc")," "),t.xp6(2),t.uIk("disabled",0==i.form.controls.schoolLevel.value?"":null),t.xp6(1),t.Q6J("selected",0==i.form.controls.schoolSubject.value),t.xp6(1),t.hij("",t.lcZ(29,58,"lang_auto_---chon_mon"),"---"),t.xp6(2),t.Q6J("ngForOf",i.subjectSelectedList),t.xp6(4),t.hij(" ",t.lcZ(35,60,"lang_testbank_test_config_time_test_minutes")," "),t.xp6(2),t.s9C("matTooltip",t.lcZ(37,62,"lang_auto_thoi_gian_lam_bai_cua_hoc_sinh")),t.xp6(7),t.s9C("placeholder",t.lcZ(44,64,"lang_auto_nhap_thoi_gian")+" ..."),t.xp6(3),t.hij(" ",t.lcZ(47,66,"lang_testbank_test_config_enter_0_unlimited_time")," "),t.xp6(2),t.Q6J("ngIf",i.form.controls.minutes.errors),t.xp6(4),t.hij(" ",t.lcZ(53,68,"lang_testbank_test_config_time_assign_exam")," "),t.xp6(2),t.s9C("matTooltip",t.lcZ(55,70,"lang_auto_hoc_sinh_lam_bai_online_chi_duoc_lam_bai_vao_thoi_gian_giao_de")),t.xp6(9),t.s9C("placeholder",t.lcZ(64,72,"lang_auto_tu")),t.Q6J("ngxMatDatetimePicker",e),t.xp6(15),t.s9C("placeholder",t.lcZ(79,74,"lang_auto_den")),t.Q6J("ngxMatDatetimePicker",n),t.xp6(20),t.hij(" ",t.lcZ(99,76,"lang_auto_dat_lai")," "),t.xp6(4),t.hij(" ",t.lcZ(103,78,"lang_testbank_test_config_tutorial_time_assigne_exam"),". "),t.xp6(3),t.hij(" ",t.lcZ(106,80,"lang_auto_bo_trong_neu_khong_muon_gioi_han_thoi_gian"),". "),t.xp6(2),t.Q6J("ngIf",i.calculatorTimeValidate(i.form.controls.endTime.value,i.form.controls.startTime.value)<0),t.xp6(4),t.hij(" ",t.lcZ(112,82,"lang_testbank_test_config_who_tested")," "),t.xp6(2),t.Q6J("ngIf",0==i.form.controls.whoAllow.value),t.xp6(6),t.hij(" ",t.lcZ(120,84,"lang_testbank_test_config_all_people")," "),t.xp6(5),t.hij(" ",t.lcZ(125,86,"lang_testbank_test_config_assigne_class")," "),t.xp6(2),t.Q6J("hidden",2!=i.form.controls.whoAllow.value),t.xp6(4),t.hij(" ",t.lcZ(131,88,"lang_auto_danh_sach_cac_lop")," "),t.xp6(3),t.Q6J("form",i.form)("objs",i.classroomObjs)("permissionName",i.permissionTypes.exam),t.xp6(2),t.Q6J("config",t.VKq(96,wm,t.lcZ(136,90,"")))("scrollIndicators",!0),t.xp6(2),t.Q6J("form",i.form)("objs",i.classroomObjs)("examClassroomObjs",i.examClassroomObjs)("permissionName",i.permissionTypes.exam),t.xp6(1),t.Q6J("ngIf",i.form.controls.classroomIds.errors),t.xp6(4),t.hij(" ",t.lcZ(143,92,"lang_auto_cau_hinh_nang_cao")," "),t.xp6(4),t.Q6J("ngIf",!i.showAdvancedSetting),t.xp6(1),t.Q6J("ngIf",i.showAdvancedSetting),t.xp6(2),t.Q6J("ngIf",0==i.obj.isPublished),t.xp6(1),t.Q6J("disabled",i.checkValidateCountQuestion||i.formInfoInvalid||i.form.controls.classroomIds.errors),t.xp6(1),t.Q6J("ngIf",i.statusObj.loading),t.xp6(1),t.hij(" ",t.lcZ(153,94,"lang_auto_xuat_ban")," ")}}let Cm=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l){super(e),this.commonService=e,this.formBuilder=n,this.activeRoute=i,this.timeService=a,this.documentConfigService=r,this.sEAztClassroomCheckboxService=l,this.form=new h.nJ({}),this.permissionTypes=en.$,this.backToLink="",this.hashId="",this.prevData="",this.isSelectClassroom=!1,this.showAdvancedSetting=!1,this.tagNameCtrl=new h.p4,this.tagNames=[],this.allTagNames=[],this.obj={},this.classroomObjs=[],this.examClassroomObjs=[],this.isGroupMixQuestion=!1,this.checkValidateCountQuestion=!1,this.hasGroupQuestion=!1,this.minLimitMixQuestion=0,this.examGroupInfos=[],this.schoolLevelObjs=[],this.schoolSubjectObjs=[],this.subjectSelectedList=[],this.infoFields=[],this.formInfoInvalid=!1,this.isHasAudio=0,this.modeView="general"}changModeView(e){var n;this.modeView=e,null===(n=document.getElementById(e))||void 0===n||n.scrollIntoView({behavior:"smooth"})}getGroupMixInfosSubmit(e){let n={};return e.forEach(i=>{var a;n.hasOwnProperty(i.groupId)||(n[i.groupId]=null!==(a=i.totalQuestion)&&void 0!==a?a:0)}),JSON.stringify({status:this.isGroupMixQuestion?1:0,objs:n})}clearTime(){this.form.controls.startTime.setValue(""),this.form.controls.endTime.setValue("")}calculateTime(e,n){let i=Mo(e,"YYYY-MM-DD[T]HH:mm:ss").add(n,"minutes").valueOf()/1e3;return Mo.unix(i).format("DD-MM-YYYY HH:mm:ss")}calculatorTimeValidate(e,n){return""!=e&&""!=n?this.timeService.calculationHomeworkTime(e,n):0}checkInfosField(e){let n="",i="",a="";if(this.commonService.myTranslate(["lang_auto_ho_ten"]).subscribe(r=>{n=r.lang_auto_ho_ten}),this.commonService.myTranslate(["lang_auto_lop"]).subscribe(r=>{i=r.lang_auto_lop}),this.commonService.myTranslate(["lang_auto_truong"]).subscribe(r=>{a=r.lang_auto_truong}),null==e||""==e)this.infoFields.push({type:0,title:n,contents:[]}),this.infoFields.push({type:0,title:i,contents:[]}),this.infoFields.push({type:0,title:a,contents:[]});else{let r=this.commonService.myParseJson(e);this.infoFields=null!=r?r:[]}}checkValidInfoField(){for(let e=0;e<this.infoFields.length;e++)if(0!=this.infoFields[e].type){if(!(this.infoFields[e].contents&&this.infoFields[e].contents.length>0)){this.formInfoInvalid=!0,this.infoFields[e].error=!0;break}{let n=this.infoFields[e].contents.filter(i=>""==i);if(n&&n.length>0){this.formInfoInvalid=!0,this.infoFields[e].error=!0;break}this.formInfoInvalid=!1}}else this.formInfoInvalid=!1}filterSubject(e){let n=this.commonService.myClone(this.schoolSubjectObjs);this.subjectSelectedList=n.filter(i=>!(i.from&&i.to&&e)||e>=i.from&&e<=i.to)}filterSchoolSubject(e){var n,i;if(0==this.subjectSelectedList.length)this.filterSubject(null!=e?e:1);else{let a=!1;for(let r=0;r<this.subjectSelectedList.length;r++)e&&(e<(null!==(n=this.subjectSelectedList[r].from)&&void 0!==n?n:0)||e>(null!==(i=this.subjectSelectedList[r].to)&&void 0!==i?i:0))&&(a=!0);a&&(this.filterSubject(null!=e?e:1),this.form.controls.schoolSubject.setValue(0))}}clearAllCheckBox(e){this.isSelectClassroom=2==e}toggleAdvancedSetting(){this.showAdvancedSetting=!this.showAdvancedSetting}redirectBackTo(){this.myNavigationBySpecialQueryString(this.backToLink)}savePublishExam(e){var n;let i=null!==(n=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")))&&void 0!==n?n:0,a=this.commonService.getFormObj(this.form);const r=this.tagNameCtrl.value;if(null!=r&&r.trim()&&this.tagNames.push(r.trim()),this.calculatorTimeValidate(a.endTime,a.startTime)<0)return void this.showErrorSnack("lang_testbank_test_config_end_time_bigger_time_star");if(("1"==a.whenShowAnswer||"1"==a.whenShowResult)&&(!a.endTime||a.minutes<=0))return void this.showErrorSnack("lang_auto_vui_long_nhap_thoi_gian_giao_de_va_thoi_gian_lam_bai_khi_chon_khi_tat_ca_thi_xong");a.startTime=""===a.startTime||null===a.startTime?null:(0,O.p6)(a.startTime,"yyyy-MM-ddTHH:mm:00 Z","en_vn"),a.endTime=""===a.endTime||null===a.endTime?null:(0,O.p6)(a.endTime,"yyyy-MM-ddTHH:mm:00 Z","en_vn"),a.isTakeTestOnce=1!=a.isTakeTestOnce?0:1,a.limitAudio=a.limitAudio>0?a.limitAudio:0,a.mixQuestion=a.mixQuestion?2:0,a.limitMixQuestion=a.limitMixQuestion>0?a.limitMixQuestion:0,a.enterInfo=1!=a.enterInfo?0:1;let l=this.getGroupMixInfosSubmit(a.groupInfos),c=a.isCreateSubTest&&1==a.mixQuestion?2:a.mixQuestion;if(1==a.enterInfo?this.checkValidInfoField():this.formInfoInvalid=!1,a.isCreateSubTest||(this.checkValidateCountQuestion=!1),this.formInfoInvalid||this.checkValidateCountQuestion)return void this.showErrorSnack("lang_auto_loi_hay_chac_chan_ban_da_dien_du_thong_tin");if(this.form.controls.classroomIds.errors)return void this.showErrorSnack("lang_auto_please_select_classroom");var _=this.sEAztClassroomCheckboxService.findClassroomWithNoPermission(this.classroomObjs,en.$.exam);const d=this.sEAztClassroomCheckboxService.getClassroomIdsChecked(this.classroomObjs,_,a.classroomIds);this.initStatusObj();let m={minutes:a.minutes,password:a.password,startTime:a.startTime,endTime:a.endTime,whenShowAnswer:a.whenShowAnswer,whenShowResult:a.whenShowResult,whoAllow:a.whoAllow,isPublished:null!=e?e:void 0,autoMonitor:a.autoMonitor,limitAudio:a.limitAudio,tags:this.tagNames,isTakeTestOnce:a.isTakeTestOnce,mixQuestion:c,fixMixQuestion:a.fixMixQuestion?1:0,limitMixQuestion:a.limitMixQuestion,enterInfo:a.enterInfo,classroomIds:d,infoFieldsV2:JSON.stringify(this.infoFields),price:a.price,isSaveconfig:1,hideGroupQuestion:a.hideGroupQuestion?1:0,limitQuestionGroups:l,schoolLevelId:Number(a.schoolLevel),schoolSubjectId:Number(a.schoolSubject)};this.subscriptions.add(this.documentConfigService.apiDocumentConfigSaveExamConfigPost(m,this.hashId).subscribe(p=>{var w;if(1==p.success){if(e){let C=`/admin/testbank/config-exam-online/${null!=i?i:0}/${this.obj.hashId}?backto=`+encodeURIComponent(this.backToLink);this.commonService.myNavigationWithQueryString(`/admin/testbank/publish-document/0/${null!=i?i:0}/${this.obj.hashId}`,"?backto="+encodeURIComponent(C))}else this.commonService.myNavigation(`/admin/testbank/document-management/0/${null!=i?i:0}/1`);this.successStatusObj()}else this.errorStatusObj(null!==(w=p.message)&&void 0!==w?w:"",!0)}))}getExamDataByHashId(e){this.initStatusObj(),this.subscriptions.add(this.documentConfigService.apiDocumentConfigGetExamConfigDataGet(e).subscribe(n=>{var i,a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt,W,P;if(1==n.success){if(null!=n.data){let R=null!==(a=null===(i=n.data)||void 0===i?void 0:i.examObj)&&void 0!==a?a:{},N=null!==(r=this.castObj(R))&&void 0!==r?r:{};if(N.limitQuestionGroupsParse=this.commonService.myParseJson(null!==(l=R.limitQuestionGroups)&&void 0!==l?l:""),this.obj=N,this.hasGroupQuestion=!(null===(c=n.data)||void 0===c||!c.hasGroupQuestion),this.minLimitMixQuestion=null!==(_=n.data.minLimitMixQuestion)&&void 0!==_?_:0,this.examGroupInfos=n.data.examGroupInfos&&n.data.examGroupInfos.length>0?n.data.examGroupInfos:this.examGroupInfos,this.classroomObjs=null!==(d=n.data.classroomObjs)&&void 0!==d?d:new Array,this.examClassroomObjs=null!==(m=n.data.examClassroomObjs)&&void 0!==m?m:[],n.data.examTagObjs)for(let J=0;J<n.data.examTagObjs.length;J++)this.tagNames.push(null!==(p=n.data.examTagObjs[J].name)&&void 0!==p?p:"");if(n.data.allTagObjs)for(let J=0;J<n.data.allTagObjs.length;J++)this.allTagNames.push(null!==(w=n.data.allTagObjs[J].name)&&void 0!==w?w:"");this.schoolLevelObjs=null!==(C=n.data.schoolLevelObjs)&&void 0!==C?C:[],this.schoolSubjectObjs=null!==(A=n.data.schoolSubjectObjs)&&void 0!==A?A:[];let B=this.obj.schoolLevelId?this.obj.schoolLevelId:null!==(D=null===(M=n.data.examSchoolLogObj)||void 0===M?void 0:M.lastSchoolLevelId)&&void 0!==D?D:0,z=this.obj.schoolSubjectId?this.obj.schoolSubjectId:null!==(U=null===(q=n.data.examSchoolLogObj)||void 0===q?void 0:q.lastSchoolSubjectId)&&void 0!==U?U:0;this.filterSchoolSubject(null!=B?B:this.schoolLevelObjs[0].id),this.hashId=null!==(F=this.obj.hashId)&&void 0!==F?F:"",this.isHasAudio=null!==(tt=n.data.isHasAudio)&&void 0!==tt?tt:0;let X=2==this.obj.mixQuestion,V=2==this.obj.mixQuestion;this.isSelectClassroom="2"==String(this.obj.whoAllow),this.form.patchValue({schoolLevel:B,schoolSubject:z,isTakeTestOnce:0!=this.obj.isTakeTestOnce,password:this.obj.password,price:null!=this.obj.price?Number(this.obj.price):0,autoMonitor:String(this.obj.autoMonitor),minutes:this.obj.minutes,startTime:null!=this.obj.startTime?this.obj.startTime:"",endTime:null!=this.obj.endTime?this.obj.endTime:"",whenShowAnswer:String(this.obj.whenShowAnswer),whenShowResult:String(this.obj.whenShowResult),whoAllow:String(this.obj.whoAllow),mixQuestion:V,isCreateSubTest:X,limitMixQuestion:this.obj.limitMixQuestion,fixMixQuestion:1==this.obj.fixMixQuestion,hideGroupQuestion:1==this.obj.hideGroupQuestion,limitAudio:null!=this.obj.limitAudio?Number(this.obj.limitAudio):0,enterInfo:0!=this.obj.enterInfo}),this.checkInfosField(null!==(W=this.obj.infoFieldsV2)&&void 0!==W?W:""),this.successStatusObj()}}else this.errorStatusObj(null!==(P=n.message)&&void 0!==P?P:"",!0)}))}ngOnInit(){var e,n,i;this.form=this.formBuilder.group({schoolLevel:new h.p4(0,[h.kI.required]),schoolSubject:new h.p4(0,[h.kI.required]),minutes:[60,[h.kI.required,h.kI.min(0)]],startTime:new h.p4(""),endTime:new h.p4("",[h.kI.required]),isTakeTestOnce:new h.p4("0"),autoMonitor:new h.p4("0"),password:new h.p4(""),whenShowAnswer:new h.p4("0"),whenShowResult:new h.p4("0"),whoAllow:new h.p4("0"),classroomIds:this.formBuilder.array([]),mixQuestion:new h.p4(!1),isCreateSubTest:new h.p4(!1),limitMixQuestion:new h.p4("",[h.kI.required]),groupInfos:new h.vC([]),fixMixQuestion:new h.p4(!1),enterInfo:new h.p4(!1),price:new h.p4(0,[h.kI.min(0)]),limitAudio:new h.p4(0,[h.kI.min(0)]),hideGroupQuestion:new h.p4("0")},{validators:[Zu.customDateTimeValidator,Li.h.classroomCheckBoxValidator]}),this.form.valueChanges.subscribe(c=>{let _=JSON.stringify(c);_!=this.prevData&&(this.prevData=_,this.form.patchValue(c))}),this.commonService.translateMetaData({title:"lang_cms__config_title",description:"lang_cms_test_config_online_description",image:""});let a=null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")))&&void 0!==e?e:0,r=null!==(n=this.commonService.getMyParam(this.activeRoute,"hash_id"))&&void 0!==n?n:"",l=null!==(i=this.commonService.getMyQueryParam("backto"))&&void 0!==i?i:"";this.backToLink=l||`/admin/testbank/document-management/0/${a}/1`,this.getExamDataByHashId(r),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(h.QS),t.Y36(x.gz),t.Y36(Tn.O),t.Y36(Mu.C),t.Y36(Ni.L))},o.\u0275cmp=t.Xpm({type:o,selectors:[["test-config-online"]],features:[t._Bn([{provide:Ve.fM,useClass:Pi.HF,deps:[wn.Ad,Zi.o8]},{provide:Ve.ab,useValue:Mi.O}]),t.qOj],decls:4,vars:3,consts:[[3,"headerBackTolink"],[4,"ngIf","ngIfElse"],["doneLoading",""],["id","azt-config-document",1,"azt-config-document","mx-auto",2,"max-width","1000px"],[1,"grid","grid-cols-12","gap-5","mt-5"],[1,"col-span-12"],[3,"formGroup"],[1,"setting-basic"],[1,"text-md","uppercase","font-medium"],["id","general",1,"box","p-5","mt-3"],["id","azt-config-level-subject",1,"grid","grid-cols-12","gap-5"],[1,"col-span-12","lg:col-span-6"],[1,"font-medium"],[1,"form-label","mb-0","flex","items-center"],["formControlName","schoolLevel",1,"form-select",3,"change"],["value","0","disabled","",3,"selected"],[3,"value","selected",4,"ngFor","ngForOf"],["class","text-xs mt-1 text-danger",4,"ngIf"],["formControlName","schoolSubject",1,"form-select"],["id","azt-config-time-minutes",1,"grid","grid-cols-12","mt-4"],["for","document-time-minutes",1,"form-label","mb-0","font-medium","flex","items-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","ml-2",3,"matTooltip"],["cx","12","cy","12","r","10"],["x1","12","y1","16","x2","12","y2","12"],["x1","12","y1","8","x2","12.01","y2","8"],[1,"setting-input"],["id","document-time-minutes","appOnlyNumber","","formControlName","minutes","type","text",1,"form-control",3,"placeholder"],[1,"text-xs","text-slate-500","mt-1"],["class","text-xs text-danger mt-1",4,"ngIf"],["id","azt-config-time-assignment",1,"grid","grid-cols-12","mt-4"],["for","regular-form-1",1,"form-label","mb-0","font-medium","flex","items-center"],[1,"grid","grid-cols-12","gap-3"],[1,"col-span-12","md:col-span-5"],["appearance","outline"],["matInput","","formControlName","startTime","readonly","",3,"placeholder","ngxMatDatetimePicker","click"],["matSuffix","",2,"font-size","18px",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide"],["d","M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5"],["d","M16 2v4"],["d","M8 2v4"],["d","M3 10h5"],["d","M17.5 17.5 16 16.25V14"],["d","M22 16a6 6 0 1 1-12 0 6 6 0 0 1 12 0Z"],["startTime",""],["matInput","","formControlName","endTime","readonly","",3,"placeholder","ngxMatDatetimePicker","click"],["endTime",""],[1,"col-span-6","md:col-span-2"],[1,"btn","btn-outline-secondary","w-full",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["d","M10 2h4"],["d","M12 14v-4"],["d","M4 13a8 8 0 0 1 8-7 8 8 0 1 1-5.3 14L4 17.6"],["d","M9 17H4v5"],[1,"text-xs","mt-2"],[1,"text-slate-500"],[1,"text-slate-500","mt-1"],["class","text-danger mt-1",4,"ngIf"],["id","azt-config-who-allow",1,"grid","grid-cols-12","mt-4"],[1,"col-span-12","lg:col-span-5","pr-5"],[1,"mb-0","font-medium","flex","items-center"],["class","leading-relaxed text-slate-500 text-xs mt-2",4,"ngIf"],[1,"col-span-12","lg:col-span-5"],[1,"flex","flex-col","sm:flex-row"],[1,"form-check","mr-10"],["id","config-who-all","formControlName","whoAllow","type","radio","value","0",1,"form-check-input",3,"change"],["for","config-who-all",1,"form-check-label"],[1,"form-check","mt-2","sm:mt-0"],["id","config-who-class","formControlName","whoAllow","type","radio","value","2",1,"form-check-input",3,"change"],["for","config-who-class",1,"form-check-label"],[1,"col-span-12","mt-4","intro-y",3,"hidden"],[1,"border","border-slate-200/60","dark:border-darkmode-400","rounded-md","pb-1"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","items-center"],[1,"mr-auto"],[1,"flex"],["formArrayName","classroomIds",3,"form","objs","permissionName"],[1,"classroom_list"],[3,"config","scrollIndicators"],["formArrayName","classroomIds",3,"form","objs","examClassroomObjs","permissionName","objsChange"],["class","col-span-12 mt-2 intro-y",4,"ngIf"],[1,"setting-advanced","mt-5"],[1,"text-md","flex","items-center","font-medium","mr-2","cursor-pointer",3,"click"],[1,"uppercase"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","ml-2"],["points","6 9 12 15 18 9"],["class","ml-5 text-md text-slate-600 hidden lg:block",4,"ngIf"],["class","box p-5 mt-3","id","advanced",4,"ngIf"],[1,"text-right","mt-5"],["class","btn w-24 btn-pending mr-2",3,"disabled","click",4,"ngIf"],[1,"btn","w-24","btn-primary",3,"disabled","click"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","white","class","w-4 h-4 mr-2",4,"ngIf"],[3,"value","selected"],[1,"text-xs","mt-1","text-danger"],[1,"text-xs","text-danger","mt-1"],[1,"text-danger","mt-1"],[1,"leading-relaxed","text-slate-500","text-xs","mt-2"],[1,"col-span-12","mt-2","intro-y"],["class","text-xs text-danger",4,"ngIf"],[1,"text-xs","text-danger"],[1,"ml-5","text-md","text-slate-600","hidden","lg:block"],["id","advanced",1,"box","p-5","mt-3"],[1,"grid","grid-cols-12"],[1,"col-span-10","lg:col-span-5"],["for","config-once-test",1,"form-label","mb-0","font-medium","flex","items-center"],[1,"col-span-2","lg:col-span-7"],[1,"setting-input","form-switch"],["id","config-once-test","formControlName","isTakeTestOnce","type","checkbox",1,"show-code","form-check-input"],[1,"grid","grid-cols-12","mt-4"],["for","config-password",1,"form-label","mt-2","mb-0","font-medium","flex","items-center"],[1,"col-span-12","lg:col-span-7"],["type","text","id","config-password","formControlName","password","type","text",1,"form-control",3,"placeholder"],[1,"grid","grid-cols-12","mt-5"],[1,"form-label","mb-0","font-medium","flex","items-center"],[1,"form-check","mr-8"],["id","automatic-off","type","radio","formControlName","autoMonitor","value","0",1,"form-check-input"],["for","automatic-off",1,"form-check-label"],[1,"form-check","mr-8","mt-2","sm:mt-0"],["id","automatic-exit-monitor","type","radio","formControlName","autoMonitor","value","1",1,"form-check-input"],["for","automatic-exit-monitor",1,"form-check-label","flex","items-center"],["id","automatic-advanced","type","radio","formControlName","autoMonitor","value","3",1,"form-check-input"],["for","automatic-advanced",1,"form-check-label","flex","items-center"],["for","config-verify-student",1,"form-label","mb-0","font-medium","flex","items-center"],[1,"leading-relaxed","text-slate-500","text-xs","mt-2","pr-5"],[1,"setting-input","form-switch","ml-"],["id","config-verify-student","formControlName","enterInfo","type","checkbox",1,"show-code","form-check-input"],["class","intro-y col-span-12 mt-5",4,"ngIf"],["for","config-mix-question",1,"form-label","mb-0","font-medium","flex","items-center"],["href","https://docs.azota.vn/","target","_blank",1,"text-primary","font-medium"],["id","config-mix-question","formControlName","mixQuestion","type","checkbox",1,"show-code","form-check-input"],["class","grid grid-cols-12 mt-4",4,"ngIf"],["class","grid grid-cols-12 mt-5",4,"ngIf"],["for","config-hide-group-header",1,"form-label","mb-0","font-medium","flex","items-center"],["id","config-hide-group-header","formControlName","hideGroupQuestion","type","checkbox",1,"show-code","form-check-input"],["id","whenShowAnswer-block",1,"grid","grid-cols-12","mt-4"],["class","clearfix pt-1",4,"ngIf"],["id","whenShowAnswer-off","type","radio","formControlName","whenShowAnswer","value","2",1,"form-check-input"],["for","whenShowAnswer-off",1,"form-check-label"],["id","whenShowAnswer-tested","type","radio","formControlName","whenShowAnswer","value","0",1,"form-check-input"],["for","whenShowAnswer-tested",1,"form-check-label","flex","items-center"],["id","whenShowAnswer-advanced","type","radio","formControlName","whenShowAnswer","value","1",1,"form-check-input"],["for","whenShowAnswer-advanced",1,"form-check-label","flex","items-center"],["id","whenShowResult-block",1,"grid","grid-cols-12","mt-4"],["id","whenShowResult-off","type","radio","formControlName","whenShowResult","value","2",1,"form-check-input"],["for","whenShowResult-off",1,"form-check-label"],["id","whenShowResult-tested","type","radio","formControlName","whenShowResult","value","0",1,"form-check-input"],["for","whenShowResult-tested",1,"form-check-label","flex","items-center"],["id","whenShowResult-advanced","type","radio","formControlName","whenShowResult","value","1",1,"form-check-input"],["for","whenShowResult-advanced",1,"form-check-label","flex","items-center"],["id","tag-block",1,"grid","grid-cols-12","mt-4"],[1,"form-label","mt-2","font-medium","flex","items-center"],[2,"width","100%",3,"form","tagNameCtrl","tagNames","allTagNames","tagNamesChange"],["class","grid grid-cols-12 mt-4","id","exam-audio",4,"ngIf"],[1,"intro-y","col-span-12","mt-5"],[3,"infoFields","formInfoInvalid","infoFieldsChange","formInfoInvalidChange"],["for","config-create-sub",1,"form-label","mb-0","font-medium","flex","items-center"],["id","config-create-sub","formControlName","isCreateSubTest","type","checkbox",1,"show-code","form-check-input",3,"disabled"],["class","col-span-12 mt-4 intro-y",4,"ngIf"],[1,"col-span-12","mt-4","intro-y"],["formArrayGroupInfosName","groupInfos","formControlLimitMixQuestionName","limitMixQuestion",3,"form","obj","minLimitMixQuestion","examGroupInfos","isGroupMixQuestionChange","checkValidateCountQuestionChange"],["for","config-fix-mix",1,"form-label","mb-0","font-medium","flex","items-center"],["id","config-fix-mix","formControlName","fixMixQuestion","type","checkbox",1,"show-code","form-check-input",3,"disabled"],[1,"clearfix","pt-1"],["id","exam-audio",1,"grid","grid-cols-12","mt-4"],["for","config-audio",1,"form-label","mt-2","mb-0","font-medium","flex","items-center"],["type","text","id","config-audio","appOnlyNumber","","formControlName","limitAudio",1,"form-control",3,"placeholder"],[1,"btn","w-24","btn-pending","mr-2",3,"disabled","click"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","white",1,"w-4","h-4","mr-2"],["fill","none","fill-rule","evenodd"],["transform","translate(1 1)","stroke-width","4"],["stroke-opacity",".5","cx","18","cy","18","r","18"],["d","M36 18c0-9.94-8.06-18-18-18"],["attributeName","transform","type","rotate","from","0 18 18","to","360 18 18","dur","1s","repeatCount","indefinite"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0),t.YNc(1,Wu,1,0,"azt-loading-effect",1),t.YNc(2,Tm,154,98,"ng-template",null,2,t.W1O),t.qZA()),2&e){const i=t.MAs(3);t.Q6J("headerBackTolink",n.backToLink),t.xp6(1),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.sg,O.O5,De.KE,De.R9,si.Nt,Wt.gM,Ve.AB,Ve.g2,Lt.Vv,h._Y,h.YN,h.Kr,h.Fj,h.Wl,h.EJ,h._,h.JJ,h.JL,h.sg,h.u,h.CE,te.Q,un.Y,oe.M,ri.o,li.g,de._,ju,$u,So,at.bT,at.bd],encapsulation:2}),o})(),Po=(()=>{class o extends mt.Q{constructor(e,n){super(e),this.commonService=e,this.activeRoute=n,this.backToLink="",this.homeworkHashId=""}redirectBackTo(){this.myNavigationBySpecialQueryString(this.backToLink)}ngOnInit(){(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var e,n,i;let a=null!==(e=this.commonService.getMyParam(this.activeRoute,"cat_id"))&&void 0!==e?e:"";this.homeworkHashId=null!==(n=this.commonService.getMyParam(this.activeRoute,"hash_id"))&&void 0!==n?n:"",this.backToLink=null!==(i=this.commonService.getMyQueryParam("backto"))&&void 0!==i?i:"";let r=this.commonService.getMyQueryParam("backto");this.backToLink=null!=r?r:`/admin/testbank/document-management/1/${null!=a?a:0}/1`}),this.commonService.translateMetaData({title:"lang_cms__config_title",description:"lang_cms_config_homework_description",image:""}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(x.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-config-homework"]],features:[t.qOj],decls:2,vars:1,consts:[[3,"headerBackTolink"],[3,"onBack"]],template:function(e,n){1&e&&(t.TgZ(0,"teacher-layout",0)(1,"main-config-homework",1),t.NdJ("onBack",function(){return n.redirectBackTo()}),t.qZA()()),2&e&&t.Q6J("headerBackTolink",n.backToLink)},dependencies:[de._,ho]}),o})();var fi=b(81760),Am=b(50491);let ym=(()=>{class o extends mt.Q{constructor(e,n,i){super(e),this.commonService=e,this.activeRoute=n,this.mobileWebviewService=i,this.linkCopy="",this.offlineCode="",this.hasOfflineExam=!1,this.checkValueInput=!1,this.form=new h.nJ({}),this.classroomObjs=[],this.isCheckAll=!1,this.shareClassroomIds=[],this.classIdsNotPermission=[],this.hashId="",this.cateId=""}ngOnInit(){var e;this.hashId=null!==(e=this.commonService.getMyParam(this.activeRoute,"hash_id"))&&void 0!==e?e:"0",super.ngOnInit(),this.mobileWebviewService.sendComponentLoaded("config_offline_result")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(x.gz),t.Y36(fi.F))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-config-share-offline-result"]],features:[t.qOj],decls:1,vars:2,consts:[[3,"examHashId","useDialog"]],template:function(e,n){1&e&&t._UZ(0,"azt-offline-share",0),2&e&&t.Q6J("examHashId",n.hashId)("useDialog",!1)},dependencies:[Am.W],styles:[".school-info_bg[_ngcontent-%COMP%]{background:#fff;height:100vh}.block-note[_ngcontent-%COMP%]{padding:5px}.note[_ngcontent-%COMP%]{color:#acacac}.btn-close[_ngcontent-%COMP%]{transition:all .5s}.btn-close[_ngcontent-%COMP%]:hover{background:#dfe6e9}mat-radio-group[_ngcontent-%COMP%]{margin:10px 5px;width:90%;display:flex;justify-content:space-between}.block-title[_ngcontent-%COMP%]{text-align:center;font-size:18px;font-weight:500}.block-main-classroom[_ngcontent-%COMP%]{padding:10px;border:1px solid #908e8e;border-radius:5px;height:200px;overflow:hidden}.classroom-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:15px}.btn-copy[_ngcontent-%COMP%]{border-radius:5px;transition:all .5s;text-transform:inherit}.btn-copy[_ngcontent-%COMP%]:hover:not([disabled]){background:#16236c}"]}),o})();var km=b(75238),Lo=b(81611),No=b(9224),Om=b(25157);function Sm(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",4)(1,"form",5)(2,"div",6),t.NdJ("click",function(){t.CHM(e);const i=t.MAs(9);return t.KtG(i.click())}),t.TgZ(3,"div",7),t.NdJ("filesChangeEmiter",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onFileSelected(i))}),t.TgZ(4,"div",8)(5,"a",9)(6,"mat-icon"),t._uU(7,"cloud_upload"),t.qZA()(),t.TgZ(8,"input",10,11),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onFileSelected(i.target.files))}),t.qZA(),t.TgZ(10,"span",12),t._uU(11),t.ALo(12,"mytranslate"),t.qZA(),t.TgZ(13,"div"),t._uU(14),t.ALo(15,"mytranslate"),t.qZA(),t.TgZ(16,"div")(17,"a",13),t.NdJ("click",function(i){return i.stopPropagation()}),t.ALo(18,"convertLink"),t.ALo(19,"mytranslate"),t._uU(20),t.ALo(21,"mytranslate"),t.qZA()()()()()()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(10),t.Oqu(t.lcZ(12,6,"lang_student_utils_click_choose_file")),t.xp6(3),t.hij(" ",t.lcZ(15,8,"lang_auto_click_vao_day_de_tai_file_excel_mau")," "),t.xp6(3),t.s9C("download",t.lcZ(19,12,"lang_auto_file_excel_mau_azota")),t.Q6J("href",t.lcZ(18,10,"blob/master/azota_assets/medias/de_mau_azota_excel.xlsx?raw=true"),t.LSH),t.xp6(3),t.Oqu(t.lcZ(21,14,"lang_auto_file_excel_mau_azota"))}}function Em(o,s){1&o&&(t.TgZ(0,"div",16)(1,"div",17)(2,"div",18),t._UZ(3,"mat-spinner",19),t.qZA()()()),2&o&&(t.xp6(3),t.Q6J("strokeWidth",2)("diameter",30))}function Im(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1,",\xa0"),t.qZA())}function Zm(o,s){if(1&o&&(t.TgZ(0,"span"),t.YNc(1,Im,2,0,"span",54),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()),2&o){const e=s.$implicit,n=s.index;t.xp6(1),t.Q6J("ngIf",n>0),t.xp6(1),t.hij("",t.lcZ(3,2,e)," ")}}function Mm(o,s){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"mytranslate"),t.TgZ(3,"b"),t._uU(4),t.qZA(),t._uU(5," - "),t.YNc(6,Zm,4,4,"span",44),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,3,"lang_auto_ma_de_loi"),": "),t.xp6(3),t.Oqu(null==e?null:e.offlineMixquestionId),t.xp6(2),t.Q6J("ngForOf",e.errorStrs)}}function Pm(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",26)(1,"mat-card",50)(2,"div",51)(3,"button",52),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.showErrorBlock=!1)}),t.ALo(4,"mytranslate"),t.TgZ(5,"mat-icon"),t._uU(6,"close"),t.qZA()()(),t.TgZ(7,"mat-card-content")(8,"p",53),t._uU(9),t.ALo(10,"mytranslate"),t.ALo(11,"mytranslate"),t.qZA(),t.YNc(12,Mm,7,5,"p",44),t.qZA()()()}if(2&o){const e=t.oxw(3);t.xp6(3),t.s9C("matTooltip",t.lcZ(4,5,"lang_auto_dong")),t.xp6(6),t.lnq("",t.lcZ(10,7,"lang_auto_co")," ",e.excelErrorObjs.length," ",t.lcZ(11,9,"lang_auto_ma_de_loi_trong_file_excel"),""),t.xp6(3),t.Q6J("ngForOf",e.excelErrorObjs)}}function Lm(o,s){1&o&&(t.TgZ(0,"div",55)(1,"span"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_auto_vui_long_nhap_ten_de_thi")," "))}function Nm(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_thang_diem")," "))}function Dm(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_dung_dinh_dang")," "))}function jm(o,s){if(1&o&&(t.TgZ(0,"div",55),t.YNc(1,Nm,3,3,"span",54),t.YNc(2,Dm,3,3,"span",54),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",e.formConfig.controls.totalScore.errors&&!e.checkValidateScore),t.xp6(1),t.Q6J("ngIf",e.checkValidateScore)}}const qm=function(o){return{"error-input":o}},Qm=function(o){return{"active-input":o}};function Um(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",56),t.NdJ("focus",function(){const i=t.CHM(e),a=i.$implicit,r=i.index,l=t.oxw(3);return t.KtG(l.chooseHashId(a,r))})("input",function(i){const r=t.CHM(e).index,l=t.oxw(3);return t.KtG(l.changeOfflineHashId(i,r))}),t.qZA(),t.BQk()}if(2&o){const e=s.$implicit,n=s.index,i=t.oxw(3);let a;t.xp6(1),t.Q6J("max",999)("value",null!==(a=e.offlineMixquestionHashId)&&void 0!==a?a:"")("ngClass",t.VKq(4,qm,e.checkValidate||e.checkMatchHashId))("ngClass",t.VKq(6,Qm,i.indexHashId==n))}}function Fm(o,s){if(1&o&&(t.O4$(),t.kcU(),t.TgZ(0,"p",57),t._uU(1),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.hij(" *",e.msgError," ")}}function Rm(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",68),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(2),l=r.index,c=r.$implicit,_=t.oxw(3);let d;return t.KtG(_.changeAnswer(l,null!==(d=c.indexQuestion)&&void 0!==d?d:0,a))}),t._uU(2),t.qZA(),t.BQk()}if(2&o){const e=s.$implicit,n=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngClass",e==n.answerQuestion?"btn-primary":""),t.xp6(1),t.hij(" ",e," ")}}function Bm(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",63)(1,"div",64),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"div",65),t.YNc(5,Rm,3,2,"ng-container",44),t.qZA(),t.TgZ(6,"div",66)(7,"button",67),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(),a=i.index,r=i.$implicit,l=t.oxw(3);let c;return t.KtG(l.deleteAnswerQuestion(a,null!==(c=r.indexQuestion)&&void 0!==c?c:0))}),t.ALo(8,"mytranslate"),t.O4$(),t.TgZ(9,"svg",37),t._UZ(10,"path",38)(11,"path",39)(12,"path",40)(13,"line",41)(14,"line",42),t.qZA()()()()}if(2&o){const e=t.oxw().$implicit,n=t.oxw(3);let i;t.xp6(2),t.AsE(" ",t.lcZ(3,4,"lang_auto_cau")," ",(null!==(i=e.indexQuestion)&&void 0!==i?i:0)+1," "),t.xp6(3),t.Q6J("ngForOf",n.configAnswerData),t.xp6(2),t.s9C("matTooltip",t.lcZ(8,6,"lang_auto_xoa_dap_an"))}}function Jm(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",72),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,a=t.oxw().index,r=t.oxw(3);return t.KtG(r.changeAnswerQuestion(a,i))}),t.TgZ(1,"span",73),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4,"-"),t.qZA(),t.TgZ(5,"span",73),t._uU(6),t.qZA()()}if(2&o){const e=t.oxw(),n=e.index,i=e.$implicit;t.xp6(2),t.Oqu(n+1),t.xp6(4),t.Oqu(i)}}function Hm(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",74),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,a=t.oxw().index,r=t.oxw(3);return t.KtG(r.changeAnswerQuestion(a,i))}),t.TgZ(1,"span",73),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4,"-"),t.qZA(),t.TgZ(5,"span",73),t._uU(6),t.qZA()()}if(2&o){const e=t.oxw(),n=e.index,i=e.$implicit;t.xp6(2),t.Oqu(n+1),t.xp6(4),t.Oqu(i)}}function zm(o,s){if(1&o&&(t.TgZ(0,"div",69),t.YNc(1,Jm,7,2,"button",70),t.YNc(2,Hm,7,2,"button",71),t.qZA()),2&o){const e=s.index,n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",n.indexQuestion===e),t.xp6(1),t.Q6J("ngIf",n.indexQuestion!==e)}}function Ym(o,s){if(1&o&&(t.O4$(),t.kcU(),t.ynx(0),t.TgZ(1,"div",58),t.YNc(2,Bm,15,8,"div",59),t.TgZ(3,"div",60)(4,"p",21),t._uU(5),t.ALo(6,"mytranslate"),t.TgZ(7,"span"),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()(),t.TgZ(10,"div",61),t.YNc(11,zm,3,2,"div",62),t.qZA()()(),t.BQk()),2&o){const e=s.$implicit,n=s.index,i=t.oxw(3);t.xp6(1),t.Q6J("hidden",n!==i.indexHashId),t.xp6(1),t.Q6J("ngIf",e.checkChangeValue),t.xp6(3),t.hij(" ",t.lcZ(6,6,"lang_auto_bang_dap_an")," "),t.xp6(3),t.AsE("(",null==e.answerTexts?null:e.answerTexts.length," ",t.lcZ(9,8,"lang_auto_cau_hoi_brackets"),""),t.xp6(3),t.Q6J("ngForOf",e.answerTexts)}}function Gm(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",20)(1,"h3",21),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"div",22)(5,"form",23)(6,"div",24),t.YNc(7,Pm,13,11,"div",25),t.TgZ(8,"div",26)(9,"mat-form-field",27)(10,"mat-label"),t._uU(11),t.ALo(12,"mytranslate"),t.qZA(),t._UZ(13,"input",28),t.YNc(14,Lm,4,3,"div",29),t.qZA()(),t.TgZ(15,"div",26)(16,"mat-form-field",27)(17,"mat-label"),t._uU(18),t.ALo(19,"mytranslate"),t.qZA(),t.TgZ(20,"input",30),t.NdJ("input",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.checkValidation())}),t.qZA()(),t.YNc(21,jm,3,2,"div",29),t.qZA(),t.TgZ(22,"div",26)(23,"div",31)(24,"div",32)(25,"div",33)(26,"p",34),t._uU(27),t.ALo(28,"mytranslate"),t.qZA()(),t.TgZ(29,"div",35)(30,"button",36),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.removeAnswerItem())}),t.ALo(31,"mytranslate"),t.O4$(),t.TgZ(32,"svg",37),t._UZ(33,"path",38)(34,"path",39)(35,"path",40)(36,"line",41)(37,"line",42),t.qZA()()(),t.kcU(),t.TgZ(38,"div",43),t.YNc(39,Um,2,8,"ng-container",44),t.qZA(),t.TgZ(40,"div",45)(41,"button",36),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.removeAnswerItem())}),t.ALo(42,"mytranslate"),t.O4$(),t.TgZ(43,"svg",37),t._UZ(44,"path",38)(45,"path",39)(46,"path",40)(47,"line",41)(48,"line",42),t.qZA()()()(),t.YNc(49,Fm,2,1,"p",46),t.qZA(),t.YNc(50,Ym,12,10,"ng-container",44),t.qZA(),t.kcU(),t.TgZ(51,"div",47)(52,"button",48),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.resetBoxFileExcel())}),t._uU(53),t.ALo(54,"mytranslate"),t.qZA(),t.TgZ(55,"button",49),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.handleSaveQuestionAndExam())}),t._uU(56),t.ALo(57,"mytranslate"),t.qZA()()()()()()}if(2&o){const e=t.oxw(2);t.xp6(2),t.hij(" ",t.lcZ(3,17,"lang_cms_create_exam_by_excel_title")," "),t.xp6(3),t.Q6J("formGroup",e.formConfig),t.xp6(2),t.Q6J("ngIf",e.excelErrorObjs.length>0&&e.showErrorBlock),t.xp6(4),t.Oqu(t.lcZ(12,19,"lang_auto_ten_de")),t.xp6(3),t.Q6J("ngIf",e.formConfig.controls.nameExam.errors),t.xp6(4),t.Oqu(t.lcZ(19,21,"lang_auto_thang_diem")),t.xp6(2),t.Q6J("decimal",!0),t.xp6(1),t.Q6J("ngIf",e.formConfig.controls.totalScore.errors||e.checkValidateScore),t.xp6(6),t.hij(" ",t.lcZ(28,23,"lang_auto_ma_de"),": "),t.xp6(3),t.s9C("matTooltip",t.lcZ(31,25,"lang_auto_xoa_ma_de")),t.xp6(9),t.Q6J("ngForOf",e.answerList),t.xp6(2),t.s9C("matTooltip",t.lcZ(42,27,"lang_auto_xoa_ma_de")),t.xp6(8),t.Q6J("ngIf",e.msgError),t.xp6(1),t.Q6J("ngForOf",e.answerList),t.xp6(3),t.hij(" ",t.lcZ(54,29,"lang_auto_huy")," "),t.xp6(2),t.Q6J("disabled",""==e.formConfig.controls.nameExam.value.toString().trim()||e.checkValidateHashId||e.checkValidateScore||e.checkMatchHashId),t.xp6(1),t.hij(" ",t.lcZ(57,31,"lang_auto_luu")," ")}}function $m(o,s){if(1&o&&(t.YNc(0,Em,4,2,"div",14),t.YNc(1,Gm,58,33,"ng-template",null,15,t.W1O)),2&o){const e=t.MAs(2),n=t.oxw();t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",e)}}const Do=".box-upload-file[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:90vh}.box-upload[_ngcontent-%COMP%]{border:none!important;background:transparent!important;display:flex;justify-content:center;align-items:center}.wh-100[_ngcontent-%COMP%]{height:100%;width:100%}#dropzoneAreaFrame[_ngcontent-%COMP%]{cursor:pointer}.app-block-info[_ngcontent-%COMP%]{margin-bottom:40px}.close-btn[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-7px;padding:5px 10px;background:#dadada;cursor:pointer;border-radius:20px}.file[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:5px;vertical-align:super}.v-dragndrop[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:500}.file-input[_ngcontent-%COMP%]{display:none}.dz-clickable[_ngcontent-%COMP%]{cursor:pointer;color:#000}.font-size-1[_ngcontent-%COMP%]{font-size:15px}.app-block-content[_ngcontent-%COMP%]{margin-top:10px}.app-block-edit[_ngcontent-%COMP%]{margin:20px auto;text-align:center;position:relative;max-width:300px}.block-answer-close[_ngcontent-%COMP%]{position:absolute;top:-10px;right:0}.btn-azt-secodary-icon[_ngcontent-%COMP%]{color:#4e4d4d;transition:all .5s}.btn-azt-secodary-icon[_ngcontent-%COMP%]:hover{color:#000}.app-block-main[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.app-block[_ngcontent-%COMP%]{margin-top:15px}.app-block-input[_ngcontent-%COMP%]{margin-right:5px}.btn-item[_ngcontent-%COMP%]{display:inline-block;border:1px solid #eee;background:#fff;border-radius:5px;transition:all .3s;padding:5px 10px;margin-right:5px;margin-top:5px;width:calc(10% - 5px);cursor:pointer}.btn-item[_ngcontent-%COMP%]:hover{background:#eee}.card-custom[_ngcontent-%COMP%]{background:#fff;padding:15px;border-radius:5px;max-width:900px;margin:0 auto}.btn-answer-item[_ngcontent-%COMP%]{display:inline-block;border-radius:50%;padding:10px 16px;font-weight:500;border:1px solid #eee;background:#fff;margin-right:10px}.block-title[_ngcontent-%COMP%]{font-size:16px;font-weight:500}.block-input[_ngcontent-%COMP%]{position:absolute;z-index:9;width:50%;right:-50%;top:-6px}.fixToolBar[_ngcontent-%COMP%]{width:100%!important;left:0!important;background-color:#fff}.fixToolBar[_ngcontent-%COMP%]   .marginInput[_ngcontent-%COMP%]{width:70%!important;margin-left:5%!important}.fixToolBar[_ngcontent-%COMP%]   .btn-save-fixed[_ngcontent-%COMP%]{right:5%!important}.btn-save-fixed[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:45px}.btn-reload[_ngcontent-%COMP%]{background:#fff;color:#000;border:1px solid #000;padding:5px 20px;font-size:small;text-align:center;width:100%;transition:all .2s}.btn-reload[_ngcontent-%COMP%]:hover:not([disabled]){background:#eee}.inp-name-root[_ngcontent-%COMP%]{position:fixed;top:0;width:70%;left:15%;display:flex;justify-content:center;align-items:center;height:45px;background:#fff}.inp-name-root[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-width:1px;border-style:solid;border-radius:5px;border-color:#d6d6d6;font-weight:500;font-size:13px;width:50%;padding:5px}.inp-name-root[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus-visible{outline:none}.active[_ngcontent-%COMP%]{color:#fff;transition:all .3s;background:#2361ae}.active[_ngcontent-%COMP%]:hover:not([disabled]){background:#154c90}.input-code[_ngcontent-%COMP%]{width:60px;border-radius:5px;padding:0 5px;font-size:14px;font-weight:400;text-align:center;transition:all .5s}.input-code[_ngcontent-%COMP%]:focus-visible{outline:none}.input-code[_ngcontent-%COMP%]:hover{border:1px solid #000}.active-input[_ngcontent-%COMP%]{background:#eee;color:#000}.btn-save[_ngcontent-%COMP%]{background:#4050b5;color:#fff;padding:5px 20px;width:100%;font-size:small;transition:all .3s}.btn-save[_ngcontent-%COMP%]:hover{background:#133864}.toolBarMobile[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;z-index:100;width:100%;background-color:#252424b3}.inputMobile[_ngcontent-%COMP%]{border-width:1px;border-style:solid;border-radius:5px;border-color:#d6d6d6;font-weight:500;font-size:13px;width:100%;padding:5px}.inputMobile[_ngcontent-%COMP%]:focus-visible{outline:none}.hidden-lg[_ngcontent-%COMP%]{display:none}.box-file[_ngcontent-%COMP%]{width:50%}.box-file-content-file_preview[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;color:#5c5c5c;overflow-y:auto}.box-file-content-file_preview--blur_status[_ngcontent-%COMP%]{position:fixed;display:flex;width:100vw;height:100%;background:rgba(0,0,0,.7803921569);color:#fff;font-size:20px;font-weight:lighter;justify-content:center;align-items:center;cursor:progress;z-index:100;top:0;left:0}.box-file-content-file_preview--blur_status-frame[_ngcontent-%COMP%]{height:85%;overflow-x:auto}.box-file-content-file_preview--blur_status[_ngcontent-%COMP%]   .span-status[_ngcontent-%COMP%]{margin-top:10px;position:relative;animation:animatefadeIn .3s}.card-custom-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.text-error[_ngcontent-%COMP%]{color:#dc1a1a}.active-input[_ngcontent-%COMP%]{font-weight:500!important;border:1px solid #2361ae!important;transition:all .3s}.text-error[_ngcontent-%COMP%]{color:#f44336;display:block;font-style:10.5px;margin-left:14px;margin-top:-10px}.example-card[_ngcontent-%COMP%]{position:relative}.block-error-close[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.block-answer-delete[_ngcontent-%COMP%]{position:absolute;top:-10px;left:0}.error-input[_ngcontent-%COMP%]{font-weight:500!important;border:1px solid #f44336!important;transition:all .3s}.btn-hover[_ngcontent-%COMP%]:hover{background-color:#cbc8c8}.btn-accept-hover[_ngcontent-%COMP%]:hover{background-color:red}@media screen and (max-width: 768px){.btn-item[_ngcontent-%COMP%]{width:calc(12.5% - 5px)}.hidden-xs[_ngcontent-%COMP%]{display:none}.hidden-lg[_ngcontent-%COMP%]{display:block}.pb-mb-120[_ngcontent-%COMP%]{padding-bottom:120px}}@media screen and (max-width: 480px){.btn-item[_ngcontent-%COMP%]{width:calc(25% - 5px)}}@media (max-width: 992px){.order_last[_ngcontent-%COMP%]{order:13}.text-float-right[_ngcontent-%COMP%]{text-align:right!important}}";let Wm=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_){super(n),this.editorOutputDataService=e,this.commonService=n,this.activeRoute=i,this.dialog=a,this.formBuilder=r,this.offlineExamParserService=l,this.offlineExamCreatorService=c,this.redirectService=_,this.form=new h.nJ({}),this.formConfig=new h.nJ({}),this.answerList=[],this.curAnswerItem={},this.nameExamInp=new h.p4(""),this.configAnswerData=["A","B","C","D"],this.backToLink="",this.checkMatchHashId=!1,this.checkValidateHashId=!1,this.msgError="",this.indexHashId=0,this.excelErrorObjs=[],this.checkValidateScore=!1,this.showErrorBlock=!1}onFileSelected(e){this.file=e?e[0]:this.file,this.file&&["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(this.file.type)?this.processFile():(this.file=null,this.showErrorSnack("lang_auto_vui_long_chon_dung_tep_tin_excel"),this.redirectService.redirectByUrl(this.commonService.getLocalRouter(this.backToLink)))}processFile(){this.initStatusObj(),this.subscriptions.add(this.offlineExamParserService.apiOfflineExamParserParserExcelPostForm(this.file).subscribe(e=>{var n,i,a,r,l,c,_;1==e.success?(this.answerList=null!==(a=null===(i=null===(n=e.data)||void 0===n?void 0:n.obj)||void 0===i?void 0:i.answerObjs)&&void 0!==a?a:[],this.excelErrorObjs=null!==(c=null===(l=null===(r=e.data)||void 0===r?void 0:r.obj)||void 0===l?void 0:l.errorObjs)&&void 0!==c?c:[],this.excelErrorObjs.length>0&&(this.showErrorBlock=!0),this.answerList.length<=0?(this.showErrorSnack("lang_auto_vui_long_tai_dung_mau_file_excel"),this.file=null,this.form.controls.File.setValue(""),this.redirectService.redirectByUrl(this.commonService.getLocalRouter(this.backToLink))):this.curAnswerItem=this.answerList[0],this.successStatusObj()):this.errorStatusObj(null!==(_=e.message)&&void 0!==_?_:"")}))}changeOfflineHashId(e,n){var i,a,r;for(let c=0;c<this.answerList.length;c++)this.answerList[c].checkMatchHashId=!1;let l=e.target.value;if(this.answerList[n].offlineMixquestionHashId=l?Number(l):void 0,this.curAnswerItem=this.answerList[n],""==l.toString().trim())return this.checkValidateHashId=!0,this.answerList[n].checkValidate=!0,void this.commonService.getTranslate("lang_auto_ma_de_khong_duoc_bo_trong").subscribe(c=>{this.msgError=c});if(this.answerList[n].checkValidate=!1,this.checkValidateHashId=!1,l.toString().length>3)return this.checkValidateHashId=!0,this.answerList[n].checkValidate=!0,void this.commonService.getTranslate("lang_auto_ma_de_dai_toi_da_3_ky_tu").subscribe(c=>{this.msgError=c});if(this.answerList[n].checkValidate=!1,this.checkValidateHashId=!1,Number(l)<=0||Number(l)>999)return this.answerList[n].checkValidate=!0,this.checkValidateHashId=!0,void this.commonService.getTranslate("lang_auto_ma_de_phai_la_so_tu_1-999").subscribe(c=>{this.msgError=c});this.checkValidateHashId=!1,this.answerList[n].checkValidate=!1;for(let c=0;c<this.answerList.length;c++){for(let _=c+1;_<this.answerList.length;_++)if(this.answerList[c].offlineMixquestionHashId&&this.answerList[_].offlineMixquestionHashId){if(Number(this.answerList[c].offlineMixquestionHashId)==Number(this.answerList[_].offlineMixquestionHashId)){this.answerList[c].checkMatchHashId=!0,this.answerList[_].checkMatchHashId=!0;break}this.answerList[c].checkMatchHashId=!1,this.answerList[_].checkMatchHashId=!1}if(this.answerList[c].checkValidate)return""==(null===(i=this.answerList[c].offlineMixquestionHashId)||void 0===i?void 0:i.toString())&&this.commonService.getTranslate("lang_auto_ma_de_khong_duoc_bo_trong").subscribe(_=>{this.msgError=_}),(null!==(r=null===(a=this.answerList[c].offlineMixquestionHashId)||void 0===a?void 0:a.toString().length)&&void 0!==r?r:0)>3&&this.commonService.getTranslate("lang_auto_ma_de_dai_toi_da_3_ky_tu").subscribe(_=>{this.msgError=_}),(Number(this.answerList[c].offlineMixquestionHashId)<0||Number(this.answerList[c].offlineMixquestionHashId)>999)&&this.commonService.getTranslate("lang_auto_ma_de_phai_la_so_tu_1-999").subscribe(_=>{this.msgError=_}),void(this.checkValidateHashId=!0);if(this.checkValidateHashId=!1,this.answerList[c].checkMatchHashId)return this.checkMatchHashId=!0,void this.commonService.getTranslate("lang_auto_ma_de_thi_khong_duoc_trung_nhau").subscribe(_=>{this.msgError=_});this.checkMatchHashId=!1,this.answerList[c].checkMatchHashId=!1}!this.checkMatchHashId&&!this.checkValidateHashId&&(this.msgError="")}changeAnswerQuestion(e,n){var i;this.answerList[e].answerTexts&&(this.answerList[e].checkChangeValue=!0,this.answerList[e].indexQuestion=n,this.answerList[e].answerQuestion=null===(i=this.answerList[e].answerTexts)||void 0===i?void 0:i[n])}closeEditAnswer(e){this.answerList[e].checkChangeValue=!1,this.answerList[e].indexQuestion=-1}changeAnswer(e,n,i){this.answerList[e].answerTexts[n]=i,this.answerList[e].answerQuestion=i}removeAnswerItem(){this.dialog.open(Km,{width:"300px",data:{item:this.curAnswerItem}}).afterClosed().subscribe(n=>{if(!0===n)for(var i=0;i<this.answerList.length;i++)this.answerList[i]==this.curAnswerItem&&(this.answerList.splice(i,1),this.showSuccessSnack("lang_auto_xoa_ma_de_thanh_cong"))})}handleSaveQuestionAndExam(){var e;let n=null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")))&&void 0!==e?e:0,i={name:this.formConfig.controls.nameExam.value,answerObjs:this.answerList,totalMark:this.formConfig.controls.totalScore.value,categoryId:n.toString(),orcLogId:-2};this.subscriptions.add(this.offlineExamCreatorService.apiOfflineExamCreatorCreateExamByAnswerDataPost(i).subscribe(a=>{var r,l,c;if(a.success){this.showSuccessSnack("lang_auto_tao_de_thi_thanh_cong");let _=`/admin/testbank/config-exam-offline/${n}/${null===(l=null===(r=a.data)||void 0===r?void 0:r.obj)||void 0===l?void 0:l.hashId}`;this.myNavigation(_)}else this.showErrorSnack(null!==(c=a.message)&&void 0!==c?c:""),this.redirectService.redirectByUrl(this.commonService.getLocalRouter(this.backToLink))}))}changeNameDownloadFile(e){return this.commonService.createFileNameExportFile([e])+".xlsx"}deleteAnswerQuestion(e,n){this.answerList[e].answerTexts.splice(n,1),this.answerList[e].checkChangeValue=!1,this.answerList[e].indexQuestion=-1,this.showSuccessSnack("lang_auto_xoa_dap_an_thanh_cong")}resetBoxFileExcel(){this.confirmDialog("lang_auto_msg_close_confirm_dialog_title","lang_auto_msg_close_confirm_dialog_desc","400px",()=>{var e;this.file=null,this.answerList=[],this.form.controls.File.setValue("");let i=`/admin/testbank/create-new-document/${null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")))&&void 0!==e?e:0}`;this.myNavigation(i)})}confirmDialog(e,n,i,a){this.dialog.open(_i.D,{width:i,data:{title:e,msg:n}}).afterClosed().subscribe(l=>{!0===l&&a()})}chooseHashId(e,n){this.curAnswerItem=e,this.indexHashId=n}checkValidation(){this.checkValidateScore="."==this.formConfig.controls.totalScore.value.toString().charAt(0)}ngOnInit(){var e;this.form=this.formBuilder.group({File:new h.p4("")});let n=this.commonService.myTranslateIntance("lang_auto_de_tao_tu_file_excel");this.formConfig=this.formBuilder.group({nameExam:new h.p4(n,[h.kI.required,Pn._.noWhiteSpace]),totalScore:new h.p4("10",[h.kI.required])});let i=null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")))&&void 0!==e?e:0;var a=this.commonService.getMyQueryParam("backto");this.backToLink=null!=a?a:"/admin/testbank/create-new-document/"+(null!=i?i:0),this.commonService.translateMetaData({title:"lang_cms_create_exam_by_excel_title",description:"lang_cms_create_exam_by_excel_description",image:"lang_cms_test_image"}),super.ngOnInit();const r=this.editorOutputDataService.getFirstFile();r?this.onFileSelected([r]):this.redirectService.redirectByUrl(this.commonService.getLocalRouter(this.backToLink))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(bn),t.Y36(vt.v),t.Y36(x.gz),t.Y36(j.uw),t.Y36(h.QS),t.Y36(km.L),t.Y36(Lo.r),t.Y36(To.V))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-by-excel"]],features:[t.qOj],decls:5,vars:3,consts:[[3,"headerBackTolink"],[1,"app"],["class","box-upload-file",4,"ngIf","ngIfElse"],["fileExist",""],[1,"box-upload-file"],[1,"form-horizontal","text-center","wh-100",3,"formGroup"],["id","dropzoneAreaFrame",1,"wh-100","text-center","v-dragndrop","dropzone","dz-started","cur-po",3,"click"],["appDragDrop","",1,"px-4","py-3","rounded","box-upload","wh-100",3,"filesChangeEmiter"],[1,"file"],["id","select-upload-file",1,"align-self-center","select","dz-clickable"],["type","file","name","file","id","file","formControlName","File","accept",".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",1,"form-control","file-input",3,"change"],["fileSelect",""],[1,"d-block","mt-20","text-dark-green","mt-2"],["target","_self",3,"href","download","click"],["class","box-file-content-file_preview--blur_status",4,"ngIf","ngIfElse"],["doneLoading",""],[1,"box-file-content-file_preview--blur_status"],[1,"text-center","box-file-content-file_preview--blur_status-frame"],[1,"d-flex","justify-content-center","mt-5"],["color","accent",3,"strokeWidth","diameter"],[1,"app-block","container","mt-5","pb-80","pb-mb-120","mx-auto",2,"max-width","900px"],[1,"text-lg","font-medium"],[1,"box","p-5","mt-3"],[3,"formGroup"],[1,"row"],["class","col-md-12 mb-4",4,"ngIf"],[1,"col-md-12","mb-4"],["appearance","outline"],["formControlName","nameExam","matInput",""],["class","text-danger text-xs mt-1",4,"ngIf"],["appOnlyNumber","","formControlName","totalScore","matInput","",3,"decimal","input"],[1,"app-block-info"],[1,"grid","grid-cols-12","gap-3","items-center"],[1,"col-span-6","md:col-span-1"],[1,"block-title","mb-0"],[1,"col-span-6","md:col-span-1","pl-0","text-float-right","block","md:hidden"],[1,"btn","btn-outline-secondary","btn-sm","btn-transparent",3,"matTooltip","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-5","h-5","lucide"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],[1,"col-span-12","md:col-span-10","align-self-center","order_last"],[4,"ngFor","ngForOf"],[1,"col-span-6","md:col-span-1","pl-0","text-float-right","hidden","md:block"],["class","text-danger text-xs mt-2 mb-0",4,"ngIf"],[1,"text-right"],[1,"btn","w-20","btn-secondary","mr-2",3,"click"],[1,"btn","w-20","btn-primary",3,"disabled","click"],[1,"example-card"],[1,"block-error-close"],["mat-icon-button","",1,"btn-azt-secodary-icon",3,"matTooltip","click"],[1,"clickable","text-danger"],[4,"ngIf"],[1,"text-danger","text-xs","mt-1"],["appOnlyNumber","","type","text",1,"input-code","form-control","mr-2","mt-2",3,"max","value","ngClass","focus","input"],[1,"text-danger","text-xs","mt-2","mb-0"],[1,"mt-4",3,"hidden"],["class","app-block-edit",4,"ngIf"],[1,"app-block-content"],[1,"grid","grid-cols-12","gap-3","mt-3"],["class","col-span-2 lg:col-span-1",4,"ngFor","ngForOf"],[1,"app-block-edit"],[1,"text-md","font-medium"],[1,"mt-3"],[1,"absolute","top-0","right-0","-mt-3"],[1,"btn","btn-outline-secondary","btn-transparent",3,"matTooltip","click"],[1,"btn","rounded-full","mr-2",2,"width","40px","height","40px","line-height","40px",3,"ngClass","click"],[1,"col-span-2","lg:col-span-1"],["class","btn btn-sm btn-primary w-full",3,"click",4,"ngIf"],["class","btn btn-sm btn-secondary w-full",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-primary","w-full",3,"click"],[1,"number"],[1,"btn","btn-sm","btn-secondary","w-full",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0)(1,"div",1),t.YNc(2,Sm,22,16,"div",2),t.YNc(3,$m,3,2,"ng-template",null,3,t.W1O),t.qZA()()),2&e){const i=t.MAs(4);t.Q6J("headerBackTolink",n.backToLink),t.xp6(2),t.Q6J("ngIf",!n.file&&0==n.answerList.length)("ngIfElse",i)}},dependencies:[O.mk,O.sg,O.O5,tn.lW,No.a8,No.dn,ge.Hw,De.KE,De.hX,si.Nt,Qi.Ou,Wt.gM,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,un.Y,Om.N,oe.M,de._,at.bT,at.Gu],styles:[Do]}),o})(),Km=(()=>{class o extends mt.Q{constructor(e,n,i){super(e),this.commonService=e,this.dialogRef=n,this.data=i}acceptRemove(){this.dialogRef.close(!0)}onNoClick(){this.dialogRef.close(!1)}ngOnInit(){super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(j.so),t.Y36(j.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["remove-answer-dialog"]],features:[t.qOj],decls:19,vars:10,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-5"],[1,"text-md","font-medium","flex","items-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-6","h-6","mr-2","text-danger"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],[1,"p-3","text-right"],[1,"btn","btn-secondary","w-20","mr-2",3,"click"],[1,"btn","w-20","btn-danger",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t.O4$(),t.TgZ(4,"svg",4),t._UZ(5,"path",5)(6,"path",6)(7,"path",7)(8,"line",8)(9,"line",9),t.qZA(),t._uU(10),t.ALo(11,"mytranslate"),t.qZA()()(),t.kcU(),t.TgZ(12,"div",10)(13,"button",11),t.NdJ("click",function(){return n.onNoClick()}),t._uU(14),t.ALo(15,"mytranslate"),t.qZA(),t.TgZ(16,"button",12),t.NdJ("click",function(){return n.acceptRemove()}),t._uU(17),t.ALo(18,"mytranslate"),t.qZA()()()),2&e&&(t.xp6(10),t.AsE(" ",t.lcZ(11,4,"lang_auto_ban_co_muon_xoa_ma_de_so"),": ",n.data.item.offlineMixquestionHashId," ? "),t.xp6(4),t.hij(" ",t.lcZ(15,6,"lang_auto_huy")," "),t.xp6(3),t.hij(" ",t.lcZ(18,8,"lang_auto_xoa")," "))},dependencies:[at.bT],styles:[Do]}),o})();function Vm(o,s){1&o&&(t.TgZ(0,"div",24)(1,"span"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_auto_vui_long_nhap_ten_de_thi"),""))}function Xm(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_ma_de")," "))}function th(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.ALo(3,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.AsE(" ",t.lcZ(2,2,"lang_auto_ma_de_phai_la_so_tu_1"),"",t.lcZ(3,4,"lang_auto_-999_va_toi_da_3_ky_tu")," "))}function eh(o,s){if(1&o&&(t.TgZ(0,"div",24),t.YNc(1,Xm,3,3,"span",19),t.YNc(2,th,4,6,"span",19),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.form.controls.codeExam.errors.required),t.xp6(1),t.Q6J("ngIf",e.form.controls.codeExam.errors.min||e.form.controls.codeExam.errors.max||e.form.controls.codeExam.errors.maxLength||e.form.controls.codeExam.value.toString().length>3)}}function nh(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_khong_qua_120_cau")," "))}function ih(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_lon_hon_0")," "))}function oh(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_so_cau_hoi")," "))}function ah(o,s){if(1&o&&(t.TgZ(0,"div",24),t.YNc(1,nh,3,3,"span",19),t.YNc(2,ih,3,3,"span",19),t.YNc(3,oh,3,3,"span",19),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.f.totalQuestion.errors.max),t.xp6(1),t.Q6J("ngIf",e.f.totalQuestion.errors.min),t.xp6(1),t.Q6J("ngIf",e.f.totalQuestion.errors.required)}}function sh(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_thang_diem")," "))}function rh(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_dung_dinh_dang")," "))}function lh(o,s){if(1&o&&(t.TgZ(0,"div",24),t.YNc(1,sh,3,3,"span",19),t.YNc(2,rh,3,3,"span",19),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.f.totalScore.errors&&!e.checkValidateScore),t.xp6(1),t.Q6J("ngIf",e.checkValidateScore)}}function ch(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"formatOfflineExamHashIdToNumber"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,e.f.codeExam.value,3))}}function _h(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1,"000"),t.qZA())}function dh(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",38),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw().index,l=t.oxw();return t.KtG(l.chooseAnswerQuestion(r,a))}),t._uU(2),t.qZA(),t.BQk()}if(2&o){const e=s.$implicit,n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngClass",n.value.answer==e?"btn-primary":""),t.xp6(1),t.hij(" ",e," ")}}function uh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",25)(1,"div",26)(2,"div",27)(3,"div",28)(4,"span",29),t._uU(5),t.qZA(),t.YNc(6,dh,3,2,"ng-container",30),t.TgZ(7,"button",31),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw();return t.KtG(r.deleteAnswerQuestion(a))}),t.ALo(8,"mytranslate"),t.O4$(),t.TgZ(9,"svg",32),t._UZ(10,"path",33)(11,"path",34)(12,"path",35)(13,"line",36)(14,"line",37),t.qZA()()()()()()}if(2&o){const e=s.index,n=t.oxw();t.xp6(1),t.Q6J("formGroupName",e),t.xp6(4),t.hij("",e+1,"."),t.xp6(1),t.Q6J("ngForOf",n.configAnswerData),t.xp6(1),t.s9C("matTooltip",t.lcZ(8,4,"lang_auto_xoa"))}}const mh=function(o){return{suppressScrollX:!0,suppressScrollY:o}};let hh=(()=>{class o extends mt.Q{constructor(e,n,i,a,r){super(e),this.commonService=e,this.activeRoute=n,this.formBuilder=i,this.offlineExamCreatorService=a,this.dialog=r,this.backToLink="",this.form=new h.nJ({}),this.answerList=new h.vC([]),this.oldAnswerList=[],this.configAnswerData=["A","B","C","D"],this.indexQuestion=0,this.answerIndexQuestion="",this.checkEmptyAnswer=!0,this.checkValidateScore=!1,this.disable=!0}get f(){return this.form.controls}chooseAnswerQuestion(e,n){this.answerList.at(e).setValue({answer:n}),this.answerIndexQuestion=n,this.oldAnswerList=this.answerList.value;for(let i=0;i<this.answerList.controls.length;i++){if(""==this.answerList.controls[i].value.answer){this.checkEmptyAnswer=!0;break}this.checkEmptyAnswer=!1}}createItemAnswer(){return this.formBuilder.group({answer:new h.p4("")})}createAnswerList(e){if(this.resetAnswerList(this.answerList),this.answerList=this.form.get("answerList"),e<=120){for(let i=0;i<e;i++)this.answerList.push(this.createItemAnswer());if(this.oldAnswerList.length>0)for(let i=0;i<this.oldAnswerList.length;i++)i<=e&&(this.answerList.value[i]=this.oldAnswerList[i],this.answerList.controls[i]&&this.answerList.controls[i].setValue(this.oldAnswerList[i]));for(let i=0;i<this.answerList.controls.length;i++){if(""==this.answerList.controls[i].value.answer){this.checkEmptyAnswer=!0;break}this.checkEmptyAnswer=!1}}}resetAnswerList(e){for(;0!==e.length;)e.removeAt(0)}handleSaveQuestionAndExam(){var e;let n=this.commonService.getFormObj(this.form),i=[];for(let _=0;_<this.answerList.length;_++)""!=this.answerList.value[_].answer&&i.push(this.answerList.value[_].answer);let r=[];r.push({offlineMixquestionHashId:n.codeExam,answerTexts:i});let l=null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")))&&void 0!==e?e:0,c={name:n.nameExam,totalMark:n.totalScore,answerObjs:r,orcLogId:-1,categoryId:l.toString()};this.subscriptions.add(this.offlineExamCreatorService.apiOfflineExamCreatorCreateExamByAnswerDataPost(c).subscribe(_=>{var d;_.success?(this.showSuccessSnack("lang_auto_tao_de_thi_thanh_cong"),this.myNavigation(`/admin/testbank/document-management/0/${l}/1`)):this.showErrorSnack(null!==(d=_.message)&&void 0!==d?d:"")}))}checkValidation(){this.checkValidateScore="."==this.form.controls.totalScore.value.toString().charAt(0)}confirmDialog(e,n,i,a){this.dialog.open(_i.D,{width:i,data:{title:e,msg:n}}).afterClosed().subscribe(l=>{!0===l&&a()})}resetCreateExam(){var e;let n=null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")))&&void 0!==e?e:0;this.confirmDialog("lang_auto_msg_close_confirm_dialog_title","lang_auto_msg_close_confirm_dialog_desc","480px",()=>{this.myNavigation(`admin/testbank/azota-editor/${n}`)})}checkDisable(){this.form.controls.codeExam.invalid||this.form.controls.nameExam.invalid?this.disable=!0:(this.disable=!1,this.form.controls.totalQuestion.enable())}deleteAnswerQuestion(e){this.answerList.removeAt(e),this.form.controls.totalQuestion.setValue(this.answerList.controls.length),this.showSuccessSnack("lang_auto_xoa_dap_an_thanh_cong")}ngOnInit(){var e,n;this.form=this.formBuilder.group({codeExam:new h.p4("",[h.kI.required,h.kI.min(1),h.kI.max(999),h.kI.maxLength(3),Pn._.noWhiteSpace]),nameExam:new h.p4("",[h.kI.required,Pn._.noWhiteSpace]),totalScore:new h.p4(10,[h.kI.required]),totalQuestion:new h.p4({value:"",disabled:this.disable},[h.kI.required,h.kI.min(1),h.kI.max(120)]),answerList:this.formBuilder.array([])});let i=null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")))&&void 0!==e?e:0;this.backToLink=null!==(n=this.commonService.getMyQueryParam("backto"))&&void 0!==n?n:`/admin/testbank/create-new-document/${i}`,this.commonService.translateMetaData({title:"lang_cms_create_exam_by_hand_title",description:"lang_cms_create_exam_by_hand_description",image:"lang_cms_test_image"}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(x.gz),t.Y36(h.QS),t.Y36(Lo.r),t.Y36(j.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["create-by-hand"]],features:[t.qOj],decls:53,vars:41,consts:[[3,"headerBackTolink"],[1,"mt-5","mx-auto",2,"max-width","1000px"],[1,"text-lg","font-medium"],[3,"formGroup"],[1,"box","p-5","mt-3"],[1,"grid","grid-cols-12","gap-5"],[1,"col-span-12","md:col-span-6"],["appearance","outline",1,"mt-2"],["name","nameExam","formControlName","nameExam","matInput","",3,"input"],["class","text-danger text-xs mt-1",4,"ngIf"],["name","codeExam","appOnlyNumber","","formControlName","codeExam","matInput","",3,"input"],["appOnlyNumber","","name","totalQuestion","formControlName","totalQuestion","matInput","",3,"input"],["appOnlyNumber","","name","totalScore","formControlName","totalScore","matInput","",3,"decimal","input"],[1,"text-right","mt-3"],[1,"btn","btn-outline-secondary","w-20","mr-2",3,"click"],[1,"btn","btn-primary","w-20",3,"disabled","click"],[1,"row","mt-mb-3"],[1,"col-12"],[1,"block-title","text-center"],[4,"ngIf"],[1,"answer-list"],[3,"config","scrollIndicators"],[1,"row"],["class","col-md-12 mt-3","formArrayName","answerList",4,"ngFor","ngForOf"],[1,"text-danger","text-xs","mt-1"],["formArrayName","answerList",1,"col-md-12","mt-3"],[3,"formGroupName"],[1,"app-item","mt-2"],[1,"answer-item","flex","items-center","justify-center"],[1,"inline-block","font-medium","mr-2"],[4,"ngFor","ngForOf"],[1,"btn","btn-outline-secondary","btn-transparent","btn-delete",3,"matTooltip","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-5","h-5","lucide"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],[1,"btn","rounded-full","mr-2",2,"width","40px","height","40px","line-height","40px",3,"ngClass","click"]],template:function(e,n){1&e&&(t.TgZ(0,"teacher-layout",0)(1,"div",1)(2,"h3",2),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.TgZ(5,"form",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"mat-form-field",7)(10,"mat-label"),t._uU(11),t.ALo(12,"mytranslate"),t.qZA(),t.TgZ(13,"input",8),t.NdJ("input",function(){return n.checkDisable()}),t.qZA()(),t.YNc(14,Vm,4,3,"div",9),t.TgZ(15,"mat-form-field",7)(16,"mat-label"),t._uU(17),t.ALo(18,"mytranslate"),t.qZA(),t.TgZ(19,"input",10),t.NdJ("input",function(){return n.checkDisable()}),t.qZA()(),t.YNc(20,eh,3,2,"div",9),t.TgZ(21,"mat-form-field",7)(22,"mat-label"),t._uU(23),t.ALo(24,"mytranslate"),t.qZA(),t.TgZ(25,"input",11),t.NdJ("input",function(){return n.createAnswerList(n.f.totalQuestion.value)}),t.qZA()(),t.YNc(26,ah,4,3,"div",9),t.TgZ(27,"mat-form-field",7)(28,"mat-label"),t._uU(29),t.ALo(30,"mytranslate"),t.qZA(),t.TgZ(31,"input",12),t.NdJ("input",function(){return n.checkValidation()}),t.qZA()(),t.YNc(32,lh,3,2,"div",9),t.TgZ(33,"div",13)(34,"button",14),t.NdJ("click",function(){return n.resetCreateExam()}),t._uU(35),t.ALo(36,"mytranslate"),t.qZA(),t.TgZ(37,"button",15),t.NdJ("click",function(){return n.handleSaveQuestionAndExam()}),t._uU(38),t.ALo(39,"mytranslate"),t.qZA()()(),t.TgZ(40,"div",6)(41,"div",16)(42,"div",17)(43,"p",18),t._uU(44),t.ALo(45,"mytranslate"),t.YNc(46,ch,3,4,"span",19),t.YNc(47,_h,2,0,"span",19),t.qZA()()(),t.TgZ(48,"div",20)(49,"perfect-scrollbar",21),t.ALo(50,"isMobileOrTable"),t.TgZ(51,"div",22),t.YNc(52,uh,15,6,"div",23),t.qZA()()()()()()()()()),2&e&&(t.Q6J("headerBackTolink",n.backToLink),t.xp6(3),t.hij(" ",t.lcZ(4,21,"lang_auto_nhap_tay_dap_an")," "),t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(6),t.Oqu(t.lcZ(12,23,"lang_auto_ten_de")),t.xp6(3),t.Q6J("ngIf",n.form.controls.nameExam.touched&&(n.f.nameExam.errors||""==n.form.controls.nameExam.value.toString().trim())),t.xp6(3),t.hij("",t.lcZ(18,25,"lang_auto_ma_de")," "),t.xp6(3),t.Q6J("ngIf",n.form.controls.codeExam.touched&&n.form.controls.codeExam.errors),t.xp6(3),t.Oqu(t.lcZ(24,27,"lang_auto_so_cau")),t.xp6(3),t.Q6J("ngIf",n.form.controls.totalQuestion.touched&&n.f.totalQuestion.errors),t.xp6(3),t.Oqu(t.lcZ(30,29,"lang_auto_thang_diem")),t.xp6(2),t.Q6J("decimal",!0),t.xp6(1),t.Q6J("ngIf",n.f.totalScore.errors||n.checkValidateScore),t.xp6(3),t.hij(" ",t.lcZ(36,31,"lang_auto_huy")," "),t.xp6(2),t.Q6J("disabled",""==n.f.nameExam.value.toString().trim()||""==n.f.totalScore.value.toString().trim()||n.f.codeExam.invalid||n.checkEmptyAnswer||n.checkValidateScore),t.xp6(1),t.hij(" ",t.lcZ(39,33,"lang_auto_luu")," "),t.xp6(6),t.hij(" ",t.lcZ(45,35,"lang_auto_chon_dap_an_ma_de"),": "),t.xp6(2),t.Q6J("ngIf",!n.f.codeExam.errors),t.xp6(1),t.Q6J("ngIf",n.f.codeExam.errors),t.xp6(2),t.Q6J("config",t.VKq(39,mh,t.lcZ(50,37,"")))("scrollIndicators",!0),t.xp6(3),t.Q6J("ngForOf",n.answerList.controls))},dependencies:[O.mk,O.sg,O.O5,De.KE,De.hX,si.Nt,Wt.gM,Lt.Vv,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,h.x0,h.CE,un.Y,oe.M,de._,at.bT,at.q7,at.bd],styles:[".btn-answer-item[_ngcontent-%COMP%]{display:inline-block;border-radius:50%;padding:10px 16px;font-weight:500;border:1px solid #2d3436;background:#fff;margin-right:10px;transition:all .2s}.btn-answer-item[_ngcontent-%COMP%]:hover{background:#eee}.app-footer[_ngcontent-%COMP%]{margin-top:20px;display:flex;justify-content:flex-end}.card-custom[_ngcontent-%COMP%]{background:#fff;padding:15px;border-radius:5px;margin:0 auto}.card-custom-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.answer-item[_ngcontent-%COMP%]{text-align:center}.answer-item[_ngcontent-%COMP%]:hover > .btn-delete[_ngcontent-%COMP%]{opacity:1;visibility:visible}.block-title[_ngcontent-%COMP%]{font-weight:500;margin-bottom:5px}.btn-item[_ngcontent-%COMP%]{display:inline-block;border:1px solid #eee;background:#fff;border-radius:5px;transition:all .2s;padding:5px 10px;margin-right:5px;margin-top:5px;width:calc(10% - 5px);cursor:pointer}.btn-item[_ngcontent-%COMP%]:hover{background:#eee}.btn-delete[_ngcontent-%COMP%]{opacity:0;visibility:hidden;transition:all .3s}.block-header[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between;max-width:400px;margin:0 auto}.btn-text-primary[_ngcontent-%COMP%]{display:inline-block;text-transform:inherit;color:#2361ae;transition:all .3s}.btn-text-primary[_ngcontent-%COMP%]:hover:not([disabled]){color:#154c90}.active[_ngcontent-%COMP%]{background:#2361ae;color:#fff;transition:all .2s}.active[_ngcontent-%COMP%]:hover:not([disabled]){background:#154c90}.btn-custom[_ngcontent-%COMP%]{display:inline-block;padding:0 80px;margin-right:10px}.answer-block[_ngcontent-%COMP%]{position:relative;max-width:400px;margin:0 auto}.block-popup[_ngcontent-%COMP%]{position:absolute;top:-6px;right:6px}.answer-list[_ngcontent-%COMP%]{position:relative;height:600px;overflow-x:hidden}.form-custom[_ngcontent-%COMP%]{position:relative}@media screen and (max-width: 768px){.btn-item[_ngcontent-%COMP%]{width:calc(12.5% - 5px)}.hidden-xs[_ngcontent-%COMP%]{display:none}.hidden-lg[_ngcontent-%COMP%]{display:block}.pb-mb-120[_ngcontent-%COMP%]{padding-bottom:120px}.mt-mb-3[_ngcontent-%COMP%]{margin-top:20px}.btn-delete[_ngcontent-%COMP%]{opacity:1;visibility:visible}}@media screen and (max-width: 480px){.btn-item[_ngcontent-%COMP%]{width:calc(25% - 5px)}}"]}),o})(),ph=(()=>{class o{constructor(){this.fileDrop=new t.vpe,this.preventBodyDrop=!0,this.active=!1}onDrop(e){e.preventDefault(),this.active=!1;const{dataTransfer:n}=e;if(null!=n&&n.items){const i=[];for(let a=0;a<n.items.length;a++)"file"===n.items[a].kind&&n.items[a].getAsFile()&&i.push(n.items[a].getAsFile());n.items.clear(),Array.isArray(i)&&this.fileDrop.emit(this.removeNullFile(i))}else{const i=null==n?void 0:n.files;null==n||n.clearData(),i&&this.fileDrop.emit(Array.from(i))}}removeNullFile(e){for(var n=[],i=0;i<e.length;i++)e[i]&&n.push(e[i]);return n}onDragOver(e){e.stopPropagation(),e.preventDefault(),this.active=!0}onDragLeave(e){this.active=!1}onBodyDragOver(e){this.preventBodyDrop&&(e.preventDefault(),e.stopPropagation())}onBodyDrop(e){this.preventBodyDrop&&e.preventDefault()}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=t.lG2({type:o,selectors:[["","appDropZone",""]],hostVars:2,hostBindings:function(e,n){1&e&&t.NdJ("drop",function(a){return n.onDrop(a)})("dragover",function(a){return n.onDragOver(a)})("dragleave",function(a){return n.onDragLeave(a)})("dragover",function(a){return n.onBodyDragOver(a)},!1,t.pYS)("drop",function(a){return n.onBodyDrop(a)},!1,t.pYS),2&e&&t.ekj("drop-zone-active",n.active)},inputs:{preventBodyDrop:"preventBodyDrop"},outputs:{fileDrop:"appDropZone"}}),o})();function gh(o,s){1&o&&t._UZ(0,"div",43)}let fh=(()=>{class o extends mt.Q{constructor(e,n,i,a){super(i),this.fb=e,this.activeRoute=n,this.commonService=i,this.editorOutputDataService=a,this.cur_cateId=0,this.backToLink="",this.isChooseFile=!1,this.form=new h.nJ({}),this.isFollowLibParser=!1,this.fileParser=new St.uD,this.isInitConf=!1,this.fileIcon="",this.msgLoading="",this.selectFile=r=>{let _=r.target.files;try{this.changeFileAction(_)}catch(d){alert(d)}}}redirectToMixBank(){this.commonService.myNavigation("/admin/testbank/mix-bank-template/"+(null!=this.cur_cateId?this.cur_cateId:0))}redirectToBack(){this.commonService.myNavigation("/testbank")}saveAndSwitch(e){this.editorOutputDataService.setFileProcess(e),this.commonService.myNavigation("/admin/testbank/azota-editor/"+(null!=this.cur_cateId?this.cur_cateId:0))}startParser(e){this.isFollowLibParser=!0,this.commonService.getTranslate("lang_auto_dang_xu_ly_file_dau_vao_vui_long_doi_trong_giay_lat").subscribe(n=>{this.msgLoading=n}),this.saveAndSwitch(e)}changeFileAction(e){if(this.file=void 0,null!==e)for(let n in e)"length"!=n&&"item"!=n&&(console.log("haiau",e[n].name),(0,Ut.D_)(e[n].type)||(0,Ut._4)(e[n].type)||(0,Ut.Or)(e[n].type)||e[n].name.toLowerCase().endsWith(".azt")?(0,Ut.EO)(e[n].size)<=200?(this.file=e[n],this.isChooseFile=!0):this.showErrorSnack("lang_auto_vui_long_chon_file_khong_qua_200_mb"):this.showErrorSnack("lang_auto_dinh_dang_file_khong_ho_tro_vui_long_tai_file_dot"));this.file&&(this.getFileIcon(),this.startParser(this.file))}onDrop(e){try{this.changeFileAction(e)}catch(n){alert(n)}}getFileIcon(){var e,n,i,a;const r=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"];this.file&&((0,Ut.D_)(null!==(e=this.file.type)&&void 0!==e?e:"")&&!r.includes(null!==(n=this.file.type)&&void 0!==n?n:"")?this.fileIcon="azota_assets/images/word-icon.png":(0,Ut._4)(null!==(i=this.file.type)&&void 0!==i?i:"")?this.fileIcon="azota_assets/images/pdf-icon.png":(0,Ut.Or)(null!==(a=this.file.type)&&void 0!==a?a:"")?this.fileIcon="azota_assets/images/jpg-icon.png":this.file.type&&r.includes(this.file.type)&&(this.fileIcon="azota_assets/images/excel.png")),this.fileIcon="azota_assets/images/documents.png"}beforeOpenEditor(e="editor"){this.editorOutputDataService.setMode(e),window.location=this.commonService.getLocalRouter("/admin/testbank/azota-editor/"+(null!=this.cur_cateId?this.cur_cateId:0))}ngOnInit(){(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{this.cur_cateId=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")),this.backToLink="/admin/testbank/document-management/0/"+(null!=this.cur_cateId?this.cur_cateId:0)+"/1",this.form=this.fb.group({file:new h.p4("",h.kI.required)})}),this.commonService.translateMetaData({title:"lang_cms_test_create_new_title",description:"lang_cms_test_create_new_description",image:"lang_cms_test_image"}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(h.QS),t.Y36(x.gz),t.Y36(vt.v),t.Y36(bn))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-new-document"]],features:[t.qOj],decls:107,vars:82,consts:[[3,"headerBackTolink"],[1,"intro-y","flex","items-center","mt-8"],[1,"text-lg","font-medium","mr-auto"],[1,"intro-y","chat","grid","grid-cols-12","gap-5","mt-5"],[1,"intro-y","col-span-12","lg:col-span-8","2xl:col-span-9"],[3,"formGroup","hidden"],["type","file","id","box-left-file-input","formControlName","file",1,"form-control","file-input",3,"change"],["fileSelect",""],["id","box-left-file-drop",1,"chat__box","cursor-pointer","box","px-5",3,"appDropZone","click"],[1,"h-full","flex","items-center"],[1,"mx-auto","text-center"],[1,"w-16","h-16","flex-none","image-fit","overflow-hidden","mx-auto","upload-box"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"w-16","h-16","text-primary"],["fill-rule","evenodd","d","M4.406 1.342A5.53 5.53 0 0 1 8 0c2.69 0 4.923 2 5.166 4.579C14.758 4.804 16 6.137 16 7.773 16 9.569 14.502 11 12.687 11H10a.5.5 0 0 1 0-1h2.688C13.979 10 15 8.988 15 7.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 2.825 10.328 1 8 1a4.53 4.53 0 0 0-2.941 1.1c-.757.652-1.153 1.438-1.153 2.055v.448l-.445.049C2.064 4.805 1 5.952 1 7.318 1 8.785 2.23 10 3.781 10H6a.5.5 0 0 1 0 1H3.781C1.708 11 0 9.366 0 7.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383z"],["fill-rule","evenodd","d","M7.646 4.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 5.707V14.5a.5.5 0 0 1-1 0V5.707L5.354 7.854a.5.5 0 1 1-.708-.708l3-3z"],[1,"mt-3"],[1,"font-medium","text-lg","upload-box"],[1,"text-slate-500","text-xs","mt-1"],["href","https://docs.azota.vn/docs/huong-dan-su-dung/de-thi/chon-file-keo-tha-file-de-tao-de/","target","_blank",1,"text-primary",3,"click"],[1,"pt-2"],["target","_self",1,"text-primary",3,"href","download","click"],["role","alert",1,"alert","alert-secondary-soft","flex","items-center","mt-3","p-2"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","icon-name","alert-circle","data-lucide","alert-circle",1,"lucide","lucide-alert-circle","w-6","h-6","mr-2"],["cx","12","cy","12","r","10"],["x1","12","y1","8","x2","12","y2","12"],["x1","12","y1","16","x2","12.01","y2","16"],[1,"col-span-12","lg:col-span-4","2xl:col-span-3"],["id","profile","role","tabpanel","aria-labelledby","profile-tab",1,"tab-pane"],[1,"pr-1"],[1,"box","px-5","py-10","zoom-in",3,"click"],[1,"w-12","h-12","flex-none","image-fit","overflow-hidden","mx-auto"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"w-12","h-12","text-pending"],["d","M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"],["fill-rule","evenodd","d","M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"],[1,"text-center","mt-3"],[1,"font-medium","text-lg"],[1,"text-slate-500","text-xs","mt-2"],["href","https://docs.azota.vn/docs/huong-dan-su-dung/de-thi/tu-soan-de/","target","_blank",1,"text-primary"],[1,"box","px-5","py-10","mt-5","zoom-in",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"w-12","h-12","text-success"],["d","M8.277.084a.5.5 0 0 0-.554 0l-7.5 5A.5.5 0 0 0 .5 6h1.875v7H1.5a.5.5 0 0 0 0 1h13a.5.5 0 1 0 0-1h-.875V6H15.5a.5.5 0 0 0 .277-.916l-7.5-5zM12.375 6v7h-1.25V6h1.25zm-2.5 0v7h-1.25V6h1.25zm-2.5 0v7h-1.25V6h1.25zm-2.5 0v7h-1.25V6h1.25zM8 4a1 1 0 1 1 0-2 1 1 0 0 1 0 2zM.5 15a.5.5 0 0 0 0 1h15a.5.5 0 1 0 0-1H.5z"],["href","https://docs.azota.vn/docs/huong-dan-su-dung/de-thi/tao-de-tu-ma-tran-de/","target","_blank",1,"text-primary"],["class","loading",4,"ngIf"],[1,"loading"]],template:function(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"teacher-layout",0)(1,"div",1)(2,"h3",2),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.TgZ(5,"div",3)(6,"div",4)(7,"form",5)(8,"input",6,7),t.NdJ("change",function(r){return n.selectFile(r)}),t.qZA()(),t.TgZ(10,"div",8),t.NdJ("appDropZone",function(r){return n.onDrop(r)})("click",function(){t.CHM(i);const r=t.MAs(9);return t.KtG(r.click())}),t.TgZ(11,"div",9)(12,"div",10)(13,"div",11),t.O4$(),t.TgZ(14,"svg",12),t._UZ(15,"path",13)(16,"path",14),t.qZA()(),t.kcU(),t.TgZ(17,"div",15)(18,"div",16),t._uU(19),t.ALo(20,"mytranslate"),t.qZA(),t.TgZ(21,"div",17),t._uU(22),t.ALo(23,"mytranslate"),t._UZ(24,"br"),t._uU(25),t.ALo(26,"mytranslate"),t.TgZ(27,"b"),t._uU(28),t.ALo(29,"mytranslate"),t.qZA(),t._uU(30,", "),t.TgZ(31,"b"),t._uU(32),t.ALo(33,"mytranslate"),t.qZA(),t._uU(34),t.ALo(35,"mytranslate"),t.TgZ(36,"b"),t._uU(37),t.ALo(38,"mytranslate"),t.qZA(),t._uU(39),t.ALo(40,"mytranslate"),t.TgZ(41,"a",18),t.NdJ("click",function(r){return r.stopPropagation()}),t._uU(42),t.ALo(43,"mytranslate"),t.qZA(),t.TgZ(44,"div",19)(45,"a",20),t.NdJ("click",function(r){return r.stopPropagation()}),t.ALo(46,"convertCdn"),t.ALo(47,"mytranslate"),t._uU(48),t.ALo(49,"mytranslate"),t.qZA(),t._uU(50,"\xa0|\xa0 "),t.TgZ(51,"a",20),t.NdJ("click",function(r){return r.stopPropagation()}),t.ALo(52,"convertLink"),t.ALo(53,"mytranslate"),t._uU(54),t.ALo(55,"mytranslate"),t.qZA(),t._uU(56,"\xa0|\xa0 "),t.TgZ(57,"a",20),t.NdJ("click",function(r){return r.stopPropagation()}),t.ALo(58,"convertLink"),t.ALo(59,"mytranslate"),t._uU(60),t.ALo(61,"mytranslate"),t.qZA()()()(),t.TgZ(62,"div",21),t.O4$(),t.TgZ(63,"svg",22),t._UZ(64,"circle",23)(65,"line",24)(66,"line",25),t.qZA(),t._uU(67),t.ALo(68,"mytranslate"),t.kcU(),t.TgZ(69,"b"),t._uU(70,".docx"),t.qZA(),t._uU(71,". "),t.qZA()()()()(),t.TgZ(72,"div",26)(73,"div",27)(74,"div",28)(75,"div",29),t.NdJ("click",function(){return n.beforeOpenEditor()}),t.TgZ(76,"div",30),t.O4$(),t.TgZ(77,"svg",31),t._UZ(78,"path",32)(79,"path",33),t.qZA()(),t.kcU(),t.TgZ(80,"div",34)(81,"div",35),t._uU(82),t.ALo(83,"mytranslate"),t.qZA()()(),t.TgZ(84,"div",36)(85,"span"),t._uU(86),t.ALo(87,"mytranslate"),t.qZA(),t.TgZ(88,"a",37),t._uU(89),t.ALo(90,"mytranslate"),t.qZA()(),t.TgZ(91,"div",38),t.NdJ("click",function(){return n.redirectToMixBank()}),t.TgZ(92,"div",30),t.O4$(),t.TgZ(93,"svg",39),t._UZ(94,"path",40),t.qZA()(),t.kcU(),t.TgZ(95,"div",34)(96,"div",35),t._uU(97),t.ALo(98,"mytranslate"),t.qZA()()(),t.TgZ(99,"div",36)(100,"span"),t._uU(101),t.ALo(102,"mytranslate"),t.qZA(),t.TgZ(103,"a",41),t._uU(104),t.ALo(105,"mytranslate"),t.qZA()()()()()(),t.YNc(106,gh,1,0,"div",42),t.qZA()}2&e&&(t.Q6J("headerBackTolink",n.backToLink),t.xp6(3),t.hij(" ",t.lcZ(4,30,"lang_auto_tao_de_moi")," "),t.xp6(4),t.Q6J("formGroup",n.form)("hidden",!0),t.xp6(12),t.Oqu(t.lcZ(20,32,"lang_auto_chon_file_hoc_keo_tha_file_vao_day")),t.xp6(3),t.hij(" ",t.lcZ(23,34,"lang_auto_azota_support_file_type")," .pdf, .docx, .xlsx. "),t.xp6(3),t.hij("",t.lcZ(26,36,"lang_auto_can_upload")," "),t.xp6(3),t.Oqu(t.lcZ(29,38,"lang_auto_bai_tap")),t.xp6(4),t.Oqu(t.lcZ(33,40,"lang_auto_de_thi")),t.xp6(2),t.hij(" ",t.lcZ(35,42,"lang_auto_hoac")," "),t.xp6(3),t.Oqu(t.lcZ(38,44,"lang_auto_bang_dap_an")),t.xp6(2),t.hij(" ",t.lcZ(40,46,"lang_auto_de_cham_offline"),". "),t.xp6(3),t.hij(" ",t.lcZ(43,48,"lang_auto_tim_hieu_them")," "),t.xp6(3),t.s9C("download",t.lcZ(47,52,"lang_testbank_create_document_azota_pdf_model")),t.Q6J("href",t.lcZ(46,50,"azota_assets/medias/de_mau_azota.zip"),t.LSH),t.xp6(3),t.Oqu(t.lcZ(49,54,"lang_testbank_create_document_azota_pdf_model")),t.xp6(3),t.s9C("download",t.lcZ(53,58,"lang_testbank_create_document_azota_docx_model")),t.Q6J("href",t.lcZ(52,56,"blob/master/azota_assets/medias/de_mau_azota.docx?raw=true"),t.LSH),t.xp6(3),t.Oqu(t.lcZ(55,60,"lang_testbank_create_document_azota_docx_model")),t.xp6(3),t.s9C("download",t.lcZ(59,64,"lang_testbank_create_document_azota_excel_model")),t.Q6J("href",t.lcZ(58,62,"blob/master/azota_assets/medias/de_mau_azota_excel.xlsx?raw=true"),t.LSH),t.xp6(3),t.Oqu(t.lcZ(61,66,"lang_testbank_create_document_azota_excel_model")),t.xp6(7),t.hij(" ",t.lcZ(68,68,"lang_auto_azota_best_support_file_type")+" "," "),t.xp6(15),t.hij(" ",t.lcZ(83,70,"lang_auto_tu_soan_de_tren_azota")," "),t.xp6(4),t.hij("",t.lcZ(87,72,"lang_auto_su_dung_trinh_soan_thao_de_cua_azota_chinh_sua_tu_cac_mau_co_san_hoac_copy_and_paste_tu_cac_nguon_khac_nhau"),"\xa0"),t.xp6(3),t.Oqu(t.lcZ(90,74,"lang_auto_tim_hieu_them")),t.xp6(8),t.hij(" ",t.lcZ(98,76,"lang_auto_tao_ma_tran_de_thi")," "),t.xp6(4),t.hij("",t.lcZ(102,78,"lang_auto_azota_se_sinh_ngau_nhien_de_moi_tu_cac_chuyen_de_so_luong_cau_trong_moi_chuyen_de_cac_muc_do_kho_de_ma_nguoi_dung_lua_chon"),"\xa0"),t.xp6(3),t.Oqu(t.lcZ(105,80,"lang_auto_tim_hieu_them")),t.xp6(2),t.Q6J("ngIf",n.isFollowLibParser))},dependencies:[O.O5,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,oe.M,de._,ph,at.bT,at.BI,at.Gu],encapsulation:2}),o})();function xh(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function vh(o,s){if(1&o&&(t.TgZ(0,"div",4)(1,"div",5)(2,"h3",6),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.TgZ(5,"div",7)(6,"h3",8),t._uU(7),t.ALo(8,"mytranslate"),t.qZA(),t.TgZ(9,"div",9),t._UZ(10,"input",10),t.TgZ(11,"a",11),t.O4$(),t.TgZ(12,"svg",12),t._UZ(13,"path",13)(14,"polyline",14)(15,"line",15),t.qZA(),t._uU(16),t.ALo(17,"mytranslate"),t.qZA()()()()),2&o){const e=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,5,"lang_testbank_create_wibsite_result_header_title")," \u{1f389} "),t.xp6(4),t.hij(" ",t.lcZ(8,7,"lang_testbank_create_wibsite_result_address")," "),t.xp6(3),t.s9C("value",e.linkExerciseExist),t.xp6(1),t.Q6J("href",e.linkExerciseExist,t.LSH),t.xp6(5),t.hij(" ",t.lcZ(17,9,"lang_testbank_create_wibsite_result_Access")," ")}}let bh=(()=>{class o extends mt.Q{constructor(e,n,i){super(n),this.activeRoute=e,this.commonService=n,this.examService=i,this.subscriptions=new f.w,this.status_obj={loading:!1,error:!1},this.linkExerciseExist="",this.backToLink=""}getExamDataById(){this.status_obj={loading:!0,error:!1},this.subscriptions.add(this.examService.apiExamGetWebsiteInfoGet().subscribe(e=>{var n,i,a,r;1==e.success?(this.obj=null===(n=e.data)||void 0===n?void 0:n.obj,this.linkExerciseExist=`${null===(a=null===(i=e.data)||void 0===i?void 0:i.obj)||void 0===a?void 0:a.value}`,this.status_obj={loading:!1,error:!1}):(this.showErrorSnack(null!==(r=e.message)&&void 0!==r?r:""),this.status_obj={loading:!1,error:!0})}))}ngOnInit(){(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{this.getExamDataById(),this.backToLink="/admin/testbank/create-website"}),this.commonService.translateMetaData({title:"lang_cms_test_create_website_result_title",description:"lang_cms_test_create_website_result_description",image:"lang_cms_test_image"}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(x.gz),t.Y36(vt.v),t.Y36(Ot.Oe))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-website-result"]],features:[t.qOj],decls:6,vars:6,consts:[[3,"headerTitle","headerBackTolink"],[1,"py-5","mt-8"],[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"intro-y","mt-8"],[1,"flex","items-center","justify-center"],[1,"text-lg","font-medium"],[1,"box","mx-auto","mt-5","p-3",2,"max-width","560px"],[1,"text-md","font-medium"],[1,"azt-copy","relative","mt-3","intro-x"],["type","text","readonly","",1,"form-control","py-3","px-4","border-transparent","bg-slate-100","pr-10",2,"padding-right","120px",3,"value"],["target","_blank",1,"btn","btn-outline-primary","absolute","my-auto","inset-y-0","right-0",2,"border-top-left-radius","0","border-bottom-left-radius","0",3,"href"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2","lucide"],["d","M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"],["points","15 3 21 3 21 9"],["x1","10","y1","14","x2","21","y2","3"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0),t.ALo(1,"mytranslate"),t.TgZ(2,"div",1),t.YNc(3,xh,1,0,"azt-loading-effect",2),t.YNc(4,vh,18,11,"ng-template",null,3,t.W1O),t.qZA()()),2&e){const i=t.MAs(5);t.Q6J("headerTitle",t.lcZ(1,4,"lang_testbank_create_wibsite_result_header_title"))("headerBackTolink",n.backToLink),t.xp6(3),t.Q6J("ngIf",n.status_obj.loading)("ngIfElse",i)}},dependencies:[O.O5,te.Q,de._,at.bT],styles:[".content-box[_ngcontent-%COMP%]{border-width:0px;background-color:#fff;box-sizing:border-box;border-width:1px;border-style:solid;border-color:#dcdcdc;border-radius:4px;box-shadow:none}.click-to-href[_ngcontent-%COMP%], .click-to-href[_ngcontent-%COMP%]:hover{color:#5f5f5f!important}@media only screen and (max-width: 992px){.box[_ngcontent-%COMP%]{width:60%}}@media only screen and (max-width: 768px){.box[_ngcontent-%COMP%]{width:80%}}@media only screen and (max-width: 576px){.box[_ngcontent-%COMP%]{width:90%}}@media only screen and (max-width: 380px){.box[_ngcontent-%COMP%]{width:95%}}"]}),o})();function wh(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function Th(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.handleRunSriptIframe())}),t.O4$(),t.TgZ(1,"svg",31),t._UZ(2,"path",50)(3,"path",51),t.qZA(),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()}2&o&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"lang_buttom_edit")," "))}function Ch(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.handleCancelEdit())}),t.O4$(),t.TgZ(1,"svg",31),t._UZ(2,"path",52)(3,"polyline",53)(4,"line",54)(5,"line",55),t.qZA(),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()}2&o&&(t.xp6(6),t.hij(" ",t.lcZ(7,1,"lang_buttom_cancel")," "))}function Ah(o,s){1&o&&(t.TgZ(0,"div",56),t.O4$(),t.TgZ(1,"svg",31),t._UZ(2,"circle",57)(3,"line",58)(4,"line",59),t.qZA(),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()),2&o&&(t.xp6(5),t.hij(" ",t.lcZ(6,1,"lang_auto_click_vao_tung_doan_text_ma_ban_muon_sua")," "))}function yh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",60),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.handleRunSriptIframe())}),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()}2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_buttom_edit")))}function kh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",61),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.handleCancelEdit())}),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()}2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_buttom_cancel")))}function Oh(o,s){1&o&&(t.TgZ(0,"div",62),t.O4$(),t.TgZ(1,"svg",31),t._UZ(2,"circle",57)(3,"line",58)(4,"line",59),t.qZA(),t.kcU(),t.TgZ(5,"span"),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()),2&o&&(t.xp6(6),t.hij("",t.lcZ(7,1,"lang_auto_click_vao_tung_doan_text_ma_ban_muon_sua")," "))}function Sh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"h3",8),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()(),t.TgZ(8,"div",9)(9,"h3",10)(10,"button",11),t._uU(11),t.ALo(12,"mytranslate"),t.qZA()(),t.TgZ(13,"mat-menu",null,12)(15,"div",13)(16,"div",14),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleClickTemplate("templateExample"))}),t.TgZ(17,"div",15),t._UZ(18,"img",16),t.ALo(19,"convertCdn"),t.qZA(),t.TgZ(20,"h4"),t._uU(21,"Landing Teacher"),t.qZA()()()()()()(),t.TgZ(22,"div",17)(23,"div",18)(24,"div",19)(25,"button",20),t.O4$(),t.TgZ(26,"svg",21),t._UZ(27,"line",22)(28,"line",23)(29,"line",24),t.qZA()(),t.kcU(),t.TgZ(30,"mat-menu",null,25)(32,"div",26)(33,"ul",27)(34,"li"),t.YNc(35,Th,6,3,"button",28),t.qZA(),t.TgZ(36,"li"),t.YNc(37,Ch,8,3,"button",28),t.qZA(),t.TgZ(38,"li"),t._UZ(39,"hr",29),t.qZA(),t.TgZ(40,"li")(41,"button",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleSaveTemplate())}),t.O4$(),t.TgZ(42,"svg",31),t._UZ(43,"path",32)(44,"polyline",33)(45,"polyline",34),t.qZA(),t._uU(46),t.ALo(47,"mytranslate"),t.qZA()()()()()()(),t.kcU(),t.TgZ(48,"div",35)(49,"div",36),t.YNc(50,Ah,7,3,"div",37),t.YNc(51,yh,3,3,"a",38),t.TgZ(52,"a",39),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleSaveTemplate())}),t._uU(53),t.ALo(54,"mytranslate"),t.qZA(),t.YNc(55,kh,3,3,"a",40),t.qZA()()(),t.TgZ(56,"div",41),t.YNc(57,Oh,8,3,"div",42),t.qZA()(),t.TgZ(58,"div",43)(59,"div",44)(60,"div",45)(61,"div",46)(62,"div",14),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleClickTemplate("templateExample"))}),t.TgZ(63,"div",15),t._UZ(64,"img",16),t.ALo(65,"convertCdn"),t.qZA(),t.TgZ(66,"h4"),t._uU(67,"Landing Teacher"),t.qZA()()()()(),t.TgZ(68,"div",47)(69,"div",48),t._UZ(70,"iframe",49),t.ALo(71,"safe"),t.qZA()()()()}if(2&o){const e=t.MAs(14),n=t.MAs(31),i=t.oxw();t.xp6(6),t.Oqu(t.lcZ(7,21,"lang_testbank_create_wibsite_Sampling")),t.xp6(4),t.Q6J("matMenuTriggerFor",e),t.xp6(1),t.hij(" ",t.lcZ(12,23,"lang_testbank_create_wibsite_Sampling")," "),t.xp6(5),t.Gre("template-item ","templateExample"==i.templateName?"previewed":"",""),t.xp6(2),t.Q6J("src",t.lcZ(19,25,"azota_assets/templates/templateExample/template_2_feature.png"),t.LSH),t.xp6(7),t.Q6J("matMenuTriggerFor",n),t.xp6(10),t.Q6J("ngIf",!i.isEditable),t.xp6(2),t.Q6J("ngIf",i.isEditable),t.xp6(9),t.hij(" ",t.lcZ(47,27,"lang_buttom_save")," "),t.xp6(4),t.Q6J("ngIf",i.isEditable),t.xp6(1),t.Q6J("ngIf",!i.isEditable),t.xp6(2),t.Oqu(t.lcZ(54,29,"lang_buttom_save")),t.xp6(2),t.Q6J("ngIf",i.isEditable),t.xp6(2),t.Q6J("ngIf",i.isEditable),t.xp6(5),t.Gre("template-item ","templateExample"==i.templateName?"previewed":"",""),t.xp6(2),t.Q6J("src",t.lcZ(65,31,"azota_assets/templates/templateExample/template_2_feature.png"),t.LSH),t.xp6(6),t.Q6J("src",t.lcZ(71,33,i.iframeSrc),t.uOi)}}let Eh=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l){super(a),this.usersettingService=e,this.http=n,this.activeRoute=i,this.commonService=a,this.baseApiService=r,this.apiUploadService=l,this.subscriptions=new f.w,this.isLoading=!1,this.isEditable=!1,this.templateName="templateExample",this.iframeSrc="/assets/templates/"+this.templateName+"/index.html",this.websiteUrl="",this.backToLink=""}handleClickTemplate(e){this.iframeSrc="/assets/templates/"+e+"/index.html",this.templateName=e}handleCancelEdit(){this.isEditable=!1,window.location.reload()}handleRunSriptIframe(){this.isEditable=!0;const e=document.getElementById("template-iframe"),n=e?e.contentWindow:null;n&&n.eval("\n        // *** INSERT THE SCRIPT TAG TO HEAD ***\n        // ---------------------------------------\n        var scriptExist=document.getElementById('ladi');\n        if(!scriptExist){console.log('Script Exist');\n        var script=document.createElement('script');\n        var att=document.createAttribute('src');\n        var attId=document.createAttribute('id');\n        att.value='https://wewiin.nyc3.digitaloceanspaces.com/storage_public/azota_assets/templates/common/ladipage.v2.js';\n        attId.value='ladi'; script.setAttributeNode(att);\n        script.setAttributeNode(attId);\n\n        document.head.appendChild(script);}\n        ")}getWebsiteUrl(){this.initStatusObj(),this.subscriptions.add(this.usersettingService.apiUsersettingGetMyDomainGet().subscribe(e=>{var n,i,a;1==e.success?((null===(n=e.data)||void 0===n?void 0:n.obj)&&(null===(i=e.data)||void 0===i?void 0:i.obj.value)?(this.websiteUrl=e.data.obj.value,this.websiteUrl=this.websiteUrl):this.websiteUrl=this.commonService.getLocalRouter(this.commonService.getHostUrl()+"/en/test/category/"+this.baseApiService.getUserObj().id+"/0/1"),this.successStatusObj()):this.errorStatusObj(null!==(a=e.message)&&void 0!==a?a:"",!0)}))}handleSaveTemplate(){const e=document.getElementById("template-iframe"),n=e?e.contentWindow:null;if(n){n.eval("\n        // *** REMOVE LADI JS SCRIPT TAG ***\n        // ---------------------------------\n        const myScript = document.getElementById('ladi');\n        if(myScript){myScript.remove();}\n\n        // *** REMOVE INPUT FILE TAG  ***\n        // ------------------------------\n        var inputFiles = document.querySelectorAll('.tpl-input-file');\n        inputFiles.forEach(input=>{jQuery(input).unwrap(); input.remove();});\n\n        // *** CHANGE ALL CONTENTEDITABLE TO FALSE ***\n        // -------------------------------------------\n        var editables=document.querySelectorAll('[contentEditable=true]');\n        editables.forEach(e=>{e.setAttribute('contentEditable','false');});\n        "),this.isLoading=!0;var i=n.document.body.outerHTML;this.apiUploadService.commonUploadLadipageFile(i,this.templateName,i.length).subscribe(a=>{var r,l,c;a.type!=Te.dt.UploadProgress&&(1==a.success&&(null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.url)?this.usersettingService.apiUsersettingSaveMyDomainPost({path:null!==(c=null===(l=null==a?void 0:a.data)||void 0===l?void 0:l.url)&&void 0!==c?c:""}).subscribe(_=>{1==_.success?this.commonService.myNavigation("/admin/testbank/create-website-result"):(this.isLoading=!1,this.showErrorSnack("lang_auto_luu_website_template_khong_thanh_cong"))}):(this.isLoading=!1,this.showErrorSnack("lang_auto_luu_website_template_khong_thanh_cong")))})}}ngOnInit(){(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{this.backToLink="/admin/dashboard",this.getWebsiteUrl()}),this.commonService.translateMetaData({title:"lang_cms_test_create_website_title",description:"lang_cms_test_create_website_description",image:"lang_cms_test_image"}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Ot.nb),t.Y36(Te.eN),t.Y36(x.gz),t.Y36(vt.v),t.Y36(zn._),t.Y36(Mn.$))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-website"]],features:[t.qOj],decls:5,vars:7,consts:[[3,"headerTitle","new_link","headerBackTolink"],[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"container-builder","container-fluid","mt-3","pb-mb-80"],[1,"grid","grid-cols-12","gap-3","button-row","justify-between","mb-4"],[1,"col-span-4",2,"align-self","center"],[1,"button-bar","mb-0"],[1,"azt-hidden","lg:block"],[1,"text-md","font-medium",2,"padding-top","10px","padding-left","10px"],[1,"block","xl:hidden"],[1,"text-md","font-medium"],[1,"btn","btn-secondary",3,"matMenuTriggerFor"],["choose","matMenu"],[1,"box","dialog-landing"],[3,"click"],[1,"tpl-avatar"],["alt","",3,"src"],[1,"col-span-8","pt-0","pb-0","text-right","w-full"],[1,"flex","justify-end","sm:hidden"],[1,"button-bar","flex","justify-end"],[1,"btn","btn-outline-secondary",3,"matMenuTriggerFor"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-5","h-5","lucide"],["x1","4","y1","12","x2","20","y2","12"],["x1","4","y1","6","x2","20","y2","6"],["x1","4","y1","18","x2","20","y2","18"],["reorder","matMenu"],[1,"dropdown-menu","w-56","show","relative","p-3"],[1,"dropdown-content"],["class","dropdown-item w-full",3,"click",4,"ngIf"],[1,"dropdown-divider","border-slate-200","dark:border-darkmode-400"],[1,"dropdown-item","w-full",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide","mr-2"],["d","M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"],["points","17 21 17 13 7 13 7 21"],["points","7 3 7 8 15 8"],[1,"azt-hidden","sm:block"],[1,"button-bar","justify-end"],["class","alert alert-info mr-3 mb-0 items-center flex p-2",4,"ngIf"],["class","btn btn-secondary mr-2 w-20",3,"click",4,"ngIf"],[1,"btn","btn-primary","w-20",3,"click"],["class","btn btn-secondary ml-2 w-20",3,"click",4,"ngIf"],[1,"col-span-12","block","sm:hidden"],["class","alert alert-info mr-1 mb-0 items-center flex text-left p-2",4,"ngIf"],[1,"grid","grid-cols-12","gap-3","content-row"],[1,"col-span-2","hidden","lg:block"],[1,"list-template"],[1,"wrap-layer"],[1,"col","col-span-12","sm:col-span-12","md:col-span-10"],[1,"wrap-layer","w-full"],["id","template-iframe","frameborder","0",2,"width","100%","height","100%",3,"src"],["d","M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"],["d","M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["x1","9.5","y1","12.5","x2","14.5","y2","17.5"],["x1","14.5","y1","12.5","x2","9.5","y2","17.5"],[1,"alert","alert-info","mr-3","mb-0","items-center","flex","p-2"],["cx","12","cy","12","r","10"],["x1","12","y1","16","x2","12","y2","12"],["x1","12","y1","8","x2","12.01","y2","8"],[1,"btn","btn-secondary","mr-2","w-20",3,"click"],[1,"btn","btn-secondary","ml-2","w-20",3,"click"],[1,"alert","alert-info","mr-1","mb-0","items-center","flex","text-left","p-2"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0),t.ALo(1,"mytranslate"),t.YNc(2,wh,1,0,"azt-loading-effect",1),t.YNc(3,Sh,72,35,"ng-template",null,2,t.W1O),t.qZA()),2&e){const i=t.MAs(4);t.Q6J("headerTitle",t.lcZ(1,5,"lang_testbank_create_wibsite_header_title"))("new_link",n.websiteUrl)("headerBackTolink","/admin/dashboard"),t.xp6(2),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.O5,he.VK,he.p6,te.Q,de._,at.bT,at.yl,at.BI],styles:[".container-builder[_ngcontent-%COMP%]{height:calc(100vh - 72px);overflow:hidden;display:flex;flex-direction:column}.container-builder[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-2[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:15px;height:38px;display:flex;justify-content:center;align-items:center}.container-builder[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]   .col-content[_ngcontent-%COMP%]{background:white;padding:15px;flex:auto;border:1px solid #ececec;border-radius:3px}.container-builder[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   #template-iframe[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden}.container-builder[_ngcontent-%COMP%]   .content-row[_ngcontent-%COMP%]{flex:auto;overflow:hidden}.container-builder[_ngcontent-%COMP%]   .content-row[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]   .wrap-layer[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#fff;padding:15px;border:1px solid #ccc;border-radius:3px}.container-builder[_ngcontent-%COMP%]   .content-row[_ngcontent-%COMP%]   .col.list-template[_ngcontent-%COMP%]{padding-right:0}.container-builder[_ngcontent-%COMP%]   .content-row[_ngcontent-%COMP%]   .col.list-template[_ngcontent-%COMP%]   .wrap-layer[_ngcontent-%COMP%]{overflow-y:auto}.container-builder[_ngcontent-%COMP%]   .list-template[_ngcontent-%COMP%]{height:100%}.button-bar[_ngcontent-%COMP%]{display:flex;align-items:center}.button-bar[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{flex:auto;margin-bottom:0;text-align:center}.template-item[_ngcontent-%COMP%]:hover{cursor:pointer}.template-item[_ngcontent-%COMP%]:hover   .tpl-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(1.2)}.template-item[_ngcontent-%COMP%]   .tpl-avatar[_ngcontent-%COMP%]{width:100%;height:0;padding-top:66.6666666667%;position:relative;overflow:hidden}.template-item[_ngcontent-%COMP%]   .tpl-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;height:auto;width:100%;top:0;left:0;transition:all .5s}.template-item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-weight:500;margin-top:3px}[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#fff}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#999999;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#414141}.dialog-landing[_ngcontent-%COMP%]{width:280px;padding:20px}"]}),o})();function Ih(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function Zh(o,s){if(1&o&&(t.TgZ(0,"div",20),t._UZ(1,"print-history-box",21),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("examObj",e.examObj)("offlineExamObj",e.offlineExamObj)}}const jo=function(o){return[o]};function Mh(o,s){if(1&o&&(t.TgZ(0,"div",3)(1,"div",4)(2,"h3",5),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.TgZ(5,"div",6),t.YNc(6,Zh,2,2,"div",7),t.qZA(),t.TgZ(7,"div",8)(8,"div",9)(9,"a",10),t.ALo(10,"mylocalize"),t.O4$(),t.TgZ(11,"svg",11),t._UZ(12,"path",12)(13,"polyline",13)(14,"path",14)(15,"path",15)(16,"path",16)(17,"path",17),t.qZA(),t._uU(18),t.ALo(19,"mytranslate"),t.qZA()(),t.kcU(),t.TgZ(20,"div",18)(21,"a",10),t.ALo(22,"mylocalize"),t.O4$(),t.TgZ(23,"svg",11),t._UZ(24,"path",19),t.qZA(),t._uU(25),t.ALo(26,"mytranslate"),t.qZA()()()()),2&o){const e=t.oxw();let n,i;t.xp6(3),t.hij(" ",t.lcZ(4,6,"lang_auto_tao_file_thanh_cong")," \u{1f44f} "),t.xp6(3),t.Q6J("ngIf",e.offlineExamObj.hashId),t.xp6(3),t.Q6J("routerLink",t.VKq(16,jo,t.lcZ(10,8,"/admin/testbank/exam-results-list/"+(null!==(n=e.examObj.categoryId)&&void 0!==n?n:0)+"/"+e.examObj.id+"/0"))),t.xp6(9),t.hij(" ",t.lcZ(19,10,"lang_auto_quan_ly_danh_sach_da_thi")," "),t.xp6(3),t.Q6J("routerLink",t.VKq(18,jo,t.lcZ(22,12,"/admin/testbank/document-management/0/"+(null!==(i=e.examObj.categoryId)&&void 0!==i?i:0)+"/1"))),t.xp6(4),t.hij(" ",t.lcZ(26,14,"lang_auto_ve_trang_quan_ly_file")," ")}}let Ph=(()=>{class o extends mt.Q{constructor(e,n,i){super(e),this.commonService=e,this.documentConfigService=n,this.activeRoute=i,this.backToLink="",this.offlineHashId=""}redirectToDocumentManager(){var e;this.myNavigation(`/admin/testbank/document-management/0/${null!==(e=this.examObj.categoryId)&&void 0!==e?e:0}/1`)}redirectToTestResultList(){var e;this.myNavigation(`/admin/testbank/exam-results-list/${null!==(e=this.examObj.categoryId)&&void 0!==e?e:0}/${this.examObj.id}/0`)}getExamInfo(e,n){this.initStatusObj(),this.subscriptions.add(this.documentConfigService.apiDocumentConfigGetExamConfigDataGet(e,n).subscribe(i=>{var a,r;1==i.success?((null===(a=i.data)||void 0===a?void 0:a.examObj)&&i.data.offlineExamObj&&(this.examObj=i.data.examObj,this.offlineExamObj=i.data.offlineExamObj),this.successStatusObj()):this.errorStatusObj(null!==(r=i.message)&&void 0!==r?r:"",!0)}))}ngOnInit(){var e,n,i;let a=null!==(e=this.commonService.getMyParam(this.activeRoute,"hash_id"))&&void 0!==e?e:"",r=null!==(n=this.commonService.getMyParam(this.activeRoute,"cat_id"))&&void 0!==n?n:"";this.offlineHashId=null!==(i=this.commonService.getMyParam(this.activeRoute,"offline_hash_id"))&&void 0!==i?i:"",this.getExamInfo(a,this.offlineHashId);let l=this.commonService.getMyQueryParam("backto");this.backToLink=null!=l?l:`/admin/testbank/document-management/0/${r}/1`,this.commonService.translateMetaData({title:"lang_cms_download_print_data_title",description:"lang_cms_download_print_data_description",image:""}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Ot.Cq),t.Y36(x.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-download-file-print"]],features:[t._Bn([O.uU]),t.qOj],decls:5,vars:3,consts:[[3,"headerBackTolink"],[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"intro-y","action-document","mx-auto","mt-8",2,"max-width","700px"],[1,"action-heading","mb-4"],[1,"text-lg","font-medium","mb-1"],[1,"action-offline","mt-5"],["class","box mt-3 p-5",4,"ngIf"],[1,"mt-5","flex","flex-col","sm:flex-row","justify-center","items-center"],[1,"mr-2"],[1,"btn","btn-outline-primary","btn-transparent",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["d","M8 13h2"],["d","M8 17h2"],["d","M14 13h2"],["d","M14 17h2"],[1,"w-30"],["d","M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"],[1,"box","mt-3","p-5"],[3,"examObj","offlineExamObj"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0),t.YNc(1,Ih,1,0,"azt-loading-effect",1),t.YNc(2,Mh,27,20,"ng-template",null,2,t.W1O),t._UZ(4,"azt-status-loading-effect"),t.qZA()),2&e){const i=t.MAs(3);t.Q6J("headerBackTolink",n.backToLink),t.xp6(1),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[x.yS,O.O5,te.Q,mn.G,de._,Io,at.mp,at.bT],styles:[".app[_ngcontent-%COMP%]{margin-top:100px}.app-block[_ngcontent-%COMP%]{max-width:750px;margin:0 auto}.app-head[_ngcontent-%COMP%]{text-align:center}.app-title[_ngcontent-%COMP%]{font-size:14px;font-weight:500;margin-bottom:0}.app-main[_ngcontent-%COMP%]{margin-top:40px}.app-copy[_ngcontent-%COMP%]{display:flex;justify-content:center;position:relative;width:630px;margin:0 auto}.btn-export[_ngcontent-%COMP%]{transition:all .5s;background:#2361ae}.btn-export[_ngcontent-%COMP%]:hover:enabled{background:#122e50}.app-content[_ngcontent-%COMP%]{border:none;outline:none;background:#fff;border-radius:5px;box-shadow:#00000012 0 0 5px;height:70px;box-sizing:border-box;padding:15px 20px;font-size:18px;color:#2361ae;width:100%;display:flex;align-items:center}.app-content-icon[_ngcontent-%COMP%]{margin-right:15px}.app-main-bottom[_ngcontent-%COMP%]{margin:30px auto 0;text-align:center;max-width:630px}.btn-text[_ngcontent-%COMP%]{border:none;text-transform:uppercase;background:transparent;color:#2361ae}.app-footer[_ngcontent-%COMP%]{margin-top:40px;margin-bottom:100px;text-align:center}.app-footer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#babbbc;font-size:18px}.btn-copy[_ngcontent-%COMP%]{position:absolute;display:flex;background:#2361ae;align-items:center;right:0;height:100%;width:134px;border:none;padding:22px 23px;color:#fff;border-top-left-radius:0;border-bottom-left-radius:0;transition:all .5s}.btn-copy[_ngcontent-%COMP%]:hover{background:#184479}.btn-copy[_ngcontent-%COMP%]   .text-copy[_ngcontent-%COMP%]{margin-left:15px;text-transform:initial;font-size:16px}.btn-copy[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:30px;height:30px;font-size:30px}.truncate[_ngcontent-%COMP%]{width:70%}@media screen and (max-width: 768px){.app-copy[_ngcontent-%COMP%]{max-width:630px;width:auto}.btn-copy[_ngcontent-%COMP%]{right:0;width:auto}.app-content[_ngcontent-%COMP%]{padding-left:15px;padding-right:140px}}"]}),o})();var Ze=b(66750);let qo=(()=>{class o{constructor(e){this.browserStorageService=e,this.global_data_filter={}}getCustomFilter(e,n){let i="";switch(e){case"exam":i="saveFilterExam_"+n;break;case"homework":i="saveFilterHomework_"+n}return this.global_data_filter[i]}setCustomFilter(e,n,i){let a="";switch(n){case"exam":a="saveFilterExam_"+i,this.global_data_filter[a]="",e.isMarked&&(this.global_data_filter[a]+="isMarked "),e.isNotMarked&&(this.global_data_filter[a]+="isNotMarked "),e.isOnTest&&(this.global_data_filter[a]+="isOnTest "),e.isNotTested&&(this.global_data_filter[a]+="isNotTested ");break;case"homework":a="saveFilterHomework_"+i,this.global_data_filter[a]="",e.isMarked&&(this.global_data_filter[a]+="isMarked "),e.isSubmitted&&(this.global_data_filter[a]+="isSubmitted "),e.isNotSubmit&&(this.global_data_filter[a]+="isNotSubmit "),e.mustReSubmit&&(this.global_data_filter[a]+="mustReSubmit ")}}removeCustomFilter(e,n){let i="";switch(e){case"exam":i="saveFilterExam_"+n,this.global_data_filter[i]="";break;case"homework":i="saveFilterHomework_"+n,this.global_data_filter[i]=""}}getStatusSideNav(e){var n;return null!==(n=this.browserStorageService.getSimpleStorage("statusSideNav_"+e))&&void 0!==n?n:""}removeStatusSideNav(e){this.browserStorageService.removeSimpleStorage("statusSideNav_"+e)}saveStatusSideNav(e,n){this.browserStorageService.saveSimpleStorage("statusSideNav_"+e,n?"open":"close")}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(Be.z))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Xe=b(15431),jn=b(61886),Qo=b(81896),yn=b(35191);let Lh=(()=>{class o{constructor(e,n,i,a,r,l,c){this.commonService=e,this.examPageResultService=n,this.permissionService=i,this.globalService=a,this.browserStorageService=r,this.gzipHelper=l,this.homeworkExamService=c}getTestedUserObjs(e,n,i){return this.globalService.startIntervalFunc(e),this.getTestedOfExamResult(e,n,"default",i)}getTestedLastMark(e,n){return this.globalService.startIntervalFunc(e),this.getTestedOfExamResult(e,n,"last")}getTestedHighestMark(e,n){return this.globalService.startIntervalFunc(e),this.getTestedOfExamResult(e,n,"highest")}getTestedFirstMark(e,n){return this.globalService.startIntervalFunc(e),this.getTestedOfExamResult(e,n,"first")}getTestedAllResult(e,n){return this.globalService.startIntervalFunc(e),this.getTestedOfExamResult(e,n,"all")}getTestedOfExamResult(e,n,i,a){return new Nn.y(r=>{var l;let c="tested_list_result_v2_"+n,_=null!==(l=this.browserStorageService.getSimpleStorage(c))&&void 0!==l?l:"",d=this.commonService.willDeleteParseJson(_)&&this.commonService.willDeleteParseJson(_).data?this.commonService.willDeleteParseJson(this.gzipHelper.resultContentSuport(this.commonService.willDeleteParseJson(_).data)):void 0;a&&d?(r.next({status:200,success:1,data:d,message:"successful"}),r.complete()):this.examPageResultService.apiExamPageResultGetObjV2Get(n).subscribe(m=>{var p,w,C,A,M,D,q,U,F,tt,W,P,R,N,B,z,X,V,J,et,ot;if(1==m.success){let lt=null!==(w=null===(p=m.data)||void 0===p?void 0:p.serverSecond)&&void 0!==w?w:0,rt=null!==(A=null===(C=m.data)||void 0===C?void 0:C.examObj)&&void 0!==A?A:{},xt=null!==(D=null===(M=m.data)||void 0===M?void 0:M.classroomWithAvatarAndStudentObjs)&&void 0!==D?D:new Array,ht=null!==(U=null===(q=m.data)||void 0===q?void 0:q.totalAttended)&&void 0!==U?U:0,gt=null!==(tt=null===(F=m.data)||void 0===F?void 0:F.examQuestionObjs)&&void 0!==tt?tt:new Array,dt=null===(W=m.data)||void 0===W?void 0:W.examCreatorObj,yt=null===(P=m.data)||void 0===P?void 0:P.offlineExamObj,bt=null===(R=m.data)||void 0===R?void 0:R.offlineMixQuestionObjs,At=null===(N=m.data)||void 0===N?void 0:N.canResetStudentCode,kt=null===(B=m.data)||void 0===B?void 0:B.hasCreateStudentCode,Qt=null!==(X=null===(z=m.data)||void 0===z?void 0:z.fileTypeStr)&&void 0!==X?X:"";if(this.permissionService.hasViewPermission("exam",rt.permissionObj)||this.permissionService.hasConfigAndViewClassroomPermission("exam",rt.permissionObj)||this.permissionService.hasConfigAndMarkClassroomPermission("exam",rt.permissionObj))this.getAllExamResultObjs(e,[],n,"",Bt=>{var Gt,ne,ae,Jt,ie,$t,be,Ce,Ae,Se,Pe,Yt,sn,He,ze,rn,ye,qe,Qe,Le,Ne,Ye,Ue,gn,Xn,Kt,fn,Vt,Rn,On,ti,Bn,ei,ni;if(Bt.hasOwnProperty("success")&&1==Bt.success){let Ge=this.mergeStudentWithAvatar(null!==(Gt=Bt.studentWithResultObjs)&&void 0!==Gt?Gt:[]),le={},fe={},Jn=[];null==Ge||Ge.forEach(Pt=>{var me,Zt,se;let Nt=null!==(me=Pt.parentId)&&void 0!==me?me:"0";le.hasOwnProperty(Nt)||(le[Nt]=null!==(Zt=Pt.examResultObjs)&&void 0!==Zt?Zt:[]),fe.hasOwnProperty(Nt)||(fe[Nt]=null!==(se=Pt.nameImages)&&void 0!==se?se:{}),Jn=Jn.concat(le[Nt])});let Hn=this.filterExamResultOnTest(Jn,rt,lt),xe=[],we=[];if(this.homeworkExamService.mustInClassroom(null!==(ne=rt.whoAllow)&&void 0!==ne?ne:0)&&xt.length>0)for(let Pt=0;Pt<xt.length;Pt++){let me=xt[Pt].classroomObj,Zt=null!==(ae=xt[Pt].studentObjs)&&void 0!==ae?ae:[],se=[];if(Zt.length>0)for(let Nt=0;Nt<Zt.length;Nt++){let xn=null!==(Jt=Zt[Nt].parentId)&&void 0!==Jt?Jt:"0";this.commonService.filterArray(we,Zt[Nt].parentId)||we.push(null!==(ie=Zt[Nt].parentId)&&void 0!==ie?ie:"0"),le.hasOwnProperty(xn)&&(Array.isArray(Zt[Nt].examResultObjs)||(Zt[Nt].examResultObjs=[]),Zt[Nt].examResultObjs=this.findExamResultOfStudent(null!==(be=null===($t=Zt[Nt].examResultObjs)||void 0===$t?void 0:$t.concat(le[xn]))&&void 0!==be?be:[],null!==(Ce=Zt[Nt].id)&&void 0!==Ce?Ce:0));let Sn=Hn.hasOwnProperty(null!==(Ae=Zt[Nt].parentId)&&void 0!==Ae?Ae:0)?Hn[null!==(Se=Zt[Nt].parentId)&&void 0!==Se?Se:0]:0;if("all"==i)if(null!==(Pe=Zt[Nt].examResultObjs)&&void 0!==Pe&&Pe.length)null===(Yt=Zt[Nt].examResultObjs)||void 0===Yt||Yt.forEach((Re,En)=>{var In,ii,no;let oi=null!==(In=this.commonService.castJsonToObj(JSON.stringify(Re)))&&void 0!==In?In:{};oi.resultId=oi.testStatus&&oi.testStatus>0?oi.id:0;let yT=this.createStudentWithResult(Zt[Nt],oi,Sn,gt.length,En,null!==(no=null===(ii=Zt[Nt].examResultObjs)||void 0===ii?void 0:ii.length)&&void 0!==no?no:0);se.push(yT)});else{let Re=this.createStudentWithResult(Zt[Nt],{},Sn,gt.length,-1,0);se.push(Re)}else{let Re=this.filterExamResultByType(null!==(sn=Zt[Nt].examResultObjs)&&void 0!==sn?sn:[],i),En=Re.hasOwnProperty(null!==(He=Zt[Nt].parentId)&&void 0!==He?He:0)?Re[null!==(ze=Zt[Nt].parentId)&&void 0!==ze?ze:0]:{},In=En.indexTest?En.indexTest:"first"==i?0:(null!==(ye=null===(rn=Zt[Nt].examResultObjs)||void 0===rn?void 0:rn.length)&&void 0!==ye?ye:0)-1,ii=this.createStudentWithResult(Zt[Nt],En,Sn,gt.length,null!=In?In:0,null!==(Qe=null===(qe=Zt[Nt].examResultObjs)||void 0===qe?void 0:qe.length)&&void 0!==Qe?Qe:0);se.push(ii)}}xe.push({classObj:me,results:se})}let ee=[],Ft=null!==(Le=this.commonService.myClone(Ge))&&void 0!==Le?Le:[];for(let Pt=0;Pt<(null==Ft?void 0:Ft.length);Pt++)if(!this.commonService.filterArray(we,Ft[Pt].parentId)){let me=Hn.hasOwnProperty(null!==(Ne=Ft[Pt].parentId)&&void 0!==Ne?Ne:0)?Hn[null!==(Ye=Ft[Pt].parentId)&&void 0!==Ye?Ye:0]:0;if("all"==i)if(null!==(Ue=Ft[Pt].examResultObjs)&&void 0!==Ue&&Ue.length)null===(gn=Ft[Pt].examResultObjs)||void 0===gn||gn.forEach((Zt,se)=>{var Nt,xn,Sn;let Re=null!==(Nt=this.commonService.castJsonToObj(JSON.stringify(Zt)))&&void 0!==Nt?Nt:{};Re.resultId=Re.testStatus&&Re.testStatus>0?Re.id:0;let En=this.createStudentWithResult(Ft[Pt],Re,me,gt.length,se,null!==(Sn=null===(xn=Ft[Pt].examResultObjs)||void 0===xn?void 0:xn.length)&&void 0!==Sn?Sn:0);ee.push(En)});else{let Zt=this.createStudentWithResult(Ft[Pt],{},me,gt.length,-1,0);ee.push(Zt)}else{let Zt=this.filterExamResultByType(null!==(Xn=Ft[Pt].examResultObjs)&&void 0!==Xn?Xn:[],i),se=Zt.hasOwnProperty(null!==(Kt=Ft[Pt].parentId)&&void 0!==Kt?Kt:0)?Zt[null!==(fn=Ft[Pt].parentId)&&void 0!==fn?fn:0]:{},Nt=se.indexTest?se.indexTest:"first"==i?0:(null!==(Rn=null===(Vt=Ft[Pt].examResultObjs)||void 0===Vt?void 0:Vt.length)&&void 0!==Rn?Rn:0)-1,xn=this.createStudentWithResult(Ft[Pt],se,me,gt.length,null!=Nt?Nt:0,null!==(ti=null===(On=Ft[Pt].examResultObjs)||void 0===On?void 0:On.length)&&void 0!==ti?ti:0);ee.push(xn)}}"all"!=i&&ee.sort((Pt,me)=>{var Zt,se;return this.compareTwoDate(null!==(Zt=Pt.createdAt)&&void 0!==Zt?Zt:"",null!==(se=me.createdAt)&&void 0!==se?se:"")});let ue=0;(xe.length||ee.length)&&(xe.forEach(Pt=>{var me;null===(me=Pt.results)||void 0===me||me.forEach(Zt=>{var se;let Nt=this.getMaxGroupId(null!==(se=Zt.groupPoints)&&void 0!==se?se:[]);ue<Nt&&(ue=Nt)})}),ee.forEach(Pt=>{var me;let Zt=this.getMaxGroupId(null!==(me=Pt.groupPoints)&&void 0!==me?me:[]);ue<Zt&&(ue=Zt)}));let Fe={studentsInClassResults:xe.length>0?xe:[],studentsNotInClassResults:ee.length>0?ee:[],totalAttended:ht,totalUsers:0,examCreatorObj:dt,offlineMixQuestionObjs:bt,examObj:rt,offlineExamObj:yt,canResetStudentCode:At,hasCreateStudentCode:kt,questionObjs:gt,fileTypeStr:Qt,errorConfigClassroomPermission:null===(Bn=m.data)||void 0===Bn?void 0:Bn.errorConfigClassroomPermission,errorMessage:null===(ei=m.data)||void 0===ei?void 0:ei.errorMessage,maxGroupId:ue};if("export_tool"!=e){(this.browserStorageService.getSizeOfStorageByKey("tested_list_result_v2")>2||this.browserStorageService.getSizeOfStorage()>4.5)&&this.browserStorageService.removeSimpleStorageByKey("tested_list_result_v2");let Pt=this.gzipHelper.zipBigContent(JSON.stringify(Fe));this.browserStorageService.saveSimpleStorage(c,Pt)}r.next({status:200,success:1,data:Fe,message:"successful"}),r.complete()}else r.next({status:Bt.code,success:0,data:null,message:null!==(ni=Bt.message)&&void 0!==ni?ni:""}),r.complete()});else{var ut={studentsInClassResults:[],studentsNotInClassResults:[],totalAttended:ht,totalUsers:0,examCreatorObj:dt,offlineMixQuestionObjs:bt,examObj:rt,offlineExamObj:yt,canResetStudentCode:At,hasCreateStudentCode:kt,questionObjs:gt,fileTypeStr:null===(V=m.data)||void 0===V?void 0:V.fileTypeStr,errorConfigClassroomPermission:null===(J=m.data)||void 0===J?void 0:J.errorConfigClassroomPermission,errorMessage:null===(et=m.data)||void 0===et?void 0:et.errorMessage,maxGroupId:0};r.next({status:200,success:1,data:ut,message:"successful"}),r.complete()}}else r.next({status:m.code,success:0,data:null,message:null!==(ot=m.message)&&void 0!==ot?ot:""}),r.complete()})})}getAllExamResultObjs(e,n,i,a,r){this.examPageResultService.apiExamPageResultGetObjsV2Get(i,"test_review"==e||"export_tool"==e?"export":"tested_list",a).subscribe(c=>{var _,d,m;1==c.success?(!(null===(_=c.data)||void 0===_)&&_.objs&&n.push(...c.data.objs),null!==(d=c.data)&&void 0!==d&&d.nextPage?this.globalService.isStopIntervalFunc(e)?r({studentWithResultObjs:n,success:1}):setTimeout(()=>{var p,w;this.getAllExamResultObjs(e,n,i,null!==(w=null===(p=c.data)||void 0===p?void 0:p.nextPage)&&void 0!==w?w:"",r)},300):r({studentWithResultObjs:n,success:1})):r({code:c.code,studentWithResultObjs:[],success:0,message:null!==(m=c.message)&&void 0!==m?m:""})})}compareTwoDate(e,n){var i=new Date(e).getTime();i=isNaN(i)?0:i;var a=new Date(n).getTime();return i-(a=isNaN(a)?0:a)>0?1:i-a<0?-1:0}filterExamResultOnTest(e,n,i){var a={};return e.forEach(r=>{var l,c,_,d,m,p,w,C,A=null!==(l=this.commonService.myClone(r))&&void 0!==l?l:{};if(A.testStatus)a[null!==(c=A.userId)&&void 0!==c?c:0]=A.testStatus;else if(A.startedTest&&i)if(n.endTime){var M=Math.floor(new Date(n.endTime).getTime()/1e3);i<=M+60*(null!==(_=n.minutes)&&void 0!==_?_:0)+600?a[null!==(d=A.userId)&&void 0!==d?d:0]=0:a[null!==(m=A.userId)&&void 0!==m?m:0]=-1}else{var D=A.startedTest?Math.floor(new Date(A.startedTest).getTime()/1e3):0;i<=D+86400?a[null!==(p=A.userId)&&void 0!==p?p:0]=0:a[null!==(w=A.userId)&&void 0!==w?w:0]=-1}else a[null!==(C=A.userId)&&void 0!==C?C:0]=0}),a}filterExamResultByType(e,n){var i,a,r={};if(e.length>1)e.forEach((c,_)=>{var d,m,p,w,C,A,M,D,q,U,F=this.commonService.myClone(c);c.testStatus&&(F.resultId=F.id,F.indexTest=_,"default"==n&&(r[null!==(d=F.userId)&&void 0!==d?d:0]=F),"last"==n&&(r[null!==(m=F.userId)&&void 0!==m?m:0]=F),"first"==n&&(r.hasOwnProperty(null!==(p=F.userId)&&void 0!==p?p:0)||(r[null!==(w=F.userId)&&void 0!==w?w:0]=F)),"highest"==n)&&(r.hasOwnProperty(null!==(C=F.userId)&&void 0!==C?C:0)?(null!==(D=r[null!==(M=F.userId)&&void 0!==M?M:0].mark)&&void 0!==D?D:-1)<=(null!==(q=F.mark)&&void 0!==q?q:-1)&&(r[null!==(U=F.userId)&&void 0!==U?U:0]=F):r[null!==(A=F.userId)&&void 0!==A?A:0]=F)});else{var l=this.commonService.myClone(null!==(i=e[0])&&void 0!==i?i:{});l.resultId=l.testStatus?l.id:0,l.indexTest=0,r[null!==(a=l.userId)&&void 0!==a?a:0]=l}return r}findExamResultOfStudent(e,n){var i=[];return e.forEach(a=>{(a.studentId==n||null==a.studentId)&&i.push(a)}),i}addResultIdToExamResult(e){var n=[];return e.forEach(i=>{var a,r=null!==(a=this.commonService.myClone(i))&&void 0!==a?a:{};r.resultId=r.id,r.testStatus&&n.push(r)}),n}compareLengthWithExamQuestion(e,n){var i=this.commonService.myClone(e);if(n>0&&e.length<n)for(var a=0;a<n-e.length;a++)i.push("");return i}mergeStudentWithAvatar(e){var n=[];return e.forEach(i=>{var a,r,l=n.filter(_=>_.parentId==i.parentId);if(l&&0!=l.length)for(var c=0;c<n.length;c++)n[c].parentId==i.parentId&&(n[c].examResultObjs=null===(a=n[c].examResultObjs)||void 0===a?void 0:a.concat(null!==(r=i.examResultObjs)&&void 0!==r?r:[]));else n.push(i)}),n}createStudentWithResult(e,n,i,a,r,l){var c,_,d;return{id:e.id,userId:e.parentId,studentId:e.id,code:e.code,gender:e.gender,fullName:e.fullName,avatar:e.avatar,birthday:e.birthday,resultId:n.hasOwnProperty("resultId")?n.resultId:0,answers:n.hasOwnProperty("answers")?n.answers:null,rightAnswer:n.hasOwnProperty("rightAnswer")?n.rightAnswer:0,totalQuestion:n.hasOwnProperty("totalQuestion")?n.totalQuestion:0,mark:n.hasOwnProperty("mark")?n.mark:null,trueFalseMark:n.hasOwnProperty("trueFalseMark")?n.trueFalseMark:null,essayMark:n.hasOwnProperty("essayMark")?n.essayMark:null,files:n.hasOwnProperty("files")?n.files:null,infors:n.hasOwnProperty("infors")?n.infors:null,confirmedAt:n.hasOwnProperty("confirmedAt")?n.confirmedAt:null,startedTest:n.hasOwnProperty("startedTest")?n.startedTest:null,createdAt:n.hasOwnProperty("createdAt")?n.createdAt:null,allResultObjs:this.addResultIdToExamResult(null!==(c=e.examResultObjs)&&void 0!==c?c:[]),answeredQuestions:n.hasOwnProperty("answeredQuestions")?n.answeredQuestions:[],groupPoints:this.getGroupPoints(n.answeredQuestions?n.answeredQuestions:[]),classroomIds:[],eventTracks:{},status:i,nameImages:e.nameImages,nameImage:"",answerMixObjs:null!==(d=this.compareLengthWithExamQuestion(null!==(_=n.answerMixObjs)&&void 0!==_?_:[],a))&&void 0!==d?d:[],testedTime:r+1,totalTestTime:l}}getGroupPoints(e){let n=[];return e.forEach(i=>{let a=!1;for(let r=0;r<n.length;r++)n[r].id==i.groupId&&(a=!0,n[r].point+=i.correct&&i.scorePerQuestion?i.scorePerQuestion:0);a||n.push({id:i.groupId,point:i.correct&&i.scorePerQuestion?i.scorePerQuestion:0})}),n.sort((i,a)=>{var r,l;return(null!==(r=i.id)&&void 0!==r?r:0)-(null!==(l=a.id)&&void 0!==l?l:0)}),n}getMaxGroupId(e){let n=0;return e.forEach(i=>{var a;n=null!==(a=i.id)&&void 0!==a?a:0}),n}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(vt.v),t.LFG(Ot.DR),t.LFG(Xe.$),t.LFG(jn.U),t.LFG(Be.z),t.LFG(Qo.n),t.LFG(yn.j))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Uo=b(88974),qn=b(2638),Fo=b(64123),Yi=b(71572),$n=b(13953);function Nh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",7),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.showSelectFileScan())}),t.O4$(),t.TgZ(1,"svg",8),t._UZ(2,"path",9)(3,"circle",10),t.qZA(),t.kcU(),t.TgZ(4,"span"),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.Oqu(t.lcZ(6,1,"lang_auto_cham_file_scan")))}function Dh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",7),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.showSelectFileScan())}),t.O4$(),t.TgZ(1,"svg",8),t._UZ(2,"line",11)(3,"path",12)(4,"path",13)(5,"path",14),t.qZA(),t.kcU(),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()()}2&o&&(t.xp6(7),t.Oqu(t.lcZ(8,1,"lang_auto_huy_cham_file_scan")))}function jh(o,s){if(1&o&&(t.TgZ(0,"div",4)(1,"p",5),t._uU(2),t.qZA(),t.YNc(3,Nh,7,3,"a",6),t.YNc(4,Dh,9,3,"a",6),t.qZA()),2&o){const e=t.oxw();t.xp6(2),t.hij(" ",e.headerTitle," "),t.xp6(1),t.Q6J("ngIf",!e.showFileScan&&!e.isNotTestedYet),t.xp6(1),t.Q6J("ngIf",e.showFileScan)}}function qh(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function Qh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",31)(1,"div",32)(2,"a",33),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.showSelectFileScan())}),t.O4$(),t.TgZ(3,"svg",34),t._UZ(4,"path",9)(5,"circle",10),t.qZA(),t.kcU(),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()()(),t.TgZ(9,"div",35)(10,"a",36),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.showCopySuccess())}),t.O4$(),t.TgZ(11,"svg",34),t._UZ(12,"circle",37)(13,"circle",38)(14,"circle",39)(15,"line",40)(16,"line",41),t.qZA(),t.kcU(),t.TgZ(17,"span"),t._uU(18),t.ALo(19,"mytranslate"),t.qZA()()()()}if(2&o){const e=t.oxw(3);t.xp6(7),t.Oqu(t.lcZ(8,3,"lang_auto_cham_file_scan")),t.xp6(3),t.Q6J("cdkCopyToClipboard",e.copyLinkToClipboard()),t.xp6(8),t.Oqu(t.lcZ(19,5,"lang_auto_copy_link_de_thi"))}}function Uh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",33),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.showSelectFileScan())}),t.O4$(),t.TgZ(1,"svg",34),t._UZ(2,"path",9)(3,"circle",10),t.qZA(),t.kcU(),t.TgZ(4,"span"),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}2&o&&(t.xp6(5),t.Oqu(t.lcZ(6,1,"lang_auto_cham_file_scan")))}function Fh(o,s){1&o&&(t.ynx(0),t.TgZ(1,"p",23),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"p",42),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"div",25)(8,"div",43)(9,"p",44)(10,"span",45),t._uU(11,"Google Play"),t.qZA(),t._UZ(12,"azt-download-qr-code",46),t.qZA(),t.TgZ(13,"p",47)(14,"span",45),t._uU(15,"App Store"),t.qZA(),t._UZ(16,"azt-download-qr-code",46),t.qZA()()(),t.BQk()),2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,6,"lang_auto_hoac")),t.xp6(3),t.hij(" ",t.lcZ(6,8,"lang_auto_su_dung_ma_qr_de_tai_app_Azota")," "),t.xp6(7),t.Q6J("fileName","azota_exam_qrcode_google_app")("linkUrl","https://play.google.com/store/apps/details?id=azt.azt"),t.xp6(4),t.Q6J("fileName","azota_exam_qrcode_app_store")("linkUrl","https://apps.apple.com/ua/app/azota/id1556025594"))}function Rh(o,s){if(1&o&&(t.TgZ(0,"div",17)(1,"div",18)(2,"h3",19),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.TgZ(5,"p",20),t._uU(6),t.ALo(7,"mytranslate"),t.ALo(8,"isOfflineExam"),t.ALo(9,"mytranslate"),t.qZA(),t.YNc(10,Qh,20,7,"div",21),t.ALo(11,"isOfflineExam"),t.YNc(12,Uh,7,3,"ng-template",null,22,t.W1O),t.TgZ(14,"p",23),t._uU(15),t.ALo(16,"mytranslate"),t.qZA(),t.TgZ(17,"p",24),t._uU(18),t.ALo(19,"mytranslate"),t.qZA(),t.TgZ(20,"div",25)(21,"div",26)(22,"a",27),t._UZ(23,"img",28),t.ALo(24,"convertCdn"),t.qZA(),t.TgZ(25,"a",29),t._UZ(26,"img",30),t.ALo(27,"convertCdn"),t.qZA()()(),t.YNc(28,Fh,17,10,"ng-container",16),t.qZA()()),2&o){const e=t.MAs(13),n=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,10,"lang_auto_chua_co_du_lieu_nop_bai")),t.xp6(3),t.AsE(" ",t.lcZ(7,12,"lang_auto_note_scan_file_in_student_exam_result")," ",t.lcZ(8,14,null==n.obj?null:n.obj.orcLogId)?".":t.lcZ(9,16,"lang_auto_or_click_copy_btn")," "),t.xp6(4),t.Q6J("ngIf",!t.lcZ(11,18,null==n.obj?null:n.obj.orcLogId))("ngIfElse",e),t.xp6(5),t.Oqu(t.lcZ(16,20,"lang_auto_hoac")),t.xp6(3),t.hij(" ",t.lcZ(19,22,"lang_auto_tai_app_azota_de_cham_bai_bang_camera_cua_dien_thoai_tai_app_tai_day")," "),t.xp6(5),t.Q6J("src",t.lcZ(24,24,"azota_assets/images/google-play-badge.svg"),t.LSH),t.xp6(3),t.Q6J("src",t.lcZ(27,26,"azota_assets/images/2928664.svg"),t.LSH),t.xp6(2),t.Q6J("ngIf",!n.isMobile)}}function Bh(o,s){if(1&o&&(t.TgZ(0,"span",58),t._uU(1),t.qZA()),2&o){const e=t.oxw(4);t.Q6J("matTooltip",(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.name)+" ("+e.curSelectClassShow.countSubmitted+"/"+(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.countStudents)+")")("matTooltipPosition","above"),t.xp6(1),t.hij(" ",(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.name)+" ("+e.curSelectClassShow.countSubmitted+"/"+(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.countStudents)+")"," ")}}function Jh(o,s){if(1&o&&(t.TgZ(0,"span",58),t.ALo(1,"mytranslate"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()),2&o){const e=t.oxw(4);t.Q6J("matTooltip",t.lcZ(1,3,"lang_auto_tu_do")+" ("+e.studentLists.length+")")("matTooltipPosition","above"),t.xp6(2),t.hij(" ",t.lcZ(3,5,"lang_auto_tu_do")+" ("+e.studentLists.length+")"," ")}}function Hh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",67),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(5);return t.KtG(a.selectClassroomShow(i,!1))}),t.TgZ(2,"span",58),t._uU(3),t.qZA()()()}if(2&o){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("matTooltip",(null==e.classObj?null:e.classObj.name)+" ("+e.countSubmitted+"/"+(null==e.classObj?null:e.classObj.countStudents)+")")("matTooltipPosition","left"),t.xp6(1),t.hij(" ",(null==e.classObj?null:e.classObj.name)+" ("+e.countSubmitted+"/"+(null==e.classObj?null:e.classObj.countStudents)+")"," ")}}function zh(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Hh,4,3,"li",16),t.BQk()),2&o){const e=s.$implicit,n=t.oxw(5);t.xp6(1),t.Q6J("ngIf",(null==n.curSelectClassShow.classObj?null:n.curSelectClassShow.classObj.id)!=(null==e.classObj?null:e.classObj.id))}}function Yh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",67),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(5);return t.KtG(i.selectClassroomShow({},!0))}),t.TgZ(2,"span",58),t.ALo(3,"mytranslate"),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()()()}if(2&o){const e=t.oxw(5);t.xp6(2),t.Q6J("matTooltip",t.lcZ(3,3,"lang_auto_tu_do")+" ("+e.studentLists.length+")")("matTooltipPosition","left"),t.xp6(2),t.hij(" ",t.lcZ(5,5,"lang_auto_tu_do")+" ("+e.studentLists.length+")"," ")}}function Gh(o,s){if(1&o&&(t.TgZ(0,"div",59)(1,"button",60)(2,"span"),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.O4$(),t.TgZ(5,"svg",61),t._UZ(6,"polyline",62),t.qZA()(),t.kcU(),t.TgZ(7,"mat-menu",null,63)(9,"div",64)(10,"ul",65),t.YNc(11,zh,2,1,"ng-container",66),t.YNc(12,Yh,6,7,"li",16),t.qZA()()()()),2&o){const e=t.MAs(8),n=t.oxw(4);t.xp6(1),t.Q6J("matMenuTriggerFor",e),t.xp6(2),t.Oqu(t.lcZ(4,4,"lang_auto_xem_them")),t.xp6(8),t.Q6J("ngForOf",n.studentListsInClass),t.xp6(1),t.Q6J("ngIf",n.studentLists.length>0&&-1!=(null==n.curSelectClassShow.classObj?null:n.curSelectClassShow.classObj.id))}}const kn=function(o){return{"col-span-2":o}};function $h(o,s){if(1&o&&(t.TgZ(0,"div",53)(1,"div",54)(2,"button",55),t.YNc(3,Bh,2,3,"span",56),t.YNc(4,Jh,4,7,"span",56),t.qZA()(),t.YNc(5,Gh,13,6,"div",57),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("ngClass",t.VKq(4,kn,e.isOpenSideNav)),t.xp6(2),t.Q6J("ngIf",-1!=(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.id)),t.xp6(1),t.Q6J("ngIf",e.studentLists.length>0&&-1==(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.id)),t.xp6(1),t.Q6J("ngIf",e.studentListsInClass.length>1||1==e.studentListsInClass.length&&e.studentLists&&e.studentLists.length>0)}}const Wn=function(o){return{active:o}};function Wh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",54)(1,"button",71),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(5);return t.KtG(i.selectClassroomShow(i.studentListsInClass[0],!1))}),t.TgZ(2,"span",58),t._uU(3),t.qZA()()()}if(2&o){const e=t.oxw(5);t.Q6J("ngClass",t.VKq(5,kn,e.isOpenSideNav)),t.xp6(1),t.Q6J("ngClass",t.VKq(7,Wn,(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.id)==(null==e.studentListsInClass[0].classObj?null:e.studentListsInClass[0].classObj.id))),t.xp6(1),t.Q6J("matTooltip",(null==e.studentListsInClass[0].classObj?null:e.studentListsInClass[0].classObj.name)+" ("+e.studentListsInClass[0].countSubmitted+"/"+(null==e.studentListsInClass[0].classObj?null:e.studentListsInClass[0].classObj.countStudents)+")")("matTooltipPosition","above"),t.xp6(1),t.hij(" ",(null==e.studentListsInClass[0].classObj?null:e.studentListsInClass[0].classObj.name)+" ("+e.studentListsInClass[0].countSubmitted+"/"+(null==e.studentListsInClass[0].classObj?null:e.studentListsInClass[0].classObj.countStudents)+")"," ")}}function Kh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",54)(1,"button",71),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(5);return t.KtG(i.selectClassroomShow(i.studentListsInClass[1],!1))}),t.TgZ(2,"span",58),t._uU(3),t.qZA()()()}if(2&o){const e=t.oxw(5);t.Q6J("ngClass",t.VKq(5,kn,e.isOpenSideNav)),t.xp6(1),t.Q6J("ngClass",t.VKq(7,Wn,(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.id)==(null==e.studentListsInClass[1].classObj?null:e.studentListsInClass[1].classObj.id))),t.xp6(1),t.Q6J("matTooltip",(null==e.studentListsInClass[1].classObj?null:e.studentListsInClass[1].classObj.name)+" ("+e.studentListsInClass[1].countSubmitted+"/"+(null==e.studentListsInClass[1].classObj?null:e.studentListsInClass[1].classObj.countStudents)+")")("matTooltipPosition","above"),t.xp6(1),t.hij(" ",(null==e.studentListsInClass[1].classObj?null:e.studentListsInClass[1].classObj.name)+" ("+e.studentListsInClass[1].countSubmitted+"/"+(null==e.studentListsInClass[1].classObj?null:e.studentListsInClass[1].classObj.countStudents)+")"," ")}}function Vh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",54)(1,"button",71),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(5);return t.KtG(i.selectClassroomShow({},!0))}),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()()()}if(2&o){const e=t.oxw(5);t.Q6J("ngClass",t.VKq(5,kn,e.isOpenSideNav)),t.xp6(1),t.Q6J("ngClass",t.VKq(7,Wn,!(null!=e.curSelectClassShow.classObj&&e.curSelectClassShow.classObj.id)||-1==(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.id))),t.xp6(2),t.hij(" ",t.lcZ(4,3,"lang_auto_tu_do")+" ("+e.studentLists.length+")"," ")}}function Xh(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",67),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(6);return t.KtG(a.selectClassroomShow(i,!1))}),t.TgZ(2,"span",58),t._uU(3),t.qZA()()()}if(2&o){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("matTooltip",(null==e.classObj?null:e.classObj.name)+" ("+e.countSubmitted+"/"+(null==e.classObj?null:e.classObj.countStudents)+")")("matTooltipPosition","left"),t.xp6(1),t.hij(" ",(null==e.classObj?null:e.classObj.name)+" ("+e.countSubmitted+"/"+(null==e.classObj?null:e.classObj.countStudents)+")"," ")}}function tp(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Xh,4,3,"li",16),t.BQk()),2&o){const e=s.index;t.xp6(1),t.Q6J("ngIf",e>1)}}function ep(o,s){if(1&o&&(t.TgZ(0,"div",72)(1,"button",60)(2,"span"),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.O4$(),t.TgZ(5,"svg",61),t._UZ(6,"polyline",62),t.qZA()(),t.kcU(),t.TgZ(7,"mat-menu",null,63)(9,"div",64)(10,"ul",65),t.YNc(11,tp,2,1,"ng-container",66),t.qZA()()()()),2&o){const e=t.MAs(8),n=t.oxw(5);t.xp6(1),t.Q6J("matMenuTriggerFor",e),t.xp6(2),t.Oqu(t.lcZ(4,3,"lang_auto_xem_them")),t.xp6(8),t.Q6J("ngForOf",n.studentListsInClass)}}function np(o,s){if(1&o&&(t.TgZ(0,"div",53),t.YNc(1,Wh,4,9,"div",69),t.YNc(2,Kh,4,9,"div",69),t.YNc(3,Vh,5,9,"div",69),t.YNc(4,ep,12,5,"div",70),t.qZA()),2&o){const e=t.oxw(4);t.xp6(1),t.Q6J("ngIf",e.studentListsInClass.length>0),t.xp6(1),t.Q6J("ngIf",e.studentListsInClass.length>1),t.xp6(1),t.Q6J("ngIf",e.studentLists&&e.studentLists.length>0),t.xp6(1),t.Q6J("ngIf",e.studentListsInClass.length>2)}}function ip(o,s){if(1&o&&(t.TgZ(0,"div",54)(1,"button",55)(2,"span",58),t._uU(3),t.qZA()()()),2&o){const e=t.oxw(5);t.Q6J("ngClass",t.VKq(4,kn,e.isOpenSideNav)),t.xp6(2),t.Q6J("matTooltip",(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.name)+" ("+e.curSelectClassShow.countSubmitted+"/"+(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.countStudents)+")")("matTooltipPosition","above"),t.xp6(1),t.hij(" ",(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.name)+" ("+e.curSelectClassShow.countSubmitted+"/"+(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.countStudents)+")"," ")}}function op(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",54)(1,"button",71),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(5);return t.KtG(i.selectClassroomShow(i.studentListsInClass[0],!1))}),t.TgZ(2,"span",58),t._uU(3),t.qZA()()()}if(2&o){const e=t.oxw(5);t.Q6J("ngClass",t.VKq(5,kn,e.isOpenSideNav)),t.xp6(1),t.Q6J("ngClass",t.VKq(7,Wn,(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.id)==(null==e.studentListsInClass[0].classObj?null:e.studentListsInClass[0].classObj.id))),t.xp6(1),t.Q6J("matTooltip",(null==e.studentListsInClass[0].classObj?null:e.studentListsInClass[0].classObj.name)+" ("+e.studentListsInClass[0].countSubmitted+"/"+(null==e.studentListsInClass[0].classObj?null:e.studentListsInClass[0].classObj.countStudents)+")")("matTooltipPosition","above"),t.xp6(1),t.hij(" ",(null==e.studentListsInClass[0].classObj?null:e.studentListsInClass[0].classObj.name)+" ("+e.studentListsInClass[0].countSubmitted+"/"+(null==e.studentListsInClass[0].classObj?null:e.studentListsInClass[0].classObj.countStudents)+")"," ")}}function ap(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",54)(1,"button",71),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(5);return t.KtG(i.selectClassroomShow({},!0))}),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()()()}if(2&o){const e=t.oxw(5);t.Q6J("ngClass",t.VKq(5,kn,e.isOpenSideNav)),t.xp6(1),t.Q6J("ngClass",t.VKq(7,Wn,!(null!=e.curSelectClassShow.classObj&&e.curSelectClassShow.classObj.id)||-1==(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.id))),t.xp6(2),t.hij(" ",t.lcZ(4,3,"lang_auto_tu_do")+" ("+e.studentLists.length+")"," ")}}function sp(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",67),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(6);return t.KtG(a.selectClassroomShow(i,!1))}),t.TgZ(2,"span",58),t._uU(3),t.qZA()()()}if(2&o){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("matTooltip",(null==e.classObj?null:e.classObj.name)+" ("+e.countSubmitted+"/"+(null==e.classObj?null:e.classObj.countStudents)+")")("matTooltipPosition","left"),t.xp6(1),t.hij(" ",(null==e.classObj?null:e.classObj.name)+" ("+e.countSubmitted+"/"+(null==e.classObj?null:e.classObj.countStudents)+")"," ")}}function rp(o,s){if(1&o&&(t.ynx(0),t.YNc(1,sp,4,3,"li",16),t.BQk()),2&o){const e=s.$implicit,n=s.index,i=t.oxw(6);t.xp6(1),t.Q6J("ngIf",n>0&&(null==i.curSelectClassShow.classObj?null:i.curSelectClassShow.classObj.id)!=(null==e.classObj?null:e.classObj.id)&&(null==i.curSelectClassShow.classObj?null:i.curSelectClassShow.classObj.id))}}function lp(o,s){if(1&o&&(t.TgZ(0,"div",74)(1,"button",60)(2,"span"),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.O4$(),t.TgZ(5,"svg",61),t._UZ(6,"polyline",62),t.qZA()(),t.kcU(),t.TgZ(7,"mat-menu",null,63)(9,"div",64)(10,"ul",65),t.YNc(11,rp,2,1,"ng-container",66),t.qZA()()()()),2&o){const e=t.MAs(8),n=t.oxw(5);t.xp6(1),t.Q6J("matMenuTriggerFor",e),t.xp6(2),t.Oqu(t.lcZ(4,3,"lang_auto_xem_them")),t.xp6(8),t.Q6J("ngForOf",n.studentListsInClass)}}function cp(o,s){if(1&o&&(t.TgZ(0,"div",53),t.YNc(1,ip,4,6,"div",69),t.YNc(2,op,4,9,"div",69),t.YNc(3,ap,5,9,"div",69),t.YNc(4,lp,12,5,"div",73),t.qZA()),2&o){const e=t.oxw(4);t.xp6(1),t.Q6J("ngIf",-1!=(null==e.curSelectClassShow.classObj?null:e.curSelectClassShow.classObj.id)),t.xp6(1),t.Q6J("ngIf",e.studentListsInClass.length>0),t.xp6(1),t.Q6J("ngIf",e.studentLists&&e.studentLists.length>0),t.xp6(1),t.Q6J("ngIf",e.studentListsInClass.length>2)}}function _p(o,s){if(1&o&&(t.YNc(0,np,5,4,"div",48),t.YNc(1,cp,5,4,"ng-template",null,68,t.W1O)),2&o){const e=t.MAs(2),n=t.oxw(3);t.Q6J("ngIf",n.curSelectClassShow==n.studentListsInClass[0]||n.curSelectClassShow==n.studentListsInClass[1]||-1==(null==n.curSelectClassShow.classObj?null:n.curSelectClassShow.classObj.id))("ngIfElse",e)}}function dp(o,s){1&o&&(t.TgZ(0,"span",102),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_dang_thi_brackets")," "))}function up(o,s){1&o&&(t.TgZ(0,"span",103),t.ALo(1,"mytranslate"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()),2&o&&(t.s9C("matTooltip",t.lcZ(1,2,"lang_auto_hoc_sinh_nay_da_thoat_ra_khoi_man_hinh_thi_khi_chua_het_gio_ma_khong_an_nut_nop_bai_giao_vien_yeu_cau_hoc_sinh_quay_lai_bai_thi_de_an_nut_xac_nhan_nop_muon_sau_do_phuc_khao_de_ghi_nhan_ket_qua_bai_thi")),t.xp6(2),t.hij(" ",t.lcZ(3,4,"lang_auto_chua_nop_bai_brackets")," "))}function mp(o,s){1&o&&(t.TgZ(0,"span",104),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_chua_cham")))}function hp(o,s){1&o&&(t.TgZ(0,"span",105),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_dang_thi")))}function pp(o,s){1&o&&(t.TgZ(0,"span",106),t.ALo(1,"mytranslate"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()),2&o&&(t.s9C("matTooltip",t.lcZ(1,2,"lang_auto_hoc_sinh_nay_da_thoat_ra_khoi_man_hinh_thi_khi_chua_het_gio_ma_khong_an_nut_nop_bai_giao_vien_yeu_cau_hoc_sinh_quay_lai_bai_thi_de_an_nut_xac_nhan_nop_muon_sau_do_phuc_khao_de_ghi_nhan_ket_qua_bai_thi")),t.xp6(2),t.hij(" ",t.lcZ(3,4,"lang_auto_chua_nop_bai")," "))}function gp(o,s){1&o&&(t.TgZ(0,"span",107),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_chua_thi"),""))}function fp(o,s){1&o&&(t.TgZ(0,"span",107),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_point")+": "," "))}function xp(o,s){if(1&o&&(t.TgZ(0,"span",108),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit;let n;t.xp6(1),t.hij(" ",null!==(n=e.mark)&&void 0!==n?n:0," ")}}function vp(o,s){if(1&o&&(t.TgZ(0,"div",100),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw(2).$implicit,n=t.oxw(4);t.xp6(1),t.hij(" ",n.calculationTime(e.createdAt||void 0)+" "+t.lcZ(2,1,"lang_auto_truoc")," ")}}function bp(o,s){1&o&&(t.TgZ(0,"div",109),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_thoi_gian_lam_bai")+":"," "))}function wp(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit,n=t.oxw(4);t.xp6(1),t.hij(" ",n.calculationTestedTime(e.startedTest||void 0,e.createdAt||void 0)," ")}}function Tp(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit,n=t.oxw(4);t.xp6(1),t.hij(" ",n.calculationTestedTime(e.startedTest||void 0)," ")}}function Cp(o,s){1&o&&(t.TgZ(0,"p",113),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_so_tep_tin_da_nop")+":"," "))}function Ap(o,s){if(1&o&&(t.TgZ(0,"p",114),t._uU(1),t.qZA()),2&o){const e=t.oxw(3).$implicit;let n;t.xp6(1),t.hij(" ",null!==(n=null==e.filesParse?null:e.filesParse.length)&&void 0!==n?n:0," ")}}function yp(o,s){if(1&o&&(t.TgZ(0,"div",110),t.YNc(1,Cp,3,3,"p",111),t.YNc(2,Ap,2,1,"p",112),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf",e.isMarked||e.isNotMarked),t.xp6(1),t.Q6J("ngIf",e.isMarked||e.isNotMarked)}}const Ro=function(o){return[o]};function kp(o,s){if(1&o&&(t.TgZ(0,"a",85),t.ALo(1,"mylocalize"),t.TgZ(2,"div",86)(3,"span",87,88),t._uU(5),t.qZA(),t.YNc(6,dp,3,3,"span",89),t.YNc(7,up,4,6,"span",90),t.qZA(),t.TgZ(8,"div",91)(9,"div",92),t.YNc(10,mp,3,3,"span",93),t.YNc(11,hp,3,3,"span",94),t.YNc(12,pp,4,6,"span",95),t.YNc(13,gp,3,3,"span",96),t.YNc(14,fp,3,3,"span",96),t.YNc(15,xp,2,1,"span",97),t.qZA(),t.YNc(16,vp,3,3,"div",98),t.qZA(),t.TgZ(17,"div",91),t.YNc(18,bp,3,3,"div",99),t.TgZ(19,"div",100),t.YNc(20,wp,2,1,"span",16),t.YNc(21,Tp,2,1,"span",16),t.qZA()(),t.YNc(22,yp,3,2,"div",101),t.qZA()),2&o){const e=t.MAs(4),n=t.oxw().$implicit,i=t.oxw(4);t.Q6J("href",t.VKq(20,Ro,t.lcZ(1,18,"/admin/testbank/test-review/"+i.obj.id+"/"+n.userId+"/"+n.studentId+"/"+n.resultId+(i.backToLink?"?backto="+i.backToLink:""))),t.LSH),t.xp6(3),t.s9C("matTooltip",n.fullName),t.Q6J("isDisabledTooltip",!1)("matTooltipDisabled",e.isDisabled),t.xp6(2),t.hij(" ",n.fullName," "),t.xp6(1),t.Q6J("ngIf",0==n.status&&(n.isMarked||n.isNotMarked)),t.xp6(1),t.Q6J("ngIf",-1==n.status&&(n.isMarked||n.isNotMarked)),t.xp6(3),t.Q6J("ngIf",n.isNotMarked),t.xp6(1),t.Q6J("ngIf",n.isOnTest),t.xp6(1),t.Q6J("ngIf",n.isNotSubmit),t.xp6(1),t.Q6J("ngIf",n.isNotTested),t.xp6(1),t.Q6J("ngIf",n.isMarked),t.xp6(1),t.Q6J("ngIf",n.isMarked),t.xp6(1),t.Q6J("ngIf",n.isMarked||n.isNotMarked),t.xp6(2),t.Q6J("ngIf",!n.isNotTested),t.xp6(2),t.Q6J("ngIf",n.isMarked||n.isNotMarked),t.xp6(1),t.Q6J("ngIf",n.isOnTest||n.isNotSubmit),t.xp6(1),t.Q6J("ngIf",i.hasEssayQuestion)}}function Op(o,s){1&o&&(t.TgZ(0,"span",119),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_dang_thi_brackets")," "))}function Sp(o,s){1&o&&(t.TgZ(0,"span",120),t.ALo(1,"mytranslate"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()),2&o&&(t.s9C("matTooltip",t.lcZ(1,2,"lang_auto_hoc_sinh_nay_da_thoat_ra_khoi_man_hinh_thi_khi_chua_het_gio_ma_khong_an_nut_nop_bai_giao_vien_yeu_cau_hoc_sinh_quay_lai_bai_thi_de_an_nut_xac_nhan_nop_muon_sau_do_phuc_khao_de_ghi_nhan_ket_qua_bai_thi")),t.xp6(2),t.hij(" ",t.lcZ(3,4,"lang_auto_chua_nop_bai_brackets")," "))}function Ep(o,s){1&o&&(t.TgZ(0,"span",104),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_chua_cham")))}function Ip(o,s){1&o&&(t.TgZ(0,"span",105),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_dang_thi")))}function Zp(o,s){1&o&&(t.TgZ(0,"span",106),t.ALo(1,"mytranslate"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()),2&o&&(t.s9C("matTooltip",t.lcZ(1,2,"lang_auto_hoc_sinh_nay_da_thoat_ra_khoi_man_hinh_thi_khi_chua_het_gio_ma_khong_an_nut_nop_bai_giao_vien_yeu_cau_hoc_sinh_quay_lai_bai_thi_de_an_nut_xac_nhan_nop_muon_sau_do_phuc_khao_de_ghi_nhan_ket_qua_bai_thi")),t.xp6(2),t.hij(" ",t.lcZ(3,4,"lang_auto_chua_nop_bai")," "))}function Mp(o,s){1&o&&(t.TgZ(0,"span",107),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_chua_thi"),""))}function Pp(o,s){1&o&&(t.TgZ(0,"span",107),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_point")+": "," "))}function Lp(o,s){if(1&o&&(t.TgZ(0,"span",108),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit;let n;t.xp6(1),t.hij(" ",null!==(n=e.mark)&&void 0!==n?n:0," ")}}function Np(o,s){if(1&o&&(t.TgZ(0,"div",100),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw(2).$implicit,n=t.oxw(4);t.xp6(1),t.hij(" ",n.calculationTime(e.createdAt||void 0)+" "+t.lcZ(2,1,"lang_auto_truoc")," ")}}function Dp(o,s){1&o&&(t.TgZ(0,"div",109),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_thoi_gian_lam_bai")+":"," "))}function jp(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit,n=t.oxw(4);t.xp6(1),t.hij(" ",n.calculationTestedTime(e.startedTest||void 0,e.createdAt||void 0)," ")}}function qp(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit,n=t.oxw(4);t.xp6(1),t.hij(" ",n.calculationTestedTime(e.startedTest||void 0)," ")}}function Qp(o,s){1&o&&(t.TgZ(0,"p",113),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_so_tep_tin_da_nop")+":"," "))}function Up(o,s){if(1&o&&(t.TgZ(0,"p",122),t._uU(1),t.qZA()),2&o){const e=t.oxw(3).$implicit;let n;t.xp6(1),t.hij(" ",null!==(n=null==e.filesParse?null:e.filesParse.length)&&void 0!==n?n:0," ")}}function Fp(o,s){if(1&o&&(t.TgZ(0,"div",110),t.YNc(1,Qp,3,3,"p",111),t.YNc(2,Up,2,1,"p",121),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf",e.isMarked||e.isNotMarked),t.xp6(1),t.Q6J("ngIf",e.isMarked||e.isNotMarked)}}function Rp(o,s){if(1&o&&(t.TgZ(0,"div",4)(1,"span",115,88),t._uU(3),t.qZA(),t.YNc(4,Op,3,3,"span",116),t.YNc(5,Sp,4,6,"span",117),t.qZA(),t.TgZ(6,"div",118)(7,"div",92),t.YNc(8,Ep,3,3,"span",93),t.YNc(9,Ip,3,3,"span",94),t.YNc(10,Zp,4,6,"span",95),t.YNc(11,Mp,3,3,"span",96),t.YNc(12,Pp,3,3,"span",96),t.YNc(13,Lp,2,1,"span",97),t.qZA(),t.YNc(14,Np,3,3,"div",98),t.qZA(),t.TgZ(15,"div",118),t.YNc(16,Dp,3,3,"div",99),t.TgZ(17,"div",100),t.YNc(18,jp,2,1,"span",16),t.YNc(19,qp,2,1,"span",16),t.qZA()(),t.YNc(20,Fp,3,2,"div",101)),2&o){const e=t.MAs(2),n=t.oxw().$implicit,i=t.oxw(4);t.xp6(1),t.s9C("matTooltip",n.fullName),t.Q6J("isDisabledTooltip",!1)("matTooltipDisabled",e.isDisabled),t.xp6(2),t.hij(" ",n.fullName," "),t.xp6(1),t.Q6J("ngIf",0==n.status&&(n.isMarked||n.isNotMarked)),t.xp6(1),t.Q6J("ngIf",-1==n.status&&(n.isMarked||n.isNotMarked)),t.xp6(3),t.Q6J("ngIf",n.isNotMarked),t.xp6(1),t.Q6J("ngIf",n.isOnTest),t.xp6(1),t.Q6J("ngIf",n.isNotSubmit),t.xp6(1),t.Q6J("ngIf",n.isNotTested),t.xp6(1),t.Q6J("ngIf",n.isMarked),t.xp6(1),t.Q6J("ngIf",n.isMarked),t.xp6(1),t.Q6J("ngIf",n.isMarked||n.isNotMarked),t.xp6(2),t.Q6J("ngIf",!n.isNotTested),t.xp6(2),t.Q6J("ngIf",n.isMarked||n.isNotMarked),t.xp6(1),t.Q6J("ngIf",n.isOnTest||n.isNotSubmit),t.xp6(1),t.Q6J("ngIf",i.hasEssayQuestion)}}const Bo=function(o){return{"md:col-span-3":o}},Bp=function(o){return{"zoom-in":o}};function Jp(o,s){if(1&o&&(t.TgZ(0,"div",78)(1,"div",79)(2,"div",80),t._UZ(3,"azt-create-avatar",81),t.qZA(),t.TgZ(4,"div",82),t.YNc(5,kp,23,22,"a",83),t.YNc(6,Rp,21,17,"ng-template",null,84,t.W1O),t.qZA()()()),2&o){const e=s.$implicit,n=t.MAs(7),i=t.oxw(4);t.Q6J("ngClass",t.VKq(7,Bo,!i.isOpenSideNav&&!i.isMobile)),t.xp6(1),t.Q6J("ngClass",t.VKq(9,Bp,e.resultId)),t.xp6(2),t.Q6J("linkAvatar",(null==e?null:e.avatar)||"")("nameCreateAvatar",e.fullName)("size",40),t.xp6(2),t.Q6J("ngIf",e.resultId)("ngIfElse",n)}}function Hp(o,s){if(1&o&&(t.TgZ(0,"div",75)(1,"div",76),t.YNc(2,Jp,8,11,"div",77),t.qZA()()),2&o){const e=t.oxw(3);t.xp6(2),t.Q6J("ngForOf",e.curSelectClassShow.results)}}function zp(o,s){1&o&&(t.TgZ(0,"span",119),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_dang_thi_brackets")," "))}function Yp(o,s){1&o&&(t.TgZ(0,"span",120),t.ALo(1,"mytranslate"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()),2&o&&(t.s9C("matTooltip",t.lcZ(1,2,"lang_auto_hoc_sinh_nay_da_thoat_ra_khoi_man_hinh_thi_khi_chua_het_gio_ma_khong_an_nut_nop_bai_giao_vien_yeu_cau_hoc_sinh_quay_lai_bai_thi_de_an_nut_xac_nhan_nop_muon_sau_do_phuc_khao_de_ghi_nhan_ket_qua_bai_thi")),t.xp6(2),t.hij(" ",t.lcZ(3,4,"lang_auto_chua_nop_bai_brackets")," "))}function Gp(o,s){if(1&o&&(t.TgZ(0,"div",132)(1,"span",133,88),t._uU(3),t.qZA(),t.YNc(4,zp,3,3,"span",116),t.YNc(5,Yp,4,6,"span",117),t.qZA()),2&o){const e=t.MAs(2),n=t.oxw().$implicit;t.xp6(1),t.s9C("matTooltip",n.fullName),t.Q6J("isDisabledTooltip",!1)("matTooltipDisabled",e.isDisabled),t.xp6(2),t.hij(" ",n.fullName," "),t.xp6(1),t.Q6J("ngIf",0==n.status&&(n.isMarked||n.isNotMarked)),t.xp6(1),t.Q6J("ngIf",-1==n.status&&(n.isMarked||n.isNotMarked))}}function $p(o,s){if(1&o&&t._UZ(0,"img",134),2&o){const e=t.oxw().$implicit;t.Q6J("nameImages",e.nameImages)}}function Wp(o,s){1&o&&(t.TgZ(0,"span",104),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_chua_cham")))}function Kp(o,s){1&o&&(t.TgZ(0,"span",105),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_dang_thi")))}function Vp(o,s){1&o&&(t.TgZ(0,"span",106),t.ALo(1,"mytranslate"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()),2&o&&(t.s9C("matTooltip",t.lcZ(1,2,"lang_auto_hoc_sinh_nay_da_thoat_ra_khoi_man_hinh_thi_khi_chua_het_gio_ma_khong_an_nut_nop_bai_giao_vien_yeu_cau_hoc_sinh_quay_lai_bai_thi_de_an_nut_xac_nhan_nop_muon_sau_do_phuc_khao_de_ghi_nhan_ket_qua_bai_thi")),t.xp6(2),t.hij(" ",t.lcZ(3,4,"lang_auto_chua_nop_bai")," "))}function Xp(o,s){1&o&&(t.TgZ(0,"span",107),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_chua_thi"),""))}function tg(o,s){1&o&&(t.TgZ(0,"span",107),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_point")+": "," "))}function eg(o,s){if(1&o&&(t.TgZ(0,"span",108),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;let n;t.xp6(1),t.hij(" ",null!==(n=e.mark)&&void 0!==n?n:0," ")}}function ng(o,s){if(1&o&&(t.TgZ(0,"div",131),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(4);t.xp6(1),t.hij(" ",n.calculationTime(e.createdAt||void 0)+" "+t.lcZ(2,1,"lang_auto_truoc")," ")}}function ig(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(4);t.xp6(1),t.hij(" ",n.calculationTestedTime(e.startedTest||void 0,e.createdAt||void 0)," ")}}function og(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(4);t.xp6(1),t.hij(" ",n.calculationTestedTime(e.startedTest||void 0)," ")}}function ag(o,s){1&o&&(t.TgZ(0,"p",113),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_so_tep_tin_da_nop")+":"," "))}function sg(o,s){if(1&o&&(t.TgZ(0,"p",136),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit;let n;t.xp6(1),t.hij(" ",null!==(n=null==e.filesParse?null:e.filesParse.length)&&void 0!==n?n:0," ")}}function rg(o,s){if(1&o&&(t.TgZ(0,"div",110),t.YNc(1,ag,3,3,"p",111),t.YNc(2,sg,2,1,"p",135),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.isMarked||e.isNotMarked),t.xp6(1),t.Q6J("ngIf",e.isMarked||e.isNotMarked)}}const lg=function(o){return{backto:o}};function cg(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",78)(1,"div",125)(2,"div",80),t._UZ(3,"azt-create-avatar",81),t.qZA(),t.TgZ(4,"div",82)(5,"div",126),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(4);return t.KtG(r.goToResultReview(a))}),t.TgZ(6,"a",127),t.ALo(7,"mylocalize"),t.YNc(8,Gp,6,6,"div",128),t.YNc(9,$p,1,1,"img",129),t.TgZ(10,"div",91)(11,"div",92),t.YNc(12,Wp,3,3,"span",93),t.YNc(13,Kp,3,3,"span",94),t.YNc(14,Vp,4,6,"span",95),t.YNc(15,Xp,3,3,"span",96),t.YNc(16,tg,3,3,"span",96),t.YNc(17,eg,2,1,"span",97),t.qZA(),t.YNc(18,ng,3,3,"div",130),t.qZA(),t.TgZ(19,"div",118)(20,"div",109),t._uU(21),t.ALo(22,"mytranslate"),t.qZA(),t.TgZ(23,"div",131),t.YNc(24,ig,2,1,"span",16),t.YNc(25,og,2,1,"span",16),t.qZA()(),t.YNc(26,rg,3,2,"div",101),t.qZA()()()()()}if(2&o){const e=s.$implicit,n=t.oxw(4);let i,a;t.Q6J("ngClass",t.VKq(23,Bo,!n.isOpenSideNav&&!n.isMobile)),t.xp6(3),t.Q6J("linkAvatar",(null==e?null:e.avatar)||"")("nameCreateAvatar",e.fullName)("size",40),t.xp6(3),t.Q6J("routerLink",t.VKq(25,Ro,t.lcZ(7,19,"/admin/testbank/test-review/"+n.obj.id+"/"+e.userId+"/"+e.studentId+"/"+e.resultId)))("queryParams",t.VKq(27,lg,n.backToLink)),t.xp6(2),t.Q6J("ngIf",!e.nameImages||(null!==(i=e.studentId)&&void 0!==i?i:0)>0),t.xp6(1),t.Q6J("ngIf",e.nameImages&&(null!==(a=e.studentId)&&void 0!==a?a:0)<=0),t.xp6(3),t.Q6J("ngIf",e.isNotMarked),t.xp6(1),t.Q6J("ngIf",e.isOnTest),t.xp6(1),t.Q6J("ngIf",e.isNotSubmit),t.xp6(1),t.Q6J("ngIf",e.isNotTested),t.xp6(1),t.Q6J("ngIf",e.isMarked),t.xp6(1),t.Q6J("ngIf",e.isMarked),t.xp6(1),t.Q6J("ngIf",e.isMarked||e.isNotMarked),t.xp6(3),t.hij(" ",t.lcZ(22,21,"lang_auto_thoi_gian_lam_bai")+":"," "),t.xp6(3),t.Q6J("ngIf",e.isMarked||e.isNotMarked),t.xp6(1),t.Q6J("ngIf",e.isOnTest||e.isNotSubmit),t.xp6(1),t.Q6J("ngIf",n.hasEssayQuestion)}}function _g(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",137)(1,"azt-paging",138),t.NdJ("SendPage",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.clickPage(i))}),t.qZA()()}if(2&o){const e=t.oxw(4);t.xp6(1),t.Q6J("lengthPage",e.totalPage)("paging",e.curPage)}}function dg(o,s){if(1&o&&(t.TgZ(0,"div",75)(1,"div",76),t.YNc(2,cg,27,29,"div",77),t.TgZ(3,"div",123),t.YNc(4,_g,2,2,"div",124),t.qZA()()()),2&o){const e=t.oxw(3);t.xp6(2),t.Q6J("ngForOf",e.studentListPage),t.xp6(2),t.Q6J("ngIf",e.totalPage>1)}}const ug=function(){return{suppressScrollX:!0}};function mg(o,s){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,$h,6,6,"div",48),t.YNc(2,_p,3,2,"ng-template",null,49,t.W1O),t.TgZ(4,"div",50)(5,"perfect-scrollbar",51),t.YNc(6,Hp,3,1,"div",52),t.YNc(7,dg,5,2,"div",52),t.qZA()()()),2&o){const e=t.MAs(3),n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",n.isMobile)("ngIfElse",e),t.xp6(4),t.Q6J("config",t.DdM(6,ug))("scrollIndicators",!0),t.xp6(1),t.Q6J("ngIf",-1!=(null==n.curSelectClassShow.classObj?null:n.curSelectClassShow.classObj.id)),t.xp6(1),t.Q6J("ngIf",-1==(null==n.curSelectClassShow.classObj?null:n.curSelectClassShow.classObj.id))}}function hg(o,s){if(1&o&&(t.YNc(0,Rh,29,28,"div",15),t.YNc(1,mg,8,7,"div",16)),2&o){const e=t.oxw();t.Q6J("ngIf",e.isNotTestedYet),t.xp6(1),t.Q6J("ngIf",!e.isNotTestedYet&&e.obj)}}const pg=function(o){return{"py-2":o}},gg=["*"];let fg=(()=>{class o extends mt.Q{constructor(e,n,i,a,r){super(e),this.commonService=e,this.permissionService=n,this.timeService=i,this.sortService=a,this.browserStorageService=r,this.isSortByMark=!1,this.isSortByTime=!1,this.isSortByName=!1,this.backToLink="",this.studentLists=[],this.studentListsInClass=[],this.examHasClass=!1,this.isNotTestedYet=!1,this.isOpenSideNav=!0,this.hasEssayQuestion=!1,this.totalSubmitByClass=0,this.showFileScan=!1,this.obj=void 0,this.isMobile=!1,this.scanLoading=!1,this.mustShownResultId=0,this.headerTitle="",this.goToResult=new t.vpe,this.notTestedOpenFileScan=new t.vpe,this.saveStudentMarkEmitFromComponent=new t.vpe,this.curSelectClassShow={},this.studentListPage=[],this.isLoadingPage=!1,this.checkPaging=!1,this.curPage=1,this.totalPage=0,this.tabIndex=0}scanMarkObjs(e){e&&this.saveStudentMarkEmitFromComponent.emit(!0)}showSelectFileScan(){this.showFileScan=!this.showFileScan,this.notTestedOpenFileScan.emit(this.showFileScan)}goToResultReview(e){this.checkExecuteViewTest()||this.goToResult.emit(e)}clickPage(e){this.createPageStudent(e)}checkExecuteViewTest(){var e;return this.permissionService.hasConfigAndViewClassroomPermission("exam",null===(e=this.obj)||void 0===e?void 0:e.permissionObj)}createPageStudent(e){this.studentListPage=[];let n=100;if(this.studentLists){let i=this.studentLists.length;if(this.totalPage=Math.ceil(i/n),i>n)for(let a=(e-1)*n;a<e*n;a++)this.studentLists.length-1>=a&&this.studentListPage.push(this.studentLists[a]);else this.checkPaging=!1,this.studentListPage=this.studentLists;this.isLoadingPage=!1}}copyLinkToClipboard(){var e;return`${this.commonService.getCurrentDomain()}/de-thi/${null===(e=this.obj)||void 0===e?void 0:e.hashId}`}showCopySuccess(){this.showSuccessSnack("lang_auto_sao_chep_thanh_cong")}calculationTime(e,n){return this.timeService.calculationTime(e,n)}calculationTestedTime(e,n){return this.timeService.calculationTestedTime(e,n)}goToStudentList(e){this.commonService.myNavigation("/admin/student/class-details/"+e)}checkSortListStudent(){var e,n,i,a;for(let r=0;r<this.studentListsInClass.length;r++)this.studentListsInClass[r].results=1==(null===(n=null===(e=this.studentListsInClass[r])||void 0===e?void 0:e.classObj)||void 0===n?void 0:n.sortType)?this.sortService.sortArrayByMultipleObjectKeyAsc(null!==(i=this.commonService.myClone(this.studentListsInClass[r].results))&&void 0!==i?i:[],"pos","id"):this.sortService.sortFirstNameStudents(null!==(a=this.commonService.myClone(this.studentListsInClass[r].results))&&void 0!==a?a:[])}checkAnonymousStudent(e){return!0}selectClassroomShow(e,n){var i;this.curSelectClassShow=n?{classObj:{id:-1},results:this.studentLists}:e,this.browserStorageService.saveSimpleSessionStorage("exam_results_shown_class_"+(null===(i=this.obj)||void 0===i?void 0:i.hashId),JSON.stringify(this.curSelectClassShow))}SelectedTabChange(e){var n;this.browserStorageService.saveSimpleStorage(`aztStatusMatTab_${null===(n=this.obj)||void 0===n?void 0:n.id}`,e.toString())}getStatusTab(){var e;let n=`aztStatusMatTab_${null===(e=this.obj)||void 0===e?void 0:e.id}`,i=this.browserStorageService.getSimpleStorage(n);this.tabIndex=i&&1==Number(i)?1:0}changesData(){var e,n;if(!this.isNotTestedYet){let i=!1;this.studentListsInClass&&this.studentListsInClass.length>0&&this.studentListsInClass.forEach(a=>{var r,l,c;(null===(r=this.curSelectClassShow.classObj)||void 0===r?void 0:r.id)==(null===(l=a.classObj)||void 0===l?void 0:l.id)&&(this.curSelectClassShow=a,i=!0,this.browserStorageService.saveSimpleSessionStorage("exam_results_shown_class_"+(null===(c=this.obj)||void 0===c?void 0:c.hashId),JSON.stringify(this.curSelectClassShow)))}),i||(this.studentLists&&this.studentLists.length>0?(this.curSelectClassShow={classObj:{id:-1},results:this.studentLists},i=!0,this.browserStorageService.saveSimpleSessionStorage("exam_results_shown_class_"+(null===(e=this.obj)||void 0===e?void 0:e.hashId),JSON.stringify(this.curSelectClassShow))):this.studentListsInClass&&this.studentListsInClass.length>0&&(this.curSelectClassShow=this.studentListsInClass[0],i=!0,this.browserStorageService.saveSimpleSessionStorage("exam_results_shown_class_"+(null===(n=this.obj)||void 0===n?void 0:n.hashId),JSON.stringify(this.curSelectClassShow))))}}foundClassToShown(){var e,n=!1;this.isNotTestedYet||(this.studentListsInClass&&this.studentListsInClass.length>0&&(this.curSelectClassShow=this.studentListsInClass[0],this.studentListsInClass.forEach(i=>{var a;null===(a=i.results)||void 0===a||a.forEach(r=>{var l;Number(r.id)==this.mustShownResultId&&(this.curSelectClassShow=i,this.browserStorageService.saveSimpleSessionStorage("exam_results_shown_class_"+(null===(l=this.obj)||void 0===l?void 0:l.hashId),JSON.stringify(this.curSelectClassShow)),n=!0)})})),n||this.studentLists&&this.studentLists.length>0&&(this.curSelectClassShow={classObj:{id:-1},results:this.studentLists},this.browserStorageService.saveSimpleSessionStorage("exam_results_shown_class_"+(null===(e=this.obj)||void 0===e?void 0:e.hashId),JSON.stringify(this.curSelectClassShow)),n=!0))}ngOnInit(){var e,n;if(this.createPageStudent(this.curPage),!this.isSortByMark&&!this.isSortByTime&&!this.isSortByName&&this.checkSortListStudent(),!this.isNotTestedYet&&!this.curSelectClassShow.classObj){var i=this.commonService.myParseJson(null!==(n=this.browserStorageService.getSimpleSessionStorage("exam_results_shown_class_"+(null===(e=this.obj)||void 0===e?void 0:e.hashId)))&&void 0!==n?n:"");i?this.curSelectClassShow=i:this.studentListsInClass&&this.studentListsInClass.length>0?this.curSelectClassShow=this.studentListsInClass[0]:this.studentLists&&this.studentLists.length>0&&(this.curSelectClassShow={classObj:{id:-1},results:this.studentLists})}super.ngOnInit()}ngOnChanges(){var e,n;if(this.createPageStudent(this.curPage),this.studentListsInClass||this.studentLists){if(!this.isNotTestedYet&&!this.curSelectClassShow.classObj){var i=this.commonService.myParseJson(null!==(n=this.browserStorageService.getSimpleSessionStorage("exam_results_shown_class_"+(null===(e=this.obj)||void 0===e?void 0:e.hashId)))&&void 0!==n?n:"");i?this.curSelectClassShow=i:this.studentListsInClass&&this.studentListsInClass.length>0?this.curSelectClassShow=this.studentListsInClass[0]:this.studentLists&&this.studentLists.length>0&&(this.curSelectClassShow={classObj:{id:-1},results:this.studentLists})}this.mustShownResultId?this.foundClassToShown():this.changesData()}this.getStatusTab()}ngAfterViewInit(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Xe.$),t.Y36(Tn.O),t.Y36(pn.K),t.Y36(Be.z))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-student-exam-result-new"]],inputs:{isSortByMark:"isSortByMark",isSortByTime:"isSortByTime",isSortByName:"isSortByName",backToLink:"backToLink",studentLists:"studentLists",studentListsInClass:"studentListsInClass",examHasClass:"examHasClass",isNotTestedYet:"isNotTestedYet",isOpenSideNav:"isOpenSideNav",hasEssayQuestion:"hasEssayQuestion",totalSubmitByClass:"totalSubmitByClass",showFileScan:"showFileScan",obj:"obj",isMobile:"isMobile",scanLoading:"scanLoading",mustShownResultId:"mustShownResultId",headerTitle:"headerTitle"},outputs:{goToResult:"goToResult",notTestedOpenFileScan:"notTestedOpenFileScan",saveStudentMarkEmitFromComponent:"saveStudentMarkEmitFromComponent"},features:[t.qOj,t.TTD],ngContentSelectors:gg,decls:6,vars:6,consts:[["class","flex items-center",4,"ngIf"],[1,"box","mt-2","relative",2,"min-height","90vh",3,"ngClass"],[4,"ngIf","ngIfElse"],["noLoading",""],[1,"flex","items-center"],[1,"text-md","font-medium","mr-auto"],["class","btn btn-pending-soft btn-sm",3,"click",4,"ngIf"],[1,"btn","btn-pending-soft","btn-sm",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2","lucide"],["d","M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"],["cx","12","cy","13","r","3"],["x1","2","y1","2","x2","22","y2","22"],["d","M7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16"],["d","M9.5 4h5L17 7h3a2 2 0 0 1 2 2v7.5"],["d","M14.121 15.121A3 3 0 1 1 9.88 10.88"],["class","scrollable-content flex items-center",4,"ngIf"],[4,"ngIf"],[1,"scrollable-content","flex","items-center"],[1,"text-center","mt-3","mx-auto","p-3",2,"max-width","28rem"],[1,"font-medium","text-lg"],[1,"mt-3","mx-auto"],["class","flex flex-col md:flex-row mx-auto",4,"ngIf","ngIfElse"],["OfflineExam",""],[1,"h5","mt-2","font-medium"],[1,"mt-2","ml-auto","mr-auto","w-4/5"],[1,"grid","grid-cols-12","mt-2","ml-auto","mr-auto","justify-center"],[1,"col-span-12","w-full","self-center","mb-2"],["href","https://play.google.com/store/apps/details?id=azt.azt","target","_blank","rel","noopener",1,"pl-1","pr-1","mb-2","display-inline-block"],["alt","Get it on Google Play","width","150px",1,"play-store-badge",3,"src"],["href","https://apps.apple.com/ua/app/azota/id1556025594","target","_blank","rel","noopener",1,"pl-1","pl-1","mb-2","display-inline-block"],["alt","Download on the App Store","width","135px",1,"app-store-badge",3,"src"],[1,"flex","flex-col","md:flex-row","mx-auto"],[1,"mt-3","lg:mr-auto"],[1,"btn","btn-secondary-soft",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide","mr-2"],[1,"mt-3","lg:ml-auto"],[1,"btn","btn-secondary-soft",3,"cdkCopyToClipboard","click"],["cx","18","cy","5","r","3"],["cx","6","cy","12","r","3"],["cx","18","cy","19","r","3"],["x1","8.59","y1","13.51","x2","15.42","y2","17.49"],["x1","15.41","y1","6.51","x2","8.59","y2","10.49"],[1,"mt-2","ml-auto","mr-auto","w-80"],[1,"col-span-12","items-center","mb-2"],[1,"px-1","mb-1","py-1","inline-flex","border","border-slate-200","rounded"],[1,"my-auto"],[1,"ml-1",3,"fileName","linkUrl"],[1,"ml-2","px-1","py-1","mb-1","inline-flex","border","border-slate-200","rounded"],["class","nav nav-link-tabs grid grid-cols-12 grap-3 p-2",4,"ngIf","ngIfElse"],["showOnWeb",""],[1,"azt-student-list","scrollable-content"],[3,"config","scrollIndicators"],["class","mt-4 p-2",4,"ngIf"],[1,"nav","nav-link-tabs","grid","grid-cols-12","grap-3","p-2"],[1,"col-span-6","md:col-span-3","nav-item",3,"ngClass"],[1,"nav-link","w-full","py-1","active"],["class","truncate",3,"matTooltip","matTooltipPosition",4,"ngIf"],["class","col-span-6 nav-item",4,"ngIf"],[1,"truncate",3,"matTooltip","matTooltipPosition"],[1,"col-span-6","nav-item"],[1,"nav-link","flex","items-center","w-full","py-1",2,"border","none",3,"matMenuTriggerFor"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide","ml-2"],["points","6 9 12 15 18 9"],["listActiveMenu","matMenu"],[1,"dropdown-menu","show","relative","w-56"],[1,"dropdown-content"],[4,"ngFor","ngForOf"],[1,"dropdown-item",3,"click"],["selectFromSeeMore",""],["class","col-span-6 md:col-span-3 nav-item",3,"ngClass",4,"ngIf"],["class","col-span-2 nan-item",4,"ngIf"],[1,"nav-link","w-full","py-1",3,"ngClass","click"],[1,"col-span-2","nan-item"],["class","col-span-2 nav-item",4,"ngIf"],[1,"col-span-2","nav-item"],[1,"mt-4","p-2"],[1,"grid","grid-cols-12","gap-3","sm:gap-6",2,"margin-bottom","85px"],["class","col-span-12 sm:col-span-6 md:col-span-4 2xl:col-span-3",3,"ngClass",4,"ngFor","ngForOf"],[1,"col-span-12","sm:col-span-6","md:col-span-4","2xl:col-span-3",3,"ngClass"],[1,"flex","items-center","p-3","rounded-md","bg-slate-100","dark:bg-darkmode-300",2,"min-height","85px","height","100%",3,"ngClass"],[1,"w-12","h-10","image-fit","lg:mr-1"],[3,"linkAvatar","nameCreateAvatar","size"],[1,"ml-2","text-left","mt-0",2,"width","calc( 100% - 3.5rem )"],["class","w-full",3,"href",4,"ngIf","ngIfElse"],["noClickInClass",""],[1,"w-full",3,"href"],[1,"azt-student-name","flex","items-center",2,"flex-wrap","wrap"],[1,"font-medium","truncate","mr-2",2,"max-width","70%",3,"matTooltip","isDisabledTooltip","matTooltipDisabled"],["c","isDisabled"],["class","text-xs text-danger text-right",4,"ngIf"],["class","text-xs text-danger text-right",3,"matTooltip",4,"ngIf"],[1,"flex","items-center","mt-1"],[1,"mr-auto","text-xs","mr-2"],["class","text-pending",4,"ngIf"],["class","text-danger",4,"ngIf"],["class","text-danger",3,"matTooltip",4,"ngIf"],["class","text-slate-500",4,"ngIf"],["class","text-black font-medium",4,"ngIf"],["class","text-slate-500 text-right text-xs",4,"ngIf"],["class","text-slate-500 mr-auto text-xs mr-2",4,"ngIf"],[1,"text-slate-500","text-right","text-xs"],["class","flex items-center mb-1",4,"ngIf"],[1,"text-xs","text-danger","text-right"],[1,"text-xs","text-danger","text-right",3,"matTooltip"],[1,"text-pending"],[1,"text-danger"],[1,"text-danger",3,"matTooltip"],[1,"text-slate-500"],[1,"text-black","font-medium"],[1,"text-slate-500","mr-auto","text-xs","mr-2"],[1,"flex","items-center","mb-1"],["class","mr-auto text-xs text-slate-500",4,"ngIf"],["class","text-xs text-slate-500",4,"ngIf"],[1,"mr-auto","text-xs","text-slate-500"],[1,"text-xs","text-slate-500"],[1,"font-medium","inline-block","truncate","mr-2",2,"max-width","70%",3,"matTooltip","isDisabledTooltip","matTooltipDisabled"],["class","inline-block text-right text-xs text-danger",4,"ngIf"],["class","inline-block text-right text-xs text-danger",3,"matTooltip",4,"ngIf"],[1,"flex","mt-1"],[1,"inline-block","text-right","text-xs","text-danger"],[1,"inline-block","text-right","text-xs","text-danger",3,"matTooltip"],["class","text-xs text-right text-slate-500",4,"ngIf"],[1,"text-xs","text-right","text-slate-500"],[1,"col-span-12","mt-2"],["class","text-left mt-2",4,"ngIf"],[1,"flex","items-center","p-3","rounded-md","bg-slate-100","dark:bg-darkmode-300","zoom-in",2,"min-height","85px","height","100%"],[1,"azt-result-student-info",3,"click"],[3,"routerLink","queryParams"],["class","flex items-center","style"," flex-wrap: wrap;",4,"ngIf"],["class","mb-1 img-fluid","appDrawNameImage","",3,"nameImages",4,"ngIf"],["class","text-slate-500 text-xs text-right",4,"ngIf"],[1,"text-slate-500","text-xs","text-right"],[1,"flex","items-center",2,"flex-wrap","wrap"],[1,"truncate","font-medium","mr-2",2,"max-width","70%",3,"matTooltip","isDisabledTooltip","matTooltipDisabled"],["appDrawNameImage","",1,"mb-1","img-fluid",3,"nameImages"],["class","text-xs text-slate-500 text-right",4,"ngIf"],[1,"text-xs","text-slate-500","text-right"],[1,"text-left","mt-2"],[3,"lengthPage","paging","SendPage"]],template:function(e,n){if(1&e&&(t.F$t(),t.YNc(0,jh,5,3,"div",0),t.TgZ(1,"div",1),t.Hsn(2),t.YNc(3,qh,1,0,"azt-loading-effect",2),t.YNc(4,hg,2,2,"ng-template",null,3,t.W1O),t.qZA()),2&e){const i=t.MAs(5);t.Q6J("ngIf",n.obj),t.xp6(1),t.Q6J("ngClass",t.VKq(4,pg,!n.showFileScan)),t.xp6(2),t.Q6J("ngIf",n.scanLoading)("ngIfElse",i)}},dependencies:[x.yS,O.mk,O.sg,O.O5,Ln.i3,he.VK,he.p6,Wt.gM,Lt.Vv,te.Q,Hi.L,Fo.t,Yi.o,$n.L,Cn.Q,at.mp,at.bT,at.HU,at.BI],encapsulation:2}),o})();const xg=["TABLE"];function vg(o,s){1&o&&(t.TgZ(0,"th",7),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_testbank_testted_list_essay_score")))}function bg(o,s){if(1&o&&(t.TgZ(0,"th",7),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.AsE("",t.lcZ(2,2,"lang_testbank_test_config_group"),"\xa0",e<9?"0"+(e+1):e+1,"")}}function wg(o,s){if(1&o&&(t.ynx(0),t.YNc(1,bg,3,4,"th",10),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.createFakeArr(e.maxGroupQuestion))}}function Tg(o,s){if(1&o&&(t.TgZ(0,"th",7),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=s.index;t.xp6(1),t.AsE("",t.lcZ(2,2,"lang_testbank_testted_list_question"),"\xa0",e<9?"0"+(e+1):e+1,"")}}function Cg(o,s){if(1&o&&(t.TgZ(0,"td",7),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(2);let i;t.xp6(1),t.Oqu(n.countEssayQuestion>0?(null!==(i=e.totalQuestion)&&void 0!==i?i:0)-(null!==(i=e.rightAnswer)&&void 0!==i?i:0)-n.countEssayQuestion:(null!==(i=e.totalQuestion)&&void 0!==i?i:0)-(null!==(i=e.rightAnswer)&&void 0!==i?i:0))}}function Ag(o,s){1&o&&(t.TgZ(0,"td",7),t._uU(1,"0"),t.qZA())}function yg(o,s){if(1&o&&(t.TgZ(0,"td",7),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.Oqu(null!=e.essayMark?e.essayMark:t.lcZ(2,1,n.checkStatusStudent(e)))}}function kg(o,s){if(1&o&&(t.TgZ(0,"th",7),t._uU(1),t.ALo(2,"number"),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.point,"1.2-2"))}}function Og(o,s){if(1&o&&(t.ynx(0),t.YNc(1,kg,3,4,"th",10),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",e.groupPoints)}}function Sg(o,s){if(1&o&&(t.TgZ(0,"td",7),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e)}}function Eg(o,s){if(1&o&&(t.TgZ(0,"td",7),t._uU(1),t.qZA(),t.TgZ(2,"td",7),t._uU(3),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e.key),t.xp6(2),t.Oqu(e.value)}}function Ig(o,s){if(1&o&&(t.TgZ(0,"tr")(1,"td",6),t._uU(2),t.qZA(),t.TgZ(3,"td",7),t._uU(4),t.qZA(),t.TgZ(5,"td",7),t._uU(6),t.ALo(7,"date"),t.qZA(),t.TgZ(8,"td",7),t._uU(9),t.ALo(10,"mytranslate"),t.ALo(11,"mytranslate"),t.qZA(),t.TgZ(12,"td",7),t._uU(13),t.qZA(),t.TgZ(14,"td",7),t._uU(15),t.qZA(),t.TgZ(16,"td",7),t._uU(17),t.qZA(),t.TgZ(18,"td",7),t._uU(19),t.ALo(20,"date"),t.qZA(),t.TgZ(21,"td",7),t._uU(22),t.ALo(23,"date"),t.qZA(),t.TgZ(24,"td",7),t._uU(25),t.qZA(),t.TgZ(26,"td",7),t._uU(27),t.qZA(),t.YNc(28,Cg,2,1,"td",8),t.YNc(29,Ag,2,0,"td",8),t.TgZ(30,"td",7),t._uU(31),t.ALo(32,"mytranslate"),t.qZA(),t.YNc(33,yg,3,3,"td",8),t.TgZ(34,"td",7),t._uU(35),t.qZA(),t.YNc(36,Og,2,1,"ng-container",9),t.TgZ(37,"td",7),t._uU(38),t.qZA(),t.TgZ(39,"td",7),t._uU(40),t.qZA(),t.YNc(41,Sg,2,1,"td",10),t.YNc(42,Eg,4,2,"ng-template",11),t.qZA()),2&o){const e=s.$implicit,n=t.oxw().$implicit,i=t.oxw();t.xp6(2),t.Oqu(e.fullName),t.xp6(2),t.Oqu(null==n.classObj?null:n.classObj.name),t.xp6(2),t.Oqu(t.xi3(7,21,e.birthday,"dd/MM/yyyy")),t.xp6(3),t.Oqu(0==e.gender?t.lcZ(10,24,"lang_gender_female"):1==e.gender?t.lcZ(11,26,"lang_gender_male"):""),t.xp6(4),t.Oqu(e.code),t.xp6(2),t.Oqu(e.testedTime),t.xp6(2),t.Oqu(e.totalTestTime?e.totalTestTime:null==e.allResultObjs?null:e.allResultObjs.length),t.xp6(2),t.Oqu(t.xi3(20,28,e.startedTest,"dd/MM/yyyy HH:mm:ss")),t.xp6(3),t.Oqu(t.xi3(23,31,e.createdAt,"dd/MM/yyyy HH:mm:ss")),t.xp6(3),t.Oqu(null==e.startedTest?"":i.calculationTime(e.startedTest,e.createdAt||"")),t.xp6(2),t.Oqu(e.rightAnswer),t.xp6(1),t.Q6J("ngIf",!e.isNotTested&&!e.isOnTest),t.xp6(1),t.Q6J("ngIf",e.isNotTested||e.isOnTest),t.xp6(2),t.Oqu(null!=e.trueFalseMark?e.trueFalseMark:t.lcZ(32,34,i.checkStatusStudent(e))),t.xp6(2),t.Q6J("ngIf",i.hasEssayQuestion),t.xp6(2),t.Oqu(e.mark),t.xp6(1),t.Q6J("ngIf",i.maxGroupQuestion>0),t.xp6(2),t.Oqu(null==e.eventTracks?null:e.eventTracks.exitCount),t.xp6(2),t.Oqu(null==e.eventTracks?null:e.eventTracks.blurCount),t.xp6(1),t.Q6J("ngForOf",e.answerMixObjs),t.xp6(1),t.Q6J("ngForOf",e.inforsParse)}}const Zg=function(){return[]};function Mg(o,s){if(1&o&&t.YNc(0,Ig,43,36,"tr",12),2&o){const e=s.$implicit,n=t.oxw();let i;t.Q6J("ngForOf",n.checkSortListStudent(null!==(i=null==e.classObj?null:e.classObj.sortType)&&void 0!==i?i:0,e.results||t.DdM(1,Zg)))}}function Pg(o,s){if(1&o&&(t.TgZ(0,"td",7),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw();let i;t.xp6(1),t.Oqu(n.countEssayQuestion>0?(null!==(i=e.totalQuestion)&&void 0!==i?i:0)-(null!==(i=e.rightAnswer)&&void 0!==i?i:0)-n.countEssayQuestion:(null!==(i=e.totalQuestion)&&void 0!==i?i:0)-(null!==(i=e.rightAnswer)&&void 0!==i?i:0))}}function Lg(o,s){1&o&&(t.TgZ(0,"td",7),t._uU(1,"0"),t.qZA())}function Ng(o,s){if(1&o&&(t.TgZ(0,"td",7),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw();t.xp6(1),t.Oqu(null!=e.essayMark?e.essayMark:t.lcZ(2,1,n.checkStatusStudent(e)))}}function Dg(o,s){if(1&o&&(t.TgZ(0,"th",7),t._uU(1),t.ALo(2,"number"),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.point,"1.2-2"))}}function jg(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Dg,3,4,"th",10),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",e.groupPoints)}}function qg(o,s){if(1&o&&(t.TgZ(0,"td",7),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e)}}function Qg(o,s){if(1&o&&(t.TgZ(0,"td",7),t._uU(1),t.qZA(),t.TgZ(2,"td",7),t._uU(3),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e.key),t.xp6(2),t.Oqu(e.value)}}function Ug(o,s){if(1&o&&(t.TgZ(0,"tr")(1,"td",6),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"td",7),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"td",7),t._uU(8),t.ALo(9,"date"),t.qZA(),t.TgZ(10,"td",7),t._uU(11),t.ALo(12,"mytranslate"),t.ALo(13,"mytranslate"),t.qZA(),t.TgZ(14,"td",7),t._uU(15),t.qZA(),t.TgZ(16,"td",7),t._uU(17),t.qZA(),t.TgZ(18,"td",7),t._uU(19),t.qZA(),t.TgZ(20,"td",7),t._uU(21),t.ALo(22,"date"),t.qZA(),t.TgZ(23,"td",7),t._uU(24),t.ALo(25,"date"),t.qZA(),t.TgZ(26,"td",7),t._uU(27),t.qZA(),t.TgZ(28,"td",7),t._uU(29),t.qZA(),t.YNc(30,Pg,2,1,"td",8),t.YNc(31,Lg,2,0,"td",8),t.TgZ(32,"td",7),t._uU(33),t.ALo(34,"mytranslate"),t.qZA(),t.YNc(35,Ng,3,3,"td",8),t.TgZ(36,"td",7),t._uU(37),t.qZA(),t.YNc(38,jg,2,1,"ng-container",9),t.TgZ(39,"td",7),t._uU(40),t.qZA(),t.TgZ(41,"td",7),t._uU(42),t.qZA(),t.YNc(43,qg,2,1,"td",10),t.YNc(44,Qg,4,2,"ng-template",11),t.qZA()),2&o){const e=s.$implicit,n=t.oxw();t.xp6(2),t.Oqu(e.fullName||t.lcZ(3,21,"lang_auto_thi_sinh_thi_offline")+e.resultId),t.xp6(3),t.Oqu(t.lcZ(6,23,"lang_auto_tu_do")),t.xp6(3),t.Oqu(t.xi3(9,25,e.birthday,"dd/MM/yyyy")),t.xp6(3),t.Oqu(0==e.gender?t.lcZ(12,28,"lang_gender_female"):1==e.gender?t.lcZ(13,30,"lang_gender_male"):""),t.xp6(4),t.Oqu(e.code),t.xp6(2),t.Oqu(e.testedTime),t.xp6(2),t.Oqu(e.totalTestTime?e.totalTestTime:null==e.allResultObjs?null:e.allResultObjs.length),t.xp6(2),t.Oqu(t.xi3(22,32,e.startedTest,"dd/MM/yyyy HH:mm:ss")),t.xp6(3),t.Oqu(t.xi3(25,35,e.createdAt,"dd/MM/yyyy HH:mm:ss")),t.xp6(3),t.Oqu(null==e.startedTest?"":n.calculationTime(e.startedTest,e.createdAt||"")),t.xp6(2),t.Oqu(e.rightAnswer),t.xp6(1),t.Q6J("ngIf",!e.isNotTested&&!e.isOnTest),t.xp6(1),t.Q6J("ngIf",e.isNotTested||e.isOnTest),t.xp6(2),t.Oqu(null!=e.trueFalseMark?e.trueFalseMark:t.lcZ(34,38,n.checkStatusStudent(e))),t.xp6(2),t.Q6J("ngIf",n.hasEssayQuestion),t.xp6(2),t.Oqu(e.mark),t.xp6(1),t.Q6J("ngIf",n.maxGroupQuestion>0),t.xp6(2),t.Oqu(null==e.eventTracks?null:e.eventTracks.exitCount),t.xp6(2),t.Oqu(null==e.eventTracks?null:e.eventTracks.blurCount),t.xp6(1),t.Q6J("ngForOf",e.answerMixObjs),t.xp6(1),t.Q6J("ngForOf",e.inforsParse)}}let Fg=(()=>{class o extends mt.Q{constructor(e,n,i,a){super(e),this.commonService=e,this.timeService=n,this.sortService=i,this.exportExcelService=a,this.dataScore=[],this.dataScoreByClass=[],this.examObj={},this.currentDate=new Date,this.questionExportObjs=[],this.tableType="lastTime",this.isSortByMark=!1,this.isSortByTime=!1,this.isSortByName=!1,this.hasEssayQuestion=!1,this.countEssayQuestion=0,this.maxGroupQuestion=0}exportToExcel(){var e;let n=this.examObj.hasOwnProperty("name")?this.commonService.createFileNameExportFile([null!==(e=this.examObj.name)&&void 0!==e?e:"",this.tableType,"-ScoreSheet"])+".xlsx":this.commonService.createFileNameExportFile([this.tableType,"ScoreSheet"])+".xlsx";this.exportExcelService.exportHtmlTableToExcel(this.TABLE,!0,n),"allTime"==this.tableType&&setTimeout(()=>{window.location.reload()},500)}createFakeArr(e){let n=[];for(let i=0;i<e;i++)n.push(i);return n}checkStatusStudent(e){return e.isNotMarked?"lang_auto_chua_cham":e.isOnTest?"lang_auto_dang_thi":e.isNotSubmit?"lang_auto_chua_nop_bai":e.isNotTested?"lang_auto_chua_thi":""}checkTypeTable(){return"lastTime"==this.tableType?"lang_auto_last_time":"firstTime"==this.tableType?"lang_auto_first_time":"highest"==this.tableType?"lang_auto_highest":"allTime"==this.tableType?"lang_auto_allTime":"lang_auto_last_time"}calculationTime(e,n){return this.timeService.calculationTestedTime(e,n)}checkSortListStudent(e,n){return this.isSortByMark?this.sortService.sortMarkDESC(this.commonService.myClone(n),this.hasEssayQuestion):this.isSortByTime?this.sortService.sortTimeDESC(this.commonService.myClone(n)):0==e||this.isSortByName?this.sortService.sortFirstNameStudents(this.commonService.myClone(n)):this.sortService.sortArrayByMultipleObjectKeyAsc(this.commonService.myClone(n),"pos","id")}ngOnDestroy(){super.ngOnDestroy()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Tn.O),t.Y36(pn.K),t.Y36(Gn.O))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-excel-score-sheet"]],viewQuery:function(e,n){if(1&e&&t.Gf(xg,5),2&e){let i;t.iGM(i=t.CRH())&&(n.TABLE=i.first)}},inputs:{dataScore:"dataScore",dataScoreByClass:"dataScoreByClass",examObj:"examObj",currentDate:"currentDate",questionExportObjs:"questionExportObjs",tableType:"tableType",isSortByMark:"isSortByMark",isSortByTime:"isSortByTime",isSortByName:"isSortByName",hasEssayQuestion:"hasEssayQuestion",countEssayQuestion:"countEssayQuestion",maxGroupQuestion:"maxGroupQuestion"},features:[t.qOj],decls:101,vars:88,consts:[[1,"table","table-bordered","azt-hidden",3,"id","click"],["TABLE",""],[1,"thead-dark"],["colspan","10"],["colspan","3"],["colspan","2"],[1,"border-table",2,"width","150px"],[1,"border-table"],["class","border-table",4,"ngIf"],[4,"ngIf"],["class","border-table",4,"ngFor","ngForOf"],["ngFor","",3,"ngForOf"],[4,"ngFor","ngForOf"]],template:function(e,n){1&e&&(t.TgZ(0,"table",0,1),t.NdJ("click",function(){return n.exportToExcel()}),t.TgZ(2,"thead",2)(3,"tr")(4,"th",3),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()(),t.TgZ(7,"tr")(8,"th",4),t._uU(9),t.ALo(10,"mytranslate"),t.qZA(),t.TgZ(11,"th",5),t._uU(12),t.ALo(13,"mytranslate"),t.qZA(),t.TgZ(14,"th",4),t._uU(15),t.ALo(16,"mytranslate"),t.qZA(),t.TgZ(17,"th",5),t._uU(18),t.qZA()(),t.TgZ(19,"tr")(20,"th",4),t._uU(21),t.ALo(22,"mytranslate"),t.qZA(),t.TgZ(23,"th",4),t._uU(24),t.ALo(25,"mytranslate"),t.qZA()(),t.TgZ(26,"tr")(27,"th",3),t._uU(28),t.ALo(29,"mytranslate"),t.ALo(30,"date"),t.qZA()(),t.TgZ(31,"tr"),t._UZ(32,"th"),t.qZA(),t.TgZ(33,"tr")(34,"th",6),t._uU(35),t.ALo(36,"mytranslate"),t.qZA(),t.TgZ(37,"th",7),t._uU(38),t.ALo(39,"mytranslate"),t.qZA(),t.TgZ(40,"th",7),t._uU(41),t.ALo(42,"mytranslate"),t.qZA(),t.TgZ(43,"th",7),t._uU(44),t.ALo(45,"mytranslate"),t.qZA(),t.TgZ(46,"th",7),t._uU(47),t.ALo(48,"mytranslate"),t.qZA(),t.TgZ(49,"th",7),t._uU(50),t.ALo(51,"mytranslate"),t.qZA(),t.TgZ(52,"th",7),t._uU(53),t.ALo(54,"mytranslate"),t.qZA(),t.TgZ(55,"th",7),t._uU(56),t.ALo(57,"mytranslate"),t.qZA(),t.TgZ(58,"th",7),t._uU(59),t.ALo(60,"mytranslate"),t.qZA(),t.TgZ(61,"th",7),t._uU(62),t.ALo(63,"mytranslate"),t.qZA(),t.TgZ(64,"th",7),t._uU(65),t.ALo(66,"mytranslate"),t.qZA(),t.TgZ(67,"th",7),t._uU(68),t.ALo(69,"mytranslate"),t.qZA(),t.TgZ(70,"th",7),t._uU(71),t.ALo(72,"mytranslate"),t.qZA(),t.YNc(73,vg,3,3,"th",8),t.TgZ(74,"th",7),t._uU(75),t.ALo(76,"mytranslate"),t.qZA(),t.YNc(77,wg,2,1,"ng-container",9),t.TgZ(78,"th",7),t._uU(79),t.ALo(80,"mytranslate"),t.qZA(),t.TgZ(81,"th",7),t._uU(82),t.ALo(83,"mytranslate"),t.qZA(),t.YNc(84,Tg,3,4,"th",10),t.TgZ(85,"th",7),t._uU(86),t.ALo(87,"mytranslate"),t.qZA()()(),t.TgZ(88,"tbody"),t.YNc(89,Mg,1,2,"ng-template",11),t.YNc(90,Ug,45,40,"tr",12),t._UZ(91,"tr"),t.TgZ(92,"tr"),t._UZ(93,"td")(94,"td")(95,"td")(96,"td"),t.TgZ(97,"td",5),t._uU(98),t.ALo(99,"mytranslate"),t.qZA(),t._UZ(100,"td"),t.qZA()()()),2&e&&(t.MGl("id","table_",n.tableType,""),t.xp6(5),t.AsE("",t.lcZ(6,35,"lang_testbank_testted_list_subject_exam"),": ",n.examObj.name,""),t.xp6(4),t.hij("",t.lcZ(10,37,"lang_testbank_testted_list_time_exam"),":"),t.xp6(3),t.AsE("",n.examObj.minutes," ",t.lcZ(13,39,"lang_testbank_testted_list_minute"),""),t.xp6(3),t.hij("",t.lcZ(16,41,"lang_testbank_testted_list_total_question"),":"),t.xp6(3),t.Oqu(2==n.examObj.mixQuestion?n.examObj.limitMixQuestion:n.examObj.countQuestion),t.xp6(3),t.hij("",t.lcZ(22,43,"lang_auto_kieu_export"),":"),t.xp6(3),t.Oqu(t.lcZ(25,45,n.checkTypeTable())),t.xp6(4),t.AsE("",t.lcZ(29,47,"lang_testbank_testted_list_time_export"),": ",t.xi3(30,49,n.currentDate,"dd/MM/yyyy"),""),t.xp6(7),t.Oqu(t.lcZ(36,52,"lang_first_and_last_name")),t.xp6(3),t.Oqu(t.lcZ(39,54,"lang_testbank_testted_list_class")),t.xp6(3),t.Oqu(t.lcZ(42,56,"lang_birthday")),t.xp6(3),t.Oqu(t.lcZ(45,58,"lang_gender")),t.xp6(3),t.Oqu(t.lcZ(48,60,"lang_number_code")),t.xp6(3),t.Oqu(t.lcZ(51,62,"lang_testbank_testted_tested_time_exams")),t.xp6(3),t.Oqu(t.lcZ(54,64,"lang_testbank_testted_list_number_exams")),t.xp6(3),t.Oqu(t.lcZ(57,66,"lang_testbank_testted_list_time_start")),t.xp6(3),t.Oqu(t.lcZ(60,68,"lang_testbank_testted_list_time_end")),t.xp6(3),t.Oqu(t.lcZ(63,70,"lang_testbank_testted_list_time_homework")),t.xp6(3),t.Oqu(t.lcZ(66,72,"lang_testbank_testted_list_number_success")),t.xp6(3),t.Oqu(t.lcZ(69,74,"lang_testbank_testted_list_error")),t.xp6(3),t.Oqu(t.lcZ(72,76,"lang_testbank_testted_list_test_score")),t.xp6(2),t.Q6J("ngIf",n.hasEssayQuestion),t.xp6(2),t.Oqu(t.lcZ(76,78,"lang_testbank_testted_list_total_point")),t.xp6(2),t.Q6J("ngIf",n.maxGroupQuestion>0),t.xp6(2),t.Oqu(t.lcZ(80,80,"lang_testbank_testted_list_exit_full_screen")),t.xp6(3),t.Oqu(t.lcZ(83,82,"lang_testbank_testted_list_exit_brower")),t.xp6(2),t.Q6J("ngForOf",n.questionExportObjs),t.xp6(2),t.Oqu(t.lcZ(87,84,"lang_testbank_testted_list_additional_information")),t.xp6(3),t.Q6J("ngForOf",n.dataScoreByClass),t.xp6(1),t.Q6J("ngForOf",n.dataScore),t.xp6(8),t.hij("",t.lcZ(99,86,"lang_testbank_testted_list_teacher_confirmed"),":"))},dependencies:[O.sg,O.O5,O.JJ,O.uU,at.bT],encapsulation:2}),o})();class Rg{constructor(){this.x=0,this.y=0}toBase64String(){return(new je).writeCvPoint2u(this).toBase64String()}}class Qn{constructor(){this.x=0,this.y=0}toBase64String(){return(new je).writeCvPoint2f(this).toBase64String()}}class Jo{constructor(){this.x=0,this.y=0,this.width=0,this.height=0}toBase64String(){return(new je).writeCvRect2f(this).toBase64String()}}class Bg{constructor(){this.center=new Qn,this.filled=!1}toBase64String(){return(new je).writeAnswerCircle(this).toBase64String()}}class xi{constructor(){this.rows=0,this.cols=0,this.radius=0,this.answers=[]}toBase64String(){return(new je).writeTableAnswer(this).toBase64String()}}class Ho{constructor(){this.top=new Qn,this.left=new Qn,this.bottom=new Qn,this.right=new Qn}toBase64String(){return(new je).writeResultRect(this).toBase64String()}}class Jg{constructor(){this.id=0,this.region=new Jo}toBase64String(){return(new je).writeCropRegion(this).toBase64String()}}class Hg{constructor(){this.type=0,this.errorCode=0,this.paperCorner=new Ho,this.studentId=new xi,this.examId=new xi,this.answerTable=new xi,this.imageWidth=0,this.imageHeight=0,this.imageSize=0,this.cropRegion=[]}toBase64String(){return(new je).writeResultOutput(this).toBase64String()}}class zg{constructor(){this.templateType=0,this.imageWidth=0,this.imageHeight=0}toBase64String(){return(new je).writeAnswerSheetInput(this).toBase64String()}}class zo{constructor(){this.position=0,this.x=0,this.y=0,this.filledCols=0,this.rows=0}toBase64String(){return(new je).writeSmallAnswerCircle(this).toBase64String()}}class Un{constructor(){this.rows=0,this.cols=0,this.radius=0,this.answers=[]}toBase64String(){return(new je).writeSmallTableAnswer(this).toBase64String()}}class Yo{constructor(){this.studentId=new Un,this.examId=new Un,this.answerTable=new Un}toBase64String(){return(new je).writeDrawData(this).toBase64String()}}class Yg{constructor(s){this.bytes=s,this.cursor=0,this.length=s.byteLength}updateCursor(s){if(this.cursor=this.cursor+s,this.cursor>this.length)throw new Error("Overflow InputStreaming")}parseUchar(){let s=this.bytes[this.cursor];return this.updateCursor(1),s}parseInt(){let s=this.bytes.buffer.slice(this.cursor,this.cursor+4);return this.updateCursor(4),new DataView(s).getInt32(0)}parseDouble(){let s=this.bytes.buffer.slice(this.cursor,this.cursor+8);return this.updateCursor(8),new DataView(s).getFloat64(0,!0)}parseString(){let s=new TextDecoder("utf-8"),e=this.cursor,n=this.bytes[this.cursor];for(;0!=n;)this.updateCursor(1),n=this.bytes[this.cursor];let i=this.bytes.slice(e,this.cursor),a=s.decode(i);return this.updateCursor(1),a}parseBool(){let s=this.bytes[this.cursor];return this.updateCursor(1),s>0}parseCvPoint2u(){let s=new Rg;return s.x=this.parseUchar(),s.y=this.parseUchar(),s}parseCvPoint2f(){let s=new Qn;return s.x=this.parseDouble(),s.y=this.parseDouble(),s}parseCvRect2f(){let s=new Jo;return s.x=this.parseDouble(),s.y=this.parseDouble(),s.width=this.parseDouble(),s.height=this.parseDouble(),s}parseAnswerCircle(){let s=new Bg;return s.center=this.parseCvPoint2f(),s.filled=this.parseBool(),s}parseTableAnswer(){let s=new xi,e=0;s.rows=this.parseInt(),s.cols=this.parseInt(),s.radius=this.parseInt(),e=this.parseInt();for(let n=0;n<e;n++)s.answers.push(this.parseAnswerCircle());return s}parseResultRect(){let s=new Ho;return s.top=this.parseCvPoint2f(),s.left=this.parseCvPoint2f(),s.bottom=this.parseCvPoint2f(),s.right=this.parseCvPoint2f(),s}parseCropRegion(){let s=new Jg;return s.id=this.parseInt(),s.region=this.parseCvRect2f(),s}parseResultOutput(){let s=new Hg,e=0;s.type=this.parseInt(),s.errorCode=this.parseInt(),s.paperCorner=this.parseResultRect(),s.studentId=this.parseTableAnswer(),s.examId=this.parseTableAnswer(),s.answerTable=this.parseTableAnswer(),s.imageWidth=this.parseInt(),s.imageHeight=this.parseInt(),s.imageSize=this.parseInt(),e=this.parseInt();for(let n=0;n<e;n++)s.cropRegion.push(this.parseCropRegion());return s}parseAnswerSheetInput(){let s=new zg;return s.templateType=this.parseInt(),s.imageWidth=this.parseInt(),s.imageHeight=this.parseInt(),s}parseSmallAnswerCircle(){let s=new zo;return s.position=this.parseUchar(),s.x=this.parseUchar(),s.y=this.parseUchar(),s.filledCols=this.parseUchar(),s.rows=this.parseUchar(),s}parseSmallTableAnswer(){let s=new Un,e=0;s.rows=this.parseUchar(),s.cols=this.parseUchar(),s.radius=this.parseUchar(),e=this.parseInt();for(let n=0;n<e;n++)s.answers.push(this.parseSmallAnswerCircle());return s}parseDrawData(){let s=new Yo;return s.studentId=this.parseSmallTableAnswer(),s.examId=this.parseSmallTableAnswer(),s.answerTable=this.parseSmallTableAnswer(),s}}const an=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];class je{constructor(){this.bytes=[]}writeUchar(s){return this.bytes.push(s),this}writeUint8Array(s){for(let e=0;e<s.length;e++)this.bytes.push(s[e]);return this}writeArrayBuffer(s){let e=new Uint8Array(s);return this.writeUint8Array(e),this}writeInt(s){let e=new ArrayBuffer(4);return new DataView(e).setUint32(0,s,!1),this.writeArrayBuffer(e),this}writeDouble(s){let e=new ArrayBuffer(8);return new DataView(e).setFloat64(0,s,!0),this.writeArrayBuffer(e),this}writeString(s){let n=(new TextEncoder).encode(s);return this.writeUint8Array(n),this.writeUchar(0),this}writeBool(s){return this.writeUchar(s?1:0),this}toBase64String(){return function Gg(o){let e,s="",n=o.length;for(e=2;e<n;e+=3)s+=an[o[e-2]>>2],s+=an[(3&o[e-2])<<4|o[e-1]>>4],s+=an[(15&o[e-1])<<2|o[e]>>6],s+=an[63&o[e]];return e===n+1&&(s+=an[o[e-2]>>2],s+=an[(3&o[e-2])<<4],s+="=="),e===n&&(s+=an[o[e-2]>>2],s+=an[(3&o[e-2])<<4|o[e-1]>>4],s+=an[(15&o[e-1])<<2],s+="="),s}(new Uint8Array(this.bytes))}writeCvPoint2u(s){return this.writeUchar(s.x),this.writeUchar(s.y),this}writeCvPoint2f(s){return this.writeDouble(s.x),this.writeDouble(s.y),this}writeCvRect2f(s){return this.writeDouble(s.x),this.writeDouble(s.y),this.writeDouble(s.width),this.writeDouble(s.height),this}writeAnswerCircle(s){return this.writeCvPoint2f(s.center),this.writeBool(s.filled),this}writeTableAnswer(s){this.writeInt(s.rows),this.writeInt(s.cols),this.writeInt(s.radius),this.writeInt(s.answers.length);for(let e of s.answers)this.writeAnswerCircle(e);return this}writeResultRect(s){return this.writeCvPoint2f(s.top),this.writeCvPoint2f(s.left),this.writeCvPoint2f(s.bottom),this.writeCvPoint2f(s.right),this}writeCropRegion(s){return this.writeInt(s.id),this.writeCvRect2f(s.region),this}writeResultOutput(s){this.writeInt(s.type),this.writeInt(s.errorCode),this.writeResultRect(s.paperCorner),this.writeTableAnswer(s.studentId),this.writeTableAnswer(s.examId),this.writeTableAnswer(s.answerTable),this.writeInt(s.imageWidth),this.writeInt(s.imageHeight),this.writeInt(s.imageSize),this.writeInt(s.cropRegion.length);for(let e of s.cropRegion)this.writeCropRegion(e);return this}writeAnswerSheetInput(s){return this.writeInt(s.templateType),this.writeInt(s.imageWidth),this.writeInt(s.imageHeight),this}writeSmallAnswerCircle(s){return this.writeUchar(s.position),this.writeUchar(s.x),this.writeUchar(s.y),this.writeUchar(s.filledCols),this.writeUchar(s.rows),this}writeSmallTableAnswer(s){this.writeUchar(s.rows),this.writeUchar(s.cols),this.writeUchar(s.radius),this.writeInt(s.answers.length);for(let e of s.answers)this.writeSmallAnswerCircle(e);return this}writeDrawData(s){return this.writeSmallTableAnswer(s.studentId),this.writeSmallTableAnswer(s.examId),this.writeSmallTableAnswer(s.answerTable),this}}const $g=["fileInput"],Wg=["fileInputMobile"];function Kg(o,s){1&o&&(t.TgZ(0,"p",17),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_he_thong_dang_tai_cong_cu_doing")))}function Vg(o,s){1&o&&(t.TgZ(0,"span",23),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_dang_quet_bai_tu_phieu_scan_doing")))}function Xg(o,s){1&o&&(t.TgZ(0,"span",23),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_quet_thanh_cong")," "))}function tf(o,s){1&o&&(t.TgZ(0,"span",23),t._uU(1),t.ALo(2,"mytranslate"),t._UZ(3,"span",24),t.qZA()),2&o&&(t.xp6(1),t.hij("",t.lcZ(2,1,"lang_auto_he_thong_dang_luu_bai_vui_long_khong_thoat_trinh_duyet"),"\xa0"))}function ef(o,s){1&o&&(t.TgZ(0,"span",23),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_cham_thanh_cong")," "))}function nf(o,s){1&o&&(t.TgZ(0,"span",23),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_cham_khong_thanh_cong")," "))}function of(o,s){if(1&o&&(t.TgZ(0,"b",25),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.AsE("",e.doneFileScan-e.uploadFileScanError.length,"/",e.totalFileScan,"")}}function af(o,s){if(1&o&&(t.TgZ(0,"b",25),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.AsE("",e.saveSuccessCount,"/",e.totalFileScan,"")}}function sf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"p",26)(1,"a",27),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.showStudentList())}),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()}2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_auto_xem_danh_sach")," "))}function rf(o,s){if(1&o&&(t.TgZ(0,"div",18)(1,"p",19),t.YNc(2,Vg,3,3,"span",20),t.YNc(3,Xg,3,3,"span",20),t.YNc(4,tf,4,3,"span",20),t.YNc(5,ef,3,3,"span",20),t.YNc(6,nf,3,3,"span",20),t.YNc(7,of,2,2,"b",21),t.YNc(8,af,2,2,"b",21),t.qZA(),t.YNc(9,sf,4,3,"p",22),t.qZA()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.scanningStatus.isScanning),t.xp6(1),t.Q6J("ngIf",e.scanningStatus.isScanDone&&!e.scanningStatus.isSavingDone&&!e.scanningStatus.isSaving&&!e.scanningStatus.isSavingFail),t.xp6(1),t.Q6J("ngIf",e.scanningStatus.isSaving),t.xp6(1),t.Q6J("ngIf",e.scanningStatus.isSavingDone),t.xp6(1),t.Q6J("ngIf",e.scanningStatus.isSavingFail),t.xp6(1),t.Q6J("ngIf",!e.scanningStatus.isSavingDone&&e.totalFileScan>0),t.xp6(1),t.Q6J("ngIf",e.scanningStatus.isSavingDone&&e.totalFileScan>0),t.xp6(1),t.Q6J("ngIf",e.scanningStatus.isSavingDone)}}function lf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",18)(1,"p",28),t._uU(2),t.ALo(3,"mytranslate"),t.TgZ(4,"b",29),t._uU(5),t.qZA(),t._uU(6," file. \xa0"),t.qZA(),t.TgZ(7,"a",27),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.showScanFalseFiles())}),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,4,"lang_auto_da_xay_ra_loi_scan_o")," "),t.xp6(3),t.AsE("",e.uploadFileScanError.length,"/",e.totalFileScan," "),t.xp6(3),t.hij(" ",t.lcZ(9,6,"lang_auto_xem_chi_tiet")," ")}}function cf(o,s){if(1&o&&(t.TgZ(0,"p",28),t._uU(1),t.ALo(2,"mytranslate"),t.ALo(3,"mytranslate"),t.qZA()),2&o){const e=s.$implicit,n=t.oxw(2);let i;t.xp6(1),t.HOy(" ",t.lcZ(2,4,"lang_auto_ma_de"),": ",n.replaceDigit(null!==(i=e.offlineMixquestionHashId)&&void 0!==i?i:0,!1)," ",t.lcZ(3,6,"lang_auto_-_so_bao_danh"),": ",n.replaceDigit(null!==(i=e.studentCode)&&void 0!==i?i:0,!0)," ")}}function _f(o,s){if(1&o&&(t.TgZ(0,"div",30)(1,"p",28),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.YNc(4,cf,4,8,"p",31),t.qZA()),2&o){const e=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,2,"lang_auto_du_lieu_luu_loi"),":"),t.xp6(2),t.Q6J("ngForOf",e.invalidDataCallMarkObjs)}}function df(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",36),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.selectFileClick())}),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()}2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_chon_thu_muc_file_scan")," "))}function uf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",32)(1,"p",33),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.YNc(4,df,3,3,"button",34),t.TgZ(5,"button",35),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.selectFileClick(!0))}),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,3,"lang_auto_cham_diem_tu_phieu_tra_loi_trac_nghiem_cua_hoc_sinh")),t.xp6(2),t.Q6J("ngIf",!e.isMobile),t.xp6(2),t.hij(" ",t.lcZ(7,5,"lang_auto_chon_thu_muc_file_scan_mobile")," ")}}function mf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",42)(1,"button",41),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.selectFileClick())}),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()}2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_auto_chon_thu_muc_file_scan")," "))}const hf=function(o){return{"pl-0":o}};function pf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",37)(1,"p",33),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"div",38),t.YNc(5,mf,4,3,"div",39),t.TgZ(6,"div",40)(7,"button",41),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.selectFileClick(!0))}),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,4,"lang_auto_cham_diem_tu_phieu_tra_loi_trac_nghiem_cua_hoc_sinh")),t.xp6(3),t.Q6J("ngIf",!e.isMobile),t.xp6(1),t.Q6J("ngClass",t.VKq(8,hf,!e.isMobile)),t.xp6(2),t.hij(" ",t.lcZ(9,6,"lang_auto_chon_thu_muc_file_scan_mobile")," ")}}function gf(o,s){1&o&&(t.TgZ(0,"mat-icon",48),t._uU(1,"double_arrow"),t.qZA())}function ff(o,s){if(1&o&&(t.TgZ(0,"div",43)(1,"div",44),t._UZ(2,"div",45),t.YNc(3,gf,2,0,"mat-icon",46),t._UZ(4,"div",47),t.qZA()()),2&o){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.doneFileScan>0)}}function xf(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function vf(o,s){if(1&o&&(t.TgZ(0,"div",11)(1,"div",12),t._UZ(2,"div",13)(3,"div",14),t.qZA()()),2&o){const e=t.oxw().index;t.xp6(2),t.s9C("id","processFileScan"+e),t.xp6(1),t.s9C("id","doneFileScan"+e)}}function bf(o,s){if(1&o&&(t.TgZ(0,"div",9)(1,"p"),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.YNc(4,vf,4,2,"div",10),t.qZA()),2&o){const e=s.$implicit,n=s.index,i=t.oxw(2);t.xp6(2),t.AsE("",n+1,".\xa0",t.lcZ(3,3,i.getErrorCode(e.errorMessage?e.errorMessage:"")),""),t.xp6(2),t.Q6J("ngIf",e.img_in||e.img_out)}}function wf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"h3",5),t._uU(4),t.ALo(5,"mytranslate"),t.qZA(),t.YNc(6,bf,5,5,"div",6),t.TgZ(7,"div",7)(8,"button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onNoClick())}),t._uU(9),t.ALo(10,"mytranslate"),t.qZA()()()()()}if(2&o){const e=t.oxw();t.xp6(4),t.hij(" ",t.lcZ(5,3,"lang_auto_anh_scan_loi")," "),t.xp6(2),t.Q6J("ngForOf",e.data),t.xp6(3),t.hij(" ",t.lcZ(10,5,"lang_auto_dong")," ")}}const Gi=".has-bg[_ngcontent-%COMP%]{background:inherit;background-color:#f1f1f1;box-sizing:border-box;border-width:1px;border-style:solid;border-color:#dfdfdf;border-radius:4px;box-shadow:none}.btn-custom-file-scan[_ngcontent-%COMP%]{display:block;background:#2361ae;color:#fff;transition:all .5s}.link__color[_ngcontent-%COMP%]{color:#0eafc0!important}.link__hover[_ngcontent-%COMP%]:hover{color:#0a8f9e!important}.status_saving[_ngcontent-%COMP%]{position:fixed;z-index:9999;top:0;left:0;width:100%;height:100%;background-color:#0000007b}.scan-file-content[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:100%;transform:translate(-50%,-50%)}.scan-file-body[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;max-height:70vh}@media (max-width: 820px){.btn-custom-file-scan[_ngcontent-%COMP%]{padding:0 10px}}@media (max-width: 768px){.scan-file-body[_ngcontent-%COMP%]{height:calc(100vh - 250px);position:relative}.scan-file-content[_ngcontent-%COMP%]{transform:none!important;top:0px;left:0px;height:100%}.arrow_icon[_ngcontent-%COMP%]{margin-left:5px!important;width:100%!important}}";function Tf(o,s){1&o&&(t.TgZ(0,"div",0)(1,"p",6),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"lang_auto_khong_the_tao_de_thi_offline_voi_de_dang_docx")))}function Cf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",0)(1,"p",6),t._uU(2),t.ALo(3,"mytranslate"),t.TgZ(4,"a",7),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.redirectToCreateOfflineTest())}),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()()}2&o&&(t.xp6(2),t.hij("",t.lcZ(3,2,"lang_testbank_tested_list_no_exam_offline_scan"),"\xa0 "),t.xp6(3),t.Oqu(t.lcZ(6,4,"lang_testbank_test_list_scan_tutorial_click_here")))}const Je=270;let Af=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c){super(n),this.fb=e,this.commonService=n,this.offlineExamResultService=i,this.baseApiService=a,this.uploadApiService=r,this.permissionService=l,this.dialog=c,this.openSelectFile=!1,this.examObj={},this.loadedJs=!1,this.hasExamOffline=!1,this.tokenScan="",this.examOfflineMessage="",this.backToLink="",this.saveStudentMarkEmit=new t.vpe,this.showStudentMarkEmit=new t.vpe,this.firstSuccessResultId=new t.vpe,this.form=new h.nJ({}),this.scanningStatus={isSaving:!1,isSavingDone:!1,isScanDone:!1,isScanning:!1,isSavingFail:!1},this.loadingFileJS=!1,this.isSelectedFile=!1,this.firstTimeScan=!0,this.isMobile=!1,this.queueUploadFileScan=[],this.uploadFileScanError=[],this.isProcessingFileScan=!1,this.doneFileScan=0,this.totalFileScan=0,this.queueSaveMarkObj=[],this.listMapStudentCodeAndExamId=[],this.isProcessingSaveMark=!1,this.doneFileScanMarked=0,this.totalFileScanMarked=0,this.saveSuccessCount=0,this.arrDataCallMarkObjs=[],this.invalidDataCallMarkObjs=[],this.selectFileDirectory=_=>(0,Oe.mG)(this,void 0,void 0,function*(){let p=_.target.files;try{let M=0;var w=[];for(var C in p)if("length"!=C&&"item"!=C){var A=p[C];A.webkitRelativePath.indexOf("._")<0&&(A.webkitRelativePath.indexOf(".jpg")>0||A.webkitRelativePath.indexOf(".png")>0||A.webkitRelativePath.indexOf(".tiff")>0||A.webkitRelativePath.indexOf(".tif")>0||A.webkitRelativePath.indexOf(".jpeg")>0)?w.push(A):M++}!p||M>=(null==p?void 0:p.length)?this.showErrorSnack("lang_auto_thu_muc_co_anh_khong_dung_dinh_dang_ho_tro_jpg_png_tiff_va_jpeg_brackets_vui_long_kiem_tra_lai"):(w.forEach(D=>{this.getFileLocal(D)}),this.firstTimeScan=!1)}catch(M){console.log(M)}}),this.selectFile=_=>(0,Oe.mG)(this,void 0,void 0,function*(){let p=_.target.files;try{let M=0,D=!1;var w=[];for(var C in p)if("length"!=C&&"item"!=C){var A=p[C];A.name.indexOf("._")<0&&(A.name.indexOf(".jpg")>0||A.name.indexOf(".png")>0||A.name.indexOf(".tiff")>0||A.name.indexOf(".tif")>0||A.name.indexOf(".jpeg")>0)?w.push(A):((A.name.indexOf(".heic")>0||A.name.indexOf(".heif")>0)&&(D=!0),M++)}!p||M>=(null==p?void 0:p.length)?this.showErrorSnack(D?"lang_auto_file_chon_co_heic_khong_dung_dinh_dang_ho_tro_jpg_png_tiff_va_jpeg_brackets_vui_long_kiem_tra_lai":"lang_auto_file_chon_co_anh_khong_dung_dinh_dang_ho_tro_jpg_png_tiff_va_jpeg_brackets_vui_long_kiem_tra_lai"):(w.forEach(q=>{this.getFileLocal(q)}),this.firstTimeScan=!1)}catch(M){console.log(M)}}),this.processSaveMarkObj=_=>(0,Oe.mG)(this,void 0,void 0,function*(){var d,m,p,w;this.isProcessingSaveMark=!0;try{if(_.page){var C={offlineMixquestionHashId:this.convertStringToNumber(_.ExamId),studentCode:this.convertStringToNumber(_.StudentId),studentCodeLength:_.StudentId?_.StudentId.split(",").length-1:0,offlineMixquestionHashIdLength:_.ExamId?_.ExamId.split(",").length-1:0,images:{url:"",width:_.img_out.naturalWidth<720?720:_.img_out.naturalWidth,height:_.img_out.naturalHeight<1038?1038:_.img_out.naturalHeight},imagesData:{content:this.getScanAnswerContent(_.Answers),pos:this.getScanFilePos(_.page)},objScan:_};0==_.code&&!this.existStudentCodeAndExamId(null!==(d=C.studentCode)&&void 0!==d?d:0,null!==(m=C.offlineMixquestionHashId)&&void 0!==m?m:0)&&(this.listMapStudentCodeAndExamId.push({studentCode:null!==(p=C.studentCode)&&void 0!==p?p:0,examId:null!==(w=C.offlineMixquestionHashId)&&void 0!==w?w:0}),C.index=this.arrDataCallMarkObjs.length,this.arrDataCallMarkObjs.push(C)),this.doneFileScanMarked++}this.isProcessingSaveMark=!1,this.processQueueSaveMarkObj(),this.totalFileScan<Je&&this.scanningStatus.isScanDone&&this.doneFileScanMarked>=this.totalFileScan-this.uploadFileScanError.length||this.doneFileScanMarked>=Je?(this.scanningStatus.isSaving=!0,this.getNamePosForStudent().then(()=>{this.callSaveMarkObj()})):console.log(this.totalFileScan+"|"+this.scanningStatus.isScanDone+"|"+this.doneFileScanMarked+"|"+(this.totalFileScan-this.uploadFileScanError.length)+"|"+this.uploadFileScanError.length)}catch(A){throw A}})}selectFileClick(e){var n;this.hasExamOffline?this.permissionService.hasMarkPointPermission("exam",null===(n=this.examObj)||void 0===n?void 0:n.permissionObj)?this.loadedJs?this.fileInput&&(this.doneFileScan=0,this.doneFileScanMarked=0,this.saveSuccessCount=0,this.totalFileScan=0,this.totalFileScanMarked=0,this.arrDataCallMarkObjs=[],this.listMapStudentCodeAndExamId=[],this.uploadFileScanError=[],this.invalidDataCallMarkObjs=[],this.isSelectedFile=!1,this.scanningStatus={isSaving:!1,isScanDone:!1,isScanning:!1,isSavingDone:!1,isSavingFail:!1},this.fileInputMobile&&e?(this.fileInputMobile.nativeElement.value=null,this.fileInputMobile.nativeElement.click(),this.firstTimeScan=!0):(this.fileInput.nativeElement.value=null,this.fileInput.nativeElement.click())):this.loadingFileJs().then(()=>{this.loadingFileJS=!1,this.fileInput&&(this.doneFileScan=0,this.saveSuccessCount=0,this.totalFileScan=0,this.totalFileScanMarked=0,this.doneFileScanMarked=0,this.arrDataCallMarkObjs=[],this.listMapStudentCodeAndExamId=[],this.uploadFileScanError=[],this.invalidDataCallMarkObjs=[],this.isSelectedFile=!1,this.scanningStatus={isSaving:!1,isScanDone:!1,isScanning:!1,isSavingDone:!1,isSavingFail:!1},this.fileInputMobile&&e?(this.fileInputMobile.nativeElement.value=null,this.fileInputMobile.nativeElement.click(),this.firstTimeScan=!0):(this.fileInput.nativeElement.value=null,this.fileInput.nativeElement.click()))}):this.showErrorSnack("lang_auto_ban_khong_co_quyen_thuc_thi_chuc_nang_nay"):this.examOfflineMessage&&""!=this.examOfflineMessage?this.showErrorSnack(this.examOfflineMessage):this.dialog.open(kf,{width:"60vw",data:{examObj:this.examObj,backToLink:this.backToLink}}).afterClosed().subscribe(a=>{})}getFileLocal(e){var n=new FileReader;n.onload=()=>{if(n.result&&"string"!=typeof n.result){var a=new Uint8Array(n.result);this.totalFileScan++,this.isSelectedFile=!0,this.scanningStatus.isScanning=!0,this.addQueueFileScan(a)}},n.readAsArrayBuffer(e)}addQueueFileScan(e){this.queueUploadFileScan.push(e),this.processQueueFileScan()}processQueueFileScan(){if(!this.isProcessingFileScan&&0!=this.queueUploadFileScan.length){var e=this.queueUploadFileScan.shift();e&&this.processImg(e)}}processImg(e){var n;return(0,Oe.mG)(this,void 0,void 0,function*(){this.isProcessingFileScan=!0;try{if(null!=typeof imgsdk&&window.hasOwnProperty("imgsdk")){yield imgsdk.init();var i=this.baseApiService.getUserObj(),a=yield imgsdk.processAnswerSheet({src:e,width:720,height:1280,token:this.tokenScan,uid:null===(n=i.id)||void 0===n?void 0:n.toString()});a&&(this.doneFileScan++,a.Result&&(a.page=new Yg(a.Result).parseResultOutput()),console.log("angular Obj",a)),0==this.queueUploadFileScan.length&&(this.scanningStatus.isScanning=!1,this.scanningStatus.isScanDone=!0),(0!=a.code||this.existStudentCodeAndExamId(this.convertStringToNumber(a.StudentId),this.convertStringToNumber(a.ExamId)))&&(a.errorMessage=0!=a.code?"process_scan_false":this.existStudentCodeAndExamId(this.convertStringToNumber(a.StudentId),this.convertStringToNumber(a.ExamId))?"exist_exam_id_and_student_code":"process_scan_false",a.img_in&&this.uploadFileToCdn(a.img_in,0,!0),this.uploadFileScanError.push(a)),this.addQueueSaveMarkObj(a),this.showOutput(a)}}catch(r){}this.isProcessingFileScan=!1,this.processQueueFileScan()})}showOutput(e){var n=document.getElementById("processFileScan"),i=document.getElementById("doneFileScan");n&&i&&(n.innerHTML="",i.innerHTML="",e.img_in.width=144,e.img_in.height=207,n.appendChild(e.img_in),e.img_out&&(e.img_out.width=144,e.img_out.height=207,e.img_out.style.marginLeft=this.isMobile?"20px":"30px",e.img_out.style.display="inline",e.img_out.style.verticalAlign="middle",i.appendChild(e.img_out)))}addQueueSaveMarkObj(e){e&&(this.queueSaveMarkObj.push(e),this.totalFileScanMarked++),this.processQueueSaveMarkObj()}processQueueSaveMarkObj(){if(!this.isProcessingSaveMark&&0!=this.queueSaveMarkObj.length){var e=this.queueSaveMarkObj.shift();e&&this.processSaveMarkObj(e)}}callSaveMarkObj(){this.subscriptions.add(this.offlineExamResultService.apiOfflineExamResultMarkObjsV2Post(this.removeObjScanToSaveObjs(this.arrDataCallMarkObjs),this.examObj.hashId).subscribe(e=>{var n,i,a,r,l,c,_;if(e&&1==e.success){var d=null!==(i=null===(n=e.data)||void 0===n?void 0:n.studentCodeToSuccessIds)&&void 0!==i?i:{};this.firstSuccessResultId.emit(null===(a=e.data)||void 0===a?void 0:a.firstSuccessResultId),(null===(r=e.data)||void 0===r?void 0:r.invalidData)&&(null===(l=e.data)||void 0===l?void 0:l.invalidData.length)>0&&(this.invalidDataCallMarkObjs=null===(c=e.data)||void 0===c?void 0:c.invalidData),Object.keys(d).length>0?this.getUrlForImgScan(d).then(m=>{this.updateImgUrlForScan(m)}):(this.scanningStatus.isSaving=!1,this.scanningStatus.isSavingFail=!0,this.showErrorSnack("lang_auto_he_thong_khong_tim_thay_de_thi_hoac_danh_sach_hs_vui_long_kiem_tra_lai_tep_tin_tai_len"))}else this.scanningStatus.isSaving=!1,this.scanningStatus.isSavingFail=!0,this.showErrorSnack(null!==(_=e.message)&&void 0!==_?_:"")}))}removeObjScanToSaveObjs(e){for(var n=[],i=e.length<Je?e.length:Je,a=0;a<i;a++)n.push({index:e[a].index,studentCode:e[a].studentCode,offlineMixquestionHashId:e[a].offlineMixquestionHashId,studentCodeLength:e[a].studentCodeLength,offlineMixquestionHashIdLength:e[a].offlineMixquestionHashIdLength,images:e[a].images,imagesData:e[a].imagesData,nameImages:e[a].nameImages});return n}getNamePosForStudent(){return new Promise(e=>{var n,i,a,r;if(this.arrDataCallMarkObjs.length>0){var l=this.arrDataCallMarkObjs.length<=Je?this.arrDataCallMarkObjs.length:Je,c=document.createElement("canvas");const w=c.getContext("2d");if(c.width=this.arrDataCallMarkObjs.length<9?250*this.arrDataCallMarkObjs.length:2250,this.arrDataCallMarkObjs.length<9)c.height=50;else if(this.arrDataCallMarkObjs.length<Je){let C=Math.floor(this.arrDataCallMarkObjs.length/9);c.height=50*(C+(this.arrDataCallMarkObjs.length%9>0?1:0))}else c.height=1500;for(var _=0,d=0,m=0;m<l;m++){m>0&&m%9==0&&(_++,d=0);var p=50*_;let C=null!==(n=this.arrDataCallMarkObjs[m].objScan.page.cropRegion[0].region.x)&&void 0!==n?n:210,A=null!==(i=this.arrDataCallMarkObjs[m].objScan.page.cropRegion[0].region.y)&&void 0!==i?i:210,M=null!==(a=this.arrDataCallMarkObjs[m].objScan.page.cropRegion[0].region.width)&&void 0!==a?a:250,D=null!==(r=this.arrDataCallMarkObjs[m].objScan.page.cropRegion[0].region.height)&&void 0!==r?r:50;null==w||w.drawImage(this.arrDataCallMarkObjs[m].objScan.img_out,C,A,M,D,250*d,p,250,50),this.arrDataCallMarkObjs[m].nameImages={url:"",width:c.width,height:c.height,position:{x:250*d,y:p,width:250,height:50}},d++}c.toBlob(C=>{let M=(new Date).getTime();var D=this.commonService.getRandomNumber(1e6,9999999);const q=new File([C],`azo_file_name_scan_${D}_${M}.jpeg`,{type:"image/jpeg"});this.uploadApiService.uploadToCdnForFileScanNameExamOffline(q).subscribe(U=>{var F,tt,W;if(U&&1==U.success)for(var P=0;P<l;P++)this.arrDataCallMarkObjs[P].nameImages={url:null!==(tt=null===(F=U.data)||void 0===F?void 0:F.url)&&void 0!==tt?tt:"",width:c.width,height:c.height,position:null===(W=this.arrDataCallMarkObjs[P].nameImages)||void 0===W?void 0:W.position};e()})},"image/jpeg",.9)}else e()})}getUrlForImgScan(e){return new Promise(n=>{var i=[];for(var a in e)if(e.hasOwnProperty(a)){var r=this.arrDataCallMarkObjs.filter(l=>{var c;return(null===(c=l.index)||void 0===c?void 0:c.toString())==a});r&&r.length>0&&this.uploadFileToCdn(r[0].objScan.img_out,e[a],!1).then(l=>{i.push({id:l.id,images:{url:l.imgUrl,width:r[0].objScan.img_out.naturalWidth<720?720:r[0].objScan.img_out.naturalWidth,height:r[0].objScan.img_out.naturalHeight<1038?1038:r[0].objScan.img_out.naturalHeight}}),i.length==Object.keys(e).length&&n(i)})}})}updateImgUrlForScan(e){this.subscriptions.add(this.offlineExamResultService.apiOfflineExamResultUpdateImagesPost(e,this.examObj.hashId).subscribe(n=>{var i;n&&1==n.success?(this.saveSuccessCount+=e.length,this.arrDataCallMarkObjs.length>=Je?this.arrDataCallMarkObjs.splice(0,Je):(this.scanningStatus.isSaving=!1,this.scanningStatus.isSavingFail=!1,this.scanningStatus.isSavingDone=!0),this.doneFileScanMarked>Je&&(this.doneFileScanMarked-=Je),this.showSuccessSnack("lang_auto_luu_thanh_cong"),this.saveStudentMarkEmit.emit(!0)):(this.scanningStatus.isSaving=!1,this.scanningStatus.isSavingFail=!0,this.showErrorSnack(null!==(i=n.message)&&void 0!==i?i:""))}))}uploadFileToCdn(e,n,i){return new Promise(a=>{this.drawImgOutToCanvas(e).then(r=>{var l;r?i?this.uploadApiService.uploadToCdnForFileScanError(r,null!==(l=this.examObj.hashId)&&void 0!==l?l:"").subscribe(c=>{var _,d;a(c&&1==c.success?{id:n,imgUrl:null!==(d=null===(_=c.data)||void 0===_?void 0:_.url)&&void 0!==d?d:""}:{id:n,imgUrl:""})}):this.uploadApiService.uploadToCdnForFileScanExamOffline(r).subscribe(c=>{var _,d;a(c&&1==c.success?{id:n,imgUrl:null!==(d=null===(_=c.data)||void 0===_?void 0:_.url)&&void 0!==d?d:""}:{id:n,imgUrl:""})}):a({id:n,imgUrl:""})})})}drawImgOutToCanvas(e){return new Promise(n=>{var i=document.createElement("canvas");i.width=e.naturalWidth,i.height=e.naturalHeight;const a=i.getContext("2d");null==a||a.drawImage(e,0,0,i.width,i.height),i.toBlob(r=>{let c=(new Date).getTime();var _=this.commonService.getRandomNumber(1e6,9999999);const d=new File([r],`azo_file_scan_${_}_${c}.jpeg`,{type:"image/jpeg"});n(d)},"image/jpeg",.9)})}replaceDigit(e,n){var i=e.toString(),a=4;for(n||(a=3);i.length<a;)i="0"+i;return i}convertStringToNumber(e){for(var n=e.split(","),i="",a=0,r=0;r<n.length;r++)""!=n[r]?i+=n[r]:a++;return""!=i&&a<=1?parseInt(i,10):-3}getScanFilePos(e){var n={version:"2.0"};return n.resultFilledPos=this.convertScanResult(e),JSON.stringify(n)}convertScanResult(e){let n=new Yo;return n.examId=this.convertTableAnswerToSmallTableAnswer(e.examId),n.studentId=this.convertTableAnswerToSmallTableAnswer(e.studentId),n.answerTable=this.convertTableAnswerToSmallTableAnswer(e.answerTable),n.toBase64String()}convertTableAnswerToSmallTableAnswer(e){let n=new Un;if(n.cols=e.cols,n.rows=e.rows,0==e.cols&&e.answers.length>0)return new Un;n.radius=e.radius,n.answers=[];let i=e.answers;for(var a=0;a<i.length;a++){let c=i[a],_=new zo;var r=Math.floor(c.center.x),l=Math.floor(c.center.y);_.position=16*Math.floor(r/256)+Math.floor(l/256),_.x=r%256,_.y=l%256,_.filledCols=128*(c.filled?1:0)+a%e.cols,_.rows=Math.floor(a/e.cols),n.answers.push(_)}return n}existStudentCodeAndExamId(e,n){var i=0;if(-3!=e&&-3!=n)for(var a=0;a<this.listMapStudentCodeAndExamId.length;a++)if(this.listMapStudentCodeAndExamId[a].studentCode==e&&this.listMapStudentCodeAndExamId[a].examId==n){i++;break}return i>0}getScanAnswerContent(e){return e?e.split(","):[]}showScanFalseFiles(){this.dialog.open(yf,{width:"80vw",data:this.uploadFileScanError}).afterClosed().subscribe(n=>{})}showStudentList(){this.openSelectFile=!1,this.showStudentMarkEmit.emit(!0)}askBeforeCloseWindow(e){return!this.scanningStatus.isSaving||(e.returnValue=!1)}loadingFileJs(){return this.loadingFileJS=!0,new Promise(e=>{this.commonService.loadScriptPromises([{source:"https://cdn.jsdelivr.net/gh/azota889/storage_public/azota_assets/imgsdk/v3/imgsdk.js?t=1910",name:"imgsdk.js"},{source:"https://cdn.jsdelivr.net/gh/azota889/storage_public/azota_assets/imgsdk/v3/imgsdk_loader.js?t=1810",name:"imgsdk_loader.js"}]).then(()=>(0,Oe.mG)(this,void 0,void 0,function*(){e(!0)}))})}ngOnChanges(){this.openSelectFile&&this.selectFileClick()}ngOnInit(){this.form=this.fb.group({fileScanner:new h.p4(""),fileScannerMobile:new h.p4("")}),this.openSelectFile&&this.selectFileClick(),this.isMobile=this.commonService.isMobileOrTable(),super.ngOnInit()}ngOnDestroy(){super.ngOnDestroy()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(h.QS),t.Y36(vt.v),t.Y36(Ot.$4),t.Y36(zn._),t.Y36(Mn.$),t.Y36(Xe.$),t.Y36(j.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-file-scan-offline-exam-new"]],viewQuery:function(e,n){if(1&e&&(t.Gf($g,5),t.Gf(Wg,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.fileInput=i.first),t.iGM(i=t.CRH())&&(n.fileInputMobile=i.first)}},hostBindings:function(e,n){1&e&&t.NdJ("beforeunload",function(a){return n.askBeforeCloseWindow(a)},!1,t.Jf7)},inputs:{openSelectFile:"openSelectFile",examObj:"examObj",loadedJs:"loadedJs",hasExamOffline:"hasExamOffline",tokenScan:"tokenScan",examOfflineMessage:"examOfflineMessage",backToLink:"backToLink"},outputs:{saveStudentMarkEmit:"saveStudentMarkEmit",showStudentMarkEmit:"showStudentMarkEmit",firstSuccessResultId:"firstSuccessResultId"},features:[t.qOj,t.TTD],decls:18,vars:9,consts:[[1,"absolute","h-full","w-full","bg-white","dark:bg-darkmode-600","top-0","left-0","z-50"],[1,"scan-file-body"],[1,"scan-file-content"],[3,"formGroup","hidden"],["type","file","formControlName","fileScanner","webkitdirectory","","multiple","",1,"form-control",3,"change"],["fileInput",""],["type","file","formControlName","fileScannerMobile","accept","image/*","multiple","",1,"form-control",3,"change"],["fileInputMobile",""],[1,"mx-auto","px-4"],[1,"grid","grid-cols-12","gap-2"],[1,"col-span-12","md:col-span-4","self-center"],["class","h5",4,"ngIf"],["class","flex items-center",4,"ngIf"],["class","items-center",4,"ngIf"],["class","col-span-12 md:col-span-8 self-center text-center",4,"ngIf"],["class","col-span-12 md:col-span-12 align-self-center text-center",4,"ngIf"],["class","col-span-12 md:col-span-8 self-center text-right",4,"ngIf"],[1,"h5"],[1,"flex","items-center"],[1,"h6"],["class","mb-1 mr-1","style","font-weight: 400;",4,"ngIf"],["style","font-size: 15px; font-weight: 550;",4,"ngIf"],["class","ml-2",4,"ngIf"],[1,"mb-1","mr-1",2,"font-weight","400"],["role","status",1,"spinner-border","spinner-border-sm"],[2,"font-size","15px","font-weight","550"],[1,"ml-2"],[1,"link__color","link__hover",3,"click"],[1,"mb-0",2,"font-size","14px","font-weight","400"],[2,"color","#DD0000","font-size","15px"],[1,"items-center"],["class","mb-0","style","font-size: 14px; font-weight: 400",4,"ngFor","ngForOf"],[1,"col-span-12","md:col-span-8","self-center","text-center"],[1,"mb-1",2,"font-size","14px"],["mat-raised-button","","class","btn-custom-file-scan","style","text-transform: none; margin-left: auto!important; margin-right: auto!important;",3,"click",4,"ngIf"],["mat-raised-button","",1,"btn-custom-file-scan",2,"text-transform","none","margin-left","auto!important","margin-right","auto!important","margin-top","0.75rem!important",3,"click"],["mat-raised-button","",1,"btn-custom-file-scan",2,"text-transform","none","margin-left","auto!important","margin-right","auto!important",3,"click"],[1,"col-span-12","md:col-span-12","align-self-center","text-center"],[1,"flex","flex-col","md:flex-row","mx-auto",2,"justify-content","center"],["class","mt-3 mr-3",4,"ngIf"],[1,"mt-3",3,"ngClass"],[1,"btn","btn-primary",2,"text-transform","none",3,"click"],[1,"mt-3","mr-3"],[1,"col-span-12","md:col-span-8","self-center","text-right"],[1,"inline-flex","w-full","items-center","justify-end"],["id","processFileScan"],["style","vertical-align: middle; margin-left: 30px; color: #2361ae",4,"ngIf"],["id","doneFileScan"],[2,"vertical-align","middle","margin-left","30px","color","#2361ae"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"input",4,5),t.NdJ("change",function(a){return n.selectFileDirectory(a)}),t.qZA(),t.TgZ(6,"input",6,7),t.NdJ("change",function(a){return n.selectFile(a)}),t.qZA()(),t.TgZ(8,"div",8)(9,"div",9)(10,"div",10),t.YNc(11,Kg,3,3,"p",11),t.YNc(12,rf,10,8,"div",12),t.YNc(13,lf,10,8,"div",12),t.YNc(14,_f,5,4,"div",13),t.qZA(),t.YNc(15,uf,8,7,"div",14),t.YNc(16,pf,10,10,"div",15),t.YNc(17,ff,5,1,"div",16),t.qZA()()()()()),2&e&&(t.xp6(3),t.Q6J("formGroup",n.form)("hidden",!0),t.xp6(8),t.Q6J("ngIf",n.loadingFileJS),t.xp6(1),t.Q6J("ngIf",n.isSelectedFile),t.xp6(1),t.Q6J("ngIf",n.uploadFileScanError.length>0),t.xp6(1),t.Q6J("ngIf",n.invalidDataCallMarkObjs.length>0),t.xp6(1),t.Q6J("ngIf",(n.scanningStatus.isSavingDone||n.scanningStatus.isSavingFail)&&!n.scanningStatus.isSaving&&!n.firstTimeScan),t.xp6(1),t.Q6J("ngIf",n.firstTimeScan),t.xp6(1),t.Q6J("ngIf",n.isSelectedFile&&!n.scanningStatus.isSavingDone&&!n.scanningStatus.isSavingFail))},dependencies:[O.mk,O.sg,O.O5,tn.lW,ge.Hw,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,oe.M,at.bT],styles:[Gi]}),o})(),yf=(()=>{class o extends mt.Q{constructor(e,n,i){super(e),this.commonService=e,this.dialogRef=n,this.data=i,this.isMobile=!1}getErrorCode(e){return"not_found_exam_id"==e?"lang_auto_khong_quet_duoc_ma_de":"not_found_student_code"==e?"lang_auto_khong_quet_duoc_so_bao_danh_hoc_sinh":"exist_exam_id_and_student_code"==e?"lang_auto_ma_de_ma_hoc_sinh_khong_ton_tai_dot":"process_scan_false"==e?"lang_auto_loi_trong_qua_tring_scan_khong_hien_thi_anh_ket_qua":""}processData(){this.data.forEach((e,n)=>{var i=document.getElementById("processFileScan"+n),a=document.getElementById("doneFileScan"+n);i&&a&&(e.img_in.width=.7*e.img_in.naturalWidth,e.img_in.style.height="auto",e.img_in.style.maxWidth="60%",e.img_in.classList.add("img-fluid"),i.appendChild(e.img_in),e.img_out&&(e.img_out.width=.7*e.img_in.naturalWidth,e.img_out.classList.add("img-fluid"),e.img_out.style.marginLeft=this.isMobile?"5px":"15px",e.img_out.style.display="inline",e.img_out.style.verticalAlign="middle"))})}onNoClick(){this.dialogRef.close(!1)}ngAfterViewInit(){var e=document.getElementById("processFileScan0");document.getElementById("doneFileScan0")&&e&&this.processData()}ngOnInit(){this.isMobile=this.commonService.isMobileOrTable(),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(j.so),t.Y36(j.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["scan-false-dialog-new"]],features:[t.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"box","w-full"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-5",2,"max-height","calc(100vh - 200px)","overflow-y","auto"],[1,"text-xl","font-medium","items-center","my-2"],["class","mt-2 mx-auto",4,"ngFor","ngForOf"],[1,"p-3","text-right"],[1,"btn","w-24","btn-secondary",3,"click"],[1,"mt-2","mx-auto"],["class","text-center",4,"ngIf"],[1,"text-center"],[1,"inline-flex","w-full","items-center"],[1,"w-full","border","border-slate-200/60","rounded","mx-auto",3,"id"],[3,"id"]],template:function(e,n){if(1&e&&(t.YNc(0,xf,1,0,"azt-loading-effect",0),t.YNc(1,wf,11,7,"ng-template",null,1,t.W1O)),2&e){const i=t.MAs(2);t.Q6J("ngIf",1==n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.sg,O.O5,te.Q,at.bT],styles:[Gi]}),o})(),kf=(()=>{class o extends mt.Q{constructor(e,n,i,a){super(e),this.commonService=e,this.permissionService=n,this.dialogRef=i,this.data=a}redirectToCreateOfflineTest(){var e,n,i,a,r;this.permissionService.hasFullPermission("exam",null===(e=this.data.examObj)||void 0===e?void 0:e.permissionObj)?(this.commonService.myNavigationWithQueryString(`/admin/testbank/action-online-offline/${null!==(n=this.data.examObj)&&void 0!==n&&n.categoryId?null===(i=this.data.examObj)||void 0===i?void 0:i.categoryId:0}/${null===(a=this.data.examObj)||void 0===a?void 0:a.hashId}`,"?backto="+encodeURIComponent(null!==(r=this.data.backToLink)&&void 0!==r?r:"")),this.dialogRef.close(!1)):this.showErrorSnack("lang_auto_ban_khong_co_quyen_tao_bai_thi_offline_cho_de_thi_nay")}onNoClick(){this.dialogRef.close(!1)}ngOnInit(){super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Xe.$),t.Y36(j.so),t.Y36(j.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["no-exam-offline-dialog"]],features:[t.qOj],decls:16,vars:13,consts:[[1,"mt-1","text-center"],[1,"h5"],[1,"mt-2"],["class","mt-1 text-center",4,"ngIf"],["align","end"],["mat-raised-button","","color","basic",3,"click"],[1,"h6",2,"font-size","13px","color","#ACACAC"],[1,"link__color","link__hover",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"mat-dialog-content")(1,"div",0)(2,"p",1),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.TgZ(5,"div",2)(6,"p"),t._uU(7),t.qZA()(),t.YNc(8,Tf,4,3,"div",3),t.ALo(9,"isDocxOnly"),t.YNc(10,Cf,7,6,"div",3),t.ALo(11,"isPdfOnly"),t.qZA(),t.TgZ(12,"mat-dialog-actions",4)(13,"button",5),t.NdJ("click",function(){return n.onNoClick()}),t._uU(14),t.ALo(15,"mytranslate"),t.qZA()()),2&e){let i,a;t.xp6(3),t.Oqu(t.lcZ(4,5,"lang_auto_cham_diem_thi_offline")),t.xp6(4),t.hij(" * ","lang_auto_note_use_case_file_scan_in_exam_offline"," "),t.xp6(1),t.Q6J("ngIf",t.lcZ(9,7,null!==(i=null==n.data.examObj?null:n.data.examObj.examType)&&void 0!==i?i:0)),t.xp6(2),t.Q6J("ngIf",t.lcZ(11,9,null!==(a=null==n.data.examObj?null:n.data.examObj.examType)&&void 0!==a?a:0)),t.xp6(4),t.Oqu(t.lcZ(15,11,"lang_auto_dong"))}},dependencies:[O.O5,tn.lW,j.xY,j.H8,at.bT,at.t5,at.yb],styles:[Gi]}),o})();var bi=b(35385),Go=b(24985),$i=b(33776),Of=b(80383);function Sf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",60),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.openDialogExamConfig("whoAllow"))}),t.O4$(),t.TgZ(1,"svg",12),t._UZ(2,"path",61)(3,"path",62),t.qZA(),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()}2&o&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"lang_auto_sua")," "))}function Ef(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",64)(1,"a",65),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.redirectToClassDetail(a))}),t._uU(2),t.qZA()()}if(2&o){const e=s.$implicit;t.xp6(1),t.s9C("matTooltip",null==e.classObj?null:e.classObj.name),t.xp6(1),t.hij(" ",null==e.classObj?null:e.classObj.name," ")}}function If(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Ef,3,2,"div",63),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.initData.studentsInClassResults)}}function Zf(o,s){1&o&&(t.TgZ(0,"div",66)(1,"a",67),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_auto_tat_ca_moi_nguoi")," "))}function Mf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",60),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.redirectToUpdateExam())}),t.O4$(),t.TgZ(1,"svg",12),t._UZ(2,"path",61)(3,"path",62),t.qZA(),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()}2&o&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"lang_auto_sua")," "))}function Pf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",68),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.openDialogExamDetail())}),t.O4$(),t.TgZ(1,"svg",69),t._UZ(2,"path",70)(3,"polyline",22)(4,"line",71)(5,"line",72)(6,"line",73),t.qZA(),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()}2&o&&(t.xp6(7),t.hij(" ",t.lcZ(8,1,"lang_auto_xem_chi_tiet")," "))}const wi=function(o){return{opacity:o}};function Lf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",30)(1,"h3",31),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"div",32)(5,"ul",33)(6,"li",34),t.ALo(7,"deletePermission"),t.TgZ(8,"a",35),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.openDeleteExam())}),t.O4$(),t.TgZ(9,"svg",12),t._UZ(10,"path",36)(11,"path",37)(12,"path",38)(13,"line",39)(14,"line",40),t.qZA(),t._uU(15),t.ALo(16,"mytranslate"),t.qZA()(),t.kcU(),t.TgZ(17,"li",34),t.ALo(18,"editPermission"),t.TgZ(19,"a",41),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.redirectToActionOnlOff())}),t.O4$(),t.TgZ(20,"svg",12),t._UZ(21,"path",42)(22,"circle",43),t.qZA(),t._uU(23),t.ALo(24,"mytranslate"),t.qZA()(),t.kcU(),t.TgZ(25,"li",34),t.ALo(26,"statisticalPermission"),t.TgZ(27,"a",41),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.redirectToStatistical())}),t.O4$(),t.TgZ(28,"svg",44),t._UZ(29,"path",45)(30,"path",46),t.qZA(),t._uU(31),t.ALo(32,"mytranslate"),t.qZA()(),t.kcU(),t.TgZ(33,"li",34),t.ALo(34,"viewPermission"),t.TgZ(35,"a",41),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.openVideoMonitor())}),t.O4$(),t.TgZ(36,"svg",12),t._UZ(37,"circle",47)(38,"circle",48)(39,"path",49)(40,"path",50),t.qZA(),t._uU(41),t.ALo(42,"mytranslate"),t.qZA()()()()(),t.kcU(),t.TgZ(43,"div",51)(44,"div",52)(45,"h3",31),t._uU(46),t.ALo(47,"mytranslate"),t.qZA(),t.YNc(48,Sf,6,3,"button",53),t.ALo(49,"editPermission"),t.ALo(50,"configPermission"),t.qZA(),t.TgZ(51,"div",54),t.YNc(52,If,2,1,"ng-container",55),t.YNc(53,Zf,4,3,"ng-template",null,56,t.W1O),t.qZA()(),t.TgZ(55,"div",57)(56,"div",52)(57,"h3",31),t._uU(58),t.ALo(59,"mytranslate"),t.qZA(),t.YNc(60,Mf,6,3,"button",53),t.ALo(61,"editPermission"),t.qZA(),t.TgZ(62,"div",58),t.YNc(63,Pf,9,3,"button",59),t.ALo(64,"viewPermission"),t.qZA()()}if(2&o){const e=t.MAs(54),n=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,16,"lang_auto_menu")," "),t.xp6(4),t.Q6J("ngStyle",t.VKq(54,wi,t.xi3(7,18,null==n.initData.examObj?null:n.initData.examObj.permissionObj,"exam")?"1":"0.5")),t.xp6(9),t.hij(" ",t.lcZ(16,21,"lang_auto_xoa")," "),t.xp6(2),t.Q6J("ngStyle",t.VKq(56,wi,t.xi3(18,23,null==n.initData.examObj?null:n.initData.examObj.permissionObj,"exam")?"1":"0.5")),t.xp6(6),t.hij(" ",t.lcZ(24,26,"lang_auto_cai_dat")," "),t.xp6(2),t.Q6J("ngStyle",t.VKq(58,wi,t.xi3(26,28,null==n.initData.examObj?null:n.initData.examObj.permissionObj,"exam")?"1":"0.5")),t.xp6(6),t.hij(" ",t.lcZ(32,31,"lang_auto_thong_ke")," "),t.xp6(2),t.Q6J("ngStyle",t.VKq(60,wi,t.xi3(34,33,null==n.initData.examObj?null:n.initData.examObj.permissionObj,"exam")?"1":"0.5")),t.xp6(8),t.hij(" ",t.lcZ(42,36,"lang_auto_giam_sat_nang_cao")," "),t.xp6(5),t.hij(" ",t.lcZ(47,38,"lang_auto_giao_cho")," "),t.xp6(2),t.Q6J("ngIf",t.xi3(49,40,null==n.initData.examObj?null:n.initData.examObj.permissionObj,"exam")||t.xi3(50,43,null==n.initData.examObj?null:n.initData.examObj.permissionObj,"exam")),t.xp6(4),t.Q6J("ngIf",2==(null==n.initData.examObj?null:n.initData.examObj.whoAllow))("ngIfElse",e),t.xp6(6),t.hij(" ",t.lcZ(59,46,"lang_auto_noi_dung")," "),t.xp6(2),t.Q6J("ngIf",t.xi3(61,48,null==n.initData.examObj?null:n.initData.examObj.permissionObj,"exam")),t.xp6(3),t.Q6J("ngIf",t.xi3(64,51,null==n.initData.examObj?null:n.initData.examObj.permissionObj,"exam"))}}function Nf(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",74),t._UZ(2,"polyline",75),t.qZA()())}function Df(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",74),t._UZ(2,"polyline",76),t.qZA()())}let jf=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l){super(e),this.commonService=e,this.dialog=n,this.permissionService=i,this.monitorService=a,this.baseApiService=r,this.fireStoreService=l,this.initData={studentsNotInClassResults:[]},this.userList=[],this.reloadApi=new t.vpe,this.isShowActions=!0,this.linkExam="",this.nextPage="",this.examDetailDialog={obj:{},curCateId:-1,isOnLib:-1,isShow:!1},this.loadingObj={},this.allQuestionObjs=[],this.dataMixQuestionObjs=[],this.offlineMixQuestionObjs=[],this.isLoadingLib=!1,this.checkFullDescription=!1}toggleShowActions(){this.isShowActions=!this.isShowActions}copyLinkToClipboard(){return this.linkExam}showCopySuccess(){this.showSuccessSnack("lang_auto_sao_chep_thanh_cong")}openDialogWaring(e){this.commonService.getTranslate(e).subscribe(n=>{this.dialog.open(bi._,{data:{isShow:!0,content:n}})})}openDeleteExam(){var e;this.permissionService.hasDeletePermission("exam",null===(e=this.initData.examObj)||void 0===e?void 0:e.permissionObj)?this.dialog.open($i.h,{data:{obj:this.initData.examObj,type:2,isShow:!0}}).afterClosed().subscribe(r=>{r&&this.commonService.myNavigation("/admin/testbank/document-management/0/0/1")}):this.openDialogWaring("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")}openDialogExamConfig(e){var n;this.dialog.open(Ii.Y,{data:{hashId:null===(n=this.initData.examObj)||void 0===n?void 0:n.hashId}}).afterClosed().subscribe(a=>{a&&(this.initData.examObj=a,this.reloadApi.emit())})}openDialogExamDetail(){var e,n,i;this.permissionService.hasViewPermission("exam",null===(e=this.initData.examObj)||void 0===e?void 0:e.permissionObj)?(this.examDetailDialog={obj:this.initData.examObj,curCateId:null!==(n=this.initData.examObj)&&void 0!==n&&n.categoryId?null===(i=this.initData.examObj)||void 0===i?void 0:i.categoryId:0,isOnLib:0,isShow:!0},this.dialog.open(Go.l,{width:"800px",maxWidth:"90vw",enterAnimationDuration:"0ms",exitAnimationDuration:"0ms",data:this.examDetailDialog}).afterClosed().subscribe(l=>{})):this.openDialogWaring("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")}redirectToActionOnlOff(){var e,n,i,a,r,l,c,_,d,m,p;if(this.permissionService.hasEditPermission("exam",null===(e=this.initData.examObj)||void 0===e?void 0:e.permissionObj)){let C=`/admin/testbank/exam-results-list/${null!==(i=null===(n=this.initData.examObj)||void 0===n?void 0:n.categoryId)&&void 0!==i?i:0}/${null===(a=this.initData.examObj)||void 0===a?void 0:a.id}/0`,A=null!==(r=this.commonService.getMyQueryParam("backto"))&&void 0!==r?r:"";A&&A.includes("shareType")&&(C=`/admin/testbank/exam-results-list/${null!==(c=null===(l=this.initData.examObj)||void 0===l?void 0:l.categoryId)&&void 0!==c?c:0}/${null===(_=this.initData.examObj)||void 0===_?void 0:_.id}/0?backto=`+encodeURIComponent(encodeURIComponent(A))),this.myNavigationWithQueryString(`/admin/testbank/action-online-offline/${null!==(m=null===(d=this.initData.examObj)||void 0===d?void 0:d.categoryId)&&void 0!==m?m:0}/${null===(p=this.initData.examObj)||void 0===p?void 0:p.hashId}`,`?backto=${encodeURIComponent(C)}`)}else this.openDialogWaring("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")}redirectConfigExamOnline(){var e,n,i,a,r,l,c,_,d,m,p;if(this.permissionService.hasEditPermission("exam",null===(e=this.initData.examObj)||void 0===e?void 0:e.permissionObj)){let C=`/admin/testbank/exam-results-list/${null!==(i=null===(n=this.initData.examObj)||void 0===n?void 0:n.categoryId)&&void 0!==i?i:0}/${null===(a=this.initData.examObj)||void 0===a?void 0:a.id}/0`,A=null!==(r=this.commonService.getMyQueryParam("backto"))&&void 0!==r?r:"";A&&A.includes("shareType")&&(C=`/admin/testbank/exam-results-list/${null!==(c=null===(l=this.initData.examObj)||void 0===l?void 0:l.categoryId)&&void 0!==c?c:0}/${null===(_=this.initData.examObj)||void 0===_?void 0:_.id}/0?backto=`+encodeURIComponent(encodeURIComponent(A))),this.myNavigationWithQueryString(`/admin/testbank/config-exam-online/${null!==(m=null===(d=this.initData.examObj)||void 0===d?void 0:d.categoryId)&&void 0!==m?m:0}/${null===(p=this.initData.examObj)||void 0===p?void 0:p.hashId}`,`?backto=${encodeURIComponent(C)}`)}else this.openDialogWaring("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")}redirectToStatistical(){var e,n,i,a,r,l,c,_,d,m;if(this.permissionService.hasStatisticalPermission("exam",null===(e=this.initData.examObj)||void 0===e?void 0:e.permissionObj)){let w=`/admin/testbank/exam-results-list/${null!==(i=null===(n=this.initData.examObj)||void 0===n?void 0:n.categoryId)&&void 0!==i?i:0}/${null===(a=this.initData.examObj)||void 0===a?void 0:a.id}/0`,C=null!==(r=this.commonService.getMyQueryParam("backto"))&&void 0!==r?r:"";C&&C.includes("shareType")&&(w=`/admin/testbank/exam-results-list/${null!==(c=null===(l=this.initData.examObj)||void 0===l?void 0:l.categoryId)&&void 0!==c?c:0}/${null===(_=this.initData.examObj)||void 0===_?void 0:_.id}/0?backto=`+encodeURIComponent(encodeURIComponent(C))),this.commonService.myNavigationWithQueryString(`/admin/testbank/statistic/${null!==(d=this.initData.examObj)&&void 0!==d&&d.categoryId?this.initData.examObj.categoryId:0}/${null===(m=this.initData.examObj)||void 0===m?void 0:m.id}`,"?backto="+encodeURIComponent(w))}else this.openDialogWaring("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")}openVideoMonitor(){var e,n,i,a,r,l;if(3!=(null===(e=this.initData.examObj)||void 0===e?void 0:e.autoMonitor)&&(this.permissionService.hasFullPermission("exam",null===(n=this.initData.examObj)||void 0===n?void 0:n.permissionObj)&&this.permissionService.hasViewPermission("exam",null===(i=this.initData.examObj)||void 0===i?void 0:i.permissionObj)?this.openDialogWaring("lang_auto_chua_bat_giam_sat_moi"):this.openDialogWaring("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")),3==(null===(a=this.initData.examObj)||void 0===a?void 0:a.autoMonitor)&&this.permissionService.hasViewPermission("exam",this.initData.examObj.permissionObj)&&this.monitorService.checkValidForSetUpMonitor()){var _=this.baseApiService.getUserObj();if("undefined"!=typeof aztExam&&aztExam&&(aztExam.ver=this.monitorService.getMNoteVer(),aztExam.showMonitorTeacher)){var d={user:{token:_.rememberToken,userid:_.id,username:_.fullName},config:{domainApi:so.N.base_api,urlGetPublicForLive:"s3space/get_public_upload_url_for_live",urlGetListFileForLive:"S3space/get_list_files_for_live",urlGetTokenForLive:"s3space/get_token_for_live",urlExamResultGetLastExamResultOfStudentId:"ExamLivestream/GetLastExamResultOfStudentId"},roomid:null===(r=this.initData.examObj)||void 0===r?void 0:r.hashId,examid:null===(l=this.initData.examObj)||void 0===l?void 0:l.id,userlist:this.userList,examconfig:this.initData.examObj,firebaseApp:this.fireStoreService,filetypeStr:this.initData.fileTypeStr};aztExam.showMonitorTeacher(d)}}}redirectToClassDetail(e){var n,i,a,r,l,c,_,d;let m=`/admin/testbank/exam-results-list/${null!==(i=null===(n=this.initData.examObj)||void 0===n?void 0:n.categoryId)&&void 0!==i?i:0}/${null===(a=this.initData.examObj)||void 0===a?void 0:a.id}/0`,p=null!==(r=this.commonService.getMyQueryParam("backto"))&&void 0!==r?r:"";p&&p.includes("shareType")&&(m=`/admin/testbank/exam-results-list/${null!==(c=null===(l=this.initData.examObj)||void 0===l?void 0:l.categoryId)&&void 0!==c?c:0}/${null===(_=this.initData.examObj)||void 0===_?void 0:_.id}/0?backto=`+encodeURIComponent(encodeURIComponent(p))),this.myNavigationWithQueryString(`/admin/student/class-details/${null===(d=e.classObj)||void 0===d?void 0:d.id}`,`?backto=${m}`)}toggleFullDescription(){this.checkFullDescription=!this.checkFullDescription}redirectToUpdateExam(){var e,n,i,a,r,l,c,_,d,m;let p=`/admin/testbank/exam-results-list/${null!==(n=null===(e=this.initData.examObj)||void 0===e?void 0:e.categoryId)&&void 0!==n?n:0}/${null===(i=this.initData.examObj)||void 0===i?void 0:i.id}/0`,w=null!==(a=this.commonService.getMyQueryParam("backto"))&&void 0!==a?a:"";w&&w.includes("shareType")&&(p=`/admin/testbank/exam-results-list/${null!==(l=null===(r=this.initData.examObj)||void 0===r?void 0:r.categoryId)&&void 0!==l?l:0}/${null===(c=this.initData.examObj)||void 0===c?void 0:c.id}/0?backto=`+encodeURIComponent(encodeURIComponent(w))),this.myNavigationWithQueryString(`/admin/testbank/update-exam/${null!==(d=null===(_=this.initData.examObj)||void 0===_?void 0:_.categoryId)&&void 0!==d?d:0}/${null===(m=this.initData.examObj)||void 0===m?void 0:m.id}`,`?backto=${encodeURIComponent(p)}`)}closeExamDetail(e){this.examDetailDialog={obj:void 0,curCateId:-1,isOnLib:-1,isShow:!1}}ngOnInit(){var e;let n=this.commonService.getCurrentDomain();this.linkExam=`${n}/de-thi/${null===(e=this.initData.examObj)||void 0===e?void 0:e.hashId}`,super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(j.uw),t.Y36(Xe.$),t.Y36(Uo.M),t.Y36(zn._),t.Y36(Of.C))},o.\u0275cmp=t.Xpm({type:o,selectors:[["menu-online-test"]],inputs:{initData:"initData",userList:"userList"},outputs:{reloadApi:"reloadApi"},features:[t.qOj],decls:48,vars:32,consts:[[1,"box","p-3","h-full","lg:h-auto","mb-10",2,"min-height","80vh"],[1,"document-info"],[1,"flex","md:items-center","flex-col","md:flex-row"],[1,"text-md","font-medium","truncate","mr-auto","mt-2",2,"max-width","60%",3,"matTooltip","isDisabledTooltip","matTooltipDisabled"],["c","isDisabled"],[1,"w-auto","flex","mt-2"],[1,"btn","btn-sm","btn-outline-primary",3,"cdkCopyToClipboard","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-file","w-4","h-4","mr-2"],["x","9","y","9","width","13","height","13","rx","2","ry","2"],["d","M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"],[1,"pl-2","ml-2",3,"fileName","linkUrl"],[1,"flex","items-center","mt-2"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["x","3","y","4","width","18","height","18","rx","2","ry","2"],["x1","16","y1","2","x2","16","y2","6"],["x1","8","y1","2","x2","8","y2","6"],["x1","3","y1","10","x2","21","y2","10"],[1,"text-sm"],["d","M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"],["cx","12","cy","7","r","4"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-layers","w-4","h-4","mr-2"],["d","M4 13.5V4a2 2 0 0 1 2-2h8.5L20 7.5V20a2 2 0 0 1-2 2h-5.5"],["points","14 2 14 8 20 8"],["d","M10.42 12.61a2.1 2.1 0 1 1 2.97 2.97L7.95 21 4 22l.99-3.95 5.43-5.44Z"],[1,"flex","mt-2"],[3,"type","typeObj","id","permissionObj"],[3,"ngIf"],[1,"mt-2","text-center"],[1,"btn","btn-sm","btn-transparent","btn-outline-secondary",3,"click"],[4,"ngIf"],[1,"azt-document-menu","mt-4"],[1,"text-md","font-bold"],[1,"dropdown-menu","show","relative","w-full","mt-2"],[1,"dropdown-content","bg-slate-100","dark:bg-darkmode-600"],[3,"ngStyle"],[1,"dropdown-item","text-danger",3,"click"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],[1,"dropdown-item",3,"click"],["d","M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"],["cx","12","cy","12","r","3"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2","lucide"],["d","M3 3v18h18"],["d","m19 9-5 5-4-4-3 3"],["cx","12","cy","10","r","8"],["cx","12","cy","10","r","3"],["d","M7 22h10"],["d","M12 22v-4"],[1,"azt-document-who","mt-4"],[1,"flex","items-center"],["class","btn btn-outline-primary btn-sm btn-transparent ml-auto",3,"click",4,"ngIf"],[1,"grid","grid-cols-12","gap-3","rounded-md","mt-1"],[4,"ngIf","ngIfElse"],["noClassroom",""],[1,"azt-document-content","mt-4"],[1,"mt-2"],["class","btn-text-primary font-medium",3,"click",4,"ngIf"],[1,"btn","btn-outline-primary","btn-sm","btn-transparent","ml-auto",3,"click"],["d","M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"],["d","M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"],["class","col-span-4 2lg:col-span-3",4,"ngFor","ngForOf"],[1,"col-span-4","2lg:col-span-3"],[1,"btn","btn-outline-secondary","block","truncate","w-full",3,"matTooltip","click"],[1,"col-span-12","md:col-span-6"],[1,"btn","btn-outline-secondary","block","cursor-default","w-full"],[1,"btn-text-primary","font-medium",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["x1","16","y1","13","x2","8","y2","13"],["x1","16","y1","17","x2","8","y2","17"],["x1","10","y1","9","x2","8","y2","9"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-5","h-5"],["points","18 15 12 9 6 15"],["points","6 9 12 15 18 9"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3,4),t._uU(5),t.qZA(),t.TgZ(6,"div",5)(7,"button",6),t.NdJ("click",function(){return n.showCopySuccess()}),t.O4$(),t.TgZ(8,"svg",7),t._UZ(9,"rect",8)(10,"path",9),t.qZA(),t._uU(11),t.ALo(12,"mytranslate"),t.qZA(),t.kcU(),t._UZ(13,"azt-download-qr-code",10),t.qZA()(),t.TgZ(14,"div",11),t.O4$(),t.TgZ(15,"svg",12),t._UZ(16,"rect",13)(17,"line",14)(18,"line",15)(19,"line",16),t.qZA(),t.kcU(),t.TgZ(20,"span",17),t._uU(21),t.ALo(22,"mytranslate"),t.ALo(23,"date"),t.qZA()(),t.TgZ(24,"div",11),t.O4$(),t.TgZ(25,"svg",12),t._UZ(26,"path",18)(27,"circle",19),t.qZA(),t.kcU(),t.TgZ(28,"span",17),t._uU(29),t.ALo(30,"mytranslate"),t.qZA()(),t.TgZ(31,"div",11),t.O4$(),t.TgZ(32,"svg",20),t._UZ(33,"path",21)(34,"polyline",22)(35,"path",23),t.qZA(),t.kcU(),t.TgZ(36,"span",17),t._uU(37),t.ALo(38,"mytranslate"),t.ALo(39,"number"),t.qZA()(),t.TgZ(40,"div",24),t._UZ(41,"azt-share",25),t.qZA()(),t.YNc(42,Lf,65,62,"ng-template",26),t.TgZ(43,"div",27)(44,"button",28),t.NdJ("click",function(){return n.toggleShowActions()}),t.YNc(45,Nf,3,0,"span",29),t.YNc(46,Df,3,0,"span",29),t.qZA()()(),t._UZ(47,"azt-status-loading-effect")),2&e){const i=t.MAs(4);t.xp6(3),t.s9C("matTooltip",null==n.initData.examObj?null:n.initData.examObj.name),t.s9C("matTooltip",null==n.initData.examObj?null:n.initData.examObj.name),t.Q6J("isDisabledTooltip",!1)("matTooltipDisabled",i.isDisabled),t.xp6(2),t.hij(" ",null==n.initData.examObj?null:n.initData.examObj.name," "),t.xp6(2),t.Q6J("cdkCopyToClipboard",n.copyLinkToClipboard()),t.xp6(4),t.hij(" ",t.lcZ(12,19,"lang_auto_copy_link")," "),t.xp6(2),t.Q6J("fileName","azota_exam_qrcode_"+(null==n.initData.examObj?null:n.initData.examObj.hashId))("linkUrl",n.copyLinkToClipboard()),t.xp6(8),t.hij(" ",t.lcZ(22,21,"lang_testbank_tested_list_date_create")+": "+t.xi3(23,23,null==n.initData.examObj?null:n.initData.examObj.createdAt,"dd/MM/yyyy HH:mm")," "),t.xp6(8),t.hij(" ",t.lcZ(30,26,"lang_auto_nguoi_tao")+": "+(null==n.initData.examCreatorObj?null:n.initData.examCreatorObj.fullName)," "),t.xp6(8),t.hij(" ",t.lcZ(38,28,"lang_testbank_tested_list_number_quizzes")+": "+(n.initData.totalAttended?n.initData.totalAttended:t.lcZ(39,30,0))," "),t.xp6(4),t.Q6J("type",3)("typeObj","EXAM")("id",null==n.initData.examObj?null:n.initData.examObj.id)("permissionObj",null==n.initData.examObj?null:n.initData.examObj.permissionObj),t.xp6(1),t.Q6J("ngIf",n.isShowActions),t.xp6(3),t.Q6J("ngIf",n.isShowActions),t.xp6(1),t.Q6J("ngIf",!n.isShowActions)}},dependencies:[O.sg,O.O5,O.PC,Ln.i3,Wt.gM,ci.I,Yi.o,mn.G,Cn.Q,O.JJ,O.uU,at.bT,at.BU,at.vL,at.Pz,at.El,at._W],encapsulation:2}),o})();var qf=b(10731),Ti=b(90893);function Qf(o,s){1&o&&(t.TgZ(0,"div",3)(1,"div",4)(2,"span",5),t._uU(3,"Loading..."),t.qZA()()())}function Uf(o,s){if(1&o&&(t.TgZ(0,"div",14)(1,"button",15),t._uU(2),t.qZA()()),2&o){const e=s.$implicit,n=s.index;t.xp6(2),t.hij(" ",n+1+"-"+(null==e.answerResultParse?null:e.answerResultParse[0])," ")}}function Ff(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",6)(1,"span",7),t._uU(2),t.ALo(3,"mytranslate"),t.ALo(4,"formatOfflineExamHashIdToNumber"),t.qZA()(),t.TgZ(5,"div",8)(6,"p",9),t._uU(7),t.ALo(8,"mytranslate"),t.qZA(),t.TgZ(9,"div",10),t.YNc(10,Uf,3,1,"div",11),t.qZA()(),t.TgZ(11,"div",12)(12,"button",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeDialog())}),t._uU(13),t.ALo(14,"mytranslate"),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(2),t.AsE(" ",t.lcZ(3,5,"lang_auto_ma_de"),": ",t.xi3(4,7,e.offlineData.hashId,3)," "),t.xp6(5),t.hij(" ",t.lcZ(8,10,"lang_auto_bang_dap_an")," "),t.xp6(3),t.Q6J("ngForOf",e.questionObjs),t.xp6(3),t.hij(" ",t.lcZ(14,12,"lang_auto_dong")," ")}}let Rf=(()=>{class o extends mt.Q{constructor(e,n,i,a,r){super(e),this.commonService=e,this.offlineMixquestionService=n,this.customQuestionAnswerConfig=i,this.dialogRef=a,this.data=r,this.offlineData={},this.questionObjs=[],this.offlineData=r.offlineItem}closeDialog(){this.dialogRef.close()}getData(){this.initStatusObj(),this.subscriptions.add(this.offlineMixquestionService.apiOfflineMixquestionSearchObjGet(this.offlineData.examHashId,this.offlineData.hashId,1).subscribe(e=>{var n,i;if(1===e.success){let a=this.commonService.castJsonToClassObjs(qf.x,JSON.stringify(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.questionObjs));this.questionObjs=this.customQuestionAnswerConfig.changeQuestionContent(null!=a?a:[],!1),this.successStatusObj()}else this.errorStatusObj(null!==(i=e.message)&&void 0!==i?i:"none",!0)}))}ngOnInit(){this.getData()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Ot.cP),t.Y36(Ti.U),t.Y36(j.so,8),t.Y36(j.WI,8))},o.\u0275cmp=t.Xpm({type:o,selectors:[["preview-offline-exam"]],features:[t.qOj],decls:4,vars:2,consts:[[1,"box","py-4","px-4"],["class","loading",4,"ngIf","ngIfElse"],["doneLoading",""],[1,"loading"],["role","status",1,"spinner-border","text-secondary"],[1,"sr-only"],[1,"box","inline-block","p-2","text-center","border","border-slate-200","dark:border-darkmode-400"],[1,"text-md","font-medium"],[1,"border","border-slate-200","dark:border-darkmode-400","p-3","mt-4","overflow-auto",2,"max-height","50vh"],[1,"text-md"],[1,"grid","grid-cols-12","gap-3","mt-3"],["class","col-span-3 md:col-span-2 xl:col-span-1",4,"ngFor","ngForOf"],[1,"text-right","mt-4"],[1,"btn","btn-outline-secondary","w-24",3,"click"],[1,"col-span-3","md:col-span-2","xl:col-span-1"],[1,"btn","btn-secondary","btn-sm","w-12"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t.YNc(1,Qf,4,0,"div",1),t.YNc(2,Ff,15,14,"ng-template",null,2,t.W1O),t.qZA()),2&e){const i=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.sg,O.O5,at.bT,at.q7],encapsulation:2}),o})();function Bf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",38),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.openDeleteExam())}),t.O4$(),t.TgZ(1,"svg",5),t._UZ(2,"path",39)(3,"path",40)(4,"path",41)(5,"line",42)(6,"line",43),t.qZA(),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()}2&o&&(t.xp6(7),t.hij(" ",t.lcZ(8,1,"lang_auto_xoa")," "))}function Jf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",44),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.redirectToSettingExamOffline())}),t.O4$(),t.TgZ(1,"svg",5),t._UZ(2,"path",45)(3,"circle",46),t.qZA(),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()}2&o&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"lang_auto_cai_dat")," "))}function Hf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",44),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.redirectToStatistical())}),t.O4$(),t.TgZ(1,"svg",47),t._UZ(2,"path",48)(3,"path",49),t.qZA(),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()}2&o&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"lang_auto_thong_ke")," "))}function zf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.openDialogExamConfig("whoAllow"))}),t.O4$(),t.TgZ(1,"svg",5),t._UZ(2,"path",51)(3,"path",52),t.qZA(),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()}2&o&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"lang_auto_sua")," "))}function Yf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",54)(1,"a",55),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.redirectToClassDetail(a))}),t._uU(2),t.qZA()()}if(2&o){const e=s.$implicit;t.xp6(1),t.s9C("matTooltip",null==e.classObj?null:e.classObj.name),t.xp6(1),t.hij(" ",null==e.classObj?null:e.classObj.name," ")}}function Gf(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Yf,3,2,"div",53),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.initData.studentsInClassResults)}}function $f(o,s){1&o&&(t.TgZ(0,"div",56)(1,"a",57),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_auto_tat_ca_moi_nguoi")," "))}function Wf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.redirectToUpdateExam())}),t.O4$(),t.TgZ(1,"svg",5),t._UZ(2,"path",51)(3,"path",52),t.qZA(),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()}2&o&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"lang_auto_sua")," "))}function Kf(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",59)(1,"button",60),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.openDialogPreview(a))}),t.O4$(),t.TgZ(2,"svg",61),t._UZ(3,"path",62)(4,"polyline",15)(5,"line",63)(6,"line",64)(7,"line",65),t.qZA(),t._uU(8),t.ALo(9,"mytranslate"),t.ALo(10,"formatOfflineExamHashIdToNumber"),t.qZA()()}if(2&o){const e=s.$implicit;t.xp6(8),t.AsE(" ",t.lcZ(9,2,"lang_auto_ma_de")," ",t.xi3(10,4,e.hashId,3)," ")}}function Vf(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Kf,11,7,"div",58),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.initData.offlineMixQuestionObjs)}}function Xf(o,s){}function t1(o,s){if(1&o&&(t.TgZ(0,"div",24)(1,"h3",25),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"div",26)(5,"ul",27)(6,"li"),t.YNc(7,Bf,9,3,"a",28),t.ALo(8,"deletePermission"),t.qZA(),t.TgZ(9,"li"),t.YNc(10,Jf,6,3,"a",29),t.ALo(11,"editPermission"),t.qZA(),t.TgZ(12,"li"),t.YNc(13,Hf,6,3,"a",29),t.ALo(14,"statisticalPermission"),t.qZA()()()(),t.TgZ(15,"div",30)(16,"div",2)(17,"h3",25),t._uU(18),t.ALo(19,"mytranslate"),t.qZA(),t.YNc(20,zf,6,3,"button",31),t.ALo(21,"editPermission"),t.ALo(22,"configPermission"),t.qZA(),t.TgZ(23,"div",32),t.YNc(24,Gf,2,1,"ng-container",33),t.YNc(25,$f,4,3,"ng-template",null,34,t.W1O),t.qZA()(),t.TgZ(27,"div",35)(28,"div",2)(29,"h3",25),t._uU(30),t.ALo(31,"mytranslate"),t.qZA(),t.YNc(32,Wf,6,3,"button",31),t.ALo(33,"editPermission"),t.qZA(),t.TgZ(34,"div",36),t.YNc(35,Vf,2,1,"ng-container",33),t.YNc(36,Xf,0,0,"ng-template",null,37,t.W1O),t.qZA()()),2&o){const e=t.MAs(26),n=t.MAs(37),i=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,12,"lang_auto_menu")," "),t.xp6(5),t.Q6J("ngIf",t.xi3(8,14,null==i.initData.examObj?null:i.initData.examObj.permissionObj,"exam")),t.xp6(3),t.Q6J("ngIf",t.xi3(11,17,null==i.initData.examObj?null:i.initData.examObj.permissionObj,"exam")),t.xp6(3),t.Q6J("ngIf",t.xi3(14,20,null==i.initData.examObj?null:i.initData.examObj.permissionObj,"exam")),t.xp6(5),t.hij(" ",t.lcZ(19,23,"lang_auto_giao_cho")," "),t.xp6(2),t.Q6J("ngIf",t.xi3(21,25,null==i.initData.examObj?null:i.initData.examObj.permissionObj,"exam")||t.xi3(22,28,null==i.initData.examObj?null:i.initData.examObj.permissionObj,"exam")),t.xp6(4),t.Q6J("ngIf",2==(null==i.initData.examObj?null:i.initData.examObj.whoAllow))("ngIfElse",e),t.xp6(6),t.hij(" ",t.lcZ(31,31,"lang_auto_noi_dung")," "),t.xp6(2),t.Q6J("ngIf",t.xi3(33,33,null==i.initData.examObj?null:i.initData.examObj.permissionObj,"exam")),t.xp6(3),t.Q6J("ngIf",null==i.initData.offlineMixQuestionObjs?null:i.initData.offlineMixQuestionObjs.length)("ngIfElse",n)}}function e1(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",66),t._UZ(2,"polyline",67),t.qZA()())}function n1(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",66),t._UZ(2,"polyline",68),t.qZA()())}function i1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"azt-preview-exam",69),t.NdJ("closeDialog",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.closeDialogPreviewExam(i))}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("data",e.examDetailDialog)}}let o1=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c){super(e),this.commonService=e,this.dialog=n,this.offlineMixquestionService=i,this.zipdataService=a,this.answerSheetHelper=r,this.printAnswersheetService=l,this.permissionService=c,this.initData={studentsNotInClassResults:[]},this.reloadApi=new t.vpe,this.examDetailDialog={obj:{},curCateId:-1,isOnLib:-1,isShow:!1},this.dataDeleteDialog={obj:{},type:0,isShow:!1},this.linkExam="",this.isShowActions=!0}toggleShowActions(){this.isShowActions=!this.isShowActions}openDialogExamConfig(e){var n;this.dialog.open(Ii.Y,{data:{hashId:null===(n=this.initData.examObj)||void 0===n?void 0:n.hashId}}).afterClosed().subscribe(a=>{a&&(this.initData.examObj=a,this.reloadApi.emit())})}openDialogPreview(e){this.dialog.open(Rf,{data:{offlineItem:e}})}openDialogWaring(e){this.commonService.getTranslate(e).subscribe(n=>{this.dialog.open(bi._,{data:{isShow:!0,content:n}})})}closeDialogPreviewExam(e){this.examDetailDialog={obj:{},isShow:!1}}openDeleteExam(){var e;this.permissionService.hasViewPermission("exam",null===(e=this.initData.examObj)||void 0===e?void 0:e.permissionObj)?this.dataDeleteDialog={obj:this.initData.examObj,type:2,isShow:!0}:this.commonService.getTranslate("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay").subscribe(i=>{this.openDialogWaring("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")})}closeDeleteExam(e){e?(this.dataDeleteDialog={obj:{},type:0,isShow:!1},this.commonService.myNavigation("/admin/testbank/document-management/0/0/1")):this.dataDeleteDialog={obj:{},type:0,isShow:!1}}redirectToSettingExamOffline(){var e,n,i,a,r,l,c,_,d,m,p;if(this.permissionService.hasEditPermission("exam",null===(e=this.initData.examObj)||void 0===e?void 0:e.permissionObj)){let C=`/admin/testbank/exam-results-list/${null!==(i=null===(n=this.initData.examObj)||void 0===n?void 0:n.categoryId)&&void 0!==i?i:0}/${null===(a=this.initData.examObj)||void 0===a?void 0:a.id}/0`,A=null!==(r=this.commonService.getMyQueryParam("backto"))&&void 0!==r?r:"";A&&A.includes("shareType")&&(C=`/admin/testbank/exam-results-list/${null!==(c=null===(l=this.initData.examObj)||void 0===l?void 0:l.categoryId)&&void 0!==c?c:0}/${null===(_=this.initData.examObj)||void 0===_?void 0:_.id}/0?backto=`+encodeURIComponent(encodeURIComponent(A))),this.myNavigationWithQueryString(`/admin/testbank/config-exam-offline/${null!==(m=null===(d=this.initData.examObj)||void 0===d?void 0:d.categoryId)&&void 0!==m?m:0}/${null===(p=this.initData.examObj)||void 0===p?void 0:p.hashId}`,`?backto=${encodeURIComponent(C)}`)}else this.openDialogWaring("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")}redirectToStatistical(){var e,n,i,a,r,l,c,_,d,m;if(this.permissionService.hasStatisticalPermission("exam",null===(e=this.initData.examObj)||void 0===e?void 0:e.permissionObj)){let w=`/admin/testbank/exam-results-list/${null!==(i=null===(n=this.initData.examObj)||void 0===n?void 0:n.categoryId)&&void 0!==i?i:0}/${null===(a=this.initData.examObj)||void 0===a?void 0:a.id}/0`,C=null!==(r=this.commonService.getMyQueryParam("backto"))&&void 0!==r?r:"";C&&C.includes("shareType")&&(w=`/admin/testbank/exam-results-list/${null!==(c=null===(l=this.initData.examObj)||void 0===l?void 0:l.categoryId)&&void 0!==c?c:0}/${null===(_=this.initData.examObj)||void 0===_?void 0:_.id}/0?backto=`+encodeURIComponent(encodeURIComponent(C))),this.commonService.myNavigationWithQueryString(`/admin/testbank/statistic/${null!==(d=this.initData.examObj)&&void 0!==d&&d.categoryId?this.initData.examObj.categoryId:0}/${null===(m=this.initData.examObj)||void 0===m?void 0:m.id}`,"?backto="+encodeURIComponent(w))}else this.openDialogWaring("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")}redirectToClassDetail(e){var n,i,a,r,l,c,_,d;let m=`/admin/testbank/exam-results-list/${null!==(i=null===(n=this.initData.examObj)||void 0===n?void 0:n.categoryId)&&void 0!==i?i:0}/${null===(a=this.initData.examObj)||void 0===a?void 0:a.id}/0`,p=null!==(r=this.commonService.getMyQueryParam("backto"))&&void 0!==r?r:"";p&&p.includes("shareType")&&(m=`/admin/testbank/exam-results-list/${null!==(c=null===(l=this.initData.examObj)||void 0===l?void 0:l.categoryId)&&void 0!==c?c:0}/${null===(_=this.initData.examObj)||void 0===_?void 0:_.id}/0?backto=`+encodeURIComponent(encodeURIComponent(p))),this.myNavigationWithQueryString(`/admin/student/class-details/${null===(d=e.classObj)||void 0===d?void 0:d.id}`,`?backto=${m}`)}redirectToUpdateExam(){var e,n,i,a,r,l,c,_,d,m;let p=`/admin/testbank/exam-results-list/${null!==(n=null===(e=this.initData.examObj)||void 0===e?void 0:e.categoryId)&&void 0!==n?n:0}/${null===(i=this.initData.examObj)||void 0===i?void 0:i.id}/0`,w=null!==(a=this.commonService.getMyQueryParam("backto"))&&void 0!==a?a:"";w&&w.includes("shareType")&&(p=`/admin/testbank/exam-results-list/${null!==(l=null===(r=this.initData.examObj)||void 0===r?void 0:r.categoryId)&&void 0!==l?l:0}/${null===(c=this.initData.examObj)||void 0===c?void 0:c.id}/0?backto=`+encodeURIComponent(encodeURIComponent(w))),this.myNavigationWithQueryString(`/admin/testbank/update-exam/${null!==(d=null===(_=this.initData.examObj)||void 0===_?void 0:_.categoryId)&&void 0!==d?d:0}/${null===(m=this.initData.examObj)||void 0===m?void 0:m.id}`,`?backto=${encodeURIComponent(p)}`)}ngOnInit(){var e;let n=this.commonService.getCurrentDomain();this.linkExam=`${n}/de-thi/${null===(e=this.initData.examObj)||void 0===e?void 0:e.hashId}`,super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(j.uw),t.Y36(Ot.cP),t.Y36(hn.n),t.Y36(Ji),t.Y36(pi.Y),t.Y36(Xe.$))},o.\u0275cmp=t.Xpm({type:o,selectors:[["menu-offline-test"]],inputs:{initData:"initData"},outputs:{reloadApi:"reloadApi"},features:[t.qOj],decls:39,vars:23,consts:[[1,"box","p-3","h-full","lg:h-auto","mb-10",2,"min-height","80vh"],[1,"document-info"],[1,"flex","items-center"],[1,"text-md","font-medium","truncate"],[1,"flex","items-center","mt-2"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["x","3","y","4","width","18","height","18","rx","2","ry","2"],["x1","16","y1","2","x2","16","y2","6"],["x1","8","y1","2","x2","8","y2","6"],["x1","3","y1","10","x2","21","y2","10"],[1,"text-sm"],["d","M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"],["cx","12","cy","7","r","4"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-layers","w-4","h-4","mr-2"],["d","M4 13.5V4a2 2 0 0 1 2-2h8.5L20 7.5V20a2 2 0 0 1-2 2h-5.5"],["points","14 2 14 8 20 8"],["d","M10.42 12.61a2.1 2.1 0 1 1 2.97 2.97L7.95 21 4 22l.99-3.95 5.43-5.44Z"],[1,"flex","mt-2"],[3,"type","typeObj","id","permissionObj"],[3,"ngIf"],[1,"mt-2","text-center"],[1,"btn","btn-sm","btn-transparent","btn-outline-secondary",3,"click"],[4,"ngIf"],[3,"data","closeDialog",4,"ngIf"],[1,"azt-document-menu","mt-4"],[1,"text-md","font-bold"],[1,"dropdown-menu","show","relative","w-full","mt-2"],[1,"dropdown-content","bg-slate-100","dark:bg-darkmode-600"],["class","dropdown-item text-danger",3,"click",4,"ngIf"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"azt-document-who","mt-4"],["class","btn btn-outline-primary btn-sm btn-transparent ml-auto",3,"click",4,"ngIf"],[1,"grid","grid-cols-12","gap-3","rounded-md","mt-1"],[4,"ngIf","ngIfElse"],["noClassroom",""],[1,"azt-document-list-code","mt-4"],[1,"grid","grid-cols-12","gap-3","mt-3"],["noExamOffline",""],[1,"dropdown-item","text-danger",3,"click"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],[1,"dropdown-item",3,"click"],["d","M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"],["cx","12","cy","12","r","3"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2","lucide"],["d","M3 3v18h18"],["d","m19 9-5 5-4-4-3 3"],[1,"btn","btn-outline-primary","btn-sm","btn-transparent","ml-auto",3,"click"],["d","M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"],["d","M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"],["class","col-span-4 2lg:col-span-3",4,"ngFor","ngForOf"],[1,"col-span-4","2lg:col-span-3"],[1,"btn","btn-outline-secondary","block","truncate","w-full",3,"matTooltip","click"],[1,"col-span-12","md:col-span-6"],[1,"btn","btn-outline-secondary","block","cursor-default","w-full"],["class","col-span-6",4,"ngFor","ngForOf"],[1,"col-span-6"],[1,"btn-text-primary","font-medium",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["x1","16","y1","13","x2","8","y2","13"],["x1","16","y1","17","x2","8","y2","17"],["x1","10","y1","9","x2","8","y2","9"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-5","h-5"],["points","18 15 12 9 6 15"],["points","6 9 12 15 18 9"],[3,"data","closeDialog"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t._uU(4),t.qZA()(),t.TgZ(5,"div",4),t.O4$(),t.TgZ(6,"svg",5),t._UZ(7,"rect",6)(8,"line",7)(9,"line",8)(10,"line",9),t.qZA(),t.kcU(),t.TgZ(11,"span",10),t._uU(12),t.ALo(13,"mytranslate"),t.ALo(14,"date"),t.qZA()(),t.TgZ(15,"div",4),t.O4$(),t.TgZ(16,"svg",5),t._UZ(17,"path",11)(18,"circle",12),t.qZA(),t.kcU(),t.TgZ(19,"span",10),t._uU(20),t.ALo(21,"mytranslate"),t.qZA()(),t.TgZ(22,"div",4),t.O4$(),t.TgZ(23,"svg",13),t._UZ(24,"path",14)(25,"polyline",15)(26,"path",16),t.qZA(),t.kcU(),t.TgZ(27,"span",10),t._uU(28),t.ALo(29,"mytranslate"),t.ALo(30,"number"),t.qZA()(),t.TgZ(31,"div",17),t._UZ(32,"azt-share",18),t.qZA()(),t.YNc(33,t1,38,36,"ng-template",19),t.TgZ(34,"div",20)(35,"button",21),t.NdJ("click",function(){return n.toggleShowActions()}),t.YNc(36,e1,3,0,"span",22),t.YNc(37,n1,3,0,"span",22),t.qZA()()(),t.YNc(38,i1,1,1,"azt-preview-exam",23)),2&e&&(t.xp6(4),t.hij(" ",null==n.initData.examObj?null:n.initData.examObj.name," "),t.xp6(8),t.hij(" ",t.lcZ(13,12,"lang_testbank_tested_list_date_create")+": "+t.xi3(14,14,null==n.initData.examObj?null:n.initData.examObj.createdAt,"dd/MM/yyyy HH:mm")," "),t.xp6(8),t.hij(" ",t.lcZ(21,17,"lang_auto_nguoi_tao")+": "+(null==n.initData.examCreatorObj?null:n.initData.examCreatorObj.fullName)," "),t.xp6(8),t.hij(" ",t.lcZ(29,19,"lang_testbank_tested_list_number_quizzes")+": "+(n.initData.totalAttended?n.initData.totalAttended:t.lcZ(30,21,0))," "),t.xp6(4),t.Q6J("type",3)("typeObj","EXAM")("id",null==n.initData.examObj?null:n.initData.examObj.id)("permissionObj",null==n.initData.examObj?null:n.initData.examObj.permissionObj),t.xp6(1),t.Q6J("ngIf",n.isShowActions),t.xp6(3),t.Q6J("ngIf",n.isShowActions),t.xp6(1),t.Q6J("ngIf",!n.isShowActions),t.xp6(1),t.Q6J("ngIf",n.examDetailDialog.isShow))},dependencies:[O.sg,O.O5,Wt.gM,Go.l,ci.I,O.JJ,O.uU,at.bT,at.BU,at.vL,at.El,at.q7,at._W],encapsulation:2}),o})();const a1=["drawer"];function s1(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function r1(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"menu-offline-test",71),t.NdJ("reloadApi",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.getData())}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("initData",e.initDataTestedList)}}function l1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"menu-online-test",72),t.NdJ("reloadApi",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.getData())}),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("initData",e.initDataTestedList)("userList",e.userList)}}function c1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",73),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.openDrawer())}),t.ALo(1,"mytranslate"),t.O4$(),t.TgZ(2,"svg",44),t._UZ(3,"rect",74)(4,"path",75)(5,"path",76),t.qZA()()}2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_auto_mo_menu"))}function _1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",73),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.closeDrawer())}),t.ALo(1,"mytranslate"),t.O4$(),t.TgZ(2,"svg",44),t._UZ(3,"rect",74)(4,"path",75)(5,"path",77),t.qZA()()}2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_auto_dong_menu"))}function d1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",78),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.exportToExcel("lastTime"))}),t.O4$(),t.TgZ(2,"svg",79),t._UZ(3,"path",80)(4,"polyline",81)(5,"line",82),t.qZA(),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()}2&o&&(t.xp6(6),t.hij(" ",t.lcZ(7,1,"lang_testbank_testted_list_export_excel_last_exam")," "))}function u1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",78),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.exportToExcel("highest"))}),t.O4$(),t.TgZ(2,"svg",79),t._UZ(3,"path",80)(4,"polyline",81)(5,"line",82),t.qZA(),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()}2&o&&(t.xp6(6),t.hij(" ",t.lcZ(7,1,"lang_testbank_testted_list_export_excel_highest_point")," "))}function m1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",78),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.exportToExcel("firstTime"))}),t.O4$(),t.TgZ(2,"svg",79),t._UZ(3,"path",80)(4,"polyline",81)(5,"line",82),t.qZA(),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()}2&o&&(t.xp6(6),t.hij(" ",t.lcZ(7,1,"lang_testbank_testted_list_export_excel_first_time_score")," "))}function h1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",78),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.exportToExcel("allTime"))}),t.O4$(),t.TgZ(2,"svg",79),t._UZ(3,"path",80)(4,"polyline",81)(5,"line",82),t.qZA(),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()}2&o&&(t.xp6(6),t.hij(" ",t.lcZ(7,1,"lang_testbank_testted_list_export_excel_all_exam")," "))}function p1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",78),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.exportToPDF())}),t.O4$(),t.TgZ(2,"svg",83),t._UZ(3,"path",84)(4,"polyline",85)(5,"line",86)(6,"line",87)(7,"line",88),t.qZA(),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()()}2&o&&(t.xp6(8),t.hij(" ",t.lcZ(9,1,"lang_testbank_testted_list_export_pdf_last")," "))}function g1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",78),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.exportToPDF("highest"))}),t.O4$(),t.TgZ(2,"svg",83),t._UZ(3,"path",84)(4,"polyline",85)(5,"line",86)(6,"line",87)(7,"line",88),t.qZA(),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()()}2&o&&(t.xp6(8),t.hij(" ",t.lcZ(9,1,"lang_testbank_testted_list_export_pdf_point_bigger")," "))}function f1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",78),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.exportToPDF("first"))}),t.O4$(),t.TgZ(2,"svg",83),t._UZ(3,"path",84)(4,"polyline",85)(5,"line",86)(6,"line",87)(7,"line",88),t.qZA(),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()()}2&o&&(t.xp6(8),t.hij(" ",t.lcZ(9,1,"lang_testbank_testted_list_export_pdf")," "))}function x1(o,s){1&o&&(t.TgZ(0,"div",89)(1,"div",90)(2,"p",91),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()()()),2&o&&(t.xp6(3),t.hij("",t.lcZ(4,1,"lang_not_found_search"),"!"))}function v1(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function b1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"app-file-scan-offline-exam-new",94),t.NdJ("saveStudentMarkEmit",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.scanMarkObjs(i))})("firstSuccessResultId",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.foundClassOfSuccessScanResult(i))})("showStudentMarkEmit",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.closeScanFile(i))}),t.qZA()}if(2&o){const e=t.oxw(3);t.Q6J("examObj",e.examObj)("backToLink",e.backFromStudentView)("loadedJs",e.loadedJs)("tokenScan",e.tokenScanExamOffline)("hasExamOffline",e.hasExamOffline)("examOfflineMessage",e.examOfflineMessage)("openSelect",e.showFileScan)}}function w1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"app-student-exam-result-new",92),t.NdJ("notTestedOpenFileScan",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.openFileScan(i))})("goToResult",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.goToTestReview(i))})("saveStudentMarkEmitFromComponent",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.scanMarkObjs(i))}),t.YNc(1,b1,1,7,"app-file-scan-offline-exam-new",93),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("isSortByMark",e.isSortByMarkDESC)("isSortByTime",e.isSortByTimeDESC)("isSortByName",e.isSortByName)("backToLink",e.backFromStudentView)("searchKey",e.searchContent.value)("studentLists",e.testedUserList)("studentListsInClass",e.testedUsersListByClass)("examHasClass",e.examHasClass)("isNotTestedYet",e.isNotTestedYet)("isOpenSideNav",e.isOpenSideNav)("hasEssayQuestion",e.hasEssayQuestion)("totalSubmitted",e.totalSubmitted)("totalSubmitByClass",e.totalStudentByClass)("showFileScan",e.showFileScan)("obj",e.examObj)("scanLoading",e.scanLoading)("isMobile",e.isMobile)("headerTitle",e.headerTitle)("mustShownResultId",e.mustShownResultId),t.xp6(1),t.Q6J("ngIf",e.showFileScan)}}const T1=function(o,s){return{"w-85":o,"w-30":s}},C1=function(){return{suppressScrollX:!0}},A1=function(o){return{"ml-5":o}},y1=function(o){return{"px-0":o}};function k1(o,s){if(1&o){const e=t.EpF();t._UZ(0,"azt-status-loading-effect"),t.TgZ(1,"div",3)(2,"mat-drawer-container",4)(3,"mat-drawer",5,6),t.NdJ("closedStart",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.changeStatusNav())}),t.TgZ(5,"perfect-scrollbar",7),t.YNc(6,r1,2,1,"ng-container",1),t.YNc(7,l1,1,2,"ng-template",null,8,t.W1O),t.qZA()(),t.TgZ(9,"mat-drawer-content")(10,"div",9)(11,"div",10),t.YNc(12,c1,6,3,"button",11),t.YNc(13,_1,6,3,"button",11),t.TgZ(14,"div",12)(15,"div",13)(16,"input",14),t.NdJ("keyup.enter",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.search())}),t.ALo(17,"mytranslate"),t.qZA(),t.O4$(),t.TgZ(18,"svg",15),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.search())}),t._UZ(19,"circle",16)(20,"line",17),t.qZA()(),t.kcU(),t.TgZ(21,"div",18)(22,"button",19),t.O4$(),t.TgZ(23,"svg",20),t._UZ(24,"polygon",21),t.qZA(),t.kcU(),t.TgZ(25,"span",22),t._uU(26),t.ALo(27,"mytranslate"),t.qZA()(),t.TgZ(28,"mat-menu",23,24)(30,"div",25)(31,"ul",26)(32,"li")(33,"label",27),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(34),t.ALo(35,"mytranslate"),t.TgZ(36,"div",28)(37,"input",29),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.toggleFilterMarked(i))}),t.qZA()()()(),t.TgZ(38,"li")(39,"label",30),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(40),t.ALo(41,"mytranslate"),t.TgZ(42,"div",28)(43,"input",31),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.toggleFilterNotMarked(i))}),t.qZA()()()(),t.TgZ(44,"li")(45,"label",32),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(46),t.ALo(47,"mytranslate"),t.TgZ(48,"div",28)(49,"input",33),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.toggleFilterIsOnTest(i))}),t.qZA()()()(),t.TgZ(50,"li")(51,"label",34),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(52),t.ALo(53,"mytranslate"),t.TgZ(54,"div",28)(55,"input",35),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.toggleFilterIsNotSubmit(i))}),t.qZA()()()(),t.TgZ(56,"li")(57,"label",36),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(58),t.ALo(59,"mytranslate"),t.TgZ(60,"div",28)(61,"input",37),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.toggleFilterIsNotTested(i))}),t.qZA()()()(),t.TgZ(62,"li"),t._UZ(63,"hr",38),t.qZA(),t.TgZ(64,"li")(65,"div",39)(66,"button",40),t._uU(67),t.ALo(68,"mytranslate"),t.qZA(),t.TgZ(69,"div",41),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(70,"button",42),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.clearFilter())}),t._uU(71),t.ALo(72,"mytranslate"),t.qZA()()()()()()()(),t.TgZ(73,"div",43)(74,"button",19),t.O4$(),t.TgZ(75,"svg",44),t._UZ(76,"line",45)(77,"line",46)(78,"line",47),t.qZA()(),t.kcU(),t.TgZ(79,"mat-menu",23,48)(81,"div",49)(82,"ul",26),t.YNc(83,d1,8,3,"li",50),t.ALo(84,"viewPermission"),t.YNc(85,u1,8,3,"li",50),t.ALo(86,"viewPermission"),t.YNc(87,m1,8,3,"li",50),t.ALo(88,"viewPermission"),t.YNc(89,h1,8,3,"li",50),t.ALo(90,"viewPermission"),t.YNc(91,p1,10,3,"li",50),t.ALo(92,"viewPermission"),t.YNc(93,g1,10,3,"li",50),t.ALo(94,"viewPermission"),t.YNc(95,f1,10,3,"li",50),t.ALo(96,"viewPermission"),t.TgZ(97,"li")(98,"label",51),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(99,"span",52),t.O4$(),t.TgZ(100,"svg",53),t._UZ(101,"path",54)(102,"path",55)(103,"path",56)(104,"path",57)(105,"path",58),t.qZA(),t._uU(106),t.ALo(107,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(108,"div",28)(109,"input",59),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.sortByName(i))}),t.qZA()()()(),t.TgZ(110,"li")(111,"label",60),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(112,"span",52),t.O4$(),t.TgZ(113,"svg",53),t._UZ(114,"path",61)(115,"path",55)(116,"path",62)(117,"path",57)(118,"path",58),t.qZA(),t._uU(119),t.ALo(120,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(121,"div",28)(122,"input",63),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.sortByMarkDESC(i))}),t.qZA()()()(),t.TgZ(123,"li")(124,"label",64),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(125,"span",52),t.O4$(),t.TgZ(126,"svg",53),t._UZ(127,"path",61)(128,"path",55)(129,"path",62)(130,"path",57)(131,"path",58),t.qZA(),t._uU(132),t.ALo(133,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(134,"div",28)(135,"input",65),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.sortByTimeDESC(i))}),t.qZA()()()()()()()()()(),t.TgZ(136,"div",66),t.YNc(137,x1,5,3,"div",67),t.YNc(138,v1,1,0,"azt-loading-effect",50),t.YNc(139,w1,2,20,"ng-template",68),t.qZA()(),t._UZ(140,"app-excel-score-sheet",69)(141,"app-excel-score-sheet",70)(142,"app-excel-score-sheet",70)(143,"app-excel-score-sheet",70),t.qZA()()()}if(2&o){const e=t.MAs(8),n=t.MAs(29),i=t.MAs(80),a=t.oxw();t.xp6(2),t.Q6J("hasBackdrop",a.hasBackdrop),t.xp6(1),t.s9C("opened",a.isOpenSideNav?"true":"false"),t.Q6J("ngClass",t.WLB(135,T1,a.isMobile,!a.isMobile))("mode",a.mode),t.xp6(2),t.Q6J("config",t.DdM(138,C1))("scrollIndicators",!0),t.xp6(1),t.Q6J("ngIf",a.isOfflineExam)("ngIfElse",e),t.xp6(4),t.Q6J("ngClass",t.VKq(139,A1,!a.isMobile&&a.isOpenSideNav)),t.xp6(2),t.Q6J("ngIf",!a.isOpenSideNav||a.isMobile),t.xp6(1),t.Q6J("ngIf",a.isOpenSideNav&&!a.isMobile),t.xp6(3),t.s9C("placeholder",t.lcZ(17,90,"lang_testbank_testted_list_search")),t.Q6J("formControl",a.searchContent),t.xp6(6),t.Q6J("matMenuTriggerFor",n),t.xp6(4),t.hij(" ",t.lcZ(27,92,"lang_testbank_testted_list_sort")," "),t.xp6(8),t.hij(" ",t.lcZ(35,94,"lang_testbank_testted_list_show_student_marking")," "),t.xp6(3),t.Q6J("checked",a.isMarked),t.xp6(3),t.hij(" ",t.lcZ(41,96,"lang_testbank_testted_list_student_not_marking")," "),t.xp6(3),t.Q6J("checked",a.isNotMarked),t.xp6(3),t.hij(" ",t.lcZ(47,98,"lang_testbank_testted_list_show_student_taking_exam")," "),t.xp6(3),t.Q6J("checked",a.isOnTest),t.xp6(3),t.hij(" ",t.lcZ(53,100,"lang_testbank_testted_list_show_student_not_submit_exam")," "),t.xp6(3),t.Q6J("checked",a.isNotSubmit),t.xp6(3),t.hij(" ",t.lcZ(59,102,"lang_testbank_testted_list_show_student_not_yet_exam")," "),t.xp6(3),t.Q6J("checked",a.isNotTested),t.xp6(6),t.hij(" ",t.lcZ(68,104,"lang_buttom_close")," "),t.xp6(4),t.hij(" ",t.lcZ(72,106,"lang_buttom_delete")," "),t.xp6(3),t.Q6J("matMenuTriggerFor",i),t.xp6(9),t.Q6J("ngIf",t.xi3(84,108,a.examObj.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(86,111,a.examObj.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(88,114,a.examObj.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(90,117,a.examObj.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(92,120,a.examObj.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(94,123,a.examObj.permissionObj,"exam")),t.xp6(2),t.Q6J("ngIf",t.xi3(96,126,a.examObj.permissionObj,"exam")),t.xp6(11),t.hij(" ",t.lcZ(107,129,"lang_testbank_testted_list_sort_name")," "),t.xp6(3),t.Q6J("checked",a.isSortByName),t.xp6(10),t.hij(" ",t.lcZ(120,131,"lang_testbank_testted_list_sort_point")," "),t.xp6(3),t.Q6J("checked",a.isSortByMarkDESC),t.xp6(10),t.hij(" ",t.lcZ(133,133,"lang_testbank_testted_list_sort_time")," "),t.xp6(3),t.Q6J("checked",a.isSortByTimeDESC),t.xp6(1),t.Q6J("ngClass",t.VKq(141,y1,a.isMobile||!a.isOpenSideNav)),t.xp6(1),t.Q6J("ngIf",a.isNullSearchData),t.xp6(1),t.Q6J("ngIf",1==a.isLoadingSearch),t.xp6(1),t.Q6J("ngIf",!a.isNullSearchData&&0==a.isLoadingSearch),t.xp6(1),t.Q6J("dataScore",a.highestMark)("dataScoreByClass",a.dataExportHighestMark)("maxGroupQuestion",a.maxGroupQuestion)("examObj",a.examObj)("questionExportObjs",a.questionExportObjs)("currentDate",a.currentDate)("tableType","highest")("isSortByMark",a.isSortByMarkDESC)("isSortByTime",a.isSortByTimeDESC)("isSortByName",a.isSortByName)("hasEssayQuestion",a.hasEssayQuestion)("countEssayQuestion",a.countEssayQuestion),t.xp6(1),t.Q6J("dataScore",a.objs)("dataScoreByClass",a.dataExportLastTime)("maxGroupQuestion",a.maxGroupQuestion)("examObj",a.examObj)("questionExportObjs",a.questionExportObjs)("currentDate",a.currentDate)("tableType","lastTime")("isSortByTime",a.isSortByTimeDESC)("isSortByName",a.isSortByName)("hasEssayQuestion",a.hasEssayQuestion)("countEssayQuestion",a.countEssayQuestion),t.xp6(1),t.Q6J("dataScore",a.firstMark)("dataScoreByClass",a.dataExportFirstTime)("maxGroupQuestion",a.maxGroupQuestion)("examObj",a.examObj)("questionExportObjs",a.questionExportObjs)("currentDate",a.currentDate)("tableType","firstTime")("isSortByTime",a.isSortByTimeDESC)("isSortByName",a.isSortByName)("hasEssayQuestion",a.hasEssayQuestion)("countEssayQuestion",a.countEssayQuestion),t.xp6(1),t.Q6J("dataScore",a.allTimeMark)("dataScoreByClass",a.dataExportAllTime)("maxGroupQuestion",a.maxGroupQuestion)("examObj",a.examObj)("questionExportObjs",a.questionExportObjs)("currentDate",a.currentDate)("tableType","allTime")("isSortByTime",a.isSortByTimeDESC)("isSortByName",a.isSortByName)("hasEssayQuestion",a.hasEssayQuestion)("countEssayQuestion",a.countEssayQuestion)}}let O1=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_,d,m,p,w){super(e),this.commonService=e,this.browserStorageService=n,this.sortService=i,this.examFilterService=a,this.testedListApiService=r,this.answerTypeService=l,this.offlineExamResultService=c,this.homeworkExamService=_,this.globalService=d,this.activeRoute=m,this.monitorService=p,this.localize=w,this.drawer=void 0,this.mode=this.commonService.isMobileOrTable()?"over":"side",this.hasBackdrop=!!this.commonService.isMobileOrTable(),this.isOpenSideNav=!this.commonService.isMobileOrTable(),this.isMobile=this.commonService.isMobileOrTable(),this.initDataTestedList={studentsNotInClassResults:[]},this.searchContent=new h.p4("",h.kI.required),this.isLoadingSearch=!1,this.examId=0,this.cateId=0,this.highestMark=[],this.firstMark=[],this.allTimeMark=[],this.exportType=0,this.objs=[],this.dataExportFirstTime=[],this.dataExportHighestMark=[],this.dataExportLastTime=[],this.dataExportAllTime=[],this.questionExportObjs=[],this.userList=[],this.testedUserList=[],this.testedUsersListByClass=[],this.studentObjsInClass=[],this.studentObjs=[],this.examObj={},this.maxGroupQuestion=0,this.examHasClass=!1,this.isNotTestedYet=!1,this.isNullSearchData=!1,this.hasEssayQuestion=!1,this.countEssayQuestion=0,this.isSortByName=!1,this.isSortByMarkDESC=!1,this.isSortByTimeDESC=!1,this.totalStudents=0,this.totalSubmitted=0,this.totalStudentByClass=0,this.headerTitle="",this.backToLink="",this.backFromStudentView="",this.errorMissingConfigClassroomPermission=!1,this.errorMissingConfigClassroomMessage="",this.isMarked=!1,this.isNotMarked=!1,this.isOnTest=!1,this.isNotSubmit=!1,this.isNotTested=!1,this.showFileScan=!1,this.hasExamOffline=!1,this.examOfflineMessage="",this.tokenScanExamOffline="",this.loadedJs=!1,this.exportLoading=!1,this.scanLoading=!1,this.countQuestion=0,this.resultId=0,this.currentDate=new Date,this.isOfflineExam=!1,this.mustShownResultId=0}openDrawer(){var e;null===(e=this.drawer)||void 0===e||e.open(),this.isOpenSideNav=!0,this.saveStatusSideNav()}closeDrawer(){var e;null===(e=this.drawer)||void 0===e||e.close(),this.isOpenSideNav=!1,this.saveStatusSideNav()}changeStatusNav(){this.isMobile&&(document.body.style.overflow="auto")}search(){var e,n;if(this.isLoadingSearch=!0,""!=this.searchContent.value){let i=this.commonService.myClone(this.studentObjs),a=this.commonService.myClone(this.studentObjsInClass),r=this.searchResultFullnameInClass(this.searchContent.value,a),l=r.count,c=this.searchResultFullname(this.searchContent.value,i),_=c.count;this.testedUsersListByClass=null!==(e=r.data)&&void 0!==e?e:new Array,this.testedUserList=null!==(n=c.data)&&void 0!==n?n:new Array,this.isLoadingSearch=!1,this.examHasClass=this.testedUsersListByClass.length>0,this.isNullSearchData=0===l&&0===_}else this.testedUserList=this.commonService.myClone(this.studentObjs),this.testedUsersListByClass=this.commonService.myClone(this.studentObjsInClass),this.examHasClass=this.testedUsersListByClass.length>0,this.isLoadingSearch=!1,this.isNullSearchData=!1,this.errorStatusObj("NO_TESTED_YET")}searchResultFullnameInClass(e,n){var i,a,r,l;e=this.commonService.convertVietnameseToEnglish(e);var c=[],_=0;for(let m=0;m<n.length;m++)try{if(n[m]&&n[m].hasOwnProperty("results")){var d=this.fillerArr(null!==(i=n[m].results)&&void 0!==i?i:new Array,e.toLowerCase());n[m].results=d.data,_+=null!==(a=d.count)&&void 0!==a?a:0,((null===(l=null===(r=n[m])||void 0===r?void 0:r.results)||void 0===l?void 0:l.length)||-1)>0&&c.push(n[m])}}catch(p){return{count:_,data:c}}return{count:_,data:c}}searchResultFullname(e,n){var i,a;e=this.commonService.convertVietnameseToEnglish(e);var r=[],l=0;try{var c=this.fillerArr(n,e.toLowerCase());r=null!==(i=c.data)&&void 0!==i?i:new Array,l+=null!==(a=c.count)&&void 0!==a?a:0}catch(_){return{count:l,data:r}}return{count:l,data:r}}toggleFilterMarked(e){this.isMarked=!!e.target.checked,this.confirmFilter()}toggleFilterNotMarked(e){this.isNotMarked=!!e.target.checked,this.confirmFilter()}toggleFilterIsOnTest(e){this.isOnTest=!!e.target.checked,this.confirmFilter()}toggleFilterIsNotSubmit(e){this.isNotSubmit=!!e.target.checked,this.confirmFilter()}toggleFilterIsNotTested(e){this.isNotTested=!!e.target.checked,this.confirmFilter()}confirmFilter(){var e=[],n=[],i=[],a=[],r=[];this.saveFilterValue();var l=this.commonService.myClone(this.studentObjsInClass),c=!1;if((this.isOnTest||this.isNotSubmit)&&(c=!0),this.isMarked&&(e=this.studentObjs.filter(d=>!(1!=d.isMarked||c&&1!=d.status&&(d.isMarked||d.isNotMarked)))),this.isNotMarked&&(n=this.studentObjs.filter(d=>!(1!=d.isNotMarked||c&&1!=d.status&&(d.isMarked||d.isNotMarked)))),this.isOnTest&&(i=this.studentObjs.filter(d=>1==d.isOnTest||0==d.status&&(d.isMarked||d.isNotMarked))),this.isNotTested&&(a=this.studentObjs.filter(d=>1==d.isNotTested)),this.isNotSubmit&&(r=this.studentObjs.filter(d=>1==d.isNotSubmit||-1==d.status&&(d.isMarked||d.isNotMarked))),this.isMarked||this.isNotMarked||this.isOnTest||this.isNotSubmit||this.isNotTested){var _=this.browserStorageService.getSimpleStorage(this.examId+"_azt_setting_sort_desc_tested_by_time");_&&"true"==_?(this.testedUserList=this.sortService.sortTimeDESC([...e,...n,...i,...a,...r]),this.testedUsersListByClass=this.sortService.sortTimeStudentsInClass(this.takeDataToFilter(l),1)):(this.testedUserList=[...e,...n,...i,...a,...r],this.testedUsersListByClass=this.takeDataToFilter(l))}else this.clearFilter()}takeDataToFilter(e){var n=[];return e.forEach(i=>{var a;i.results=this.filterResultInClass(null!==(a=i.results)&&void 0!==a?a:new Array),n.push(i)}),n}filterResultInClass(e){var i=[],a=[],r=[],l=[],c=[],_=!1;return(this.isOnTest||this.isNotSubmit)&&(_=!0),this.isMarked&&(i=e.filter(d=>!(1!=d.isMarked||_&&1!=d.status&&(d.isMarked||d.isNotMarked)))),this.isNotMarked&&(a=e.filter(d=>!(1!=d.isNotMarked||_&&1!=d.status&&(d.isMarked||d.isNotMarked)))),this.isOnTest&&(r=e.filter(d=>1==d.isOnTest||0==d.status&&(d.isMarked||d.isNotMarked))),this.isNotTested&&(l=e.filter(d=>1==d.isNotTested)),this.isNotSubmit&&(c=e.filter(d=>1==d.isNotSubmit||-1==d.status&&(d.isMarked||d.isNotMarked))),[...i,...a,...r,...l,...c]}fillerArr(e,n){var i=0,a=[];return e.forEach(r=>{var l;-1!=this.commonService.convertVietnameseToEnglish(null!==(l=r.fullName)&&void 0!==l?l:"").toLowerCase().indexOf(n.toLowerCase())&&(i++,a.push(r))}),{count:i,data:a}}clearFilter(){if(this.isNotMarked=!1,this.isMarked=!1,this.isOnTest=!1,this.isNotSubmit=!1,this.isNotTested=!1,this.isSortByName){let e=this.commonService.myClone(this.studentObjs),n=this.commonService.myClone(this.studentObjsInClass);this.testedUserList=this.sortService.sortFirstNameStudents(e),this.testedUsersListByClass=this.sortService.sortFirstNameStudentsInClass(n)}else if(this.isSortByTimeDESC){let e=this.commonService.myClone(this.studentObjs),n=this.commonService.myClone(this.studentObjsInClass);this.testedUserList=this.sortService.sortTimeDESC(e),this.testedUsersListByClass=this.sortService.sortTimeStudentsInClass(n,1)}else if(this.isSortByMarkDESC){let e=this.commonService.myClone(this.studentObjs),n=this.commonService.myClone(this.studentObjsInClass);this.testedUserList=this.sortService.sortMarkDESC(e,this.hasEssayQuestion),this.testedUsersListByClass=this.sortService.sortMarkStudentsInClass(n,1,this.hasEssayQuestion)}else{let e=this.commonService.myClone(this.studentObjs),n=this.commonService.myClone(this.studentObjsInClass);this.testedUserList=e,this.testedUsersListByClass=this.checkSortTypeClass(n)}this.removeFilterStore()}checkSortTypeClass(e){var n=[];return e.forEach(i=>{var a,r,l;i.results=0==(null===(a=i.classObj)||void 0===a?void 0:a.sortType)?this.sortService.sortFirstNameStudents(null!==(r=this.commonService.myClone(i.results))&&void 0!==r?r:[]):this.sortService.sortArrayByMultipleObjectKeyAsc(null!==(l=this.commonService.myClone(i.results))&&void 0!==l?l:[],"pos","id"),n.push(i)}),n}saveFilterValue(){let e={};this.isMarked&&(e.isMarked=!0),this.isNotMarked&&(e.isNotMarked=!0),this.isOnTest&&(e.isOnTest=!0),this.isNotSubmit&&(e.isNotSubmit=!0),this.isNotTested&&(e.isNotTested=!0),this.examFilterService.setCustomFilter(e,"exam",this.examId)}checkFilterValue(){let e=this.examFilterService.getCustomFilter("exam",this.examId);null!=e&&""!=e&&(e.includes("isMarked")&&(this.isMarked=!0),e.includes("isNotMarked")&&(this.isNotMarked=!0),e.includes("isOnTest")&&(this.isOnTest=!0),e.includes("isNotSubmit")&&(this.isNotSubmit=!0),e.includes("isNotTested")&&(this.isNotTested=!0),this.confirmFilter())}removeFilterStore(){this.examFilterService.removeCustomFilter("exam",this.examId)}saveStatusSideNav(){this.examFilterService.saveStatusSideNav("exam",this.isOpenSideNav)}removeStatusSideNav(){this.examFilterService.removeStatusSideNav("exam")}getStatusSideNav(){if(window.innerWidth>980){let e=this.examFilterService.getStatusSideNav("exam");this.isOpenSideNav=!e||"close"!=e}}foundClassOfSuccessScanResult(e){e&&(this.mustShownResultId=e)}scanMarkObjs(e){e&&(this.scanLoading=!0,this.testedUserList=[],this.testedUsersListByClass=[],this.studentObjs=[],this.studentObjsInClass=[],this.getData())}closeScanFile(e){e&&(this.showFileScan=!1)}openFileScan(e){this.showFileScan=!(!e||!this.loadedJs)&&e}goToTestReview(e){var n;if(e.resultId){var i=`/admin/testbank/exam-results-list/${this.cateId}/${this.examId}/${this.resultId}`;let a=null!==(n=this.commonService.getMyQueryParam("backto"))&&void 0!==n?n:"";a&&a.includes("shareType")&&(i=`/admin/testbank/exam-results-list/${this.cateId}/${this.examId}/${this.resultId}?backto=`+encodeURIComponent(encodeURIComponent(a))),this.commonService.myNavigationWithQueryString("/admin/testbank/test-review/"+this.examObj.id+"/"+e.userId+"/"+e.studentId+"/"+e.resultId,"?backto="+encodeURIComponent(i))}}checkNewInfo(e){var n=!1;if(null!=e)for(var i=0;i<e.length;i++)if(e[i].hasOwnProperty("contents")){n=!0;break}return n}changeInfo(e){var n,i,a,r,l=[];for(let d=0;d<e.length;d++){var c=null!==(i=this.commonService.myParseJson(null!==(n=e[d].infors)&&void 0!==n?n:""))&&void 0!==i?i:[];if(this.checkNewInfo(c))if(null!=c){var _=new Array;c.forEach(m=>{m.contents&&1==m.contents.length?_.push({key:m.title,value:m.contents[0]}):m.contents&&m.contents.length>1&&_.push({key:m.title,value:m.contents.join(", ")})}),e[d].inforsParse=_}else e[d].inforsParse=new Array;else e[d].inforsParse=null!==(r=this.commonService.myParseJson(null!==(a=e[d].infors)&&void 0!==a?a:""))&&void 0!==r?r:[];l.push(e[d])}return l}mapQuestionWithAnswer(e,n){var i=[];return e.forEach(a=>{if(""!=a.answers&&null!=a.answers&&"[]"!=a.answers){var r=this.commonService.willDeleteParseJson(a.answers),l=[];n.forEach(c=>{for(var _={QuestionId:c.questionId,Answer:"",index:c.sort},d=0;d<r.length;d++)if(r[d].QuestionId==c.questionId&&r[d].AnswerContent&&r[d].AnswerContent.length>0){_.Answer=r[d].AnswerContent[0].Content;break}l.push(_)}),i.push(Object.assign(Object.assign({},a),{results:l}))}else l=[],n.forEach(_=>{l.push({QuestionId:_.questionId,Answer:"",index:_.sort})}),i.push(Object.assign(Object.assign({},a),{results:l}))}),i}processDataForExcel(e){var n=[];return e.forEach(i=>{var a;i.results=this.mapQuestionWithAnswer(this.sortService.sortFirstNameStudents(null!==(a=i.results)&&void 0!==a?a:new Array),this.questionExportObjs),i.results=this.checkStatusStudent(this.changeInfo(i.results),!1),n.push(i)}),n}exportToExcel(e){let n="";this.commonService.myTranslate(["lang_auto_dang_khoi_tao_du_lieu"]).subscribe(i=>{n=i.lang_auto_dang_khoi_tao_du_lieu}),Ze.AX.openLoadingEffect(n),"lastTime"==e?this.subscriptions.add(this.testedListApiService.getTestedLastMark("export_tool",this.examId).subscribe(i=>{var a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt,W,P,R,N;Array.isArray(i)||1!=i.success?(this.showErrorSnack(null!==(N=i.message)&&void 0!==N?N:""),Ze.AX.closeLoadingEffect(10)):(this.commonService.myTranslate(["lang_auto_tao_tin_dang_duoc_tai_xuong"]).subscribe(B=>{n=B.lang_auto_tao_tin_dang_duoc_tai_xuong}),Ze.AX.changeMsgLoadingEffect(n),this.questionExportObjs=null!==(r=null===(a=i.data)||void 0===a?void 0:a.questionObjs)&&void 0!==r?r:[],this.objs=null!==(c=null===(l=i.data)||void 0===l?void 0:l.studentsNotInClassResults)&&void 0!==c?c:[],this.maxGroupQuestion=null!==(d=null===(_=i.data)||void 0===_?void 0:_.maxGroupId)&&void 0!==d?d:0,this.objs=this.isSortByMarkDESC?this.mapQuestionWithAnswer(this.sortService.sortMarkDESC(null!==(p=null===(m=i.data)||void 0===m?void 0:m.studentsNotInClassResults)&&void 0!==p?p:[],this.hasEssayQuestion),null!==(C=null===(w=i.data)||void 0===w?void 0:w.questionObjs)&&void 0!==C?C:[]):this.isSortByTimeDESC?this.mapQuestionWithAnswer(this.sortService.sortTimeDESC(null!==(M=null===(A=i.data)||void 0===A?void 0:A.studentsNotInClassResults)&&void 0!==M?M:[]),null!==(q=null===(D=i.data)||void 0===D?void 0:D.questionObjs)&&void 0!==q?q:[]):this.mapQuestionWithAnswer(this.sortService.sortFirstNameStudents(null!==(F=null===(U=i.data)||void 0===U?void 0:U.studentsNotInClassResults)&&void 0!==F?F:[]),null!==(W=null===(tt=i.data)||void 0===tt?void 0:tt.questionObjs)&&void 0!==W?W:[]),this.objs=this.checkStatusStudent(this.changeInfo(this.objs),!0),this.dataExportLastTime=this.processDataForExcel(null!==(R=null===(P=i.data)||void 0===P?void 0:P.studentsInClassResults)&&void 0!==R?R:[]),setTimeout(()=>{var B;null===(B=document.getElementById("table_"+e))||void 0===B||B.click(),Ze.AX.closeLoadingEffect(10)},1e3),this.successStatusObj())})):"highest"==e?this.subscriptions.add(this.testedListApiService.getTestedHighestMark("export_tool",this.examId).subscribe(i=>{var a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt,W,P,R,N;1==i.success?(this.commonService.myTranslate(["lang_auto_tao_tin_dang_duoc_tai_xuong"]).subscribe(B=>{n=B.lang_auto_tao_tin_dang_duoc_tai_xuong}),Ze.AX.changeMsgLoadingEffect(n),this.questionExportObjs=null!==(r=null===(a=i.data)||void 0===a?void 0:a.questionObjs)&&void 0!==r?r:[],this.highestMark=null!==(c=null===(l=i.data)||void 0===l?void 0:l.studentsNotInClassResults)&&void 0!==c?c:[],this.maxGroupQuestion=null!==(d=null===(_=i.data)||void 0===_?void 0:_.maxGroupId)&&void 0!==d?d:0,this.highestMark=this.isSortByMarkDESC?this.mapQuestionWithAnswer(this.sortService.sortMarkDESC(null!==(p=null===(m=i.data)||void 0===m?void 0:m.studentsNotInClassResults)&&void 0!==p?p:[],this.hasEssayQuestion),null!==(C=null===(w=i.data)||void 0===w?void 0:w.questionObjs)&&void 0!==C?C:[]):this.isSortByTimeDESC?this.mapQuestionWithAnswer(this.sortService.sortTimeDESC(null!==(M=null===(A=i.data)||void 0===A?void 0:A.studentsNotInClassResults)&&void 0!==M?M:[]),null!==(q=null===(D=i.data)||void 0===D?void 0:D.questionObjs)&&void 0!==q?q:[]):this.mapQuestionWithAnswer(this.sortService.sortFirstNameStudents(null!==(F=null===(U=i.data)||void 0===U?void 0:U.studentsNotInClassResults)&&void 0!==F?F:[]),null!==(W=null===(tt=i.data)||void 0===tt?void 0:tt.questionObjs)&&void 0!==W?W:[]),this.highestMark=this.checkStatusStudent(this.changeInfo(this.highestMark),!0),this.dataExportHighestMark=this.processDataForExcel(null!==(R=null===(P=i.data)||void 0===P?void 0:P.studentsInClassResults)&&void 0!==R?R:[]),setTimeout(()=>{var B;null===(B=document.getElementById("table_"+e))||void 0===B||B.click(),Ze.AX.closeLoadingEffect(10)},1e3),this.successStatusObj()):(this.showErrorSnack(null!==(N=i.message)&&void 0!==N?N:""),Ze.AX.closeLoadingEffect(10))})):"firstTime"==e?this.subscriptions.add(this.testedListApiService.getTestedFirstMark("export_tool",this.examId).subscribe(i=>{var a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt,W,P,R,N;1==i.success?(this.commonService.myTranslate(["lang_auto_tao_tin_dang_duoc_tai_xuong"]).subscribe(B=>{n=B.lang_auto_tao_tin_dang_duoc_tai_xuong}),Ze.AX.changeMsgLoadingEffect(n),this.questionExportObjs=null!==(r=null===(a=i.data)||void 0===a?void 0:a.questionObjs)&&void 0!==r?r:[],this.firstMark=null!==(c=null===(l=i.data)||void 0===l?void 0:l.studentsNotInClassResults)&&void 0!==c?c:[],this.maxGroupQuestion=null!==(d=null===(_=i.data)||void 0===_?void 0:_.maxGroupId)&&void 0!==d?d:0,this.firstMark=this.isSortByMarkDESC?this.mapQuestionWithAnswer(this.sortService.sortMarkDESC(null!==(p=null===(m=i.data)||void 0===m?void 0:m.studentsNotInClassResults)&&void 0!==p?p:[],this.hasEssayQuestion),null!==(C=null===(w=i.data)||void 0===w?void 0:w.questionObjs)&&void 0!==C?C:[]):this.isSortByTimeDESC?this.mapQuestionWithAnswer(this.sortService.sortTimeDESC(null!==(M=null===(A=i.data)||void 0===A?void 0:A.studentsNotInClassResults)&&void 0!==M?M:[]),null!==(q=null===(D=i.data)||void 0===D?void 0:D.questionObjs)&&void 0!==q?q:[]):this.mapQuestionWithAnswer(this.sortService.sortFirstNameStudents(null!==(F=null===(U=i.data)||void 0===U?void 0:U.studentsNotInClassResults)&&void 0!==F?F:[]),null!==(W=null===(tt=i.data)||void 0===tt?void 0:tt.questionObjs)&&void 0!==W?W:[]),this.firstMark=this.checkStatusStudent(this.changeInfo(this.firstMark),!0),this.dataExportFirstTime=this.processDataForExcel(null!==(R=null===(P=i.data)||void 0===P?void 0:P.studentsInClassResults)&&void 0!==R?R:[]),setTimeout(()=>{var B;null===(B=document.getElementById("table_"+e))||void 0===B||B.click(),Ze.AX.closeLoadingEffect(10)},1e3),this.successStatusObj()):(this.showErrorSnack(null!==(N=i.message)&&void 0!==N?N:""),Ze.AX.closeLoadingEffect(10))})):"allTime"==e&&this.subscriptions.add(this.testedListApiService.getTestedAllResult("export_tool",this.examId).subscribe(i=>{var a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt,W,P,R,N;1==i.success?(this.commonService.myTranslate(["lang_auto_tao_tin_dang_duoc_tai_xuong"]).subscribe(B=>{n=B.lang_auto_tao_tin_dang_duoc_tai_xuong}),Ze.AX.changeMsgLoadingEffect(n),this.questionExportObjs=null!==(r=null===(a=i.data)||void 0===a?void 0:a.questionObjs)&&void 0!==r?r:[],this.allTimeMark=null!==(c=null===(l=i.data)||void 0===l?void 0:l.studentsNotInClassResults)&&void 0!==c?c:[],this.maxGroupQuestion=null!==(d=null===(_=i.data)||void 0===_?void 0:_.maxGroupId)&&void 0!==d?d:0,this.allTimeMark=this.isSortByMarkDESC?this.mapQuestionWithAnswer(this.sortService.sortMarkDESC(null!==(p=null===(m=i.data)||void 0===m?void 0:m.studentsNotInClassResults)&&void 0!==p?p:[],this.hasEssayQuestion),null!==(C=null===(w=i.data)||void 0===w?void 0:w.questionObjs)&&void 0!==C?C:[]):this.isSortByTimeDESC?this.mapQuestionWithAnswer(this.sortService.sortTimeDESC(null!==(M=null===(A=i.data)||void 0===A?void 0:A.studentsNotInClassResults)&&void 0!==M?M:[]),null!==(q=null===(D=i.data)||void 0===D?void 0:D.questionObjs)&&void 0!==q?q:[]):this.mapQuestionWithAnswer(this.sortService.sortFirstNameStudents(null!==(F=null===(U=i.data)||void 0===U?void 0:U.studentsNotInClassResults)&&void 0!==F?F:[]),null!==(W=null===(tt=i.data)||void 0===tt?void 0:tt.questionObjs)&&void 0!==W?W:[]),this.allTimeMark=this.checkStatusStudent(this.changeInfo(this.allTimeMark),!0),this.dataExportAllTime=this.processDataForExcel(null!==(R=null===(P=i.data)||void 0===P?void 0:P.studentsInClassResults)&&void 0!==R?R:[]),setTimeout(()=>{var B;null===(B=document.getElementById("table_"+e))||void 0===B||B.click(),Ze.AX.closeLoadingEffect(10)},1e3),this.successStatusObj()):(this.showErrorSnack(null!==(N=i.message)&&void 0!==N?N:""),Ze.AX.closeLoadingEffect(10))}))}exportToPDF(e){const n=this.localize.translateRoute(`/admin/testbank/export-pdf-by-class/${this.examObj.id}/0/0/0?export_type=${e||"last"}`).toString();window.open(n,"_blank")}sortByName(e){let n=this.commonService.myClone(this.studentObjs),i=this.commonService.myClone(this.studentObjsInClass);e.target.checked?(this.isSortByName=e.target.checked,this.testedUserList=this.sortService.sortFirstNameStudents(n),this.testedUsersListByClass=this.sortService.sortFirstNameStudentsInClass(i),this.browserStorageService.saveSimpleStorage(this.examId+"_azt_setting_sort_tested_by_name",e.target.checked.toString()),this.isSortByMarkDESC&&(this.isSortByMarkDESC=!1,this.browserStorageService.saveSimpleStorage(this.examId+"_azt_setting_sort_desc_tested_by_mark",this.isSortByMarkDESC.toString())),this.isSortByTimeDESC&&(this.isSortByTimeDESC=!1,this.browserStorageService.saveSimpleStorage(this.examId+"_azt_setting_sort_desc_tested_by_time",this.isSortByTimeDESC.toString()))):(this.isSortByName=e.target.checked,this.testedUserList=n,this.testedUsersListByClass=this.checkSortTypeClass(i),this.browserStorageService.saveSimpleStorage(this.examId+"_azt_setting_sort_tested_by_name",e.target.checked.toString()))}sortByMarkDESC(e){let n=this.commonService.myClone(this.studentObjs),i=this.commonService.myClone(this.studentObjsInClass);e.target.checked?(this.isSortByMarkDESC=e.target.checked,this.testedUserList=this.sortService.sortMarkDESC(n,this.hasEssayQuestion),this.testedUsersListByClass=this.sortService.sortMarkStudentsInClass(i,1,this.hasEssayQuestion),this.browserStorageService.saveSimpleStorage(this.examId+"_azt_setting_sort_desc_tested_by_mark",e.target.checked.toString()),this.isSortByName&&(this.isSortByName=!1,this.browserStorageService.saveSimpleStorage(this.examId+"_azt_setting_sort_tested_by_name",this.isSortByName.toString())),this.isSortByTimeDESC&&(this.isSortByTimeDESC=!1,this.browserStorageService.saveSimpleStorage(this.examId+"_azt_setting_sort_desc_tested_by_time",this.isSortByTimeDESC.toString()))):(this.isSortByMarkDESC=e.target.checked,this.testedUserList=n,this.testedUsersListByClass=this.checkSortTypeClass(i),this.browserStorageService.saveSimpleStorage(this.examId+"_azt_setting_sort_desc_tested_by_mark",e.target.checked.toString()))}sortByTimeDESC(e){let n=this.commonService.myClone(this.studentObjs),i=this.commonService.myClone(this.studentObjsInClass);e.target.checked?(this.isSortByTimeDESC=e.target.checked,this.testedUserList=this.sortService.sortTimeDESC(n),this.testedUsersListByClass=this.sortService.sortTimeStudentsInClass(i,1),this.browserStorageService.saveSimpleStorage(this.examId+"_azt_setting_sort_desc_tested_by_time",e.target.checked.toString()),this.isSortByName&&(this.isSortByName=!1,this.browserStorageService.saveSimpleStorage(this.examId+"_azt_setting_sort_tested_by_name",this.isSortByName.toString())),this.isSortByMarkDESC&&(this.isSortByMarkDESC=!1,this.browserStorageService.saveSimpleStorage(this.examId+"_azt_setting_sort_desc_tested_by_mark",this.isSortByMarkDESC.toString()))):(this.isSortByTimeDESC=e.target.checked,this.testedUserList=n,this.testedUsersListByClass=this.checkSortTypeClass(i),this.browserStorageService.saveSimpleStorage(this.examId+"_azt_setting_sort_desc_tested_by_time",e.target.checked.toString()))}getData(){this.testedListApiService.getTestedUserObjs("tested_list",this.examId,!1).subscribe(e=>{var n,i,a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt,W,P,R,N;if(1==e.success){this.initDataTestedList=null!==(n=e.data)&&void 0!==n?n:{studentsNotInClassResults:[]},this.examObj=null!==(a=null===(i=e.data)||void 0===i?void 0:i.examObj)&&void 0!==a?a:{},this.maxGroupQuestion=null!==(l=null===(r=e.data)||void 0===r?void 0:r.maxGroupId)&&void 0!==l?l:0,this.countQuestion=null!==(d=null===(_=null===(c=e.data)||void 0===c?void 0:c.questionObjs)||void 0===_?void 0:_.length)&&void 0!==d?d:0;let V=null!==(m=this.commonService.getMyQueryParam("backto"))&&void 0!==m?m:"";if(this.countQuestion=null!==(C=null===(w=null===(p=e.data)||void 0===p?void 0:p.questionObjs)||void 0===w?void 0:w.length)&&void 0!==C?C:0,this.backToLink=V||"/admin/testbank/document-management/0/"+(null!=this.cateId?this.cateId:0)+"/1",this.countEssayQuestion=this.counterEssay(null!==(M=null===(A=e.data)||void 0===A?void 0:A.questionObjs)&&void 0!==M?M:[]),this.hasEssayQuestion=0!=this.countEssayQuestion,!(null===(D=e.data)||void 0===D)&&D.hasOwnProperty("studentsInClassResults")&&(this.testedUsersListByClass=this.changeData(null!==(q=e.data.studentsInClassResults)&&void 0!==q?q:[]),this.studentObjsInClass=this.changeData(null!==(U=e.data.studentsInClassResults)&&void 0!==U?U:[]),this.examHasClass=this.testedUsersListByClass.length>0),!(null===(F=e.data)||void 0===F)&&F.hasOwnProperty("studentsNotInClassResults")&&(this.testedUserList=this.checkStatusStudent(e.data.studentsNotInClassResults,!0),this.studentObjs=this.checkStatusStudent(e.data.studentsNotInClassResults,!0)),this.checkHasExamOffline(null!==(tt=this.examObj.hashId)&&void 0!==tt?tt:""),this.checkOfflineExam(),0==this.testedUserList.length&&0==this.testedUsersListByClass.length)this.isNotTestedYet=!0,this.errorStatusObj("NO_TESTED_YET"),this.getStatusSideNav();else{var B=this.browserStorageService.getSimpleStorage(this.examId+"_azt_setting_sort_tested_by_name"),z=this.browserStorageService.getSimpleStorage(this.examId+"_azt_setting_sort_desc_tested_by_mark"),X=this.browserStorageService.getSimpleStorage(this.examId+"_azt_setting_sort_desc_tested_by_time");let J=this.commonService.myClone(this.studentObjs),et=this.commonService.myClone(this.studentObjsInClass);this.testedUsersListByClass=this.checkSortTypeClass(et),B&&("true"==B?(this.testedUserList=this.sortService.sortFirstNameStudents(J),this.testedUsersListByClass=this.sortService.sortFirstNameStudentsInClass(et),this.isSortByName=!0):this.isSortByName=!1),z&&("true"==z?(this.testedUserList=this.sortService.sortMarkDESC(J,this.hasEssayQuestion),this.testedUsersListByClass=this.sortService.sortMarkStudentsInClass(et,1,this.hasEssayQuestion),this.isSortByMarkDESC=!0):this.isSortByMarkDESC=!1),X&&("true"==X?(this.testedUserList=this.sortService.sortTimeDESC(J),this.testedUsersListByClass=this.sortService.sortTimeStudentsInClass(et,1),this.isSortByTimeDESC=!0):this.isSortByTimeDESC=!1),this.userList=this.takeAllUserList(),setTimeout(()=>{this.checkFilterValue()},0),this.getStatusSideNav(),this.isNotTestedYet&&(this.isNotTestedYet=!1)}this.scanLoading=!1,this.successStatusObj()}else if(this.scanLoading=!1,this.isNotTestedYet=!0,this.errorStatusObj("NO_TESTED_YET"),e.data&&e.data.hasOwnProperty("errorConfigClassroomPermission"))this.examObj=null!==(W=e.data.examObj)&&void 0!==W?W:{},this.errorMissingConfigClassroomPermission=!0,this.errorMissingConfigClassroomMessage=null!==(P=e.data.errorMessage)&&void 0!==P?P:"";else{console.log("a");let V=null!==(R=this.commonService.getMyQueryParam("backto"))&&void 0!==R?R:"";this.backToLink=V||"/admin/testbank/document-management/0/"+(null!=this.cateId?this.cateId:0)+"/1",this.showErrorSnack(null!==(N=e.message)&&void 0!==N?N:"")}}),this.commonService.gaEvent("teacher_tested_list")}counterEssay(e){let n=0;return e.forEach(i=>{this.answerTypeService.isEssayAnswer(i.answerType&&i.answerType)&&n++}),n}changeData(e){var n=[];return e.forEach(i=>{var a,r;i.results=this.checkStatusStudent(null!==(a=i.results)&&void 0!==a?a:new Array,!1),i=Object.assign(Object.assign({},i),{countSubmitted:this.countSubmitted(null!==(r=i.results)&&void 0!==r?r:new Array)}),n.push(i)}),n}checkStatusStudent(e,n){var i=[];for(let a of e)this.hasEssayQuestion?a.confirmedAt&&""!=a.confirmedAt&&a.resultId&&a.resultId>0?a.isMarked=!0:a.resultId&&a.resultId>0&&(!a.confirmedAt||""==a.confirmedAt)?a.isNotMarked=!0:a.resultId&&0!=a.resultId||!a.startedTest||""==a.startedTest||0!=a.status?a.resultId&&0!=a.resultId||!a.startedTest||""==a.startedTest||-1!=a.status?null==a.startedTest&&(a.isNotTested=!0):a.isNotSubmit=!0:a.isOnTest=!0:a.resultId&&a.resultId>0?a.isMarked=!0:a.resultId&&0!=a.resultId||!a.startedTest||""==a.startedTest||0!=a.status?a.resultId&&0!=a.resultId||!a.startedTest||""==a.startedTest||-1!=a.status?null==a.startedTest&&(a.isNotTested=!0):a.isNotSubmit=!0:a.isOnTest=!0,i.push(a);return this.parseData(i,n)}countSubmitted(e){var n=0;return e.forEach(i=>{(i.isMarked||i.isNotMarked)&&n++}),n}checkHasExamOffline(e){this.offlineExamResultService.apiOfflineExamResultHasOfflineExamGet(e).subscribe(n=>{var i,a,r,l;1==n.success?(null===(i=n.data)||void 0===i?void 0:i.value)&&this.homeworkExamService.isPdfExam(null!==(a=this.examObj.examType)&&void 0!==a?a:0)?(this.hasExamOffline=!0,this.tokenScanExamOffline=null===(r=n.data)||void 0===r?void 0:r.value):(this.hasExamOffline=!1,this.tokenScanExamOffline=""):(this.hasExamOffline=!1,this.examOfflineMessage=null!==(l=n.message)&&void 0!==l?l:""),setTimeout(()=>{this.changeHeaderTitle(),this.stopStatusObj()},this.commonService.getRandomNumber(200,1e3))})}changeHeaderTitle(){var e=[...this.studentObjsInClass],n=this.studentObjs.filter(d=>1==d.isOnTest)?this.studentObjs.filter(d=>1==d.isOnTest).length:0,i=this.studentObjs.filter(d=>1==d.isNotTested)?this.studentObjs.filter(d=>1==d.isNotTested).length:0,a=0,r=0,l=this.studentObjs.length,c=0;e.forEach(d=>{var m,p,w,C,A,M;l+=null!==(p=null===(m=d.results)||void 0===m?void 0:m.length)&&void 0!==p?p:0,c+=null!==(C=null===(w=d.results)||void 0===w?void 0:w.length)&&void 0!==C?C:0,a+=null!==(A=d.results)&&void 0!==A&&A.filter(D=>1==D.isOnTest)?d.results.filter(D=>1==D.isOnTest).length:0,r+=null!==(M=d.results)&&void 0!==M&&M.filter(D=>1==D.isNotTested)?d.results.filter(D=>1==D.isNotTested).length:0});var _=l-r-a-i-n;this.totalSubmitted=_,this.totalStudentByClass=c,this.totalStudents=l,this.commonService.getTranslate("lang_auto_danh_sach_da_thi").subscribe(d=>{this.headerTitle=d+" ("+_+"/"+l+")"})}takeAllUserList(){var e=[];return this.testedUserList.forEach(n=>{var a={userid:n.userId,studentid:n.studentId,username:n.fullName,studentname:n.fullName,status:n.isOnTest?1:n.isNotMarked?2:n.isMarked?3:0};this.commonService.filterArray(e,a)||e.push(a)}),this.testedUsersListByClass.forEach(n=>{n.results&&n.results.length>0&&n.results.forEach(i=>{var r={userid:i.userId,studentid:i.studentId,username:null,studentname:i.fullName,status:i.isOnTest?1:i.isNotMarked?2:i.isMarked?3:0};this.commonService.filterArray(e,r)||e.push(r)})}),e}parseData(e,n){var i=[];return e.forEach(a=>(0,Oe.mG)(this,void 0,void 0,function*(){a.files&&""!=a.files&&!Array.isArray(a.files)&&(a.filesParse=this.commonService.myParseJson(a.files)),i.push(a)})),i}checkOfflineExam(){this.isOfflineExam=this.homeworkExamService.isOfflineExam(this.examObj.orcLogId)}ngOnInit(){this.initStatusObj(),window.scrollTo(0,0),(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var e,n,i,a;this.cateId=null!==(e=Number(this.activeRoute.snapshot.paramMap.get("cat_id")))&&void 0!==e?e:0,this.examId=null!==(n=Number(this.activeRoute.snapshot.paramMap.get("id")))&&void 0!==n?n:0,this.resultId=null!==(i=Number(this.activeRoute.snapshot.paramMap.get("result_id")))&&void 0!==i?i:0;let r=null!==(a=this.commonService.getMyQueryParam("backto"))&&void 0!==a?a:"";this.backFromStudentView=`/admin/testbank/exam-results-list/${this.cateId}/${this.examId}/${this.resultId}`,r&&r.includes("shareType")&&(this.backFromStudentView=`/admin/testbank/exam-results-list/${this.cateId}/${this.examId}/${this.resultId}?backto=`+encodeURIComponent(encodeURIComponent(r)));var l=[{source:this.monitorService.getTmpVersionMonitor(),name:"listactive.js"},{source:"https://cdn.jsdelivr.net/gh/azota889/storage_public/azota_assets/imgsdk/v3/imgsdk.js?t=1910",name:"imgsdk.js"},{source:"https://cdn.jsdelivr.net/gh/azota889/storage_public/azota_assets/imgsdk/v3/imgsdk_loader.js?t=1810",name:"imgsdk_loader.js"}];this.commonService.loadScriptPromises(l).then(()=>{this.loadedJs=!0,this.getData()})}),this.commonService.translateMetaData({title:"lang_cms_test_tested_list_title",description:"lang_cms_test_tested_list_description",image:"lang_cms_test_image"}),super.ngOnInit()}ngAfterViewInit(){setTimeout(()=>{this.checkFilterValue()},1e3)}ngOnDestroy(){this.globalService.stopIntervalFunc("tested_list"),document.body.style.overflow="auto",super.ngOnDestroy()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Be.z),t.Y36(pn.K),t.Y36(qo),t.Y36(Lh),t.Y36(nn.T),t.Y36(Ot.$4),t.Y36(yn.j),t.Y36(jn.U),t.Y36(x.gz),t.Y36(Uo.M),t.Y36(ji.An))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-exam-result-list"]],viewQuery:function(e,n){if(1&e&&t.Gf(a1,5),2&e){let i;t.iGM(i=t.CRH())&&(n.drawer=i.first)}},features:[t.qOj],decls:4,vars:3,consts:[[3,"headerBackTolink"],[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"azt-result-list"],[1,"azt-drawer-container","mt-5",3,"hasBackdrop"],[3,"ngClass","mode","opened","closedStart"],["drawer",""],[3,"config","scrollIndicators"],["onlineExam",""],[1,"azt-drawer-content",3,"ngClass"],[1,"flex","box","sm:h-auto","rounded-md","border","border-slate-200/60","dark:border-darkmode-400","p-2","text-slate-500","mb-2"],["class","btn btn-sm mr-2",3,"matTooltip","click",4,"ngIf"],[1,"relative","flex","ml-auto"],[1,"search","mr-2"],["type","text",1,"form-control","border-transparent","bg-slate-100","dark:bg-darkmode-300","py-1","px-4","w-full","lg:w-64","box","pr-10",2,"border-radius","0.375rem",3,"formControl","placeholder","keyup.enter"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","icon-name","search",1,"lucide","lucide-search","w-4","h-4","absolute","my-auto","inset-y-0","mr-3","right-0","text-slate-500","cursor-pointer",3,"click"],["cx","11","cy","11","r","8"],["x1","21","y1","21","x2","16.65","y2","16.65"],[1,"filter","mr-2"],[1,"btn","btn-sm",3,"matMenuTriggerFor"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-search","w-4","h-4","mr-0","md:mr-1"],["points","22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"],[1,"azt-hidden","md:block"],["xPosition","before"],["filterMenu","matMenu"],[1,"dropdown-menu","show","relative","w-64"],[1,"dropdown-content"],["for","isMarked",1,"dropdown-item","cursor-pointer",3,"click"],[1,"form-check","form-switch","ml-auto"],["id","isMarked","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],["for","isNotMarked",1,"dropdown-item","cursor-pointer",3,"click"],["id","isNotMarked","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],["for","isOnTest",1,"dropdown-item","cursor-pointer",3,"click"],["id","isOnTest","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],["for","isNotSubmit",1,"dropdown-item","cursor-pointer",3,"click"],["id","isNotSubmit","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],["for","isNotTested",1,"dropdown-item","cursor-pointer",3,"click"],["id","isNotTested","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],[1,"dropdown-divider"],[1,"flex","p-1"],[1,"btn","btn-secondary","py-1","px-2","ml-auto","mr-2"],[3,"click"],[1,"btn","btn-danger","py-1","px-2",3,"click"],[1,"menu"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-menu","w-4","h-4"],["x1","4","y1","12","x2","20","y2","12"],["x1","4","y1","6","x2","20","y2","6"],["x1","4","y1","18","x2","20","y2","18"],["mainMenu","matMenu"],[1,"dropdown-menu","show","relative","w-72"],[4,"ngIf"],["for","isSortByName",1,"dropdown-item","cursor-pointer",3,"click"],[1,"flex","items-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2","lucide"],["d","M11 5h4"],["d","M11 9h7"],["d","M11 13h10"],["d","m3 17 3 3 3-3"],["d","M6 18V4"],["id","isSortByName","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],["for","isSortByMarkDESC",1,"dropdown-item","cursor-pointer",3,"click"],["d","M11 5h10"],["d","M11 13h4"],["id","isSortByMarkDESC","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],["for","isSortByTimeDESC",1,"dropdown-item","cursor-pointer",3,"click"],["id","isSortByTimeDESC","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],[1,"container-fluid","app-content","pr-0",3,"ngClass"],["class","box-content py-2 mt-2",4,"ngIf"],[3,"ngIf"],[3,"dataScore","dataScoreByClass","maxGroupQuestion","examObj","questionExportObjs","currentDate","tableType","isSortByMark","isSortByTime","isSortByName","hasEssayQuestion","countEssayQuestion"],[3,"dataScore","dataScoreByClass","maxGroupQuestion","examObj","questionExportObjs","currentDate","tableType","isSortByTime","isSortByName","hasEssayQuestion","countEssayQuestion"],[3,"initData","reloadApi"],[3,"initData","userList","reloadApi"],[1,"btn","btn-sm","mr-2",3,"matTooltip","click"],["x","3","y","3","width","18","height","18","rx","2","ry","2"],["d","M9 3v18"],["d","m14 9 3 3-3 3"],["d","m16 15-3-3 3-3"],[1,"dropdown-item",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide","mr-2"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","7 10 12 15 17 10"],["x1","12","y1","15","x2","12","y2","3"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["x1","16","y1","13","x2","8","y2","13"],["x1","16","y1","17","x2","8","y2","17"],["x1","10","y1","9","x2","8","y2","9"],[1,"box-content","py-2","mt-2"],[1,"text-center","mt-3"],[1,"h4"],[3,"isSortByMark","isSortByTime","isSortByName","backToLink","searchKey","studentLists","studentListsInClass","examHasClass","isNotTestedYet","isOpenSideNav","hasEssayQuestion","totalSubmitted","totalSubmitByClass","showFileScan","obj","scanLoading","isMobile","headerTitle","mustShownResultId","notTestedOpenFileScan","goToResult","saveStudentMarkEmitFromComponent"],[3,"examObj","backToLink","loadedJs","tokenScan","hasExamOffline","examOfflineMessage","openSelect","saveStudentMarkEmit","firstSuccessResultId","showStudentMarkEmit",4,"ngIf"],[3,"examObj","backToLink","loadedJs","tokenScan","hasExamOffline","examOfflineMessage","openSelect","saveStudentMarkEmit","firstSuccessResultId","showStudentMarkEmit"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0),t.YNc(1,s1,1,0,"azt-loading-effect",1),t.YNc(2,k1,144,143,"ng-template",null,2,t.W1O),t.qZA()),2&e){const i=t.MAs(3);t.Q6J("headerBackTolink",n.backToLink),t.xp6(1),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.mk,O.O5,he.VK,he.p6,qn.jA,qn.kh,qn.LW,Wt.gM,Lt.Vv,h.Fj,h.JJ,h.oH,te.Q,mn.G,fg,de._,Fg,Af,jf,o1,at.bT,at.Pz],encapsulation:2}),o})();var $o=b(25650);function S1(o,s){if(1&o&&(t.TgZ(0,"span",18),t._uU(1),t.ALo(2,"slice"),t.qZA()),2&o){const e=t.oxw().index,n=t.oxw();t.s9C("matTooltip",n.data.resultsArr[e].fullName),t.xp6(1),t.Oqu(n.data.resultsArr[e].fullName.length>25?t.Dn7(2,2,n.data.resultsArr[e].fullName,0,25)+"..":n.data.resultsArr[e].fullName)}}function E1(o,s){if(1&o&&t._UZ(0,"img",19),2&o){const e=t.oxw().index,n=t.oxw();t.Q6J("nameImages",n.data.resultsArr[e].nameImages)}}function I1(o,s){if(1&o&&(t.TgZ(0,"div",14)(1,"mat-checkbox",15),t._uU(2),t.YNc(3,S1,3,6,"span",16),t.YNc(4,E1,1,1,"img",17),t.qZA()()),2&o){const e=s.index,n=t.oxw();t.xp6(1),t.Q6J("checked",n.form.value.exports[e])("formControlName",e),t.xp6(1),t.hij(" ",e+1,". "),t.xp6(1),t.Q6J("ngIf",!n.data.resultsArr[e].nameImages||n.data.resultsArr[e].studentId>0),t.xp6(1),t.Q6J("ngIf",n.data.resultsArr[e].nameImages&&n.data.resultsArr[e].studentId<=0)}}const Z1=function(o){return{selects:o}};function M1(o=1){return e=>e.controls.map(i=>i.value).reduce((i,a)=>a?i+a:i,0)>=o?null:{required:!0}}let P1=(()=>{class o{constructor(e,n,i){this.dialogRef=e,this.fb=n,this.data=i,this.form=new h.nJ({}),this.isSelectAll=new h.p4}get exportsFormArray(){return this.form.controls.exports}get countSelected(){return this.exportsFormArray.value.filter(e=>!0===e).length}selectAll(){const e=[];this.data.resultsArr.forEach(()=>{e.push(this.isSelectAll.value)}),this.form.controls.exports.setValue(e)}ngOnInit(){this.form=this.fb.group({exports:new h.vC([],M1(1))}),this.data.resultsArr.forEach(()=>{this.exportsFormArray.push(new h.p4(!1))})}onNoClick(){this.dialogRef.close()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(j.so),t.Y36(h.QS),t.Y36(j.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["what-export-dialog"]],decls:28,vars:28,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-5"],[1,"text-center","mb-2"],[1,"text-md","font-medium"],[1,"clickable","flex","items-center",2,"font-weight","500"],["color","primary",1,"example-margin",3,"formControl","change"],["mat-dialog-content","",1,"mt-3"],[3,"formGroup"],[1,"grid","grid-cols-12","gap-3","pl-0","pl-0"],["class","col-span-12 md:col-span-3","formArrayName","exports",4,"ngFor","ngForOf"],[1,"p-3","text-right"],[1,"btn","btn-secondary","w-24","mr-2",3,"click"],[1,"btn","w-24","btn-danger",3,"disabled","mat-dialog-close"],["formArrayName","exports",1,"col-span-12","md:col-span-3"],["color","primary",1,"mr-2","mb-2",3,"checked","formControlName"],[3,"matTooltip",4,"ngIf"],["appDrawNameImage","","loading","lazy","style","width: 100%; height: auto",3,"nameImages",4,"ngIf"],[3,"matTooltip"],["appDrawNameImage","","loading","lazy",2,"width","100%","height","auto",3,"nameImages"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()(),t.TgZ(7,"p")(8,"i"),t._uU(9),t.ALo(10,"mytranslate"),t.ALo(11,"mytranslate"),t.qZA()(),t.TgZ(12,"span",5)(13,"mat-checkbox",6),t.NdJ("change",function(){return n.selectAll()}),t._uU(14),t.ALo(15,"mytranslate"),t.ALo(16,"mytranslate"),t.qZA()(),t.TgZ(17,"div",7)(18,"form",8)(19,"div",9),t.YNc(20,I1,5,5,"div",10),t.qZA()()(),t.TgZ(21,"div",11)(22,"button",12),t.NdJ("click",function(){return n.onNoClick()}),t._uU(23),t.ALo(24,"mytranslate"),t.qZA(),t.TgZ(25,"button",13),t._uU(26),t.ALo(27,"mytranslate"),t.qZA()()()()()),2&e&&(t.xp6(5),t.hij(" ",t.lcZ(6,12,"lang_testbank_what_to_export_select_students_export"),"! "),t.xp6(4),t.lnq("*** ",t.lcZ(10,14,"lang_testbank_what_to_export_note_tutorial")," (",t.lcZ(11,16,"lang_choose"),": ",n.countSelected,")"),t.xp6(4),t.Q6J("formControl",n.isSelectAll),t.xp6(1),t.Oqu(n.isSelectAll.value?t.lcZ(15,18,"lang_remove_all"):t.lcZ(16,20,"lang_select_all")),t.xp6(4),t.Q6J("formGroup",n.form),t.xp6(2),t.Q6J("ngForOf",n.exportsFormArray.controls),t.xp6(3),t.hij(" ",t.lcZ(24,22,"lang_buttom_cancel_clear")," "),t.xp6(2),t.Q6J("disabled",!n.form.valid)("mat-dialog-close",t.VKq(26,Z1,n.exportsFormArray.value)),t.xp6(1),t.hij(" ",t.lcZ(27,24,"lang_buttom_agree")," "))},dependencies:[O.sg,O.O5,Co.oG,j.ZT,j.xY,Wt.gM,h._Y,h.JJ,h.JL,h.oH,h.sg,h.u,h.CE,oe.M,$n.L,O.OU,at.bT],encapsulation:2}),o})(),Fn=(()=>{class o{constructor(e,n,i,a,r,l,c){this.commonService=e,this.examPageResultService=n,this.permissionService=i,this.globalService=a,this.browserStorageService=r,this.gzipHelper=l,this.homeworkExamService=c}getTestedUserObjs(e,n,i){return this.globalService.startIntervalFunc(e),this.getTestedOfExamResult(e,n,"default",i)}getTestedLastMark(e,n){return this.globalService.startIntervalFunc(e),this.getTestedOfExamResult(e,n,"last")}getTestedHighestMark(e,n){return this.globalService.startIntervalFunc(e),this.getTestedOfExamResult(e,n,"highest")}getTestedFirstMark(e,n){return this.globalService.startIntervalFunc(e),this.getTestedOfExamResult(e,n,"first")}getTestedAllResult(e,n){return this.globalService.startIntervalFunc(e),this.getTestedOfExamResult(e,n,"all")}getTestedOfExamResult(e,n,i,a){return new Nn.y(r=>{var l,c="tested_list_result_v2_"+n,_=null!==(l=this.browserStorageService.getSimpleStorage(c))&&void 0!==l?l:"",d=this.commonService.willDeleteParseJson(_)&&this.commonService.willDeleteParseJson(_).data?this.commonService.willDeleteParseJson(this.gzipHelper.resultContentSuport(this.commonService.willDeleteParseJson(_).data)):void 0;a&&d?(r.next({status:200,success:1,data:d,message:"successful"}),r.complete()):this.examPageResultService.apiExamPageResultGetResultGet(n).subscribe(m=>{var p,w,C,A,M,D,q,U,F,tt,W,P,R,N,B,z;if(1==m.success){var X=null!==(w=null===(p=m.data)||void 0===p?void 0:p.serverSecond)&&void 0!==w?w:0,V=null!==(A=null===(C=m.data)||void 0===C?void 0:C.examObj)&&void 0!==A?A:{},J=null!==(D=null===(M=m.data)||void 0===M?void 0:M.classroomWithAvatarAndStudentObjs)&&void 0!==D?D:new Array,et=null!==(U=null===(q=m.data)||void 0===q?void 0:q.totalAttended)&&void 0!==U?U:0,ot=null!==(tt=null===(F=m.data)||void 0===F?void 0:F.examQuestionObjs)&&void 0!==tt?tt:new Array,ut=null!==(P=null===(W=m.data)||void 0===W?void 0:W.fileTypeStr)&&void 0!==P?P:"";if(this.permissionService.hasViewPermission("exam",V.permissionObj)||this.permissionService.hasConfigAndViewClassroomPermission("exam",V.permissionObj)||this.permissionService.hasConfigAndMarkClassroomPermission("exam",V.permissionObj))this.getAllExamResultObjs(e,[],n,"",rt=>{var xt,ht,gt,dt,yt,bt,At,kt,Qt,Bt,Gt,ne,ae,Jt,ie,$t,be,Ce,Ae,Se,Pe,Yt,sn,He,ze,rn;if(rt.hasOwnProperty("success")&&1==rt.success){var ye=this.mergeStudentWithAvatar(null!==(xt=rt.studentWithResultObjs)&&void 0!==xt?xt:[]),qe={},Qe={},Le=[];null==ye||ye.forEach(xe=>{var we,ee,Ft,ue=null!==(we=xe.parentId)&&void 0!==we?we:"0";qe.hasOwnProperty(ue)||(qe[ue]=null!==(ee=xe.examResultObjs)&&void 0!==ee?ee:[]),Qe.hasOwnProperty(ue)||(Qe[ue]=null!==(Ft=xe.nameImages)&&void 0!==Ft?Ft:{}),Le=Le.concat(qe[ue])});var Ne=this.filterExamResultOnTest(Le,V,X),Ye=[],Ue=[];if(this.homeworkExamService.mustInClassroom(null!==(ht=V.whoAllow)&&void 0!==ht?ht:0)&&J.length>0)for(var gn=0;gn<J.length;gn++){var Xn=J[gn].classroomObj,Kt=null!==(gt=J[gn].studentObjs)&&void 0!==gt?gt:[],fn=[];if(Kt.length>0)for(var Vt=0;Vt<Kt.length;Vt++){var Rn=null!==(dt=Kt[Vt].parentId)&&void 0!==dt?dt:"0";this.commonService.filterArray(Ue,Kt[Vt].parentId)||Ue.push(null!==(yt=Kt[Vt].parentId)&&void 0!==yt?yt:"0"),qe.hasOwnProperty(Rn)&&(Array.isArray(Kt[Vt].examResultObjs)||(Kt[Vt].examResultObjs=[]),Kt[Vt].examResultObjs=this.findExamResultOfStudent(null!==(At=null===(bt=Kt[Vt].examResultObjs)||void 0===bt?void 0:bt.concat(qe[Rn]))&&void 0!==At?At:[],null!==(kt=Kt[Vt].id)&&void 0!==kt?kt:0));var On=Ne.hasOwnProperty(null!==(Qt=Kt[Vt].parentId)&&void 0!==Qt?Qt:0)?Ne[null!==(Bt=Kt[Vt].parentId)&&void 0!==Bt?Bt:0]:0;if("all"==i)if(null!==(Gt=Kt[Vt].examResultObjs)&&void 0!==Gt&&Gt.length)null===(ne=Kt[Vt].examResultObjs)||void 0===ne||ne.forEach((xe,we)=>{var ee,Ft,ue,Fe=null!==(ee=this.commonService.castJsonToObj(JSON.stringify(xe)))&&void 0!==ee?ee:{};Fe.resultId=Fe.testStatus&&Fe.testStatus>0?Fe.id:0;var Pt=this.createStudentWithResult(Kt[Vt],Fe,On,ot.length,we,null!==(ue=null===(Ft=Kt[Vt].examResultObjs)||void 0===Ft?void 0:Ft.length)&&void 0!==ue?ue:0);fn.push(Pt)});else{var ti=this.createStudentWithResult(Kt[Vt],{},On,ot.length,-1,0);fn.push(ti)}else{var Bn=this.filterExamResultByType(null!==(ae=Kt[Vt].examResultObjs)&&void 0!==ae?ae:[],i),ei=Bn.hasOwnProperty(null!==(Jt=Kt[Vt].parentId)&&void 0!==Jt?Jt:0)?Bn[null!==(ie=Kt[Vt].parentId)&&void 0!==ie?ie:0]:{},ni=this.createStudentWithResult(Kt[Vt],ei,On,ot.length,-1,0);fn.push(ni)}}Ye.push({classObj:Xn,results:fn})}for(var Ge=[],le=null!==($t=this.commonService.myClone(ye))&&void 0!==$t?$t:[],fe=0;fe<(null==le?void 0:le.length);fe++)if(!this.commonService.filterArray(Ue,le[fe].parentId)){let xe=Ne.hasOwnProperty(null!==(be=le[fe].parentId)&&void 0!==be?be:0)?Ne[null!==(Ce=le[fe].parentId)&&void 0!==Ce?Ce:0]:0;if("all"==i)null!==(Ae=le[fe].examResultObjs)&&void 0!==Ae&&Ae.length?null===(Se=le[fe].examResultObjs)||void 0===Se||Se.forEach((we,ee)=>{var Ft,ue,Fe;let Pt=null!==(Ft=this.commonService.castJsonToObj(JSON.stringify(we)))&&void 0!==Ft?Ft:{};Pt.resultId=Pt.testStatus&&Pt.testStatus>0?Pt.id:0,Ge.push(this.createStudentWithResult(le[fe],Pt,xe,ot.length,ee,null!==(Fe=null===(ue=le[fe].examResultObjs)||void 0===ue?void 0:ue.length)&&void 0!==Fe?Fe:0))}):Ge.push(this.createStudentWithResult(le[fe],{},xe,ot.length,-1,0));else{let we=this.filterExamResultByType(null!==(Pe=le[fe].examResultObjs)&&void 0!==Pe?Pe:[],i),ee=we.hasOwnProperty(null!==(Yt=le[fe].parentId)&&void 0!==Yt?Yt:0)?we[null!==(sn=le[fe].parentId)&&void 0!==sn?sn:0]:{};Ge.push(this.createStudentWithResult(le[fe],ee,xe,ot.length,-1,0))}}"all"!=i&&Ge.sort((xe,we)=>{var ee,Ft;return this.compareTwoDate(null!==(ee=xe.createdAt)&&void 0!==ee?ee:"",null!==(Ft=we.createdAt)&&void 0!==Ft?Ft:"")});var Jn={studentsInClassResults:Ye.length>0?Ye:[],studentsNotInClassResults:Ge.length>0?Ge:[],totalAttended:et,totalUsers:0,examObj:V,questionObjs:ot,fileTypeStr:ut,errorConfigClassroomPermission:null===(He=m.data)||void 0===He?void 0:He.errorConfigClassroomPermission,errorMessage:null===(ze=m.data)||void 0===ze?void 0:ze.errorMessage};if("export_tool"!=e){(this.browserStorageService.getSizeOfStorageByKey("tested_list_result_v2")>2||this.browserStorageService.getSizeOfStorage()>4.5)&&this.browserStorageService.removeSimpleStorageByKey("tested_list_result_v2");var Hn=this.gzipHelper.zipBigContent(JSON.stringify(Jn));this.browserStorageService.saveSimpleStorage(c,Hn)}r.next({status:200,success:1,data:Jn,message:"successful"}),r.complete()}else r.next({status:rt.code,success:0,data:null,message:null!==(rn=rt.message)&&void 0!==rn?rn:""}),r.complete()});else{var lt={studentsInClassResults:[],studentsNotInClassResults:[],totalAttended:et,totalUsers:0,examObj:V,questionObjs:ot,fileTypeStr:null===(R=m.data)||void 0===R?void 0:R.fileTypeStr,errorConfigClassroomPermission:null===(N=m.data)||void 0===N?void 0:N.errorConfigClassroomPermission,errorMessage:null===(B=m.data)||void 0===B?void 0:B.errorMessage};r.next({status:200,success:1,data:lt,message:"successful"}),r.complete()}}else r.next({status:m.code,success:0,data:null,message:null!==(z=m.message)&&void 0!==z?z:""}),r.complete()})})}getAllExamResultObjs(e,n,i,a,r){this.examPageResultService.apiExamPageResultGetObjsV2Get(i,"test_review"==e||"export_tool"==e?"export":"tested_list",a).subscribe(c=>{var _,d,m;1==c.success?(!(null===(_=c.data)||void 0===_)&&_.objs&&n.push(...c.data.objs),null!==(d=c.data)&&void 0!==d&&d.nextPage?this.globalService.isStopIntervalFunc(e)?r({studentWithResultObjs:n,success:1}):setTimeout(()=>{var p,w;this.getAllExamResultObjs(e,n,i,null!==(w=null===(p=c.data)||void 0===p?void 0:p.nextPage)&&void 0!==w?w:"",r)},300):r({studentWithResultObjs:n,success:1})):r({code:c.code,studentWithResultObjs:[],success:0,message:null!==(m=c.message)&&void 0!==m?m:""})})}compareTwoDate(e,n){var i=new Date(e).getTime();i=isNaN(i)?0:i;var a=new Date(n).getTime();return i-(a=isNaN(a)?0:a)>0?1:i-a<0?-1:0}filterExamResultOnTest(e,n,i){var a={};return e.forEach(r=>{var l,c,_,d,m,p,w,C,A=null!==(l=this.commonService.myClone(r))&&void 0!==l?l:{};if(A.testStatus)a[null!==(c=A.userId)&&void 0!==c?c:0]=A.testStatus;else if(A.startedTest&&i)if(n.endTime){var M=Math.floor(new Date(n.endTime).getTime()/1e3);i<=M+60*(null!==(_=n.minutes)&&void 0!==_?_:0)+600?a[null!==(d=A.userId)&&void 0!==d?d:0]=0:a[null!==(m=A.userId)&&void 0!==m?m:0]=-1}else{var D=A.startedTest?Math.floor(new Date(A.startedTest).getTime()/1e3):0;i<=D+86400?a[null!==(p=A.userId)&&void 0!==p?p:0]=0:a[null!==(w=A.userId)&&void 0!==w?w:0]=-1}else a[null!==(C=A.userId)&&void 0!==C?C:0]=0}),a}filterExamResultByType(e,n){var i,a,r={};if(e.length>1)e.forEach(c=>{var _,d,m,p,w,C,A,M,D,q,U,F=null!==(_=this.commonService.myClone(c))&&void 0!==_?_:{};c.testStatus&&(F.resultId=F.id,"default"==n&&(r[null!==(d=F.userId)&&void 0!==d?d:0]=F),"last"==n&&(r[null!==(m=F.userId)&&void 0!==m?m:0]=F),"first"==n&&(r.hasOwnProperty(null!==(p=F.userId)&&void 0!==p?p:0)||(r[null!==(w=F.userId)&&void 0!==w?w:0]=F)),"highest"==n)&&(r.hasOwnProperty(null!==(C=F.userId)&&void 0!==C?C:0)?(null!==(D=r[null!==(M=F.userId)&&void 0!==M?M:0].mark)&&void 0!==D?D:-1)<=(null!==(q=F.mark)&&void 0!==q?q:-1)&&(r[null!==(U=F.userId)&&void 0!==U?U:0]=F):r[null!==(A=F.userId)&&void 0!==A?A:0]=F)});else{var l=null!==(i=this.commonService.myClone(e[0]))&&void 0!==i?i:{};l.resultId=l.testStatus?l.id:0,r[null!==(a=l.userId)&&void 0!==a?a:0]=l}return r}findExamResultOfStudent(e,n){var i=[];return e.forEach(a=>{(a.studentId==n||null==a.studentId)&&i.push(a)}),i}addResultIdToExamResult(e){var n=[];return e.forEach(i=>{var a;let r=null!==(a=this.commonService.myClone(i))&&void 0!==a?a:{};r.resultId=r.id,r.testStatus&&n.push(r)}),n}compareLengthWithExamQuestion(e,n){var i=this.commonService.myClone(e);if(n>0&&e.length<n)for(var a=0;a<n-e.length;a++)i.push("");return i}mergeStudentWithAvatar(e){var n=[];return e.forEach(i=>{var a,r,l=n.filter(_=>_.parentId==i.parentId);if(l&&0!=l.length)for(var c=0;c<n.length;c++)n[c].parentId==i.parentId&&(n[c].examResultObjs=null===(a=n[c].examResultObjs)||void 0===a?void 0:a.concat(null!==(r=i.examResultObjs)&&void 0!==r?r:[]));else n.push(i)}),n}createStudentWithResult(e,n,i,a,r,l){var c,_,d;return{id:e.id,userId:e.parentId,studentId:e.id,fullName:e.fullName,gender:e.gender,avatar:e.avatar,birthday:e.birthday,resultId:n.hasOwnProperty("resultId")?n.resultId:0,answers:n.hasOwnProperty("answers")?n.answers:null,rightAnswer:n.hasOwnProperty("rightAnswer")?n.rightAnswer:0,totalQuestion:n.hasOwnProperty("totalQuestion")?n.totalQuestion:0,mark:n.hasOwnProperty("mark")?n.mark:null,trueFalseMark:n.hasOwnProperty("trueFalseMark")?n.trueFalseMark:null,essayMark:n.hasOwnProperty("essayMark")?n.essayMark:null,files:n.hasOwnProperty("files")?n.files:null,infors:n.hasOwnProperty("infors")?n.infors:null,confirmedAt:n.hasOwnProperty("confirmedAt")?n.confirmedAt:null,startedTest:n.hasOwnProperty("startedTest")?n.startedTest:null,createdAt:n.hasOwnProperty("createdAt")?n.createdAt:null,allResultObjs:this.addResultIdToExamResult(null!==(c=e.examResultObjs)&&void 0!==c?c:[]),classroomIds:[],eventTracks:{},status:i,nameImages:e.nameImages,nameImage:"",answerMixObjs:null!==(d=this.compareLengthWithExamQuestion(null!==(_=n.answerMixObjs)&&void 0!==_?_:[],a))&&void 0!==d?d:[],testedTime:r+1,totalTestTime:l}}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(vt.v),t.LFG(Ot.DR),t.LFG(Xe.$),t.LFG(jn.U),t.LFG(Be.z),t.LFG(Qo.n),t.LFG(yn.j))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Wo=b(296),Ko=b(16031),Wi=b(20814),Vo=b(42193),Xo=b(32502),ta=b(79814),Ci=b(99568),ea=b(62e3),L1=b(1643),Kn=b(62201),N1=b(69359);function D1(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(null==e.studentObj?null:e.studentObj.fullName)}}function j1(o,s){if(1&o&&(t.TgZ(0,"span"),t._UZ(1,"img",15),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("nameImages",e.studentObj.nameImages)}}function q1(o,s){if(1&o&&(t.TgZ(0,"h3",11),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw();let n;t.xp6(1),t.HOy("",t.lcZ(2,4,"lang_auto_trac_nghiem"),": ",null==e.examResultObj?null:e.examResultObj.trueFalseMark," (",null==e.examResultObj?null:e.examResultObj.rightAnswer,"/",(null!==(n=null==e.examResultObj?null:e.examResultObj.totalQuestion)&&void 0!==n?n:0)-e.countEssayQuestion,")")}}function Q1(o,s){if(1&o&&(t.TgZ(0,"h3",11),t._uU(1),t.ALo(2,"mytranslate"),t.ALo(3,"mytranslate"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.AsE("",t.lcZ(2,2,"lang_auto_tu_luan"),": ",(null==e.examResultObj?null:e.examResultObj.essayMark)+" ("+e.countEssayQuestion+" "+t.lcZ(3,4,"lang_auto_cau_brackets"),"")}}function U1(o,s){if(1&o&&(t.TgZ(0,"h3",11),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.AsE("",t.lcZ(2,2,"lang_auto_so_file_da_nop"),": ",null==e.iframeEssayResultObj.pages?null:e.iframeEssayResultObj.pages.length,"")}}function F1(o,s){if(1&o&&(t.TgZ(0,"h3",11),t._uU(1),t.ALo(2,"mytranslate"),t.qZA(),t.TgZ(3,"h3",11),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.AsE("",t.lcZ(2,4,"lang_auto_so_lan_thoat_man_hinh"),": ",e.examTracks.exitFullScreen,""),t.xp6(3),t.AsE("",t.lcZ(5,6,"lang_auto_so_lan_thoat_trinh_duyet"),": ",e.examTracks.blurWindow,"")}}function R1(o,s){if(1&o&&t._UZ(0,"azt-loaded-img",16),2&o){const e=t.oxw();t.Tol("mb-1 "+e.blockItemCropClass),t.Q6J("isRetry",!1)("imgSrc",e.examObj.examHeader)}}function B1(o,s){if(1&o&&(t.TgZ(0,"div",21),t._uU(1),t.ALo(2,"mytranslate"),t.ALo(3,"mytranslate"),t.qZA()),2&o){const e=t.oxw(2).$implicit;let n;t.xp6(1),t.HOy(" ",t.lcZ(2,4,"lang_auto_da_cham"),": ",null!==(n=e.essayMarkParsed)&&void 0!==n?n:0," ",t.lcZ(3,6,"lang_auto_diem_toi_da"),": ",null!==(n=e.scorePerQuestion)&&void 0!==n?n:0,") ")}}function J1(o,s){if(1&o&&(t.TgZ(0,"div",21),t._uU(1),t.ALo(2,"mytranslate"),t.ALo(3,"mytranslate"),t.qZA()),2&o){const e=t.oxw(2).$implicit;let n;t.xp6(1),t.lnq(" ",t.lcZ(2,3,"lang_auto_diem_toi_da"),": ",null!==(n=e.scorePerQuestion)&&void 0!==n?n:0," ",t.lcZ(3,5,"lang_auto_chua_cham_brackets")," ")}}function H1(o,s){if(1&o&&(t.TgZ(0,"div",19),t.YNc(1,B1,4,8,"div",20),t.YNc(2,J1,4,7,"div",20),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.examResultObj?null:e.examResultObj.confirmedAt),t.xp6(1),t.Q6J("ngIf",!(null!=e.examResultObj&&e.examResultObj.confirmedAt))}}const z1=function(o){return{__CANVAS_CROP_ITEM:o}};function Y1(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"azt-standalone-question",17),t.NdJ("doneRender",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.doneRender())}),t.ALo(1,"isOneChoiceAnswer"),t.ALo(2,"isFillAnswer"),t.YNc(3,H1,3,2,"div",18),t.ALo(4,"isEssayAnswer"),t.qZA()}if(2&o){const e=s.$implicit,n=s.index,i=t.oxw();t.Q6J("answerSizeManager",i.answerSizeManager)("startQuestionIndex",i.examObj.startQuestionIndex)("isDisplayInExportMode",!0)("mathJaxImage",!0)("follower",i.followerRenderQuest)("userAnswersObj",i.userAnswersObj)("question",e)("index",n)("configExam",i.examObj)("isRoleTeacher",!0)("index",n)("isBackEnd",!0)("displayScreen",4)("disableLazy",!0)("ngClass",t.VKq(22,z1,t.lcZ(1,16,e.answerType)||t.lcZ(2,18,e.answerType))),t.xp6(3),t.Q6J("ngIf",t.lcZ(4,20,e.answerType))}}function G1(o,s){if(1&o&&(t.ynx(0,24),t._UZ(1,"azt-export-essay-template",25),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("blockItemCropClass",e.blockItemCropClass)("blockItemEssayCropClass",e.blockItemEssayCropClass)("result",e.iframeEssayResultObj)}}function $1(o,s){if(1&o&&(t.TgZ(0,"h2"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw(2);t.Tol("text-center mt-2 "+e.blockItemCropClass),t.xp6(1),t.Oqu(t.lcZ(2,4,"lang_auto_khong_co_anh_bai_lam_tu_luan"))}}function W1(o,s){if(1&o&&(t.YNc(0,G1,2,3,"ng-container",22),t.YNc(1,$1,3,6,"ng-template",null,23,t.W1O)),2&o){const e=t.MAs(2),n=t.oxw();t.Q6J("ngIf",n.iframeEssayResultObj&&n.iframeEssayResultObj.pages&&n.iframeEssayResultObj.pages.length>0)("ngIfElse",e)}}let na=(()=>{class o extends mt.Q{constructor(e,n,i){super(n),this.exportPdfUtilsService=e,this.commonService=n,this.answerTypeService=i,this.examResultId=0,this.classroomName="",this.examQuestionObjs=[],this.examObj={},this.studentObj=void 0,this.examResultObj=void 0,this.userAnswersObj={},this.hasEssay=!1,this.hasMultiple=!1,this.isProcessingPdf=!1,this.isProcessingSinglePdf=!1,this.answerSizeManager=0,this.followerRenderQuest=new Ci.G,this.countEssayQuestion=0,this.countRenderQuestion=0}doneRender(){this.countRenderQuestion++,this.countRenderQuestion===this.questionList.length&&(this.answerSizeManager=0,this.commonService.pushSvgOutputMathJax().then(()=>{this.commonService.convertMathJaxContentSVG().then(()=>{this.answerSizeManager=1,this.countRenderQuestion=0})}))}ngOnInit(){this.blockItemCropClass=this.exportPdfUtilsService.blockCropItemClass,this.blockItemEssayCropClass=this.exportPdfUtilsService.blockEssayCropItemClass,this.followerRenderQuest.setNumQuest(this.questionList.length||0),this.countEssayQuestion=this.questionList.filter(e=>this.answerTypeService.isEssayAnswer(e.answerType)).length,super.ngOnInit()}ngOnDestroy(){this.commonService.pushHtmlOutputMathJax().then(()=>{}),super.ngOnDestroy()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Wi.V),t.Y36(vt.v),t.Y36(nn.T))},o.\u0275cmp=t.Xpm({type:o,selectors:[["azt-export-template"]],inputs:{examResultId:"examResultId",classroomName:"classroomName",questionList:"questionList",examQuestionObjs:"examQuestionObjs",examObj:"examObj",examTracks:"examTracks",studentObj:"studentObj",examResultObj:"examResultObj",userAnswersObj:"userAnswersObj",iframeEssayResultObj:"iframeEssayResultObj",hasEssay:"hasEssay",hasMultiple:"hasMultiple",isProcessingPdf:"isProcessingPdf",isProcessingSinglePdf:"isProcessingSinglePdf",newFirstInGroupIndexes:"newFirstInGroupIndexes"},features:[t.qOj],decls:29,vars:30,consts:[["id","multipleChoiceWrap",1,"exportPdfMode","exportPdfModeIndex"],["id","multipleChoiceWrapHeader"],["id","mainTitle",1,"text-center","text-xl","font-medium"],[4,"ngIf"],["id","examName",1,"mb-1","text-sm","font-medium"],["id","className",1,"mb-2","text-sm","font-medium"],["id","detailInfo",1,"flex","justify-between"],["id","colLeftInfo"],["class","mb-0 text-sm font-medium",4,"ngIf"],[3,"ngIf"],["id","colRightInfo"],[1,"mb-0","text-sm","font-medium"],["id","copyRight"],["style","display: block;","id","examHeader",3,"isRetry","class","imgSrc",4,"ngIf"],["ngFor","",3,"ngForOf"],["id","nameDrawImage","appDrawNameImage","","loading","lazy","alt","",2,"max-width","100%","height","auto",3,"nameImages"],["id","examHeader",2,"display","block",3,"isRetry","imgSrc"],[3,"answerSizeManager","startQuestionIndex","isDisplayInExportMode","mathJaxImage","follower","userAnswersObj","question","index","configExam","isRoleTeacher","isBackEnd","displayScreen","disableLazy","ngClass","doneRender"],["questionEssayInfo","","class","py-3 m-1","style","font-weight: 500;",4,"ngIf"],["questionEssayInfo","",1,"py-3","m-1",2,"font-weight","500"],["class","_essayMarkInfo",4,"ngIf"],[1,"_essayMarkInfo"],["style","text-align: center;",4,"ngIf","ngIfElse"],["noSubmit",""],[2,"text-align","center"],[3,"blockItemCropClass","blockItemEssayCropClass","result"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2)(3,"span"),t._uU(4),t.ALo(5,"mytranslate"),t.YNc(6,D1,2,1,"span",3),t.YNc(7,j1,2,1,"span",3),t.qZA()(),t.TgZ(8,"h3",4),t._uU(9),t.ALo(10,"mytranslate"),t.qZA(),t.TgZ(11,"h3",5),t._uU(12),t.ALo(13,"mytranslate"),t.qZA(),t.TgZ(14,"div",6)(15,"div",7),t.YNc(16,q1,3,6,"h3",8),t.YNc(17,Q1,4,6,"h3",8),t.YNc(18,U1,3,4,"h3",8),t.YNc(19,F1,6,8,"ng-template",9),t.qZA(),t.TgZ(20,"div",10)(21,"h3",11),t._uU(22),t.ALo(23,"mytranslate"),t.qZA()()()(),t.TgZ(24,"div",12),t._uU(25,"* * * * *"),t.qZA(),t.YNc(26,R1,1,5,"azt-loaded-img",13),t.YNc(27,Y1,5,24,"ng-template",14),t.YNc(28,W1,3,2,"ng-template",9),t.qZA()),2&e){let i,a;t.xp6(1),t.Tol("mb-5 "+n.blockItemCropClass),t.xp6(3),t.hij(" ",t.lcZ(5,22,"lang_auto_thi_sinh"),": "),t.xp6(2),t.Q6J("ngIf",!(null!=n.studentObj&&n.studentObj.nameImages)||(null!==(i=null==n.studentObj?null:n.studentObj.id)&&void 0!==i?i:0)>0),t.xp6(1),t.Q6J("ngIf",n.studentObj&&n.studentObj.nameImages&&(null!==(a=null==n.studentObj?null:n.studentObj.id)&&void 0!==a?a:0)<=0),t.xp6(2),t.AsE("",t.lcZ(10,24,"lang_auto_de_thi"),": ",n.examObj.name,""),t.xp6(3),t.AsE("",t.lcZ(13,26,"lang_auto_lop"),": ",n.classroomName,""),t.xp6(4),t.Q6J("ngIf",n.hasMultiple),t.xp6(1),t.Q6J("ngIf",n.hasEssay),t.xp6(1),t.Q6J("ngIf",n.hasEssay&&n.iframeEssayResultObj),t.xp6(1),t.Q6J("ngIf",n.examTracks&&0!=n.examObj.autoMonitor),t.xp6(3),t.AsE("",t.lcZ(23,28,"lang_auto_ma_bai_lam"),": ",n.examResultId,""),t.xp6(2),t.Tol("mb-3 "+n.blockItemCropClass),t.xp6(2),t.Q6J("ngIf",n.examObj.examHeader),t.xp6(1),t.Q6J("ngForOf",n.questionList),t.xp6(1),t.Q6J("ngIf",n.hasEssay)}},dependencies:[O.mk,O.sg,O.O5,ea.l,L1.p,$n.L,Kn.$,N1.s,at.bT,at.DC,at.Tf,at.UG],styles:["#multipleChoiceWrap[_ngcontent-%COMP%]{padding:30px;position:relative;background-color:#fff}#copyRight[_ngcontent-%COMP%]{text-align:center;font-size:14px;color:#bebebe}#test_review_container[_ngcontent-%COMP%]{background:#ecf0f5;flex:auto;padding-top:15px}#tester-info[_ngcontent-%COMP%]{width:300px;padding:15px;background-color:#fff;margin:0 auto;position:sticky;top:10px;max-height:calc(100vh - 10px);display:flex;flex-direction:column;max-width:100%;border-radius:3px;border:1px solid #f1f1f1}#short_cut_mobile[_ngcontent-%COMP%]{display:none}#fullPoint[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid #f1f1f1;background-color:#fafafa;padding:10px;margin-top:15px;align-items:center}#fullPoint[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%]{font-weight:500;font-size:130%}.tested-times[_ngcontent-%COMP%]{margin-top:15px}.tested-times[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{border:1px solid #f1f1f1;background-color:#fafafa;padding:10px}.tested-times[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;border:1px solid #f1f1f1;border-top:none;margin-bottom:0;background-color:#fff;padding:10px}.tested-times[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px}.tested-times[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.tested-times[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.select[_ngcontent-%COMP%]{font-weight:500}.tested-times[_ngcontent-%COMP%]:last-child{flex:auto;overflow:auto}.fading_layer[_ngcontent-%COMP%]{position:absolute;z-index:9;background-color:#ffffffe3;width:100%;height:100%;top:0;left:0;padding-top:200px;text-align:center;color:#a9a9a9;font-size:16px}#filterWrap[_ngcontent-%COMP%]{position:absolute;right:0;top:-4px;z-index:2}.viewWrong[_ngcontent-%COMP%]   .correct[_ngcontent-%COMP%], .viewRight[_ngcontent-%COMP%]   .incorrect[_ngcontent-%COMP%]{display:none}#col_examContent_wrap[_ngcontent-%COMP%]{width:1100px;margin:0 auto}#col_examContent_wrap[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{position:fixed;right:5px;top:50%;z-index:3;font-size:35px;width:40px;height:40px;display:flex;align-items:center;justify-content:center;background-color:#c9c9c97a;border-radius:50%;color:#fff;margin-top:-20px}#col_examContent_wrap[_ngcontent-%COMP%] > mat-icon.prev_icon[_ngcontent-%COMP%]{left:5px}#mbTestContent[_ngcontent-%COMP%]{position:relative}#mbTestContent[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{display:none;position:absolute;top:12px;color:#646464;z-index:100}#test_review_container.toggleNavInfo[_ngcontent-%COMP%]   #col_std_info[_ngcontent-%COMP%]{left:0}#close_button[_ngcontent-%COMP%]{color:red;position:absolute;right:5px;top:5px}@media screen and (max-width: 320px){#tester-info[_ngcontent-%COMP%]{width:100%}}@media screen and (max-width: 480px){#mbTestContent[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{display:inline-block}#test_review_container[_ngcontent-%COMP%]{padding-top:0}#col_std_info[_ngcontent-%COMP%]{position:fixed;top:0;left:-100%;z-index:99999;background:rgba(0,0,0,.6117647059);bottom:0;padding:0;transition:all .5s}#short_cut_mobile[_ngcontent-%COMP%]{display:flex;font-weight:500;font-size:18px;justify-content:space-between;color:#4a4a4a}#header-app-component[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:last-child{padding-left:0!important}#tester-info[_ngcontent-%COMP%]{margin:0;position:relative;height:100%;max-height:unset;top:0}}@media screen and (max-width: 1600px){#col_examContent_wrap[_ngcontent-%COMP%]{width:100%}}  mjx-container[jax=SVG][display=true]{display:inline-block!important}",".exportPdfMode[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{\n    max-width: 100%!important;\n  }"]}),o})();function K1(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function V1(o,s){if(1&o&&(t.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"h1",7),t._uU(6),t.ALo(7,"mytranslate"),t.qZA(),t.TgZ(8,"div",8),t.Hsn(9),t.qZA(),t.Hsn(10,1),t.Hsn(11,2),t.Hsn(12,3),t.qZA()()()()()),2&o){const e=t.oxw();t.xp6(6),t.AsE("",t.lcZ(7,2,"lang_testbank_export_tpl_wrap_export")," ",e.exportType,"")}}const X1=[[["","actionButton",""]],[["","actionButton",""]],[["","statusInfo",""]],[["","templateExport",""]]],t0=["[actionButton]","[actionButton]","[statusInfo]","[templateExport]"];let ia=(()=>{class o{constructor(){this.exportType=""}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["export-tpl-wrap"]],inputs:{isLoading:"isLoading",exportType:"exportType"},ngContentSelectors:t0,decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["doneLoading",""],["id","test_review_container",1,"container-fluid","mt-2","pt-2"],["id","tabRowExam",1,"row",2,"margin-bottom","10px"],["id","test_review_area",1,"col"],["id","col_examContent_wrap",2,"width","1100px","margin","auto"],["id","mbTestContent"],[1,"text-center","text-lg","font-medium"],[1,"buttons-area","mb-3","text-center"]],template:function(e,n){if(1&e&&(t.F$t(X1),t.YNc(0,K1,1,0,"azt-loading-effect",0),t.YNc(1,V1,13,4,"ng-template",null,1,t.W1O)),2&e){const i=t.MAs(2);t.Q6J("ngIf",n.isLoading)("ngIfElse",i)}},dependencies:[O.O5,te.Q,at.bT],encapsulation:2}),o})();function e0(o,s){if(1&o&&(t.TgZ(0,"mat-radio-button",14),t._uU(1),t.qZA()),2&o){const e=s.$implicit,n=t.oxw(3);t.Q6J("matTooltip",(null==e.classObj?null:e.classObj.name)||"")("checked",(null==e.classObj?null:e.classObj.id)==n.selectedClassroomCtl.value)("value",null==e.classObj?null:e.classObj.id)("color","primary"),t.xp6(1),t.hij(" ",null==e.classObj?null:e.classObj.name," ")}}function n0(o,s){if(1&o&&(t.ynx(0),t.YNc(1,e0,2,5,"mat-radio-button",13),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.studentsInClassResults)}}function i0(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-radio-button",15),t.ALo(2,"mytranslate"),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("matTooltip",t.lcZ(2,5,"lang_testbank_export_pdf_free"))("color","primary")("value",0)("checked",0==e.selectedClassroomCtl.value),t.xp6(2),t.hij(" ",t.lcZ(4,7,"lang_testbank_export_pdf_free")," ")}}function o0(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.openDialog(i.examResultObjs,i.hasEssay))}),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()}2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_buttom_continue")," "))}function a0(o,s){if(1&o&&(t.TgZ(0,"div",17),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.errorNoResult)}}function s0(o,s){1&o&&(t.TgZ(0,"mat-icon",20),t._uU(1,"check_circle"),t.qZA())}function r0(o,s){if(1&o&&(t.TgZ(0,"div",18),t.YNc(1,s0,2,0,"mat-icon",19),t._uU(2),t.ALo(3,"mytranslate"),t.ALo(4,"mytranslate"),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.countDonePdf==e.curExportArrs.length),t.xp6(1),t.lnq("\xa0 ",e.countDonePdf<e.curExportArrs.length?t.lcZ(3,4,"lang_testbank_export_pdf_repuest"):t.lcZ(4,6,"lang_testbank_export_pdf_complete")," : ",e.countDonePdf," / ",e.curExportArrs.length," ")}}function l0(o,s){if(1&o&&t._UZ(0,"azt-export-template",21),2&o){const e=t.oxw(2);t.Q6J("examQuestionObjs",e.examQuestionObjs)("examResultId",e.curExamResultId)("questionList",e.questionList)("examObj",e.examObj)("examTracks",e.examTracks)("studentObj",e.studentObj)("classroomName",e.curClassroomName)("examResultObj",e.examResultObj)("userAnswersObj",e.userAnswersObj)("iframeEssayResultObj",e.iframeEssayResultObj)("hasMultiple",e.hasMultiple)("hasEssay",e.hasEssay)("isProcessingPdf",e.isProcessingPdf)("isProcessingSinglePdf",e.isProcessingSinglePdf)}}function c0(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"export-tpl-wrap",3),t.ALo(1,"mytranslate"),t.ALo(2,"mytranslate"),t.ALo(3,"mytranslate"),t.TgZ(4,"div",4)(5,"div",5),t._uU(6),t.ALo(7,"mytranslate"),t.qZA(),t.TgZ(8,"mat-radio-group",6),t.NdJ("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleChangeClassExport(i.selectedClassroomCtl.value))}),t.ALo(9,"mytranslate"),t.YNc(10,n0,2,1,"ng-container",7),t.YNc(11,i0,5,9,"ng-container",7),t.qZA(),t._UZ(12,"div",8),t.YNc(13,o0,3,3,"button",9),t.YNc(14,a0,2,1,"div",10),t.qZA(),t.YNc(15,r0,5,8,"div",11),t.YNc(16,l0,1,14,"azt-export-template",12),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("isLoading",e.isLoading)("exportType","highest"==e.exportType?t.lcZ(1,12,"lang_testbank_export_pdf_follow_max_point"):"first"==e.exportType?t.lcZ(2,14,"lang_testbank_export_pdf_follow_exam_times_fisrt"):t.lcZ(3,16,"lang_testbank_export_pdf_follow_exam_times_last")),t.xp6(6),t.AsE("",t.lcZ(7,18,"lang_testbank_export_pdf_total_student_marking"),": ",e.examResultObjs.length,""),t.xp6(2),t.s9C("aria-label",t.lcZ(9,20,"lang_auto_vui_long_chon_lop")),t.Q6J("formControl",e.selectedClassroomCtl),t.xp6(2),t.Q6J("ngIf",e.studentsInClassResults.length>0),t.xp6(1),t.Q6J("ngIf",e.studentsNotInClassResults.length>0),t.xp6(2),t.Q6J("ngIf",""==e.errorNoResult),t.xp6(1),t.Q6J("ngIf",""!=e.errorNoResult),t.xp6(1),t.Q6J("ngIf",e.isProcessingPdf),t.xp6(1),t.Q6J("ngIf",e.questionList.length>0)}}function _0(o,s){1&o&&(t.TgZ(0,"div",22),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_testbank_export_pdf_tutorial")))}function d0(o,s){1&o&&t._UZ(0,"span",26)}function u0(o,s){if(1&o&&(t.TgZ(0,"div",23),t.YNc(1,d0,1,0,"span",24),t.TgZ(2,"span",25),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.countDonePdf<e.curExportArrs.length),t.xp6(2),t.hij(" ",t.lcZ(4,2,"lang_testbank_export_pdf_by_user_wait_loading")," ")}}let m0=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_,d,m,p,w,C,A){super(n),this.dialog=e,this.commonService=n,this.examResultService=i,this.testedListApiService=a,this.activeRoute=r,this.exportPdfConvertDataService=l,this.newPdfExportService=c,this.cdnService=_,this.exportPdfUtilsService=d,this.checkDrawImgNameService=m,this.answerTypeService=p,this.homeworkExamService=w,this.timeService=C,this.questionRenderService=A,this.folderName="results",this.selectedClassroomCtl=new h.p4(-1),this.curExamResultId=0,this.curExamId=0,this.curUserId=0,this.curStudentId=0,this.curClassroomName="",this.isLoading=!1,this.isProcessingPdf=!1,this.isProcessingSinglePdf=!1,this.countDonePdf=0,this.doneConvertUserResults=!1,this.errorNoResult="",this.curExportArrs=[],this.studentObj=void 0,this.examResultObjs=[],this.examResultObj=void 0,this.questionList=[],this.examQuestionObjs=[],this.userAnswersObj={},this.examTracks=void 0,this.examObj={name:""},this.studentsInClassResults=[],this.studentsNotInClassResults=[],this.myZip=new $o}get hasEssay(){let e=!1;for(let n=0;n<this.questionList.length;n++)if(this.answerTypeService.isEssayAnswer(this.questionList[n].answerType)){e=!0;break}return e}get hasMultiple(){let e=!1;for(let n=0;n<this.questionList.length;n++)if(this.answerTypeService.isOneChoiceAnswer(this.questionList[n].answerType)){e=!0;break}return e}askBeforeCloseWindow(e){return!this.isProcessingPdf||(e.returnValue=!1)}openDialog(e,n){this.dialog.open(P1,{width:"1100px",data:{resultsArr:e,haveEssay:n}}).afterClosed().subscribe(a=>{if(a){const r=[];for(let l=0;l<a.selects.length;l++)a.selects[l]&&r.push(e[l]);this.zipAll(r)}})}processConvertData(e){var n,i,a,r,l,c,_,d,m,p,w;return(0,Oe.mG)(this,void 0,void 0,function*(){this.examResultObj=null===(n=e.data)||void 0===n?void 0:n.examResultObj,this.questionList=null!==(a=this.commonService.castJsonToClassObjs(on.v,JSON.stringify(null===(i=e.data)||void 0===i?void 0:i.questionObjs)))&&void 0!==a?a:[],this.questionList.forEach(A=>{A.isRoleTeacher=!0});for(let A=0;A<this.questionList.length;A++)this.questionList[A].indexLabel=A,this.questionList[A].correctAnswer=this.commonService.filterArray(null===(r=e.data)||void 0===r?void 0:r.correctQuestionIds,this.questionList[A].id);this.studentObj&&(this.studentObj=yield this.loadNameImage(this.studentObj)),this.examObj.examHeader&&(this.examObj.examHeader=yield this.exportPdfUtilsService.convertAndRetryToBase64(this.examObj.examHeader)),this.userAnswersObj={};let C=this.castJsonToObj(null!==(_=null===(c=null===(l=e.data)||void 0===l?void 0:l.examResultObj)||void 0===c?void 0:c.answers)&&void 0!==_?_:"");this.exportPdfConvertDataService.convertAnswersArr(null!=C?C:[],this.userAnswersObj),this.iframeEssayResultObj=null!==(w=this.commonService.castJsonToObj(null!==(p=null===(m=null===(d=e.data)||void 0===d?void 0:d.examResultObj)||void 0===m?void 0:m.result)&&void 0!==p?p:""))&&void 0!==w?w:void 0,this.exportPdfUtilsService.parseEssayMarkResult(this.questionList,this.examResultObj,this.examQuestionObjs)})}loadNameImage(e){var n;return(0,Oe.mG)(this,void 0,void 0,function*(){if(e&&e.nameImages&&(null!==(n=null==e?void 0:e.id)&&void 0!==n?n:0)<=0){var i=yield this.checkDrawImgNameService.getBase64Url(e.nameImages);return i&&(e.nameImages.url=i),e}return e})}zipAll(e){var n,i,a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt,W;return(0,Oe.mG)(this,void 0,void 0,function*(){let P=!0;this.isProcessingPdf=!0,document.body.style.overflow="hidden",this.countDonePdf=0,this.curExportArrs=e,this.myZip=new $o;for(const N of e){this.curExamResultId=N.id,N.fullName&&(this.studentObj={id:Number(N.studentId)?Number(N.studentId):0,parentId:null===(n=N.userId)||void 0===n?void 0:n.toString(),fullName:N.fullName}),N.nameImages&&(this.studentObj={id:Number(N.studentId)?Number(N.studentId):0,parentId:null===(i=N.userId)||void 0===i?void 0:i.toString(),fullName:null!==(a=N.fullName)&&void 0!==a?a:"",nameImages:N.nameImages});const B=yield this.examResultService.apiExamResultGetLastResultGet(this.examObj.id,null===(r=N.userId)||void 0===r?void 0:r.toString(),null===(l=N.studentId)||void 0===l?void 0:l.toString(),N.id).toPromise();this.questionList=null!==(_=this.commonService.castJsonToClassObjs(on.v,JSON.stringify(null===(c=B.data)||void 0===c?void 0:c.questionObjs)))&&void 0!==_?_:[],this.questionList.forEach(X=>{X.isRoleTeacher=!0}),yield this.questionRenderService.parseRenderQuestions(this.questionList),this.iframeEssayResultObj=null!==(w=this.commonService.castJsonToObj(null!==(p=null===(m=null===(d=B.data)||void 0===d?void 0:d.examResultObj)||void 0===m?void 0:m.result)&&void 0!==p?p:""))&&void 0!==w?w:void 0,this.iframeEssayResultObj&&(this.iframeEssayResultObj.staticTextConfigParse=this.commonService.castJsonToObj(null!==(C=this.iframeEssayResultObj.staticTextConfig)&&void 0!==C?C:""),this.iframeEssayResultObj=yield this.exportPdfConvertDataService.processEssayResultToBase64(this.iframeEssayResultObj)),this.doneConvertUserResults=!0,this.examQuestionObjs=(null===(A=B.data)||void 0===A?void 0:A.examQuestionObjs)||[],this.examResultObj=null===(M=B.data)||void 0===M?void 0:M.examResultObj,this.examTracks=null===(D=B.data)||void 0===D?void 0:D.examTracks,this.userAnswersObj={};let z=this.castJsonToObj(null!==(F=null===(U=null===(q=B.data)||void 0===q?void 0:q.examResultObj)||void 0===U?void 0:U.answers)&&void 0!==F?F:"");this.exportPdfConvertDataService.convertAnswersArr(null!=z?z:[],this.userAnswersObj),this.exportPdfUtilsService.parseEssayMarkResult(this.questionList,this.examResultObj,this.examQuestionObjs);try{if(yield this.exportPdfUtilsService.asyncTimeout(5e3),1===e.length)yield this.newPdfExportService.examToPdf("user"),this.isProcessingPdf=!1,document.body.style.overflow="auto",P=!1;else{const X=yield this.newPdfExportService.examToPdf("class");var R=`${this.folderName}/${this.commonService.convertVietnameseToEnglish(N.fullName?N.fullName:null!==(W=null===(tt=this.studentObj)||void 0===tt?void 0:tt.fullName)&&void 0!==W?W:"")}_${N.id}.pdf`;this.myZip.file(R,X)}}catch(X){this.showErrorSnack("lang_auto_co_loi_xay_ra_trong_qua_trinh_tao_file_pdf"),console.log(X)}this.countDonePdf<e.length-1&&this.countDonePdf++}P&&this.finalSaveAll()})}finalSaveAll(){this.myZip.generateAsync({type:"blob"}).then(e=>{var n,i;this.countDonePdf++;let a=this.commonService.createFileNameExportFile([this.curClassroomName,null!==(i=null===(n=this.examObj)||void 0===n?void 0:n.name)&&void 0!==i?i:""])+"_exam_result.zip";(0,hi.saveAs)(e,a),this.isProcessingPdf=!1,document.body.style.overflow="auto"},e=>{console.log(e)})}handleChangeClassExport(e){var n,i,a,r;if(this.isProcessingPdf=!1,this.errorNoResult="",0==e)this.commonService.getTranslate("lang_auto_tu_do").subscribe(l=>{this.curClassroomName=l}),this.filterTestedAndSelectFirst(this.studentsNotInClassResults);else for(let l=0;l<this.studentsInClassResults.length;l++)if((null===(n=this.studentsInClassResults[l].classObj)||void 0===n?void 0:n.id)==e){this.curClassroomName=null!==(a=null===(i=this.studentsInClassResults[l].classObj)||void 0===i?void 0:i.name)&&void 0!==a?a:"",this.filterTestedAndSelectFirst(null!==(r=this.studentsInClassResults[l].results)&&void 0!==r?r:[]);break}}getTestedUserByClass(){let e;switch(this.exportType){case"highest":e=this.testedListApiService.getTestedHighestMark("export_tool",this.curExamId);break;case"first":e=this.testedListApiService.getTestedFirstMark("export_tool",this.curExamId);break;default:e=this.testedListApiService.getTestedLastMark("export_tool",this.curExamId)}e.subscribe(n=>{var i,a,r,l,c,_,d,m,p,w,C,A,M;1==n.success?(this.studentsInClassResults=null!==(a=null===(i=n.data)||void 0===i?void 0:i.studentsInClassResults)&&void 0!==a?a:[],this.studentsNotInClassResults=null!==(l=null===(r=n.data)||void 0===r?void 0:r.studentsNotInClassResults)&&void 0!==l?l:[],this.examType=null===(_=null===(c=n.data)||void 0===c?void 0:c.examObj)||void 0===_?void 0:_.examType,this.examObj=null!==(m=null===(d=n.data)||void 0===d?void 0:d.examObj)&&void 0!==m?m:this.examObj,this.studentsInClassResults.length>0?(this.selectedClassroomCtl.setValue(null===(p=this.studentsInClassResults[0].classObj)||void 0===p?void 0:p.id),this.curClassroomName=null!==(C=null===(w=this.studentsInClassResults[0].classObj)||void 0===w?void 0:w.name)&&void 0!==C?C:"",this.filterTestedAndSelectFirst(null!==(A=this.studentsInClassResults[0].results)&&void 0!==A?A:[])):(this.selectedClassroomCtl.setValue(0),this.commonService.getTranslate("lang_auto_tu_do").subscribe(D=>{this.curClassroomName=D}),this.filterTestedAndSelectFirst(this.studentsNotInClassResults))):this.showErrorSnack(null!==(M=n.message)&&void 0!==M?M:"")})}filterTestedAndSelectFirst(e){var n,i,a,r,l,c,_;if(e&&0!=e.length){let d;d=this.homeworkExamService.hasEssayInExam(null!==(n=this.examType)&&void 0!==n?n:0)?e.filter(p=>{var w;return p.allResultObjs&&(null===(w=p.allResultObjs)||void 0===w?void 0:w.length)>0&&p.confirmedAt}):e.filter(p=>{var w;return p.allResultObjs&&(null===(w=p.allResultObjs)||void 0===w?void 0:w.length)>0}),this.examResultObjs=[];for(let p=0;p<d.length;p++)this.examResultObjs.push({id:null!==(i=d[p].resultId)&&void 0!==i?i:0,fullName:null!==(a=d[p].fullName)&&void 0!==a?a:"",userId:d[p].userId,studentId:d[p].studentId,nameImage:null!==(r=d[p].nameImage)&&void 0!==r?r:"",nameImages:d[p].nameImages});let m=0;this.studentObj=void 0,this.examResultObjs&&this.examResultObjs.length>0&&(m=this.examResultObjs[0].id,this.studentObj={id:this.examResultObjs[0].studentId?Number(this.examResultObjs[0].studentId):0,parentId:null===(l=this.examResultObjs[0].userId)||void 0===l?void 0:l.toString(),fullName:this.examResultObjs[0].fullName,nameImages:this.examResultObjs[0].nameImages}),this.curExamResultId=m,0==m?(this.isLoading=!1,this.commonService.getTranslate("lang_auto_chua_co_thi_sinh_du_thi_hoac_chua_co_bai_thi_nao_duoc_cham_diem_vui_long_kiem_tra_lai").subscribe(p=>{this.errorNoResult=p})):this.examResultService.apiExamResultGetLastResultGet(this.examObj.id,null===(c=this.examResultObjs[0].userId)||void 0===c?void 0:c.toString(),null===(_=this.examResultObjs[0].studentId)||void 0===_?void 0:_.toString(),m).subscribe(p=>{var w,C,A,M;1==p.success?(this.examTracks=null===(w=p.data)||void 0===w?void 0:w.examTracks,this.examQuestionObjs=null!==(A=null===(C=p.data)||void 0===C?void 0:C.examQuestionObjs)&&void 0!==A?A:[],this.processConvertData(p),this.exportPdfUtilsService.translateMetaTitle(p),this.errorNoResult="",this.isLoading=!1):(this.isLoading=!1,this.commonService.getTranslate("lang_auto_khong_tim_thay_du_lieu_thi_vui_long_tai_lai_trang").subscribe(D=>{this.errorNoResult=D}),this.showErrorSnack(null!==(M=p.message)&&void 0!==M?M:""))})}else this.curExamResultId=0,this.commonService.getTranslate("lang_auto_chua_co_thi_sinh_du_thi_hoac_chua_co_bai_thi_nao_duoc_cham_diem_vui_long_kiem_tra_lai").subscribe(d=>{this.errorNoResult=d})}ngOnInit(){if(this.isSupportedBrowswer=this.exportPdfUtilsService.isSupportedBrowswer(),this.isSupportedBrowswer){this.isLoading=!0;var e=[{source:this.cdnService.convertLinkCdn("azota_assets/js/html2pdf.bundle.js?v=28092021"),name:"html2pdf.bundle.js"}];this.commonService.loadScriptPromises(e).then(()=>{var n;this.isLoading=!1,this.exportType=null!==(n=this.commonService.getMyQueryParam("export_type"))&&void 0!==n?n:"",this.curExamId=Number(this.activeRoute.snapshot.paramMap.get("exam_id")),this.curUserId=Number(this.activeRoute.snapshot.paramMap.get("user_id")),this.curStudentId=Number(this.activeRoute.snapshot.paramMap.get("student_id")),this.curExamResultId=Number(this.activeRoute.snapshot.paramMap.get("result_id")),this.getTestedUserByClass()})}super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(j.uw),t.Y36(vt.v),t.Y36(Ot.kS),t.Y36(Fn),t.Y36(x.gz),t.Y36(Wo.S),t.Y36(Ko.I),t.Y36(Ke.U),t.Y36(Wi.V),t.Y36(Vo.k),t.Y36(nn.T),t.Y36(yn.j),t.Y36(Tn.O),t.Y36(Xo.L))},o.\u0275cmp=t.Xpm({type:o,selectors:[["export-pdf-by-class"]],hostBindings:function(e,n){1&e&&t.NdJ("beforeunload",function(a){return n.askBeforeCloseWindow(a)},!1,t.Jf7)},features:[t.qOj],decls:4,vars:3,consts:[[3,"isLoading","exportType",4,"ngIf","ngIfElse"],["notBrowserSupport",""],["class","text-center","style","padding-top: 215px; font-size: 20px; background-color: rgba(0, 0, 0, 0.575); color: #fff; position: fixed; top: 0; right: 0; left: 0; bottom: 0; z-index: 9999999999;",4,"ngIf"],[3,"isLoading","exportType"],["actionButton","",1,"buttons-area","mb-3","text-center"],[1,"mb-2","mt-2","text-md","text-medium"],[1,"grid","grid-cols-12","gap-4",3,"formControl","aria-label","change"],[4,"ngIf"],[1,"mb-1"],["class","btn btn-primary mt-2",3,"click",4,"ngIf"],["class","p-3 my-3 text-danger font-medium",4,"ngIf"],["statusInfo","","class","buttons-area mb-3 text-center",4,"ngIf"],["templateExport","",3,"examQuestionObjs","examResultId","questionList","examObj","examTracks","studentObj","classroomName","examResultObj","userAnswersObj","iframeEssayResultObj","hasMultiple","hasEssay","isProcessingPdf","isProcessingSinglePdf",4,"ngIf"],["class","col-span-3",3,"matTooltip","checked","value","color",4,"ngFor","ngForOf"],[1,"col-span-3",3,"matTooltip","checked","value","color"],[1,"col-span-3",3,"matTooltip","color","value","checked"],[1,"btn","btn-primary","mt-2",3,"click"],[1,"p-3","my-3","text-danger","font-medium"],["statusInfo","",1,"buttons-area","mb-3","text-center"],["style","color: green; vertical-align: bottom;",4,"ngIf"],[2,"color","green","vertical-align","bottom"],["templateExport","",3,"examQuestionObjs","examResultId","questionList","examObj","examTracks","studentObj","classroomName","examResultObj","userAnswersObj","iframeEssayResultObj","hasMultiple","hasEssay","isProcessingPdf","isProcessingSinglePdf"],[1,"p-5","text-center","alert","alert-danger",2,"justify-content","center"],[1,"text-center",2,"padding-top","215px","font-size","20px","background-color","rgba(0, 0, 0, 0.575)","color","#fff","position","fixed","top","0","right","0","left","0","bottom","0","z-index","9999999999"],["style","color: #fff; vertical-align: middle;","class","spinner-border spinner-border-sm","role","status",4,"ngIf"],[2,"color","#fff","vertical-align","middle"],["role","status",1,"spinner-border","spinner-border-sm",2,"color","#fff","vertical-align","middle"]],template:function(e,n){if(1&e&&(t.YNc(0,c0,17,22,"export-tpl-wrap",0),t.YNc(1,_0,3,3,"ng-template",null,1,t.W1O),t.YNc(3,u0,5,4,"div",2)),2&e){const i=t.MAs(2);t.Q6J("ngIf",n.isSupportedBrowswer)("ngIfElse",i),t.xp6(3),t.Q6J("ngIf",n.isProcessingPdf)}},dependencies:[O.sg,O.O5,ge.Hw,ta.VQ,ta.U0,Wt.gM,h.JJ,h.oH,na,ia,at.bT],encapsulation:2}),o})();function h0(o,s){1&o&&t._UZ(0,"span",8)}function p0(o,s){if(1&o&&t._UZ(0,"azt-export-template",9),2&o){const e=t.oxw(2);t.Q6J("examQuestionObjs",e.examQuestionObjs)("examResultId",e.curExamResultId)("questionList",e.questionList)("examObj",e.examObj)("examTracks",e.examTracks)("studentObj",e.studentObj)("classroomName",e.classroomName)("examResultObj",e.examResultObj)("userAnswersObj",e.userAnswersObj)("iframeEssayResultObj",e.iframeEssayResultObj)("hasMultiple",e.hasMultiple)("hasEssay",e.hasEssay)("isProcessingPdf",e.isProcessingPdf)("isProcessingSinglePdf",e.isProcessingSinglePdf)}}function g0(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"export-tpl-wrap",3)(1,"div",4)(2,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.exportToPdf())}),t.YNc(3,h0,1,0,"span",6),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()(),t.YNc(6,p0,1,14,"azt-export-template",7),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("isLoading",e.isLoading),t.xp6(2),t.Q6J("disabled",!e.isDoneAllConvertTasks),t.xp6(1),t.Q6J("ngIf",!e.isDoneAllConvertTasks),t.xp6(1),t.hij(" ",t.lcZ(5,5,"lang_testbank_export_pdf_by_user_download"),""),t.xp6(2),t.Q6J("ngIf",e.questionList.length>0)}}function f0(o,s){1&o&&(t.TgZ(0,"div",10),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_testbank_export_pdf_tutorial")))}const x0=function(o){return{"block-hidden":o}};let v0=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_,d,m){super(e),this.commonService=e,this.activeRoute=n,this.exportPdfConvertDataService=i,this.newPdfExportService=a,this.cdnService=r,this.examResultService=l,this.exportPdfUtilsService=c,this.checkDrawImgNameService=_,this.answerTypeService=d,this.questionRenderService=m,this.reference="",this.curExamResultId=0,this.curExamId=0,this.curUserId=0,this.curStudentId=0,this.isLoading=!1,this.isProcessingPdf=!1,this.isProcessingSinglePdf=!1,this.doneConvertUserResults=!1,this.doneParsingAllQuestionsContent=!1,this.studentObj=void 0,this.examResultObjs=[],this.examResultObj=void 0,this.questionList=[],this.examQuestionObjs=[],this.userAnswersObj={},this.examTracks=void 0,this.examObj={name:""},this.classroomName="",this.listenToFinishRenderAll=p=>{console.log("finish render all question ..."),this.doneParsingAllQuestionsContent=!0}}get pdfPercent(){return this.newPdfExportService.loadPercent}get isDoneAllConvertTasks(){return this.doneConvertUserResults&&this.doneParsingAllQuestionsContent}get hasEssay(){let e=!1;for(let n=0;n<this.questionList.length;n++)if(this.answerTypeService.isEssayAnswer(this.questionList[n].answerType)){e=!0;break}return e}get hasMultiple(){let e=!1;for(let n=0;n<this.questionList.length;n++)if(this.answerTypeService.isOneChoiceAnswer(this.questionList[n].answerType)){e=!0;break}return e}askBeforeCloseWindow(e){return!this.isProcessingSinglePdf||(e.returnValue=!1)}processConvertData(e){var n,i,a,r,l,c,_,d,m,p,w;return(0,Oe.mG)(this,void 0,void 0,function*(){this.examResultObj=null===(n=e.data)||void 0===n?void 0:n.examResultObj,this.questionList=null!==(a=this.commonService.castJsonToClassObjs(on.v,JSON.stringify(null===(i=e.data)||void 0===i?void 0:i.questionObjs)))&&void 0!==a?a:[],this.questionList.forEach(A=>{A.isRoleTeacher=!0}),this.questionRenderService.parseRenderQuestions(this.questionList).then(this.listenToFinishRenderAll);for(let A=0;A<this.questionList.length;A++)this.questionList[A].indexLabel=A,this.questionList[A].correctAnswer=this.commonService.filterArray(null===(r=e.data)||void 0===r?void 0:r.correctQuestionIds,this.questionList[A].id);this.studentObj&&(this.studentObj=yield this.loadNameImage(this.studentObj)),this.examObj.examHeader&&(this.examObj.examHeader=yield this.exportPdfUtilsService.convertAndRetryToBase64(this.examObj.examHeader)),this.userAnswersObj={};let C=this.castJsonToObj(null!==(_=null===(c=null===(l=e.data)||void 0===l?void 0:l.examResultObj)||void 0===c?void 0:c.answers)&&void 0!==_?_:"");this.exportPdfConvertDataService.convertAnswersArr(null!=C?C:[],this.userAnswersObj),this.iframeEssayResultObj=null!==(w=this.commonService.castJsonToObj(null!==(p=null===(m=null===(d=e.data)||void 0===d?void 0:d.examResultObj)||void 0===m?void 0:m.result)&&void 0!==p?p:""))&&void 0!==w?w:void 0,this.iframeEssayResultObj&&(this.iframeEssayResultObj=yield this.exportPdfConvertDataService.processEssayResultToBase64(this.iframeEssayResultObj)),this.exportPdfUtilsService.parseEssayMarkResult(this.questionList,this.examResultObj,this.examQuestionObjs),this.doneConvertUserResults=!0})}loadNameImage(e){var n;return(0,Oe.mG)(this,void 0,void 0,function*(){if(e&&e.nameImages&&(null!==(n=null==e?void 0:e.id)&&void 0!==n?n:0)<=0){var i=yield this.checkDrawImgNameService.getBase64Url(e.nameImages);return i&&(e.nameImages.url=i),e}return e})}exportToPdf(){var e,n;this.isProcessingSinglePdf=!0;let i=this.commonService.createFileNameExportFile([null!==(n=null===(e=this.studentObj)||void 0===e?void 0:e.fullName)&&void 0!==n?n:"Thi Offline",this.curExamResultId.toString()])+"_test_result.pdf";document.body.style.overflow="hidden",setTimeout(()=>{this.newPdfExportService.examToPdf("user",i).then(()=>{this.isProcessingSinglePdf=!1,document.body.style.overflow="auto"}).catch(()=>{this.isProcessingSinglePdf=!1,document.body.style.overflow="auto"})},100)}getAndProcessData(e,n,i,a){this.isLoading=!0,this.examResultService.apiExamResultGetLastResultGet(e,n.toString(),i.toString(),a).subscribe(r=>{var l,c,_,d,m,p,w,C,A,M,D,q;if(1==r.success){let U="";this.commonService.getTranslate("lang_auto_tu_do").subscribe(F=>{U=F}),this.studentObj=null===(l=r.data)||void 0===l?void 0:l.studentObj,this.classroomName=null!==(c=r.data)&&void 0!==c&&c.classroomObj&&null!==(d=null===(_=r.data)||void 0===_?void 0:_.classroomObj.name)&&void 0!==d?d:U,this.examResultObjs=null!==(p=null===(m=r.data)||void 0===m?void 0:m.historyExamResultObjs)&&void 0!==p?p:[],this.examTracks=null===(w=r.data)||void 0===w?void 0:w.examTracks,this.examObj=null!==(A=null===(C=r.data)||void 0===C?void 0:C.examObj)&&void 0!==A?A:this.examObj,this.examQuestionObjs=null!==(D=null===(M=r.data)||void 0===M?void 0:M.examQuestionObjs)&&void 0!==D?D:[],this.processConvertData(r),this.exportPdfUtilsService.translateMetaTitle(r),this.isLoading=!1}else this.isLoading=!1,this.showErrorSnack(null!==(q=r.message)&&void 0!==q?q:"")})}ngOnInit(){if(this.isSupportedBrowswer=this.exportPdfUtilsService.isSupportedBrowswer(),this.isSupportedBrowswer){this.isLoading=!0;var e=[{source:this.cdnService.convertLinkCdn("azota_assets/js/html2pdf.bundle.js?v=28092021"),name:"html2pdf.bundle.js"}];this.commonService.loadScriptPromises(e).then(()=>{var n;this.isLoading=!1,this.reference=null!==(n=this.commonService.getMyQueryParam("ref"))&&void 0!==n?n:"",this.curExamId=Number(this.activeRoute.snapshot.paramMap.get("exam_id")),this.curUserId=Number(this.activeRoute.snapshot.paramMap.get("user_id")),this.curStudentId=Number(this.activeRoute.snapshot.paramMap.get("student_id")),this.curExamResultId=Number(this.activeRoute.snapshot.paramMap.get("result_id")),this.getAndProcessData(this.curExamId,this.curUserId,this.curStudentId,this.curExamResultId)})}super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(x.gz),t.Y36(Wo.S),t.Y36(Ko.I),t.Y36(Ke.U),t.Y36(Ot.kS),t.Y36(Wi.V),t.Y36(Vo.k),t.Y36(nn.T),t.Y36(Xo.L))},o.\u0275cmp=t.Xpm({type:o,selectors:[["export-pdf-by-user"]],hostBindings:function(e,n){1&e&&t.NdJ("beforeunload",function(a){return n.askBeforeCloseWindow(a)},!1,t.Jf7)},inputs:{blockItemCropClass:"blockItemCropClass",blockItemEssayCropClass:"blockItemEssayCropClass"},features:[t.qOj],decls:6,vars:9,consts:[[3,"isLoading",4,"ngIf","ngIfElse"],["notBrowserSupport",""],[1,"text-center",2,"padding-top","150px","font-size","20px","background-color","rgba(0, 0, 0, 0.575)","color","#fff","position","fixed","top","0","right","0","left","0","bottom","0","z-index","9999999999",3,"ngClass"],[3,"isLoading"],["actionButton","",1,"buttons-area","mb-3","text-center"],[1,"btn","btn-primary","mr-2",3,"disabled","click"],["style","color: darkgrey;","class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["templateExport","",3,"examQuestionObjs","examResultId","questionList","examObj","examTracks","studentObj","classroomName","examResultObj","userAnswersObj","iframeEssayResultObj","hasMultiple","hasEssay","isProcessingPdf","isProcessingSinglePdf",4,"ngIf"],["role","status",1,"spinner-border","spinner-border-sm",2,"color","darkgrey"],["templateExport","",3,"examQuestionObjs","examResultId","questionList","examObj","examTracks","studentObj","classroomName","examResultObj","userAnswersObj","iframeEssayResultObj","hasMultiple","hasEssay","isProcessingPdf","isProcessingSinglePdf"],[1,"p-5","text-center","alert","alert-danger",2,"justify-content","center"]],template:function(e,n){if(1&e&&(t.YNc(0,g0,7,7,"export-tpl-wrap",0),t.YNc(1,f0,3,3,"ng-template",null,1,t.W1O),t.TgZ(3,"div",2),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()),2&e){const i=t.MAs(2);t.Q6J("ngIf",n.isSupportedBrowswer)("ngIfElse",i),t.xp6(3),t.Q6J("ngClass",t.VKq(7,x0,!n.isProcessingSinglePdf)),t.xp6(1),t.AsE(" [ ",n.pdfPercent,"% ] ",t.lcZ(5,5,"lang_testbank_export_pdf_by_user_wait_loading"),"\n")}},dependencies:[O.mk,O.O5,na,ia,at.bT],encapsulation:2}),o})();var b0=b(37234),w0=b(37104);function T0(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"p",5),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.TgZ(5,"p",6),t._uU(6),t.ALo(7,"mytranslate"),t.ALo(8,"mytranslate"),t.ALo(9,"mytranslate"),t.qZA(),t.TgZ(10,"a",7),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.showCopySuccess())}),t.O4$(),t.TgZ(11,"svg",8),t._UZ(12,"circle",9)(13,"circle",10)(14,"circle",11)(15,"line",12)(16,"line",13),t.qZA(),t.kcU(),t.TgZ(17,"span"),t._uU(18),t.ALo(19,"mytranslate"),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,6,"lang_auto_chua_co_du_lieu_nop_bai")),t.xp6(3),t.lnq("",t.lcZ(7,8,"lang_auto_neu_chua_gui_link_nop_bai_cho_hoc_sinh_vui_long_bam"),' "',t.lcZ(8,10,"lang_auto_copy_link_bai_tap"),'" ',t.lcZ(9,12,"lang_auto_ben_duoi_va_gui_cho_hoc_sinh_de_nop_bai"),""),t.xp6(4),t.Q6J("cdkCopyToClipboard",e.copyLinkHomeWorkToClipboard()),t.xp6(8),t.Oqu(t.lcZ(19,14,"lang_auto_copy_link_bai_tap"))}}function C0(o,s){1&o&&(t.TgZ(0,"span",38),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_chua_cham")))}function A0(o,s){1&o&&(t.TgZ(0,"span",39),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_chua_nop")))}function y0(o,s){1&o&&(t.TgZ(0,"span",40),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_da_yeu_cau_nop_lai"),""))}function k0(o,s){1&o&&(t.TgZ(0,"span",40),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_point")+": "," "))}function O0(o,s){if(1&o&&(t.TgZ(0,"span",41),t._UZ(1,"azt-check-mark",42),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("mark",e.point)}}function S0(o,s){if(1&o&&(t.TgZ(0,"div",43),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw(2).$implicit,n=t.oxw(2);t.xp6(1),t.hij(" ",n.calculationTime(e.createdAt||void 0)+" "+t.lcZ(2,1,"lang_auto_truoc")," ")}}function E0(o,s){1&o&&(t.TgZ(0,"p",47),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_so_tep_tin_da_nop")+":"," "))}function I0(o,s){if(1&o&&(t.TgZ(0,"div",44),t.YNc(1,E0,3,3,"p",45),t.TgZ(2,"p",46),t._uU(3),t.qZA()()),2&o){const e=t.oxw(2).$implicit;let n;t.xp6(1),t.Q6J("ngIf",e.isMarked||e.isSubmitted),t.xp6(2),t.hij(" ",null!==(n=null==e.answerFileObjs?null:e.answerFileObjs.length)&&void 0!==n?n:0," ")}}const Z0=function(o){return[o]},M0=function(o){return{"zoom-in":o}};function P0(o,s){if(1&o&&(t.TgZ(0,"div")(1,"a",22),t.ALo(2,"mylocalize"),t.TgZ(3,"div",23)(4,"div",24),t._UZ(5,"azt-create-avatar",25),t.qZA(),t.TgZ(6,"div",26)(7,"div",27)(8,"span",28,29),t._uU(10),t.qZA()(),t.TgZ(11,"div",30)(12,"div",31),t.YNc(13,C0,3,3,"span",32),t.YNc(14,A0,3,3,"span",33),t.YNc(15,y0,3,3,"span",34),t.YNc(16,k0,3,3,"span",34),t.YNc(17,O0,2,1,"span",35),t.qZA(),t.YNc(18,S0,3,3,"div",36),t.qZA(),t.YNc(19,I0,4,2,"div",37),t.qZA()()()()),2&o){const e=t.MAs(9),n=t.oxw().$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("href",t.VKq(18,Z0,t.lcZ(2,16,"/admin/homework/mark-exercise/"+n.answer.id+"/"+i.obj.hashId+(i.backToLink?"?backto="+i.backToLink:""))),t.LSH),t.xp6(2),t.Q6J("ngClass",t.VKq(20,M0,!(n.isNotSubmit&&n.mustReSubmit))),t.xp6(2),t.Q6J("linkAvatar",(null==n?null:n.avatar)||"")("nameCreateAvatar",n.fullName)("size",40),t.xp6(3),t.s9C("matTooltip",n.fullName),t.Q6J("isDisabledTooltip",!1)("matTooltipDisabled",e.isDisabled),t.xp6(2),t.hij(" ",n.fullName," "),t.xp6(3),t.Q6J("ngIf",n.isSubmitted),t.xp6(1),t.Q6J("ngIf",n.isNotSubmit),t.xp6(1),t.Q6J("ngIf",n.mustReSubmit),t.xp6(1),t.Q6J("ngIf",n.isMarked),t.xp6(1),t.Q6J("ngIf",n.isMarked),t.xp6(1),t.Q6J("ngIf",null!=n.createdAt),t.xp6(1),t.Q6J("ngIf",n.isMarked||n.isSubmitted)}}function L0(o,s){1&o&&(t.TgZ(0,"span",38),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_chua_cham")))}function N0(o,s){1&o&&(t.TgZ(0,"span",39),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_chua_nop")))}function D0(o,s){1&o&&(t.TgZ(0,"span",40),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_da_yeu_cau_nop_lai"),""))}function j0(o,s){1&o&&(t.TgZ(0,"span",40),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_point")+": "," "))}function q0(o,s){if(1&o&&(t.TgZ(0,"span",41),t._UZ(1,"azt-check-mark",42),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("mark",e.point)}}function Q0(o,s){if(1&o&&(t.TgZ(0,"div",43),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw(2).$implicit,n=t.oxw(2);t.xp6(1),t.hij(" ",n.calculationTime(e.createdAt||void 0)+" "+t.lcZ(2,1,"lang_auto_truoc")," ")}}function U0(o,s){1&o&&(t.TgZ(0,"p",47),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_so_tep_tin_da_nop")+":"," "))}function F0(o,s){if(1&o&&(t.TgZ(0,"div",44),t.YNc(1,U0,3,3,"p",45),t.TgZ(2,"p",46),t._uU(3),t.qZA()()),2&o){const e=t.oxw(2).$implicit;let n;t.xp6(1),t.Q6J("ngIf",e.isMarked||e.isSubmitted),t.xp6(2),t.hij(" ",null!==(n=null==e.answerFileObjs?null:e.answerFileObjs.length)&&void 0!==n?n:0," ")}}function R0(o,s){if(1&o&&(t.TgZ(0,"div",48)(1,"div",24),t._UZ(2,"azt-create-avatar",25),t.qZA(),t.TgZ(3,"div",26)(4,"div",27)(5,"span",28,29),t._uU(7),t.qZA()(),t.TgZ(8,"div",30)(9,"div",31),t.YNc(10,L0,3,3,"span",32),t.YNc(11,N0,3,3,"span",33),t.YNc(12,D0,3,3,"span",34),t.YNc(13,j0,3,3,"span",34),t.YNc(14,q0,2,1,"span",35),t.qZA(),t.YNc(15,Q0,3,3,"div",36),t.qZA(),t.YNc(16,F0,4,2,"div",37),t.qZA()()),2&o){const e=t.MAs(6),n=t.oxw().$implicit;t.xp6(2),t.Q6J("linkAvatar",(null==n?null:n.avatar)||"")("nameCreateAvatar",n.fullName)("size",40),t.xp6(3),t.s9C("matTooltip",n.fullName),t.Q6J("isDisabledTooltip",!1)("matTooltipDisabled",e.isDisabled),t.xp6(2),t.hij(" ",n.fullName," "),t.xp6(3),t.Q6J("ngIf",n.isSubmitted),t.xp6(1),t.Q6J("ngIf",n.isNotSubmit),t.xp6(1),t.Q6J("ngIf",n.mustReSubmit),t.xp6(1),t.Q6J("ngIf",n.isMarked),t.xp6(1),t.Q6J("ngIf",n.isMarked),t.xp6(1),t.Q6J("ngIf",null!=n.createdAt),t.xp6(1),t.Q6J("ngIf",n.isMarked||n.isSubmitted)}}const B0=function(o){return{"md:col-span-3":o}};function J0(o,s){if(1&o&&(t.TgZ(0,"div",19),t.YNc(1,P0,20,22,"div",20),t.YNc(2,R0,17,14,"ng-template",null,21,t.W1O),t.qZA()),2&o){const e=s.$implicit,n=t.MAs(3),i=t.oxw(2);t.Q6J("ngClass",t.VKq(3,B0,!i.isOpenSideNav&&!i.isMobile)),t.xp6(1),t.Q6J("ngIf",e.answer)("ngIfElse",n)}}const H0=function(){return{suppressScrollX:!0}};function z0(o,s){if(1&o&&(t.TgZ(0,"div")(1,"div",14)(2,"perfect-scrollbar",15)(3,"div",16)(4,"div",17),t.YNc(5,J0,4,5,"div",18),t.qZA()()()()()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("config",t.DdM(3,H0))("scrollIndicators",!0),t.xp6(3),t.Q6J("ngForOf",e.studentLists)}}let Y0=(()=>{class o extends mt.Q{constructor(e,n){super(e),this.commonService=e,this.timeService=n,this.isSortByTime=!1,this.backToLink="",this.searchKey="",this.studentLists=[],this.isNotTestedYet=!1,this.isOpenSideNav=!0,this.obj={},this.isMobile=!1,this.goToResult=new t.vpe}goToResultReview(e){e.isNotSubmit||e.mustReSubmit||this.goToResult.emit(e)}copyLinkHomeWorkToClipboard(){return`${this.commonService.getCurrentDomain()}/bai-tap/${this.obj.hashId}`}showCopySuccess(){this.showSuccessSnack("lang_auto_sao_chep_thanh_cong")}calculationTime(e,n){return this.timeService.calculationTime(e,n)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Tn.O))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-student-homework-result"]],inputs:{isSortByTime:"isSortByTime",backToLink:"backToLink",searchKey:"searchKey",studentLists:"studentLists",isNotTestedYet:"isNotTestedYet",isOpenSideNav:"isOpenSideNav",obj:"obj",isMobile:"isMobile"},outputs:{goToResult:"goToResult"},features:[t.qOj],decls:3,vars:2,consts:[[1,"box","mt-2","relative"],["class","scrollable-content flex items-center",4,"ngIf"],[4,"ngIf"],[1,"scrollable-content","flex","items-center"],[1,"text-center","mt-5","mx-auto",2,"max-width","28rem"],[1,"text-lg"],[1,"mt-2","mx-auto"],[1,"mt-2","btn","btn-secondary-soft",3,"cdkCopyToClipboard","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2","lucide"],["cx","18","cy","5","r","3"],["cx","6","cy","12","r","3"],["cx","18","cy","19","r","3"],["x1","8.59","y1","13.51","x2","15.42","y2","17.49"],["x1","15.41","y1","6.51","x2","8.59","y2","10.49"],[1,"azt-student-list","scrollable-content"],[3,"config","scrollIndicators"],[1,"mt-4","p-2"],[1,"grid","grid-cols-12","gap-3","sm:gap-6",2,"margin-bottom","85px"],["class","col-span-12 sm:col-span-6 md:col-span-4 2xl:col-span-3",3,"ngClass",4,"ngFor","ngForOf"],[1,"col-span-12","sm:col-span-6","md:col-span-4","2xl:col-span-3",3,"ngClass"],[4,"ngIf","ngIfElse"],["answerIdNull",""],[3,"href"],[1,"flex","items-center","p-3","rounded-md","bg-slate-100","dark:bg-darkmode-300",2,"min-height","85px",3,"ngClass"],[1,"w-12","h-10","image-fit","lg:mr-1"],[3,"linkAvatar","nameCreateAvatar","size"],[1,"ml-2","text-left","mt-0","w-full"],[1,"azt-student-name",2,"height","20px"],[1,"font-medium","truncate",2,"max-width","70%",3,"matTooltip","isDisabledTooltip","matTooltipDisabled"],["c","isDisabled"],[1,"flex","mt-1"],[1,"mr-auto","text-xs","mr-2"],["class","text-pending",4,"ngIf"],["class","text-danger",4,"ngIf"],["class","text-slate-500",4,"ngIf"],["class","text-black font-medium",4,"ngIf"],["class","text-slate-500 text-xs",4,"ngIf"],["class","flex items-center mb-1",4,"ngIf"],[1,"text-pending"],[1,"text-danger"],[1,"text-slate-500"],[1,"text-black","font-medium"],[3,"mark"],[1,"text-slate-500","text-xs"],[1,"flex","items-center","mb-1"],["class","mr-auto text-xs text-slate-500",4,"ngIf"],[1,"text-xs","text-slate-500"],[1,"mr-auto","text-xs","text-slate-500"],[1,"flex","items-center","p-3","rounded-md","bg-slate-100","dark:bg-darkmode-300",2,"min-height","85px","height","100%"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,T0,20,16,"div",1),t.YNc(2,z0,6,4,"div",2),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",n.isNotTestedYet),t.xp6(1),t.Q6J("ngIf",!n.isNotTestedYet))},dependencies:[O.mk,O.sg,O.O5,Ln.i3,Wt.gM,Lt.Vv,Fo.t,w0.B,Cn.Q,at.mp,at.bT],encapsulation:2}),o})();function G0(o,s){1&o&&(t.TgZ(0,"div",3),t.O4$(),t.TgZ(1,"svg",4)(2,"g",5)(3,"g",6),t._UZ(4,"circle",7),t.TgZ(5,"path",8),t._UZ(6,"animateTransform",9),t.qZA()()()()())}const $0=function(){return{standalone:!0}};function W0(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",10)(1,"form",11)(2,"div",12)(3,"div",13)(4,"h3",14),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()(),t.TgZ(7,"div",15),t._UZ(8,"editor",16),t.qZA()()()(),t.TgZ(9,"div",17)(10,"button",18),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeDialog())}),t._uU(11),t.ALo(12,"mytranslate"),t.qZA(),t.TgZ(13,"button",19),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.saveHomework())}),t._uU(14),t.ALo(15,"mytranslate"),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(4),t.hij(" ",t.lcZ(6,6,"lang_auto_noi_dung")," "),t.xp6(3),t.Q6J("ngModelOptions",t.DdM(12,$0))("init",e.initDataEditor),t.xp6(3),t.hij(" ",t.lcZ(12,8,"lang_auto_huy")," "),t.xp6(3),t.hij(" ",t.lcZ(15,10,"lang_auto_luu")," ")}}let K0=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_){super(e),this.commonService=e,this.formBuilder=n,this.zipdataService=i,this.documentConfigService=a,this.browserStorageService=r,this.uploadImageOfHomeworkService=l,this.dialogRef=c,this.data=_,this.form=new h.nJ({}),this.permissionTypes=en.$,this.homeworkId=0,this.homeworkHashId="",this.homeworkObj=void 0,this.initDataEditor={},this.homeworkHashId=_.hashId,this.getHomework(this.homeworkHashId)}closeDialog(){this.dialogRef.close()}saveHomework(){if(this.initStatusObj(),this.form.invalid)this.showErrorSnack("lang_auto_vui_long_nhap_day_du_thong_tin");else{var n=this.commonService.getFormObj(this.form).homeworkDescription;this.uploadImageOfHomeworkService.replaceImageInContent(n).subscribe(i=>{if(null==i.errorMessage){let r={content:this.zipdataService.convertContentGzip(i.content)};this.subscriptions.add(this.documentConfigService.apiDocumentConfigSaveHomeworkConfigPost(r,this.homeworkHashId).subscribe(l=>{var c;1==l.success?(l.data&&l.data.objs&&this.data.callback(l.data.objs[0]),this.closeDialog(),this.showSuccessSnack("lang_auto_luu_thanh_cong")):this.errorStatusObj(null!==(c=l.message)&&void 0!==c?c:"",!0)}))}else this.showErrorSnack(i.errorMessage),this.stopStatusObj()})}}getHomework(e){this.initStatusObj(),this.subscriptions.add(this.documentConfigService.apiDocumentConfigGetHomeworkConfigDataPost([],e).subscribe(n=>{var i,a,r,l;if(1==n.success){this.homeworkObj=null===(i=n.data)||void 0===i?void 0:i.homeworkObj;let c=null!==(a=this.homeworkObj)&&void 0!==a&&a.content?this.zipdataService.decodeContentGzip(null===(r=this.homeworkObj)||void 0===r?void 0:r.content):"";this.form.patchValue({homeworkDescription:c}),this.successStatusObj()}else this.errorStatusObj(null!==(l=n.message)&&void 0!==l?l:"",!0)}))}checkModeUiEditor(){var e;this.initDataEditor="dark"==(""==this.browserStorageService.getStorage("mode_ui")?"light":null!==(e=this.browserStorageService.getStorage("mode_ui"))&&void 0!==e?e:"light")?{height:250,menubar:!1,plugins:[],skin:"oxide-dark",content_css:"dark",toolbar:"bold italic backcolor | alignleft aligncenter alignright alignjustify"}:{height:250,menubar:!1,plugins:[],toolbar:"bold italic backcolor | alignleft aligncenter alignright alignjustify"}}ngOnInit(){this.form=this.formBuilder.group({homeworkDescription:new h.p4("")}),this.checkModeUiEditor(),super.ngOnInit()}ngOnChanges(){this.checkModeUiEditor()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(h.QS),t.Y36(hn.n),t.Y36(Ot.Cq),t.Y36(Be.z),t.Y36(mo.J),t.Y36(j.so,8),t.Y36(j.WI,8))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-config-homework"]],features:[t._Bn([{provide:Ve.fM,useClass:Pi.HF,deps:[wn.Ad,Zi.o8]},{provide:Ve.ab,useValue:Mi.O}]),t.qOj,t.TTD],decls:4,vars:2,consts:[[1,"box"],["class","azt-icon-loading text-center p-5",4,"ngIf","ngIfElse"],["doneLoading",""],[1,"azt-icon-loading","text-center","p-5"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","rgb(30, 41, 59)",1,"mx-auto","w-8","h-8"],["fill","none","fill-rule","evenodd"],["transform","translate(1 1)","stroke-width","4"],["stroke-opacity",".5","cx","18","cy","18","r","18"],["d","M36 18c0-9.94-8.06-18-18-18"],["attributeName","transform","type","rotate","from","0 18 18","to","360 18 18","dur","1s","repeatCount","indefinite"],[1,"setting","p-3"],[3,"formGroup"],["id","document-desc"],[1,"setting-label-textarea"],[1,"text-md","font-medium"],[1,"mt-2"],["formControlName","homeworkDescription","apiKey","ldij13v1886vlrnk42g9bvngyqdc6gxpe8l0n9mo8gdjpg9d",3,"ngModelOptions","init"],[1,"p-3","text-right"],[1,"btn","btn-secondary","w-24","mr-2",3,"click"],[1,"btn","w-24","btn-primary",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t.YNc(1,G0,7,0,"div",1),t.YNc(2,W0,16,13,"ng-template",null,2,t.W1O),t.qZA()),2&e){const i=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.O5,Dt.PG,h._Y,h.JJ,h.JL,h.sg,h.u,oe.M,at.bT],encapsulation:2}),o})();function V0(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.clickToSeeMore())}),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()}2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_cms_common_see_more")))}function X0(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.clickToShowShortContent())}),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()}2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_cms_common_see_short_content")))}let tx=(()=>{class o extends mt.Q{constructor(){super(...arguments),this.content="",this.maxLength=500,this.showContent="",this.showSeeMoreButton=!0,this.showShortContentButton=!1}clickToShowShortContent(){this.showSeeMoreButton=!0,this.showShortContentButton=!1,this.processSeeMore()}clickToSeeMore(){this.showSeeMoreButton=!1,this.showShortContentButton=!0,this.processSeeMore()}processSeeMore(){let e=this.commonService.removeTagHtml(this.content);e.length>this.maxLength?this.showContent=this.showSeeMoreButton?e.substring(0,this.maxLength)+"...":this.content:(this.showSeeMoreButton=!1,this.showShortContentButton=!1,this.showContent=this.content)}ngOnInit(){this.processSeeMore(),super.ngOnInit()}ngOnChanges(){this.showSeeMoreButton=!0,this.showShortContentButton=!1,this.processSeeMore()}}return o.\u0275fac=function(){let s;return function(n){return(s||(s=t.n5z(o)))(n||o)}}(),o.\u0275cmp=t.Xpm({type:o,selectors:[["azt-see-more"]],inputs:{content:"content",maxLength:"maxLength"},features:[t.qOj,t.TTD],decls:3,vars:3,consts:[[3,"innerHTML"],["class","btn-text-primary",3,"click",4,"ngIf"],[1,"btn-text-primary",3,"click"]],template:function(e,n){1&e&&(t._UZ(0,"div",0),t.YNc(1,V0,3,3,"a",1),t.YNc(2,X0,3,3,"a",1)),2&e&&(t.Q6J("innerHTML",n.showContent,t.oJD),t.xp6(1),t.Q6J("ngIf",n.showSeeMoreButton&&n.content.length>n.maxLength),t.xp6(1),t.Q6J("ngIf",n.showShortContentButton&&n.content.length>n.maxLength))},dependencies:[O.O5,at.bT],encapsulation:2}),o})();function ex(o,s){if(1&o&&(t.TgZ(0,"div",11),t.O4$(),t.TgZ(1,"svg",12),t._UZ(2,"rect",13)(3,"line",14)(4,"line",15)(5,"line",16),t.qZA(),t.kcU(),t.TgZ(6,"span",17),t._uU(7),t.ALo(8,"mytranslate"),t.ALo(9,"date"),t.qZA()()),2&o){const e=t.oxw();t.xp6(7),t.hij(" ",t.lcZ(8,1,"lang_auto_bat_dau")+": "+t.xi3(9,3,null==e.initData.homeworkObj?null:e.initData.homeworkObj.startDate,"dd/MM/yyyy HH:mm:ss")," ")}}function nx(o,s){if(1&o&&t._UZ(0,"azt-share",31),2&o){const e=t.oxw();t.Q6J("type",2)("typeObj","HOMEWORK")("id",e.initData.homeworkObj.id)("permissionObj",e.initData.homeworkObj.permissionObj)}}function ix(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",61)(2,"a",62),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.redirectToClassroomDetail())}),t._uU(3),t.qZA()(),t.BQk()}if(2&o){const e=t.oxw(2);t.xp6(2),t.s9C("matTooltip",e.initData.classroomObj.name),t.xp6(1),t.hij(" ",e.initData.classroomObj.name," ")}}function ox(o,s){1&o&&(t.TgZ(0,"div",61)(1,"a",63),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_auto_tat_ca_moi_nguoi")," "))}function ax(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",64),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.openConfigDialogDesc())}),t.O4$(),t.TgZ(1,"svg",12),t._UZ(2,"path",65)(3,"path",66),t.qZA(),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()}2&o&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"lang_auto_sua")," "))}function sx(o,s){if(1&o&&(t.TgZ(0,"div",67),t._UZ(1,"azt-see-more",68),t.qZA()),2&o){const e=t.oxw(2);let n;t.xp6(1),t.Q6J("content",null!==(n=null==e.initData.homeworkObj?null:e.initData.homeworkObj.content)&&void 0!==n?n:"")("maxLength",200)}}function rx(o,s){1&o&&(t.TgZ(0,"p",69),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_chua_co_noi_dung")," "))}function lx(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",19),t._UZ(2,"path",70)(3,"polyline",71)(4,"line",72),t.qZA()())}function cx(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",73)(2,"g",74)(3,"g",75),t._UZ(4,"circle",76),t.TgZ(5,"path",77),t._UZ(6,"animateTransform",78),t.qZA()()()()())}function _x(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",64),t.NdJ("click",function(){t.CHM(e),t.oxw();const i=t.MAs(51);return t.KtG(i.click())}),t.YNc(1,lx,5,0,"span",30),t.YNc(2,cx,7,0,"span",30),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.loadingUpload),t.xp6(1),t.Q6J("ngIf",e.loadingUpload),t.xp6(1),t.hij(" ",t.lcZ(4,3,"lang_auto_them_file")," ")}}function dx(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",81),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.onShowFile(a,-1))}),t.O4$(),t.TgZ(2,"svg",19),t._UZ(3,"path",82)(4,"polyline",83)(5,"line",84)(6,"line",85)(7,"line",86),t.qZA(),t.kcU(),t.TgZ(8,"span",87),t._uU(9),t.qZA()(),t.TgZ(10,"button",88),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw(3);return t.KtG(r.removeFile(a))}),t.ALo(11,"mytranslate"),t.O4$(),t.TgZ(12,"svg",89),t._UZ(13,"line",90)(14,"line",91),t.qZA()(),t.BQk()}if(2&o){const e=s.$implicit;t.xp6(8),t.s9C("matTooltip",e.name),t.xp6(1),t.hij(" ",e.name," "),t.xp6(1),t.s9C("matTooltip",t.lcZ(11,3,"lang_auto_xoa"))}}function ux(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"div",79),t.YNc(2,dx,15,5,"ng-container",80),t.qZA(),t.BQk()),2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",e.formHomework.files)}}function mx(o,s){1&o&&(t.TgZ(0,"p",92),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_chua_co_file_dinh_kem")," "))}const oa=function(o){return{opacity:o}},hx=function(){return{standalone:!0}};function px(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",32)(1,"h3",33),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"div",34)(5,"ul",35)(6,"li",36),t.ALo(7,"deletePermission"),t.TgZ(8,"a",37),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteHomework())}),t.O4$(),t.TgZ(9,"svg",12),t._UZ(10,"path",38)(11,"path",39)(12,"path",40)(13,"line",41)(14,"line",42),t.qZA(),t._uU(15),t.ALo(16,"mytranslate"),t.qZA()(),t.kcU(),t.TgZ(17,"li",36),t.ALo(18,"editPermission"),t.TgZ(19,"a",43),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.redirectToSetting())}),t.O4$(),t.TgZ(20,"svg",12),t._UZ(21,"path",44)(22,"circle",45),t.qZA(),t._uU(23),t.ALo(24,"mytranslate"),t.qZA()()()()(),t.kcU(),t.TgZ(25,"div",46)(26,"div",47)(27,"h3",33),t._uU(28),t.ALo(29,"mytranslate"),t.qZA()(),t.TgZ(30,"div",48),t.YNc(31,ix,4,2,"ng-container",49),t.YNc(32,ox,4,3,"ng-template",null,50,t.W1O),t.qZA()(),t.TgZ(34,"div",51)(35,"div",47)(36,"h3",33),t._uU(37),t.ALo(38,"mytranslate"),t.qZA(),t.YNc(39,ax,6,3,"button",52),t.ALo(40,"editPermission"),t.ALo(41,"configPermission"),t.qZA(),t.TgZ(42,"div",53),t.YNc(43,sx,2,2,"div",54),t.YNc(44,rx,3,3,"p",55),t.qZA()(),t.TgZ(45,"div",56)(46,"div",47)(47,"h3",33),t._uU(48),t.ALo(49,"mytranslate"),t.qZA(),t.TgZ(50,"input",57,58),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onFileSelected(i))}),t.qZA(),t.YNc(52,_x,5,5,"button",52),t.ALo(53,"editPermission"),t.ALo(54,"configPermission"),t.qZA(),t.TgZ(55,"div",59),t._uU(56),t.ALo(57,"mytranslate"),t.qZA(),t.YNc(58,ux,3,1,"ng-container",49),t.YNc(59,mx,3,3,"ng-template",null,60,t.W1O),t.qZA()}if(2&o){const e=t.MAs(33),n=t.MAs(60),i=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,18,"lang_auto_menu")," "),t.xp6(4),t.Q6J("ngStyle",t.VKq(50,oa,t.xi3(7,20,null==i.initData.homeworkObj?null:i.initData.homeworkObj.permissionObj,"homework")?"1":"0.5")),t.xp6(9),t.hij(" ",t.lcZ(16,23,"lang_auto_xoa")," "),t.xp6(2),t.Q6J("ngStyle",t.VKq(52,oa,t.xi3(18,25,null==i.initData.homeworkObj?null:i.initData.homeworkObj.permissionObj,"homework")?"1":"0.5")),t.xp6(6),t.hij(" ",t.lcZ(24,28,"lang_auto_cai_dat")," "),t.xp6(5),t.hij(" ",t.lcZ(29,30,"lang_auto_giao_cho")," "),t.xp6(3),t.Q6J("ngIf",i.initData.classroomObj)("ngIfElse",e),t.xp6(6),t.hij(" ",t.lcZ(38,32,"lang_auto_noi_dung")," "),t.xp6(2),t.Q6J("ngIf",t.xi3(40,34,null==i.initData.homeworkObj?null:i.initData.homeworkObj.permissionObj,"homework")||t.xi3(41,37,null==i.initData.homeworkObj?null:i.initData.homeworkObj.permissionObj,"homework")),t.xp6(4),t.Q6J("ngIf",null==i.initData.homeworkObj?null:i.initData.homeworkObj.content),t.xp6(1),t.Q6J("ngIf",!(null!=i.initData.homeworkObj&&i.initData.homeworkObj.content)),t.xp6(4),t.hij(" ",t.lcZ(49,40,"lang_auto_file_dinh_kem")," "),t.xp6(2),t.Q6J("ngModelOptions",t.DdM(54,hx)),t.xp6(2),t.Q6J("ngIf",t.xi3(53,42,null==i.initData.homeworkObj?null:i.initData.homeworkObj.permissionObj,"exam")||t.xi3(54,45,null==i.initData.homeworkObj?null:i.initData.homeworkObj.permissionObj,"exam")),t.xp6(4),t.hij(" ",t.lcZ(57,48,"lang_auto_ho_tro_file_dinh_danh_anh_pdf_work_excel_audio_hoac_video")," "),t.xp6(2),t.Q6J("ngIf",null==i.formHomework.files?null:i.formHomework.files.length)("ngIfElse",n)}}function gx(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",93),t._UZ(2,"polyline",94),t.qZA()())}function fx(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",93),t._UZ(2,"polyline",95),t.qZA()())}let xx=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l){super(e),this.commonService=e,this.dialog=n,this.apiUploadService=i,this.documentConfigService=a,this.zipdataService=r,this.permissionService=l,this.initData={},this.reloadApi=new t.vpe,this.isShowActions=!0,this.typeEdit="",this.loadingUpload=!1,this.uploadProgress=0,this.formHomework={files:[],content:""},this.isShowPreviewFile=!1,this.isFullContent=!1}showCopySuccess(){this.showSuccessSnack("lang_auto_sao_chep_thanh_cong_duong_dan_nop_bai")}toggleShowActions(){this.isShowActions=!this.isShowActions}copyLinkToClipboard(e){return`${this.commonService.getCurrentDomain()}/bai-tap/${e}`}openConfigDialogDesc(){var e;this.dialog.open(K0,{width:"850px",data:{callback:this.callBack.bind(this),showConfig:{description:!0},hashId:null===(e=this.initData.homeworkObj)||void 0===e?void 0:e.hashId}})}callBack(e){var n;this.initData.homeworkObj&&(this.initData.homeworkObj.name=e.name,this.initData.homeworkObj.content=this.zipdataService.decodeContentGzip(null!==(n=e.content)&&void 0!==n?n:""),this.formHomework.content=this.initData.homeworkObj.content.length>100?this.initData.homeworkObj.content.slice(0,100)+"...":this.initData.homeworkObj.content)}onFileSelected(e){var n;if(this.permissionService.hasEditPermission("homework",null===(n=this.initData.homeworkObj)||void 0===n?void 0:n.permissionObj)){let r=e.target,l=r.files,c=!!l&&l[0];0!=c&&((0,Ut.C0)(c.type)?(0,Ut.ml)(c.type)?this.showErrorSnack("lang_auto__chua_ho_tro_dinh_dang_video_wmv_vui_long_thu_lai"):(this.loadingUpload=!0,this.uploadProgress=0,(0,Ut.hv)(c).then(_=>{this.apiUploadService.uploadToCdnForHomework(_).subscribe(d=>{var m;if(d.type!=Te.dt.UploadProgress)if(1==d.success){this.formHomework.files.push(Object.assign({},d.data));let p={files:JSON.stringify(this.formHomework.files)};this.subscriptions.add(this.documentConfigService.apiDocumentConfigSaveHomeworkConfigPost(p,null===(m=this.initData.homeworkObj)||void 0===m?void 0:m.hashId).subscribe(w=>{var C;1==w.success?this.showSuccessSnack("lang_auto_them_file_thanh_cong"):this.errorStatusObj(null!==(C=w.message)&&void 0!==C?C:"",!0),this.loadingUpload=!1})),this.uploadProgress=-1}else this.loadingUpload=!1,this.showErrorSnack("lang_auto_khong_upload_duoc_anh_vui_long_thu_lai_sau_loi[SPLIT_LANG] [SPLIT_LANG]"+d.message)})})):this.showErrorSnack("lang_auto_vui_long_tai_len_file_dinh_dang_anh_pdf_word_excel_audio_hoac_video")),r.files=null}else this.openDialogWaring("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")}removeFile(e){var n;this.dialog.open(vx,{width:"400px",data:null===(n=this.formHomework.files)||void 0===n?void 0:n[e]}).afterClosed().subscribe(a=>{var r,l;if(a){null===(r=this.formHomework.files)||void 0===r||r.splice(e,1);let c={files:JSON.stringify(this.formHomework.files)};this.subscriptions.add(this.documentConfigService.apiDocumentConfigSaveHomeworkConfigPost(c,null===(l=this.initData.homeworkObj)||void 0===l?void 0:l.hashId).subscribe(_=>{var d;1==_.success?this.showSuccessSnack("lang_auto_xoa_file_thanh_cong"):this.errorStatusObj(null!==(d=_.message)&&void 0!==d?d:"",!0),this.loadingUpload=!1}))}})}processData(){var e,n,i;this.initData.homeworkObj&&(this.formHomework.files=null!==(n=this.commonService.myParseJson(null!==(e=this.initData.homeworkObj.files)&&void 0!==e?e:""))&&void 0!==n?n:[],this.initData.homeworkObj.content=this.zipdataService.decodeContentGzip(null!==(i=this.initData.homeworkObj.content)&&void 0!==i?i:""),this.formHomework.content=this.initData.homeworkObj.content.length>100?this.initData.homeworkObj.content.slice(0,100)+"...":this.initData.homeworkObj.content)}onShowFile(e,n){let i=Object.assign(Object.assign({},e),{index:n});this.dialog.open(Ri.F,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",data:{fileOption:i}})}deleteHomework(){var e;this.permissionService.hasFullPermission("homework",null===(e=this.initData.homeworkObj)||void 0===e?void 0:e.permissionObj)?this.dialog.open($i.h,{data:{obj:this.initData.homeworkObj,type:3,isShow:!0}}).afterClosed().subscribe(r=>{r&&this.commonService.myNavigation("/admin/testbank/document-management/1/0/1")}):this.openDialogWaring("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")}redirectToClassroomDetail(){var e,n,i,a,r,l,c,_,d,m;let p=`/admin/testbank/homework-results-list/${null!==(n=null===(e=this.initData.homeworkObj)||void 0===e?void 0:e.categoryId)&&void 0!==n?n:0}/${null===(i=this.initData.homeworkObj)||void 0===i?void 0:i.id}/${null===(a=this.initData.homeworkObj)||void 0===a?void 0:a.hashId}`,w=null!==(r=this.commonService.getMyQueryParam("backto"))&&void 0!==r?r:"";w&&w.includes("shareType")&&(p=`/admin/testbank/homework-results-list/${null!==(c=null===(l=this.initData.homeworkObj)||void 0===l?void 0:l.categoryId)&&void 0!==c?c:0}/${null===(_=this.initData.homeworkObj)||void 0===_?void 0:_.id}/${null===(d=this.initData.homeworkObj)||void 0===d?void 0:d.hashId}?backto=`+encodeURIComponent(encodeURIComponent(w))),this.myNavigationWithQueryString(`/admin/student/class-details/${null===(m=this.initData.classroomObj)||void 0===m?void 0:m.id}`,`?backto=${p}`)}redirectToSetting(){var e,n,i,a,r,l,c,_,d,m,p,w,C;if(this.permissionService.hasEditPermission("homework",null===(e=this.initData.homeworkObj)||void 0===e?void 0:e.permissionObj)){let M=`/admin/testbank/homework-results-list/${null!==(i=null===(n=this.initData.homeworkObj)||void 0===n?void 0:n.categoryId)&&void 0!==i?i:0}/${null===(a=this.initData.homeworkObj)||void 0===a?void 0:a.id}/${null===(r=this.initData.homeworkObj)||void 0===r?void 0:r.hashId}`,D=null!==(l=this.commonService.getMyQueryParam("backto"))&&void 0!==l?l:"";D&&D.includes("shareType")&&(M=`/admin/testbank/homework-results-list/${null!==(_=null===(c=this.initData.homeworkObj)||void 0===c?void 0:c.categoryId)&&void 0!==_?_:0}/${null===(d=this.initData.homeworkObj)||void 0===d?void 0:d.id}/${null===(m=this.initData.homeworkObj)||void 0===m?void 0:m.hashId}?backto=`+encodeURIComponent(encodeURIComponent(D))),this.myNavigationWithQueryString(`/admin/testbank/config-homework/${null!==(w=null===(p=this.initData.homeworkObj)||void 0===p?void 0:p.categoryId)&&void 0!==w?w:0}/${null===(C=this.initData.homeworkObj)||void 0===C?void 0:C.hashId}`,`?backto=${M}`)}else this.openDialogWaring("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")}openDialogWaring(e){this.commonService.getTranslate(e).subscribe(n=>{this.dialog.open(bi._,{data:{isShow:!0,content:n}})})}toggleMoreFullContent(){this.isFullContent=!this.isFullContent}ngOnInit(){this.processData(),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(j.uw),t.Y36(Mn.$),t.Y36(Ot.Cq),t.Y36(hn.n),t.Y36(Xe.$))},o.\u0275cmp=t.Xpm({type:o,selectors:[["menu-homework"]],inputs:{initData:"initData"},outputs:{reloadApi:"reloadApi"},features:[t.qOj],decls:47,vars:30,consts:[[1,"box","p-3","h-full","lg:h-auto","mb-10",2,"min-height","80vh"],[1,"document-info"],[1,"flex","md:items-center","flex-col","md:flex-row"],[1,"text-md","font-medium","truncate","mr-auto","mt-2",3,"matTooltip","isDisabledTooltip","matTooltipDisabled"],["c","isDisabled"],[1,"w-auto","flex","mt-2"],[1,"btn","btn-sm","btn-outline-primary",3,"cdkCopyToClipboard","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-file","w-4","h-4","mr-2"],["x","9","y","9","width","13","height","13","rx","2","ry","2"],["d","M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"],[1,"ml-1",3,"fileName","linkUrl"],[1,"flex","items-center","mt-2"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["x","3","y","4","width","18","height","18","rx","2","ry","2"],["x1","16","y1","2","x2","16","y2","6"],["x1","8","y1","2","x2","8","y2","6"],["x1","3","y1","10","x2","21","y2","10"],[1,"text-sm"],["class"," flex items-center mt-2",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2","lucide"],["d","M4.18 4.18A2 2 0 0 0 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 1.82-1.18"],["d","M21 15.5V6a2 2 0 0 0-2-2H9.5"],["d","M16 2v4"],["d","M3 10h7"],["d","M21 10h-5.5"],["x1","2","y1","2","x2","22","y2","22"],[1,"flex","mt-2"],[3,"ngIf"],[1,"mt-2","text-center"],[1,"btn","btn-sm","btn-transparent","btn-outline-secondary",3,"click"],[4,"ngIf"],[3,"type","typeObj","id","permissionObj"],[1,"azt-document-menu","mt-4"],[1,"text-md","font-bold"],[1,"dropdown-menu","show","relative","w-full","mt-2"],[1,"dropdown-content","bg-slate-100","dark:bg-darkmode-600"],[3,"ngStyle"],[1,"dropdown-item","text-danger",3,"click"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],[1,"dropdown-item",3,"click"],["d","M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"],["cx","12","cy","12","r","3"],[1,"azt-document-who","mt-4"],[1,"flex","items-center"],[1,"grid","grid-cols-12","gap-3","rounded-md","mt-1"],[4,"ngIf","ngIfElse"],["noClassroom",""],[1,"azt-document-content","mt-4"],["class","btn btn-outline-primary btn-sm btn-transparent ml-auto",3,"click",4,"ngIf"],[1,"azt-document-desc"],["id","description_content","class","description text-left",4,"ngIf"],["class","text-md text-center",4,"ngIf"],[1,"azt-document-file","mt-4"],["type","file","name","fileHomework",1,"azt-hidden",3,"ngModelOptions","change"],["formChoseFile",""],[1,"leading-relaxed","text-slate-500","text-xs"],["noFile",""],[1,"col-span-12","md:col-span-6"],[1,"btn","btn-outline-secondary","block","truncate","w-full",3,"matTooltip","click"],[1,"btn","btn-outline-secondary","block","cursor-default","w-full"],[1,"btn","btn-outline-primary","btn-sm","btn-transparent","ml-auto",3,"click"],["d","M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"],["d","M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"],["id","description_content",1,"description","text-left"],[3,"content","maxLength"],[1,"text-md","text-center"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","17 8 12 3 7 8"],["x1","12","y1","3","x2","12","y2","15"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","rgb(30, 41, 59)",1,"w-4","h-4","lucide","mr-2"],["fill","none","fill-rule","evenodd"],["transform","translate(1 1)","stroke-width","4"],["stroke-opacity",".5","cx","18","cy","18","r","18"],["d","M36 18c0-9.94-8.06-18-18-18"],["attributeName","transform","type","rotate","from","0 18 18","to","360 18 18","dur","1s","repeatCount","indefinite"],[1,"app-block-detail","mt-2"],[4,"ngFor","ngForOf"],[1,"btn-text-primary",2,"width","85%",3,"click"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["x1","16","y1","13","x2","8","y2","13"],["x1","16","y1","17","x2","8","y2","17"],["x1","10","y1","9","x2","8","y2","9"],[1,"truncate",2,"width","75%","text-align","left",3,"matTooltip"],[1,"btn","btn-transparent",3,"matTooltip","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"text-md","text-center","mt-3"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-5","h-5"],["points","18 15 12 9 6 15"],["points","6 9 12 15 18 9"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3,4),t._uU(5),t.qZA(),t.TgZ(6,"div",5)(7,"button",6),t.NdJ("click",function(){return n.showCopySuccess()}),t.O4$(),t.TgZ(8,"svg",7),t._UZ(9,"rect",8)(10,"path",9),t.qZA(),t._uU(11),t.ALo(12,"mytranslate"),t.qZA(),t.kcU(),t._UZ(13,"azt-download-qr-code",10),t.qZA()(),t.TgZ(14,"div",11),t.O4$(),t.TgZ(15,"svg",12),t._UZ(16,"rect",13)(17,"line",14)(18,"line",15)(19,"line",16),t.qZA(),t.kcU(),t.TgZ(20,"span",17),t._uU(21),t.ALo(22,"mytranslate"),t.ALo(23,"date"),t.qZA()(),t.YNc(24,ex,10,6,"div",18),t.TgZ(25,"div",11),t.O4$(),t.TgZ(26,"svg",19),t._UZ(27,"path",20)(28,"path",21)(29,"path",22)(30,"path",23)(31,"path",24)(32,"line",25),t.qZA(),t.kcU(),t.TgZ(33,"span",17),t._uU(34),t.ALo(35,"mytranslate"),t.qZA(),t.TgZ(36,"span",17),t._uU(37),t.ALo(38,"date"),t.ALo(39,"mytranslate"),t.qZA()(),t.TgZ(40,"div",26),t.YNc(41,nx,1,4,"ng-template",27),t.qZA()(),t.YNc(42,px,61,55,"ng-template",27),t.TgZ(43,"div",28)(44,"button",29),t.NdJ("click",function(){return n.toggleShowActions()}),t.YNc(45,gx,3,0,"span",30),t.YNc(46,fx,3,0,"span",30),t.qZA()()()),2&e){const i=t.MAs(4);t.xp6(3),t.s9C("matTooltip",null==n.initData.homeworkObj?null:n.initData.homeworkObj.name),t.Q6J("isDisabledTooltip",!1)("matTooltipDisabled",i.isDisabled),t.xp6(2),t.hij(" ",null==n.initData.homeworkObj?null:n.initData.homeworkObj.name," "),t.xp6(2),t.Q6J("cdkCopyToClipboard",n.copyLinkToClipboard(null==n.initData.homeworkObj?null:n.initData.homeworkObj.hashId)),t.xp6(4),t.hij(" ",t.lcZ(12,16,"lang_auto_copy_link")," "),t.xp6(2),t.Q6J("fileName","azota_submit_homework_qrcode_"+(null==n.initData.homeworkObj?null:n.initData.homeworkObj.hashId))("linkUrl",n.copyLinkToClipboard(null==n.initData.homeworkObj?null:n.initData.homeworkObj.hashId)),t.xp6(8),t.hij(" ",t.lcZ(22,18,"lang_testbank_tested_list_date_create")+": "+t.xi3(23,20,null==n.initData.homeworkObj?null:n.initData.homeworkObj.createdAt,"dd/MM/yyyy HH:mm")," "),t.xp6(3),t.Q6J("ngIf",null==n.initData.homeworkObj?null:n.initData.homeworkObj.startDate),t.xp6(10),t.hij(" ",t.lcZ(35,23,"lang_auto_han_cuoi")+": "," "),t.xp6(3),t.hij(" ",null!=n.initData.homeworkObj&&n.initData.homeworkObj.deadline?t.xi3(38,25,null==n.initData.homeworkObj?null:n.initData.homeworkObj.deadline,"dd/MM/yyyy HH:mm:ss"):t.lcZ(39,28,"lang_auto_khong_thoi_han")," "),t.xp6(4),t.Q6J("ngIf",n.initData.homeworkObj&&n.initData.homeworkObj.hasOwnProperty("id")),t.xp6(1),t.Q6J("ngIf",n.isShowActions),t.xp6(3),t.Q6J("ngIf",n.isShowActions),t.xp6(1),t.Q6J("ngIf",!n.isShowActions)}},dependencies:[O.sg,O.O5,O.PC,Ln.i3,Wt.gM,ci.I,Yi.o,tx,Cn.Q,O.uU,at.bT,at.BU,at.vL,at.El],encapsulation:2}),o})(),vx=(()=>{class o{constructor(e,n){this.dialogRef=e,this.data=n}ngOnInit(){}handleCloseDialog(){this.dialogRef.close(!1)}handleConfirmDialog(){this.dialogRef.close(!0)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(j.so),t.Y36(j.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["delete-dialog"]],decls:23,vars:12,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-5"],[1,"text-md","font-medium","flex","items-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-6","h-6","mr-2","text-danger"],["d","M3 6h18"],["d","M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"],["d","M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],[1,"mt-2"],[1,"text-xs","text-slate-500","dark:text-slate-400"],[1,"p-3","text-right"],[1,"btn","btn-secondary","w-24","mr-2",3,"click"],[1,"btn","w-24","btn-danger",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t.O4$(),t.TgZ(4,"svg",4),t._UZ(5,"path",5)(6,"path",6)(7,"path",7)(8,"line",8)(9,"line",9),t.qZA(),t._uU(10),t.ALo(11,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(12,"div",10)(13,"p",11),t._uU(14),t.ALo(15,"mytranslate"),t.qZA()()()(),t.TgZ(16,"div",12)(17,"button",13),t.NdJ("click",function(){return n.handleCloseDialog()}),t._uU(18),t.ALo(19,"mytranslate"),t.qZA(),t.TgZ(20,"button",14),t.NdJ("click",function(){return n.handleConfirmDialog()}),t._uU(21),t.ALo(22,"mytranslate"),t.qZA()()()),2&e&&(t.xp6(10),t.hij(" ",t.lcZ(11,4,"lang_auto_ban_co_chac_chan_muon_xoa")+" ?"," "),t.xp6(4),t.hij(" ",t.lcZ(15,6,"lang_auto_ban_muon_xoa_file")+" "+n.data.name," "),t.xp6(4),t.hij(" ",t.lcZ(19,8,"lang_auto_dong")," "),t.xp6(3),t.hij(" ",t.lcZ(22,10,"lang_auto_xac_nhan")," "))},dependencies:[at.bT],encapsulation:2}),o})();const bx=["TABLE"],wx=function(){return{}};function Tx(o,s){if(1&o&&(t.TgZ(0,"tr")(1,"td",4),t._uU(2),t.qZA(),t.TgZ(3,"td",4),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.ALo(8,"mytranslate"),t.ALo(9,"mytranslate"),t.qZA(),t.TgZ(10,"td",4),t._uU(11),t.qZA(),t.TgZ(12,"td",4),t._uU(13),t.ALo(14,"mytranslate"),t.ALo(15,"mytranslate"),t.ALo(16,"mytranslate"),t.qZA(),t.TgZ(17,"td",4),t._uU(18),t.qZA()()),2&o){const e=s.$implicit,n=t.oxw();t.xp6(2),t.Oqu(e.fullName),t.xp6(2),t.Oqu(t.xi3(5,6,e.birthday,"dd/MM/yyyy")),t.xp6(3),t.Oqu(0==e.gender?t.lcZ(8,9,"lang_gender_female"):1==e.gender?t.lcZ(9,11,"lang_gender_male"):""),t.xp6(4),t.Oqu(e.code),t.xp6(2),t.Oqu(e.isMarked?n.checkPoint(e.point?e.point:0):e.mustReSubmit?t.lcZ(14,13,"lang_homework_utils_excel_table_export_must_resubmit"):e.isNotSubmit?t.lcZ(15,15,"lang_homework_utils_excel_table_export_not_submit"):t.lcZ(16,17,"lang_homework_utils_excel_table_export_not_point")),t.xp6(5),t.Oqu(n.getComment(e.answer?e.answer:t.DdM(19,wx)))}}let Cx=(()=>{class o extends mt.Q{constructor(e,n){super(e),this.commonService=e,this.exportExcelService=n,this.studentList=[],this.homeworkObj={},this.currentDate=new Date,this.tableType="homework"}exportToExcel(){var e;let n=this.homeworkObj.hasOwnProperty("name")?this.commonService.createFileNameExportFile([null!==(e=this.homeworkObj.name)&&void 0!==e?e:""])+"-ScoreSheet.xlsx":this.commonService.createFileNameExportFile(["ScoreSheet"])+".xlsx";this.exportExcelService.exportHtmlTableToExcel(this.TABLE,!0,n)}checkPoint(e){var n,i,a,r,l;let c=null!==(n=this.commonService.myTranslateIntance("lang_auto_dat"))&&void 0!==n?n:"",_=null!==(i=this.commonService.myTranslateIntance("lang_auto_chua_dat"))&&void 0!==i?i:"",d=null!==(a=this.commonService.myTranslateIntance("lang_auto_hoan_thanh"))&&void 0!==a?a:"",m=null!==(r=this.commonService.myTranslateIntance("lang_auto_chua_hoan_thanh"))&&void 0!==r?r:"",p=null!==(l=this.commonService.myTranslateIntance("lang_auto_hoan_thanh_tot"))&&void 0!==l?l:"";switch(e){case 1e3:return c;case 1001:return _;case 2e3:return d;case 2001:return m;case 3e3:return p;default:return e}}getComment(e){var n="";return null!=e&&e.result&&(n=this.commonService.willDeleteParseJson(e.result).comment),n}ngOnInit(){super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Gn.O))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-excel-export"]],viewQuery:function(e,n){if(1&e&&t.Gf(bx,5),2&e){let i;t.iGM(i=t.CRH())&&(n.TABLE=i.first)}},inputs:{studentList:"studentList",homeworkObj:"homeworkObj",currentDate:"currentDate",tableType:"tableType"},features:[t.qOj],decls:47,vars:34,consts:[[1,"table","table-bordered","azt-hidden",3,"id","click"],["TABLE",""],[1,"thead-dark"],["colspan","10"],[1,"border-table"],[4,"ngFor","ngForOf"],["colspan","2"]],template:function(e,n){1&e&&(t.TgZ(0,"table",0,1),t.NdJ("click",function(){return n.exportToExcel()}),t.TgZ(2,"thead",2)(3,"tr")(4,"th",3),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()(),t.TgZ(7,"tr"),t._UZ(8,"th"),t.qZA(),t.TgZ(9,"tr")(10,"th",3),t._uU(11),t.ALo(12,"mytranslate"),t.ALo(13,"date"),t.qZA()(),t.TgZ(14,"tr"),t._UZ(15,"th"),t.qZA(),t.TgZ(16,"tr")(17,"th",4),t._uU(18),t.ALo(19,"mytranslate"),t.qZA(),t.TgZ(20,"th",4),t._uU(21),t.ALo(22,"mytranslate"),t.qZA(),t.TgZ(23,"th",4),t._uU(24),t.ALo(25,"mytranslate"),t.qZA(),t.TgZ(26,"th",4),t._uU(27),t.ALo(28,"mytranslate"),t.qZA(),t.TgZ(29,"th",4),t._uU(30),t.ALo(31,"mytranslate"),t.qZA(),t.TgZ(32,"th",4),t._uU(33),t.ALo(34,"mytranslate"),t.qZA()()(),t.TgZ(35,"tbody"),t.YNc(36,Tx,19,20,"tr",5),t._UZ(37,"tr"),t.TgZ(38,"tr"),t._UZ(39,"td")(40,"td")(41,"td")(42,"td"),t.TgZ(43,"td",6),t._uU(44),t.ALo(45,"mytranslate"),t.qZA(),t._UZ(46,"td"),t.qZA()()()),2&e&&(t.MGl("id","table_",n.tableType,""),t.xp6(5),t.AsE("",t.lcZ(6,13,"lang_homework_utils_excel_table_export_homework"),": ",n.homeworkObj.name,""),t.xp6(6),t.AsE("",t.lcZ(12,15,"lang_homework_utils_excel_table_export_time_export_result"),": ",t.xi3(13,17,n.currentDate,"dd/MM/yyyy"),""),t.xp6(7),t.Oqu(t.lcZ(19,20,"lang_first_and_last_name")),t.xp6(3),t.Oqu(t.lcZ(22,22,"lang_birthday")),t.xp6(3),t.Oqu(t.lcZ(25,24,"lang_gender")),t.xp6(3),t.Oqu(t.lcZ(28,26,"lang_number_code")),t.xp6(3),t.Oqu(t.lcZ(31,28,"lang_point")),t.xp6(3),t.Oqu(t.lcZ(34,30,"lang_homework_utils_excel_table_export_comment")),t.xp6(3),t.Q6J("ngForOf",n.studentList),t.xp6(8),t.hij("",t.lcZ(45,32,"lang_homework_utils_excel_table_export_verifil_teacher"),": "))},dependencies:[O.sg,O.uU,at.bT],encapsulation:2}),o})();const Ax=["drawer"],yx=["boxContent"];function kx(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function Ox(o,s){if(1&o&&(t.TgZ(0,"div",8)(1,"span"),t.O4$(),t.TgZ(2,"svg",9),t._UZ(3,"circle",10)(4,"line",11)(5,"line",12),t.qZA()(),t.kcU(),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"mytranslate"),t.ALo(9,"mytranslate"),t.qZA()()),2&o){const e=t.oxw(3);t.xp6(7),t.AsE("",t.lcZ(8,2,"lang_homework_homework_score_list_not_search_data"),"! ",t.lcZ(9,4,"lang_core_not_found_classroom_or_homework"==e.errorMessage?"lang_homework_homework_score_list_class_maybe_delete":""),"")}}function Sx(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",87),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(4);return t.KtG(i.openDrawer())}),t.ALo(1,"mytranslate"),t.O4$(),t.TgZ(2,"svg",53),t._UZ(3,"rect",88)(4,"path",89)(5,"path",90),t.qZA()()}2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_auto_mo_menu"))}function Ex(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",87),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(4);return t.KtG(i.closeDrawer())}),t.ALo(1,"mytranslate"),t.O4$(),t.TgZ(2,"svg",53),t._UZ(3,"rect",88)(4,"path",89)(5,"path",91),t.qZA()()}2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_auto_dong_menu"))}function Ix(o,s){1&o&&(t.TgZ(0,"div",92)(1,"div",93)(2,"p",94),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()()()),2&o&&(t.xp6(3),t.hij("",t.lcZ(4,1,"lang_not_found_search"),"!"))}function Zx(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function Mx(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"app-student-homework-result",95),t.NdJ("goToResult",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.goToTestReview(i))}),t.qZA()}if(2&o){const e=t.oxw(4);t.Q6J("isSortByTime",e.isSortByTimeDESC)("backToLink",e.backToLink)("searchKey",e.form.controls.searchContent.value)("studentLists",e.dataListStudents)("isNotTestedYet",e.isNotTestedYet)("isOpenSideNav",e.isOpenSideNav)("obj",e.homeworkObj)("isMobile",e.isMobile)}}const Px=function(o,s){return{"w-85":o,"w-30":s}},Lx=function(){return{suppressScrollX:!0}},Nx=function(o){return{"ml-5":o}},Dx=function(o){return{"px-0":o}},jx=function(o){return[o]};function qx(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"mat-drawer-container",13)(1,"mat-drawer",14,15),t.NdJ("closedStart",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.changeStatusNav())}),t.TgZ(3,"perfect-scrollbar",16),t._UZ(4,"menu-homework",17),t.qZA()(),t.TgZ(5,"mat-drawer-content")(6,"div",18)(7,"div",19,20),t.YNc(9,Sx,6,3,"button",21),t.YNc(10,Ex,6,3,"button",21),t.TgZ(11,"div",22)(12,"div",23)(13,"form",24)(14,"input",25),t.NdJ("keyup.enter",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.search())}),t.ALo(15,"mytranslate"),t.qZA(),t.O4$(),t.TgZ(16,"svg",26),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.search())}),t._UZ(17,"circle",27)(18,"line",28),t.qZA()()(),t.kcU(),t.TgZ(19,"div",29)(20,"button",30),t.O4$(),t.TgZ(21,"svg",31),t._UZ(22,"polygon",32),t.qZA(),t.kcU(),t.TgZ(23,"span",33),t._uU(24),t.ALo(25,"mytranslate"),t.qZA()(),t.TgZ(26,"mat-menu",34,35)(28,"div",36)(29,"ul",37)(30,"li")(31,"label",38),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(32),t.ALo(33,"mytranslate"),t.TgZ(34,"div",39)(35,"input",40),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.toggleFilterSubmitted(i))}),t.qZA()()()(),t.TgZ(36,"li")(37,"label",41),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(38),t.ALo(39,"mytranslate"),t.TgZ(40,"div",39)(41,"input",42),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.toggleFilterNotSubmit(i))}),t.qZA()()()(),t.TgZ(42,"li")(43,"label",43),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(44),t.ALo(45,"mytranslate"),t.TgZ(46,"div",39)(47,"input",44),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.toggleFilterMarked(i))}),t.qZA()()()(),t.TgZ(48,"li")(49,"label",45),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(50),t.ALo(51,"mytranslate"),t.TgZ(52,"div",39)(53,"input",46),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.toggleFilterReSubmit(i))}),t.qZA()()()(),t.TgZ(54,"li"),t._UZ(55,"hr",47),t.qZA(),t.TgZ(56,"li")(57,"div",48)(58,"button",49),t._uU(59),t.ALo(60,"mytranslate"),t.qZA(),t.TgZ(61,"div",50),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(62,"button",51),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.clearFilter())}),t._uU(63),t.ALo(64,"mytranslate"),t.qZA()()()()()()()(),t.TgZ(65,"div",52)(66,"button",30),t.O4$(),t.TgZ(67,"svg",53),t._UZ(68,"line",54)(69,"line",55)(70,"line",56),t.qZA()(),t.kcU(),t.TgZ(71,"mat-menu",34,57)(73,"div",58)(74,"ul",37)(75,"li")(76,"a",59),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.exportToExcel("homework"))}),t.ALo(77,"mytranslate"),t.O4$(),t.TgZ(78,"svg",60),t._UZ(79,"path",61)(80,"polyline",62)(81,"line",63),t.qZA(),t._uU(82),t.ALo(83,"mytranslate"),t.qZA()(),t.kcU(),t.TgZ(84,"li")(85,"a",59),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.exportToPDF())}),t.ALo(86,"mytranslate"),t.O4$(),t.TgZ(87,"svg",64),t._UZ(88,"path",65)(89,"polyline",66)(90,"line",67)(91,"line",68)(92,"line",69),t.qZA(),t._uU(93),t.ALo(94,"mytranslate"),t.qZA()(),t.kcU(),t.TgZ(95,"li")(96,"label",70),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(97,"span",71),t.O4$(),t.TgZ(98,"svg",72),t._UZ(99,"path",73)(100,"path",74)(101,"path",75)(102,"path",76)(103,"path",77),t.qZA(),t._uU(104),t.ALo(105,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(106,"div",39)(107,"input",78),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.sortByTimeDESC(i))}),t.qZA()()()()()()()()()(),t.TgZ(108,"div",79)(109,"div",80)(110,"div",81)(111,"p",82),t._uU(112),t.ALo(113,"mytranslate"),t.TgZ(114,"a",83),t.ALo(115,"mylocalize"),t._uU(116),t.ALo(117,"slice"),t.qZA()()()(),t.YNc(118,Ix,5,3,"div",84),t.YNc(119,Zx,1,0,"azt-loading-effect",3),t.YNc(120,Mx,1,8,"ng-template",85),t.qZA()(),t._UZ(121,"app-excel-export",86),t.qZA()()}if(2&o){const e=t.MAs(27),n=t.MAs(72),i=t.oxw(3);t.Q6J("hasBackdrop",i.hasBackdrop),t.xp6(1),t.s9C("opened",i.isOpenSideNav?"true":"false"),t.Q6J("ngClass",t.WLB(78,Px,i.isMobile,!i.isMobile))("mode",i.mode),t.xp6(2),t.Q6J("config",t.DdM(81,Lx))("scrollIndicators",!0),t.xp6(1),t.Q6J("initData",i.initDataHomework),t.xp6(2),t.Q6J("ngClass",t.VKq(82,Nx,!i.isMobile&&i.isOpenSideNav)),t.xp6(3),t.Q6J("ngIf",!i.isOpenSideNav||i.isMobile),t.xp6(1),t.Q6J("ngIf",i.isOpenSideNav&&!i.isMobile),t.xp6(3),t.Q6J("formGroup",i.form),t.xp6(1),t.s9C("placeholder",t.lcZ(15,44,"lang_homework_homework_score_list_search")),t.xp6(6),t.Q6J("matMenuTriggerFor",e),t.xp6(4),t.hij(" ",t.lcZ(25,46,"lang_testbank_testted_list_sort")," "),t.xp6(8),t.hij(" ",t.lcZ(33,48,"lang_homework_homework_score_list_sort_student_not_marking")," "),t.xp6(3),t.Q6J("checked",i.isSubmitted),t.xp6(3),t.hij(" ",t.lcZ(39,50,"lang_homework_homework_score_list_sort_student_not_yet_paid")," "),t.xp6(3),t.Q6J("checked",i.isNotSubmit),t.xp6(3),t.hij(" ",t.lcZ(45,52,"lang_homework_homework_score_list_sort_mark")," "),t.xp6(3),t.Q6J("checked",i.isMarked),t.xp6(3),t.hij(" ",t.lcZ(51,54,"lang_homework_homework_score_list_sort_student_resubmit")," "),t.xp6(3),t.Q6J("checked",i.mustReSubmit),t.xp6(6),t.hij(" ",t.lcZ(60,56,"lang_buttom_close")," "),t.xp6(4),t.hij(" ",t.lcZ(64,58,"lang_buttom_delete")," "),t.xp6(3),t.Q6J("matMenuTriggerFor",n),t.xp6(10),t.s9C("matTooltip",t.lcZ(77,60,"lang_homework_homework_score_list_export_excel")),t.xp6(6),t.hij(" ",t.lcZ(83,62,"lang_homework_homework_score_list_export_excel")," "),t.xp6(3),t.s9C("matTooltip",t.lcZ(86,64,"lang_homework_homework_score_list_export_pdf")),t.xp6(8),t.hij(" ",t.lcZ(94,66,"lang_homework_homework_score_list_export_pdf")," "),t.xp6(11),t.hij(" ",t.lcZ(105,68,"lang_testbank_testted_list_sort_time")," "),t.xp6(3),t.Q6J("checked",i.isSortByTimeDESC),t.xp6(1),t.Q6J("ngClass",t.VKq(84,Dx,i.isMobile||!i.isOpenSideNav)),t.xp6(4),t.hij("",t.lcZ(113,70,"lang_homework_homework_score_list_list_submit_class"),": "),t.xp6(2),t.s9C("matTooltip",i.classObj.name),t.Q6J("routerLink",t.VKq(86,jx,t.lcZ(115,72,"/admin/student/class-details/"+i.classId))),t.xp6(2),t.AsE(" ",i.classObj.name&&i.classObj.name.length>20?t.Dn7(117,74,i.classObj.name,0,20)+"..":i.classObj.name," (",(null==i.initDataHomework.homeworkObj?null:i.initDataHomework.homeworkObj.count)+"/"+(null==i.initDataHomework.studentObjs?null:i.initDataHomework.studentObjs.length),") "),t.xp6(2),t.Q6J("ngIf",i.isNullSearchData),t.xp6(1),t.Q6J("ngIf",1==i.isLoadingSearch),t.xp6(1),t.Q6J("ngIf",!i.isNullSearchData&&0==i.isLoadingSearch),t.xp6(1),t.Q6J("studentList",i.dataListStudents)("homeworkObj",i.homeworkObj)("currentDate",i.currentDate)("typeTable","homework")}}function Qx(o,s){1&o&&t._UZ(0,"div",96)}function Ux(o,s){if(1&o&&(t.TgZ(0,"div")(1,"div",4),t.YNc(2,Ox,10,6,"div",5),t.YNc(3,qx,122,88,"mat-drawer-container",6),t.qZA(),t.YNc(4,Qx,1,0,"div",7),t.qZA()),2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",""!=e.errorMessage),t.xp6(1),t.Q6J("ngIf",""==e.errorMessage),t.xp6(1),t.Q6J("ngIf",1==e.isMobile)}}function Fx(o,s){if(1&o&&t.YNc(0,Ux,5,3,"div",3),2&o){const e=t.oxw();t.Q6J("ngIf",e.homeworkObj)}}let Rx=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_,d,m){super(n),this.dialog=e,this.commonService=n,this.localize=i,this.activeRoute=a,this.fb=r,this.answerService=l,this.zipdataService=c,this.sortService=_,this.browserStorageService=d,this.examFilterService=m,this.currentDate=new Date,this.homeworkId="",this.categoryId=0,this.classId=0,this.form=new h.nJ({}),this.contentHeight=0,this.backUpHeight=0,this.backToLink="",this.paramBackToLink="",this.hasBackdrop=!!this.commonService.isMobileOrTable(),this.mode=this.commonService.isMobileOrTable()?"over":"side",this.isMobile=this.commonService.isMobileOrTable(),this.isShowActions=(this.commonService.isMobileOrTable(),!0),this.isOpenSideNav=!this.commonService.isMobileOrTable(),this.isHomeworkFlow=!0,this.isSortByTimeDESC=!1,this.isSubmitted=!1,this.isNotSubmit=!1,this.isMarked=!1,this.mustReSubmit=!1,this.isLoadingSearch=!1,this.deleteHomeworkData={homeworkObj:{},isShow:!1},this.homeworkUserList=[],this.studentObjs=[],this.homeworkObj={},this.classObj={},this.isNotTestedYet=!1,this.isNullSearchData=!1,this.hasDeadline=!1,this.isShowPreviewFile=!1,this.previewFile={},this.errorMessage="",this.keyFilter="",this.dataListStudents=[],this.homeworkHashId="",this.initDataHomework={}}getData(){this.initStatusObj(),this.subscriptions.add(this.answerService.apiAnswerGetStudentsHomeworkGet(Number(this.homeworkId),this.homeworkHashId).subscribe(e=>{var n,i,a,r,l,c,_,d,m,p,w,C,A,M,D,q;if(1==e.success){this.initDataHomework=null!==(n=e.data)&&void 0!==n?n:{},this.errorMessage="",this.zipdataService.convertStudentsHomeworkObj(null===(i=e.data)||void 0===i?void 0:i.studentObjs),this.homeworkUserList=this.checkStatusStudent(null!==(r=null===(a=e.data)||void 0===a?void 0:a.studentObjs)&&void 0!==r?r:new Array),this.homeworkObj=this.parseHomeworkData(null!==(c=null===(l=e.data)||void 0===l?void 0:l.homeworkObj)&&void 0!==c?c:{}),this.classObj=null!==(d=null===(_=e.data)||void 0===_?void 0:_.classroomObj)&&void 0!==d?d:{},this.classId=null!==(m=this.classObj.id)&&void 0!==m?m:0,this.categoryId=null!==(w=null===(p=this.homeworkObj)||void 0===p?void 0:p.categoryId)&&void 0!==w?w:0;let F=null!==(C=this.commonService.getMyQueryParam("backto"))&&void 0!==C?C:"";if(this.backToLink="/admin/testbank/homework-results-list/"+this.categoryId+"/"+this.homeworkId+"/"+this.homeworkHashId,F&&F.includes("shareType")&&(this.backToLink=`/admin/testbank/homework-results-list/${this.categoryId}/${this.homeworkId}/${this.homeworkHashId}?backto=`+encodeURIComponent(encodeURIComponent(F))),(null===(A=this.homeworkObj)||void 0===A?void 0:A.deadline)&&null!=this.homeworkObj.deadline&&""!=this.homeworkObj.deadline.toString()&&(this.hasDeadline=!0),0==this.homeworkUserList.length)return this.isNotTestedYet=!0,void this.errorStatusObj("NO_TESTED_YET");this.studentObjs=this.commonService.myClone(this.homeworkUserList),this.isNullSearchData=!1,setTimeout(()=>{this.checkFilterValue()},0),this.getStatusSideNav();var U=this.browserStorageService.getSimpleStorage(this.homeworkId+"_azt_setting_sort_desc_submit_by_time");U&&"true"==U?(this.isSortByTimeDESC=!0,this.dataListStudents=this.checkSortListStudent(99,this.studentObjs)):(this.isSortByTimeDESC=!1,this.dataListStudents=this.checkSortListStudent(null!==(M=this.classObj.sortType)&&void 0!==M?M:0,this.studentObjs)),this.successStatusObj()}else this.errorMessage=null!==(D=e.message)&&void 0!==D?D:"",this.errorStatusObj(null!==(q=e.message)&&void 0!==q?q:"",!0)}))}checkStatusStudent(e){for(var n,i,a=[],r=0;r<e.length;r++)a.push(Object.assign(Object.assign({},null==e?void 0:e[r]),{index:r})),e[r].confirmedAt&&e[r].confirmedAt&&a[r].index==r?a[r].isMarked=!0:null==e[r].answer||e[r].confirmedAt||a[r].index!=r?null==e[r].answer&&null!=e[r].answerHistory&&a[r].index==r?a[r].mustReSubmit=!0:a[r].isNotSubmit=!0:a[r].isSubmitted=!0,a[r].answerFileObjs=this.castJsonToObj(null!==(i=null===(n=e[r].answer)||void 0===n?void 0:n.files)&&void 0!==i?i:"");return a}parseHomeworkData(e){var n=this.castObj(e);return null!=n&&n.files&&(n.fileObjs=this.commonService.myParseJson(n.files)),this.zipdataService.convertHomeworkObj(null!=n?n:{}),n}fillerArr(e,n){var i;n=this.commonService.convertVietnameseToEnglish(n);var a=[];for(let c=0;c<e.length;c++)-1!=this.commonService.convertVietnameseToEnglish(null!==(i=e[c].fullName)&&void 0!==i?i:"").toLowerCase().indexOf(n.toLowerCase())&&a.push(e[c]);return a}search(){var e,n;this.isLoadingSearch=!0;var i=this.commonService.getFormObj(this.form);if(""!=i.searchContent){var a=this.commonService.myClone(this.checkSortListStudent(null!==(e=this.classObj.sortType)&&void 0!==e?e:0,this.studentObjs)),r=this.fillerArr(a,i.searchContent);this.dataListStudents=r,this.isLoadingSearch=!1}else this.isLoadingSearch=!1,this.homeworkUserList=this.studentObjs,this.dataListStudents=this.checkSortListStudent(null!==(n=this.classObj.sortType)&&void 0!==n?n:0,this.studentObjs),this.isNullSearchData=!1,this.errorStatusObj("NO_TESTED_YET")}toggleFilterSubmitted(e){this.isSubmitted=!!e.target.checked,this.confirmFilter()}toggleFilterNotSubmit(e){this.isNotSubmit=!!e.target.checked,this.confirmFilter()}toggleFilterMarked(e){this.isMarked=!!e.target.checked,this.confirmFilter()}toggleFilterReSubmit(e){this.mustReSubmit=!!e.target.checked,this.confirmFilter()}confirmFilter(){var e,n=[],i=[],a=[],r=[];this.saveFilterValue(),this.isSubmitted&&(n=this.studentObjs.filter(_=>1==_.isSubmitted)),this.isNotSubmit&&(i=this.studentObjs.filter(_=>1==_.isNotSubmit)),this.isMarked&&(a=this.studentObjs.filter(_=>1==_.isMarked)),this.mustReSubmit&&(r=this.studentObjs.filter(_=>1==_.mustReSubmit)),this.isSubmitted||this.isNotSubmit||this.isMarked||this.mustReSubmit?this.homeworkUserList=this.sortIndex([...n,...i,...a,...r]):this.clearFilter();let l=this.homeworkUserList;var c=this.browserStorageService.getSimpleStorage(this.homeworkId+"_azt_setting_sort_desc_submit_by_time");this.dataListStudents=this.checkSortListStudent(c&&"true"==c?99:null!==(e=this.classObj.sortType)&&void 0!==e?e:0,l)}clearFilter(){var e;this.isSubmitted=!1,this.isNotSubmit=!1,this.isMarked=!1,this.mustReSubmit=!1,this.homeworkUserList=this.studentObjs;var n=this.browserStorageService.getSimpleStorage(this.homeworkId+"_azt_setting_sort_desc_submit_by_time");this.dataListStudents=this.checkSortListStudent(n&&"true"==n?99:null!==(e=this.classObj.sortType)&&void 0!==e?e:0,this.studentObjs),this.removeFilterStore()}removeFilterStore(){this.examFilterService.removeCustomFilter("homework",this.homeworkId)}exportToExcel(e){setTimeout(()=>{var n;null===(n=document.getElementById("table_"+e))||void 0===n||n.click()},1e3)}exportToPDF(){this.commonService.gaEvent("go_to_exp_pdf_homework");const e=this.localize.translateRoute("/admin/homework/export-homework")+"/"+this.classId+"/"+this.homeworkId+"/"+this.homeworkHashId;window.open(e,"_blank")}resizeImg(e,n,i){var a,r=document.getElementById("media_content_"+e),l=null!==(a=null==r?void 0:r.offsetWidth)&&void 0!==a?a:0;return r?l/n<=1?Math.round(i*(l/n)):Math.round(i):0}sortIndex(e){return e.sort((n,i)=>Number(n)-Number(i))}sortByName(){this.homeworkUserList=this.sortService.sortFirstNameStudents(this.studentObjs)}getFileName(e){var n;return"object"==typeof e&&e.hasOwnProperty("name")&&null!==(n=e.name)&&void 0!==n?n:""}sortByTimeDESC(e){var n;e.target.checked?(this.isSortByTimeDESC=e.target.checked,this.dataListStudents=this.checkSortListStudent(99,this.commonService.myClone(this.studentObjs)),this.browserStorageService.saveSimpleStorage(this.homeworkId+"_azt_setting_sort_desc_submit_by_time",e.target.checked.toString())):(this.isSortByTimeDESC=e.target.checked,this.dataListStudents=this.checkSortListStudent(null!==(n=this.classObj.sortType)&&void 0!==n?n:0,this.studentObjs),this.browserStorageService.saveSimpleStorage(this.homeworkId+"_azt_setting_sort_desc_submit_by_time",e.target.checked.toString()))}goToTestReview(e){var n;this.commonService.myNavigationWithQueryString("/admin/homework/mark-exercise/"+(null===(n=e.answer)||void 0===n?void 0:n.id)+"/"+this.homeworkHashId,"?backto="+encodeURIComponent("/admin/testbank/homework-results-list/"+this.classId+"/"+this.homeworkId+"/"+this.homeworkHashId))}disableScroll(){let e=window.pageYOffset||document.documentElement.scrollLeft,n=window.pageXOffset||document.documentElement.scrollTop;window.onscroll=()=>{window.scrollTo(e,n)}}enableScroll(){window.onscroll=()=>{}}onFileClose(){this.enableScroll(),this.isShowPreviewFile=!1,this.previewFile={}}onShowFile(e,n){this.isShowPreviewFile=!0,this.disableScroll(),this.previewFile=Object.assign(Object.assign({},e),{index:n})}toggleDrawer(){var e;null===(e=this.drawer)||void 0===e||e.toggle(),this.isOpenSideNav=!this.isOpenSideNav}openDrawer(){var e;null===(e=this.drawer)||void 0===e||e.open(),this.isOpenSideNav=!0,this.saveStatusSideNav()}closeDrawer(){var e;null===(e=this.drawer)||void 0===e||e.close(),this.isOpenSideNav=!1,this.saveStatusSideNav(),this.isMobile&&(document.body.style.overflow="auto")}changeStatusNav(){this.isMobile&&(document.body.style.overflow="auto")}saveStatusSideNav(){this.examFilterService.saveStatusSideNav("homework",this.isOpenSideNav)}removeStatusSideNav(){this.examFilterService.removeStatusSideNav("homework")}getStatusSideNav(){if(window.innerWidth>980){let e=this.examFilterService.getStatusSideNav("homework");this.isOpenSideNav=!e||"close"!=e}else this.isOpenSideNav=!1}toggleShowActions(){this.isShowActions=!this.isShowActions,this.isMobile&&(this.contentHeight=0==this.isShowActions?200:this.backUpHeight)}showCopySuccess(){this.showSuccessSnack("lang_auto_sao_chep_thanh_cong_duong_dan_nop_bai")}copyLinkToClipboard(e){return`${this.commonService.getCurrentDomain()}/bai-tap/${e}`}goToStudentList(){this.commonService.myNavigation("/admin/student/manage-class/0")}checkSortListStudent(e,n){return 0==e?this.sortService.sortFirstNameStudents(this.commonService.myClone(n)):99==e?this.sortService.sortTimeDESC(this.commonService.myClone(n)):this.sortService.sortArrayByMultipleObjectKeyAsc(this.commonService.myClone(n),"pos","id")}saveFilterValue(){let e={};this.isMarked&&(e.isMarked=!0),this.isSubmitted&&(e.isSubmitted=!0),this.isNotSubmit&&(e.isNotSubmit=!0),this.mustReSubmit&&(e.mustReSubmit=!0),this.examFilterService.setCustomFilter(e,"homework",this.homeworkId)}checkFilterValue(){let e=this.examFilterService.getCustomFilter("homework",this.homeworkId);null!=e&&""!=e&&(e.includes("isMarked")&&(this.isMarked=!0),e.includes("isSubmitted")&&(this.isSubmitted=!0),e.includes("isNotSubmit")&&(this.isNotSubmit=!0),e.includes("mustReSubmit")&&(this.mustReSubmit=!0),this.confirmFilter())}ngOnInit(){(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var e,n,i,a;this.homeworkId=null!==(e=this.activeRoute.snapshot.paramMap.get("id"))&&void 0!==e?e:"",this.homeworkHashId=null!==(n=this.commonService.getMyParam(this.activeRoute,"hash_id"))&&void 0!==n?n:"",this.categoryId=null!==(i=Number(this.activeRoute.snapshot.paramMap.get("cat_id")))&&void 0!==i?i:0,this.paramBackToLink=null!==(a=this.commonService.getMyQueryParam("backto"))&&void 0!==a?a:`/admin/testbank/document-management/1/${this.categoryId}/1`,this.form=this.fb.group({searchContent:new h.p4("",h.kI.required)}),this.initStatusObj(),this.getData()}),this.commonService.translateMetaData({title:"lang_cms_homework_submit_list_title",description:"lang_cms_homework_submit_list_description",image:"lang_cms_homework_image"}),this.commonService.gaEvent("teacher_homework_score"),super.ngOnInit()}ngAfterViewInit(){setTimeout(()=>{var e,n;this.isMobile?(this.contentHeight=(null===(e=this.boxContent)||void 0===e?void 0:e.nativeElement.offsetHeight)+45,this.backUpHeight=(null===(n=this.boxContent)||void 0===n?void 0:n.nativeElement.offsetHeight)+45):this.contentHeight=166},1e3)}ngOnDestroy(){document.body.style.overflow="auto",super.ngOnDestroy()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(j.uw),t.Y36(vt.v),t.Y36(ji.An),t.Y36(x.gz),t.Y36(h.QS),t.Y36(b0.P),t.Y36(hn.n),t.Y36(pn.K),t.Y36(Be.z),t.Y36(qo))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-homework-result-list"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Ax,5),t.Gf(yx,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.drawer=i.first),t.iGM(i=t.CRH())&&(n.boxContent=i.first)}},features:[t.qOj],decls:4,vars:3,consts:[[3,"headerBackTolink"],[4,"ngIf","ngIfElse"],["doneLoading",""],[4,"ngIf"],[1,"container-fluid"],["class","intro-y col-span-11 alert alert-danger alert-dismissible show flex items-center mb-6",4,"ngIf"],["class","azt-drawer-container mt-5",3,"hasBackdrop",4,"ngIf"],["class","py-4",4,"ngIf"],[1,"intro-y","col-span-11","alert","alert-danger","alert-dismissible","show","flex","items-center","mb-6"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","icon-name","info","data-lucide","info",1,"lucide","w-4","h-4","mr-2"],["cx","12","cy","12","r","10"],["x1","12","y1","16","x2","12","y2","12"],["x1","12","y1","8","x2","12.01","y2","8"],[1,"azt-drawer-container","mt-5",3,"hasBackdrop"],[3,"ngClass","mode","opened","closedStart"],["drawer",""],[3,"config","scrollIndicators"],[3,"initData"],[1,"azt-drawer-content",3,"ngClass"],[1,"flex","box","sm:h-auto","rounded-md","border","border-slate-200/60","dark:border-darkmode-400","p-2","text-slate-500","mb-2"],["boxContent",""],["class","btn btn-sm mr-2",3,"matTooltip","click",4,"ngIf"],[1,"relative","flex","ml-auto"],[1,"search","mr-2"],[3,"formGroup"],["type","text","formControlName","searchContent",1,"form-control","border-transparent","bg-slate-100","dark:bg-darkmode-300","py-1","px-4","w-full","lg:w-64","box","pr-10",2,"border-radius","0.375rem",3,"placeholder","keyup.enter"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","icon-name","search",1,"lucide","w-4","h-4","absolute","my-auto","inset-y-0","mr-3","right-0","text-slate-500","cursor-pointer",3,"click"],["cx","11","cy","11","r","8"],["x1","21","y1","21","x2","16.65","y2","16.65"],[1,"filter","mr-2"],[1,"btn","btn-sm",3,"matMenuTriggerFor"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-search","w-4","h-4","mr-0","md:mr-1"],["points","22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"],[1,"azt-hidden","md:block"],["xPosition","before"],["filterMenu","matMenu"],[1,"dropdown-menu","show","relative","w-64"],[1,"dropdown-content"],["for","isSubmitted",1,"dropdown-item","cursor-pointer",3,"click"],[1,"form-check","form-switch","ml-auto"],["id","isSubmitted","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],["for","isNotSubmit",1,"dropdown-item","cursor-pointer",3,"click"],["id","isNotSubmit","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],["for","isMarked",1,"dropdown-item","cursor-pointer",3,"click"],["id","isMarked","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],["for","mustReSubmit",1,"dropdown-item","cursor-pointer",3,"click"],["id","mustReSubmit","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],[1,"dropdown-divider"],[1,"flex","p-1"],[1,"btn","btn-secondary","py-1","px-2","ml-auto","mr-2"],[3,"click"],[1,"btn","btn-danger","py-1","px-2",3,"click"],[1,"menu"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-menu","w-4","h-4"],["x1","4","y1","12","x2","20","y2","12"],["x1","4","y1","6","x2","20","y2","6"],["x1","4","y1","18","x2","20","y2","18"],["mainMenu","matMenu"],[1,"dropdown-menu","show","relative","w-72"],[1,"dropdown-item",3,"matTooltip","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide","mr-2"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","7 10 12 15 17 10"],["x1","12","y1","15","x2","12","y2","3"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["x1","16","y1","13","x2","8","y2","13"],["x1","16","y1","17","x2","8","y2","17"],["x1","10","y1","9","x2","8","y2","9"],["for","isSortByTimeDESC",1,"dropdown-item","cursor-pointer",3,"click"],[1,"flex","items-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2","lucide"],["d","M11 5h10"],["d","M11 9h7"],["d","M11 13h4"],["d","m3 17 3 3 3-3"],["d","M6 18V4"],["id","isSortByTimeDESC","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],[1,"container-fluid","content-zone","pr-0",3,"ngClass"],[1,"row","mt-2","align-items-center","mx-auto",2,"width","100%"],[1,"col-10","p-0","text-left"],[1,"mb-1","h6",2,"font-weight","400","font-size","14px"],[1,"clickable","link-stu",3,"routerLink","matTooltip"],["class","box-content py-2",4,"ngIf"],[3,"ngIf"],[3,"studentList","homeworkObj","currentDate","typeTable"],[1,"btn","btn-sm","mr-2",3,"matTooltip","click"],["x","3","y","3","width","18","height","18","rx","2","ry","2"],["d","M9 3v18"],["d","m14 9 3 3-3 3"],["d","m16 15-3-3 3-3"],[1,"box-content","py-2"],[1,"text-center","mt-3"],[1,"h4"],[3,"isSortByTime","backToLink","searchKey","studentLists","isNotTestedYet","isOpenSideNav","obj","isMobile","goToResult"],[1,"py-4"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0),t.YNc(1,kx,1,0,"azt-loading-effect",1),t.YNc(2,Fx,1,1,"ng-template",null,2,t.W1O),t.qZA()),2&e){const i=t.MAs(3);t.Q6J("headerBackTolink",n.paramBackToLink),t.xp6(1),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[x.yS,O.mk,O.O5,he.VK,he.p6,qn.jA,qn.kh,qn.LW,Wt.gM,Lt.Vv,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,te.Q,Y0,oe.M,de._,xx,Cx,O.OU,at.mp,at.bT],encapsulation:2}),o})(),Bx=(()=>{class o extends mt.Q{redirectToDonate(){this.commonService.myNavigation("/admin/testbank/donate")}}return o.\u0275fac=function(){let s;return function(n){return(s||(s=t.n5z(o)))(n||o)}}(),o.\u0275cmp=t.Xpm({type:o,selectors:[["app-testbank"]],features:[t.qOj],decls:2,vars:0,consts:[["id","testbank-layout"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"router-outlet"),t.qZA())},dependencies:[x.lC],styles:[".header-container[_ngcontent-%COMP%]{border-bottom-left-radius:3px;border-bottom-right-radius:3px;box-shadow:#a997973d 0 1px 7px}.btn-donate[_ngcontent-%COMP%]{background:transparent;border:none;text-transform:inherit;font-size:14px;color:#3c8dbc;display:flex;justify-content:center;align-items:center;margin-right:15px;transition:all .5s}.btn-donate[_ngcontent-%COMP%]:hover{color:#204e69}.btn-donate[_ngcontent-%COMP%]:hover   .donate-icon[_ngcontent-%COMP%]{animation:bounce 1.2s 2s 8}.donate-icon[_ngcontent-%COMP%]{margin-right:5px;animation:bounce 1.2s 2s 8}@keyframes bounce{0%,20%,53%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1);transform:translateZ(0)}40%,43%{animation-timing-function:cubic-bezier(.755,.05,.855,.06);transform:translate3d(0,-14px,0) scaleY(1.1) rotate(-15deg)}70%{animation-timing-function:cubic-bezier(.755,.05,.855,.06);transform:translate3d(0,-7px,0) scaleY(1.05) rotate(15deg)}80%{transition-timing-function:cubic-bezier(.215,.61,.355,1);transform:translateZ(0) scaleY(.95) rotate(0)}90%{transform:translate3d(0,-2px,0) scaleY(1.02) rotate(0)}}@media screen and (max-width: 768px){.donate-title[_ngcontent-%COMP%]{display:none}.btn-donate[_ngcontent-%COMP%]{margin-right:0}}"]}),o})();var Jx=b(28258),Hx=b(591),zx=b(36787);class aa{constructor(s,e,n,i,a=1,r=!1,l=!1,c){this.id=s,this.pr=e,this.type=n,this.item=i,this.level=a,this.expandable=r,this.isLoading=l,this.prNode=c}}let Yx=(()=>{class o{constructor(e){this.documentService=e,this.dataMap=new Map}initialData(){return new Promise(e=>{this.apiLeechData(0).then(n=>{e(n.map(i=>new aa(i.id,i.pr,i.type,i.name,0,"cate"===i.type)))})})}isExpandable(e){return this.dataMap.has(e)}apiLeechData(e){return new Promise(n=>{const i=[];this.documentService.apiDocumentsGet(e,void 0,void 0,void 0,void 0,1,1,-1).subscribe(a=>{1===a.success&&a.data&&((a.data.categoryObjs||[]).forEach(c=>{var _,d;i.push({pr:e,id:null!==(_=c.id)&&void 0!==_?_:0,name:null!==(d=c.name)&&void 0!==d?d:"",type:"cate"})}),(a.data.documentObjs||[]).forEach(c=>{var _,d;c.exam&&i.push({pr:e,id:null!==(_=c.exam.id)&&void 0!==_?_:0,name:null!==(d=c.exam.name)&&void 0!==d?d:"",type:"test"})})),n(i)})})}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(Ot.Zg))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();class Gx{constructor(s,e){this._treeControl=s,this._database=e,this.dataChange=new Hx.X([])}get data(){return this.dataChange.value}set data(s){this._treeControl.dataNodes=s,this.dataChange.next(s)}connect(s){return this._treeControl.expansionModel.changed.subscribe(e=>{(e.added||e.removed)&&this.handleTreeControl(e)}),(0,zx.T)(s.viewChange,this.dataChange).pipe((0,qi.U)(()=>this.data))}disconnect(s){}handleTreeControl(s){s.added&&s.added.forEach(e=>this.toggleNode(e,!0)),s.removed&&s.removed.slice().reverse().forEach(e=>this.toggleNode(e,!1))}toggleNode(s,e){if("cate"===s.type){const n=this.data.indexOf(s);if(e)s.isLoading=!0,this._database.apiLeechData(s.id).then(i=>{const a=i.map(r=>new aa(r.id,r.pr,r.type,r.name,s.level+1,"cate"===r.type,!1,s));this.data.splice(n+1,0,...a),this.dataChange.next(this.data),s.isLoading=!1});else{let i=0;for(let a=n+1;a<this.data.length&&this.data[a].level>s.level;a++,i++);this.data.splice(n+1,i),this.dataChange.next(this.data)}}}}let $x=(()=>{class o{static generate(e){const n=o._DEFAULT;if(void 0!==e)for(const i in n)Object.hasOwnProperty.call(n,i)&&Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}}return o._DEFAULT={is_select_cell:!0,is_select_row:!0},o})();class Wx{constructor(s,e,n,i,a,r,l){this.commonService=s,this.noteAction=e,this.questionService=n,this.callbackOnChange=l,this.name="table_matrix",this.class_active="select",this.first_matrix=null,this.last_matrix=null,this.max_row=0,this.max_col=0,this.menuElement=null,this.list=[],this.menuMode=[],this.lstNode=[],this.isErrSum=!1,this.table__main=i,this.table__element=a,this.option=r,this.flag=!1,this.flag_right=!1,this.flag_shift=!1,this.flag_un_merge=!1,this.flag_merge=!1,this.list=[],this.startAddEvent(),this.setupMenuMode(),window.addEventListener("mouseup",()=>{this.endCheck()})}pushNode(s){return new Promise(e=>{const n=this.pushTrElement(s);n&&this.reqCheck(n).then(()=>{e()})})}getResult(){return this.lstNode.length>0?this.lstNode.map(s=>(s.content=s.content.map(e=>Object.assign(Object.assign({},e),{value:this.getResultOfString(e.value)})),s)):[]}resetAndPushList(s){return new Promise(e=>{this.lstNode=s,this.reBuild();const n=new qt.Q(2);this.lstNode.forEach(i=>{n.addTask(this,this.reqCheck,[i])}),n.start().then(i=>{e()})})}reqCheck(s){return new Promise(e=>{var n;let i,a;"test"===s.obj.type&&(a=s.obj.id.toString()),"cate"===s.obj.type&&(i=s.obj.id.toString());let r=null!==(n=this.commonService.myTranslateIntance("lang_auto_don_vi"))&&void 0!==n?n:"",l=this.commonService.myTranslateIntance("lang_auto_khong_tim_thay_cau_hoi_duoc_gan_nhan");this.questionService.apiQuestionsSummarizeTagsTypesGet(i,a).subscribe(c=>{var _;s.disLoading=!0,1===c.success&&c.data?0===c.data.reduce((m,p)=>{var w;return m+(null!==(w=p.total)&&void 0!==w?w:0)},0)?(-1==s.obj.id&&(s.obj.item=null!==(_=this.commonService.myTranslateIntance(s.obj.item))&&void 0!==_?_:""),this.noteAction(r+': "'+s.obj.item+'":'+l,!0),s.content.forEach(m=>{m.disabled=!0})):s.content.forEach(m=>{var p,w,C,A,M,D,q;const U=null===(p=c.data)||void 0===p?void 0:p.map(W=>{var P;return{answerType:W.answerType,tag:null===(P=W.tags)||void 0===P?void 0:P.find(R=>R.code==m.indexName.split("_")[0])}}),F=null==U?void 0:U.find(W=>3===W.answerType),tt=null==U?void 0:U.find(W=>1===W.answerType||4===W.answerType);m.totalTL=null!==(A=null!==(C=null===(w=null==F?void 0:F.tag)||void 0===w?void 0:w.total)&&void 0!==C?C:0)&&void 0!==A?A:0,m.totalTN=null!==(q=null!==(D=null===(M=null==tt?void 0:tt.tag)||void 0===M?void 0:M.total)&&void 0!==D?D:0)&&void 0!==q?q:0}):(this.noteAction(r+': "'+s.obj.item+'":'+l,!0),s.content.forEach(d=>{d.disabled=!0})),this.reBuild(),e()})})}getResultOfString(s){s=s.replace("&nbsp;","").trim().toUpperCase();let e=!1;const n=this.selectNumberOfString(s);return n?(["TN","TL"].forEach(i=>{-1!==s.indexOf(i)&&(e=!0,s=n.toString()+i)}),e?s:n.toString()):""}pushChangeEvent(){this.callbackOnChange&&this.callbackOnChange(this.lstNode)}startAddEvent(){this.getMatrixTable();const s=c=>{this.startCheck(c)},e=c=>(c.preventDefault(),this.startRightCheck(c),!1),n=c=>{this.flag&&(c.preventDefault(),this.moveCheck(c.target))},i=c=>{this.validateInput(c)},a=c=>{this.checkHotKey(c)},r=c=>{this.checkHotKeyEnd(c)};for(let c=0;c<this.max_row;c++)for(let _=0;_<this.max_col;_++){const d=this.getElWithMatrix(_,c);d&&d.classList.contains("edit-item-tb")&&(d.setAttribute("row_index",c.toString()),d.setAttribute("col_index",_.toString()),d.addEventListener("mousedown",s),d.addEventListener("contextmenu",e,!1),d.addEventListener("mouseover",n),d.addEventListener("input",i),d.addEventListener("keydown",a),d.addEventListener("keyup",r))}const l=document.getElementsByClassName("tb-matrix-editor-trash-node");for(let c=0;c<l.length;c++){const _=l[c];_.addEventListener("click",()=>{const d=this.getNodeWithElement(_);if(d){if(d.isMergeCate){const m=this.getRootMerge(d,"Cate");m&&m.numMergeCate--}else if(d.numMergeCate>1){const m=this.lstNode[this.lstNode.indexOf(d)+1];m&&(m.isMergeCate=!1,m.numMergeCate=d.numMergeCate-1)}d.content.forEach(m=>{if(m.isMerge){const p=this.findContentRootOfMerge(m,d.index);p&&p.mergeId.splice(p.mergeId.indexOf(d.index),1)}else if(m.mergeId.length>0){const p=this.findContentNextMerge(m);p&&(m.mergeId.splice(0,1),p.isMerge=!1,p.mergeId=m.mergeId)}}),this.lstNode.splice(this.lstNode.indexOf(d),1)}this.reBuild()})}}findContentRootOfMerge(s,e){let n;return this.lstNode.forEach(i=>{i.content.forEach(a=>{a.index==s.index&&a.mergeId.includes(e)&&(n=a)})}),n}findContentNextMerge(s){const e=this.lstNode.find(n=>n.index==s.mergeId[0]);if(e&&e.content[s.index])return e.content[s.index]}checkHotKeyEnd(s){return 16===s.keyCode&&(s.preventDefault(),this.list.length>1&&this.openMenu("select")),!1}checkHotKey(s){const e=(a,r)=>{if(this.flag_shift&&r){const l=this.getElWithMatrix(a.cell,a.row);l&&(0===this.list.length&&this.checkList(s.target),this.checkList(l))}else this.removeAllList(),this.focusMatrix(a);return!1},n=0===this.list.length?s.target:this.list[this.list.length-1],i=this.getMatrixEl(n);return 40===s.keyCode?(s.preventDefault(),e(Object.assign(Object.assign({},i),{row:i.row+1}),this.option.is_select_row)):38===s.keyCode?(s.preventDefault(),e(Object.assign(Object.assign({},i),{row:i.row-n.rowSpan}),this.option.is_select_row)):37===s.keyCode?(s.preventDefault(),e({row:i.row-n.rowSpan+1,cell:i.cell-1},this.option.is_select_cell)):39===s.keyCode?(s.preventDefault(),e({row:i.row-n.rowSpan+1,cell:i.cell+1},this.option.is_select_cell)):13===s.keyCode?(s.preventDefault(),this.flag_un_merge?(this.startUnMergeAction(),!1):this.flag_merge?(this.startMergeAction(),!1):this.flag_shift?(this.startRightCheck(s),!1):e(Object.assign(Object.assign({},i),{row:i.row+1}),this.option.is_select_row)):(16===s.keyCode&&(s.preventDefault(),this.flag_shift=!0),!1)}focusMatrix(s){const e=this.getElWithMatrix(s.cell,s.row);e&&e.focus()}startRightCheck(s){const e=s.target;e.rowSpan>1&&(this.flag_right=!0,this.flag=!1,this.list=[e],this.openMenu("right"),this.flag_un_merge=!0)}startCheck(s){this.removeAllList(),this.flag=!0,this.checkList(s.target)}moveCheck(s){this.toggleCursor(!0),this.checkList(s)}endCheck(){this.flag_right||(this.toggleCursor(!1),this.flag=!1,this.stepMenu()||this.removeAllList())}checkList(s){0===this.list.length?this.first_matrix=this.getMatrixEl(s):this.last_matrix=this.getMatrixEl(s),this.getList(),this.loopList(),this.flag_merge=!0}removeAllList(){this.closeMenu(),this.removeSelectList(),this.first_matrix=null,this.last_matrix=null,this.flag=!1,this.flag_right=!1,this.flag_shift=!1,this.flag_un_merge=!1,this.flag_merge=!1}getMatrixEl(s){return{cell:Number(s.getAttribute("col_index")),row:Number(s.getAttribute("row_index"))}}getMatrixTable(){this.table__element.innerHTML=this.table__element.innerHTML,this.max_row=this.table__element.rows.length,this.max_col=16}getList(){if(this.removeSelectList(),this.first_matrix&&this.last_matrix){let s=0,e=0,n=0,i=0;this.first_matrix.cell<this.last_matrix.cell?(s=this.first_matrix.cell,e=this.last_matrix.cell):(s=this.last_matrix.cell,e=this.first_matrix.cell),this.first_matrix.row<this.last_matrix.row?(n=this.first_matrix.row,i=this.last_matrix.row):(n=this.last_matrix.row,i=this.first_matrix.row);for(let a=s;a<=e;a++)for(let r=n;r<=i;r++){let l=!1;this.option.is_select_cell&&this.option.is_select_row?l=!0:this.option.is_select_row?s===e&&(l=!0):n===i&&(l=!0),l?this.pushList(this.getElWithMatrix(a,r)):this.endCheck()}}else this.first_matrix&&this.pushList(this.getElWithMatrix(this.first_matrix.cell,this.first_matrix.row))}loopList(){this.list.forEach(s=>{s.classList.add(this.class_active)})}getElWithMatrix(s,e){var i,a,r,l,c,_,d,n=[];for(d=0;d<this.table__element.rows.length;d++)for(i=this.table__element.rows[d],_=0;_<i.cells.length;_++){for(a=i.cells[_],r=_;n[d]&&n[d][r];++r);for(l=r;l<r+a.colSpan;++l)for(c=d;c<d+a.rowSpan;++c)n[c]||(n[c]=[]),n[c][l]=!0;if(r<=s&&s<r+a.colSpan&&d<=e&&e<d+a.rowSpan)return a}}pushList(s){s&&this.list.push(s)}removeSelectList(){this.list.forEach(s=>{s.classList.remove(this.class_active)}),this.list=[]}toggleCursor(s){document.body.style.cursor=s?"crosshair":"auto"}setupMenuMode(){this.menuMode.push({id:"__merge",mode:"select",action:this.startMergeAction}),this.menuMode.push({id:"__un_merge",mode:"right",action:this.startUnMergeAction})}generateMenu(s){this.menuElement||(this.menuElement=document.getElementById("menu__excel_editor"),this.menuMode.forEach(e=>{var n;const i=document.getElementById((null===(n=this.menuElement)||void 0===n?void 0:n.id)+e.id);i&&i.addEventListener("click",a=>{e.action.call(this)})})),this.menuMode.forEach(e=>{var n;const i=document.getElementById((null===(n=this.menuElement)||void 0===n?void 0:n.id)+e.id);i&&(i.style.display=e.mode===s?"flex":"none")})}stepMenu(){return this.list.length>1&&(this.openMenu("select"),!0)}openMenu(s){if(this.list.length>0){this.generateMenu(s);const e=this.getPosWithParent(this.list[this.list.length-1]);this.menuElement&&(this.menuElement.style.top=e.top+Math.floor(e.height/2)+"px",this.menuElement.style.left=e.left+Math.floor(e.width/2)+"px",this.menuElement.style.display="block")}}closeMenu(){this.menuElement&&(this.menuElement.style.display="none")}getPosWithParent(s){const e=this.table__main.getBoundingClientRect(),n=s.getBoundingClientRect();return{top:n.top-e.top,left:n.left-e.left,width:n.width,height:n.height}}startMergeAction(){let s;var e;for(let n=0;n<this.list.length;n++){const i=this.list[n];if(i){const a=this.getNodeWithElement(i);if(a){const r=this.getContentOfNodeWithElement(i,a);r&&(0===n?(s=this.getMatrixEl(i),e=r):i.parentElement&&e&&(e.mergeId.push(a.index),r.isMerge=!0,r.value=""))}}}this.reBuild(),s&&this.focusMatrix(s)}startUnMergeAction(){const s=this.list[0],e=this.getMatrixEl(s),n=this.getNodeWithElement(s);if(n){const i=this.getContentOfNodeWithElement(s,n);i&&(i.mergeId.forEach(a=>{const r=this.lstNode.find(l=>l.index==a);if(r){const l=r.content[i.index];l&&(l.isMerge=!1)}}),i.mergeId=[])}this.reBuild(),this.focusMatrix(e)}getCellOfCNode(s,e){for(let n=0;n<this.table__element.rows.length;n++){const i=this.table__element.rows[n];if(i.getAttribute("data-index")===s.index)for(let a=0;a<i.cells.length;a++){const r=i.cells[a];if(r.getAttribute("data-index")===e.index.toString())return r}}}getNodeWithElement(s){if(s.parentElement&&"TR"==s.parentElement.tagName.toUpperCase()){const e=s.parentElement.getAttribute("data-index");if(e){const n=e;return this.lstNode.find(i=>i.index===n)}}}getContentOfNodeWithElement(s,e){const n=s.getAttribute("data-index");if(n&&(null==n?void 0:n.length)>0)return e.content[parseInt(n)]}selectNumberWithElement(s){return this.selectNumberOfString(s.innerText)}selectNumberOfString(s){var e=s.replace(/([0-9]+)T/g,"$1");if(!isNaN(Number(e)))return Number(e);var n=s.replace(/([0-9]+)TL/g,"$1");if(!isNaN(Number(n)))return Number(n);var i=s.replace(/([0-9]+)TN/g,"$1");if(!isNaN(Number(i)))return Number(i);var a=s.replace(/([0-9]+)%/g,"$1");return isNaN(Number(a))?void 0:Number(a)}validateInput(s){var e,n,i;const a=s.target;if(0==a.innerText.length)return void this.pushValueWithElement(a);if(a.innerText=a.innerText.replace(/(\r\n|\n|\r)/gm,"").trim().toUpperCase(),-1!==(null!==(e=a.getAttribute("data-name"))&&void 0!==e?e:"").indexOf("_SOCH")&&null==this.selectNumberWithElement(a)&&(a.innerHTML="&nbsp;",this.snackErrElement(a)),-1!==(null!==(n=a.getAttribute("data-name"))&&void 0!==n?n:"").indexOf("_TGP")&&isNaN(Number(a.innerText))&&(a.innerHTML="&nbsp;",this.snackErrElement(a)),0==(null!==(i=a.getAttribute("data-name"))&&void 0!==i?i:"").indexOf("DIEM")){let c=a.innerText.replace("%","");isNaN(Number(c))?(a.innerHTML="&nbsp;",this.snackErrElement(a)):a.innerText=c}""==a.innerText&&(a.innerHTML="&nbsp;");const r=window.getSelection(),l=document.createRange();r.removeAllRanges(),l.selectNodeContents(a),l.collapse(!1),r.addRange(l),a.focus(),this.pushValueWithElement(a)}pushValueWithElement(s){const e=this.getNodeWithElement(s);if(e){const n=this.getContentOfNodeWithElement(s,e);n&&(n.value=s.innerText+("DIEM"===n.indexName?"%":""),this.isNodeWarning(n)?s.classList.add(...this.getWarMsg(n).split(" ")):s.classList.remove("warning-item","wn-empty","wn-over-tn","wn-over-tl"))}this.sumAll()}sumAll(){let s=" ".repeat(12).split("").map(()=>0);this.lstNode.forEach(a=>{a.content.forEach(r=>{var l;if(["SOCH_TN","SOCH_TL","TGP"].includes(r.indexName)){r.value=this.sumParamOfColName(a.content,r.indexName).toString();const c=this.getCellOfCNode(a,r);c&&(c.innerText=r.value)}void 0!==s[r.index]&&!r.isMerge&&(s[r.index]+=null!==(l=this.selectNumberOfString(r.value))&&void 0!==l?l:0)})});var e="";s.forEach((a,r)=>{r===s.length-1?(this.isErrSum=Number(a)>100,e+=`<td class="text-center">${a>0?a.toString()+"%":""}</td>`):e+=`<td class="text-center">${a>0?a.toString():""}</td>`});const i=`<tr class="dis-item-tb"><td colspan="4" class="text-center">${this.commonService.myTranslateIntance("lang_auto_tong")}</td>${e}</tr>`;this.table__element.tFoot&&(this.table__element.tFoot.innerHTML=i)}sumParamOfColName(s,e){const n={SOCH_TN:0,SOCH_TL:0,TGP:0};return s.forEach(i=>{var a,r,l;i.indexName.indexOf("SOCH")>0&&(-1!==i.value.toUpperCase().indexOf("TL")?n.SOCH_TL+=null!==(a=this.selectNumberOfString(i.value))&&void 0!==a?a:0:n.SOCH_TN+=null!==(r=this.selectNumberOfString(i.value))&&void 0!==r?r:0),i.indexName.indexOf("TGP")>0&&(n.TGP+=null!==(l=this.selectNumberOfString(i.value))&&void 0!==l?l:0)}),n[e]}indexToColName(s){var e;return null!==(e=["NB_SOCH","NB_TGP","TH_SOCH","TH_TGP","VD_SOCH","VD_TGP","VDC_SOCH","VDC_TGP","SOCH_TN","SOCH_TL","TGP","DIEM"][s])&&void 0!==e?e:""}snackErrElement(s){var e;let n=null!==(e=this.commonService.myTranslateIntance("lang_auto_du_lieu_nhap_vao_khong_hop_le"))&&void 0!==e?e:"";this.noteAction(n,!0),s.classList.add("border-err"),setTimeout(()=>{s.classList.remove("border-err")},1200)}hiddenNoteEmpty(){if(0===this.lstNode.length){let s=this.commonService.myTranslateIntance("lang_auto_matrix_content_text");this.table__element.tBodies[0].innerHTML=`<tr class="text-center"><td colspan="16">${s}</td></tr>`}}getRootMerge(s,e){for(let n=this.lstNode.length-1;n>=0;n--)if(!this.lstNode[n]["isMerge"+e])return this.lstNode[n];return s}pushTrElement(s){var e,n,i=!1;if(this.lstNode.length>0){const r=this.lstNode[this.lstNode.length-1];if(r.obj.id===s.id)return;const l=this.getRootMerge(r,"Cate");(i=(null===(e=r.obj.prNode)||void 0===e?void 0:e.id)===(null===(n=s.prNode)||void 0===n?void 0:n.id))&&l.numMergeCate++}const a={numMergeCate:1,isMergeCate:i,index:this.generateIdRequired(10),obj:s,content:" ".repeat(12).split("").map((r,l)=>({totalTL:0,totalTN:0,indexName:this.indexToColName(l),index:l,id:s.id,value:"&nbsp;",mergeId:[]}))};return this.lstNode.push(a),this.reBuild(),a}reBuild(){this.removeAllList();var s="";this.lstNode.forEach((e,n)=>{var i,a="";a+=`<td class="dis-item-tb text-center">${n+1}</td>`,!e.isMergeCate&&e.obj.prNode&&(a+=`<td rowSpan="${e.numMergeCate}" class="dis-item-tb text-center">${null!==(i=e.obj.prNode.item)&&void 0!==i?i:""}</td>`),a+=`<td class="dis-item-tb text-center" colSpan="${e.obj.prNode?1:2}">${e.obj.item}</td>`,a+='<td class="dis-item-tb text-center tb-matrix-editor-trash-node"><i class="fa fa-trash"></i></td>',e.content.forEach(r=>{var l,c,_,d,m,p;if(["SOCH_TN","SOCH_TL","TGP"].includes(r.indexName))a+=`<td data-index="${r.index}" class="dis-item-tb text-center">${r.value}</td>`;else if(!r.isMerge)if(e.disLoading){let w=null!==(l=this.commonService.myTranslateIntance("lang_auto_hien_co_trac_nghiem"))&&void 0!==l?l:"",C=null!==(c=this.commonService.myTranslateIntance("lang_auto_tu_luan"))&&void 0!==c?c:"",A=null!==(_=this.commonService.myTranslateIntance("lang_auto_khong_co_cau_hoi_nao"))&&void 0!==_?_:"",M=null!==(d=this.commonService.myTranslateIntance("lang_auto_khong_du_cau_hoi"))&&void 0!==d?d:"";a+=`<td col-name="${this.getNameCol(r.indexName)}" num-tl="${null!==(m=r.totalTL)&&void 0!==m?m:0}" num-tn="${null!==(p=r.totalTN)&&void 0!==p?p:0}" data-name="${r.indexName}" first-trans="${w}" last-trans="${C}"  over-question-trans="${M}" empty-question-trans="${A}" data-index="${r.index}" class="${this.isNoteEditTable(r)?"note-edit-item-tb":""} ${this.getWarMsg(r)} edit-item-tb text-center" contenteditable="true" ${r.mergeId.length>0?'rowSpan="'+(r.mergeId.length+1)+'"':""}>${r.value}</td>`}else a+=`<td data-name="${r.indexName}" data-index="${r.index}" class="text-center" ${r.mergeId.length>0?'rowSpan="'+(r.mergeId.length+1)+'"':""}><i class="fa fa-spinner fa-spin"></i></td>`}),s+=`<tr data-index="${e.index}">${a}</tr>`}),this.table__element.tBodies[0].innerHTML=s,this.sumAll(),this.startAddEvent(),this.hiddenNoteEmpty(),this.pushChangeEvent()}isNodeWarning(s){var e;let n=!s.value.includes("TL");const i=null!==(e=this.selectNumberOfString(s.value))&&void 0!==e?e:0;return this.isNoteEditTable(s)&&(0===s.totalTL&&0===s.totalTN||n&&i>s.totalTN||!n&&i>s.totalTL||!s.totalTL&&!s.totalTN)}getWarMsg(s){var e;let n=!s.value.includes("TL");const i=null!==(e=this.selectNumberOfString(s.value))&&void 0!==e?e:0;if(this.isNoteEditTable(s)){if(0===s.totalTL&&0===s.totalTN||!s.totalTL&&!s.totalTN)return"warning-item wn-empty";if(n&&i>s.totalTN)return"warning-item wn-over-tn";if(!n&&i>s.totalTL)return"warning-item wn-over-tl"}return""}isNoteEditTable(s){return s.indexName.includes("SOCH")&&s.indexName.indexOf("SOCH")>0}getNameCol(s){var e,n,i,a;let r=null!==(e=this.commonService.myTranslateIntance("lang_auto_nhan_biet"))&&void 0!==e?e:"",l=null!==(n=this.commonService.myTranslateIntance("lang_auto_thong_hieu"))&&void 0!==n?n:"",c=null!==(i=this.commonService.myTranslateIntance("lang_auto_van_dung"))&&void 0!==i?i:"",_=null!==(a=this.commonService.myTranslateIntance("lang_auto_van_dung_cao"))&&void 0!==a?a:"";return 0===s.indexOf("NB")?r:0===s.indexOf("TH")?l:0===s.indexOf("VDC")?c:0===s.indexOf("VD")?_:""}generateIdRequired(s){let e="";const n="abcdefghijklmnopqrstuvwxyz0123456789",i=n.length;for(let a=0;a<s;a++)e+=n.charAt(Math.floor(Math.random()*i));return Math.floor(Date.now()/1e3)+e}}var sa=b(85899),Vn=b(90149);const Kx=["tableMain"],Vx=["popupConfirm"];function Xx(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function tv(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",59),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.switchContentAction(a))}),t._uU(2),t.qZA()()}if(2&o){const e=s.$implicit;t.xp6(2),t.Oqu(e.name)}}function nv(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",64),t._UZ(2,"path",65),t.qZA()())}function iv(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",66),t._UZ(2,"path",67)(3,"polyline",68)(4,"path",69),t.qZA()())}const ra=function(o,s){return{"tb-active":o,"d-none":s}};function ov(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"mat-tree-node",60),t._UZ(1,"button",61),t.YNc(2,nv,3,0,"span",62),t.YNc(3,iv,5,0,"span",62),t.TgZ(4,"string",63),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(null==r.tableEditor?null:r.tableEditor.pushNode(a))}),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()}if(2&o){const e=s.$implicit,n=t.oxw(2);t.Q6J("ngClass",t.WLB(6,ra,n.exitsTables.includes(e.id),!e.item.includes(n.filterContent))),t.xp6(2),t.Q6J("ngIf","cate"===e.type),t.xp6(1),t.Q6J("ngIf","cate"!==e.type),t.xp6(2),t.Oqu(t.lcZ(6,4,e.item))}}function av(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",64),t._UZ(2,"path",65),t.qZA()())}function sv(o,s){1&o&&(t.TgZ(0,"span"),t.O4$(),t.TgZ(1,"svg",66),t._UZ(2,"path",67)(3,"polyline",68)(4,"path",69),t.qZA()())}function rv(o,s){1&o&&t._UZ(0,"mat-progress-bar",73)}function lv(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"mat-tree-node",60)(1,"button",70)(2,"mat-icon",71),t._uU(3),t.qZA()(),t.YNc(4,av,3,0,"span",62),t.YNc(5,sv,5,0,"span",62),t.TgZ(6,"string",63),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(null==r.tableEditor?null:r.tableEditor.pushNode(a))}),t._uU(7),t.ALo(8,"mytranslate"),t.qZA(),t.YNc(9,rv,1,0,"mat-progress-bar",72),t.qZA()}if(2&o){const e=s.$implicit,n=t.oxw(2);t.Q6J("ngClass",t.WLB(9,ra,n.exitsTables.includes(e.id),!e.item.includes(n.filterContent))),t.xp6(1),t.uIk("aria-label","Toggle "+e.item),t.xp6(2),t.hij(" ",n.treeControl.isExpanded(e)?"expand_more":"chevron_right"," "),t.xp6(1),t.Q6J("ngIf","cate"===e.type),t.xp6(1),t.Q6J("ngIf","cate"!==e.type),t.xp6(2),t.Oqu(t.lcZ(8,7,e.item)),t.xp6(2),t.Q6J("ngIf",e.isLoading)}}function cv(o,s){if(1&o&&(t.TgZ(0,"div",74)(1,"div",75)(2,"div",76)(3,"span"),t._UZ(4,"span",77),t._uU(5,"\xa0"),t.qZA()(),t.TgZ(6,"div",78),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(7),t.Oqu(t.lcZ(8,1,e.logConfig.msg))}}const _v=function(o){return{"has-err":o}},dv=function(){return{suppressScrollX:!0}};function uv(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"input",7),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.bankSelect.name=i)}),t.ALo(5,"mytranslate"),t.qZA()()()(),t.TgZ(6,"button",8),t._uU(7),t.ALo(8,"mytranslate"),t.TgZ(9,"mat-icon"),t._uU(10,"expand_more"),t.qZA()(),t.TgZ(11,"mat-menu",null,9)(13,"div",10)(14,"perfect-scrollbar",11)(15,"ul",12)(16,"li")(17,"a",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.createNew())}),t._uU(18),t.ALo(19,"mytranslate"),t.qZA()(),t.TgZ(20,"li"),t._UZ(21,"hr",14),t.qZA(),t.YNc(22,tv,3,1,"li",15),t.qZA()()()()(),t.TgZ(23,"div",16)(24,"div",17)(25,"mat-tree",18),t.YNc(26,ov,7,9,"mat-tree-node",19),t.YNc(27,lv,10,12,"mat-tree-node",20),t.qZA(),t.TgZ(28,"div",21)(29,"input",22),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.filterContent=i)}),t.ALo(30,"mytranslate"),t.qZA()()(),t.TgZ(31,"div",23)(32,"div",24,25)(34,"table",26)(35,"thead",27)(36,"tr",28)(37,"td",29),t._uU(38),t.ALo(39,"mytranslate"),t.qZA(),t.TgZ(40,"td",29),t._uU(41),t.ALo(42,"mytranslate"),t.qZA(),t.TgZ(43,"td",30),t._uU(44),t.ALo(45,"mytranslate"),t.qZA(),t.TgZ(46,"td",31),t._uU(47),t.ALo(48,"mytranslate"),t.qZA(),t.TgZ(49,"td",32),t._uU(50),t.ALo(51,"mytranslate"),t.qZA(),t.TgZ(52,"td",29),t._uU(53,"%"),t._UZ(54,"br"),t._uU(55),t.ALo(56,"mytranslate"),t._UZ(57,"br"),t._uU(58),t.ALo(59,"mytranslate"),t.qZA()(),t.TgZ(60,"tr",28)(61,"td",33),t._uU(62),t.ALo(63,"mytranslate"),t.qZA(),t.TgZ(64,"td",33),t._uU(65),t.ALo(66,"mytranslate"),t.qZA(),t.TgZ(67,"td",33),t._uU(68),t.ALo(69,"mytranslate"),t.qZA(),t.TgZ(70,"td",33),t._uU(71),t.ALo(72,"mytranslate"),t.qZA(),t.TgZ(73,"td",33),t._uU(74),t.ALo(75,"mytranslate"),t.qZA(),t.TgZ(76,"td",34),t._uU(77),t.ALo(78,"mytranslate"),t.qZA()(),t.TgZ(79,"tr",28)(80,"td"),t._uU(81),t.ALo(82,"mytranslate"),t.qZA(),t.TgZ(83,"td"),t._uU(84),t.ALo(85,"mytranslate"),t.qZA(),t.TgZ(86,"td"),t._uU(87),t.ALo(88,"mytranslate"),t.qZA(),t.TgZ(89,"td"),t._uU(90),t.ALo(91,"mytranslate"),t.qZA(),t.TgZ(92,"td"),t._uU(93),t.ALo(94,"mytranslate"),t.qZA(),t.TgZ(95,"td"),t._uU(96),t.ALo(97,"mytranslate"),t.qZA(),t.TgZ(98,"td"),t._uU(99),t.ALo(100,"mytranslate"),t.qZA(),t.TgZ(101,"td"),t._uU(102),t.ALo(103,"mytranslate"),t.qZA(),t.TgZ(104,"td"),t._uU(105),t.ALo(106,"mytranslate"),t.qZA(),t.TgZ(107,"td"),t._uU(108),t.ALo(109,"mytranslate"),t.qZA()()(),t.TgZ(110,"tbody")(111,"tr",35)(112,"td",36),t._uU(113),t.ALo(114,"mytranslate"),t.qZA()()(),t.TgZ(115,"tfoot",27)(116,"tr",37)(117,"td",38),t._uU(118),t.ALo(119,"mytranslate"),t.qZA(),t._UZ(120,"td")(121,"td")(122,"td")(123,"td")(124,"td")(125,"td")(126,"td")(127,"td")(128,"td")(129,"td")(130,"td")(131,"td"),t.qZA()()(),t.TgZ(132,"div",39),t._uU(133),t.ALo(134,"mytranslate"),t._UZ(135,"br"),t._uU(136),t.ALo(137,"mytranslate"),t._UZ(138,"br"),t._uU(139),t.ALo(140,"mytranslate"),t.TgZ(141,"a",40),t._uU(142),t.ALo(143,"mytranslate"),t.qZA(),t._UZ(144,"br"),t.qZA(),t.TgZ(145,"div",41)(146,"li",42),t.O4$(),t.TgZ(147,"svg",43),t._UZ(148,"path",44)(149,"path",45)(150,"path",46)(151,"path",47)(152,"path",48)(153,"path",49),t.qZA(),t.kcU(),t.TgZ(154,"span",50),t._uU(155),t.ALo(156,"mytranslate"),t.qZA()(),t.TgZ(157,"li",51),t.O4$(),t.TgZ(158,"svg",52),t._UZ(159,"path",53)(160,"path",45)(161,"path",54)(162,"path",55)(163,"path",56),t.qZA(),t.kcU(),t.TgZ(164,"span",50),t._uU(165),t.ALo(166,"mytranslate"),t.qZA()()()()()(),t._UZ(167,"editor-confirm",null,57),t.YNc(169,cv,9,3,"div",58)}if(2&o){const e=t.MAs(12),n=t.oxw();t.xp6(4),t.s9C("placeholder",t.lcZ(5,46,"lang_auto_nhap_ten_ma_tran")+"..."),t.Q6J("ngModel",n.bankSelect.name)("ngClass",t.VKq(116,_v,n.checkName&&(!n.bankSelect.name||0===n.bankSelect.name.trim().length))),t.xp6(2),t.Q6J("matMenuTriggerFor",e),t.xp6(1),t.hij(" ",t.lcZ(8,48,"lang_auto_danh_sach_da_tao")," "),t.xp6(7),t.Q6J("config",t.DdM(118,dv))("scrollIndicators",!0),t.xp6(4),t.hij(" + ",t.lcZ(19,50,"lang_auto_tao_moi")," "),t.xp6(4),t.Q6J("ngForOf",n.banks),t.xp6(3),t.Q6J("dataSource",n.dataSource)("treeControl",n.treeControl),t.xp6(2),t.Q6J("matTreeNodeDefWhen",n.hasChild),t.xp6(2),t.s9C("placeholder",t.lcZ(30,52,"lang_auto_loc_theo_ten")),t.Q6J("ngModel",n.filterContent),t.xp6(9),t.hij(" ",t.lcZ(39,54,"lang_auto_STT")," "),t.xp6(3),t.hij(" ",t.lcZ(42,56,"lang_auto_noi_dung_kien_thuc")," "),t.xp6(3),t.hij(" ",t.lcZ(45,58,"lang_auto_don_vi_kien_thuc")," "),t.xp6(3),t.hij(" ",t.lcZ(48,60,"lang_auto_muc_do_nhan_biet")," "),t.xp6(3),t.hij(" ",t.lcZ(51,62,"lang_auto_tong")," "),t.xp6(5),t.hij(" ",t.lcZ(56,64,"lang_auto_tong")," "),t.xp6(3),t.Oqu(t.lcZ(59,66,"lang_auto_diem")),t.xp6(4),t.hij(" ",t.lcZ(63,68,"lang_auto_nhan_biet")," "),t.xp6(3),t.Oqu(t.lcZ(66,70,"lang_auto_thong_hieu")),t.xp6(3),t.Oqu(t.lcZ(69,72,"lang_auto_van_dung")),t.xp6(3),t.Oqu(t.lcZ(72,74,"lang_auto_van_dung_cao")),t.xp6(3),t.Oqu(t.lcZ(75,76,"lang_auto_so_ch")),t.xp6(3),t.Oqu(t.lcZ(78,78,"lang_auto_thoi_gian_phut")),t.xp6(4),t.Oqu(t.lcZ(82,80,"lang_auto_so_ch")),t.xp6(3),t.Oqu(t.lcZ(85,82,"lang_auto_thoi_gian_phut")),t.xp6(3),t.Oqu(t.lcZ(88,84,"lang_auto_so_ch")),t.xp6(3),t.Oqu(t.lcZ(91,86,"lang_auto_thoi_gian_phut")),t.xp6(3),t.Oqu(t.lcZ(94,88,"lang_auto_so_ch")),t.xp6(3),t.Oqu(t.lcZ(97,90,"lang_auto_thoi_gian_phut")),t.xp6(3),t.Oqu(t.lcZ(100,92,"lang_auto_so_ch")),t.xp6(3),t.Oqu(t.lcZ(103,94,"lang_auto_thoi_gian_phut")),t.xp6(3),t.Oqu(t.lcZ(106,96,"lang_auto_TN")),t.xp6(3),t.Oqu(t.lcZ(109,98,"lang_auto_TL")),t.xp6(5),t.hij(" ",t.lcZ(114,100,"lang_auto_chon_cac_noi_dung_kien_thuc_o_cay_thu_muc_ben_cac_de_them_vao_ma_tran")," "),t.xp6(5),t.hij(" ",t.lcZ(119,102,"lang_auto_tong")," "),t.xp6(15),t.hij(" * ",t.lcZ(134,104,"lang_auto_nhap_tl_vao_sau_so_luong_cau_can_lay_de_chi_lay_cau_tu_luan"),""),t.xp6(3),t.hij(" * ",t.lcZ(137,106,"lang_auto_viet_tat_ch_cau_hoi_tl_tu_luan_dot"),""),t.xp6(3),t.hij(" * ",t.lcZ(140,108,"lang_auto_ban_can_gan_nhan_muc_do_nhan_biet_cho_cac_cau_hoi_trong_dot")," "),t.xp6(3),t.hij(" ",t.lcZ(143,110,"lang_auto_tim_hieu_them")," "),t.xp6(13),t.Oqu(t.lcZ(156,112,"lang_auto_gop_cac_o_da_chon")),t.xp6(10),t.hij(" ",t.lcZ(166,114,"lang_auto_huy_gop_o_da_chon")," "),t.xp6(4),t.Q6J("ngIf",n.logConfig.status)}}let mv=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l){super(a),this.editorOutputDataService=n,this.activeRoute=i,this.commonService=a,this.examBankService=r,this.questionService=l,this.backToLink="",this.checkName=!1,this.cur_cateId=0,this.exitsTables=[],this.banks=[],this.logConfig={},this.bankSelect={},this.filterContent="",this.doneInitView=!1,this.doneGetRequest=!1,this.getLevel=c=>c.level,this.isExpandable=c=>c.expandable,this.hasChild=(c,_)=>_.expandable,this.treeControl=new Jx.C2(this.getLevel,this.isExpandable),this.dataSource=new Gx(this.treeControl,e)}switchContentAction(e){var n,i;let a=null!==(n=this.commonService.myTranslateIntance("lang_auto_xac_nhap_thay_the_noi_dung_ma_tran_da_chon"))&&void 0!==n?n:"";null===(i=this.popupConfirm)||void 0===i||i.startConfirm(a).then(r=>{var l;if(r){let c=this.commonService.myTranslateIntance("lang_loading_data");this.logConfig.status=!0,this.logConfig.msg=c,this.examBankService.apiExamBanksIdGet(null!==(l=e.id)&&void 0!==l?l:0).subscribe(_=>{var d,m,p;if(_.success&&_.data){const w=this.commonService.castJsonToObj(null!==(d=_.data.content)&&void 0!==d?d:"");w&&(this.bankSelect=_.data,null===(m=this.tableEditor)||void 0===m||m.resetAndPushList(w).then(()=>{this.logConfig.status=!1,this.logConfig.msg=void 0}))}else this.errorStatusObj(null!==(p=_.message)&&void 0!==p?p:"",!0),this.logConfig.status=!1,this.logConfig.msg=void 0})}})}cancelAction(){var e;null===(e=this.popupConfirm)||void 0===e||e.startConfirm("lang_auto_confirm_destroy_content").then(n=>{n&&location.reload()})}actionRedirect(e){this.logConfig.status=!1,this.logConfig.msg=void 0,this.editorOutputDataService.setMatrixData({matrix:e,response:this.bankSelect}),window.location=this.commonService.getLocalRouter("/admin/testbank/azota-editor/"+(null!=this.cur_cateId?this.cur_cateId:0))}saveAction(){var e,n;const i=null===(e=this.tableEditor)||void 0===e?void 0:e.getResult();if(this.bankSelect.name=this.commonService.removeXssInHtml(this.bankSelect.name),null!==(n=this.tableEditor)&&void 0!==n&&n.isErrSum)this.showErrorSnack("lang_auto_vui_long_nhap_tong_%_diem_khong_qua_100%");else if(i&&i.length>0&&this.bankSelect.name&&this.bankSelect.name.length>0){let a=this.commonService.myTranslateIntance("lang_auto_dang_chuan_bi_cau_hoi_cho_ma_tran_vua_tao");this.logConfig.status=!0,this.logConfig.msg=a,this.bankSelect.id&&this.bankSelect.id>0?this.examBankService.apiExamBanksIdPut(this.bankSelect.id,{name:this.bankSelect.name,content:JSON.stringify(i),type:"matrix"}).subscribe(r=>{r&&1==r.success?this.actionRedirect(i):this.showErrorSnack("lang_auto_khong_the_thay_doi_ma_tran_de_thi")}):this.examBankService.apiExamBanksPost({name:this.bankSelect.name,content:JSON.stringify(i),type:"matrix"}).subscribe(r=>{r&&1==r.success?this.actionRedirect(i):this.showErrorSnack("lang_auto_khong_the_luu_ma_tran_de_thi")})}else i&&0!==i.length?(this.checkName=!0,this.showErrorSnack("lang_auto_vui_long_nhap_ten_ma_tran_de_thi")):this.showErrorSnack("lang_auto_khong_tim_thay_du_lieu_ma_tran")}initTableEditor(){if(this.tableMain){const e=this.tableMain.nativeElement;this.tableEditor=new Wx(this.commonService,(a,r)=>{r||this.showSuccessSnack(a)},this.questionService,e,e.firstElementChild,$x.generate({is_select_cell:!1}),a=>{this.exitsTables=[],a.forEach(r=>{this.exitsTables.push(r.obj.id)})});const i=this.editorOutputDataService.getMatrixData();i&&i.matrix.length>0&&(this.bankSelect=i.response,this.tableEditor.resetAndPushList(i.matrix)),this.doneInitView=!0,this.checkDataBeforeInitDone()}}checkDataBeforeInitDone(){this.doneInitView&&this.doneGetRequest&&this.banks.length>0&&this.bankSelect.name===this.banks[0].name&&(this.bankSelect=this.banks[0])}createNew(){var e,n;let i=null!==(e=this.commonService.myTranslateIntance("lang_auto_xac_nhan_tao_moi_ma_tran_de_thi"))&&void 0!==e?e:"";null===(n=this.popupConfirm)||void 0===n||n.startConfirm(i).then(a=>{var r;a&&(this.bankSelect={},null===(r=this.tableEditor)||void 0===r||r.resetAndPushList([]))})}initData(){let e=this.commonService.myTranslateIntance("lang_loading_data");this.logConfig.status=!0,this.logConfig.msg=e,this.dataSource._database.initialData().then(n=>{this.dataSource.data=n,this.examBankService.apiExamBanksGet("matrix").subscribe(i=>{var a,r;i.success&&i.data?(this.banks=null!==(a=i.data.banks)&&void 0!==a?a:[],this.logConfig.status=!1,this.logConfig.msg=void 0,this.doneGetRequest=!0,this.checkDataBeforeInitDone()):this.errorStatusObj(null!==(r=i.message)&&void 0!==r?r:"",!0)})})}ngAfterViewInit(){this.initTableEditor()}ngOnInit(){super.ngOnInit(),(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var e;this.cur_cateId=null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")))&&void 0!==e?e:0,this.backToLink="/admin/testbank/create-new-document/"+this.cur_cateId}),this.initData()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Yx),t.Y36(bn),t.Y36(x.gz),t.Y36(vt.v),t.Y36(Ot.SP),t.Y36(Ot.aE))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-mix-bank-template"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Kx,5,t.SBq),t.Gf(Vx,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.tableMain=i.first),t.iGM(i=t.CRH())&&(n.popupConfirm=i.first)}},features:[t.qOj],decls:4,vars:4,consts:[[3,"headerBackTolink","showConfirmButton","handleCancel","handleConfirm"],[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"header-mix-bank"],[1,"bank-name-block"],[1,"name-block"],[1,"input"],["type","text",1,"form-control",3,"placeholder","ngModel","ngClass","ngModelChange"],[1,"btn","btn-outline-secondary","btn-sm",3,"matMenuTriggerFor"],["historyMatrix","matMenu"],[1,"dropdown-menu","show","relative","w-56",2,"height","60vh"],[3,"config","scrollIndicators"],[1,"dropdown-content","mt-0"],[1,"dropdown-item","uppercase",3,"click"],[1,"dropdown-divider","border-slate-200","dark:border-darkmode-400"],[4,"ngFor","ngForOf"],[1,"main-mix-blank","bg-white","dark:bg-darkmode-400"],[1,"col-tree"],[3,"dataSource","treeControl"],["matTreeNodePadding","",3,"ngClass",4,"matTreeNodeDef"],["matTreeNodePadding","",3,"ngClass",4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"filler-node","bg-white","dark:bg-darkmode-400"],["type","text",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[1,"col-table"],["id","table_main",1,"table-main"],["tableMain",""],["id","table__element"],[2,"color","#2a3545"],[1,"header-tb"],["rowspan","3"],["rowspan","3","colspan","2"],["colspan","8"],["colspan","3"],["colspan","2"],["rowspan","2"],["id","tr__empty-length",1,"text-center","text-slate-500","dark:text-slate-200"],["colspan","16"],[1,"dis-item-tb"],["colspan","4",1,"text-center"],[1,"ins-info"],["href","https://docs.azota.vn/docs/huong-dan-su-dung/de-thi/tao-de-tu-ma-tran-de","target","_blank",1,"text-primary"],["id","menu__excel_editor",1,"menu-excel"],["id","menu__excel_editor__merge",2,"display","none"],["width","25px","viewBox","0, 0, 2048, 2048","focusable","false"],["type","path","d","M 1536 973 l -256 256 l -72 -73 l 132 -132 h -734 l 132 132 l -72 73 l -256 -256 l 256 -256 l 72 72 l -132 133 h 734 l -132 -133 l 72 -72 m 563 -615 v 1741 h -1741 v -1741 m 103 308 h 717 v -205 h -717 m 717 1536 v -205 h -717 v 205 m 1536 -205 h -717 v 205 h 717 m 0 -1229 h -1536 v 922 h 1536 m 0 -1229 h -717 v 205 h 717 z",2,"fill","rgba(250, 250, 250, 1)"],["type","path","d","M 154 1792 v -1638 h 1638 v 1638 z",2,"fill","rgba(250, 250, 250, 1)"],["type","path","d","M 1024 410 h -102 v -205 h 102 m 0 1536 h -102 v -205 h 102 z",2,"fill","rgba(121, 119, 116, 1)"],["type","path","d","M 1843 102 v 1741 h -1741 v -1741 m 103 1639 h 1536 v -1536 h -1536 z",2,"fill","rgba(58, 58, 56, 1)"],["type","path","d","M 1843 410 v 1126 h -1741 v -1126 m 103 1024 h 1536 v -922 h -1536 z",2,"fill","rgba(30, 139, 205, 1)"],["type","path","d","M 1536 973 l -256 256 l -72 -73 l 132 -132 h -734 l 132 132 l -72 73 l -256 -256 l 256 -256 l 72 72 l -132 133 h 734 l -132 -133 l 72 -72 z",2,"fill","rgba(30, 139, 205, 1)"],[1,"menu-content"],["id","menu__excel_editor__un_merge",2,"display","none"],["width","25px","viewBox","0,0,2048,2048","focusable","false"],["type","path","d","M 1843 102 v 1741 h -1741 v -1741 m 103 512 h 717 v -409 h -717 m 1229 1024 h 307 v -512 h -307 m -103 0 h -307 v 512 h 307 m -819 -512 h -307 v 512 h 307 m 102 0 h 308 v -512 h -308 m 308 1024 v -410 h -717 v 410 m 1536 -410 h -717 v 410 h 717 m 0 -1127 v -409 h -717 v 409 z"],["type","path","d","M 1024 1331 v 410 h -102 v -410 m 0 -614 v -512 h 102 v 512 z",2,"fill","rgba(121, 119, 116, 1)"],["type","path","d","M 1843 102 v 1741 h -1741 v -1741 m 1639 103 h -1536 v 1536 h 1536 z",2,"fill","rgba(58, 58, 56, 1)"],["type","path","d","M 1843 614 v 717 h -1741 v -717 m 410 615 v -512 h -307 v 512 m 717 0 v -512 h -308 v 512 m 717 0 v -512 h -307 v 512 m 717 -512 h -307 v 512 h 307 z",2,"fill","rgba(30, 139, 205, 1)"],["popupConfirm",""],["class","loading-mess",4,"ngIf"],[1,"dropdown-item",3,"click"],["matTreeNodePadding","",3,"ngClass"],["mat-icon-button","","disabled",""],[4,"ngIf"],[3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"w-6","h-6","mr-2","text-slate-600","dark:text-slate-500"],["d","M9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.825a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31L.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3zm-8.322.12C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139z"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","aria-describedby","cdk-describedby-message-serverApp-1-31","cdk-describedby-host","serverApp-1",1,"mat-tooltip-trigger","w-6","h-6","text-pending","ng-star-inserted"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["d","m9 15 2 2 4-4"],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],["mode","indeterminate","class","example-tree-progress-bar",4,"ngIf"],["mode","indeterminate",1,"example-tree-progress-bar"],[1,"loading-mess"],[1,"loading-content"],[1,"icon-msg"],["role","status",1,"spinner-border","spinner-border-sm"],[1,"text-msg"]],template:function(e,n){if(1&e&&(t.TgZ(0,"editor-layout",0),t.NdJ("handleCancel",function(){return n.cancelAction()})("handleConfirm",function(){return n.saveAction()}),t.YNc(1,Xx,1,0,"azt-loading-effect",1),t.YNc(2,uv,170,119,"ng-template",null,2,t.W1O),t.qZA()),2&e){const i=t.MAs(3);t.Q6J("headerBackTolink",n.backToLink)("showConfirmButton",!0),t.xp6(1),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.mk,O.sg,O.O5,tn.lW,ge.Hw,he.VK,he.p6,sa.pW,Vn.fQ,Vn.ah,Vn.eu,Vn.gi,Vn.uo,Lt.Vv,h.Fj,h.JJ,h.On,te.Q,Ei,Ui,at.bT],styles:['.header-mix-bank[_ngcontent-%COMP%]{padding:5px 20px;display:flex;flex-wrap:wrap;justify-content:end;align-items:center}.header-mix-bank[_ngcontent-%COMP%]   .bank-his-matrix[_ngcontent-%COMP%]{height:-moz-fit-content;height:fit-content;display:flex;justify-content:center;align-items:center}.header-mix-bank[_ngcontent-%COMP%]   .name-block[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center}.header-mix-bank[_ngcontent-%COMP%]   .name-block[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{margin-right:10px}.header-mix-bank[_ngcontent-%COMP%]   .name-block[_ngcontent-%COMP%]   .has-err[_ngcontent-%COMP%]{border:1px solid red!important}.header-mix-bank[_ngcontent-%COMP%]   .name-block[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:500px;padding:5px 10px;border-radius:5px;margin-right:15px}.btn-save[_ngcontent-%COMP%]{background-color:#2361ae;line-height:30px;margin-top:5px;text-transform:none}.btn-save[_ngcontent-%COMP%]:hover{background-color:#2e8cff}.btn-save.mat-button-disabled[_ngcontent-%COMP%]{background-color:#0000001f}.btn-cancel[_ngcontent-%COMP%]{background-color:#d0d0d0;line-height:30px;margin-top:5px;text-transform:none}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#a3a3a3}.btn-cancel.mat-button-disabled[_ngcontent-%COMP%]{background-color:#0000001f}.loading-mess[_ngcontent-%COMP%]{width:100vw;height:100vh;position:fixed;z-index:9;top:0;left:0;display:flex;justify-content:center;align-items:center;background-color:#0006}.loading-content[_ngcontent-%COMP%]{text-align:center;color:#000}.loading-content[_ngcontent-%COMP%]   .text-msg[_ngcontent-%COMP%]{font-size:20px;margin-top:10px;background-color:#f0f8ffa3;padding:10px;border-radius:5px}  .main-mix-blank{width:100%;height:calc(100vh - 95px);display:flex}  .main-mix-blank .col-tree{position:relative;height:100%;overflow:auto;width:25%;padding-right:10px;border-right:1px dotted #7f7f7f}  .main-mix-blank .col-tree .filler-node{position:sticky;bottom:0;padding:10px 0 10px 10px;border-top:1px dotted #e0e0e0}  .main-mix-blank .col-tree .filler-node input{width:100%;padding:5px 10px}  .main-mix-blank .col-tree mat-tree-node mat-icon{color:#37474f;width:30px}  .main-mix-blank .col-tree mat-tree-node string{width:100%;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;cursor:pointer}  .main-mix-blank .col-tree mat-tree-node .icon--folder{color:#ff9800}  .main-mix-blank .col-tree mat-tree-node .icon--article{color:#2196f3}  .main-mix-blank .col-tree .tb-active mat-icon{color:#3f51b5}  .main-mix-blank .col-tree .tb-active string{color:#3f51b5}  .main-mix-blank .col-table{width:75%;margin:20px 0;padding:0 20px;overflow:auto}  .main-mix-blank .table-main{position:relative}  .main-mix-blank .table-main td,   .main-mix-blank .table-main th{box-shadow:1px 1px #000 inset;-webkit-user-select:none;user-select:none}  .main-mix-blank .table-main table{border-right:1px solid #000;border-bottom:1px solid #000;width:100%}  .main-mix-blank .table-main table thead{position:sticky;top:0;z-index:2}  .main-mix-blank .table-main table tfoot{position:sticky;bottom:0;box-shadow:0 1px #000 inset}  .main-mix-blank .table-main td{padding:10px}  .main-mix-blank .table-main .note-edit-item-tb:before{position:absolute;z-index:3;width:-moz-fit-content;width:fit-content;display:block;top:-55px;left:-130px;background:#fff59d;padding:5px;border-radius:5px;color:#263238;box-shadow:#00000005 0 1px 3px,#1b1f2326 0 0 0 1px}  .main-mix-blank .table-main .note-edit-item-tb:focus-visible:before{content:attr(first-trans) ": " attr(num-tn) "; " attr(last-trans) ": " attr(num-tl) "";white-space:pre-wrap}  .main-mix-blank .table-main .warning-item:after{content:"\\e000";position:absolute;font-family:Material Icons;color:#ff9800;font-size:12px;top:0;right:3px;opacity:.5}  .main-mix-blank .table-main .warning-item:hover:after{cursor:pointer}  .main-mix-blank .table-main .wn-empty:hover:before{content:attr(empty-question-trans);background:#ff9800;z-index:3;color:#fff;left:-100px;top:-34px}  .main-mix-blank .table-main .wn-over-tn:hover:before{content:attr(over-question-trans);background:#ff9800;z-index:3;color:#fff;left:-70px;top:-34px}  .main-mix-blank .table-main .wn-over-tl:hover:before{content:attr(over-question-trans);background:#ff9800;z-index:3;color:#fff;left:-70px;top:-34px}  .main-mix-blank .table-main .edit-item-tb{text-align:center;position:relative}  .main-mix-blank .table-main .edit-item-tb:focus-visible{outline:2px solid #00279d;background-color:#fff;color:#000}  .main-mix-blank .table-main .header-tb{background-color:#c8e6c9;text-align:center;font-weight:600}  .main-mix-blank .table-main .header-tb td:hover{background-color:#c8e6c9}  .main-mix-blank .table-main .dis-item-tb{background-color:#cfd8dc;color:#2a3545}  .main-mix-blank .table-main .dis-item-tb td:hover{background-color:#cfd8dc!important}  .main-mix-blank .table-main .dis-item-tb:hover{background-color:#cfd8dc!important}  .main-mix-blank .table-main .text-center{text-align:center}  .main-mix-blank .table-main .no-background{background:#fff!important}  .main-mix-blank .table-main .no-background:hover{background:#fff!important}  .main-mix-blank .table-main table .select{background:#c7e5ff!important}  .main-mix-blank .table-main .menu-excel{display:none;width:-moz-fit-content;width:fit-content;background:#fff;border:1px solid #3f51b5;position:absolute;box-shadow:#00000059 0 5px 15px}  .main-mix-blank .table-main .menu-excel li{padding:10px;list-style:none;display:flex;justify-content:space-between;align-items:center;cursor:pointer}  .main-mix-blank .table-main .menu-excel li:hover{background:rgba(200,230,201,.231372549)}  .main-mix-blank .table-main .menu-excel li svg{margin-right:10px}  .main-mix-blank .table-main .border-err{border:1px solid #f44336!important;outline:1px solid #f44336!important}  .main-mix-blank .table-main .tb-matrix-editor-trash-node{cursor:pointer;width:20px}  .main-mix-blank .table-main .tb-matrix-editor-trash-node:hover{color:#f44336}  .main-mix-blank .table-main thead td{font-weight:400}.header-mix-bank[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .menu-item[_ngcontent-%COMP%]{text-transform:none}.ins-info[_ngcontent-%COMP%]{padding-top:15px;font-style:italic}@media (max-width: 768px){.bank-name-block[_ngcontent-%COMP%], .name-block[_ngcontent-%COMP%], .input[_ngcontent-%COMP%]{width:100%}.input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%!important;margin-bottom:5px}.main-mix-blank[_ngcontent-%COMP%]{flex-wrap:wrap;height:100%!important}.col-tree[_ngcontent-%COMP%]{width:100%!important;height:50vh!important;padding:10px 10px 0;--tw-border-opacity: 1;border:1px solid;border-color:rgb(var(--color-slate-200)/var(--tw-border-opacity))}.col-tree[_ngcontent-%COMP%]   .filler-node[_ngcontent-%COMP%]{padding:5px!important}.col-table[_ngcontent-%COMP%]{width:calc(100vw - 20px)!important;padding-bottom:30px}}']}),o})();function hv(o,s){1&o&&t._UZ(0,"azt-loading-effect")}const pv=function(o){return{active:o}};function gv(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",11),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw(3);return t.KtG(r.changeViewHashId(a))}),t._uU(2),t.qZA(),t.BQk()}if(2&o){const e=s.$implicit,n=s.index,i=t.oxw(3);let a;t.xp6(1),t.Q6J("ngClass",t.VKq(2,pv,i.indexHashId==n)),t.xp6(1),t.hij(" ",i.replace3DigitExamCode(null!==(a=e.offlineMixquestionHashId)&&void 0!==a?a:0)," ")}}function fv(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"button",16)(2,"span",17),t._uU(3),t.qZA(),t.TgZ(4,"span"),t._uU(5,"-"),t.qZA(),t.TgZ(6,"span",17),t._uU(7),t.qZA()(),t.BQk()),2&o){const e=s.$implicit,n=s.index;t.xp6(3),t.Oqu(n+1),t.xp6(4),t.Oqu(e)}}function xv(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"div",12)(2,"div",13)(3,"p",14),t._uU(4),t.ALo(5,"mytranslate"),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()(),t.TgZ(9,"div",15),t.YNc(10,fv,8,2,"ng-container",10),t.qZA()()(),t.BQk()),2&o){const e=s.$implicit,n=s.index,i=t.oxw(3);t.xp6(1),t.Q6J("hidden",n!==i.indexHashId),t.xp6(3),t.hij(" ",t.lcZ(5,5,"lang_auto_bang_dap_an")," "),t.xp6(3),t.AsE("(",null==e.rightAnswers?null:e.rightAnswers.length," ",t.lcZ(8,7,"lang_auto_cau_hoi_brackets"),""),t.xp6(3),t.Q6J("ngForOf",e.rightAnswers)}}function vv(o,s){if(1&o&&(t.TgZ(0,"div",5)(1,"div",8)(2,"p",9),t._uU(3),t.ALo(4,"mytranslate"),t.YNc(5,gv,3,4,"ng-container",10),t.qZA()(),t.YNc(6,xv,11,9,"ng-container",10),t.qZA()),2&o){const e=t.oxw(2);t.xp6(3),t.hij(" ",t.lcZ(4,3,"lang_auto_ma_de"),": "),t.xp6(2),t.Q6J("ngForOf",e.offlineExportObjs),t.xp6(1),t.Q6J("ngForOf",e.offlineExportObjs)}}function bv(o,s){1&o&&(t.TgZ(0,"div",5)(1,"div",18),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_auto_ban_chua_tao_ma_de_thi_offline_nao")," "))}function wv(o,s){if(1&o&&(t.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"h3",6),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()(),t.TgZ(7,"div",4),t.YNc(8,vv,7,5,"div",7),t.YNc(9,bv,4,3,"div",7),t.qZA()()()),2&o){const e=t.oxw();t.xp6(5),t.hij(" ",t.lcZ(6,3,"lang_auto_dap_an_de_thi_offline")," "),t.xp6(3),t.Q6J("ngIf",e.offlineExportObjs.length>0),t.xp6(1),t.Q6J("ngIf",e.offlineExportObjs.length<=0)}}let Tv=(()=>{class o extends mt.Q{constructor(e,n,i,a){super(e),this.commonService=e,this.activeRoute=n,this.offlineExamExportService=i,this.mobileWebviewService=a,this.offlineExportObjs=[],this.indexHashId=0}getData(){var e;this.initStatusObj();let n=null!==(e=this.getMyParam(this.activeRoute,"hash_id"))&&void 0!==e?e:"";this.subscriptions.add(this.offlineExamExportService.apiOfflineExamExportExportExcelGet(n).subscribe(i=>{var a,r,l;1==i.success?(this.offlineExportObjs=null!==(r=null===(a=i.data)||void 0===a?void 0:a.objs)&&void 0!==r?r:[],this.successStatusObj()):this.errorStatusObj(null!==(l=i.message)&&void 0!==l?l:"",!0)}))}changeViewHashId(e){this.indexHashId=e}replace3DigitExamCode(e){for(var n=e.toString();n.length<3;)n="0"+n;return n}ngOnInit(){this.getData(),super.ngOnInit(),this.mobileWebviewService.sendComponentLoaded("offline_answer_list")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(x.gz),t.Y36(Ot.qr),t.Y36(fi.F))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-offline-answer-list"]],features:[t.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"app"],[1,"container"],[1,"row"],[1,"col-md-12"],[1,"title","text-center"],["class","col-md-12",4,"ngIf"],[1,"app-block-info"],[1,"block-title"],[4,"ngFor","ngForOf"],[1,"btn-item",3,"ngClass","click"],[1,"app-item","mt-4",3,"hidden"],[1,"app-block-content"],[1,"app-block-title"],[1,"app-block-main"],[1,"btn-item"],[1,"number"],[1,"mt-4","alert","alert-danger"]],template:function(e,n){if(1&e&&(t.YNc(0,hv,1,0,"azt-loading-effect",0),t.YNc(1,wv,10,5,"ng-template",null,1,t.W1O)),2&e){const i=t.MAs(2);t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.mk,O.sg,O.O5,te.Q,at.bT],styles:[".app[_ngcontent-%COMP%]{min-height:100vh;background:#fff;padding:20px 0}.title[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.btn-item[_ngcontent-%COMP%]{display:inline-block;border:1px solid #eee;background:#fff;border-radius:5px;transition:all .3s;padding:5px 10px;margin-right:5px;margin-top:5px;width:calc(10% - 5px);cursor:pointer}.btn-item[_ngcontent-%COMP%]:hover{background:#eee}.block-title[_ngcontent-%COMP%]{font-weight:500}.active[_ngcontent-%COMP%]{color:#fff;transition:all .3s;background:#2361ae}.active[_ngcontent-%COMP%]:hover:not([disabled]){background:#154c90}@media screen and (max-width: 768px){.btn-item[_ngcontent-%COMP%]{width:calc(12.5% - 5px)}}@media screen and (max-width: 480px){.btn-item[_ngcontent-%COMP%]{width:calc(25% - 5px)}}"]}),o})();function Cv(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function Av(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",25)(1,"h3",26),t._uU(2),t.qZA(),t.TgZ(3,"div",27),t._UZ(4,"input",28),t.TgZ(5,"button",29),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.showCopySuccess())}),t.O4$(),t.TgZ(6,"svg",12),t._UZ(7,"rect",30)(8,"path",31),t.qZA(),t._uU(9),t.ALo(10,"mytranslate"),t.qZA()()()}if(2&o){const e=s.$implicit,n=t.oxw(3);let i;t.xp6(2),t.hij(" ",null==e.classObj?null:e.classObj.name," "),t.xp6(2),t.Q6J("value",e.linkDocument),t.xp6(1),t.Q6J("cdkCopyToClipboard",n.copyLinkToClipboard(null!==(i=e.linkDocument)&&void 0!==i?i:"")),t.xp6(4),t.hij(" ",t.lcZ(10,4,"lang_auto_sao_chep")," ")}}function yv(o,s){if(1&o&&(t.TgZ(0,"div",22)(1,"h3",23),t._uU(2),t.qZA(),t.YNc(3,Av,11,6,"div",24),t.qZA()),2&o){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.homeworkObj.name," "),t.xp6(1),t.Q6J("ngForOf",e.listLinkDocument)}}function kv(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",22)(1,"h3",23),t._uU(2),t.qZA(),t.TgZ(3,"div",32),t._UZ(4,"input",33),t.TgZ(5,"button",29),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.showCopySuccess())}),t.O4$(),t.TgZ(6,"svg",12),t._UZ(7,"rect",30)(8,"path",31),t.qZA(),t._uU(9),t.ALo(10,"mytranslate"),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.examObj.name," "),t.xp6(2),t.Q6J("value",e.linkDocument),t.xp6(1),t.Q6J("cdkCopyToClipboard",e.copyLinkToClipboard(e.linkDocument)),t.xp6(4),t.hij(" ",t.lcZ(10,4,"lang_auto_sao_chep")," ")}}function Ov(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",34)(1,"p",35),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"p",26),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"div",36)(8,"code",37)(9,"span"),t._uU(10,"<"),t.TgZ(11,"span"),t._uU(12,"iframe"),t.qZA(),t._uU(13,"\xa0 "),t.TgZ(14,"span"),t._uU(15,"width"),t.qZA(),t._uU(16,"="),t.TgZ(17,"span"),t._uU(18,'"100%"'),t.qZA(),t._uU(19,"\xa0 "),t.TgZ(20,"span"),t._uU(21,"height"),t.qZA(),t._uU(22,"="),t.TgZ(23,"span"),t._uU(24,'"900"'),t.qZA(),t._uU(25,"\xa0 "),t.TgZ(26,"span"),t._uU(27,"src"),t.qZA(),t._uU(28,"="),t.TgZ(29,"span"),t._uU(30),t.qZA(),t._uU(31,"\xa0 "),t.TgZ(32,"span"),t._uU(33,"title"),t.qZA(),t._uU(34,"="),t.TgZ(35,"span"),t._uU(36),t.qZA(),t._uU(37,"\xa0 "),t.TgZ(38,"span"),t._uU(39,"frameborder"),t.qZA(),t._uU(40,"="),t.TgZ(41,"span"),t._uU(42,'"0"'),t.qZA(),t._uU(43,"\xa0 "),t.TgZ(44,"span"),t._uU(45,"allow"),t.qZA(),t._uU(46,"="),t.TgZ(47,"span"),t._uU(48,'"accelerometer;autoplay;clipboard-write;encrypted-media; gyroscope; picture-in-picture"'),t.qZA(),t._uU(49,"\xa0 "),t.TgZ(50,"span"),t._uU(51,"allowfullscreen"),t.qZA(),t._uU(52,">"),t.qZA(),t._uU(53,"\xa0 "),t.TgZ(54,"span"),t._uU(55,"</"),t.TgZ(56,"span"),t._uU(57,"iframe"),t.qZA(),t._uU(58,">"),t.qZA()()(),t.TgZ(59,"div",38)(60,"button",39),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.showCopySuccess())}),t.O4$(),t.TgZ(61,"svg",40),t._UZ(62,"path",41)(63,"polyline",14),t.qZA(),t._uU(64),t.ALo(65,"mytranslate"),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(2),t.hij(" ",t.lcZ(3,6,"lang_testbank_publish_result_had_website"),"? "),t.xp6(3),t.hij(" ",t.lcZ(6,8,"lang_testbank_publish_result_note_tutorial")," "),t.xp6(25),t.hij('"',e.linkDocument,'"'),t.xp6(6),t.hij('"',e.examObj.name,'"'),t.xp6(24),t.Q6J("cdkCopyToClipboard",e.copyLinkToIframe()),t.xp6(4),t.hij(" ",t.lcZ(65,10,"lang_auto_sao_chep_ma_nhung")," ")}}const Sv=function(o){return[o]};function Ev(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"h3",5),t._uU(3),t.ALo(4,"mytranslate"),t.ALo(5,"mytranslate"),t.ALo(6,"mytranslate"),t.ALo(7,"mytranslate"),t.qZA()(),t.TgZ(8,"p",6),t._uU(9),t.ALo(10,"mytranslate"),t.qZA(),t.YNc(11,yv,4,2,"div",7),t.YNc(12,kv,11,6,"div",7),t.YNc(13,Ov,66,12,"div",8),t.TgZ(14,"div",9)(15,"div",10)(16,"a",11),t.ALo(17,"mylocalize"),t.O4$(),t.TgZ(18,"svg",12),t._UZ(19,"path",13)(20,"polyline",14)(21,"path",15)(22,"path",16)(23,"path",17)(24,"path",18),t.qZA(),t._uU(25),t.ALo(26,"mytranslate"),t.qZA()(),t.kcU(),t.TgZ(27,"div",19)(28,"a",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.backToDocumentManager())}),t.O4$(),t.TgZ(29,"svg",12),t._UZ(30,"path",21),t.qZA(),t._uU(31),t.ALo(32,"mytranslate"),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(3),t.hij(" ",1==e.type?e.homeworkObj.isPublished?t.lcZ(4,8,"lang_auto_xuat_ban_thanh_cong"):t.lcZ(5,10,"lang_auto_da_luu_thanh_cong_chua_xuat_ban"):e.examObj.isPublished?t.lcZ(6,12,"lang_auto_xuat_ban_thanh_cong"):t.lcZ(7,14,"lang_auto_da_luu_thanh_cong_chua_xuat_ban")," \u{1f389} "),t.xp6(6),t.hij(" ",t.lcZ(10,16,"lang_auto_copy_link_ben_duoi_va_gui_cho_hoc_sinh_hoc_sinh_truy_cap_link_de_lam_bai_va_nop_bai")," "),t.xp6(2),t.Q6J("ngIf",1==e.type),t.xp6(1),t.Q6J("ngIf",0==e.type),t.xp6(1),t.Q6J("ngIf",0==e.type),t.xp6(3),t.Q6J("routerLink",t.VKq(24,Sv,t.lcZ(17,18,e.getRouterLinkByType()))),t.xp6(9),t.hij(" ",t.lcZ(26,20,"lang_auto_quan_ly_danh_sach_da_thi")," "),t.xp6(6),t.hij(" ",t.lcZ(32,22,"lang_auto_ve_trang_quan_ly_file")," ")}}let Iv=(()=>{class o extends mt.Q{constructor(e,n,i){super(e),this.commonService=e,this.documentConfigService=n,this.activeRoute=i,this.backToLink="",this.linkDocument="",this.listLinkDocument=[],this.linkIframeDocument="",this.homeworkObj={},this.successListHomework=[],this.examObj={},this.type=0}createLinkHomeworkObjs(e,n){var i=[];let a=this.commonService.getCurrentDomain();return e.forEach(r=>{var l,c=n.filter(_=>_.id==r.classroomId);if(c&&c.length>0)i.push({classObj:c[0],homeworkObj:r,linkDocument:`${a}/bai-tap/${r.hashId}`});else{let _=null!==(l=this.commonService.myTranslateIntance("lang_auto_tu_do"))&&void 0!==l?l:"";i.push({classObj:{name:_},homeworkObj:r,linkDocument:`${a}/bai-tap/${r.hashId}`})}}),i}getHomeworkInfoByHashId(e){var n=this.commonService.myParseJson(e);this.initStatusObj(),this.subscriptions.add(this.documentConfigService.apiDocumentConfigGetHomeworkConfigDataPost(n,null==n?void 0:n[0]).subscribe(i=>{var a,r,l,c,_,d,m,p,w;if(1==i.success){this.homeworkObj=null!==(r=null===(a=i.data)||void 0===a?void 0:a.homeworkObj)&&void 0!==r?r:{},this.successListHomework=null!==(c=null===(l=i.data)||void 0===l?void 0:l.successHomeworkObjs)&&void 0!==c?c:[],this.listLinkDocument=this.createLinkHomeworkObjs(null!==(d=null===(_=i.data)||void 0===_?void 0:_.successHomeworkObjs)&&void 0!==d?d:[],null!==(p=null===(m=i.data)||void 0===m?void 0:m.classroomObjs)&&void 0!==p?p:[]);let C=this.commonService.getCurrentDomain();this.linkDocument=`${C}/bai-tap/${this.homeworkObj.hashId}`,this.successStatusObj()}else this.errorStatusObj(null!==(w=i.message)&&void 0!==w?w:"",!0)}))}getExamInfoByHashId(e){this.initStatusObj(),this.subscriptions.add(this.documentConfigService.apiDocumentConfigGetExamConfigDataGet(e).subscribe(n=>{var i,a,r;if(1==n.success){this.examObj=null!==(a=null===(i=n.data)||void 0===i?void 0:i.examObj)&&void 0!==a?a:{};let l=this.commonService.getCurrentDomain();this.linkDocument=`${l}/de-thi/${this.examObj.hashId}`,this.linkIframeDocument=`<iframe width="100%" height="900" src="${this.linkDocument}"  title="${this.examObj.name}" frameborder="0" allow="accelerometer;autoplay;clipboard-write;encrypted-media; gyroscope; picture-in-picture" allowfullscreen> </iframe>`,this.successStatusObj()}else this.errorStatusObj(null!==(r=n.message)&&void 0!==r?r:"",!0)}))}copyLinkToClipboard(e){return e}copyLinkToIframe(){return this.linkIframeDocument}showCopySuccess(){this.showSuccessSnack("lang_auto_sao_chep_thanh_cong")}getRouterLinkByType(){var e;return 1==this.type?"/admin/testbank/homework-results-list/"+this.homeworkObj.classroomId+"/"+this.homeworkObj.id+"/"+this.homeworkObj.hashId:"/admin/testbank/exam-results-list/"+(null!==(e=this.examObj.categoryId)&&void 0!==e?e:0)+"/"+this.examObj.id+"/0"}backToDocumentManager(){this.myNavigation(1==this.type?"/admin/testbank/document-management/1/0/1":`/admin/testbank/document-management/0/${this.examObj.categoryId}/1`)}ngOnInit(){var e,n;let i=this.commonService.getMyQueryParam("backto"),a=null!==(e=this.commonService.getMyParam(this.activeRoute,"hash_id"))&&void 0!==e?e:"";this.type=null!==(n=Number(this.commonService.getMyParam(this.activeRoute,"type")))&&void 0!==n?n:0,1==this.type?this.getHomeworkInfoByHashId(a):this.getExamInfoByHashId(a),this.backToLink=null!=i?i:"/admin/testbank/document-management/0/0/1",this.commonService.translateMetaData({title:"lang_cms_publish_document_title",description:"lang_cms_publish_document_description",image:""}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Ot.Cq),t.Y36(x.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-publish-document"]],features:[t.qOj],decls:4,vars:3,consts:[[3,"headerBackTolink"],[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"intro-y","mt-8"],[1,"flex","items-center","justify-center"],[1,"text-lg","font-medium"],[1,"text-md","text-center"],["class","box mx-auto mt-5 p-3","style","max-width: 560px",4,"ngIf"],["class","box p-3 text-center mt-5 intro-x mx-auto","style","max-width: 560px;",4,"ngIf"],[1,"mt-5","flex","flex-col","sm:flex-row","justify-center","items-center"],[1,"mr-2"],[1,"btn","btn-outline-primary","btn-transparent",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["d","M8 13h2"],["d","M8 17h2"],["d","M14 13h2"],["d","M14 17h2"],[1,"w-30"],[1,"btn","btn-outline-primary","btn-transparent",3,"click"],["d","M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"],[1,"box","mx-auto","mt-5","p-3",2,"max-width","560px"],[1,"text-md","font-medium"],["class","mt-4",4,"ngFor","ngForOf"],[1,"mt-4"],[1,"text-md"],[1,"azt-copy","relative","mt-2","intro-x"],["type","text","readonly","",1,"form-control","py-3","px-4","border-transparent","bg-slate-100","pr-10",2,"padding-right","120px",3,"value"],[1,"btn","btn-outline-primary","absolute","my-auto","inset-y-0","right-0",2,"border-top-left-radius","0","border-bottom-left-radius","0",3,"cdkCopyToClipboard","click"],["x","9","y","9","width","13","height","13","rx","2","ry","2"],["d","M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"],[1,"azt-copy","relative","mt-5","intro-x"],["type","text","readonly","",1,"form-control","py-3","px-4","border-transparent","bg-slate-100","pr-10","text-primary",2,"padding-right","120px","cursor","pointer",3,"value"],[1,"box","p-3","text-center","mt-5","intro-x","mx-auto",2,"max-width","560px"],[1,"tex-md"],[1,"overflow-y-auto","mt-3","rounded-md","text-left","border","border-slate-200","dark:border-darkmode-300","p-3"],[1,"whitespace-nowrap",2,"padding","1rem"],[1,"text-right","mt-3"],[1,"copy-code","btn","py-1","mr-auto","px-2","btn-outline-secondary",3,"cdkCopyToClipboard","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","icon-name","file","data-lucide","file",1,"lucide","lucide-file","w-4","h-4","mr-2"],["d","M14.5 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V7.5L14.5 2z"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0),t.YNc(1,Cv,1,0,"azt-loading-effect",1),t.YNc(2,Ev,33,26,"ng-template",null,2,t.W1O),t.qZA()),2&e){const i=t.MAs(3);t.Q6J("headerBackTolink",n.backToLink),t.xp6(1),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[x.yS,O.sg,O.O5,Ln.i3,te.Q,de._,at.mp,at.bT],encapsulation:2}),o})(),Ai=(()=>{class o{constructor(e,n,i){this.globalService=e,this.commonService=n,this.examPageResultService=i}getExamStatisticObjs(e,n,i,a){return this.globalService.startIntervalFunc(e),this.getExamAndQuestionObjsForStatistic(e,n,i,null!=a?a:0)}getExamAndQuestionObjsForStatistic(e,n,i,a){return new Nn.y(r=>{this.examPageResultService.apiExamPageResultGetObjV2Get(n,a).subscribe(l=>{var c,_,d,m,p,w,C,A,M;if(1==l.success){var D=null!==(_=null===(c=l.data)||void 0===c?void 0:c.serverSecond)&&void 0!==_?_:0,q=null!==(m=null===(d=l.data)||void 0===d?void 0:d.examObj)&&void 0!==m?m:{},U=null!==(w=null===(p=l.data)||void 0===p?void 0:p.classroomWithAvatarAndStudentObjs)&&void 0!==w?w:new Array,F=null!==(A=this.commonService.castJsonToClassObjs(on.v,JSON.stringify(null===(C=l.data)||void 0===C?void 0:C.questionObjs)))&&void 0!==A?A:new Array;this.getAllExamMarksObjsForStatistic(e,[],n,"",tt=>{var W,P,R,N;if(tt.hasOwnProperty("success")&&1==tt.success)if("Mark"==i){var B={classroomObjsWithStudentObjs:U,examObj:q,resultObjs:null!==(W=tt.resultObjs)&&void 0!==W?W:[],curServerTime:D,totalAttended:null===(P=l.data)||void 0===P?void 0:P.totalAttended};r.next({status:200,success:1,data:B,message:"successful"}),r.complete()}else{var z=[],X={};null===(R=tt.resultObjs)||void 0===R||R.forEach(V=>{V.examResultObjs&&V.examResultObjs.length>0&&V.examResultObjs.forEach(J=>{var et,ot,ut;z.push(null!==(et=J.id)&&void 0!==et?et:0),X.hasOwnProperty(null!==(ot=J.id)&&void 0!==ot?ot:0)||(X[null!==(ut=J.id)&&void 0!==ut?ut:0]=J)})}),this.getAllAnswerObjsForStatistic(z,n,V=>{var J,et,ot,ut;if(V.hasOwnProperty("success")&&1==V.success){var lt=[];U.forEach(ht=>{ht.classroomObj&&lt.push(ht.classroomObj)});var rt=[];null===(J=V.resultObjs)||void 0===J||J.forEach(ht=>{if(ht.id&&X.hasOwnProperty(ht.id)){var gt=Object.assign(Object.assign({},X[ht.id]),{correctQuestionIds:ht.correctQuestionIds,wrongQuestionIds:ht.wrongQuestionIds,resultQuestionIds:ht.resultQuestionIds});rt.push(gt)}});var xt={examObj:q,classroomObjs:lt,classroomObjsWithStudentObjs:U,questionObjs:F,resultQuestionObjs:rt,resultObjs:null!==(et=tt.resultObjs)&&void 0!==et?et:[],curServerTime:D,totalAttended:null===(ot=l.data)||void 0===ot?void 0:ot.totalAttended};F.length>0?(r.next({status:200,success:1,data:xt,message:"successful"}),r.complete()):(r.next({status:200,success:0,data:null,message:"lang_core_there_are_no_question_in_exam"}),r.complete())}else r.next({status:V.code,success:0,data:null,message:null!==(ut=V.message)&&void 0!==ut?ut:""}),r.complete()})}else r.next({status:tt.code,success:0,data:null,message:null!==(N=tt.message)&&void 0!==N?N:""}),r.complete()})}else r.next({status:l.code,success:0,data:null,message:null!==(M=l.message)&&void 0!==M?M:""}),r.complete()})})}getAllExamMarksObjsForStatistic(e,n,i,a,r){this.examPageResultService.apiExamPageResultGetObjsV2Get(i,"statistic",a).subscribe(l=>{var c,_,d;1==l.success?(!(null===(c=l.data)||void 0===c)&&c.objs&&n.push(...l.data.objs),null!==(_=l.data)&&void 0!==_&&_.nextPage?this.globalService.isStopIntervalFunc(e)?r({code:200,resultObjs:n,success:1,message:"successful"}):setTimeout(()=>{var m,p;this.getAllExamMarksObjsForStatistic(e,n,i,null!==(p=null===(m=l.data)||void 0===m?void 0:m.nextPage)&&void 0!==p?p:"",r)},300):r({code:200,resultObjs:n,success:1,message:"successful"})):r({code:l.code,resultObjs:[],success:0,message:null!==(d=l.message)&&void 0!==d?d:""})})}getAllAnswerObjsForStatistic(e,n,i){this.examPageResultService.apiExamPageResultGetQuestionStatisticByExamResultIdsPost({examResultIds:e},n).subscribe(a=>{var r,l;if(1==a.success){var c=[];!(null===(r=a.data)||void 0===r)&&r.objs&&c.push(...a.data.objs),i({code:200,resultObjs:c,success:1,message:"successful"})}else i({code:a.code,resultObjs:void 0,success:0,message:null!==(l=a.message)&&void 0!==l?l:""})})}findExamResultOfStudent(e,n){var i=[];return e.length>1?e.forEach(a=>{a.testStatus&&(a.studentId==n||null==a.studentId)&&i.push(a)}):1==e.length&&(e[0].studentId==n||null==e[0].studentId)&&i.push(e[0]),i}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(jn.U),t.LFG(vt.v),t.LFG(Ot.DR))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();class Ki extends on.v{constructor(){super(...arguments),this.countTested=0,this.countTrue=0,this.countNotAnswer=0,this.countAttended=0,this.countFalse=0,this.studentWhoFalse=[],this.studentWhoNotAnswer=[]}}class la{constructor(){this.listResult=[],this.listQuestions=[]}}var Vi=b(54729),Xi=b(98674);function Zv(o,s){1&o&&(t.TgZ(0,"div",3)(1,"h3",4),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"div",5),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,2,"lang_auto_bang_ty_le_dung_sai")," "),t.xp6(3),t.hij("",t.lcZ(6,4,"lang_testbank_statistical_cant_data_statistics"),"."))}function Mv(o,s){1&o&&(t.TgZ(0,"div",6)(1,"h3",4),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_auto_bang_ty_le_dung_sai")," "))}function Pv(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li",15),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.handleChangeClassStatistic(a))}),t.TgZ(1,"button",16),t._uU(2),t.qZA()()}if(2&o){const e=s.$implicit,n=t.oxw(3);t.xp6(1),t.Gre("nav-link w-full py-2 ",n.idClassObj==e.id?"active":""," "),t.xp6(1),t.hij(" ",e.name," ")}}function Lv(o,s){if(1&o&&(t.TgZ(0,"ul",13),t.YNc(1,Pv,3,4,"li",14),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.classroomObjs)}}function Nv(o,s){1&o&&(t.TgZ(0,"div",17)(1,"div",18)(2,"span",19),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()()()),2&o&&(t.xp6(3),t.hij("",t.lcZ(4,1,"lang_cms_common_loading"),"..."))}function Dv(o,s){if(1&o&&(t.TgZ(0,"div",45)(1,"div",46)(2,"div",47)(3,"mat-icon",48),t._uU(4," close "),t.qZA()()(),t.TgZ(5,"div"),t._UZ(6,"azt-standalone-question",49),t.qZA()()),2&o){const e=s.$implicit,n=t.oxw().index,i=t.oxw(3);t.xp6(6),t.Q6J("startQuestionIndex",i.examObj.startQuestionIndex)("follower",i.followerRenderQuest)("isBackEnd",!1)("isMobile",i.isMobile)("examObj",i.examObj)("question",e)("index",n)}}function jv(o,s){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij("",t.Dn7(2,1,t.xi3(3,5,(e.countNotAnswer+e.countFalse)/e.countAttended*100,"1.0-2"),",","."),"%")}}function qv(o,s){1&o&&(t.TgZ(0,"div"),t._uU(1,"0%"),t.qZA())}function Qv(o,s){if(1&o&&t._UZ(0,"img",53),2&o){const e=t.oxw().$implicit;t.Q6J("nameImages",e.nameImages)}}function Uv(o,s){if(1&o&&(t.TgZ(0,"span",54),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.fullName)}}function Fv(o,s){1&o&&(t.TgZ(0,"span",55),t._uU(1," , "),t.qZA())}function Rv(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Qv,1,1,"img",50),t.YNc(2,Uv,2,1,"ng-template",null,51,t.W1O),t.YNc(4,Fv,2,0,"span",52),t.BQk()),2&o){const e=s.$implicit,n=s.index,i=t.MAs(3),a=t.oxw().$implicit;let r;t.xp6(1),t.Q6J("ngIf",e.nameImages&&(null!==(r=e.studentId)&&void 0!==r?r:0)<=0)("ngIfElse",i),t.xp6(3),t.Q6J("ngIf",n!=a.studentWhoFalse.length-1)}}function Bv(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"tr")(1,"td")(2,"div",35)(3,"span",36),t._uU(4),t.ALo(5,"mytranslate"),t.qZA(),t.TgZ(6,"button",37),t.NdJ("click",function(i){const r=t.CHM(e).$implicit,l=t.MAs(11),c=t.oxw(3);return t.KtG(c.onContextMenu(i,r,l))}),t.O4$(),t.TgZ(7,"svg",38),t._UZ(8,"path",39)(9,"circle",40),t.qZA()()(),t.kcU(),t.TgZ(10,"context-menu",null,41),t.YNc(12,Dv,7,7,"ng-template",42),t.qZA()(),t.TgZ(13,"td",43),t._uU(14),t.qZA(),t.TgZ(15,"td",43),t._uU(16),t.qZA(),t.TgZ(17,"td",43),t._uU(18),t.qZA(),t.TgZ(19,"td",43),t._uU(20),t.qZA(),t.TgZ(21,"td",43),t._uU(22),t.qZA(),t.TgZ(23,"td",43),t.YNc(24,jv,4,8,"div",44),t.YNc(25,qv,2,0,"div",44),t.qZA(),t.TgZ(26,"td",43),t.YNc(27,Rv,5,3,"ng-container",34),t.qZA()()}if(2&o){const e=s.$implicit,n=s.index;t.xp6(4),t.AsE("",t.lcZ(5,10,"lang_testbank_statistical_question")," ",(null!=e.indexQuestion?e.indexQuestion:n)+1,""),t.xp6(10),t.Oqu(e.countAttended),t.xp6(2),t.Oqu(e.countTested),t.xp6(2),t.Oqu(e.countNotAnswer),t.xp6(2),t.Oqu(e.countTrue),t.xp6(2),t.Oqu(e.countFalse),t.xp6(2),t.Q6J("ngIf",0!=e.countAttended),t.xp6(1),t.Q6J("ngIf",0==e.countAttended),t.xp6(2),t.Q6J("ngForOf",e.studentWhoFalse)}}function Jv(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",20)(1,"table",21)(2,"thead",22)(3,"tr")(4,"th",23)(5,"div",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.toggleSortIndexQuestion())}),t._uU(6),t.ALo(7,"mytranslate"),t.O4$(),t.TgZ(8,"svg",25),t._UZ(9,"polyline",26)(10,"line",27)(11,"polyline",28)(12,"line",29),t.qZA()()(),t.kcU(),t.TgZ(13,"th",30)(14,"div",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.toggleSortStudentCountAttended())}),t._uU(15),t.ALo(16,"mytranslate"),t.O4$(),t.TgZ(17,"svg",25),t._UZ(18,"polyline",26)(19,"line",27)(20,"polyline",28)(21,"line",29),t.qZA()()(),t.kcU(),t.TgZ(22,"th",30)(23,"div",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.toggleSortStudentCountTested())}),t._uU(24),t.ALo(25,"mytranslate"),t.O4$(),t.TgZ(26,"svg",25),t._UZ(27,"polyline",26)(28,"line",27)(29,"polyline",28)(30,"line",29),t.qZA()()(),t.kcU(),t.TgZ(31,"th",30)(32,"div",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.toggleSortStudentCountNotAnswer())}),t._uU(33),t.ALo(34,"mytranslate"),t.O4$(),t.TgZ(35,"svg",25),t._UZ(36,"polyline",26)(37,"line",27)(38,"polyline",28)(39,"line",29),t.qZA()()(),t.kcU(),t.TgZ(40,"th",30)(41,"div",31),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.toggleSortStudentCountTrue())}),t._uU(42),t.ALo(43,"mytranslate"),t.O4$(),t.TgZ(44,"svg",25),t._UZ(45,"polyline",26)(46,"line",27)(47,"polyline",28)(48,"line",29),t.qZA()()(),t.kcU(),t.TgZ(49,"th",30)(50,"div",31),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.toggleSortStudentCountFalse())}),t._uU(51),t.ALo(52,"mytranslate"),t.O4$(),t.TgZ(53,"svg",25),t._UZ(54,"polyline",26)(55,"line",27)(56,"polyline",28)(57,"line",29),t.qZA()()(),t.kcU(),t.TgZ(58,"th",32)(59,"div",31),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.toggleSortFalse())}),t._uU(60),t.ALo(61,"mytranslate"),t.O4$(),t.TgZ(62,"svg",25),t._UZ(63,"polyline",26)(64,"line",27)(65,"polyline",28)(66,"line",29),t.qZA()()(),t.kcU(),t.TgZ(67,"th",33)(68,"span"),t._uU(69),t.ALo(70,"mytranslate"),t.qZA()()()(),t.TgZ(71,"tbody"),t.YNc(72,Bv,28,12,"tr",34),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(6),t.hij(" ",t.lcZ(7,9,"lang_testbank_statistical_questions")," "),t.xp6(9),t.hij(" ",t.lcZ(16,11,"lang_testbank_statistical_total_number_exam")," "),t.xp6(9),t.hij(" ",t.lcZ(25,13,"lang_testbank_statistical_number_student_did")," "),t.xp6(9),t.hij(" ",t.lcZ(34,15,"lang_testbank_statistical_number_student_do_not")," "),t.xp6(9),t.hij(" ",t.lcZ(43,17,"lang_testbank_statistical_number_student_right")," "),t.xp6(9),t.hij(" ",t.lcZ(52,19,"lang_testbank_statistical_number_student_wrong")," "),t.xp6(9),t.hij(" ",t.lcZ(61,21,"lang_testbank_statistical_student_not_done")," "),t.xp6(9),t.hij(" ",t.lcZ(70,23,"lang_testbank_statistical_student_who_wrong")," "),t.xp6(3),t.Q6J("ngForOf",e.listQuestion)}}function Hv(o,s){if(1&o&&(t.TgZ(0,"div",7)(1,"div",8),t.YNc(2,Lv,2,1,"ul",9),t.TgZ(3,"div",10),t.YNc(4,Nv,5,3,"div",11),t.YNc(5,Jv,73,25,"div",12),t.qZA()()()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.classroomObjs&&e.classroomObjs.length>0),t.xp6(2),t.Q6J("ngIf",e.changeClassLoading),t.xp6(1),t.Q6J("ngIf",!e.changeClassLoading)}}let zv=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_,d,m,p){super(a),this.statisticalApiService=e,this.testedListApiService=n,this.dialog=i,this.commonService=a,this.activeRoute=r,this.contextMenuService=l,this.docxService=c,this.dictionaryService=_,this.customQuestionInterface=d,this.fb=m,this.answerTypeService=p,this.viewType=-1,this.doneLoadingEmit=new t.vpe,this.idClassObj=-1,this.examId=-1,this.listQuestion=[],this.examObj={},this.isCheckData=!1,this.changeClassLoading=!1,this.examAttended=0,this.isMobile=this.commonService.isMobileOrTable(),this.panelOpenState=!1,this.statusSort=1,this.isSortFalse=!1,this.cloneListQuestion=[],this.followerRenderQuest=new Ci.G,this.form=new h.nJ({}),this.classroomObjs=[],this.questionObjs=[],this.listResults=[],this.studentObjs=[],this.userObjs=[],this.checkSortType={ratioTrueFalse:!1,numberIndex:!0,totalStudentExam:!1,countTested:!1,countFalse:!1,countNotAnswer:!1,countTrue:!1}}onContextMenu(e,n,i){e&&(this.contextMenuService.show.next({anchorElement:null!=e&&e.target?e.target:void 0,contextMenu:i,event:e,item:n}),null==e||e.preventDefault(),null==e||e.stopPropagation())}readyData(e,n){this.listQuestion=e,this.examAttended=n,this.isCheckData=0==this.listQuestion.length,this.followerRenderQuest.setNumQuest(this.listQuestion.length),this.cloneListQuestion=this.commonService.myClone(this.listQuestion),this.isSortFalse&&(this.listQuestion=this.listQuestion.sort((i,a)=>i.countAttended>0&&a.countAttended>0?(a.countNotAnswer+a.countFalse)/a.countAttended*100-(i.countNotAnswer+i.countFalse)/i.countAttended*100:0)),this.changeClassLoading=!1,this.doneLoadingEmit.emit(!0),this.successStatusObj()}getListQuestionStatistic(e,n){this.initStatusObj(),this.statisticalApiService.getExamStatisticObjs("statistic_question",e,n,1).subscribe(i=>{var a,r,l,c,_,d,m,p,w;if(1==i.success&&i.data){let C=i.data.resultObjs&&i.data.resultObjs.length>0?i.data.resultObjs:new Array,A=this.testedListApiService.mergeStudentWithAvatar(null!=C?C:[]),M=this.commonService.castJsonToClassObjs(la,JSON.stringify(i.data.classroomObjs));this.classroomObjs=null!=M?M:[];let D={};null===(a=i.data.classroomObjsWithStudentObjs)||void 0===a||a.forEach(R=>{var N,B,z,X;R.classroomObj&&R.studentObjs&&(D.hasOwnProperty(null!==(B=null===(N=R.classroomObj)||void 0===N?void 0:N.id)&&void 0!==B?B:0)||(D[null!==(X=null===(z=R.classroomObj)||void 0===z?void 0:z.id)&&void 0!==X?X:0]=R.studentObjs))}),this.form=this.fb.group(this.classroomObjs&&this.classroomObjs.length>0?{curSelectClass:new h.p4(this.classroomObjs[0].id)}:{curSelectClass:new h.p4(-1)});let q=i.data.questionObjs&&i.data.questionObjs.length>0?i.data.questionObjs:new Array;this.questionObjs=null!==(r=this.commonService.castJsonToClassObjs(Ki,JSON.stringify(q)))&&void 0!==r?r:[],this.listResults=(null===(l=i.data)||void 0===l?void 0:l.resultQuestionObjs)&&(null===(c=i.data)||void 0===c?void 0:c.resultQuestionObjs.length)>0?i.data.resultQuestionObjs:new Array;let U=this.dictionaryService.getDictionaryByGroupFieldTS(this.listResults,"userId"),F=[];for(let R=0;R<this.classroomObjs.length;R++)D.hasOwnProperty(null!==(_=this.classroomObjs[R].id)&&void 0!==_?_:0)&&(this.classroomObjs[R].students=D[null!==(d=this.classroomObjs[R].id)&&void 0!==d?d:0]),null===(m=this.classroomObjs[R].students)||void 0===m||m.forEach(N=>{var B,z;if(N.parentId&&!this.commonService.filterArray(F,N.parentId)&&F.push(N.parentId),N.parentId&&U.hasOwnProperty(N.parentId)&&!this.commonService.filterArray(this.classroomObjs[R].listResult,U[N.parentId][0])){let X=this.statisticalApiService.findExamResultOfStudent(U[N.parentId],null!==(B=N.id)&&void 0!==B?B:0);X.length>0&&(null===(z=this.classroomObjs[R].listResult)||void 0===z||z.push(X[X.length-1]))}});let tt=!1,P={id:-1,name:null!==(p=this.commonService.myTranslateIntance("lang_auto_thi_sinh_tu_do"))&&void 0!==p?p:"",userTested:[],listResult:[],listQuestions:[]};A.forEach(R=>{var N,B,z,X,V;if(!this.commonService.filterArray(F,null!==(N=R.parentId)&&void 0!==N?N:"0")){if(R.parentId&&U.hasOwnProperty(null!==(B=R.parentId)&&void 0!==B?B:0)){let J=this.statisticalApiService.findExamResultOfStudent(U[R.parentId],null!==(z=R.id)&&void 0!==z?z:0);if(J.length>0){let et=J[J.length-1];P.listResult.push(et);let ot=this.commonService.myTranslateIntance("lang_auto_thi_sinh_thi_offline");R.fullName=null!==(X=R.fullName)&&void 0!==X?X:ot+"_"+et.id,null===(V=P.userTested)||void 0===V||V.push(R)}}tt=!0}}),tt&&this.classroomObjs.push(P),this.classroomObjs.length>0?this.handleChangeClassStatistic(this.classroomObjs[0]):(this.doneLoadingEmit.emit(!1),this.isCheckData=!0,this.successStatusObj())}else this.doneLoadingEmit.emit(!1),this.showErrorSnack(null!==(w=i.message)&&void 0!==w?w:"")})}handleChangeClassStatistic(e){var n,i,a,r,l,c,_;this.idClassObj=e.id;let d=[],m=0;this.changeClassLoading=!0;for(let p=0;p<this.questionObjs.length;p++)(this.answerTypeService.isOneChoiceAnswer(this.questionObjs[p].answerType)||this.answerTypeService.isFillAnswer(this.questionObjs[p].answerType))&&(this.questionObjs[p].countFalse=0,this.questionObjs[p].countNotAnswer=0,this.questionObjs[p].countTested=0,this.questionObjs[p].countAttended=0,this.questionObjs[p].countTrue=0,this.questionObjs[p].indexQuestion=p,this.questionObjs[p].studentWhoFalse=[],this.questionObjs[p].studentWhoNotAnswer=[]);if(-1==e.id){let p=this.dictionaryService.getDictionaryByGroupFieldTS(e.listResult,"userId");for(let w in p)if(p.hasOwnProperty(w)){m++;let C=null===(n=e.userTested)||void 0===n?void 0:n.filter(A=>A.parentId==p[w][p[w].length-1].userId);for(let A=0;A<this.questionObjs.length;A++)(this.answerTypeService.isOneChoiceAnswer(this.questionObjs[A].answerType)||this.answerTypeService.isFillAnswer(this.questionObjs[A].answerType))&&(p[w][0].correctQuestionIds&&this.commonService.filterArray(p[w][0].correctQuestionIds,this.questionObjs[A].id)&&(this.questionObjs[A].countTrue++,this.questionObjs[A].countTested++),p[w][0].wrongQuestionIds&&this.commonService.filterArray(p[w][0].wrongQuestionIds,this.questionObjs[A].id)&&(this.questionObjs[A].countFalse++,this.questionObjs[A].countTested++,C&&C.length>0&&(this.commonService.filterArray(this.questionObjs[A].studentWhoFalse,{studentId:C[0].id,parentId:C[0].parentId,fullName:C[0].fullName,nameImages:C[0].nameImages})||null===(i=this.questionObjs[A].studentWhoFalse)||void 0===i||i.push({studentId:C[0].id,parentId:C[0].parentId,fullName:C[0].fullName,nameImages:C[0].nameImages}))),p[w][0].resultQuestionIds&&this.commonService.filterArray(p[w][0].resultQuestionIds,this.questionObjs[A].id)&&this.questionObjs[A].countAttended++,this.commonService.filterArray(p[w][0].resultQuestionIds,this.questionObjs[A].id)&&!this.commonService.filterArray(p[w][0].correctQuestionIds,this.questionObjs[A].id)&&!this.commonService.filterArray(p[w][0].wrongQuestionIds,this.questionObjs[A].id)&&(this.questionObjs[A].countNotAnswer++,C&&C.length>0&&(this.commonService.filterArray(this.questionObjs[A].studentWhoNotAnswer,{studentId:C[0].id,parentId:C[0].parentId,fullName:C[0].fullName,nameImages:C[0].nameImages})||null===(a=this.questionObjs[A].studentWhoNotAnswer)||void 0===a||a.push({studentId:C[0].id,parentId:C[0].parentId,fullName:C[0].fullName,nameImages:C[0].nameImages}))))}}else{let p=this.dictionaryService.getDictionaryByGroupFieldTS(null!==(r=e.listResult)&&void 0!==r?r:[],"userId");for(let w in p)if(p.hasOwnProperty(w)){m++;let C=null===(l=e.students)||void 0===l?void 0:l.filter(A=>A.parentId==p[w][0].userId);for(let A=0;A<this.questionObjs.length;A++)(this.answerTypeService.isOneChoiceAnswer(this.questionObjs[A].answerType)||this.answerTypeService.isFillAnswer(this.questionObjs[A].answerType))&&(p[w][0].correctQuestionIds&&this.commonService.filterArray(p[w][0].correctQuestionIds,this.questionObjs[A].id)&&(this.questionObjs[A].countTrue++,this.questionObjs[A].countTested++),p[w][0].wrongQuestionIds&&this.commonService.filterArray(p[w][0].wrongQuestionIds,this.questionObjs[A].id)&&(this.questionObjs[A].countFalse++,this.questionObjs[A].countTested++,C&&C.length>0&&(this.commonService.filterArray(this.questionObjs[A].studentWhoFalse,{studentId:C[0].id,parentId:C[0].parentId,fullName:C[0].fullName,nameImages:C[0].nameImages})||null===(c=this.questionObjs[A].studentWhoFalse)||void 0===c||c.push({studentId:C[0].id,parentId:C[0].parentId,fullName:C[0].fullName,nameImages:C[0].nameImages}))),p[w][0].resultQuestionIds&&this.commonService.filterArray(p[w][0].resultQuestionIds,this.questionObjs[A].id)&&this.questionObjs[A].countAttended++,this.commonService.filterArray(p[w][0].resultQuestionIds,this.questionObjs[A].id)&&!this.commonService.filterArray(p[w][0].correctQuestionIds,this.questionObjs[A].id)&&!this.commonService.filterArray(p[w][0].wrongQuestionIds,this.questionObjs[A].id)&&(this.questionObjs[A].countNotAnswer++,C&&C.length>0&&(this.commonService.filterArray(this.questionObjs[A].studentWhoNotAnswer,{studentId:C[0].id,parentId:C[0].parentId,fullName:C[0].fullName,nameImages:C[0].nameImages})||null===(_=this.questionObjs[A].studentWhoNotAnswer)||void 0===_||_.push({studentId:C[0].id,parentId:C[0].parentId,fullName:C[0].fullName,nameImages:C[0].nameImages}))))}}this.docxService.replaceCanvasBackgroundTS(this.questionObjs),this.questionObjs.forEach(p=>{(this.answerTypeService.isOneChoiceAnswer(p.answerType)||this.answerTypeService.isFillAnswer(p.answerType))&&d.push(p)}),this.readyData(d,m)}toggleSortFalse(){this.checkSortType.ratioTrueFalse=!this.checkSortType.ratioTrueFalse,this.checkSortType.ratioTrueFalse?(this.isSortFalse=!0,this.listQuestion=this.listQuestion.sort((e,n)=>(n.countAttended>0?(n.countNotAnswer+n.countFalse)/n.countAttended*100:0)-(e.countAttended>0?(e.countNotAnswer+e.countFalse)/e.countAttended*100:0))):this.listQuestion=this.listQuestion.sort((e,n)=>(n.countAttended>0?(n.countNotAnswer+n.countFalse)/n.countAttended*100:0)-(e.countAttended>0?(e.countNotAnswer+e.countFalse)/e.countAttended*100:0)).reverse()}toggleSortIndexQuestion(){this.checkSortType.numberIndex=!this.checkSortType.numberIndex,this.listQuestion=this.checkSortType.numberIndex?this.commonService.myClone(this.cloneListQuestion):this.commonService.myClone(this.cloneListQuestion).reverse()}toggleSortStudentCountAttended(){this.checkSortType.totalStudentExam=!this.checkSortType.totalStudentExam,this.checkSortType.totalStudentExam?this.listQuestion.sort((e,n)=>e.countAttended-n.countAttended):this.listQuestion.sort((e,n)=>e.countAttended-n.countAttended).reverse()}toggleSortStudentCountTested(){this.checkSortType.countTested=!this.checkSortType.countTested,this.checkSortType.countTested?this.listQuestion.sort((e,n)=>e.countTested-n.countTested):this.listQuestion.sort((e,n)=>e.countTested-n.countTested).reverse()}toggleSortStudentCountNotAnswer(){this.checkSortType.countNotAnswer=!this.checkSortType.countNotAnswer,this.checkSortType.countNotAnswer?this.listQuestion.sort((e,n)=>e.countNotAnswer-n.countNotAnswer):this.listQuestion.sort((e,n)=>e.countNotAnswer-n.countNotAnswer).reverse()}toggleSortStudentCountTrue(){this.checkSortType.countTrue=!this.checkSortType.countTrue,this.checkSortType.countTrue?this.listQuestion.sort((e,n)=>e.countTrue-n.countTrue):this.listQuestion.sort((e,n)=>e.countTrue-n.countTrue).reverse()}toggleSortStudentCountFalse(){this.checkSortType.countFalse=!this.checkSortType.countFalse,this.checkSortType.countFalse?this.listQuestion.sort((e,n)=>e.countFalse-n.countFalse):this.listQuestion.sort((e,n)=>e.countFalse-n.countFalse).reverse()}ngOnInit(){(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var e;this.examId=null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"id")))&&void 0!==e?e:-1,this.getListQuestionStatistic(this.examId,"Question")}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Ai),t.Y36(Fn),t.Y36(j.uw),t.Y36(vt.v),t.Y36(x.gz),t.Y36(ft),t.Y36(Vi.x),t.Y36(Xi.E),t.Y36(Ti.U),t.Y36(h.QS),t.Y36(nn.T))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-list-question"]],inputs:{viewType:"viewType"},outputs:{doneLoadingEmit:"doneLoadingEmit"},features:[t.qOj],decls:3,vars:3,consts:[["class","intro-y block items-center",4,"ngIf"],["class","intro-y block sm:flex items-center",4,"ngIf"],["class","report-box intro-x mt-5",4,"ngIf"],[1,"intro-y","block","items-center"],[1,"text-lg","font-medium","truncate","mr-5"],[1,"p-3","m-3","text-center","alert","text-slate-500","font-medium"],[1,"intro-y","block","sm:flex","items-center"],[1,"report-box","intro-x","mt-5"],[1,"box","p-5"],["class","nav nav-link-tabs","style","overflow-x: auto","role","tablist",4,"ngIf"],[1,"tab-content","mt-5","overflow-x-auto"],["class","d-flex justify-content-center",4,"ngIf"],["id","example-tab-5","class","tab-pane leading-relaxed active","role","tabpanel","aria-labelledby","example-5-tab",4,"ngIf"],["role","tablist",1,"nav","nav-link-tabs",2,"overflow-x","auto"],["id","example-5-tab","class","nav-item flex-1 dz-clickable","role","presentation",3,"click",4,"ngFor","ngForOf"],["id","example-5-tab","role","presentation",1,"nav-item","flex-1","dz-clickable",3,"click"],["data-tw-toggle","pill","data-tw-target","#example-tab-5","type","button","role","tab","aria-controls","example-tab-5","aria-selected","true"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"sr-only"],["id","example-tab-5","role","tabpanel","aria-labelledby","example-5-tab",1,"tab-pane","leading-relaxed","active"],[1,"intro-x","table","table-bordered",2,"width","max-content"],[1,"bg-slate-100","dark:bg-darkmode-400"],[1,"whitespace-nowrap",2,"padding","10px","width","120px"],[1,"flex","items-center","dz-clickable",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-5","h-5","ml-1","inline-block","flex-none"],["points","11 17 7 21 3 17"],["x1","7","y1","21","x2","7","y2","9"],["points","21 7 17 3 13 7"],["x1","17","y1","15","x2","17","y2","3"],[1,"w-30",2,"padding","10px","width","110px"],[1,"flex","items-center","clickable",3,"click"],[1,"w-30",2,"padding","10px","width","150px"],[1,"whitespace-nowrap",2,"text-align","center","vertical-align","middle","width","29.5vw"],[4,"ngFor","ngForOf"],[1,"flex","items-center","relative"],[1,"text-md"],[1,"btn-transparent","ml-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-5","h-5"],["d","M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"],["cx","12","cy","12","r","3"],["popUp",""],["contextMenuItem","","style","position: absolute"],[2,"text-align","center","vertical-align","middle"],[4,"ngIf"],[1,"box"],[1,"grid","grid-cols-12"],[1,"col-span-12","py-1",2,"text-align","end","padding-right","10px","cursor","context-menu"],[2,"color","#333333","vertical-align","middle","font-size","18px","width","18px","height","18px","cursor","pointer"],[2,"margin-bottom","0px",3,"startQuestionIndex","follower","isBackEnd","isMobile","examObj","question","index"],["appDrawNameImage","","class","img-fluid","loading","lazy","style","margin-top: 1px; margin-bottom: 1px",3,"nameImages",4,"ngIf","ngIfElse"],["showName",""],["class","mr-1",4,"ngIf"],["appDrawNameImage","","loading","lazy",1,"img-fluid",2,"margin-top","1px","margin-bottom","1px",3,"nameImages"],[1,"mb-0"],[1,"mr-1"]],template:function(e,n){1&e&&(t.YNc(0,Zv,7,6,"div",0),t.YNc(1,Mv,4,3,"div",1),t.YNc(2,Hv,6,3,"div",2)),2&e&&(t.Q6J("ngIf",1==n.isCheckData),t.xp6(1),t.Q6J("ngIf",1!=n.isCheckData),t.xp6(1),t.Q6J("ngIf",1!=n.isCheckData))},dependencies:[O.sg,O.O5,ge.Hw,ct,st,$n.L,Kn.$,O.JJ,at.bT,at.AS],styles:[".table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center;vertical-align:middle}"]}),o})();function Yv(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li",6)(1,"button",7),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw();return t.KtG(r.chooseTapClass(a))}),t._uU(2),t.qZA()()}if(2&o){const e=s.$implicit,n=s.index,i=t.oxw();t.xp6(1),t.Gre("nav-link w-full py-2 ",i.indexClassInArray==n?"active":"",""),t.xp6(1),t.hij(" ",null==e.classObj?null:e.classObj.name," ")}}function Gv(o,s){1&o&&(t.O4$(),t.kcU(),t.TgZ(0,"tbody")(1,"tr")(2,"td",22)(3,"p",23),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()()()()),2&o&&(t.xp6(4),t.hij("",t.lcZ(5,1,"lang_testbank_statistical_cant_had_student"),"."))}function $v(o,s){if(1&o&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.fullName)}}function Wv(o,s){if(1&o&&(t.TgZ(0,"td",28),t._UZ(1,"img",32),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.nameImage,t.LSH)}}function Kv(o,s){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.birthday,"dd/MM/yyyy"))}}function Vv(o,s){1&o&&(t._uU(0),t.ALo(1,"mytranslate")),2&o&&t.hij(" ",t.lcZ(1,1,"lang_testbank_statistical_student_cant_enter_birthday"),". ")}function Xv(o,s){1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_statistical_not_mark")," "))}function t2(o,s){1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_statistical_exam_progress")," "))}function e2(o,s){1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_statistical_exam_not_submit")," "))}function n2(o,s){1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_statistical_not_exem_yet")," "))}function i2(o,s){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.mark," ")}}function o2(o,s){if(1&o&&(t.TgZ(0,"tr")(1,"td",28),t._uU(2),t.qZA(),t.YNc(3,$v,2,1,"td",29),t.YNc(4,Wv,2,1,"td",29),t.TgZ(5,"td",28),t.YNc(6,Kv,3,4,"div",20),t.YNc(7,Vv,2,3,"ng-template",null,30,t.W1O),t.qZA(),t.TgZ(9,"td",31),t.YNc(10,Xv,3,3,"div",24),t.YNc(11,t2,3,3,"div",24),t.YNc(12,e2,3,3,"div",24),t.YNc(13,n2,3,3,"div",24),t.YNc(14,i2,2,1,"div",24),t.qZA()()),2&o){const e=s.$implicit,n=s.index,i=t.MAs(8);let a,r;t.xp6(2),t.Oqu(n+1),t.xp6(1),t.Q6J("ngIf",!e.nameImage||(null!==(a=e.id)&&void 0!==a?a:0)>0),t.xp6(1),t.Q6J("ngIf",e.nameImage&&(null!==(r=e.id)&&void 0!==r?r:0)<=0),t.xp6(2),t.Q6J("ngIf",null!=e.birthday)("ngIfElse",i),t.xp6(4),t.Q6J("ngIf",e.isNotMarked),t.xp6(1),t.Q6J("ngIf",e.isOnTest),t.xp6(1),t.Q6J("ngIf",e.isNotSubmit),t.xp6(1),t.Q6J("ngIf",e.isNotTested),t.xp6(1),t.Q6J("ngIf",e.isMarked)}}const ca=function(){return[]};function a2(o,s){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw(3);let n;t.xp6(1),t.hij(" ",t.Dn7(2,1,t.xi3(3,5,e.calcAvgClassroomMark(null!==(n=e.statisticObj[e.indexClassInArray].studentsWithMark)&&void 0!==n?n:t.DdM(8,ca)),"1.0-2"),",",".")," ")}}function s2(o,s){if(1&o&&(t.O4$(),t.kcU(),t.TgZ(0,"tbody"),t.YNc(1,o2,15,10,"tr",25),t.TgZ(2,"tr",26)(3,"td",27),t._uU(4),t.ALo(5,"mytranslate"),t.qZA(),t.TgZ(6,"td",28),t.YNc(7,a2,4,9,"div",24),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",null==e.statisticObj[e.indexClassInArray]?null:e.statisticObj[e.indexClassInArray].studentsWithMark),t.xp6(3),t.Oqu(t.lcZ(5,3,"lang_testbank_statistical_avg_max_point")),t.xp6(3),t.Q6J("ngIf",e.statisticObj.length>0&&e.statisticObj[e.indexClassInArray])}}function r2(o,s){if(1&o&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.fullName)}}function l2(o,s){if(1&o&&(t.TgZ(0,"td",28),t._UZ(1,"img",33),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("nameImages",e.nameImages)}}function c2(o,s){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.birthday,"dd/MM/yyyy"))}}function _2(o,s){1&o&&(t._uU(0),t.ALo(1,"mytranslate")),2&o&&t.hij(" ",t.lcZ(1,1,"lang_testbank_statistical_student_cant_enter_birthday"),". ")}function d2(o,s){1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_statistical_not_mark")," "))}function u2(o,s){1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_statistical_exam_progress")," "))}function m2(o,s){1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_statistical_exam_not_submit")," "))}function h2(o,s){1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_statistical_not_exem_yet")," "))}function p2(o,s){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.mark," ")}}function g2(o,s){if(1&o&&(t.TgZ(0,"tr")(1,"td",28),t._uU(2),t.qZA(),t.YNc(3,r2,2,1,"td",29),t.YNc(4,l2,2,1,"td",29),t.TgZ(5,"td",28),t.YNc(6,c2,3,4,"div",20),t.YNc(7,_2,2,3,"ng-template",null,30,t.W1O),t.qZA(),t.TgZ(9,"td",31),t.YNc(10,d2,3,3,"div",24),t.YNc(11,u2,3,3,"div",24),t.YNc(12,m2,3,3,"div",24),t.YNc(13,h2,3,3,"div",24),t.YNc(14,p2,2,1,"div",24),t.qZA()()),2&o){const e=s.$implicit,n=s.index,i=t.MAs(8);t.xp6(2),t.Oqu(n+1),t.xp6(1),t.Q6J("ngIf",!e.nameImages||!e.nameImages.url),t.xp6(1),t.Q6J("ngIf",e.nameImages&&e.nameImages.url),t.xp6(2),t.Q6J("ngIf",null!=e.birthday)("ngIfElse",i),t.xp6(4),t.Q6J("ngIf",e.isNotMarked),t.xp6(1),t.Q6J("ngIf",e.isOnTest),t.xp6(1),t.Q6J("ngIf",e.isNotSubmit),t.xp6(1),t.Q6J("ngIf",e.isNotTested),t.xp6(1),t.Q6J("ngIf",e.isMarked)}}function f2(o,s){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.hij(" ",t.Dn7(2,1,t.xi3(3,5,e.calcAvgClassroomMark(e.freeStudentList||t.DdM(8,ca)),"1.0-2"),",",".")," ")}}function x2(o,s){if(1&o&&(t.O4$(),t.kcU(),t.TgZ(0,"tbody"),t.YNc(1,g2,15,10,"tr",25),t.TgZ(2,"tr",26)(3,"td",27),t._uU(4),t.ALo(5,"mytranslate"),t.qZA(),t.TgZ(6,"td",28),t.YNc(7,f2,4,9,"div",24),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.freeStudentList),t.xp6(3),t.Oqu(t.lcZ(5,3,"lang_testbank_statistical_avg_max_point")),t.xp6(3),t.Q6J("ngIf",e.freeStudentList.length>0)}}function v2(o,s){if(1&o&&(t.O4$(),t.YNc(0,s2,8,5,"tbody",24),t.YNc(1,x2,8,5,"tbody",24)),2&o){const e=t.oxw();t.Q6J("ngIf",e.indexClassInArray>-1),t.xp6(1),t.Q6J("ngIf",-1==e.indexClassInArray)}}let b2=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_){super(i),this.statisticalApiService=e,this.dialog=n,this.commonService=i,this.activeRoute=a,this.sortService=r,this.globalService=l,this.testedListApiService=c,this.homeworkExamService=_,this.viewType=-1,this.doneLoadingEmit=new t.vpe,this.examId=0,this.indexClassInArray=0,this.statisticObj=[],this.statisticObjClone=[],this.isCheckData=!1,this.hasEssayQuestion=!1,this.examObj={},this.freeStudentList=[],this.checkSortObj={numberIndex:!1,fullName:!1,point:!1}}chooseTapClass(e){this.indexClassInArray=e}getDataStatistic(e,n){this.initStatusObj(),this.statisticalApiService.getExamStatisticObjs("statistic_score",e,n).subscribe(i=>{var a,r,l,c,_,d,m;if(1==i.success&&i.data){this.examObj=null!==(a=i.data.examObj)&&void 0!==a?a:{},this.hasEssayQuestion=this.homeworkExamService.hasEssayInExam(null!==(r=this.examObj.examType)&&void 0!==r?r:0);var p=i.data.classroomObjsWithStudentObjs&&i.data.classroomObjsWithStudentObjs.length>0?i.data.classroomObjsWithStudentObjs:new Array,w=(null===(l=i.data)||void 0===l?void 0:l.resultObjs)&&(null===(c=i.data)||void 0===c?void 0:c.resultObjs.length)>0?i.data.resultObjs:new Array,C=this.testedListApiService.mergeStudentWithAvatar(null!=w?w:[]),A=[],M={};null==C||C.forEach(W=>{var P,R,N=null!==(P=W.parentId)&&void 0!==P?P:"0";M.hasOwnProperty(N)||(M[N]=null!==(R=W.examResultObjs)&&void 0!==R?R:[]),A=A.concat(M[N])});var D=this.testedListApiService.filterExamResultOnTest(A,this.examObj,null!==(_=i.data.curServerTime)&&void 0!==_?_:0),q=[],F=[];if(this.homeworkExamService.mustInClassroom(null!==(d=this.examObj.whoAllow)&&void 0!==d?d:0)&&p.length>0){var tt=[];p.forEach(W=>{var P,R=[];null===(P=W.studentObjs)||void 0===P||P.forEach(N=>{var B,z,X,V,J,et,ot,ut,lt={};tt.push(null!==(B=N.parentId)&&void 0!==B?B:"0");var rt=null!==(z=N.parentId)&&void 0!==z?z:"0";if(M.hasOwnProperty(rt)&&(Array.isArray(N.examResultObjs)||(N.examResultObjs=[]),N.examResultObjs=this.statisticalApiService.findExamResultOfStudent(null!==(J=null===(X=N.examResultObjs)||void 0===X?void 0:X.concat(null!==(V=M[rt])&&void 0!==V?V:[]))&&void 0!==J?J:[],null!==(et=N.id)&&void 0!==et?et:0)),N.examResultObjs&&N.examResultObjs.length>0){var xt=N.examResultObjs[N.examResultObjs.length-1];lt=null!=xt?xt:{}}var ht=D.hasOwnProperty(null!==(ot=lt.userId)&&void 0!==ot?ot:"0")?D[null!==(ut=lt.userId)&&void 0!==ut?ut:"0"]:0,gt=lt.mark?lt.mark:0,dt=lt.id&&ht>0?lt.id:0,yt=lt.startedTest?lt.startedTest:null,bt=lt.confirmedAt?lt.confirmedAt:null,At=Object.assign(Object.assign({},N),{mark:gt,resultId:dt,startedTest:yt,confirmedAt:bt,status:ht});R.push(At)}),q.push({classObj:W.classroomObj,studentsWithMark:R})})}w.forEach(W=>{var P,R,N,B,z,X,V={};if(!this.commonService.filterArray(tt,null!==(P=W.parentId)&&void 0!==P?P:"0")){if(W.examResultObjs&&W.examResultObjs.length>0){var J=this.statisticalApiService.findExamResultOfStudent(W.examResultObjs,null!==(R=W.id)&&void 0!==R?R:0);V=J[J.length-1]}var ot=D.hasOwnProperty(null!==(N=V.userId)&&void 0!==N?N:"0")?D[null!==(B=V.userId)&&void 0!==B?B:"0"]:0,ut=V.mark?V.mark:0,lt=V.id&&ot>0?V.id:0,rt=V.startedTest?V.startedTest:null,xt=V.confirmedAt?V.confirmedAt:null,ht=Object.assign(Object.assign({},W),{mark:ut,resultId:lt,startedTest:rt,confirmedAt:xt,nameImages:null!==(z=W.nameImages)&&void 0!==z?z:{},nameImage:"",status:ot});let gt=this.commonService.myTranslateIntance("lang_auto_thi_sinh_thi_offline");ht.fullName=null!==(X=ht.fullName)&&void 0!==X?X:gt+"_"+lt,F.push(ht)}}),this.readyData(q,F),this.statisticObjClone=this.commonService.myClone(this.statisticObj)}else this.doneLoadingEmit.emit(!1),this.showErrorSnack(null!==(m=i.message)&&void 0!==m?m:"")})}readyData(e,n){var i,a,r,l,c;this.statisticObj=null!=e?e:new Array,this.freeStudentList=this.checkStatusStudent(this.sortService.sortFirstNameStudents(n));for(let _=0;_<this.freeStudentList.length;_++)this.freeStudentList[_].isMarked||(this.freeStudentList[_].mark=-1);for(let _=0;_<this.statisticObj.length;_++)if(this.statisticObj[_].studentsWithMark=this.statisticObj[_].classObj&&0==(null===(i=this.statisticObj[_].classObj)||void 0===i?void 0:i.sortType)?this.checkStatusStudent(this.sortService.sortFirstNameStudents(null!==(a=this.commonService.myClone(this.statisticObj[_].studentsWithMark))&&void 0!==a?a:[])):this.checkStatusStudent(this.sortService.sortArrayByMultipleObjectKeyAsc(null!==(r=this.commonService.myClone(this.statisticObj[_].studentsWithMark))&&void 0!==r?r:[],"pos","id")),this.statisticObj[_].studentsWithMark)for(let d=0;d<(null!==(c=null===(l=this.statisticObj[_].studentsWithMark)||void 0===l?void 0:l.length)&&void 0!==c?c:0);d++)this.statisticObj[_].studentsWithMark[d].isMarked||(this.statisticObj[_].studentsWithMark[d].mark=-1);this.doneLoadingEmit.emit(!0),this.successStatusObj()}checkStatusStudent(e){var n=[];return e.forEach(i=>{this.hasEssayQuestion?i.confirmedAt&&""!=i.confirmedAt&&i.resultId&&i.resultId>0?i.isMarked=!0:i.resultId&&i.resultId>0&&(!i.confirmedAt||""==i.confirmedAt)?i.isNotMarked=!0:i.resultId&&0!=i.resultId||!i.startedTest||""==i.startedTest||0!=i.status?i.resultId&&0!=i.resultId||!i.startedTest||""==i.startedTest||-1!=i.status?null==i.startedTest&&(i.isNotTested=!0):i.isNotSubmit=!0:i.isOnTest=!0:i.resultId&&i.resultId>0?i.isMarked=!0:i.resultId&&0!=i.resultId||!i.startedTest||""==i.startedTest||0!=i.status?i.resultId&&0!=i.resultId||!i.startedTest||""==i.startedTest||-1!=i.status?null==i.startedTest&&(i.isNotTested=!0):i.isNotSubmit=!0:i.isOnTest=!0,n.push(i)}),n}calcAvgClassroomMark(e){var n=0,i=0;return e.forEach(a=>{var r;a.isMarked&&(n++,i+=null!==(r=a.mark)&&void 0!==r?r:0)}),n>0?(i/n).toFixed(2):0}goToStudentList(e){var n,i;let a=`/admin/testbank/statistic/${null!==(n=this.examObj.categoryId)&&void 0!==n?n:0}/${this.examObj.id}`;this.commonService.myNavigationWithQueryString(`/admin/student/class-details/${null===(i=e.classObj)||void 0===i?void 0:i.id}`,"?backto="+encodeURIComponent(a))}sortFullNameStudent(e){var n,i;this.checkSortObj.fullName=!this.checkSortObj.fullName,-1==e?this.freeStudentList=this.checkSortObj.fullName?this.sortService.sortFirstNameStudents(this.freeStudentList):this.sortService.sortFirstNameStudents(this.freeStudentList).reverse():this.statisticObj[e].studentsWithMark=this.checkSortObj.fullName?this.sortService.sortFirstNameStudents(null!==(n=this.statisticObj[e].studentsWithMark)&&void 0!==n?n:[]):this.sortService.sortFirstNameStudents(null!==(i=this.statisticObj[e].studentsWithMark)&&void 0!==i?i:[]).reverse()}sortStudentByPoint(e){var n,i;this.checkSortObj.point=!this.checkSortObj.point,-1==e?this.freeStudentList=this.checkSortObj.point?this._sortByPoint(this.freeStudentList):this._sortByPoint(this.freeStudentList).reverse():this.statisticObj[e].studentsWithMark=this.checkSortObj.point?this._sortByPoint(null!==(n=this.statisticObj[e].studentsWithMark)&&void 0!==n?n:[]):this._sortByPoint(null!==(i=this.statisticObj[e].studentsWithMark)&&void 0!==i?i:[]).reverse()}_sortByPoint(e){return e.sort((n,i)=>Number(n.mark)-Number(i.mark)),e}ngOnInit(){(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var e;this.examId=null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"id")))&&void 0!==e?e:0,this.getDataStatistic(this.examId,"Mark")}),super.ngOnInit()}ngOnDestroy(){this.globalService.stopIntervalFunc("statistic_score"),super.ngOnDestroy()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Ai),t.Y36(j.uw),t.Y36(vt.v),t.Y36(x.gz),t.Y36(pn.K),t.Y36(jn.U),t.Y36(Fn),t.Y36(yn.j))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-table-score"]],inputs:{viewType:"viewType"},outputs:{doneLoadingEmit:"doneLoadingEmit"},features:[t.qOj],decls:46,vars:24,consts:[[1,"intro-y","block","sm:flex","items-center"],[1,"text-lg","font-medium","truncate","mr-5"],[1,"report-box","intro-x","mt-5"],[1,"box","p-5"],["role","tablist",1,"nav","nav-link-tabs",2,"overflow-x","auto"],["id","example-5-tab","class","nav-item flex-1","role","presentation",4,"ngFor","ngForOf"],["id","example-5-tab","role","presentation",1,"nav-item","flex-1"],["data-tw-toggle","pill","data-tw-target","#example-tab-5","type","button","role","tab","aria-controls","example-tab-5","aria-selected","true",3,"click"],[1,"tab-content","overflow-x-auto","mt-5"],["id","example-tab-5","role","tabpanel","aria-labelledby","example-5-tab",1,"tab-pane","leading-relaxed","active"],[1,"intro-x","table","table-bordered"],[1,"bg-slate-100","dark:bg-darkmode-400"],[1,"whitespace-nowrap"],[1,"flex","items-center","justify-center"],[1,"flex","items-center","justify-center",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-5","h-5","ml-1","inline-block"],["points","11 17 7 21 3 17"],["x1","7","y1","21","x2","7","y2","9"],["points","21 7 17 3 13 7"],["x1","17","y1","15","x2","17","y2","3"],[4,"ngIf","ngIfElse"],["table",""],["colspan","4"],[1,"text-center","font-weight-bold","p-0","m-0"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"font-medium","text-center"],["colspan","3",2,"text-align","center","vertical-align","middle"],[2,"text-align","center","vertical-align","middle"],["style","text-align: center; vertical-align: middle",4,"ngIf"],["birthday",""],[1,"text-center",2,"text-align","center","vertical-align","middle"],[1,"img-fluid",3,"src"],["appDrawNameImage","","loading","lazy",1,"img-fluid",3,"nameImages"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"h3",1),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()(),t.TgZ(4,"div",2)(5,"div",3)(6,"ul",4),t.YNc(7,Yv,3,4,"li",5),t.TgZ(8,"li",6)(9,"button",7),t.NdJ("click",function(){return n.chooseTapClass(-1)}),t._uU(10),t.ALo(11,"mytranslate"),t.qZA()()(),t.TgZ(12,"div",8)(13,"div",9)(14,"table",10)(15,"thead",11)(16,"tr")(17,"th",12)(18,"div",13),t._uU(19),t.ALo(20,"mytranslate"),t.qZA()(),t.TgZ(21,"th",12)(22,"div",14),t.NdJ("click",function(){return n.sortFullNameStudent(n.indexClassInArray)}),t._uU(23),t.ALo(24,"mytranslate"),t.O4$(),t.TgZ(25,"svg",15),t._UZ(26,"polyline",16)(27,"line",17)(28,"polyline",18)(29,"line",19),t.qZA()()(),t.kcU(),t.TgZ(30,"th",12)(31,"div",13),t._uU(32),t.ALo(33,"mytranslate"),t.qZA()(),t.TgZ(34,"th",12)(35,"div",14),t.NdJ("click",function(){return n.sortStudentByPoint(n.indexClassInArray)}),t._uU(36),t.ALo(37,"mytranslate"),t.O4$(),t.TgZ(38,"svg",15),t._UZ(39,"polyline",16)(40,"line",17)(41,"polyline",18)(42,"line",19),t.qZA()()()()(),t.YNc(43,Gv,6,3,"tbody",20),t.YNc(44,v2,2,2,"ng-template",null,21,t.W1O),t.qZA()()()()()),2&e){const i=t.MAs(45);t.xp6(2),t.hij(" ",t.lcZ(3,12,"lang_auto_bang_diem")," "),t.xp6(5),t.Q6J("ngForOf",n.statisticObj),t.xp6(2),t.Gre("nav-link w-full py-2 ",-1==n.indexClassInArray?"active":"",""),t.xp6(1),t.hij(" ",t.lcZ(11,14,"lang_auto_tu_do")," "),t.xp6(9),t.hij(" ",t.lcZ(20,16,"lang_auto_STT")," "),t.xp6(4),t.hij(" ",t.lcZ(24,18,"lang_first_and_last_name")," "),t.xp6(9),t.hij(" ",t.lcZ(33,20,"lang_birthday")," "),t.xp6(4),t.hij(" ",t.lcZ(37,22,"lang_point")," "),t.xp6(7),t.Q6J("ngIf",n.indexClassInArray>-1&&n.statisticObj.length>0&&0==(null==n.statisticObj[n.indexClassInArray].studentsWithMark?null:n.statisticObj[n.indexClassInArray].studentsWithMark.length)||-1==n.indexClassInArray&&0==n.freeStudentList.length)("ngIfElse",i)}},dependencies:[O.sg,O.O5,$n.L,O.JJ,O.uU,at.bT,at.AS],styles:["td[_ngcontent-%COMP%]{vertical-align:middle!important}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center;vertical-align:middle!important}.link-stu[_ngcontent-%COMP%]:hover{color:#007bff}.block-center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.sort-icon[_ngcontent-%COMP%]{margin-top:4px;margin-left:4px}th[_ngcontent-%COMP%]{background:#2361ae;color:#fff;font-weight:400}.text-weight-500[_ngcontent-%COMP%]{font-weight:500}"]}),o})();var pt=b(83321);function w2(o,s){1&o&&(t.O4$(),t.TgZ(0,"svg",19),t._UZ(1,"path",20)(2,"polyline",21)(3,"path",22)(4,"path",23)(5,"path",24)(6,"path",25),t.qZA())}function T2(o,s){1&o&&(t.TgZ(0,"span"),t._UZ(1,"span",26),t._uU(2,"\xa0"),t.qZA())}function C2(o,s){1&o&&(t.TgZ(0,"div",27),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_testbank_statistical_export_file_excel_success")))}function A2(o,s){1&o&&(t.TgZ(0,"div",28),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_testbank_statistical_export_file_excel_error")))}let y2=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_,d,m,p,w,C){super(a),this.statisticalApiService=e,this.testedListApiService=n,this.dialog=i,this.commonService=a,this.activeRoute=r,this.fb=l,this.sortService=c,this.homeworkExamService=_,this.globalService=d,this._decimalPipe=m,this.dictionaryService=p,this.answerTypeService=w,this.mobileWebviewService=C,this.viewType=-1,this.form=new h.nJ({}),this.keyColExcelArr=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],this.examId=-1,this.examObj={},this.limitQuestions=0,this.loadingDownload=!1,this.isExportSuccess=void 0,this.isOnApp=!1,this.style_first={border:{top:{style:"thin",color:{rgb:"ff3c8dbc"}},bottom:{style:"thin",color:{rgb:"ff3c8dbc"}},left:{style:"thin",color:{rgb:"ffffffff"}},right:{style:"thin",color:{rgb:"ffffffff"}},diagonal:{style:"thin",color:{rgb:"ffffffff"}},diagonalDown:!0},alignment:{vertical:"center",horizontal:"left",wrapText:!0},font:{sz:11,bold:!0,color:{rgb:"ffffffff"}},fill:{patternType:"solid",fgColor:{rgb:"ff3c8dbc"}}},this.style_header={border:{top:{style:"thin",color:{rgb:"ff3c8dbc"}},bottom:{style:"thin",color:{rgb:"ff3c8dbc"}},left:{style:"thin",color:{rgb:"ffffffff"}},right:{style:"thin",color:{rgb:"ffffffff"}}},alignment:{vertical:"center",horizontal:"center",wrapText:!0},font:{sz:11,bold:!0,color:{rgb:"ffffffff"}},fill:{patternType:"solid",fgColor:{rgb:"2361ae"}}},this.style_body={border:{top:{style:"thin",color:{rgb:"ff757575"}},bottom:{style:"thin",color:{rgb:"ff757575"}},left:{style:"thin",color:{rgb:"ff757575"}},right:{style:"thin",color:{rgb:"ff757575"}}},alignment:{vertical:"center",horizontal:"center",wrapText:!0}},this.style_footer={border:{top:{style:"thin",color:{rgb:"ff757575"}},bottom:{style:"thin",color:{rgb:"ff757575"}},left:{style:"thin",color:{rgb:"ff757575"}},right:{style:"thin",color:{rgb:"ff757575"}}},alignment:{vertical:"center",horizontal:"center",wrapText:!0},font:{sz:11,bold:!0},fill:{patternType:"solid",fgColor:{rgb:"ffffffff"}}},this.statisticalLoaded=!1,this.listquestionLoaded=!1,this.tablescoreLoaded=!1,this.wb=pt.utils.book_new(),this.Statistic={},this.ListQuest={},this.TableScore={}}exportExcel(){let e=this.commonService.getFormObj(this.form);if(0==e.statisticalCheck&&0==e.listquestionCheck&&0==e.tablescoreCheck){let n=this.commonService.myTranslateIntance("lang_auto_khong_the_de_trong_tat_ca_cac_lua_chon_dot");alert(n)}else this.loadingDownload=!0,this.isExportSuccess=void 0,this.getData(this.examId).then(n=>{setTimeout(()=>{var i,a,r,l,c,_,d,m;if(1==n){e.statisticalCheck&&this.AddStatisticToSheet(null!==(i=this.Statistic.statisticClass)&&void 0!==i?i:[],null!==(a=this.Statistic.statisticNoClass)&&void 0!==a?a:[]),e.tablescoreCheck&&this.AddTableScoreToSheet(null!==(r=this.TableScore.statisticClass)&&void 0!==r?r:[],null!==(l=this.TableScore.statisticNoClass)&&void 0!==l?l:[]),e.listquestionCheck&&this.AddListQuestionToSheet(null!==(c=this.ListQuest.attended)&&void 0!==c?c:0,null!==(_=this.ListQuest.listQuestions)&&void 0!==_?_:[],null!==(d=this.ListQuest.listClassStatistic)&&void 0!==d?d:[]);try{var p=pt.write(this.wb,{bookType:"xlsx",bookSST:!0,type:"base64"}),w="";null!=this.examObj?(w=this.commonService.createFileNameExportFile(["Thong ke de thi",null!==(m=this.examObj.name)&&void 0!==m?m:""])+".xlsx",pt.writeFile(this.wb,w)):(w=this.commonService.createFileNameExportFile(["Thong ke de thi"])+".xlsx",pt.writeFile(this.wb,w)),this.mobileWebviewService.sendExportExcelBase64(w,p),this.isExportSuccess=!0,this.loadingDownload=!1,this.wb=pt.utils.book_new()}catch(C){console.log(C),this.isExportSuccess=!1,this.loadingDownload=!1,this.wb=pt.utils.book_new()}}else this.isExportSuccess=!1,this.loadingDownload=!1,this.wb=pt.utils.book_new()},0)})}AddStatisticToSheet(e,n){var i,a,r,l,c,_;let d=null!==(i=this.commonService.myTranslateIntance("lang_auto_lop"))&&void 0!==i?i:"",m=null!==(a=this.commonService.myTranslateIntance("lang_auto_so_hoc_sinh"))&&void 0!==a?a:"",p=null!==(r=this.commonService.myTranslateIntance("lang_auto_tren_tb"))&&void 0!==r?r:"(>5)",w=null!==(l=this.commonService.myTranslateIntance("lang_auto_dang_ky"))&&void 0!==l?l:"",C=null!==(c=this.commonService.myTranslateIntance("lang_auto_du_thi"))&&void 0!==c?c:"",M=1,D=pt.utils.json_to_sheet([{A:d,B:m,C:"",D:"<=1",E:"",F:"<=2",G:"",H:"<=3",I:"",J:"<=4",K:"",L:"<=5",M:"",N:"<=6",O:"",P:"<=7",Q:"",R:"<=8",S:"",T:"<=9",U:"",V:"<=10",W:"",X:p,Y:""},{A:"",B:w,C,D:"SL",E:"%",F:"SL",G:"%",H:"SL",I:"%",J:"SL",K:"%",L:"SL",M:"%",N:"SL",O:"%",P:"SL",Q:"%",R:"SL",S:"%",T:"SL",U:"%",V:"SL",W:"%",X:"SL",Y:"%"}],{skipHeader:!0});const q_e_c=24;for(let N=0;N<=q_e_c;++N)D[pt.utils.encode_cell({c:N,r:0})].s=this.style_header;if(null==e&&null==n){let N=null!==(_=this.commonService.myTranslateIntance("lang_auto_chua_co_du_lieu_thong_ke"))&&void 0!==_?_:"";pt.utils.sheet_add_json(D,[{A:N}],{skipHeader:!0,origin:-1})}else{null!=e&&e.forEach(J=>{null!=J.classObj&&(pt.utils.sheet_add_json(D,[{A:J.classObj.name,B:J.registerCount,C:J.testedCount,D:J.markPercent[0].count,E:this._decimalPipe.transform(J.markPercent[0].percent,"1.0-2"),F:J.markPercent[1].count,G:this._decimalPipe.transform(J.markPercent[1].percent,"1.0-2"),H:J.markPercent[2].count,I:this._decimalPipe.transform(J.markPercent[2].percent,"1.0-2"),J:J.markPercent[3].count,K:this._decimalPipe.transform(J.markPercent[3].percent,"1.0-2"),L:J.markPercent[4].count,M:this._decimalPipe.transform(J.markPercent[4].percent,"1.0-2"),N:J.markPercent[5].count,O:this._decimalPipe.transform(J.markPercent[5].percent,"1.0-2"),P:J.markPercent[6].count,Q:this._decimalPipe.transform(J.markPercent[6].percent,"1.0-2"),R:J.markPercent[7].count,S:this._decimalPipe.transform(J.markPercent[7].percent,"1.0-2"),T:J.markPercent[8].count,U:this._decimalPipe.transform(J.markPercent[8].percent,"1.0-2"),V:J.markPercent[9].count,W:this._decimalPipe.transform(J.markPercent[9].percent,"1.0-2"),X:J.markPercent[10].count,Y:this._decimalPipe.transform(J.markPercent[10].percent,"1.0-2")}],{skipHeader:!0,origin:-1}),M++)}),null!=n&&n.forEach(J=>{var et;if((null!==(et=J.registerCount)&&void 0!==et?et:0)>0){let ot=this.commonService.myTranslateIntance("lang_auto_thi_sinh_tu_do");pt.utils.sheet_add_json(D,[{A:ot,B:J.registerCount,C:J.testedCount,D:J.markPercent[0].count,E:this._decimalPipe.transform(J.markPercent[0].percent,"1.0-2"),F:J.markPercent[1].count,G:this._decimalPipe.transform(J.markPercent[1].percent,"1.0-2"),H:J.markPercent[2].count,I:this._decimalPipe.transform(J.markPercent[2].percent,"1.0-2"),J:J.markPercent[3].count,K:this._decimalPipe.transform(J.markPercent[3].percent,"1.0-2"),L:J.markPercent[4].count,M:this._decimalPipe.transform(J.markPercent[4].percent,"1.0-2"),N:J.markPercent[5].count,O:this._decimalPipe.transform(J.markPercent[5].percent,"1.0-2"),P:J.markPercent[6].count,Q:this._decimalPipe.transform(J.markPercent[6].percent,"1.0-2"),R:J.markPercent[7].count,S:this._decimalPipe.transform(J.markPercent[7].percent,"1.0-2"),T:J.markPercent[8].count,U:this._decimalPipe.transform(J.markPercent[8].percent,"1.0-2"),V:J.markPercent[9].count,W:this._decimalPipe.transform(J.markPercent[9].percent,"1.0-2"),X:J.markPercent[10].count,Y:this._decimalPipe.transform(J.markPercent[10].percent,"1.0-2")}],{skipHeader:!0,origin:-1}),M++}});let N=this.totalPoint(e,n),B=this.totalPercent(e,n),z=this.totalStudentRegister(e,n),X=this.totalStudentTakeExam(e,n),V=this.commonService.myTranslateIntance("lang_auto_tong_upper");pt.utils.sheet_add_json(D,[{A:V,B:z,C:X,D:N[0],E:this._decimalPipe.transform(B[0],"1.0-2"),F:N[1],G:this._decimalPipe.transform(B[1],"1.0-2"),H:N[2],I:this._decimalPipe.transform(B[2],"1.0-2"),J:N[3],K:this._decimalPipe.transform(B[3],"1.0-2"),L:N[4],M:this._decimalPipe.transform(B[4],"1.0-2"),N:N[5],O:this._decimalPipe.transform(B[5],"1.0-2"),P:N[6],Q:this._decimalPipe.transform(B[6],"1.0-2"),R:N[7],S:this._decimalPipe.transform(B[7],"1.0-2"),T:N[8],U:this._decimalPipe.transform(B[8],"1.0-2"),V:N[9],W:this._decimalPipe.transform(B[9],"1.0-2"),X:N[10],Y:this._decimalPipe.transform(B[10],"1.0-2")}],{skipHeader:!0,origin:-1}),M++}D["!cols"]=[{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9},{width:9}],D["!rows"]=[{hpt:28},{hpt:27}],D["!merges"]=[{s:{r:0,c:1},e:{r:0,c:2}},{s:{r:0,c:3},e:{r:0,c:4}},{s:{r:0,c:5},e:{r:0,c:6}},{s:{r:0,c:7},e:{r:0,c:8}},{s:{r:0,c:9},e:{r:0,c:10}},{s:{r:0,c:11},e:{r:0,c:12}},{s:{r:0,c:13},e:{r:0,c:14}},{s:{r:0,c:15},e:{r:0,c:16}},{s:{r:0,c:17},e:{r:0,c:18}},{s:{r:0,c:19},e:{r:0,c:20}},{s:{r:0,c:21},e:{r:0,c:22}},{s:{r:0,c:23},e:{r:0,c:24}}];let W_s_c=0,W_e_c=24,W_e_r=M-1,P_s_c=0,P_e_c=24;for(let N=1;N<=W_e_r;++N)for(let B=W_s_c;B<=W_e_c;++B)D[pt.utils.encode_cell({c:B,r:N})].s=this.style_body;for(let N=P_s_c;N<=P_e_c;++N)D[pt.utils.encode_cell({c:N,r:M})].s=this.style_footer;let R=this.commonService.myTranslateIntance("lang_auto_thong_ke_pho_diem");pt.utils.book_append_sheet(this.wb,D,R)}AddTableScoreToSheet(e,n){var i,a,r,l,c,_,d,m,p,w,C,A,M,D,q;let U=null!==(i=this.commonService.myTranslateIntance("lang_auto_stt"))&&void 0!==i?i:"",F=null!==(a=this.commonService.myTranslateIntance("lang_auto_ho_va_ten"))&&void 0!==a?a:"",tt=null!==(r=this.commonService.myTranslateIntance("lang_auto_gioi_tinh"))&&void 0!==r?r:"",W=null!==(l=this.commonService.myTranslateIntance("lang_auto_ma_hoc_sinh"))&&void 0!==l?l:"",P=null!==(c=this.commonService.myTranslateIntance("lang_auto_ngay_sinh"))&&void 0!==c?c:"",R=null!==(_=this.commonService.myTranslateIntance("lang_point"))&&void 0!==_?_:"",N=this.commonService.myTranslateIntance("lang_auto_cau");if(0==e.length&&0==n.length){let et=this.commonService.myTranslateIntance("lang_auto_chua_co_hoc_sinh_thanh_gia_lam_de"),ot=this.commonService.myTranslateIntance("lang_auto_bang_diem");q=pt.utils.json_to_sheet([{A:et,B:"",C:"",D:"",E:"",F:""}],{skipHeader:!0}),pt.utils.book_append_sheet(this.wb,q,ot)}else{var B=[{width:8},{width:22},{width:34},{width:13},{width:13},{width:13}];for(let ot=0;ot<this.limitQuestions;ot++)B.push({width:13});var z=[{s:{r:0,c:0},e:{r:0,c:5}}],X=0,V=[],J=[];if(q=pt.utils.json_to_sheet([{A:""}],{skipHeader:!0}),0!=e.length&&e.forEach(ot=>{var ut,lt,rt,xt,ht,gt,dt,yt,bt,At,kt,Qt;let Bt=[{A:null===(ut=ot.classObj)||void 0===ut?void 0:ut.name,B:"",C:"",D:"",E:"",F:""},{A:U,B:F,C:P,D:tt,E:W,F:R}],Gt=6,ne=0,ae=0;for(let ie=0;ie<this.limitQuestions;ie++){Gt>=26&&(Gt=0,ne++);let $t="";0==ne&&0==ae?$t=this.keyColExcelArr[Gt]:(ne>26&&(ne=1,ae++),ae>0&&($t+=this.keyColExcelArr[ae-1]),$t+=this.keyColExcelArr[ne-1]+""+this.keyColExcelArr[Gt]),Bt[0][$t]="",Bt[1][$t]=N+" "+(ie<9?"0"+(ie+1):ie+1),Gt++}if(V.push(X+=2),z.push({s:{r:X-1,c:0},e:{r:X-1,c:5}}),q=pt.utils.sheet_add_json(q,Bt,{skipHeader:!0,origin:-1}),0==(null===(lt=ot.studentsWithMark)||void 0===lt?void 0:lt.length)){let $t=[{A:this.commonService.myTranslateIntance("lang_auto_chua_co_hoc_sinh_du_thi"),B:"",C:"",D:"",E:"",F:""}];z.push({s:{r:X+1,c:0},e:{r:X+1,c:5}}),pt.utils.sheet_add_json(q,$t,{skipHeader:!0,origin:-1}),X++}else{let ie=null!==(rt=this.commonService.myTranslateIntance("lang_auto_chua_cham"))&&void 0!==rt?rt:"",$t=null!==(xt=this.commonService.myTranslateIntance("lang_auto_dang_thi"))&&void 0!==xt?xt:"",be=null!==(ht=this.commonService.myTranslateIntance("lang_auto_chua_nop_bai"))&&void 0!==ht?ht:"",Ce=null!==(gt=this.commonService.myTranslateIntance("lang_auto_chua_thi"))&&void 0!==gt?gt:"",Ae=null!==(dt=this.commonService.myTranslateIntance("lang_auto_hoc_sinh_chua_nhap_ngay_sinh"))&&void 0!==dt?dt:"",Se=null!==(yt=this.commonService.myTranslateIntance("lang_auto_nam"))&&void 0!==yt?yt:"",Pe=null!==(bt=this.commonService.myTranslateIntance("lang_auto_nu"))&&void 0!==bt?bt:"";null===(At=ot.studentsWithMark)||void 0===At||At.forEach((Yt,sn)=>{var He,ze;let ye,rn=new O.uU("en-US").transform(Yt.birthday,"dd/MM/yyyy");ye=Yt.isNotMarked?ie:Yt.isOnTest?$t:Yt.isNotSubmit?be:Yt.isNotTested?Ce:null!==(He=Yt.mark)&&void 0!==He?He:"",X++;let qe=[{A:sn+1,B:Yt.fullName,C:null==Yt.birthday?Ae:`${rn}`,D:`${1==Yt.gender?Se:Pe}`,E:`${Yt.code?Yt.code:""}`,F:`${ye}`}];if(Yt.answeredQuestions){let Qe=6,Le=0,Ne=0;for(let Ye=0;Ye<(null===(ze=Yt.answeredQuestions)||void 0===ze?void 0:ze.length);Ye++){Qe>=26&&(Qe=0,Le++);let Ue="";0==Le&&0==Ne?Ue=this.keyColExcelArr[Qe]:(Le>26&&(Le=1,Ne++),Ne>0&&(Ue+=this.keyColExcelArr[Ne-1]),Ue+=this.keyColExcelArr[Le-1]+""+this.keyColExcelArr[Qe]),qe[0][Ue]=this.checkAnswerQuestionTableExport(Yt.answeredQuestions[Ye]),Qe++}}pt.utils.sheet_add_json(q,qe,{skipHeader:!0,origin:-1})})}let Jt=null!==(kt=this.commonService.myTranslateIntance("lang_auto_diem_trung_binh"))&&void 0!==kt?kt:"";pt.utils.sheet_add_json(q,[{A:Jt,B:"",C:"",D:"",E:"",F:this.calcAvgClassroomMark(null!==(Qt=ot.studentsWithMark)&&void 0!==Qt?Qt:[])}],{skipHeader:!0,origin:-1}),J.push(X+1),z.push({s:{r:(X+=3)-2,c:0},e:{r:X-2,c:4}}),pt.utils.sheet_add_json(q,[{A:"",B:"",C:"",D:"",E:"",F:""},{A:"",B:"",C:"",D:"",E:"",F:""}],{skipHeader:!0,origin:-1})}),0!=n.length){let ot=this.commonService.myTranslateIntance("lang_auto_danh_sach_hoc_sinh_da_tham_gia_nhung_chua_chon_lop"),ut=[{A:ot,B:"",C:"",D:"",E:"",F:""},{A:U,B:F,C:P,D:tt,E:W,F:R}],lt=6,rt=0,xt=0;for(let ht=0;ht<this.limitQuestions;ht++){lt>=26&&(lt=0,rt++);let gt="";0==rt&&0==xt?gt=this.keyColExcelArr[lt]:(rt>26&&(rt=1,xt++),xt>0&&(gt+=this.keyColExcelArr[xt-1]),gt+=this.keyColExcelArr[rt-1]+""+this.keyColExcelArr[lt]),ut[0][gt]="",ut[1][gt]=N+" "+(ht<9?"0"+(ht+1):ht+1),lt++}if(z.push({s:{r:(X+=2)-1,c:0},e:{r:X-1,c:5}}),V.push(X),q=pt.utils.sheet_add_json(q,ut,{skipHeader:!0,origin:-1}),null==n)ot=this.commonService.myTranslateIntance("lang_auto_chua_co_hoc_sinh_du_thi"),pt.utils.sheet_add_json(q,[{A:ot,B:"",C:"",D:"",E:"",F:""},{A:"",B:"",C:"",D:"",E:"",F:""},{A:"",B:"",C:"",D:"",E:"",F:""}],{skipHeader:!0,origin:-1});else{let ht=1,gt=null!==(d=this.commonService.myTranslateIntance("lang_auto_chua_cham"))&&void 0!==d?d:"",dt=null!==(m=this.commonService.myTranslateIntance("lang_auto_dang_thi"))&&void 0!==m?m:"",yt=null!==(p=this.commonService.myTranslateIntance("lang_auto_chua_nop_bai"))&&void 0!==p?p:"",bt=null!==(w=this.commonService.myTranslateIntance("lang_auto_chua_thi"))&&void 0!==w?w:"",At=null!==(C=this.commonService.myTranslateIntance("lang_auto_hoc_sinh_chua_nhap_ngay_sinh"))&&void 0!==C?C:"",kt=null!==(A=this.commonService.myTranslateIntance("lang_auto_nam"))&&void 0!==A?A:"",Qt=null!==(M=this.commonService.myTranslateIntance("lang_auto_nu"))&&void 0!==M?M:"";Object.keys(n).forEach(Gt=>{var ne,ae;let $t,Jt=n[Gt],ie=new O.uU("en-US").transform(Jt.birthday,"dd/MM/yyyy");$t=Jt.isNotMarked?gt:Jt.isOnTest?dt:Jt.isNotSubmit?yt:Jt.isNotTested?bt:null!==(ne=Jt.mark)&&void 0!==ne?ne:"";let be=[{A:ht,B:Jt.fullName,C:null==ie?At:`${ie}`,D:`${1==Jt.gender?kt:Qt}`,E:`${Jt.code?Jt.code:""}`,F:$t}];if(Jt.answeredQuestions){let Ce=6,Ae=0,Se=0;for(let Pe=0;Pe<(null===(ae=Jt.answeredQuestions)||void 0===ae?void 0:ae.length);Pe++){Ce>=26&&(Ce=0,Ae++);let Yt="";0==Ae&&0==Se?Yt=this.keyColExcelArr[Ce]:(Ae>26&&(Ae=1,Se++),Se>0&&(Yt+=this.keyColExcelArr[Se-1]),Yt+=this.keyColExcelArr[Ae-1]+""+this.keyColExcelArr[Ce]),be[0][Yt]=this.checkAnswerQuestionTableExport(Jt.answeredQuestions[Pe]),Ce++}}pt.utils.sheet_add_json(q,be,{skipHeader:!0,origin:-1}),ht++,X++});let Bt=null!==(D=this.commonService.myTranslateIntance("lang_auto_diem_trung_binh"))&&void 0!==D?D:"";pt.utils.sheet_add_json(q,[{A:Bt,B:"",C:"",D:"",E:"",F:this.calcAvgClassroomMark(n)}],{skipHeader:!0,origin:-1}),J.push(X+1),z.push({s:{r:X+=1,c:0},e:{r:X,c:4}}),pt.utils.sheet_add_json(q,[{A:"",B:"",C:"",D:"",E:"",F:""},{A:"",B:"",C:"",D:"",E:"",F:""}],{skipHeader:!0,origin:-1})}}q["!cols"]=B,q["!merges"]=z;for(let ot=0;ot<V.length;ot++){q[pt.utils.encode_cell({c:0,r:V[ot]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},q[pt.utils.encode_cell({c:1,r:V[ot]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},q[pt.utils.encode_cell({c:2,r:V[ot]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},q[pt.utils.encode_cell({c:3,r:V[ot]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},q[pt.utils.encode_cell({c:4,r:V[ot]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},q[pt.utils.encode_cell({c:5,r:V[ot]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},q[pt.utils.encode_cell({c:0,r:V[ot]})].s=this.style_header,q[pt.utils.encode_cell({c:1,r:V[ot]})].s=this.style_header,q[pt.utils.encode_cell({c:2,r:V[ot]})].s=this.style_header,q[pt.utils.encode_cell({c:3,r:V[ot]})].s=this.style_header,q[pt.utils.encode_cell({c:4,r:V[ot]})].s=this.style_header,q[pt.utils.encode_cell({c:5,r:V[ot]})].s=this.style_header,q[pt.utils.encode_cell({c:0,r:J[ot]})].s=this.style_footer,q[pt.utils.encode_cell({c:1,r:J[ot]})].s=this.style_footer,q[pt.utils.encode_cell({c:2,r:J[ot]})].s=this.style_footer,q[pt.utils.encode_cell({c:3,r:J[ot]})].s=this.style_footer,q[pt.utils.encode_cell({c:4,r:J[ot]})].s=this.style_footer,q[pt.utils.encode_cell({c:5,r:J[ot]})].s=this.style_footer;for(let lt=0;lt<this.limitQuestions;lt++)q[pt.utils.encode_cell({c:5,r:V[ot]-1})]&&(q[pt.utils.encode_cell({c:5,r:V[ot]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}}),q[pt.utils.encode_cell({c:6+lt,r:V[ot]})]&&(q[pt.utils.encode_cell({c:6+lt,r:V[ot]})].s=this.style_header),q[pt.utils.encode_cell({c:6+lt,r:J[ot]})]&&(q[pt.utils.encode_cell({c:6+lt,r:J[ot]})].s=this.style_footer);let ut={s:{c:0,r:V[ot]+1},e:{c:5+this.limitQuestions,r:J[ot]}};for(let lt=ut.s.r;lt<=ut.e.r;++lt)for(let rt=ut.s.c;rt<=ut.e.c;++rt)q[pt.utils.encode_cell({c:rt,r:lt})]&&(q[pt.utils.encode_cell({c:rt,r:lt})].s=this.style_body)}let et=this.commonService.myTranslateIntance("lang_auto_bang_diem");pt.utils.book_append_sheet(this.wb,q,et)}}AddListQuestionToSheet(e,n,i){var a,r=0,l=[{s:{r:0,c:0},e:{r:0,c:7}}],_=[],d=[];if(a=pt.utils.json_to_sheet([{A:""}],{skipHeader:!0}),0==e){let m=this.commonService.myTranslateIntance("lang_auto_chua_co_du_lieu_thong_ke"),p=this.commonService.myTranslateIntance("lang_auto_bang_ty_le_dung_sai"),w=[{A:m,B:"",C:"",D:"",E:"",F:"",G:"",H:""}];r++,_.push(r),l.push({s:{r:r-1,c:0},e:{r:r-1,c:7}}),a=pt.utils.sheet_add_json(a,w,{skipHeader:!0,origin:-1}),pt.utils.book_append_sheet(this.wb,a,p)}else{let m=this.commonService.myTranslateIntance("lang_auto_cau_hoi"),p=this.commonService.myTranslateIntance("lang_auto_tong_so_hs_du_thi"),w=this.commonService.myTranslateIntance("lang_auto_so_hs_da_lam"),C=this.commonService.myTranslateIntance("lang_auto_so_hs_chua_lam"),A=this.commonService.myTranslateIntance("lang_auto_so_hs_lam_dung"),M=this.commonService.myTranslateIntance("lang_auto_so_hs_lam_sai"),D=this.commonService.myTranslateIntance("lang_auto_ty_le_hoc_sinh_khong_hoan_thanh_cau"),q=this.commonService.myTranslateIntance("lang_auto_danh_sach_hoc_sinh_lam_sai"),U=this.commonService.myTranslateIntance("lang_auto_thong_ke_theo_cau_hoi"),F=this.commonService.myTranslateIntance("lang_auto_cau");i.length>0&&i.forEach(P=>{var R,N;let B=[{A:P.name,B:"",C:"",D:"",E:"",F:"",G:"",H:""},{A:m,B:p,C:w,D:C,E:A,F:M,G:D,H:q}];if(_.push(r+=2),l.push({s:{r:r-1,c:0},e:{r:r-1,c:7}}),a=pt.utils.sheet_add_json(a,B,{skipHeader:!0,origin:-1}),0==(null===(R=P.listQuestions)||void 0===R?void 0:R.length)){let X=[{A:this.commonService.myTranslateIntance("lang_auto_chua_co_du_lieu_thong_ke"),B:"",C:"",D:"",E:"",F:"",G:"",H:""}];r++,l.push({s:{r:r+1,c:0},e:{r:r+1,c:7}}),pt.utils.sheet_add_json(a,X,{skipHeader:!0,origin:-1})}else null===(N=P.listQuestions)||void 0===N||N.forEach((z,X)=>{var V;let et=[{A:`${F} ${(null!==(V=z.indexQuestion)&&void 0!==V?V:X)+1}`,B:z.countAttended,C:z.countTested,D:z.countNotAnswer,E:z.countTrue,F:z.countFalse,G:0!=z.countAttended?`${((z.countNotAnswer+z.countFalse)/z.countAttended*100).toFixed(2)}%`:"0%",H:this.getNameStudentWhoFalse(z.studentWhoFalse).join(", ")}];pt.utils.sheet_add_json(a,et,{skipHeader:!0,origin:-1}),r++});d.push(r),r+=2,pt.utils.sheet_add_json(a,[{A:"",B:"",C:"",D:"",E:"",F:"",G:"",H:""},{A:"",B:"",C:"",D:"",E:"",F:"",G:"",H:""}],{skipHeader:!0,origin:-1})});let tt=[{A:U,B:"",C:"",D:"",E:"",F:"",G:"",H:""},{A:m,B:p,C:w,D:C,E:A,F:M,G:D,H:q}];l.push({s:{r:(r+=2)-1,c:0},e:{r:r-1,c:7}}),_.push(r),a=pt.utils.sheet_add_json(a,tt,{skipHeader:!0,origin:-1}),n.forEach((P,R)=>{var N;pt.utils.sheet_add_json(a,[{A:`${F} ${(null!==(N=P.indexQuestion)&&void 0!==N?N:R)+1}`,B:P.countAttended,C:P.countTested,D:P.countNotAnswer,E:P.countTrue,F:P.countFalse,G:0!=P.countAttended?`${((P.countNotAnswer+P.countFalse)/P.countAttended*100).toFixed(2)}%`:"0%",H:this.getNameStudentWhoFalse(P.studentWhoFalse).join(", ")}],{skipHeader:!0,origin:-1}),r++}),d.push(r),pt.utils.sheet_add_json(a,[{A:"",B:"",C:"",D:"",E:"",F:"",G:"",H:""},{A:"",B:"",C:"",D:"",E:"",F:"",G:"",H:""}],{skipHeader:!0,origin:-1}),a["!cols"]=[{wch:15.25},{wch:10.63},{wch:6.25},{wch:8.25},{wch:9},{wch:7.25},{wch:16.75},{wch:60}],a["!merges"]=l;for(let P=0;P<_.length;P++){a[pt.utils.encode_cell({c:0,r:_[P]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},a[pt.utils.encode_cell({c:1,r:_[P]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},a[pt.utils.encode_cell({c:2,r:_[P]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},a[pt.utils.encode_cell({c:3,r:_[P]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},a[pt.utils.encode_cell({c:4,r:_[P]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},a[pt.utils.encode_cell({c:5,r:_[P]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},a[pt.utils.encode_cell({c:6,r:_[P]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},a[pt.utils.encode_cell({c:7,r:_[P]-1})].s={alignment:{vertical:"center",horizontal:"center"},font:{bold:!0}},a[pt.utils.encode_cell({c:0,r:_[P]})].s=this.style_header,a[pt.utils.encode_cell({c:1,r:_[P]})].s=this.style_header,a[pt.utils.encode_cell({c:2,r:_[P]})].s=this.style_header,a[pt.utils.encode_cell({c:3,r:_[P]})].s=this.style_header,a[pt.utils.encode_cell({c:4,r:_[P]})].s=this.style_header,a[pt.utils.encode_cell({c:5,r:_[P]})].s=this.style_header,a[pt.utils.encode_cell({c:6,r:_[P]})].s=this.style_header,a[pt.utils.encode_cell({c:7,r:_[P]})].s=this.style_header;let R={s:{c:0,r:_[P]+1},e:{c:7,r:d[P]}};for(let N=R.s.r;N<=R.e.r;++N)for(let B=R.s.c;B<=R.e.c;++B)a[pt.utils.encode_cell({c:B,r:N})].s=this.style_body}let W=this.commonService.myTranslateIntance("lang_auto_bang_ty_le_dung_sai");pt.utils.book_append_sheet(this.wb,a,W)}}getNameStudentWhoFalse(e){var n=[];return e.forEach(i=>{i.fullName&&n.push(i.fullName)}),n}checkStatusStudent(e,n){var i=[];return e.forEach(a=>{n?a.confirmedAt&&""!=a.confirmedAt&&a.resultId&&a.resultId>0?a.isMarked=!0:a.resultId&&a.resultId>0&&(!a.confirmedAt||""==a.confirmedAt)?a.isNotMarked=!0:a.resultId&&0!=a.resultId||!a.startedTest||""==a.startedTest||0!=a.status?a.resultId&&0!=a.resultId||!a.startedTest||""==a.startedTest||-1!=a.status?null==a.startedTest&&(a.isNotTested=!0):a.isNotSubmit=!0:a.isOnTest=!0:a.resultId&&a.resultId>0?a.isMarked=!0:a.resultId&&0!=a.resultId||!a.startedTest||""==a.startedTest||0!=a.status?a.resultId&&0!=a.resultId||!a.startedTest||""==a.startedTest||-1!=a.status?null==a.startedTest&&(a.isNotTested=!0):a.isNotSubmit=!0:a.isOnTest=!0,i.push(a)}),i}totalPercent(e,n){var i,a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt,W,P,R,N,B,z,X=[0,0,0,0,0,0,0,0,0,0,0,0];let V=0;for(let J=0;J<e.length;J++)e[J]&&(V+=null!==(i=e[J].testedCount)&&void 0!==i?i:0,X[0]+=null!==(a=e[J].markPercent[0].count)&&void 0!==a?a:0,X[1]+=null!==(r=e[J].markPercent[1].count)&&void 0!==r?r:0,X[2]+=null!==(l=e[J].markPercent[2].count)&&void 0!==l?l:0,X[3]+=null!==(c=e[J].markPercent[3].count)&&void 0!==c?c:0,X[4]+=null!==(_=e[J].markPercent[4].count)&&void 0!==_?_:0,X[5]+=null!==(d=e[J].markPercent[5].count)&&void 0!==d?d:0,X[6]+=null!==(m=e[J].markPercent[6].count)&&void 0!==m?m:0,X[7]+=null!==(p=e[J].markPercent[7].count)&&void 0!==p?p:0,X[8]+=null!==(w=e[J].markPercent[8].count)&&void 0!==w?w:0,X[9]+=null!==(C=e[J].markPercent[9].count)&&void 0!==C?C:0,X[10]+=null!==(A=e[J].markPercent[10].count)&&void 0!==A?A:0);for(let J=0;J<n.length;J++)n[J]&&(V+=null!==(M=n[J].testedCount)&&void 0!==M?M:0,X[0]+=null!==(D=n[J].markPercent[0].count)&&void 0!==D?D:0,X[1]+=null!==(q=n[J].markPercent[1].count)&&void 0!==q?q:0,X[2]+=null!==(U=n[J].markPercent[2].count)&&void 0!==U?U:0,X[3]+=null!==(F=n[J].markPercent[3].count)&&void 0!==F?F:0,X[4]+=null!==(tt=n[J].markPercent[4].count)&&void 0!==tt?tt:0,X[5]+=null!==(W=n[J].markPercent[5].count)&&void 0!==W?W:0,X[6]+=null!==(P=n[J].markPercent[6].count)&&void 0!==P?P:0,X[7]+=null!==(R=n[J].markPercent[7].count)&&void 0!==R?R:0,X[8]+=null!==(N=n[J].markPercent[8].count)&&void 0!==N?N:0,X[9]+=null!==(B=n[J].markPercent[9].count)&&void 0!==B?B:0,X[10]+=null!==(z=n[J].markPercent[10].count)&&void 0!==z?z:0);for(let J=0;J<X.length;J++)X[J]=100*X[J]/V;return X}totalPoint(e,n){var i,a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt,W,P,R,N;let B=[0,0,0,0,0,0,0,0,0,0,0];for(let z=0;z<e.length;z++)B[0]+=null!==(i=e[z].markPercent[0].count)&&void 0!==i?i:0,B[1]+=null!==(a=e[z].markPercent[1].count)&&void 0!==a?a:0,B[2]+=null!==(r=e[z].markPercent[2].count)&&void 0!==r?r:0,B[3]+=null!==(l=e[z].markPercent[3].count)&&void 0!==l?l:0,B[4]+=null!==(c=e[z].markPercent[4].count)&&void 0!==c?c:0,B[5]+=null!==(_=e[z].markPercent[5].count)&&void 0!==_?_:0,B[6]+=null!==(d=e[z].markPercent[6].count)&&void 0!==d?d:0,B[7]+=null!==(m=e[z].markPercent[7].count)&&void 0!==m?m:0,B[8]+=null!==(p=e[z].markPercent[8].count)&&void 0!==p?p:0,B[9]+=null!==(w=e[z].markPercent[9].count)&&void 0!==w?w:0,B[10]+=null!==(C=e[z].markPercent[10].count)&&void 0!==C?C:0;for(let z=0;z<n.length;z++)B[0]+=null!==(A=n[z].markPercent[0].count)&&void 0!==A?A:0,B[1]+=null!==(M=n[z].markPercent[1].count)&&void 0!==M?M:0,B[2]+=null!==(D=n[z].markPercent[2].count)&&void 0!==D?D:0,B[3]+=null!==(q=n[z].markPercent[3].count)&&void 0!==q?q:0,B[4]+=null!==(U=n[z].markPercent[4].count)&&void 0!==U?U:0,B[5]+=null!==(F=n[z].markPercent[5].count)&&void 0!==F?F:0,B[6]+=null!==(tt=n[z].markPercent[6].count)&&void 0!==tt?tt:0,B[7]+=null!==(W=n[z].markPercent[7].count)&&void 0!==W?W:0,B[8]+=null!==(P=n[z].markPercent[8].count)&&void 0!==P?P:0,B[9]+=null!==(R=n[z].markPercent[9].count)&&void 0!==R?R:0,B[10]+=null!==(N=n[z].markPercent[10].count)&&void 0!==N?N:0;return B}totalStudentRegister(e,n){var i,a,r=0;for(let l=0;l<e.length;l++)r+=null!==(i=e[l].registerCount)&&void 0!==i?i:0;for(let l=0;l<n.length;l++)r+=null!==(a=n[l].registerCount)&&void 0!==a?a:0;return r}totalStudentTakeExam(e,n){var i,a,r=0;for(let l=0;l<e.length;l++)r+=null!==(i=e[l].testedCount)&&void 0!==i?i:0;for(let l=0;l<n.length;l++)r+=null!==(a=n[l].testedCount)&&void 0!==a?a:0;return r}calcAvgClassroomMark(e){var n=0,i=0;return e.forEach(a=>{var r;a.isMarked&&(n++,i+=null!==(r=a.mark)&&void 0!==r?r:0)}),n>0?(i/n).toFixed(2):0}convertStatisticalAllQuestion(e){var n,i,a,r,l,c,_,d,m,p,w,C=(null===(n=e.data)||void 0===n?void 0:n.questionObjs)&&e.data.questionObjs.length>0?e.data.questionObjs:new Array,A=[];A=null!==(i=this.commonService.castJsonToClassObjs(Ki,JSON.stringify(C)))&&void 0!==i?i:[];var M=(null===(a=e.data)||void 0===a?void 0:a.resultQuestionObjs)&&(null===(r=e.data)||void 0===r?void 0:r.resultQuestionObjs.length)>0?e.data.resultQuestionObjs:new Array,D=this.dictionaryService.getDictionaryByGroupFieldTS(M,"userId"),q=[];this.examObj=null!==(c=null===(l=e.data)||void 0===l?void 0:l.examObj)&&void 0!==c?c:{};var U=(null===(_=e.data)||void 0===_?void 0:_.resultObjs)&&e.data.resultObjs.length>0?e.data.resultObjs:new Array,F={},tt=[],W={};null===(m=null===(d=e.data)||void 0===d?void 0:d.classroomObjsWithStudentObjs)||void 0===m||m.forEach(z=>{z.classroomObj&&z.studentObjs&&z.studentObjs.forEach(X=>{var V,J;if(X.parentId){this.commonService.filterArray(tt,X.parentId)||tt.push(X.parentId);var et=this.statisticalApiService.findExamResultOfStudent(null!==(V=D[X.parentId])&&void 0!==V?V:[],null!==(J=X.id)&&void 0!==J?J:0);if(et.length>0){var ot=et[et.length-1],ut=X.parentId+"_"+(X.id?X.id:0)+"_"+ot.id;F.hasOwnProperty(ut)||(F[ut]=X),W.hasOwnProperty(ut)||(W[ut]=ot)}}})}),U.forEach(z=>{var X,V,J,et;if(z.parentId&&D.hasOwnProperty(null!==(X=z.parentId)&&void 0!==X?X:0)&&!this.commonService.filterArray(tt,null!==(V=z.parentId)&&void 0!==V?V:"0")){var ot=D[z.parentId][D[z.parentId].length-1];let lt=this.commonService.myTranslateIntance("lang_auto_thi_sinh_thi_offline");z.fullName=null!==(J=z.fullName)&&void 0!==J?J:lt+"_"+ot.id;var ut=z.parentId+"_"+(null!==(et=z.id)&&void 0!==et?et:0)+"_"+ot.id;F.hasOwnProperty(ut)||(F[ut]=z),W.hasOwnProperty(ut)||(W[ut]=ot)}});for(var P=0;P<A.length;P++)(this.answerTypeService.isOneChoiceAnswer(A[P].answerType)||this.answerTypeService.isFillAnswer(A[P].answerType))&&(A[P].countFalse=0,A[P].countNotAnswer=0,A[P].countTested=0,A[P].countAttended=0,A[P].countTrue=0,A[P].indexQuestion=P,A[P].studentWhoFalse=[],A[P].studentWhoNotAnswer=[]);for(var R in W)if(W.hasOwnProperty(R))for(P=0;P<A.length;P++)if(this.answerTypeService.isOneChoiceAnswer(A[P].answerType)||this.answerTypeService.isFillAnswer(A[P].answerType)){var N=W[R],B=F.hasOwnProperty(R)?F[R]:{};N.correctQuestionIds&&this.commonService.filterArray(N.correctQuestionIds,A[P].id)&&(A[P].countTrue++,A[P].countTested++),N.wrongQuestionIds&&this.commonService.filterArray(N.wrongQuestionIds,A[P].id)&&(A[P].countFalse++,A[P].countTested++,this.commonService.filterArray(A[P].studentWhoFalse,{studentId:B.id,parentId:B.parentId,fullName:B.fullName,nameImages:B.nameImages})||null===(p=A[P].studentWhoFalse)||void 0===p||p.push({studentId:B.id,parentId:B.parentId,fullName:B.fullName,nameImages:B.nameImages})),N.resultQuestionIds&&this.commonService.filterArray(N.resultQuestionIds,A[P].id)&&A[P].countAttended++,this.commonService.filterArray(N.resultQuestionIds,A[P].id)&&!this.commonService.filterArray(N.correctQuestionIds,A[P].id)&&!this.commonService.filterArray(N.wrongQuestionIds,A[P].id)&&(A[P].countNotAnswer++,this.commonService.filterArray(A[P].studentWhoNotAnswer,{studentId:B.id,parentId:B.parentId,fullName:B.fullName,nameImages:B.nameImages})||null===(w=A[P].studentWhoNotAnswer)||void 0===w||w.push({studentId:B.id,parentId:B.parentId,fullName:B.fullName,nameImages:B.nameImages}))}return A.forEach(z=>{(this.answerTypeService.isOneChoiceAnswer(z.answerType)||this.answerTypeService.isFillAnswer(z.answerType))&&q.push(z)}),q}getData(e){return(0,Oe.mG)(this,void 0,void 0,function*(){return new Promise((n,i)=>{let a=0,r=0,l=this.commonService.getFormObj(this.form);1==l.statisticalCheck&&0==this.statisticalLoaded&&a++,1==l.listquestionCheck&&0==this.listquestionLoaded&&a++,1==l.tablescoreCheck&&0==this.tablescoreLoaded&&a++,0==a&&n(!0),1==l.statisticalCheck&&0==this.statisticalLoaded&&this.statisticalApiService.getExamStatisticObjs("statistic_export_excel1",e,"Mark").subscribe(c=>{var _,d;if(1==c.success&&c.data){var m=c.data.classroomObjsWithStudentObjs&&c.data.classroomObjsWithStudentObjs.length>0?c.data.classroomObjsWithStudentObjs:new Array,p=c.data.resultObjs&&c.data.resultObjs.length>0?c.data.resultObjs:new Array,w=this.testedListApiService.mergeStudentWithAvatar(null!=p?p:[]),C=[],A=[],M=this.dictionaryService.getDictionaryByFieldTS(w,"parentId");if(this.examObj=null!==(_=c.data.examObj)&&void 0!==_?_:{},m.length>0){var D=[],q=[];m.forEach(z=>{var X,V=[],J=[],et=0;null===(X=z.studentObjs)||void 0===X||X.forEach(rt=>{var xt,ht,gt,dt,yt,bt,At;D.push(null!==(xt=rt.parentId)&&void 0!==xt?xt:"0");var kt=null!==(ht=rt.parentId)&&void 0!==ht?ht:"0";if(M.hasOwnProperty(kt)&&(Array.isArray(rt.examResultObjs)||(rt.examResultObjs=[]),rt.examResultObjs=this.statisticalApiService.findExamResultOfStudent(null!==(yt=null===(gt=rt.examResultObjs)||void 0===gt?void 0:gt.concat(null!==(dt=M[kt].examResultObjs)&&void 0!==dt?dt:[]))&&void 0!==yt?yt:[],null!==(bt=rt.id)&&void 0!==bt?bt:0)),rt.examResultObjs&&rt.examResultObjs.length>0){var Qt=rt.examResultObjs[rt.examResultObjs.length-1];Qt.testStatus&&(this.homeworkExamService.isOnlyTrueFalse(null!==(At=this.examObj.examType)&&void 0!==At?At:0)||Qt.confirmedAt)&&J.push(Qt)}et++});for(var ot=this.homeworkExamService.countMarks(J),ut=0;ut<ot.length;ut++)V.push({key:10==ut?"Avg":"<="+(ut+1),count:ot[ut],percent:this.homeworkExamService.calcPercent(ot[ut],J.length)});C.push({classObj:z.classroomObj,registerCount:et,testedCount:J.length>0?J.length:0,markPercent:V})});var U=[],F=[];w.forEach(z=>{var X,V,J,et;if(!this.commonService.filterArray(D,null!==(X=z.parentId)&&void 0!==X?X:"0")&&z.examResultObjs&&z.examResultObjs.length>0){var ot=this.statisticalApiService.findExamResultOfStudent(z.examResultObjs,null!==(V=z.id)&&void 0!==V?V:0);if(ot.length>0){var ut=ot[ot.length-1];ut.testStatus&&((this.homeworkExamService.isOnlyTrueFalse(null!==(J=this.examObj.examType)&&void 0!==J?J:0)||ut.confirmedAt)&&F.push(ut),q.push(null!==(et=z.parentId)&&void 0!==et?et:"0"))}}});for(var tt=this.homeworkExamService.countMarks(F),W=0;W<tt.length;W++)U.push({key:10==W?"Avg":"<="+(W+1),count:tt[W],percent:this.homeworkExamService.calcPercent(tt[W],F.length)});F.length>0&&A.push({classObj:{},registerCount:q.length>0?q.length:0,testedCount:F.length>0?F.length:0,markPercent:U})}else{var R=[],N=[],B=[];for(w.forEach(X=>{var V,J,et;if(X.examResultObjs&&X.examResultObjs.length>0){var ot=this.statisticalApiService.findExamResultOfStudent(X.examResultObjs,null!==(V=X.id)&&void 0!==V?V:0);if(ot.length>0){var ut=ot[ot.length-1];ut.testStatus&&((this.homeworkExamService.isOnlyTrueFalse(null!==(J=this.examObj.examType)&&void 0!==J?J:0)||ut.confirmedAt)&&N.push(ut),B.push(null!==(et=X.parentId)&&void 0!==et?et:"0"))}}}),tt=this.homeworkExamService.countMarks(N),W=0;W<tt.length;W++)R.push({key:10==W?"Avg":"<="+(W+1),count:tt[W],percent:this.homeworkExamService.calcPercent(tt[W],N.length)});N.length>0&&A.push({classObj:{},registerCount:B.length>0?B.length:0,testedCount:N.length>0?N.length:0,markPercent:R})}this.Statistic={statisticClass:C,statisticNoClass:A},this.statisticalLoaded=!0}else this.showErrorSnack(null!==(d=c.message)&&void 0!==d?d:"");r++,r==a&&n(!0)}),1==l.listquestionCheck&&0==this.listquestionLoaded&&this.statisticalApiService.getExamStatisticObjs("statistic_export_excel2",e,"Question",1).subscribe(c=>{var _,d,m,p,w,C,A,M,D,q,U,F,tt,W;if(1==c.success&&c.data){var P=c.data.resultObjs&&c.data.resultObjs.length>0?c.data.resultObjs:new Array,R=this.testedListApiService.mergeStudentWithAvatar(null!=P?P:[]),N=null!==(_=this.commonService.castJsonToClassObjs(la,JSON.stringify(c.data.classroomObjs)))&&void 0!==_?_:[],B={};null===(d=c.data.classroomObjsWithStudentObjs)||void 0===d||d.forEach(At=>{var kt,Qt,Bt,Gt;At.classroomObj&&At.studentObjs&&(B.hasOwnProperty(null!==(Qt=null===(kt=At.classroomObj)||void 0===kt?void 0:kt.id)&&void 0!==Qt?Qt:0)||(B[null!==(Gt=null===(Bt=At.classroomObj)||void 0===Bt?void 0:Bt.id)&&void 0!==Gt?Gt:0]=At.studentObjs))});for(var z=c.data.questionObjs&&c.data.questionObjs.length>0?c.data.questionObjs:new Array,X=(null===(m=c.data)||void 0===m?void 0:m.resultQuestionObjs)&&(null===(p=c.data)||void 0===p?void 0:p.resultQuestionObjs.length)>0?c.data.resultQuestionObjs:new Array,V=this.dictionaryService.getDictionaryByGroupFieldTS(X,"userId"),J=[],et=0;et<N.length;et++)B.hasOwnProperty(null!==(w=N[et].id)&&void 0!==w?w:0)&&(N[et].students=B[null!==(C=N[et].id)&&void 0!==C?C:0]),null===(A=N[et].students)||void 0===A||A.forEach(At=>{var kt,Qt;if(At.parentId&&!this.commonService.filterArray(J,At.parentId)&&J.push(At.parentId),At.parentId&&V.hasOwnProperty(At.parentId)&&!this.commonService.filterArray(N[et].listResult,V[At.parentId][0])){var Bt=this.statisticalApiService.findExamResultOfStudent(V[At.parentId],null!==(kt=At.id)&&void 0!==kt?kt:0);Bt.length>0&&(null===(Qt=N[et].listResult)||void 0===Qt||Qt.push(Bt[Bt.length-1]))}});var ot=!1,ut={id:-1,name:this.commonService.myTranslateIntance("lang_auto_thi_sinh_tu_do"),userTested:[],listResult:[],listQuestions:[]};R.forEach(At=>{var kt,Qt,Bt,Gt,ne;if(!this.commonService.filterArray(J,null!==(kt=At.parentId)&&void 0!==kt?kt:"0")){if(At.parentId&&V.hasOwnProperty(null!==(Qt=At.parentId)&&void 0!==Qt?Qt:0)){var ae=this.statisticalApiService.findExamResultOfStudent(V[At.parentId],null!==(Bt=At.id)&&void 0!==Bt?Bt:0);if(ae.length>0){var Jt=ae[ae.length-1];ut.listResult.push(Jt);let ie=this.commonService.myTranslateIntance("lang_auto_thi_sinh_thi_offline");At.fullName=null!==(Gt=At.fullName)&&void 0!==Gt?Gt:ie+"_"+Jt.id,null===(ne=ut.userTested)||void 0===ne||ne.push(At)}}ot=!0}}),ot&&N.push(ut);for(var lt=0,rt=0;rt<N.length;rt++){var xt=[];xt=null!==(M=this.commonService.castJsonToClassObjs(Ki,JSON.stringify(z)))&&void 0!==M?M:[];for(var ht=0;ht<xt.length;ht++)(this.answerTypeService.isOneChoiceAnswer(xt[ht].answerType)||this.answerTypeService.isFillAnswer(xt[ht].answerType))&&(xt[ht].indexQuestion=ht,N[rt].listQuestions.push(xt[ht]));var gt=this.dictionaryService.getDictionaryByGroupFieldTS(null!==(D=N[rt].listResult)&&void 0!==D?D:[],"userId");for(var dt in gt)if(gt.hasOwnProperty(dt)){lt++;var yt=-1==N[rt].id?null===(q=N[rt].userTested)||void 0===q?void 0:q.filter(At=>At.parentId==gt[dt][0].userId):null===(U=N[rt].students)||void 0===U?void 0:U.filter(At=>At.parentId==gt[dt][0].userId);for(et=0;et<N[rt].listQuestions.length;et++)(this.answerTypeService.isOneChoiceAnswer(N[rt].listQuestions[et].answerType)||this.answerTypeService.isFillAnswer(N[rt].listQuestions[et].answerType))&&(gt[dt][0].correctQuestionIds&&this.commonService.filterArray(gt[dt][0].correctQuestionIds,N[rt].listQuestions[et].id)&&(N[rt].listQuestions[et].countTrue++,N[rt].listQuestions[et].countTested++),gt[dt][0].wrongQuestionIds&&this.commonService.filterArray(gt[dt][0].wrongQuestionIds,N[rt].listQuestions[et].id)&&(N[rt].listQuestions[et].countFalse++,N[rt].listQuestions[et].countTested++,yt&&yt.length>0&&(this.commonService.filterArray(N[rt].listQuestions[et].studentWhoFalse,{studentId:yt[0].id,parentId:yt[0].parentId,fullName:yt[0].fullName,nameImages:yt[0].nameImages})||null===(F=N[rt].listQuestions[et].studentWhoFalse)||void 0===F||F.push({studentId:yt[0].id,parentId:yt[0].parentId,fullName:yt[0].fullName,nameImages:yt[0].nameImages}))),gt[dt][0].resultQuestionIds&&this.commonService.filterArray(gt[dt][0].resultQuestionIds,N[rt].listQuestions[et].id)&&N[rt].listQuestions[et].countAttended++,this.commonService.filterArray(gt[dt][0].resultQuestionIds,N[rt].listQuestions[et].id)&&!this.commonService.filterArray(gt[dt][0].correctQuestionIds,N[rt].listQuestions[et].id)&&!this.commonService.filterArray(gt[dt][0].wrongQuestionIds,N[rt].listQuestions[et].id)&&(N[rt].listQuestions[et].countNotAnswer++,yt&&yt.length>0&&(this.commonService.filterArray(N[rt].listQuestions[et].studentWhoNotAnswer,{studentId:yt[0].id,parentId:yt[0].parentId,fullName:yt[0].fullName,nameImages:yt[0].nameImages})||null===(tt=N[rt].listQuestions[et].studentWhoNotAnswer)||void 0===tt||tt.push({studentId:yt[0].id,parentId:yt[0].parentId,fullName:yt[0].fullName,nameImages:yt[0].nameImages}))))}}this.ListQuest={attended:lt,listQuestions:this.convertStatisticalAllQuestion(c),listClassStatistic:N},this.listquestionLoaded=!0}else this.showErrorSnack(null!==(W=c.message)&&void 0!==W?W:"");r++,r==a&&n(!0)}),1==l.tablescoreCheck&&0==this.tablescoreLoaded&&this.statisticalApiService.getExamStatisticObjs("statistic_export_excel3",e,"Mark").subscribe(c=>{var _,d,m,p,w,C,A,M,D,q,U;if(1==c.success&&c.data){this.examObj=null!==(d=null===(_=c.data)||void 0===_?void 0:_.examObj)&&void 0!==d?d:{},this.limitQuestions=null!==(m=this.examObj.countQuestion)&&void 0!==m?m:0;let F=this.homeworkExamService.hasEssayInExam(null!==(p=this.examObj.examType)&&void 0!==p?p:0),tt=c.data.classroomObjsWithStudentObjs&&c.data.classroomObjsWithStudentObjs.length>0?c.data.classroomObjsWithStudentObjs:new Array,W=(null===(w=c.data)||void 0===w?void 0:w.resultObjs)&&(null===(C=c.data)||void 0===C?void 0:C.resultObjs.length)>0?c.data.resultObjs:new Array,P=this.testedListApiService.mergeStudentWithAvatar(null!=W?W:[]),R=[],N={};null==P||P.forEach(et=>{var ot,ut;let lt=null!==(ot=et.parentId)&&void 0!==ot?ot:"0";N.hasOwnProperty(lt)||(N[lt]=null!==(ut=et.examResultObjs)&&void 0!==ut?ut:[]),R=R.concat(N[lt])});let B=this.testedListApiService.filterExamResultOnTest(R,this.examObj,null!==(A=c.data.curServerTime)&&void 0!==A?A:0),z=[],X=[],V=[],J=[];this.homeworkExamService.mustInClassroom(null!==(M=this.examObj.whoAllow)&&void 0!==M?M:0)&&tt.length>0&&tt.forEach(et=>{var ot;let ut=[];null===(ot=et.studentObjs)||void 0===ot||ot.forEach(lt=>{var rt,xt,ht,gt,dt,yt,bt,At;let kt={};J.push(null!==(rt=lt.parentId)&&void 0!==rt?rt:"0");let Qt=null!==(xt=lt.parentId)&&void 0!==xt?xt:"0";if(N.hasOwnProperty(Qt)&&(Array.isArray(lt.examResultObjs)||(lt.examResultObjs=[]),lt.examResultObjs=this.statisticalApiService.findExamResultOfStudent(null!==(dt=null===(ht=lt.examResultObjs)||void 0===ht?void 0:ht.concat(null!==(gt=N[Qt])&&void 0!==gt?gt:[]))&&void 0!==dt?dt:[],null!==(yt=lt.id)&&void 0!==yt?yt:0)),lt.examResultObjs&&lt.examResultObjs.length>0){let be=lt.examResultObjs[lt.examResultObjs.length-1];kt=null!=be?be:{}}let Bt=B.hasOwnProperty(null!==(bt=kt.userId)&&void 0!==bt?bt:"0")?B[null!==(At=kt.userId)&&void 0!==At?At:"0"]:0,Gt=kt.mark?kt.mark:0,ne=kt.id&&Bt>0?kt.id:0,ae=kt.startedTest?kt.startedTest:null,Jt=kt.confirmedAt?kt.confirmedAt:null,ie=kt.answeredQuestions?kt.answeredQuestions:[],$t=Object.assign(Object.assign({},lt),{mark:Gt,resultId:ne,startedTest:ae,confirmedAt:Jt,status:Bt,answeredQuestions:ie});ut.push($t)}),z.push({classObj:et.classroomObj,studentsWithMark:ut})}),W.forEach(et=>{var ot,ut,lt,rt,xt;let ht={};if(!this.commonService.filterArray(J,null!==(ot=et.parentId)&&void 0!==ot?ot:"0")){et.examResultObjs&&et.examResultObjs.length>0&&(ht=et.examResultObjs[et.examResultObjs.length-1]);let gt=B.hasOwnProperty(null!==(ut=ht.userId)&&void 0!==ut?ut:"0")?B[null!==(lt=ht.userId)&&void 0!==lt?lt:"0"]:0,dt=ht.mark?ht.mark:0,yt=ht.id&&gt>0?ht.id:0,bt=ht.startedTest?ht.startedTest:null,At=ht.confirmedAt?ht.confirmedAt:null,kt=ht.answeredQuestions?ht.answeredQuestions:[],Qt=Object.assign(Object.assign({},et),{mark:dt,resultId:yt,startedTest:bt,confirmedAt:At,nameImages:null!==(rt=et.nameImages)&&void 0!==rt?rt:{},nameImage:"",status:gt,answeredQuestions:kt}),Bt=this.commonService.myTranslateIntance("lang_auto_thi_sinh_thi_offline");Qt.fullName=null!==(xt=Qt.fullName)&&void 0!==xt?xt:Bt+"_"+yt,V.push(Qt)}}),X=V;for(let et of z)et.studentsWithMark=this.checkStatusStudent(et.classObj&&0==et.classObj.sortType?this.sortService.sortFirstNameStudents(null!==(D=et.studentsWithMark)&&void 0!==D?D:[]):this.sortService.sortArrayByMultipleObjectKeyAsc(null!==(q=this.commonService.myClone(et.studentsWithMark))&&void 0!==q?q:[],"pos","id"),F);this.TableScore={statisticClass:z,statisticNoClass:this.checkStatusStudent(this.sortService.sortFirstNameStudents(X),F)},this.tablescoreLoaded=!0}else this.showErrorSnack(null!==(U=c.message)&&void 0!==U?U:"");r++,r==a&&n(!0)})})})}getObjKeyLength(e){return Object.keys(e).length}checkAnswerQuestionTableExport(e){var n;let i="";return i=e.correct&&!e.isEssay?"lang_auto_dung":e.correct&&e.isEssay?"lang_auto_cau_TL":"lang_auto_sai",null!==(n=this.commonService.myTranslateIntance(i))&&void 0!==n?n:""}ngOnInit(){this.form=this.fb.group({statisticalCheck:[!0],listquestionCheck:[!0],tablescoreCheck:[!0]}),(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var e;this.examId=null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"id")))&&void 0!==e?e:0,this.isOnApp=this.commonService.isMobileWebview()}),super.ngOnInit()}ngOnDestroy(){this.globalService.stopIntervalFunc("statistic_export_excel1"),this.globalService.stopIntervalFunc("statistic_export_excel2"),this.globalService.stopIntervalFunc("statistic_export_excel3"),super.ngOnDestroy()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Ai),t.Y36(Fn),t.Y36(j.uw),t.Y36(vt.v),t.Y36(x.gz),t.Y36(h.QS),t.Y36(pn.K),t.Y36(yn.j),t.Y36(jn.U),t.Y36(O.JJ),t.Y36(Xi.E),t.Y36(nn.T),t.Y36(fi.F))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-export-excel"]],inputs:{viewType:"viewType"},features:[t.qOj],decls:33,vars:20,consts:[[1,"intro-y","flex","items-center"],[1,"text-lg","font-medium","truncate","mr-5"],[1,"report-box","intro-y","mt-3"],[3,"formGroup"],[1,"box","p-5"],[1,"text-slate-500","border-b","border-slate-200","flex","mb-2","pb-2"],[1,"form-check","mt-2"],["name","statistical","formControlName","statisticalCheck","id","checkbox-switch-1","type","checkbox",1,"form-check-input"],["for","checkbox-switch-1",1,"form-check-label"],["id","checkbox-switch-2","name","listquestion","formControlName","listquestionCheck","type","checkbox",1,"form-check-input"],["for","checkbox-switch-2",1,"form-check-label"],["id","checkbox-switch-3","name","tablescore","formControlName","tablescoreCheck","type","checkbox","value","",1,"form-check-input"],["for","checkbox-switch-3",1,"form-check-label"],[1,"mt-3"],[1,"btn","btn-outline-primary","shadow-md",3,"click"],["xmlns","http://www.w3.org/2000/svg","class","lucide w-4 h-4 mr-2","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],[4,"ngIf"],["class","col-md-8 mt-4","style","color: rgb(87, 141, 32);",4,"ngIf"],["class","col-md-8 mt-4","style","color: rgb(204, 49, 80);",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["d","M8 13h3"],["d","M8 17h3"],["d","M14 13h3"],["d","M14 17h3"],["role","status",1,"spinner-border","spinner-border-sm"],[1,"col-md-8","mt-4",2,"color","rgb(87, 141, 32)"],[1,"col-md-8","mt-4",2,"color","rgb(204, 49, 80)"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"h3",1),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()(),t.TgZ(4,"div",2)(5,"form",3)(6,"div",4)(7,"div",5)(8,"div",6),t._UZ(9,"input",7),t.TgZ(10,"label",8),t._uU(11),t.ALo(12,"mytranslate"),t.qZA()()(),t.TgZ(13,"div",5)(14,"div",6),t._UZ(15,"input",9),t.TgZ(16,"label",10),t._uU(17),t.ALo(18,"mytranslate"),t.qZA()()(),t.TgZ(19,"div",5)(20,"div",6),t._UZ(21,"input",11),t.TgZ(22,"label",12),t._uU(23),t.ALo(24,"mytranslate"),t.qZA()()(),t.TgZ(25,"div",13)(26,"button",14),t.NdJ("click",function(){return n.exportExcel()}),t.YNc(27,w2,7,0,"svg",15),t.YNc(28,T2,3,0,"span",16),t._uU(29),t.ALo(30,"mytranslate"),t.qZA(),t.YNc(31,C2,3,3,"div",17),t.YNc(32,A2,3,3,"div",18),t.qZA()()()()),2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,10,"lang_testbank_statistical_export_data_to_excel")," "),t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(6),t.hij(" ",t.lcZ(12,12,"lang_testbank_statistical_score_spectrum_statistics")," "),t.xp6(6),t.hij(" ",t.lcZ(18,14,"lang_testbank_statistical_statistics_right_wrong")," "),t.xp6(6),t.hij(" ",t.lcZ(24,16,"lang_testbank_statistical_transcript")," "),t.xp6(4),t.Q6J("ngIf",1!=n.loadingDownload),t.xp6(1),t.Q6J("ngIf",1==n.loadingDownload),t.xp6(1),t.hij("",t.lcZ(30,18,"lang_testbank_statistical_export_file_excel")," "),t.xp6(2),t.Q6J("ngIf",!n.isOnApp&&!0===n.isExportSuccess),t.xp6(1),t.Q6J("ngIf",!n.isOnApp&&!1===n.isExportSuccess))},dependencies:[O.O5,h._Y,h.Wl,h.JJ,h.JL,h.sg,h.u,oe.M,at.bT],styles:["td[_ngcontent-%COMP%]{vertical-align:center!important}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:unset!important}.bg-blue-color[_ngcontent-%COMP%]{background-color:#3c8dbc;color:#fff}hr.solid[_ngcontent-%COMP%]{border-top:1px solid #bbb}input[type=checkbox].export-checkbox[_ngcontent-%COMP%]{width:19px;height:19px;vertical-align:middle}input[type=checkbox].export-checkbox[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{color:#252525;padding-top:1rem;padding-bottom:.5rem;padding-right:.5rem}input[type=checkbox].export-checkbox[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;width:19px;height:19px;margin:-2px 10px 0 0;vertical-align:middle;cursor:pointer}input[type=checkbox].export-checkbox[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:.5rem}@media only screen and (max-width: 720px){.export-block[_ngcontent-%COMP%]{text-align:center}}"]}),o})();function k2(o,s){1&o&&(t.TgZ(0,"div",2)(1,"div",3)(2,"h3",4),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.TgZ(5,"div",5),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()),2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,2,"lang_auto_bieu_do_pho_diem")," "),t.xp6(3),t.hij("",t.lcZ(7,4,"lang_testbank_statistical_cant_data_statistics"),"."))}function O2(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"td",54),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.goToStudentList(i))}),t._uU(1),t.qZA()}if(2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.classObj.name)}}function S2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.registerCount)}}function E2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.testedCount)}}function I2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[0].count)}}function Z2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[0].percent,"1.0-2"),",","."))}}function M2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[1].count)}}function P2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[1].percent,"1.0-2"),",","."))}}function L2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[2].count)}}function N2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[2].percent,"1.0-2"),",","."))}}function D2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[3].count)}}function j2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[3].percent,"1.0-2"),",","."))}}function q2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[4].count)}}function Q2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[4].percent,"1.0-2"),",","."))}}function U2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[5].count)}}function F2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[5].percent,"1.0-2"),",","."))}}function R2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[6].count)}}function B2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[6].percent,"1.0-2"),",","."))}}function J2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[7].count)}}function H2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[7].percent,"1.0-2"),",","."))}}function z2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[8].count)}}function Y2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[8].percent,"1.0-2"),",","."))}}function G2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[9].count)}}function $2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[9].percent,"1.0-2"),",","."))}}function W2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[10].count)}}function K2(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[10].percent,"1.0-2"),",","."))}}function V2(o,s){if(1&o&&(t.TgZ(0,"tr"),t.YNc(1,O2,2,1,"td",52),t.YNc(2,S2,2,1,"td",53),t.YNc(3,E2,2,1,"td",53),t.YNc(4,I2,2,1,"td",53),t.YNc(5,Z2,4,8,"td",53),t.YNc(6,M2,2,1,"td",53),t.YNc(7,P2,4,8,"td",53),t.YNc(8,L2,2,1,"td",53),t.YNc(9,N2,4,8,"td",53),t.YNc(10,D2,2,1,"td",53),t.YNc(11,j2,4,8,"td",53),t.YNc(12,q2,2,1,"td",53),t.YNc(13,Q2,4,8,"td",53),t.YNc(14,U2,2,1,"td",53),t.YNc(15,F2,4,8,"td",53),t.YNc(16,R2,2,1,"td",53),t.YNc(17,B2,4,8,"td",53),t.YNc(18,J2,2,1,"td",53),t.YNc(19,H2,4,8,"td",53),t.YNc(20,z2,2,1,"td",53),t.YNc(21,Y2,4,8,"td",53),t.YNc(22,G2,2,1,"td",53),t.YNc(23,$2,4,8,"td",53),t.YNc(24,W2,2,1,"td",53),t.YNc(25,K2,4,8,"td",53),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj),t.xp6(1),t.Q6J("ngIf",null!=e.classObj)}}function X2(o,s){1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_testbank_statistical_freelance_contestant")))}function tb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.registerCount)}}function eb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.testedCount)}}function nb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[0].count)}}function ib(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[0].percent,"1.0-2"),",","."))}}function ob(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[1].count)}}function ab(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[1].percent,"1.0-2"),",","."))}}function sb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[2].count)}}function rb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[2].percent,"1.0-2"),",","."))}}function lb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[3].count)}}function cb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[3].percent,"1.0-2"),",","."))}}function _b(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[4].count)}}function db(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[4].percent,"1.0-2"),",","."))}}function ub(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[5].count)}}function mb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[5].percent,"1.0-2"),",","."))}}function hb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[6].count)}}function pb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[6].percent,"1.0-2"),",","."))}}function gb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[7].count)}}function fb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[7].percent,"1.0-2"),",","."))}}function xb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[8].count)}}function vb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[8].percent,"1.0-2"),",","."))}}function bb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[9].count)}}function wb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[9].percent,"1.0-2"),",","."))}}function Tb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.markPercent[10].count)}}function Cb(o,s){if(1&o&&(t.TgZ(0,"td",51),t._uU(1),t.ALo(2,"replace"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,t.xi3(3,5,e.markPercent[10].percent,"1.0-2"),",","."))}}function Ab(o,s){if(1&o&&(t.TgZ(0,"tr"),t.YNc(1,X2,3,3,"td",53),t.YNc(2,tb,2,1,"td",53),t.YNc(3,eb,2,1,"td",53),t.YNc(4,nb,2,1,"td",53),t.YNc(5,ib,4,8,"td",53),t.YNc(6,ob,2,1,"td",53),t.YNc(7,ab,4,8,"td",53),t.YNc(8,sb,2,1,"td",53),t.YNc(9,rb,4,8,"td",53),t.YNc(10,lb,2,1,"td",53),t.YNc(11,cb,4,8,"td",53),t.YNc(12,_b,2,1,"td",53),t.YNc(13,db,4,8,"td",53),t.YNc(14,ub,2,1,"td",53),t.YNc(15,mb,4,8,"td",53),t.YNc(16,hb,2,1,"td",53),t.YNc(17,pb,4,8,"td",53),t.YNc(18,gb,2,1,"td",53),t.YNc(19,fb,4,8,"td",53),t.YNc(20,xb,2,1,"td",53),t.YNc(21,vb,4,8,"td",53),t.YNc(22,bb,2,1,"td",53),t.YNc(23,wb,4,8,"td",53),t.YNc(24,Tb,2,1,"td",53),t.YNc(25,Cb,4,8,"td",53),t.qZA()),2&o){const e=s.$implicit;let n,i,a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt,W,P,R,N,B,z;t.xp6(1),t.Q6J("ngIf",(null!==(n=e.registerCount)&&void 0!==n?n:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(i=e.registerCount)&&void 0!==i?i:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(a=e.registerCount)&&void 0!==a?a:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(r=e.registerCount)&&void 0!==r?r:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(l=e.registerCount)&&void 0!==l?l:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(c=e.registerCount)&&void 0!==c?c:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(_=e.registerCount)&&void 0!==_?_:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(d=e.registerCount)&&void 0!==d?d:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(m=e.registerCount)&&void 0!==m?m:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(p=e.registerCount)&&void 0!==p?p:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(w=e.registerCount)&&void 0!==w?w:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(C=e.registerCount)&&void 0!==C?C:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(A=e.registerCount)&&void 0!==A?A:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(M=e.registerCount)&&void 0!==M?M:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(D=e.registerCount)&&void 0!==D?D:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(q=e.registerCount)&&void 0!==q?q:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(U=e.registerCount)&&void 0!==U?U:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(F=e.registerCount)&&void 0!==F?F:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(tt=e.registerCount)&&void 0!==tt?tt:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(W=e.registerCount)&&void 0!==W?W:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(P=e.registerCount)&&void 0!==P?P:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(R=e.registerCount)&&void 0!==R?R:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(N=e.registerCount)&&void 0!==N?N:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(B=e.registerCount)&&void 0!==B?B:0)>0),t.xp6(1),t.Q6J("ngIf",(null!==(z=e.registerCount)&&void 0!==z?z:0)>0)}}function yb(o,s){if(1&o&&(t.TgZ(0,"div",6)(1,"div",3)(2,"h3",4),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.TgZ(5,"div",7)(6,"div",8)(7,"div",9)(8,"div",10)(9,"h3",11),t._uU(10),t.qZA(),t.TgZ(11,"div",12)(12,"div",13),t.O4$(),t.TgZ(13,"svg",14),t._UZ(14,"path",15)(15,"circle",16)(16,"polyline",17),t.qZA(),t._uU(17),t.ALo(18,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(19,"div",18)(20,"div",19),t._uU(21),t.qZA()()(),t.TgZ(22,"div",12)(23,"div",13),t.O4$(),t.TgZ(24,"svg",14),t._UZ(25,"path",15)(26,"circle",16)(27,"line",20)(28,"line",21),t.qZA(),t._uU(29),t.ALo(30,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(31,"div",18)(32,"div",19),t._uU(33),t.qZA(),t.TgZ(34,"div",22),t._uU(35),t.ALo(36,"replace"),t.ALo(37,"number"),t.qZA()()(),t.TgZ(38,"div",12)(39,"div",13),t.O4$(),t.TgZ(40,"svg",14),t._UZ(41,"path",23)(42,"path",24)(43,"path",25),t.qZA(),t._uU(44),t.ALo(45,"mytranslate"),t.qZA(),t.kcU(),t.TgZ(46,"div",18)(47,"div",19),t._uU(48),t.qZA()()()()(),t.TgZ(49,"div",26)(50,"div",27)(51,"p",28),t._uU(52),t.ALo(53,"mytranslate"),t.qZA(),t.TgZ(54,"div",18)(55,"span",19),t._uU(56),t.ALo(57,"replace"),t.ALo(58,"number"),t.qZA()()(),t.TgZ(59,"div",29)(60,"p",28),t._uU(61),t.ALo(62,"mytranslate"),t.qZA(),t.TgZ(63,"div",18)(64,"span",19),t._uU(65),t.qZA(),t.TgZ(66,"div",22),t._uU(67),t.ALo(68,"replace"),t.ALo(69,"number"),t.qZA()()(),t.TgZ(70,"div",27)(71,"p",30),t._uU(72),t.ALo(73,"mytranslate"),t.qZA(),t.TgZ(74,"div",18)(75,"span",19),t._uU(76),t.qZA(),t.TgZ(77,"div",31),t._uU(78),t.ALo(79,"replace"),t.ALo(80,"number"),t.qZA()()(),t.TgZ(81,"div",27)(82,"p",30),t._uU(83),t.ALo(84,"mytranslate"),t.qZA(),t.TgZ(85,"div",18)(86,"span",19),t._uU(87),t.qZA(),t.TgZ(88,"div",32),t._uU(89),t.ALo(90,"replace"),t.ALo(91,"number"),t.qZA()()()()()()(),t.TgZ(92,"div",33),t._UZ(93,"app-export-excel",34),t.qZA(),t.TgZ(94,"div",2)(95,"div",3)(96,"h3",4),t._uU(97),t.ALo(98,"mytranslate"),t.qZA()(),t.TgZ(99,"div",35)(100,"div",36)(101,"div",37)(102,"div",38),t._UZ(103,"div",39),t.qZA()()()()(),t.TgZ(104,"div",2)(105,"div",3)(106,"h3",4),t._uU(107),t.ALo(108,"mytranslate"),t.qZA()(),t.TgZ(109,"div",40)(110,"div",41)(111,"table",42)(112,"thead",43)(113,"tr")(114,"th",44),t._uU(115),t.ALo(116,"mytranslate"),t.qZA(),t.TgZ(117,"th",45),t._uU(118),t.ALo(119,"mytranslate"),t.qZA(),t.TgZ(120,"th",45),t._uU(121,"<= 1"),t.qZA(),t.TgZ(122,"th",45),t._uU(123,"<= 2"),t.qZA(),t.TgZ(124,"th",45),t._uU(125,"<= 3"),t.qZA(),t.TgZ(126,"th",45),t._uU(127,"<= 4"),t.qZA(),t.TgZ(128,"th",45),t._uU(129,"<= 5"),t.qZA(),t.TgZ(130,"th",45),t._uU(131,"<= 6"),t.qZA(),t.TgZ(132,"th",45),t._uU(133,"<= 7"),t.qZA(),t.TgZ(134,"th",45),t._uU(135,"<= 8"),t.qZA(),t.TgZ(136,"th",45),t._uU(137,"<= 9"),t.qZA(),t.TgZ(138,"th",45),t._uU(139,"<= 10"),t.qZA(),t.TgZ(140,"th",45),t._uU(141),t.ALo(142,"mytranslate"),t.qZA()()(),t.TgZ(143,"tbody",46)(144,"tr"),t._UZ(145,"td"),t.TgZ(146,"td",47),t._uU(147),t.ALo(148,"mytranslate"),t.qZA(),t.TgZ(149,"td",47),t._uU(150),t.ALo(151,"mytranslate"),t.qZA(),t.TgZ(152,"td",48),t._uU(153,"SL"),t.qZA(),t.TgZ(154,"td",48),t._uU(155,"%"),t.qZA(),t.TgZ(156,"td",48),t._uU(157,"SL"),t.qZA(),t.TgZ(158,"td",48),t._uU(159,"%"),t.qZA(),t.TgZ(160,"td",48),t._uU(161,"SL"),t.qZA(),t.TgZ(162,"td",48),t._uU(163,"%"),t.qZA(),t.TgZ(164,"td",48),t._uU(165,"SL"),t.qZA(),t.TgZ(166,"td",48),t._uU(167,"%"),t.qZA(),t.TgZ(168,"td",48),t._uU(169,"SL"),t.qZA(),t.TgZ(170,"td",48),t._uU(171,"%"),t.qZA(),t.TgZ(172,"td",48),t._uU(173,"SL"),t.qZA(),t.TgZ(174,"td",48),t._uU(175,"%"),t.qZA(),t.TgZ(176,"td",48),t._uU(177,"SL"),t.qZA(),t.TgZ(178,"td",48),t._uU(179,"%"),t.qZA(),t.TgZ(180,"td",48),t._uU(181,"SL"),t.qZA(),t.TgZ(182,"td",48),t._uU(183,"%"),t.qZA(),t.TgZ(184,"td",48),t._uU(185,"SL"),t.qZA(),t.TgZ(186,"td",48),t._uU(187,"%"),t.qZA(),t.TgZ(188,"td",48),t._uU(189,"SL"),t.qZA(),t.TgZ(190,"td",48),t._uU(191,"%"),t.qZA(),t.TgZ(192,"td",48),t._uU(193,"SL"),t.qZA(),t.TgZ(194,"td",48),t._uU(195,"%"),t.qZA()(),t.YNc(196,V2,26,25,"tr",49),t.YNc(197,Ab,26,25,"tr",49),t.TgZ(198,"tr",50)(199,"td",51),t._uU(200),t.ALo(201,"mytranslate"),t.qZA(),t.TgZ(202,"td",51),t._uU(203),t.qZA(),t.TgZ(204,"td",51),t._uU(205),t.qZA(),t.TgZ(206,"td",51),t._uU(207),t.qZA(),t.TgZ(208,"td",51),t._uU(209),t.ALo(210,"replace"),t.ALo(211,"number"),t.qZA(),t.TgZ(212,"td",51),t._uU(213),t.qZA(),t.TgZ(214,"td",51),t._uU(215),t.ALo(216,"replace"),t.ALo(217,"number"),t.qZA(),t.TgZ(218,"td",51),t._uU(219),t.qZA(),t.TgZ(220,"td",51),t._uU(221),t.ALo(222,"replace"),t.ALo(223,"number"),t.qZA(),t.TgZ(224,"td",51),t._uU(225),t.qZA(),t.TgZ(226,"td",51),t._uU(227),t.ALo(228,"replace"),t.ALo(229,"number"),t.qZA(),t.TgZ(230,"td",51),t._uU(231),t.qZA(),t.TgZ(232,"td",51),t._uU(233),t.ALo(234,"replace"),t.ALo(235,"number"),t.qZA(),t.TgZ(236,"td",51),t._uU(237),t.qZA(),t.TgZ(238,"td",51),t._uU(239),t.ALo(240,"replace"),t.ALo(241,"number"),t.qZA(),t.TgZ(242,"td",51),t._uU(243),t.qZA(),t.TgZ(244,"td",51),t._uU(245),t.ALo(246,"replace"),t.ALo(247,"number"),t.qZA(),t.TgZ(248,"td",51),t._uU(249),t.qZA(),t.TgZ(250,"td",51),t._uU(251),t.ALo(252,"replace"),t.ALo(253,"number"),t.qZA(),t.TgZ(254,"td",51),t._uU(255),t.qZA(),t.TgZ(256,"td",51),t._uU(257),t.ALo(258,"replace"),t.ALo(259,"number"),t.qZA(),t.TgZ(260,"td",51),t._uU(261),t.qZA(),t.TgZ(262,"td",51),t._uU(263),t.ALo(264,"replace"),t.ALo(265,"number"),t.qZA(),t.TgZ(266,"td",51),t._uU(267),t.qZA(),t.TgZ(268,"td",51),t._uU(269),t.ALo(270,"replace"),t.ALo(271,"number"),t.qZA()()()()()()()),2&o){const e=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,56,"lang_auto_chi_so_co_ban")," "),t.xp6(7),t.hij(" ",e.examObj.name," "),t.xp6(7),t.hij(" ",t.lcZ(18,58,"lang_auto_so_nguoi_dang_ky_thi")," "),t.xp6(4),t.Oqu(e.countStudentRegister),t.xp6(8),t.hij(" ",t.lcZ(30,60,"lang_auto_so_nguoi_thi")," "),t.xp6(4),t.Oqu(e.countStudentRegister-e.countStudentTakeExam),t.xp6(2),t.hij("",t.Dn7(36,62,t.xi3(37,66,(e.countStudentRegister-e.countStudentTakeExam)/e.countStudentRegister*100,"1.0-2"),",","."),"%"),t.xp6(9),t.hij(" ",t.lcZ(45,69,"lang_auto_tong_luot_lam")," "),t.xp6(4),t.Oqu(e.totalAttended),t.xp6(4),t.hij(" ",t.lcZ(53,71,"lang_auto_diem_trung_binh")," "),t.xp6(4),t.Oqu(t.Dn7(57,73,t.xi3(58,77,e.avgPoint,"1.0-2"),",",".")),t.xp6(5),t.hij(" ",t.lcZ(62,80,"lang_auto_so_hoc_sinh_dat_diem")+" "," <=1 "),t.xp6(4),t.Oqu(e.markPointOne),t.xp6(2),t.hij("",t.Dn7(68,82,t.xi3(69,86,e.markPercentOne,"1.0-2"),",","."),"%"),t.xp6(5),t.Oqu(t.lcZ(73,89,"lang_auto_so_hoc_sinh_dat_diem")+"(>=5)"),t.xp6(4),t.Oqu(e.markPointAvg),t.xp6(2),t.hij("",t.Dn7(79,91,t.xi3(80,95,e.markPercentAvg,"1.0-2"),",","."),"%"),t.xp6(5),t.hij(" ",t.lcZ(84,98,"lang_auto_moc_diem_co_nhieu_hoc_sinh_dat_duoc_nhat")," "),t.xp6(4),t.Oqu(e.highestCountPoint),t.xp6(2),t.hij("",t.Dn7(90,100,t.xi3(91,104,e.highestPercentPoint,"1.0-2"),",","."),"%"),t.xp6(4),t.Q6J("viewType",e.viewType),t.xp6(4),t.hij(" ",t.lcZ(98,107,"lang_auto_bieu_do_pho_diem")," "),t.xp6(6),t.Q6J("chart",e.chart),t.xp6(4),t.hij(" ",t.lcZ(108,109,"lang_auto_bang_tan_so")," "),t.xp6(8),t.Oqu(t.lcZ(116,111,"lang_testbank_statistical_class")),t.xp6(3),t.Oqu(t.lcZ(119,113,"lang_testbank_statistical_number_student")),t.xp6(23),t.hij("",t.lcZ(142,115,"lang_testbank_statistical_on_tb")," (>= 5)"),t.xp6(6),t.Oqu(t.lcZ(148,117,"lang_buttom_register")),t.xp6(3),t.Oqu(t.lcZ(151,119,"lang_testbank_statistical_join_exam")),t.xp6(46),t.Q6J("ngForOf",e.statistic),t.xp6(1),t.Q6J("ngForOf",e.freeStudentList),t.xp6(3),t.Oqu(t.lcZ(201,121,"lang_testbank_statistical_total")),t.xp6(3),t.Oqu(e.countStudentRegister),t.xp6(2),t.Oqu(e.countStudentTakeExam),t.xp6(2),t.Oqu(e.markPointOne),t.xp6(2),t.Oqu(t.Dn7(210,123,t.xi3(211,127,e.markPercentOne,"1.0-2"),",",".")),t.xp6(4),t.Oqu(e.markPointTwo),t.xp6(2),t.Oqu(t.Dn7(216,130,t.xi3(217,134,e.markPercentTwo,"1.0-2"),",",".")),t.xp6(4),t.Oqu(e.markPointThree),t.xp6(2),t.Oqu(t.Dn7(222,137,t.xi3(223,141,e.markPercentThree,"1.0-2"),",",".")),t.xp6(4),t.Oqu(e.markPointFour),t.xp6(2),t.Oqu(t.Dn7(228,144,t.xi3(229,148,e.markPercentFour,"1.0-2"),",",".")),t.xp6(4),t.Oqu(e.markPointFive),t.xp6(2),t.Oqu(t.Dn7(234,151,t.xi3(235,155,e.markPercentFive,"1.0-2"),",",".")),t.xp6(4),t.Oqu(e.markPointSix),t.xp6(2),t.Oqu(t.Dn7(240,158,t.xi3(241,162,e.markPercentSix,"1.0-2"),",",".")),t.xp6(4),t.Oqu(e.markPointSeven),t.xp6(2),t.Oqu(t.Dn7(246,165,t.xi3(247,169,e.markPercentSeven,"1.0-2"),",",".")),t.xp6(4),t.Oqu(e.markPointEight),t.xp6(2),t.Oqu(t.Dn7(252,172,t.xi3(253,176,e.markPercentEight,"1.0-2"),",",".")),t.xp6(4),t.Oqu(e.markPointNine),t.xp6(2),t.Oqu(t.Dn7(258,179,t.xi3(259,183,e.markPercentNine,"1.0-2"),",",".")),t.xp6(4),t.Oqu(e.markPointTen),t.xp6(2),t.Oqu(t.Dn7(264,186,t.xi3(265,190,e.markPercentTen,"1.0-2"),",",".")),t.xp6(4),t.Oqu(e.markPointAvg),t.xp6(2),t.Oqu(t.Dn7(270,193,t.xi3(271,197,e.markPercentAvg,"1.0-2"),",","."))}}let kb=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c){super(i),this.dialog=e,this.statisticalApiService=n,this.commonService=i,this.activeRoute=a,this.homeworkExamService=r,this.dictionaryService=l,this.testedListApiService=c,this.viewType=-1,this.doneLoadingEmit=new t.vpe,this.chart=new Tt.kL,this.examId=-1,this.statistic=[],this.examObj={},this.totalAttended=0,this.avgPoint=0,this.highestCountPoint=0,this.highestPercentPoint=0,this.markPointOne=0,this.markPointTwo=0,this.markPointThree=0,this.markPointFour=0,this.markPointFive=0,this.markPointSix=0,this.markPointSeven=0,this.markPointEight=0,this.markPointNine=0,this.markPointTen=0,this.markPointAvg=0,this.markPercentOne=0,this.markPercentTwo=0,this.markPercentThree=0,this.markPercentFour=0,this.markPercentFive=0,this.markPercentSix=0,this.markPercentSeven=0,this.markPercentEight=0,this.markPercentNine=0,this.markPercentTen=0,this.markPercentAvg=0,this.countStudentRegister=0,this.countStudentTakeExam=0,this.freeStudentCount=0,this.freeStudentTakeTest=0,this.freeStudentList=[]}getDataStatistic(e,n){this.initStatusObj(),this.statisticalApiService.getExamStatisticObjs("statistic_point",e,n).subscribe(i=>{var a,r,l;if(1==i.success&&i.data){var c=i.data.classroomObjsWithStudentObjs&&i.data.classroomObjsWithStudentObjs.length>0?i.data.classroomObjsWithStudentObjs:new Array,_=i.data.resultObjs&&i.data.resultObjs.length>0?i.data.resultObjs:new Array,d=this.testedListApiService.mergeStudentWithAvatar(null!=_?_:[]),m=[],p=[],w=this.dictionaryService.getDictionaryByFieldTS(d,"parentId");let P=0,R=0;if(this.examObj=null!==(a=i.data.examObj)&&void 0!==a?a:{},this.totalAttended=null!==(r=i.data.totalAttended)&&void 0!==r?r:0,c.length>0){var C=[],A=[];c.forEach(B=>{var z,X=[],V=[],J=0;null===(z=B.studentObjs)||void 0===z||z.forEach(lt=>{var rt,xt,ht,gt,dt,yt,bt;C.push(null!==(rt=lt.parentId)&&void 0!==rt?rt:"0");var At=null!==(xt=lt.parentId)&&void 0!==xt?xt:"0";if(w.hasOwnProperty(At)&&(Array.isArray(lt.examResultObjs)||(lt.examResultObjs=[]),lt.examResultObjs=this.statisticalApiService.findExamResultOfStudent(null!==(dt=null===(ht=lt.examResultObjs)||void 0===ht?void 0:ht.concat(null!==(gt=w[At].examResultObjs)&&void 0!==gt?gt:[]))&&void 0!==dt?dt:[],null!==(yt=lt.id)&&void 0!==yt?yt:0)),lt.examResultObjs&&lt.examResultObjs.length>0){var kt=lt.examResultObjs[lt.examResultObjs.length-1];kt.testStatus&&(this.homeworkExamService.isOnlyTrueFalse(null!==(bt=this.examObj.examType)&&void 0!==bt?bt:0)||kt.confirmedAt)&&(V.push(kt),null!=kt.mark&&(P+=kt.mark))}J++});for(var et=this.homeworkExamService.countMarks(V),ot=0;ot<et.length;ot++)X.push({key:10==ot?"Avg":"<="+(ot+1),count:et[ot],percent:this.homeworkExamService.calcPercent(et[ot],V.length)});R+=V.length,m.push({classObj:B.classroomObj,registerCount:J,testedCount:V.length>0?V.length:0,markPercent:X})});var M=[],D=[];let N=0;d.forEach(B=>{var z,X,V,J;if(!this.commonService.filterArray(C,null!==(z=B.parentId)&&void 0!==z?z:"0")&&B.examResultObjs&&B.examResultObjs.length>0){var et=this.statisticalApiService.findExamResultOfStudent(B.examResultObjs,null!==(X=B.id)&&void 0!==X?X:0);if(et.length>0){var ot=et[et.length-1];N++,ot.testStatus&&((this.homeworkExamService.isOnlyTrueFalse(null!==(V=this.examObj.examType)&&void 0!==V?V:0)||ot.confirmedAt)&&(D.push(ot),null!=ot.mark&&(P+=ot.mark)),A.push(null!==(J=B.parentId)&&void 0!==J?J:"0"))}}});for(var q=this.homeworkExamService.countMarks(D),U=0;U<q.length;U++)M.push({key:10==U?"Avg":"<="+(U+1),count:q[U],percent:this.homeworkExamService.calcPercent(q[U],D.length)});p.push({classObj:{},registerCount:N,testedCount:D.length>0?D.length:0,markPercent:M}),R+=D.length,this.avgPoint=P/R,this.readyData(m,p)}else{var tt=[],W=[];let N=0;for(d.forEach(z=>{var X,V;if(z.examResultObjs&&z.examResultObjs.length>0){var J=this.statisticalApiService.findExamResultOfStudent(z.examResultObjs,null!==(X=z.id)&&void 0!==X?X:0);if(J.length>0){var et=J[J.length-1];N++,et.testStatus&&(this.homeworkExamService.isOnlyTrueFalse(null!==(V=this.examObj.examType)&&void 0!==V?V:0)||et.confirmedAt)&&(W.push(et),null!=et.mark&&(P+=et.mark))}}}),q=this.homeworkExamService.countMarks(W),U=0;U<q.length;U++)tt.push({key:10==U?"Avg":"<="+(U+1),count:q[U],percent:this.homeworkExamService.calcPercent(q[U],W.length)});p.push({classObj:{},registerCount:N,testedCount:W.length>0?W.length:0,markPercent:tt}),R=W.length,this.avgPoint=P/R,this.readyData(m,p)}}else this.doneLoadingEmit.emit(!1),this.showErrorSnack(null!==(l=i.message)&&void 0!==l?l:"")})}readyData(e,n){this.statistic=e,this.freeStudentList=n,this.totalStudentRegister(this.statistic,this.freeStudentList),this.totalStudentTakeExam(this.statistic,this.freeStudentList),this.totalPercent(this.statistic,this.freeStudentList),this.totalPoint(this.statistic,this.freeStudentList),this.createChart(),this.doneLoadingEmit.emit(!0),this.successStatusObj()}createChart(){var e,n;let i=null!==(e=this.commonService.myTranslateIntance("lang_auto_thong_ke_diem_thi"))&&void 0!==e?e:"",a=null!==(n=this.commonService.myTranslateIntance("lang_auto_so_luong"))&&void 0!==n?n:"",l=new Tt.kL({chart:{type:"column",style:{fontFamily:"Arial"}},colors:["#2361ae"],title:{style:{wordWrap:"break-word","text-align":"center"},text:i+"_"+this.examObj.name,useHTML:!0},credits:{enabled:!1},xAxis:{categories:["<= 1","<= 2","<= 3","<= 4","<= 5","<= 6","<= 7","<= 8","<= 9","<= 10"]},yAxis:{title:{text:""}},plotOptions:{series:{dataLabels:{enabled:!0,align:"center"}}},series:[{name:a,type:"column",data:[this.markPointOne,this.markPointTwo,this.markPointThree,this.markPointFour,this.markPointFive,this.markPointSix,this.markPointSeven,this.markPointEight,this.markPointNine,this.markPointTen]}]});this.chart=l}totalPercent(e,n){var i,a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt,W,P,R,N,B,z,X=0,V=0,J=0,et=0,ot=0,ut=0,lt=0,rt=0,xt=0,ht=0,gt=0,dt=0;for(let bt=0;bt<e.length;bt++)e[bt]&&(dt+=null!==(i=e[bt].testedCount)&&void 0!==i?i:0,X+=null!==(a=e[bt].markPercent[0].count)&&void 0!==a?a:0,V+=null!==(r=e[bt].markPercent[1].count)&&void 0!==r?r:0,J+=null!==(l=e[bt].markPercent[2].count)&&void 0!==l?l:0,et+=null!==(c=e[bt].markPercent[3].count)&&void 0!==c?c:0,ot+=null!==(_=e[bt].markPercent[4].count)&&void 0!==_?_:0,ut+=null!==(d=e[bt].markPercent[5].count)&&void 0!==d?d:0,lt+=null!==(m=e[bt].markPercent[6].count)&&void 0!==m?m:0,rt+=null!==(p=e[bt].markPercent[7].count)&&void 0!==p?p:0,xt+=null!==(w=e[bt].markPercent[8].count)&&void 0!==w?w:0,ht+=null!==(C=e[bt].markPercent[9].count)&&void 0!==C?C:0,gt+=null!==(A=e[bt].markPercent[10].count)&&void 0!==A?A:0);for(let bt=0;bt<n.length;bt++)n[bt]&&(dt+=null!==(M=n[bt].testedCount)&&void 0!==M?M:0,X+=null!==(D=n[bt].markPercent[0].count)&&void 0!==D?D:0,V+=null!==(q=n[bt].markPercent[1].count)&&void 0!==q?q:0,J+=null!==(U=n[bt].markPercent[2].count)&&void 0!==U?U:0,et+=null!==(F=n[bt].markPercent[3].count)&&void 0!==F?F:0,ot+=null!==(tt=n[bt].markPercent[4].count)&&void 0!==tt?tt:0,ut+=null!==(W=n[bt].markPercent[5].count)&&void 0!==W?W:0,lt+=null!==(P=n[bt].markPercent[6].count)&&void 0!==P?P:0,rt+=null!==(R=n[bt].markPercent[7].count)&&void 0!==R?R:0,xt+=null!==(N=n[bt].markPercent[8].count)&&void 0!==N?N:0,ht+=null!==(B=n[bt].markPercent[9].count)&&void 0!==B?B:0,gt+=null!==(z=n[bt].markPercent[10].count)&&void 0!==z?z:0);this.markPercentOne=100*X/dt,this.markPercentTwo=100*V/dt,this.markPercentThree=100*J/dt,this.markPercentFour=100*et/dt,this.markPercentFive=100*ot/dt,this.markPercentSix=100*ut/dt,this.markPercentSeven=100*lt/dt,this.markPercentEight=100*rt/dt,this.markPercentNine=100*xt/dt,this.markPercentTen=100*ht/dt,this.markPercentAvg=100*gt/dt;let yt=[this.markPercentOne,this.markPercentTwo,this.markPercentThree,this.markPercentFour,this.markPercentFive,this.markPercentSix,this.markPercentSeven,this.markPercentEight,this.markPercentNine,this.markPercentTen];for(let bt=0;bt<yt.length;++bt)this.highestPercentPoint<yt[bt]&&(this.highestPercentPoint=yt[bt])}totalPoint(e,n){var i,a,r,l,c,_,d,m,p,w,C,A,M,D,q,U,F,tt,W,P,R,N,B=0,z=0,X=0,V=0,J=0,et=0,ot=0,ut=0,lt=0,rt=0,xt=0;for(let dt=0;dt<e.length;dt++)e[dt]&&(B+=null!==(i=e[dt].markPercent[0].count)&&void 0!==i?i:0,z+=null!==(a=e[dt].markPercent[1].count)&&void 0!==a?a:0,X+=null!==(r=e[dt].markPercent[2].count)&&void 0!==r?r:0,V+=null!==(l=e[dt].markPercent[3].count)&&void 0!==l?l:0,J+=null!==(c=e[dt].markPercent[4].count)&&void 0!==c?c:0,et+=null!==(_=e[dt].markPercent[5].count)&&void 0!==_?_:0,ot+=null!==(d=e[dt].markPercent[6].count)&&void 0!==d?d:0,ut+=null!==(m=e[dt].markPercent[7].count)&&void 0!==m?m:0,lt+=null!==(p=e[dt].markPercent[8].count)&&void 0!==p?p:0,rt+=null!==(w=e[dt].markPercent[9].count)&&void 0!==w?w:0,xt+=null!==(C=e[dt].markPercent[10].count)&&void 0!==C?C:0);for(let dt=0;dt<n.length;dt++)n[dt]&&(B+=null!==(A=n[dt].markPercent[0].count)&&void 0!==A?A:0,z+=null!==(M=n[dt].markPercent[1].count)&&void 0!==M?M:0,X+=null!==(D=n[dt].markPercent[2].count)&&void 0!==D?D:0,V+=null!==(q=n[dt].markPercent[3].count)&&void 0!==q?q:0,J+=null!==(U=n[dt].markPercent[4].count)&&void 0!==U?U:0,et+=null!==(F=n[dt].markPercent[5].count)&&void 0!==F?F:0,ot+=null!==(tt=n[dt].markPercent[6].count)&&void 0!==tt?tt:0,ut+=null!==(W=n[dt].markPercent[7].count)&&void 0!==W?W:0,lt+=null!==(P=n[dt].markPercent[8].count)&&void 0!==P?P:0,rt+=null!==(R=n[dt].markPercent[9].count)&&void 0!==R?R:0,xt+=null!==(N=n[dt].markPercent[10].count)&&void 0!==N?N:0);this.markPointOne=B,this.markPointTwo=z,this.markPointThree=X,this.markPointFour=V,this.markPointFive=J,this.markPointSix=et,this.markPointSeven=ot,this.markPointEight=ut,this.markPointNine=lt,this.markPointTen=rt,this.markPointAvg=xt;let ht=[this.markPointOne,this.markPointTwo,this.markPointThree,this.markPointFour,this.markPointFive,this.markPointSix,this.markPointSeven,this.markPointEight,this.markPointNine,this.markPointTen],gt=0;for(let dt=0;dt<ht.length;++dt)gt<ht[dt]&&(gt=ht[dt],this.highestCountPoint=dt+1)}totalStudentRegister(e,n){var i,a,r=0;for(let l=0;l<e.length;l++)r+=null!==(i=e[l].registerCount)&&void 0!==i?i:0;for(let l=0;l<n.length;l++)r+=null!==(a=n[l].registerCount)&&void 0!==a?a:0;this.countStudentRegister=r}totalStudentTakeExam(e,n){var i,a,r=0;for(let l=0;l<e.length;l++)r+=null!==(i=e[l].testedCount)&&void 0!==i?i:0;for(let l=0;l<n.length;l++)r+=null!==(a=n[l].testedCount)&&void 0!==a?a:0;this.countStudentTakeExam=r}goToStudentList(e){var n,i;let a=`/admin/testbank/statistic/${null!==(n=this.examObj.categoryId)&&void 0!==n?n:0}/${this.examObj.id}`;this.commonService.myNavigationWithQueryString(`/admin/student/class-details/${null===(i=e.classObj)||void 0===i?void 0:i.id}`,"?backto="+encodeURIComponent(a))}ngOnInit(){(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var e;this.examId=null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"id")))&&void 0!==e?e:0,this.getDataStatistic(this.examId,"Mark")}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(j.uw),t.Y36(Ai),t.Y36(vt.v),t.Y36(x.gz),t.Y36(yn.j),t.Y36(Xi.E),t.Y36(Fn))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-statistical-point"]],inputs:{viewType:"viewType"},outputs:{doneLoadingEmit:"doneLoadingEmit"},features:[t.qOj],decls:3,vars:2,consts:[["class","col-span-12",4,"ngIf","ngIfElse"],["statisticIO",""],[1,"col-span-12"],[1,"intro-y","block","sm:flex","items-center"],[1,"text-lg","font-medium","truncate","mr-5"],[1,"p-3","m-3","text-center","alert","text-slate-500","font-medium"],[1,"col-span-12","lg:col-span-8","xl:col-span-8"],[1,"report-box","intro-y","mt-3"],[1,"box","sm:flex"],[1,"flex-1","p-5"],[1,"text-3xl"],[1,"text-lg","font-medium"],[1,"mt-3"],[1,"text-slate-500","text-xs","uppercase","flex","items-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["d","M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"],["cx","9","cy","7","r","4"],["points","16 11 18 13 22 9"],[1,"mt-1.5","flex","items-center"],[1,"text-base"],["x1","17","y1","8","x2","22","y2","13"],["x1","22","y1","8","x2","17","y2","13"],[1,"report-box__indicator","bg-danger","tooltip","cursor-pointer","ml-2"],["d","M20 19.5v.5a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8.5L18 5.5"],["d","M8 18h1"],["d","M18.42 9.61a2.1 2.1 0 1 1 2.97 2.97L16.95 17 13 18l.99-3.95 4.43-4.44Z"],[1,"p-5","flex","flex-col","justify-center","flex-1","border-t","sm:border-t-0","sm:border-l","border-slate-200","dark:border-darkmode-300","border-dashed"],[1,"static-info-item"],[1,"text-slate-500","text-xs","uppercase"],[1,"static-info-item","mt-5"],[1,"text-slate-500","text-xs","mt-5","uppercase"],[1,"report-box__indicator","bg-warning","tooltip","cursor-pointer","ml-2"],[1,"report-box__indicator","bg-primary","tooltip","cursor-pointer","ml-2"],[1,"col-span-12","lg:col-span-8","xl:col-span-4"],[3,"viewType"],[1,"report-box","intro-x","mt-3"],[1,"box","p-5"],[1,"h-[400px]"],[1,"chart-center"],[3,"chart"],[1,"report-box","intro-x","mt-5"],[1,"box","p-5","overflow-x-auto"],[1,"table","table-bordered"],[1,"bg-slate-100","dark:bg-darkmode-400"],[1,"whitespace-nowrap",2,"text-align","center","vertical-align","middle"],["colspan","2",1,"whitespace-nowrap",2,"text-align","center","vertical-align","middle"],[1,"text-center"],[2,"text-align","center","vertical-align","middle"],[2,"padding","9.5px !important","text-align","center","vertical-align","middle"],[4,"ngFor","ngForOf"],[1,"font-medium"],[2,"padding","9.5px !important"],["style","padding: 9.5px !important",3,"click",4,"ngIf"],["style","padding: 9.5px !important",4,"ngIf"],[2,"padding","9.5px !important",3,"click"]],template:function(e,n){if(1&e&&(t.YNc(0,k2,8,6,"div",0),t.YNc(1,yb,272,200,"ng-template",null,1,t.W1O)),2&e){const i=t.MAs(2);t.Q6J("ngIf",n.statistic&&0==n.statistic.length&&n.freeStudentList&&0==n.freeStudentList.length)("ngIfElse",i)}},dependencies:[O.sg,O.O5,Tt.Dm,y2,O.JJ,at.bT,at.AS],styles:["td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:middle!important}.bg-blue-color[_ngcontent-%COMP%]{background-color:#2361ae;color:#fff}.color-white[_ngcontent-%COMP%]{color:#fff}.table-border-slim[_ngcontent-%COMP%]{border:none!important}.table-bordered[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table-bordered[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:.5px solid #dee2e6!important}.border-top-none[_ngcontent-%COMP%]{border-top:none!important}.border-left-none[_ngcontent-%COMP%]{border-left:none!important}.border-right-none[_ngcontent-%COMP%]{border-right:none}.border-right-bold[_ngcontent-%COMP%]{border-right:1px solid #dee2e6!important}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar{background-color:#fff;width:16px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#fff}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#babac0;border-radius:16px;border:4px solid #fff}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-button{display:none}.block-total[_ngcontent-%COMP%]{font-weight:700;color:#000;background:#fff}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center;vertical-align:middle}@media screen and (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{display:block}}"]}),o})();const Ob=["drawer"];function Sb(o,s){1&o&&t._UZ(0,"azt-loading-effect")}const Eb=function(o){return{hidden:o}};let Ib=(()=>{class o extends mt.Q{constructor(e,n,i){super(e),this.commonService=e,this.activeRoute=n,this.mobileWebviewService=i,this.isListQuestion=!0,this.isStatistical=!1,this.isTabScore=!0,this.isExportExcel=!0,this.viewType=1,this.backToLink="",this.examObj={},this.doneLoadCount=0,this.hasBackdrop=!!this.commonService.isMobileOrTable(),this.mode=this.commonService.isMobileOrTable()?"over":"side",this.isMobile=this.commonService.isMobileOrTable(),this.isShowActions=(this.commonService.isMobileOrTable(),!0),this.isOpenSideNav=!this.commonService.isMobileOrTable()}changeTabType(e){0==e&&(this.isStatistical=!1,this.isListQuestion=!0,this.isTabScore=!0,this.isExportExcel=!0,this.viewType=1,"over"==this.mode&&this.toggleDrawer()),1==e&&(this.isStatistical=!0,this.isListQuestion=!1,this.isTabScore=!0,this.isExportExcel=!0,this.viewType=2,"over"==this.mode&&this.toggleDrawer()),2==e&&(this.isStatistical=!0,this.isListQuestion=!0,this.isTabScore=!1,this.isExportExcel=!0,this.viewType=3,"over"==this.mode&&this.toggleDrawer()),3==e&&(this.isStatistical=!0,this.isListQuestion=!0,this.isTabScore=!0,this.isExportExcel=!1,this.viewType=4,"over"==this.mode&&this.toggleDrawer())}toggleShowActions(){this.isShowActions=!this.isShowActions}toggleDrawer(){var e;null===(e=this.drawer)||void 0===e||e.toggle(),this.isOpenSideNav=!this.isOpenSideNav}doneLoadingFunc(e){this.doneLoadCount++,this.doneLoadCount>=3&&this.stopStatusObj()}ngOnInit(){var e,n,i;this.commonService.translateMetaData({title:"lang_cms_test_statistical_title",description:"lang_cms_test_statistical_description",image:"lang_cms_test_image"});let a=null!==(e=this.commonService.getMyParam(this.activeRoute,"cat_id"))&&void 0!==e?e:"",r=null!==(n=this.commonService.getMyParam(this.activeRoute,"id"))&&void 0!==n?n:"";this.backToLink=this.commonService.getMyQueryParam("backto")?null!==(i=this.commonService.getMyQueryParam("backto"))&&void 0!==i?i:"":`/admin/testbank/exam-results-list/${a}/${r}/0`,this.initStatusObj(),super.ngOnInit(),this.mobileWebviewService.sendComponentLoaded("statistic")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(x.gz),t.Y36(fi.F))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-statistical"]],viewQuery:function(e,n){if(1&e&&t.Gf(Ob,5),2&e){let i;t.iGM(i=t.CRH())&&(n.drawer=i.first)}},features:[t.qOj],decls:8,vars:11,consts:[[3,"headerTitle","headerBackTolink"],[1,"statistical","mx-auto","mt-5"],[4,"ngIf"],[1,"grid","grid-cols-12","gap-6",3,"ngClass"],[1,"col-span-12","grid","grid-cols-12","gap-6",3,"viewType","doneLoadingEmit"],[1,"col-span-12",3,"viewType","doneLoadingEmit"]],template:function(e,n){1&e&&(t.TgZ(0,"teacher-layout",0),t.ALo(1,"mytranslate"),t.TgZ(2,"div",1),t.YNc(3,Sb,1,0,"azt-loading-effect",2),t.TgZ(4,"div",3)(5,"app-statistical-point",4),t.NdJ("doneLoadingEmit",function(a){return n.doneLoadingFunc(a)}),t.qZA(),t.TgZ(6,"app-list-question",5),t.NdJ("doneLoadingEmit",function(a){return n.doneLoadingFunc(a)}),t.qZA(),t.TgZ(7,"app-table-score",5),t.NdJ("doneLoadingEmit",function(a){return n.doneLoadingFunc(a)}),t.qZA()()()()),2&e&&(t.Q6J("headerTitle",t.lcZ(1,7,"lang_testbank_statistical_header_title"))("headerBackTolink",n.backToLink),t.xp6(3),t.Q6J("ngIf",n.statusObj.loading),t.xp6(1),t.Q6J("ngClass",t.VKq(9,Eb,n.statusObj.loading)),t.xp6(1),t.Q6J("viewType",n.viewType),t.xp6(1),t.Q6J("viewType",n.viewType),t.xp6(1),t.Q6J("viewType",n.viewType))},dependencies:[O.mk,O.O5,te.Q,de._,zv,b2,kb,at.bT]}),o})();var Zb=b(73828);function Mb(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function Pb(o,s){if(1&o&&(t.TgZ(0,"div",2),t._UZ(1,"azt-test-result-tracking",3),t.qZA()),2&o){const e=t.oxw();let n;t.xp6(1),t.Q6J("startQuestionIndex",null!==(n=null==e.examObj?null:e.examObj.startQuestionIndex)&&void 0!==n?n:1)("dataResultObjs",e.dataResultObjs)("dataScrollObjs",e.dataScrollObjs)}}let Lb=(()=>{class o extends mt.Q{constructor(e,n,i,a){super(n),this.activeRoute=e,this.commonService=n,this.examResultService=i,this.zipdataService=a,this.dataResultObjs=[],this.dataScrollObjs=[],this.backToLink=""}processData(e){if(e)for(var n=0;n<e.length;n++)if("scroll"!=e[n][0]){var i={index:e[n][0],alpha:e[n][1],key:e[n][2],questionId:Number(e[n][3]),second:Number(e[n][4])};this.dataResultObjs.push(i)}else{var a={scrollPos:Number(e[n][1]),second:Number(e[n][2])};this.dataScrollObjs.push(a)}}getData(e,n,i,a){this.initStatusObj(),this.subscriptions.add(this.examResultService.apiExamResultGetLastExamResultByIdGet(e,n,i,a).subscribe(r=>{var l,c,_,d,m,p,w,C,A;if(1==r.success){this.examObj=null===(l=r.data)||void 0===l?void 0:l.examObj;var M=this.castJsonToObj(this.zipdataService.decodeContentGzip(null!==(d=null===(_=null===(c=null==r?void 0:r.data)||void 0===c?void 0:c.resultTracks)||void 0===_?void 0:_.trackData)&&void 0!==d?d:""));M&&this.processData(M),this.backToLink="/admin/testbank/exam-results-list/"+(null!==(p=null===(m=r.data)||void 0===m?void 0:m.examObj)&&void 0!==p&&p.categoryId?r.data.examObj.categoryId:0)+"/"+(null===(C=null===(w=r.data)||void 0===w?void 0:w.examObj)||void 0===C?void 0:C.id)+"/0",this.successStatusObj()}else this.errorStatusObj(null!==(A=r.message)&&void 0!==A?A:"",!0)}))}ngOnInit(){var e,n,i;this.commonService.translateMetaData({title:"lang_auto_chi_tite_qua_trinh_lam_trac_nghiem",description:"lang_auto_chi_tite_qua_trinh_lam_trac_nghiem",image:"lang_cms_test_image"});let a=Number(this.activeRoute.snapshot.paramMap.get("exam_id"));var r=null!==(e=this.activeRoute.snapshot.paramMap.get("result_id"))&&void 0!==e?e:"0";let l=parseInt(r,10),c=null!==(n=this.activeRoute.snapshot.paramMap.get("user_id"))&&void 0!==n?n:"",_=null!==(i=this.activeRoute.snapshot.paramMap.get("student_id"))&&void 0!==i?i:"";this.getData(a,c,_,l),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(x.gz),t.Y36(vt.v),t.Y36(Ot.kS),t.Y36(hn.n))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-test-result-tracking"]],features:[t.qOj],decls:4,vars:2,consts:[[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"container-fluid","mt-3","mb-5"],[3,"startQuestionIndex","dataResultObjs","dataScrollObjs"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout"),t.YNc(1,Mb,1,0,"azt-loading-effect",0),t.YNc(2,Pb,2,3,"ng-template",null,1,t.W1O),t.qZA()),2&e){const i=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.O5,te.Q,Zb.$,de._]}),o})();var Nb=b(23917);function Db(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function jb(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"azt-test-review",3),t.NdJ("openResultHistory",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.openResultHistoryReview(i))}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("displayScreen",4)("initDataResult",e.initDataLastResultExam)("testedUserObjs",e.testedUserObjs)}}let qb=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l){super(e),this.commonService=e,this.activeRoute=n,this.browserStorageService=i,this.examResultService=a,this.sortService=r,this.testedListApiService=l,this.headerTitle="",this.examResultHistoryDialog=void 0,this.isShowPreviewFile=!1,this.backToLink=""}openResultHistoryReview(e){this.examResultHistoryDialog=e}closeResultHistoryReview(e){e&&location.reload(),this.examResultHistoryDialog=void 0}onShowFile(e){this.isShowPreviewFile=!0,this.previewFile=e}onFileClose(){this.isShowPreviewFile=!1,this.previewFile=void 0}getAndProcessData(){var e,n;this.initStatusObj();let i=Number(this.activeRoute.snapshot.paramMap.get("exam_id")),a=null!==(e=this.activeRoute.snapshot.paramMap.get("user_id"))&&void 0!==e?e:"",r=null!==(n=this.activeRoute.snapshot.paramMap.get("student_id"))&&void 0!==n?n:"",l=Number(this.activeRoute.snapshot.paramMap.get("result_id"));this.getTestedUsers(()=>{this.examResultService.apiExamResultGetLastResultGet(i,a,r,l).subscribe(c=>{var _,d,m,p,w,C;1==c.success?(this.initDataLastResultExam=c,this.headerTitle=null!==(m=null===(d=null===(_=null==c?void 0:c.data)||void 0===_?void 0:_.examObj)||void 0===d?void 0:d.name)&&void 0!==m?m:"",this.translateMetaTitle(null===(w=null===(p=c.data)||void 0===p?void 0:p.examObj)||void 0===w?void 0:w.name),this.successStatusObj()):this.errorStatusObj(null!==(C=c.message)&&void 0!==C?C:"",!0)})})}getTestedUsers(e){let n=Number(this.activeRoute.snapshot.paramMap.get("result_id")),i=Number(this.activeRoute.snapshot.paramMap.get("exam_id"));var a=this.browserStorageService.getSimpleStorage(n+"_azt_setting_sort_desc_tested_by_time"),r=this.browserStorageService.getSimpleStorage(n+"_azt_setting_sort_tested_by_name"),l=this.browserStorageService.getSimpleStorage(n+"_azt_setting_sort_desc_tested_by_mark");this.testedListApiService.getTestedUserObjs("test_review",i,!0).subscribe(c=>{var _,d,m,p,w,C,A,M,D,q,U,F,tt,W,P,R;if(1==c.success){let N=[],B=[];a&&"true"==a?(N=this.sortService.sortTimeDESC(null!==(d=null===(_=null==c?void 0:c.data)||void 0===_?void 0:_.studentsNotInClassResults)&&void 0!==d?d:[]),B=this.sortService.sortTimeStudentsInClass(null!==(p=null===(m=null==c?void 0:c.data)||void 0===m?void 0:m.studentsInClassResults)&&void 0!==p?p:[],1),this.testedUserObjs=this.progressUserObjsList(N,B)):r&&"true"==r?(N=this.sortService.sortFirstNameStudents(null!==(C=null===(w=null==c?void 0:c.data)||void 0===w?void 0:w.studentsNotInClassResults)&&void 0!==C?C:[]),B=this.sortService.sortFirstNameStudentsInClass(null!==(M=null===(A=null==c?void 0:c.data)||void 0===A?void 0:A.studentsInClassResults)&&void 0!==M?M:[]),this.testedUserObjs=this.progressUserObjsList(N,B)):l&&"true"==l?(N=this.sortService.sortMarkDESC(null!==(q=null===(D=null==c?void 0:c.data)||void 0===D?void 0:D.studentsNotInClassResults)&&void 0!==q?q:[],!0),B=this.sortService.sortMarkStudentsInClass(null!==(F=null===(U=null==c?void 0:c.data)||void 0===U?void 0:U.studentsInClassResults)&&void 0!==F?F:[],1,!0),this.testedUserObjs=this.progressUserObjsList(N,B)):this.testedUserObjs=this.progressUserObjsList(null!==(W=null===(tt=null==c?void 0:c.data)||void 0===tt?void 0:tt.studentsNotInClassResults)&&void 0!==W?W:[],null!==(R=null===(P=null==c?void 0:c.data)||void 0===P?void 0:P.studentsInClassResults)&&void 0!==R?R:[])}e()})}progressUserObjsList(e,n){var i=[];return e.length>0&&e.forEach(a=>{a.resultId&&a.resultId>0&&i.push(a)}),n.forEach(a=>{var r;null===(r=null==a?void 0:a.results)||void 0===r||r.forEach(l=>{l.resultId&&l.resultId>0&&i.push(l)})}),i}translateMetaTitle(e){this.commonService.getTranslate("lang_auto_cham_de_thi").subscribe(n=>{this.commonService.translateMetaData({title:n+" "+e,description:n+e,image:"lang_cms_test_image"})})}ngOnInit(){var e,n,i,a,r,l;let c=Number(this.activeRoute.snapshot.paramMap.get("exam_id")),_=this.commonService.getMyQueryParam("backto"),d="/admin/testbank/exam-results-list/"+(null!==(i=null===(n=null===(e=this.initDataLastResultExam)||void 0===e?void 0:e.data)||void 0===n?void 0:n.examObj)&&void 0!==i&&i.categoryId?null===(l=null===(r=null===(a=this.initDataLastResultExam)||void 0===a?void 0:a.data)||void 0===r?void 0:r.examObj)||void 0===l?void 0:l.categoryId:0)+"/"+c+"/0";this.backToLink=_||d,this.getAndProcessData(),super.ngOnInit(),window.scrollTo(0,0)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(x.gz),t.Y36(Be.z),t.Y36(Ot.kS),t.Y36(pn.K),t.Y36(Fn))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-test-review"]],features:[t.qOj],decls:4,vars:3,consts:[[3,"headerBackTolink"],[4,"ngIf","ngIfElse"],["doneLoading",""],[3,"displayScreen","initDataResult","testedUserObjs","openResultHistory"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0),t.YNc(1,Db,1,0,"azt-loading-effect",1),t.YNc(2,jb,1,3,"ng-template",null,2,t.W1O),t.qZA()),2&e){const i=t.MAs(3);t.Q6J("headerBackTolink",n.backToLink),t.xp6(1),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i)}},dependencies:[O.O5,te.Q,Nb.K,de._],encapsulation:2}),o})();var Qb=b(73852);function Ub(o,s){1&o&&t._UZ(0,"azt-loading-effect")}function Fb(o,s){1&o&&(t.TgZ(0,"div",26),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_testted_list_teacher_confirmed")," "))}function Rb(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"azt-split-point",34),t.NdJ("closeDialog",function(){t.CHM(e);const i=t.oxw(4);return t.KtG(i.closeDialogSpitPoint())})("setPoint",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.setPointTest(i))}),t.qZA()}if(2&o){const e=t.oxw(4);t.Q6J("data",e.dataSpitPoint)}}function Bb(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",27)(1,"div",28)(2,"button",29),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.showAllResultQuestion())}),t._uU(3),t.ALo(4,"mytranslate"),t.ALo(5,"mytranslate"),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"button",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.openExamInfoDialog())}),t.ALo(8,"mytranslate"),t.TgZ(9,"mat-icon"),t._uU(10,"info"),t.qZA()()(),t.TgZ(11,"div",31)(12,"button",32),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.openDialogSpitPoint())}),t._uU(13),t.ALo(14,"mytranslate"),t.qZA(),t.YNc(15,Rb,1,1,"azt-split-point",33),t.qZA()()}if(2&o){const e=t.oxw(3);t.xp6(3),t.AsE(" ",0==e.defaultShowResultMedia?t.lcZ(4,5,"lang_testbank_update_exam_show"):t.lcZ(5,7,"lang_testbank_update_exam_hide")," ",t.lcZ(6,9,"lang_testbank_update_exam_explain")," "),t.xp6(4),t.s9C("matTooltip",t.lcZ(8,11,"lang_auto_chi_tiet_de_thi")),t.xp6(6),t.Oqu(t.lcZ(14,13,"lang_testbank_update_exam_split_points")),t.xp6(2),t.Q6J("ngIf",null==e.dataSpitPoint?null:e.dataSpitPoint.isShow)}}function Jb(o,s){1&o&&(t.TgZ(0,"span",41),t._uU(1,",\xa0"),t.qZA())}function Hb(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"b",39),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(5);let l;return t.KtG(r.goToQuestionAll(null!==(l=a.index)&&void 0!==l?l:0))}),t.ALo(2,"mytranslate"),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.YNc(5,Jb,2,0,"span",40),t.BQk()}if(2&o){const e=s.$implicit,n=s.index,i=t.oxw(5);let a;t.xp6(1),t.s9C("matTooltip",t.lcZ(2,4,"lang_testbank_create_exam_width_file_pdf_click_roll")),t.xp6(2),t.AsE("",t.lcZ(4,6,"lang_testbank_create_exam_width_file_pdf_question")," ",(null!==(a=e.index)&&void 0!==a?a:0)+1,""),t.xp6(2),t.Q6J("ngIf",n<i.invalidTypeQuestionConfig.length-1)}}function zb(o,s){if(1&o&&(t.ynx(0),t._uU(1),t.ALo(2,"mytranslate"),t.TgZ(3,"div",37),t.YNc(4,Hb,6,8,"ng-container",38),t.qZA(),t.BQk()),2&o){const e=t.oxw(4);t.xp6(1),t.hij(" ",t.lcZ(2,2,"lang_testbank_create_exam_width_file_pdf_check_configuration")," "),t.xp6(3),t.Q6J("ngForOf",e.invalidTypeQuestionConfig)}}function Yb(o,s){if(1&o&&(t.TgZ(0,"div",35)(1,"mat-icon",36),t._uU(2,"info_outlined"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.YNc(5,zb,5,4,"ng-container",3),t.qZA()),2&o){const e=t.oxw(3);t.xp6(3),t.hij(" ",t.lcZ(4,2,"lang_testbank_create_exam_width_file_pdf_cant_save")," "),t.xp6(2),t.Q6J("ngIf",e.invalidTypeQuestionConfig.length>0)}}function Gb(o,s){1&o&&(t.TgZ(0,"span",45),t._uU(1,"|"),t.qZA())}function $b(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"a",43),t.NdJ("click",function(i){const r=t.CHM(e).$implicit,l=t.oxw(4);return t.KtG(l.onShowFile(i,r,-1))}),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.YNc(4,Gb,2,0,"span",44),t.BQk()}if(2&o){const e=s.index,n=t.oxw(4);t.xp6(2),t.AsE("",t.lcZ(3,3,"lang_testbank_update_exam_image")," ",e+1,""),t.xp6(2),t.Q6J("ngIf",e<n.cropperData.length-1)}}function Wb(o,s){if(1&o&&(t.TgZ(0,"div",42),t._uU(1),t.ALo(2,"mytranslate"),t.YNc(3,$b,5,5,"ng-container",38),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.hij(" ",t.lcZ(2,2,"lang_testbank_update_exam_data_split_exam"),": "),t.xp6(2),t.Q6J("ngForOf",e.cropperData)}}function Kb(o,s){if(1&o&&t._UZ(0,"azt-loaded-img",46),2&o){const e=t.oxw(3);t.Q6J("imgSrc",e.examObj.examHeader)}}function Vb(o,s){if(1&o&&(t.TgZ(0,"div",53)(1,"p",54),t._uU(2),t.ALo(3,"mytranslate"),t.ALo(4,"mytranslate"),t.ALo(5,"mytranslate"),t.qZA(),t.TgZ(6,"div",55)(7,"span"),t._uU(8,"A."),t.qZA(),t.TgZ(9,"span"),t._uU(10,"B."),t.qZA(),t.TgZ(11,"span"),t._uU(12,"C."),t.qZA(),t.TgZ(13,"span"),t._uU(14,"D."),t.qZA()()()),2&o){const e=t.oxw(2).index;t.xp6(2),t.HOy("",t.lcZ(3,4,"lang_auto_cau")," ",e+1,": ",t.lcZ(4,6,"lang_auto_cau"),"\xa0",t.lcZ(5,8,"lang_auto_hoi_de_thi_offline")," ")}}function Xb(o,s){if(1&o&&(t.TgZ(0,"span",66),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.key," ")}}function tw(o,s){if(1&o&&(t.TgZ(0,"span",67),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.key," ")}}function ew(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li",63),t.NdJ("click",function(){const i=t.CHM(e),a=i.$implicit,r=i.index,l=t.oxw(3).$implicit,c=t.oxw(3);let _;return t.KtG(c.setAnswer({idQuestion:null!==(_=l.id)&&void 0!==_?_:0,event:a,type:2,isImage:!1,score:null!==(_=l.scorePerQuestion)&&void 0!==_?_:0,index:r}))}),t.YNc(1,Xb,2,1,"span",64),t.YNc(2,tw,2,1,"span",65),t.qZA()}if(2&o){const e=s.$implicit;t.xp6(1),t.Q6J("ngIf",!e.isTrue),t.xp6(1),t.Q6J("ngIf",e.isTrue)}}function nw(o,s){1&o&&(t.TgZ(0,"div",68)(1,"small",69),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij("* ",t.lcZ(3,1,"lang_testbank_update_exam_fixed_answer"),""))}function iw(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"a",70),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3).$implicit,a=t.oxw(3);let r;return t.KtG(a.showResultQuestion(null!==(r=i.id)&&void 0!==r?r:0))}),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()}2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_xem_giai_thich")))}function ow(o,s){if(1&o&&(t.TgZ(0,"div",56)(1,"div",57)(2,"ul",58),t.YNc(3,ew,3,2,"li",59),t.qZA()(),t.YNc(4,nw,4,3,"div",60),t.TgZ(5,"div",61),t.YNc(6,iw,3,3,"a",62),t.qZA()()),2&o){const e=t.oxw(2).$implicit;t.xp6(3),t.Q6J("ngForOf",e.answers),t.xp6(1),t.Q6J("ngIf",(null==e.name?null:e.name.startsWith("[PDFv2]"))&&e.isFixAns),t.xp6(2),t.Q6J("ngIf",e.answerMedia&&e.answerMedia.length>0)}}function aw(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"div"),t.YNc(2,Vb,15,10,"div",51),t.YNc(3,ow,7,3,"div",52),t.ALo(4,"isOneChoiceAnswer"),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngIf",e.content),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,2,e.answerType))}}function sw(o,s){1&o&&(t.TgZ(0,"div",93),t.ALo(1,"mytranslate"),t.O4$(),t.TgZ(2,"svg",94),t._UZ(3,"line",95)(4,"path",96),t.qZA()()),2&o&&t.s9C("matTooltip",t.lcZ(1,1,"lang_auto_dap_an_cua_cau_hoi_nay_da_duoc_co_dinh"))}function rw(o,s){1&o&&(t.TgZ(0,"div",86),t._uU(1,"|"),t.qZA())}function lw(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",97)(1,"div",98)(2,"mat-chip-list")(3,"mat-chip",99),t.NdJ("removed",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw(3);return t.KtG(a.setTag(i))}),t._uU(4),t.TgZ(5,"button",100)(6,"mat-icon",101),t._uU(7,"cancel"),t.qZA()()()()()()}if(2&o){const e=t.oxw(2).$implicit;t.xp6(4),t.hij(" ",e.tags[0].code," ")}}function cw(o,s){1&o&&(t.TgZ(0,"div",86),t._uU(1,"|"),t.qZA())}function _w(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"a",112),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(3).$implicit,l=t.oxw(3);return t.KtG(l.setTag(r,a))}),t._uU(2),t.qZA()()}if(2&o){const e=s.$implicit,n=t.oxw(6);let i;t.xp6(2),t.hij(" ",null!==(i=e[n.commonService.getCurrentLang()+"Name"])&&void 0!==i?i:e.enName," ")}}function dw(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",102)(1,"button",103),t.O4$(),t.TgZ(2,"svg",82),t._UZ(3,"path",104)(4,"path",105)(5,"path",106),t.qZA(),t.kcU(),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()(),t.TgZ(9,"mat-menu",null,107)(11,"div",108)(12,"ul",109),t.YNc(13,_w,3,1,"li",38),t.TgZ(14,"li"),t._UZ(15,"hr",110),t.qZA(),t.TgZ(16,"li")(17,"button",111),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw(3);return t.KtG(a.applyTagAll(i))}),t._uU(18),t.ALo(19,"mytranslate"),t.qZA()()()()()()}if(2&o){const e=t.MAs(10),n=t.oxw(2).$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("matMenuTriggerFor",e),t.xp6(6),t.Oqu(t.lcZ(8,5,"lang_teacher_set_tags")),t.xp6(6),t.Q6J("ngForOf",i.questionTags),t.xp6(4),t.Q6J("disabled",!n.tags),t.xp6(1),t.hij(" ",t.lcZ(19,7,"lang_teacher_apply_all_tags")," ")}}function uw(o,s){1&o&&(t.TgZ(0,"div",86),t._uU(1,"|"),t.qZA())}function mw(o,s){1&o&&(t.TgZ(0,"div",113),t.ALo(1,"mytranslate"),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()()),2&o&&(t.s9C("matTooltip",t.lcZ(1,2,"lang_testbank_create_exam_width_file_pdf_question_not_mix")),t.xp6(3),t.Oqu(t.lcZ(4,4,"lang_testbank_create_exam_width_file_pdf_not_mix")))}const hw=function(o){return{"d-none":o}},pw=function(o){return{"error-border":o}};function gw(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",71)(1,"div",72),t._UZ(2,"div",73)(3,"div",74),t.TgZ(4,"div",75),t.YNc(5,sw,5,3,"div",76),t.YNc(6,rw,2,0,"div",77),t.TgZ(7,"div",78),t.YNc(8,lw,8,1,"div",79),t.qZA(),t.YNc(9,cw,2,0,"div",77),t.YNc(10,dw,20,9,"div",80),t.YNc(11,uw,2,0,"div",77),t.TgZ(12,"div",81),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(3);return t.KtG(a.editQuestion(i))}),t.TgZ(13,"span"),t.O4$(),t.TgZ(14,"svg",82),t._UZ(15,"path",83)(16,"polyline",84)(17,"path",85),t.qZA(),t._uU(18),t.ALo(19,"mytranslate"),t.qZA()(),t.kcU(),t.TgZ(20,"div",86),t._uU(21,"|"),t.qZA(),t.TgZ(22,"div",87)(23,"span",88),t._uU(24),t.ALo(25,"mytranslate"),t.qZA(),t.TgZ(26,"input",89),t.NdJ("input",function(i){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw(3);let l;return t.KtG(r.setScore(i,null!==(l=a.id)&&void 0!==l?l:0))}),t.qZA()()()(),t.TgZ(27,"div",90)(28,"azt-standalone-question",91),t.NdJ("showResultQuestionEmit",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.showResultQuestion(i))})("setAnswerType4UpdateEmit",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.setAnswerType4(i))})("removeAnswerType4Emit",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.removeAnswerType4(i))})("setAnswerOnUpdateEmit",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.setAnswer(i))}),t.YNc(29,mw,5,6,"div",92),t.qZA()()()}if(2&o){const e=t.oxw(),n=e.index,i=e.$implicit,a=t.oxw(3);let r;t.s9C("id","question_"+n),t.xp6(5),t.Q6J("ngIf",i.isFixAns),t.xp6(1),t.Q6J("ngIf",i.isFixAns),t.xp6(2),t.Q6J("ngIf",i.tags&&i.tags.length>0),t.xp6(1),t.Q6J("ngIf",i.tags&&i.tags.length>0),t.xp6(1),t.Q6J("ngIf",a.questionTags.length>0),t.xp6(1),t.Q6J("ngIf",a.questionTags.length>0),t.xp6(7),t.hij(" ",t.lcZ(19,22,"lang_teacher_edit_content_exam"),""),t.xp6(5),t.Q6J("ngClass",t.VKq(26,hw,a.isMobile)),t.xp6(1),t.hij("",t.lcZ(25,24,"lang_testbank_update_exam_point"),":"),t.xp6(2),t.s9C("value",a.isDivinePointForQuestion?a.parseNumberFixed(null!==(r=i.scorePerQuestion)&&void 0!==r?r:0,8):i.scorePerQuestion),t.Q6J("ngClass",t.VKq(28,pw,null==i.scorePerQuestion||i.scorePerQuestion<0))("decimal",!0),t.xp6(2),t.Q6J("startQuestionIndex",a.examObj.startQuestionIndex)("follower",a.followerRenderQuest)("isBackEnd",!0)("displayScreen",8)("isMobile",a.isMobile)("examObj",a.examObj)("question",i)("index",n),t.xp6(1),t.Q6J("ngIf",(null==i.groupInfo?null:i.groupInfo.isFirstInGroup)&&(null==i.groupInfo?null:i.groupInfo.isFixGroup))}}function fw(o,s){if(1&o&&(t.TgZ(0,"div",116),t._UZ(1,"img",117),t.ALo(2,"mycdn"),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.s9C("src",t.lcZ(2,1,e.answerMedia),t.LSH)}}function xw(o,s){if(1&o&&(t.TgZ(0,"div",116)(1,"div",118),t._UZ(2,"span",119),t.qZA()()),2&o){const e=t.oxw(2).$implicit;t.xp6(2),t.Q6J("innerHtml",e.answerMedia,t.oJD)}}function vw(o,s){if(1&o&&(t.TgZ(0,"div",114),t.YNc(1,fw,3,3,"div",115),t.YNc(2,xw,3,1,"div",115),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",1==e.isImage),t.xp6(1),t.Q6J("ngIf",0==e.isImage)}}function bw(o,s){if(1&o&&(t.TgZ(0,"div",47)(1,"div",48),t.YNc(2,aw,5,4,"ng-container",1),t.ALo(3,"isOfflineExam"),t.YNc(4,gw,30,30,"ng-template",null,49,t.W1O),t.YNc(6,vw,3,2,"div",50),t.qZA()()),2&o){const e=s.$implicit,n=t.MAs(5),i=t.oxw(3);t.xp6(2),t.Q6J("ngIf",t.lcZ(3,3,null==i.examObj?null:i.examObj.orcLogId))("ngIfElse",n),t.xp6(4),t.Q6J("ngIf",e.showResultMedia)}}function ww(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",5)(2,"div",6)(3,"div",7),t._UZ(4,"input",8),t.qZA(),t.TgZ(5,"div",9)(6,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.goBack())}),t._uU(7),t.ALo(8,"mytranslate"),t.qZA(),t.TgZ(9,"button",11),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.handleSubmitSaveExam())}),t._uU(10),t.ALo(11,"mytranslate"),t.qZA()()(),t.TgZ(12,"div",12)(13,"div",13)(14,"div",14),t.YNc(15,Fb,3,3,"div",15),t.YNc(16,Bb,16,15,"div",16),t.YNc(17,Yb,6,4,"div",17),t.YNc(18,Wb,4,4,"div",18),t.TgZ(19,"div",19),t.YNc(20,Kb,1,1,"azt-loaded-img",20),t.YNc(21,bw,7,5,"div",21),t.qZA()()()(),t.TgZ(22,"div",22),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.scrollDown())}),t.O4$(),t.TgZ(23,"svg",23),t._UZ(24,"polyline",24)(25,"polyline",25),t.qZA()()(),t.BQk()}if(2&o){const e=t.oxw(2);t.xp6(4),t.Q6J("formControl",e.nameExamInp),t.xp6(3),t.Oqu(t.lcZ(8,10,"lang_buttom_cancel")),t.xp6(2),t.Q6J("disabled",""===e.nameExamInp.value.trim()||e.nameExamInp.errors||e.invalidTypeQuestionConfig.length>0),t.xp6(1),t.Oqu(t.lcZ(11,12,"lang_buttom_save")),t.xp6(5),t.Q6J("ngIf",0===e.questionObjs.length),t.xp6(1),t.Q6J("ngIf",e.questionObjs.length>0),t.xp6(1),t.Q6J("ngIf",e.invalidTypeQuestionConfig.length>0),t.xp6(1),t.Q6J("ngIf",e.cropperData&&e.cropperData.length>0),t.xp6(2),t.Q6J("ngIf",e.examObj.examHeader),t.xp6(1),t.Q6J("ngForOf",e.questionObjs)}}function Tw(o,s){1&o&&(t.TgZ(0,"div",120)(1,"span",121),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_testbank_update_exam_not_access_rights"),"! "))}function Cw(o,s){if(1&o&&(t.YNc(0,ww,26,14,"ng-container",1),t.ALo(1,"editPermission"),t.YNc(2,Tw,4,3,"ng-template",null,4,t.W1O)),2&o){const e=t.MAs(3),n=t.oxw();t.Q6J("ngIf",t.xi3(1,2,n.examObj.permissionObj,"exam"))("ngIfElse",e)}}function Aw(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"azt-preview-media",122),t.NdJ("closePreview",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onFileClose())}),t.ALo(2,"mytranslate"),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("linkUrl",e.previewFile)("typePreview",1)("fileNameCustom",t.lcZ(2,3,"lang_auto_du_lieu_cat_de"))}}function yw(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"azt-exam-info",123),t.NdJ("closeDialog",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeDialogExamInfo())}),t.qZA()()}if(2&o){const e=t.oxw();let n;t.xp6(1),t.Q6J("startIndexQuestion",null!==(n=e.examObj.startQuestionIndex)&&void 0!==n?n:1)("data",e.dataExamInfo)}}const Ow=[{path:"",component:Bx,canActivate:[Bl.v],children:[{path:"create-new-document/:cat_id",component:fh},{path:"azota-editor/:cat_id",component:Si},{path:"azota-editor/:cat_id/:quest_id",component:Si},{path:"mix-bank-template/:cat_id",component:mv},{path:"document-management/:type/:cat_id/:page",component:po.Vn},{path:"action-online-offline/:cat_id/:hash_id",component:pu},{path:"config-exam-offline/:cat_id/:hash_id",component:Iu},{path:"config-exam-online/:cat_id/:hash_id",component:Cm},{path:"config-homework/:cat_id/:hash_id",component:Po},{path:"config-homework/:cat_id",component:Po},{path:"download-file-print/:cat_id/:hash_id/:offline_hash_id",component:Ph},{path:"exam-results-list/:cat_id/:id/:result_id",component:O1},{path:"publish-document/:type/:cat_id/:hash_id",component:Iv},{path:"all-documents-in-class/:class_id/:page",component:yu},{path:"homework-results-list/:cat_id/:id/:hash_id",component:Rx},{path:"create-file-pdf-ver2/:cat_id",component:j_},{path:"create-exam-by-excel/:cat_id",component:Wm},{path:"create-exam-by-hand/:cat_id",component:hh},{path:"test-review/:exam_id/:user_id/:student_id/:result_id",component:qb},{path:"test-result-tracking/:exam_id/:user_id/:student_id/:result_id",component:Lb},{path:"statistic/:cat_id/:id",component:Ib},{path:"update-exam/:cat_id/:id",component:(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_,d,m){super(i),this.dialog=e,this.fb=n,this.commonService=i,this.questionService=a,this.examService=r,this.activeRoute=l,this.questionInterfaceService=c,this.permissionService=_,this.docxService=d,this.answerTypeService=m,this.questionTags=[],this.form=new h.nJ({}),this.questionObjs=[],this.followerRenderQuest=new Ci.G,this.defaultShowResultMedia=!1,this.cur_cateId=0,this.examId=0,this.examObj={},this.firstInGroupIndexes=[],this.nameExamInp=new h.p4("",[Pn._.noWhiteSpace]),this.newAnswerList=[],this.isMobile=this.commonService.isMobileOrTable(),this.backToLink="",this.countTrueFalseQuestion=0,this.invalidTotalQuestion=!1,this.isDivinePointForQuestion=!1,this.separatorKeysCodes=[zi.K5],this.selectable=!0,this.removable=!0,this.addOnBlur=!0,this.isLoadingSave=!1,this.isShowPreviewFile=!1,this.dataSpitPoint={isShow:!1},this.dataExamInfo={isShow:!1}}onWindowScroll(){let e=document.getElementById("np-name-root");window.pageYOffset>30?null==e||e.classList.add("fixToolBar"):null==e||e.classList.remove("fixToolBar")}scrollDown(){let e=document.getElementById("azt-layout");console.log(e),e.scrollIntoView()}editQuestion(e){var n,i;if(this.examObj.editable){let a=`/admin/testbank/update-exam/${null!=this.cur_cateId?this.cur_cateId:0}/${this.examId}`;window.location=this.commonService.getLocalRouter("/admin/testbank/azota-editor/"+(null!=this.cur_cateId?this.cur_cateId:0))+"/"+e.id+"?backto="+encodeURIComponent(a)+"&r="+((null!==(n=e.rawIndex)&&void 0!==n?n:0)+(null!==(i=this.examObj.startQuestionIndex)&&void 0!==i?i:1)-1)}else this.openDialogWaring("lang_auto_not_edit_content_question")}openDialogWaring(e){this.commonService.getTranslate(e).subscribe(n=>{this.dialog.open(bi._,{data:{isShow:!0,content:n}})})}setTag(e,n){e.tags=n?[n]:[]}applyTagAll(e){for(let i=this.questionObjs.indexOf(e)+1;i<this.questionObjs.length;i++)this.questionObjs[i].tags=e.tags}openDialogSpitPoint(){if(this.dataSpitPoint){let e=this.trueFalseCounter(this.questionObjs),n=this.questionObjs.length-e,i={multipleQuestion:e,multiplePoint:parseFloat(this.maxPointCounter(this.questionObjs)).toFixed(2),essayQuestion:n,essayPoint:parseFloat(this.essayPointCounter(this.questionObjs)).toFixed(2)};this.dataSpitPoint={isShow:!0,obj:i}}}closeDialogSpitPoint(){this.dataSpitPoint&&(this.dataSpitPoint.isShow=!1)}get invalidTypeQuestionConfig(){return this.questionObjs.filter(e=>{var n,i;return null==e.scorePerQuestion||e.scorePerQuestion<0||!isFinite(null!==(n=e.scorePerQuestion)&&void 0!==n?n:0)||!(null!==(i=e.answerResult)&&void 0!==i&&i.length)&&this.answerTypeService.isFillAnswer(e.answerType)})}goToQuestionAll(e,n=150){document.getElementById("question_"+e).scrollIntoView()}enableScroll(){window.onscroll=()=>{}}disableScroll(){let e=window.pageYOffset||document.documentElement.scrollLeft,n=window.pageXOffset||document.documentElement.scrollTop;window.onscroll=()=>{window.scrollTo(e,n)}}onFileClose(){this.enableScroll(),this.isShowPreviewFile=!1,this.previewFile=void 0}onShowFile(e,n,i){this.isShowPreviewFile=!0,this.disableScroll(),this.previewFile=n}goBack(){this.commonService.myNavigation(this.backToLink)}showAllResultQuestion(){this.viewQuestions.forEach(e=>{e.isShowExplain=!this.defaultShowResultMedia}),this.defaultShowResultMedia=!this.defaultShowResultMedia}showResultQuestion(e){this.viewQuestions.forEach(n=>{n.id==e&&(n.isShowExplain=!n.isShowExplain)})}convertData(e){for(var n=[],i=0;i<e.length;i++)e[i].content&&n.push(e[i].content);return JSON.stringify(n)}keepAnswerResult(e){for(var n,i=[],a=0;a<e.length;a++)i.push({id:e[a].id,answerResult:JSON.stringify(e[a].answerResult),scorePerQuestion:e[a].scorePerQuestion,tags:null===(n=e[a].tags)||void 0===n?void 0:n.map(r=>{var l;return null!==(l=r.code)&&void 0!==l?l:""})});return i}handleSubmitSaveExam(){if(!0!==this.isLoadingSave)if(this.permissionService.hasEditPermission("exam",this.examObj.permissionObj)){let e=!1,n=0;this.questionObjs.forEach(i=>{var a;if(3!=i.answerType&&0==(null===(a=i.answerResult)||void 0===a?void 0:a.length)){i.errorValidateQuestion=!0,e=!0;let r=document.getElementById("question_"+n);null==r||r.scrollIntoView()}n++}),this.newAnswerList.length>0?this.newAnswerList.forEach(i=>{var a,r=this.questionObjs.filter(l=>l.id==i.id);null!=r&&r.length>0&&!this.answerTypeService.isFillAnswer(r[0].answerType)&&i.answerResultParse&&i.answerResultParse.length>0&&(i.answerResult=this.convertData(null!==(a=i.answerResultParse)&&void 0!==a?a:[]))}):this.newAnswerList=this.keepAnswerResult(this.questionObjs),e?this.showErrorSnack("lang_auto_vui_long_nhap_dap_an_cho_cau_hoi"):(this.isLoadingSave=!0,this.initStatusObj(),this.subscriptions.add(this.questionService.apiQuestionUpdateAnswerResultsWithExamNamePost({examId:this.examId,examName:this.nameExamInp.value,answerResults:this.newAnswerList}).subscribe(a=>{var r;1==a.success?(this.newAnswerList=new Array,this.getData(),this.successStatusObj("lang_cms_update_success",!0),this.isLoadingSave=!1):(this.newAnswerList=new Array,this.errorStatusObj(null!==(r=a.message)&&void 0!==r?r:"",!0),this.isLoadingSave=!1)})))}else this.showErrorSnack("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay")}setAnswer(e){var n,i,a,r=this.newAnswerList.filter(d=>d.id==e.idQuestion);if(null!=e.index&&1==e.type){var l={id:e.idQuestion,answerResultParse:[{index:e.index,content:e.isImage?e.event.content:e.event.key}],scorePerQuestion:e.score};if(r&&r.length>0)for(var c=0;c<this.newAnswerList.length;c++)this.newAnswerList[c].id==l.id&&(null===(n=this.newAnswerList[c].answerResultParse)||void 0===n||n.push(null!==(a=null===(i=l.answerResultParse)||void 0===i?void 0:i[0])&&void 0!==a?a:{}),this.newAnswerList[c].answerResult=JSON.stringify(this.newAnswerList[c].answerResultParse));else l.answerResult=JSON.stringify(l.answerResultParse),this.newAnswerList.push(l);this.changeStatusAnswer(l,e.index,!0,e.isImage)}else if(null!=e.index&&2==e.type){var _={id:e.idQuestion,answerResult:JSON.stringify([{index:e.index,content:e.isImage?e.event.content:e.event.key}]),answerResultParse:[{index:e.index,content:e.isImage?e.event.content:e.event.key}],scorePerQuestion:e.score};if(r&&r.length>0)for(c=0;c<this.newAnswerList.length;c++)this.newAnswerList[c].id==_.id&&(this.newAnswerList[c].answerResult=_.answerResult,this.newAnswerList[c].answerResultParse=_.answerResultParse);else this.newAnswerList.push(_);this.changeStatusAnswer(_,e.index,!1,e.isImage)}}setAnswerType4(e){const n=(e.event.value||"").trim();if(n){var i=this.newAnswerList.filter(a=>a.id==e.questionId);this.questionObjs.forEach(a=>{if(a.id==e.questionId){n.split("|").forEach(c=>{var _;null===(_=a.answerResult)||void 0===_||_.push(c.trim())}),a.onChanges=!0;var r={id:a.id,answerResult:JSON.stringify(a.answerResult),scorePerQuestion:a.scorePerQuestion};null!=i&&i.length>0?this.newAnswerList.forEach(c=>{c.id==e.questionId&&(c.answerResult=JSON.stringify(a.answerResult))}):this.newAnswerList.push(r)}})}this.questionObjs.forEach(a=>{var r;a.errorValidateQuestion=3!=a.answerType&&0==(null===(r=a.answerResult)||void 0===r?void 0:r.length)}),e.event.input.value=""}removeAnswerType4(e){var n=this.newAnswerList.filter(i=>i.id==e.questionId);this.questionObjs.forEach(i=>{var a,r,l;if(i.id==e.questionId){var c=null!==(r=null===(a=i.answerResult)||void 0===a?void 0:a.indexOf(e.answerObj))&&void 0!==r?r:0;if(c>=0){null===(l=i.answerResult)||void 0===l||l.splice(c,1);var _={id:i.id,answerResult:JSON.stringify(i.answerResult),scorePerQuestion:i.scorePerQuestion};null!=n&&n.length>0?this.newAnswerList.forEach(d=>{d.id==e.questionId&&(d.answerResult=JSON.stringify(i.answerResult))}):this.newAnswerList.push(_)}}})}changeStatusAnswer(e,n,i,a){i||this.questionObjs.forEach(r=>{if(r.id==e.id&&r.answers&&r.answers.length>0){for(var l=0;l<r.answers.length;l++)r.answers[l].isTrue=!1;r.answers[n].isTrue=!0}})}setPointTest(e){let n=Number(e.multiplePoint)/this.countTrueFalseQuestion,i=0;this.questionObjs.length-this.countTrueFalseQuestion>0&&(i=Number(e.essayPoint)/(this.questionObjs.length-this.countTrueFalseQuestion));for(let a=0;a<this.questionObjs.length;a++){let r=!1;if(this.answerTypeService.isOneChoiceAnswer(this.questionObjs[a].answerType)||this.answerTypeService.isFillAnswer(this.questionObjs[a].answerType)){this.questionObjs[a].scorePerQuestion=Number(this.parseNumberFixed(n,8));for(let l=0;l<this.newAnswerList.length;l++)if(this.newAnswerList[l].id==this.questionObjs[a].id){this.newAnswerList[l].scorePerQuestion=Number(this.parseNumberFixed(n,8)),r=!0;break}}else if(this.answerTypeService.isEssayAnswer(this.questionObjs[a].answerType)){this.questionObjs[a].scorePerQuestion=Number(this.parseNumberFixed(i,8));for(let l=0;l<this.newAnswerList.length;l++)if(this.newAnswerList[l].id==this.questionObjs[a].id){this.newAnswerList[l].scorePerQuestion=Number(this.parseNumberFixed(i,8)),r=!0;break}}if(!r){let l={id:this.questionObjs[a].id,answerResult:JSON.stringify(this.questionObjs[a].answerResult),scorePerQuestion:this.questionObjs[a].scorePerQuestion};this.newAnswerList.push(l)}}this.showSuccessSnack("lang_auto_chia_diem_thanh_cong"),this.dataSpitPoint&&(this.dataSpitPoint.isShow=!1)}setPointQuestion(){var e=this.commonService.getFormObj(this.form);if(e.totalQuestion<=this.countTrueFalseQuestion){this.invalidTotalQuestion=!1;var n=e.maxScore/e.totalQuestion;this.questionObjs.forEach(i=>{if(this.answerTypeService.isOneChoiceAnswer(i.answerType)||this.answerTypeService.isFillAnswer(i.answerType)){i.scorePerQuestion=n;for(var a=0;a<this.newAnswerList.length;a++)if(this.newAnswerList[a].id==i.id){this.newAnswerList[a].scorePerQuestion=n;break}}}),this.isDivinePointForQuestion=!0,this.showSuccessSnack("lang_auto_chia_diem_thanh_cong")}else this.invalidTotalQuestion=!0,this.showErrorSnack("lang_auto_so_cau_ban_nhap_da_vuot_qua_so_cau_trac_nghiem_trong_de_thi")}setScore(e,n){var i,a;for(let l=0;l<this.questionObjs.length;l++){let c=isNaN(parseFloat(e.target.value))?void 0:parseFloat(e.target.value);if(this.questionObjs[l]&&this.questionObjs[l].id==n&&(this.questionObjs[l].scorePerQuestion=c,this.newAnswerList.length>0)){let _=!1;for(var r=0;r<this.newAnswerList.length;r++)if(this.newAnswerList[r].id==this.questionObjs[l].id){this.newAnswerList[r].scorePerQuestion=c,_=!0;break}if(!_){let d=Array.isArray(this.questionObjs[l].answerResult)&&(null===(i=this.questionObjs[l].answerResult)||void 0===i?void 0:i.length)?null===(a=this.questionObjs[l].answerResult)||void 0===a?void 0:a[0]:"";this.newAnswerList.push({id:this.questionObjs[l].id,answerResult:JSON.stringify(this.questionObjs[l].answerResult),answerResultParse:[{content:d}],scorePerQuestion:parseFloat(e.target.value)})}}}}trueFalseCounter(e){var n=0;return e.forEach(i=>{(this.answerTypeService.isOneChoiceAnswer(i.answerType)||this.answerTypeService.isFillAnswer(i.answerType))&&n++}),n}maxPointCounter(e){var n=0;return e.forEach(i=>{var a;(this.answerTypeService.isOneChoiceAnswer(i.answerType)||this.answerTypeService.isFillAnswer(i.answerType))&&(n+=null!==(a=i.scorePerQuestion)&&void 0!==a?a:0)}),this.parseNumberFixed(n,4)}essayPointCounter(e){var n=0;return e.forEach(i=>{var a;!this.answerTypeService.isOneChoiceAnswer(i.answerType)&&!this.answerTypeService.isFillAnswer(i.answerType)&&(n+=null!==(a=i.scorePerQuestion)&&void 0!==a?a:0)}),n.toString()}parseNumberFixed(e,n){let i=Number(parseFloat(e.toString()).toFixed(n));return isNaN(i)?"0":parseFloat(e.toString()).toFixed(n)}convertErrsResultQuestions(){for(let e=0;e<this.questionObjs.length;e++)null===this.questionObjs[e].answerResult&&(this.questionObjs[e].answerResult=[])}changeAnswerResultStatus(e){var n=[];let i=0;return e.forEach(a=>{var r;if(a.index=i,i++,a.answers&&a.answerResult)for(let l=0;l<a.answers.length;l++)a.answers[l].questionId=a.id,a.answers[l].checked=!1,a.answers[l].isTrue=!!this.checkAnswerResult(null!==(r=a.answers[l].key)&&void 0!==r?r:"",a.answerResult);n.push(a)}),n}checkAnswerResult(e,n){var i=!1;for(var a in n){if(n[a]==e){i=!0;break}i=!1}return i}getData(){this.initStatusObj(),this.subscriptions.add(this.examService.apiExamGetQuestionsIdGet(this.examId).subscribe(e=>{var n,i,a,r,l,c,_,d,m;if(1==e.success){this.examObj=null!==(i=null===(n=e.data)||void 0===n?void 0:n.examObj)&&void 0!==i?i:{},this.firstInGroupIndexes=null!==(r=this.commonService.myParseJson(null!==(a=this.examObj.firstInGroupIndexes)&&void 0!==a?a:""))&&void 0!==r?r:[],this.nameExamInp.setValue(null!==(l=this.examObj.name)&&void 0!==l?l:"");let p=this.commonService.castJsonToClassObjs(on.v,JSON.stringify(null===(c=e.data)||void 0===c?void 0:c.questionObjs));const w=this.changeAnswerResultStatus(null!=p?p:[]);this.followerRenderQuest.setNumQuest(w.length),this.questionObjs=w,this.cropperData=null!==(d=this.commonService.myParseJson(null!==(_=this.examObj.labelsUrl)&&void 0!==_?_:""))&&void 0!==d?d:[],this.docxService.replaceCanvasBackgroundTS(this.questionObjs),this.countTrueFalseQuestion=this.trueFalseCounter(this.questionObjs),this.convertErrsResultQuestions(),this.form=this.fb.group({maxScore:new h.p4(this.maxPointCounter(this.questionObjs),[h.kI.required]),totalQuestion:new h.p4(this.trueFalseCounter(this.questionObjs),[h.kI.required])}),this.successStatusObj(),this.questionService.apiQuestionGetTagsGet().subscribe(C=>{var A;1==C.success&&C.data&&(this.questionTags=null!==(A=C.data.objs)&&void 0!==A?A:[])})}else this.showErrorSnack(null!==(m=e.message)&&void 0!==m?m:"")}))}openExamInfoDialog(){this.dataExamInfo={isShow:!0,obj:this.questionObjs}}closeDialogExamInfo(){this.dataExamInfo.isShow=!1}ngOnInit(){(0,Xt.aj)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var e,n;this.cur_cateId=null!==(e=Number(this.commonService.getMyParam(this.activeRoute,"cat_id")))&&void 0!==e?e:0,this.examId=null!==(n=Number(this.commonService.getMyParam(this.activeRoute,"id")))&&void 0!==n?n:0;var i=this.commonService.getMyQueryParam("backto");this.backToLink=i||"/admin/testbank/document-management/0/"+(null!=this.cur_cateId?this.cur_cateId:0)+"/1",this.getData()}),this.commonService.translateMetaData({title:"lang_cms_test_update_exam_title",description:"lang_cms_test_update_exam_description",image:"lang_cms_test_image"}),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(j.uw),t.Y36(h.QS),t.Y36(vt.v),t.Y36(Ot.aE),t.Y36(Ot.Oe),t.Y36(x.gz),t.Y36(Ti.U),t.Y36(Xe.$),t.Y36(Vi.x),t.Y36(nn.T))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-update-exam"]],viewQuery:function(e,n){if(1&e&&t.Gf(Kn.$,5),2&e){let i;t.iGM(i=t.CRH())&&(n.viewQuestions=i)}},hostBindings:function(e,n){1&e&&t.NdJ("scroll",function(a){return n.onWindowScroll(a)},!1,t.Jf7)},features:[t.qOj],decls:7,vars:8,consts:[[3,"headerTitle","headerBackTolink"],[4,"ngIf","ngIfElse"],["doneLoading",""],[4,"ngIf"],["noPermission",""],["id","box-create-action",1,"simple-exam-box"],["id","down-page",1,"grid","grid-cols-12","gap-5",2,"width","100%","margin","20px auto"],[1,"mb-1","lg:col-span-8","sm:col-span-6","col-span-12"],["type","text",1,"inputMobile","form-control",3,"formControl"],[1,"text-center","h-9","flex","col-span-12","lg:col-span-4","sm:col-span-6"],[1,"btn","btn-reload","mr-3",3,"click"],[1,"btn","btn-save",3,"disabled","click"],[1,"container-fluid","mb-5","mt-3"],[1,"block-cols-12-full","m-0"],["id","box-left-file",1,"box-file",2,"width","100%"],["class","box-control text-center",4,"ngIf"],["class","flex items-center","style","justify-content: space-between",4,"ngIf"],["class","p-2 mt-2 mb-2 alert alert-danger text-center",4,"ngIf"],["id","box-cropper-data","class","mt-3",4,"ngIf"],[1,"box-questions","mt-3"],["style","display: block","class","mb-1",3,"imgSrc",4,"ngIf"],["class","box-questions-item mb-2","style","position: relative",4,"ngFor","ngForOf"],[1,"toolBarMobile","clickable",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",2,"color","white"],["points","17 11 12 6 7 11"],["points","17 18 12 13 7 18"],[1,"box-control","text-center"],[1,"flex","items-center",2,"justify-content","space-between"],[1,"box-control","text-left","col-span-6"],["mat-button","",1,"btn","btn-show",3,"click"],["mat-button","",1,"btn-detail",2,"margin-left","10px",3,"matTooltip","click"],[1,"col-span-6","flex","justify-end"],["mat-button","",1,"btn","btn-set-score",3,"click"],[3,"data","closeDialog","setPoint",4,"ngIf"],[3,"data","closeDialog","setPoint"],[1,"p-2","mt-2","mb-2","alert","alert-danger","text-center"],[2,"vertical-align","bottom"],[1,"error-block"],[4,"ngFor","ngForOf"],[1,"clickable","mt-1",3,"matTooltip","click"],["class","mt-1",4,"ngIf"],[1,"mt-1"],["id","box-cropper-data",1,"mt-3"],[1,"text-primary",3,"click"],["class","mx-1","style","color: #6c6c6c",4,"ngIf"],[1,"mx-1",2,"color","#6c6c6c"],[1,"mb-1",2,"display","block",3,"imgSrc"],[1,"box-questions-item","mb-2",2,"position","relative"],[1,"w-100"],["elseTemplate",""],["class","card question-card","style","box-shadow: none",4,"ngIf"],["class","card question-card mb-0 p-2","style","box-shadow: none; overflow: hidden",4,"ngIf"],["class","answer-box ml-auto mr-auto",4,"ngIf"],[1,"card","question-card","mb-0","p-2",2,"box-shadow","none","overflow","hidden"],[1,"question-offline-title"],[1,"question-offline-answer"],[1,"answer-box","ml-auto","mr-auto"],[1,"list-answer","mt-auto","mb-auto"],[1,"listda","mt-0","mb-0","pl-0"],["class","listli",3,"click",4,"ngFor","ngForOf"],["class","flex items-center",4,"ngIf"],[1,"flex","float-right"],["class","clickable show_explain mr-3","style","user-select: none",3,"click",4,"ngIf"],[1,"listli",3,"click"],["class","no-answered","style","background: #fff; color: #111",4,"ngIf"],["class","no-answered","style","background-color: rgba(243, 156, 18, 1); color: rgb(255, 255, 255)",4,"ngIf"],[1,"no-answered",2,"background","#fff","color","#111"],[1,"no-answered",2,"background-color","rgba(243, 156, 18, 1)","color","rgb(255, 255, 255)"],[1,"flex","items-center"],[2,"color","#fff"],[1,"clickable","show_explain","mr-3",2,"user-select","none",3,"click"],[3,"id"],[1,"edit-question-header","box"],[1,"edit-question-header-left"],[1,"edit-question-header-center"],[1,"edit-question-header-right"],["class","fix-answer",3,"matTooltip",4,"ngIf"],["class","edit-question-header-dr",4,"ngIf"],[1,"edit-question-header-show-tags"],["class","box-service-type no-wrap",4,"ngIf"],["class","edit-question-header-tag",4,"ngIf"],[1,"edit-question-header-content",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-1"],["d","M4 13.5V4a2 2 0 0 1 2-2h8.5L20 7.5V20a2 2 0 0 1-2 2h-5.5"],["points","14 2 14 8 20 8"],["d","M10.42 12.61a2.1 2.1 0 1 1 2.97 2.97L7.95 21 4 22l.99-3.95 5.43-5.44Z"],[1,"edit-question-header-dr"],[1,"edit-question-header-point"],[2,"font-weight","500",3,"ngClass"],["type","text","appOnlyNumber","",1,"point-input","form-control",3,"ngClass","decimal","value","input"],[1,"card","question-card","mb-0",2,"box-shadow","none"],[1,"mb-0","relative","overflow-hidden",3,"startQuestionIndex","follower","isBackEnd","displayScreen","isMobile","examObj","question","index","showResultQuestionEmit","setAnswerType4UpdateEmit","removeAnswerType4Emit","setAnswerOnUpdateEmit"],["class","fix-group",3,"matTooltip",4,"ngIf"],[1,"fix-answer",3,"matTooltip"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide"],["x1","12","y1","17","x2","12","y2","22"],["d","M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"],[1,"box-service-type","no-wrap"],[1,"first-text"],[1,"tag-chip",3,"removed"],["matChipRemove",""],[2,"font-size","15px"],[1,"edit-question-header-tag"],[3,"matMenuTriggerFor"],["d","M9 5H2v7l6.29 6.29c.94.94 2.48.94 3.42 0l3.58-3.58c.94-.94.94-2.48 0-3.42L9 5Z"],["d","M6 9.01V9"],["d","m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19"],["tags","matMenu"],[1,"dropdown-menu","show","relative","w-56"],[1,"dropdown-content"],[1,"dropdown-divider","border-slate-200","dark:border-darkmode-400"],[1,"dropdown-item","w-full",3,"disabled","click"],[1,"dropdown-item",3,"click"],[1,"fix-group",3,"matTooltip"],[1,"card","question-card",2,"box-shadow","none"],["class","card-body pt-1 pb-1 pl-0 pr-0 MW-800",4,"ngIf"],[1,"card-body","pt-1","pb-1","pl-0","pr-0","MW-800"],["alt","question media",1,"img-fluid","img_respon",3,"src"],[1,"contentDocx",2,"max-width","80%","margin-left","10%"],[3,"innerHtml"],[1,"alert","alert-danger","flex-center-box"],[1,"title-no-permission"],[3,"linkUrl","typePreview","fileNameCustom","closePreview"],[3,"startIndexQuestion","data","closeDialog"]],template:function(e,n){if(1&e&&(t.TgZ(0,"teacher-layout",0),t.ALo(1,"mytranslate"),t.YNc(2,Ub,1,0,"azt-loading-effect",1),t.YNc(3,Cw,4,5,"ng-template",null,2,t.W1O),t.qZA(),t.YNc(5,Aw,3,5,"div",3),t.YNc(6,yw,2,2,"div",3)),2&e){const i=t.MAs(4);t.Q6J("headerTitle",t.lcZ(1,6,"lang_testbank_update_exam_exam"))("headerBackTolink",n.backToLink),t.xp6(2),t.Q6J("ngIf",n.statusObj.loading)("ngIfElse",i),t.xp6(3),t.Q6J("ngIf",n.isShowPreviewFile),t.xp6(1),t.Q6J("ngIf",n.dataExamInfo.isShow)}},dependencies:[O.mk,O.sg,O.O5,tn.lW,ke.qn,ke.HS,ke.qH,ge.Hw,he.VK,he.p6,Wt.gM,h.Fj,h.JJ,h.oH,ea.l,te.Q,Qb.x,un.Y,Ao,yo,Kn.$,de._,at.bT,at.GT,at.BU,at.HU,at.DC],styles:["#box-create-action[_ngcontent-%COMP%]   #resizeBox[_ngcontent-%COMP%]{margin-left:50%;width:10px;position:fixed;height:100vh;cursor:col-resize}#box-create-action[_ngcontent-%COMP%]   #resizeBox[_ngcontent-%COMP%]   .resizeContent[_ngcontent-%COMP%]{height:100vh;width:10px}#box-create-action[_ngcontent-%COMP%]   .inp-name-root[_ngcontent-%COMP%]{position:fixed;top:0;width:70%;left:15%;display:flex;justify-content:center;align-items:center;height:45px}#box-create-action[_ngcontent-%COMP%]   .inp-name-root[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;font-weight:500;color:#555;text-align:center;width:100%}#box-create-action[_ngcontent-%COMP%]   .box-control[_ngcontent-%COMP%]{justify-content:left;align-items:center}#box-create-action[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]{background:#4050b5;color:#fff;padding:5px 20px;width:100%;font-size:small;transition:all .5s}#box-create-action[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]:hover{background:#133864}#box-create-action[_ngcontent-%COMP%]   .btn-set-score[_ngcontent-%COMP%]{text-transform:initial;background:#2361ae;color:#fff;font-size:small;transition:all .5s}#box-create-action[_ngcontent-%COMP%]   .btn-set-score[_ngcontent-%COMP%]:hover{background:#133864}#box-create-action[_ngcontent-%COMP%]   .btn-show[_ngcontent-%COMP%]{text-transform:initial;background:#fff;border:1px solid #eee;color:#000;font-size:small;transition:all .5s}#box-create-action[_ngcontent-%COMP%]   .btn-show[_ngcontent-%COMP%]{background:#eee}#box-create-action[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{background:#9e9e9e;color:#fff;padding:5px 20px;font-size:small;text-align:center;width:100%}#box-create-action[_ngcontent-%COMP%]   .btn-reload[_ngcontent-%COMP%]{background:#fff;color:#000;border:1px solid #000;padding:5px 20px;font-size:small;text-align:center;width:100%;transition:all .5}#box-create-action[_ngcontent-%COMP%]   .btn-reload[_ngcontent-%COMP%]:hover{background:#eee}#box-create-action[_ngcontent-%COMP%]   .box-file[_ngcontent-%COMP%]{width:50%}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;color:#5c5c5c;overflow-y:auto}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview--blur_status[_ngcontent-%COMP%]{position:fixed;display:flex;width:100vw;height:100%;background:rgba(0,0,0,.7803921569);color:#fff;font-size:20px;font-weight:lighter;justify-content:center;align-items:center;cursor:progress;z-index:100;top:0;left:0}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview--blur_status-frame[_ngcontent-%COMP%]{height:85%;overflow-x:auto}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview--blur_status[_ngcontent-%COMP%]   .span-status[_ngcontent-%COMP%]{margin-top:10px;position:relative;animation:animatefadeIn .3s}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions[_ngcontent-%COMP%]{padding:0 20px 100px;background:rgb(244,244,244)}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item[_ngcontent-%COMP%]{padding-top:20px}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item__img[_ngcontent-%COMP%]{padding:10px 0;background:white;border-radius:5px 5px 0 0;cursor:ns-resize}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item__img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;cursor:default}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item__img_result[_ngcontent-%COMP%]{padding:10px;background:white;border-radius:0 0 5px 5px}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item__img_result[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item__control[_ngcontent-%COMP%]   .border-result[_ngcontent-%COMP%]{border-radius:0!important}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]{display:flex;align-items:center;background:#43bfb6;border-radius:0 0 5px 5px;color:#fff;padding:8px 20px;justify-content:space-between}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .btn-ans[_ngcontent-%COMP%]{background:white;height:25px;width:25px;border-radius:50%;display:inline-block;padding:0!important;margin-left:10px}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .btn-ans-result[_ngcontent-%COMP%]{color:#fff;background-color:#f39c12}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]{background:red;color:#fff;box-shadow:inset 0 0 58px 8px #00000012}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]{background:#f59c12;color:#fff}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .inp[_ngcontent-%COMP%]{margin-left:10px;width:50px;border:none;height:25px;background-color:#e0e0e0}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_preview[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .inp-result[_ngcontent-%COMP%]{margin-left:10px;width:-moz-fit-content;width:fit-content;height:25px;padding:3px 10px;color:#949494;font-size:small}#box-create-action[_ngcontent-%COMP%]   #box-viewer-create-result[_ngcontent-%COMP%]{cursor:cell!important}#box-create-action[_ngcontent-%COMP%]   .pdf__view[_ngcontent-%COMP%]{display:block;border:none}#box-create-action[_ngcontent-%COMP%]   .box-control-crop[_ngcontent-%COMP%]{position:absolute;top:-15px;left:10px;z-index:10}#box-create-action[_ngcontent-%COMP%]   .box-control-crop-btn[_ngcontent-%COMP%]{width:25px;height:25px;display:flex;justify-content:center;align-items:center}#box-create-action[_ngcontent-%COMP%]   .crop_action[_ngcontent-%COMP%]{position:fixed;z-index:10;background:#e2e2e2;padding:9px 5px;border-radius:0 0 5px;display:grid}#box-create-action[_ngcontent-%COMP%]   .crop_preview[_ngcontent-%COMP%]{position:fixed;z-index:3;background:gainsboro;display:flex;justify-content:center;align-items:center;padding:10px}#box-create-action[_ngcontent-%COMP%]   .crop_preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;cursor:all-scroll}#box-create-action[_ngcontent-%COMP%]   .d-none[_ngcontent-%COMP%]{display:none!important}#box-create-action[_ngcontent-%COMP%]   .link-merge-image-control[_ngcontent-%COMP%]{margin-bottom:10px;text-align:center;margin-top:-10px}#box-create-action[_ngcontent-%COMP%]   .link-merge-image-control[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:pointer}#box-create-action[_ngcontent-%COMP%]   .link-merge-image-control[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{color:#f06292}#box-create-action[_ngcontent-%COMP%]   .cursor-all-scroll[_ngcontent-%COMP%]{cursor:all-scroll!important}#box-create-action[_ngcontent-%COMP%]   .btn-save-fixed[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:45px}.toolBarMobile[_ngcontent-%COMP%]{position:fixed;bottom:0px;right:0;z-index:100;margin:0 40px 25px;padding:5px;background:rgba(181,181,181,.5294117647);border-radius:3px}@keyframes animatefadeIn{0%{top:0;opacity:0}to{top:0;opacity:1}}#box-create-action[_ngcontent-%COMP%]   .box-file[_ngcontent-%COMP%]   .box-control[_ngcontent-%COMP%]{display:flex;justify-content:left;align-items:center}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]{background:inherit;background-color:#fff;border-width:1px;border-style:solid;border-color:#d6d6d6;border-radius:5px;box-shadow:none;height:300px;display:flex}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_drop[_ngcontent-%COMP%]{cursor:pointer;width:100%;display:flex;justify-content:center;align-items:center;color:#5c5c5c}#box-create-action[_ngcontent-%COMP%]   .box-file-content-file_drop--input[_ngcontent-%COMP%]{text-align:center}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .is-dragover[_ngcontent-%COMP%]{background:#e4e4e4!important}#box-create-action[_ngcontent-%COMP%]   .box-file-content--viewer[_ngcontent-%COMP%]{overflow:auto;position:relative;width:100%}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item[_ngcontent-%COMP%]:first-child{padding-top:0!important}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions[_ngcontent-%COMP%]{background:rgb(244,244,244)}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item[_ngcontent-%COMP%]{padding-top:20px}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__img[_ngcontent-%COMP%]{padding:5px 0;background:white;border-radius:5px 5px 0 0;cursor:ns-resize;border:1px solid #2361ae}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;cursor:default}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__img_result[_ngcontent-%COMP%]{padding:5px 0;cursor:ns-resize;background:white;border-radius:0 0 5px 5px;border:1px solid #2361ae}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__img_result[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;cursor:default}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control[_ngcontent-%COMP%]   .border-result[_ngcontent-%COMP%]{border-radius:0!important}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]{display:flex;align-items:center;background:#2361ae;border-radius:0 0 5px 5px;color:#fff;padding:8px 20px;justify-content:space-between}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .btn-ans[_ngcontent-%COMP%]{background:white;height:25px;width:25px;border-radius:50%;display:inline-block;padding:0!important;margin-left:10px}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .btn-ans-result[_ngcontent-%COMP%]{color:#fff;background-color:#f39c12}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]{background:red;color:#fff;box-shadow:inset 0 0 58px 8px #00000012}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]{background:#f59c12;color:#fff}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .inp[_ngcontent-%COMP%]{margin-left:10px;width:50px;border:none;height:25px;background-color:#e0e0e0}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item__control_flex[_ngcontent-%COMP%]   .inp-result[_ngcontent-%COMP%]{margin-left:10px;width:-moz-fit-content;width:fit-content;height:25px;padding:3px 10px;color:#949494;font-size:small}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item[_ngcontent-%COMP%]   .link-merge-image-control[_ngcontent-%COMP%]{margin-bottom:10px;text-align:center;margin-top:-10px}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item[_ngcontent-%COMP%]   .link-merge-image-control[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:pointer}#box-create-action[_ngcontent-%COMP%]   .box-file-content[_ngcontent-%COMP%]   .box-questions-item[_ngcontent-%COMP%]   .link-merge-image-control[_ngcontent-%COMP%]:hover{color:#f06292}#box-create-action[_ngcontent-%COMP%]   .inp-name-root[_ngcontent-%COMP%]{position:fixed;z-index:110;top:0;left:15%;display:flex;justify-content:center;align-items:center;height:45px}#box-create-action[_ngcontent-%COMP%]   .inp-name-root[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-width:1px;border-style:solid;border-radius:5px;border-color:#d6d6d6;font-weight:500;font-size:13px;text-align:center;width:50%;padding:4px}#box-create-action[_ngcontent-%COMP%]   .inp-name-root[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus-visible{outline:none}.inputMobile[_ngcontent-%COMP%]{border-width:1px;border-style:solid;border-radius:5px;font-weight:500;font-size:13px;text-align:center;width:100%;padding:4px;height:38px}.inputMobile[_ngcontent-%COMP%]:focus-visible{outline:none}.fixToolBar[_ngcontent-%COMP%]{width:100%!important;left:0!important;background-color:#fff}.fixToolBar[_ngcontent-%COMP%]   .marginInput[_ngcontent-%COMP%]{width:70%!important;margin-left:5%!important}.fixToolBar[_ngcontent-%COMP%]   .btn-save-fixed[_ngcontent-%COMP%]{right:5%!important}.question-offline-title[_ngcontent-%COMP%]{font-weight:500;margin-bottom:15px}.question-offline-answer[_ngcontent-%COMP%]{max-width:300px;padding:10px;display:flex;justify-content:space-between;font-weight:500}.question-offline-answer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500}.btn-primary-icon[_ngcontent-%COMP%]{transition:all .3s}.btn-primary-icon[_ngcontent-%COMP%]:hover{background:#000}.listda[_ngcontent-%COMP%]{margin-top:30px;padding-left:20px}.ng-binding[_ngcontent-%COMP%]{font-size:24px;font-weight:400}.listli[_ngcontent-%COMP%]{padding:0;margin:0 5px 0 0;display:inline-block}.listli[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid rgb(52,125,165);display:flex;align-items:center;color:#fff;justify-content:center;font-size:15px;cursor:pointer}.no-answered[_ngcontent-%COMP%]{background:#273044}.dot-example[_ngcontent-%COMP%]   .__choice[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid #ffd300;background-color:#ffd300;display:inline-flex}.answer-box[_ngcontent-%COMP%]{background:#2361ae;color:#fff;border-bottom-left-radius:3px;border-bottom-right-radius:3px;padding:8px 20px;max-width:100%;display:flex!important;flex-wrap:wrap;justify-content:space-between}.chip_question[_ngcontent-%COMP%]{background-color:#ffd300;color:#fff!important}.show_explain[_ngcontent-%COMP%]{color:#fff;font-size:15px;margin-block:auto}.point-input[_ngcontent-%COMP%]{border-width:1px;border-style:solid;border-radius:5px;font-weight:500;font-size:13px;text-align:center;width:60px;padding:4px;margin-left:5px}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.on-change[_ngcontent-%COMP%]{border:3px solid #25df5a}.image_group[_ngcontent-%COMP%]{position:relative}.image_group[_ngcontent-%COMP%]   .mixGroupLabel[_ngcontent-%COMP%]{position:absolute;width:80px;height:50px;top:-35px;left:-45px;background-color:#ff000094;transform:rotate(-45deg);color:#fff;font-size:9px;text-align:center;padding-top:30px;display:block}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.btn-detail[_ngcontent-%COMP%]{color:#2361ae}.btn-detail[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#2361ae}@media (max-width: 768px){.answer-box[_ngcontent-%COMP%]{justify-content:center}.box-questions[_ngcontent-%COMP%]{margin-bottom:30px;scrollbar-width:none;-ms-overflow-style:none}.box-questions[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}.box-questions[_ngcontent-%COMP%]   .point-input[_ngcontent-%COMP%]{width:60px}}.error-border[_ngcontent-%COMP%]{border:1px solid #ff4757!important}.error-border[_ngcontent-%COMP%]:focus{border:1px solid #ff4757!important}.edit-question-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:40px;padding:10px;border-radius:5px;margin-bottom:-8px}.edit-question-header-right[_ngcontent-%COMP%]{display:flex;align-items:center}.edit-question-header-tag[_ngcontent-%COMP%], .edit-question-header-content[_ngcontent-%COMP%]{padding:5px}.edit-question-header-tag[_ngcontent-%COMP%]:hover, .edit-question-header-content[_ngcontent-%COMP%]:hover{background:rgba(35,97,174,.1803921569);border-radius:5px}.edit-question-header-dr[_ngcontent-%COMP%]{color:#607d8b;margin:0 10px}.edit-question-header-content[_ngcontent-%COMP%]{cursor:pointer}.edit-question-header-point[_ngcontent-%COMP%]{text-align:right}.first-text[_ngcontent-%COMP%]{display:flex;align-items:center}.first-text[_ngcontent-%COMP%]   marquee[_ngcontent-%COMP%]{width:100px}.first-text[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;margin:0;padding:0;width:100%;display:flex;justify-content:center;align-items:center}.tag-chip[_ngcontent-%COMP%]{min-height:20px;font-size:12px}.fix-group[_ngcontent-%COMP%]{position:absolute;width:80px;height:50px;top:-21px;left:-36px;background-color:#d63031d4;transform:rotate(-45deg);color:#fff;font-size:9px;text-align:center;padding-top:30px}"]}),o})()},{path:"export-pdf-by-user/:exam_id/:user_id/:student_id/:result_id",component:v0},{path:"export-pdf-by-class/:exam_id/:user_id/:student_id/:result_id",component:m0},{path:"create-website",component:Eh},{path:"create-website-result",component:bh},{path:"config-share-offline-result/:cat_id/:hash_id",component:ym},{path:"offline-answer-list/:cat_id/:hash_id",component:Tv}]}];let Sw=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[x.Bz.forChild(Ow),x.Bz,ji.fQ]}),o})();class Ew extends on.v{constructor(){super(...arguments),this.isSelected=!1}}var da=b(33502);const Iw=["colItem"],Zw=["resizeBarH"],Mw=["aztColResizable",""];function Pw(o,s){1&o&&(t.TgZ(0,"div",6)(1,"div",2),t.Hsn(2,1),t.qZA()())}const Lw=[[["","colLeftContent",""]],[["","colRightContent",""]]],Nw=function(o){return{width:o}},Dw=["[colLeftContent]","[colRightContent]"];let jw=(()=>{class o extends mt.Q{constructor(e){super(e),this.commonService=e,this.hasColRight=!1,this.width=0,this.x=0,this.y=0,this.leftWidth=0,this.handleMouseUp=n=>{var i,a,r;this.resizeBarH&&this.resizeBarH.nativeElement.classList.remove("hover"),null===(i=this.resizeBarH)||void 0===i||i.nativeElement.style.removeProperty("cursor"),document.body.style.removeProperty("cursor"),null===(a=this.colItem)||void 0===a||a.nativeElement.style.removeProperty("user-select"),null===(r=this.colItem)||void 0===r||r.nativeElement.style.removeProperty("pointer-events"),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp)},this.handleMouseMove=n=>{if(this.colItem){let i=this.colItem.nativeElement;i.style.width=`${this.leftWidth+(n.clientX-this.x)}px`,document.body.style.cursor="col-resize",i.style.userSelect="none",i.style.pointerEvents="none"}}}handleMouseDown(e){this.colItem&&(this.x=e.clientX,this.y=e.clientY,this.leftWidth=this.colItem.nativeElement.getBoundingClientRect().width,this.resizeBarH&&this.resizeBarH.nativeElement.classList.add("hover"),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp))}ngOnInit(){super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v))},o.\u0275cmp=t.Xpm({type:o,selectors:[["","aztColResizable",""]],viewQuery:function(e,n){if(1&e&&(t.Gf(Iw,5),t.Gf(Zw,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.colItem=i.first),t.iGM(i=t.CRH())&&(n.resizeBarH=i.first)}},inputs:{hasColRight:"hasColRight",width:"width"},features:[t.qOj],attrs:Mw,ngContentSelectors:Dw,decls:7,vars:4,consts:[[1,"col-item","border-r","border-slate-400","dark:border-darkmode-400",3,"ngStyle"],["colItem",""],[1,"col-content"],[1,"resize-bar","resize-bar-h",3,"mousedown"],["resizeBarH",""],["class","col-right",4,"ngIf"],[1,"col-right"]],template:function(e,n){1&e&&(t.F$t(Lw),t.TgZ(0,"div",0,1)(2,"div",2),t.Hsn(3),t.qZA(),t.TgZ(4,"div",3,4),t.NdJ("mousedown",function(a){return n.handleMouseDown(a)}),t.qZA()(),t.YNc(6,Pw,3,0,"div",5)),2&e&&(t.Q6J("ngStyle",t.VKq(2,Nw,n.hasColRight?"60%":n.width?n.width+"px":"100%")),t.xp6(6),t.Q6J("ngIf",n.hasColRight))},dependencies:[O.O5,O.PC],styles:[".col-item[_ngcontent-%COMP%]{min-width:150px;min-height:150px;height:100%;position:relative}.col-item[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]{position:absolute;background-color:transparent}.col-item[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]:hover{background-color:#2262ae;cursor:col-resize}.col-item[_ngcontent-%COMP%]   .resize-bar.hover[_ngcontent-%COMP%]{background-color:#2262ae}.col-item[_ngcontent-%COMP%]   .resize-bar.resize-bar-h[_ngcontent-%COMP%]{width:3px;right:0;top:0;bottom:0}.col-right[_ngcontent-%COMP%]{flex:auto}.col-content[_ngcontent-%COMP%]{height:100%;padding:15px;overflow-y:auto;overflow-x:hidden}"]}),o})();var qw=b(71465),Qw=b(75937);function Uw(o,s){if(1&o&&(t.ynx(0),t._UZ(1,"azt-standalone-question",3),t.BQk()),2&o){const e=s.$implicit,n=s.index,i=t.oxw(2);t.xp6(1),t.Q6J("follower",i.followerRenderQuest)("question",e)("index",n)("displayScreen",9)("configExam",i.exam)("isBackEnd",!0)("startQuestionIndex",null==i.exam?null:i.exam.startQuestionIndex)}}function Fw(o,s){if(1&o&&(t.TgZ(0,"div",1),t.YNc(1,Uw,2,7,"ng-container",2),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.questionList)}}let Rw=(()=>{class o extends mt.Q{constructor(e,n,i,a,r,l,c,_){super(i),this.fb=e,this.store=n,this.commonService=i,this.permissionService=a,this.docxService=r,this.examService=l,this.examLibraryService=c,this.customQuestionAnswerConfig=_,this.questionList=[],this.followerRenderQuest=new Ci.G}ngOnInit(){this.subscriptions.add(this.store.select(da.Y).subscribe(e=>{this.state=e})),this.followerRenderQuest.setNumQuest(this.questionList.length),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(h.QS),t.Y36(Oi.yh),t.Y36(vt.v),t.Y36(Xe.$),t.Y36(Vi.x),t.Y36(qw.O),t.Y36(Qw.j),t.Y36(Ti.U))},o.\u0275cmp=t.Xpm({type:o,selectors:[["azt-preview-list-question"]],inputs:{exam:"exam",questionList:"questionList"},features:[t.qOj],decls:1,vars:1,consts:[["id","boxContentQuestion",4,"ngIf"],["id","boxContentQuestion"],[4,"ngFor","ngForOf"],[3,"follower","question","index","displayScreen","configExam","isBackEnd","startQuestionIndex"]],template:function(e,n){1&e&&t.YNc(0,Fw,2,1,"div",0),2&e&&t.Q6J("ngIf",n.questionList.length>0)},dependencies:[O.sg,O.O5,Kn.$],styles:['.used[_ngcontent-%COMP%]{position:relative}.used[_ngcontent-%COMP%]:after{content:"";display:block;width:100%;height:100%;position:absolute;z-index:3;background-color:#44444429;left:0;top:0}.image_group[_ngcontent-%COMP%]{border:1px solid #ccc}.image_group.selected-group[_ngcontent-%COMP%]{border:1px solid green;outline:3px solid rgba(0,193,0,.321)}.image_group[_ngcontent-%COMP%], .image_question[_ngcontent-%COMP%]{padding:15px;margin-bottom:20px}']}),o})();function Bw(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.name)," ")}}function Jw(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function Hw(o,s){1&o&&(t.TgZ(0,"span",22),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_auto_chia_se")))}const ua=function(o,s){return{selected:o,last:s}};function zw(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",16),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(2).index,l=t.oxw(2);let c;return t.KtG(l.handleClickFolder(null!==(c=a.id)&&void 0!==c?c:0,r,a.name||"Th\u01b0 m\u1ee5c "+a.id,l.state.itemSelecteds.length>0&&r==l.state.itemSelecteds.length-1&&l.state.itemSelecteds[r].id==a.id&&1==l.state.itemSelecteds[r].type))}),t.O4$(),t.TgZ(1,"svg",17),t._UZ(2,"path",18),t.qZA(),t.kcU(),t.TgZ(3,"span",19),t.YNc(4,Bw,3,3,"span",2),t.YNc(5,Jw,2,1,"span",2),t.qZA(),t.YNc(6,Hw,3,3,"span",20),t._UZ(7,"mat-spinner",21),t.qZA()}if(2&o){const e=s.$implicit,n=t.oxw(2).index,i=t.oxw(2);t.Q6J("ngClass",t.WLB(7,ua,i.state.itemSelecteds.length>0&&i.state.itemSelecteds[n]&&i.state.itemSelecteds[n].id==e.id&&1==i.state.itemSelecteds[n].type,i.state.itemSelecteds.length>0&&n==i.state.itemSelecteds.length-1&&i.state.itemSelecteds[n].id==e.id&&1==i.state.itemSelecteds[n].type)),t.xp6(3),t.Q6J("title",e.name),t.xp6(1),t.Q6J("ngIf",-1==e.id),t.xp6(1),t.Q6J("ngIf",-1!=e.id),t.xp6(1),t.Q6J("ngIf",-1==e.id),t.xp6(1),t.Q6J("strokeWidth",2)("diameter",24)}}function Yw(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",23),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(2).index,l=t.oxw(2);return t.KtG(l.handleClickFile(a,r,a.name||"T\xean \u0111\u1ec1 thi",l.state.itemSelecteds.length>0&&r==l.state.itemSelecteds.length-1&&l.state.itemSelecteds[r].id==(null==a.exam?null:a.exam.id)&&2==l.state.itemSelecteds[r].type))}),t.TgZ(2,"div",24),t.O4$(),t.TgZ(3,"svg",25),t._UZ(4,"path",26),t.qZA()(),t.kcU(),t.TgZ(5,"span",19),t._uU(6),t.qZA(),t._UZ(7,"mat-spinner",21),t.qZA(),t.BQk()}if(2&o){const e=s.$implicit,n=t.oxw(2).index,i=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.WLB(5,ua,i.state.itemSelecteds.length>0&&i.state.itemSelecteds[n]&&i.state.itemSelecteds[n].id==(null==e.exam?null:e.exam.id)&&2==i.state.itemSelecteds[n].type,i.state.itemSelecteds.length>0&&n==i.state.itemSelecteds.length-1&&i.state.itemSelecteds[n].id==(null==e.exam?null:e.exam.id)&&2==i.state.itemSelecteds[n].type)),t.xp6(4),t.Q6J("title",(null==e.exam?null:e.exam.name)||(null==e.homework?null:e.homework.className)||""),t.xp6(1),t.hij(" ",(null==e.exam?null:e.exam.name)||(null==e.homework?null:e.homework.className)||""," "),t.xp6(1),t.Q6J("strokeWidth",2)("diameter",24)}}function Gw(o,s){if(1&o&&(t.TgZ(0,"div",13)(1,"div",14),t.YNc(2,zw,8,10,"div",15),t.YNc(3,Yw,8,8,"ng-container",8),t.qZA()()),2&o){const e=t.oxw(),n=e.last,i=e.$implicit,a=t.oxw(2);t.Q6J("width",300)("id",!a.state.showPreview&&n?"col-last":""),t.xp6(2),t.Q6J("ngForOf",i.categoryObjs),t.xp6(1),t.Q6J("ngForOf",i.documentObjs)}}function $w(o,s){if(1&o&&(t.TgZ(0,"div",27)(1,"div",14)(2,"div",28),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()()()),2&o){const e=t.oxw(3);t.Q6J("id",e.state.showPreview?"":"col-last")("width",300),t.xp6(3),t.Oqu(t.lcZ(4,3,"lang_auto_thu_muc_trong"))}}function Ww(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Gw,4,4,"div",11),t.YNc(2,$w,5,5,"ng-template",null,12,t.W1O),t.BQk()),2&o){const e=s.$implicit,n=t.MAs(3);t.xp6(1),t.Q6J("ngIf",e.categoryObjs.length>0||e.documentObjs.length>0)("ngIfElse",n)}}function Kw(o,s){if(1&o&&(t.TgZ(0,"div",27)(1,"div",14)(2,"div",29),t._uU(3),t.qZA()()()),2&o){const e=t.oxw(2);t.Q6J("id",e.state.showPreview?"":"col-last")("width",300),t.xp6(3),t.Oqu("[ERROR] "+e.state.error)}}function Vw(o,s){if(1&o&&(t.TgZ(0,"div",30)(1,"div",31),t._UZ(2,"azt-preview-list-question",32),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("exam",e.exam)("questionList",e.questionList)}}function Xw(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Ww,4,2,"ng-container",8),t.YNc(2,Kw,4,3,"div",9),t.YNc(3,Vw,3,2,"div",10),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.state.dataLevels),t.xp6(1),t.Q6J("ngIf",e.state.error),t.xp6(1),t.Q6J("ngIf",e.state.showPreview)}}function tT(o,s){if(1&o&&(t._uU(0),t.ALo(1,"mytranslate"),t.TgZ(2,"b"),t._uU(3),t.qZA()),2&o){const e=t.oxw();t.hij(" ",t.lcZ(1,2,"lang_auto_so_cau_da_chon"),":\xa0"),t.xp6(3),t.Oqu(e.calSelectings)}}function eT(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"span",36),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.tongleTooltip())}),t._uU(1),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.tooltipRandom)}}function nT(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",33),t.YNc(1,eT,2,1,"span",34),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"mytranslate"),t.qZA(),t.TgZ(5,"input",35),t.NdJ("focus",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.showTooltip=!0)})("keyup.enter",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.handlePressEnter(i))})("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.random=i)}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.showTooltip&&e.state.itemSelecteds.length>0),t.xp6(2),t.Oqu(t.lcZ(4,3,"lang_auto_nhap_so_cau_can_lay")),t.xp6(2),t.Q6J("ngModel",e.random)}}const iT=function(o){return{loading:o}};let oT=(()=>{class o extends mt.Q{constructor(e,n,i){super(e),this.commonService=e,this.store=n,this.examService=i,this.closeTestFinder=new t.vpe,this.isFirstTime=!1,this.random=0,this.usedIds=[],this.showTooltip=!0,this.questionList=[],this.loadingPreview=!1}onKeydownHandler(e){"Escape"==e.key&&this.closeTestFinder.emit(void 0)}handlePressEnter(e){0==this.state.itemSelecteds.length||this.state.loading||this.handleClickChon()}handleClickFolder(e,n,i,a=!1){this.showTooltip=!0,!this.state.loading&&(a||(this.store.dispatch(Et.nm()),this.store.dispatch(Et.m_({item:{type:1,id:e,level:n,name:i}}))))}get tooltipRandom(){let e="",n="",i="",a="",r="";return this.commonService.getTranslate("lang_auto_lay_ngau_nhien_so_cau_hoi_o").subscribe(l=>{e=l}),this.commonService.getTranslate("lang_auto_nhom_thuong").subscribe(l=>{n=l.toUpperCase()}),this.commonService.getTranslate("lang_auto_thu_muc_thuong").subscribe(l=>{i=l.toUpperCase()}),this.commonService.getTranslate("lang_auto_de_thi_thuong").subscribe(l=>{a=l.toUpperCase()}),this.commonService.getTranslate("lang_auto_dang_chon").subscribe(l=>{r=l}),e+" "+(void 0!==this.state.chosenGroup?n:0==this.state.itemSelecteds.length||1==this.state.itemSelecteds[this.state.itemSelecteds.length-1].type?i:a)+" "+r}handleClickFile(e,n,i,a=!1){var r;if(this.showTooltip=!0,!this.state.loading&&!a&&e.exam){this.loadingPreview=!0;let l=null!==(r=e.exam.id)&&void 0!==r?r:0;this.store.dispatch(Et.m_({item:{type:2,id:l,level:n,name:i}})),this.fectchPreview(l)}}fectchPreview(e){this.examService.apiExamGetQuestionsIdGet(e).subscribe(n=>{var i,a,r,l;if(n.success){this.exam=null===(i=n.data)||void 0===i?void 0:i.examObj;let c=null!==(r=this.commonService.castJsonToClassObjs(on.v,JSON.stringify((null===(a=n.data)||void 0===a?void 0:a.questionObjs)||[])))&&void 0!==r?r:[];this.questionList=null!==(l=this.commonService.castJsonToClassObjs(Ew,JSON.stringify(c)))&&void 0!==l?l:[],this.loadingPreview=!1}else this.loadingPreview=!1})}handleClickCancel(){this.closeTestFinder.emit(void 0)}handleGetAllQuestionStringCode(){this.calSelectings<1&&this.random<1&&this.state.chosenGroup&&this.questionList.forEach(e=>{var n;(null===(n=e.groupInfo)||void 0===n?void 0:n.groupId)==this.state.chosenGroup&&(e.isSelected=!0)}),this.calSelectings<1&&this.random<1&&!this.state.chosenGroup&&this.questionList.forEach(e=>{e.isSelected=!0})}handleClickChon(){this.handleGetAllQuestionStringCode();let e="",n="",i="",a="",r="";if(this.commonService.getTranslate("lang_auto_nhom").subscribe(_=>{e=_}),this.commonService.getTranslate("lang_auto_cau_thuong").subscribe(_=>{n=_}),this.commonService.getTranslate("lang_auto_lay_tieu_de").subscribe(_=>{i=_}),this.commonService.getTranslate("lang_auto_lay_ngau_nhien").subscribe(_=>{a=_}),this.commonService.getTranslate("lang_auto_lay_toan_bo").subscribe(_=>{r=_}),this.calSelectings>0){this.store.dispatch(Et.qY({questions:this.questionList}));let _=[],d=0;for(let m=0;m<this.state.usedQuestionLocations.length;m++){const p=this.state.usedQuestionLocations[m];let w=[],C=0;for(let A=0;A<p.length;A++){const M=p[A];let D=this.cleanName(M.name);if(1==M.type&&w.push(`[@C${M.id}:${D}]`),2==M.type&&w.push(`[@T${M.id}:${D}]`),3==M.type){let q=this.questionList.filter(U=>{var F,tt;return(null===(F=U.groupInfo)||void 0===F?void 0:F.groupId)&&(null===(tt=U.groupInfo)||void 0===tt?void 0:tt.groupId)==parseInt(D)}).length;q&&w.push(`[@G${D}:${q}-${e} ${D}]`),C=parseInt(D)}4==M.type&&w.push(`[@Q${M.id}:${D.replace("[PDFv2] ","")}]`)}if(0!=C&&C!=d){let A=[...w];A[A.length-1]=`[${i}]`,_.push(A.join(".")),d=C}_.push(w.join("."))}return void this.closeTestFinder.emit(_)}const l=this.state.itemSelecteds;let c=[];for(let _=0;_<l.length;_++){const d=l[_];let m=this.cleanName(d.name);1==d.type&&c.push(`[@C${d.id}:${m}]`),2==d.type&&c.push(`[@T${d.id}:${m}]`)}if(this.state.chosenGroup){let _=this.questionList.filter(d=>{var m;return(null===(m=d.groupInfo)||void 0===m?void 0:m.groupId)==this.state.chosenGroup}).length;if(c.push(`[@G${this.state.chosenGroup}:${_}-${e} ${this.state.chosenGroup}]`),this.random>0)c.push(`[${a} ${this.random} ${n}]`);else{let d=this.questionList.filter(m=>{var p;return(null===(p=m.groupInfo)||void 0===p?void 0:p.groupId)==this.state.chosenGroup}).length;c.push(`[${r} ${d} ${n}]`)}}else if(this.random>0)c.push(`[${a} ${this.random} ${n}]`);else{if(!(this.questionList.length>0))return void this.showErrorSnack("lang_auto_ban_can_nhap_so_luong_it_nhat_1_cau");c.push(`[${r} ${this.questionList.length} ${n}]`)}this.closeTestFinder.emit([c.join(".")])}get calSelectings(){return this.questionList.filter(e=>e.isSelected).length}cleanName(e){let n=e;return n=n.replaceAll(/[\[\],\.\-]+/g,""),n}tongleTooltip(){this.showTooltip=!this.showTooltip}ngAfterViewInit(){if(this.state.itemSelecteds.length>0){let e=this.state.itemSelecteds[this.state.itemSelecteds.length-1];2==e.type&&this.fectchPreview(e.id)}}ngOnInit(){this.store.dispatch(Et.WR({isFirstTime:this.isFirstTime})),this.store.dispatch(Et.AL()),this.subscriptions.add(this.store.select(da.Y).subscribe(e=>{this.state=e,this.usedIds=this.state.usedQuestions.map(n=>n.id||0)})),super.ngOnInit()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v),t.Y36(Oi.yh),t.Y36(Ot.Oe))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-test-finder"]],hostBindings:function(e,n){1&e&&t.NdJ("keydown",function(a){return n.onKeydownHandler(a)},!1,t.evT)},inputs:{isFirstTime:"isFirstTime"},outputs:{closeTestFinder:"closeTestFinder"},features:[t.qOj],decls:13,vars:13,consts:[[1,"close-button","clickable",3,"matTooltip","click"],["id","grid-parent",1,"grid-parent",3,"ngClass"],[4,"ngIf"],["id","examSaveBtns",1,"bg-slate-200","dark:bg-darkmode-400"],[1,"right"],["manualSelect",""],["class","random",4,"ngIf","ngIfElse"],[1,"btn","btn-primary","w-24","ml-3",3,"disabled","click"],[4,"ngFor","ngForOf"],["aztColResizable","",3,"id","width",4,"ngIf"],["class","preview-pane","id","col-last",4,"ngIf"],["aztColResizable","",3,"width","id",4,"ngIf","ngIfElse"],["emptyCol",""],["aztColResizable","",3,"width","id"],["colLeftContent",""],["class","doc-item doc-item-cate clickable mb-2",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"doc-item","doc-item-cate","clickable","mb-2",3,"ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"w-6","h-6","mr-3","text-slate-600","dark:text-slate-500"],["d","M9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.825a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31L.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3zm-8.322.12C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139z"],[1,"cat-name",3,"title"],["class","whitespace-nowrap ml-2 py-0.5 px-2 rounded-full text-xs bg-primary text-white font-medium",4,"ngIf"],["color","accent",3,"strokeWidth","diameter"],[1,"whitespace-nowrap","ml-2","py-0.5","px-2","rounded-full","text-xs","bg-primary","text-white","font-medium"],[1,"doc-item","doc-item-file","clickable","mb-2",3,"ngClass","click"],[1,"file-icon"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"w-6","h-6","mr-3","text-pending"],["d","M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zm1.354 4.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708.708z"],["aztColResizable","",3,"id","width"],[1,"text-center","alert","alert-info"],[1,"text-center","alert","alert-danger"],["id","col-last",1,"preview-pane"],[1,"preview-content"],[3,"exam","questionList"],[1,"random"],["class","qv_tooltip",3,"click",4,"ngIf"],["type","text","appOnlyNumber","","name","random","id","random",1,"form-control",3,"ngModel","focus","keyup.enter","ngModelChange"],[1,"qv_tooltip",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"mat-icon",0),t.NdJ("click",function(){return n.handleClickCancel()}),t.ALo(1,"mytranslate"),t._uU(2,"close"),t.qZA(),t.TgZ(3,"div",1),t.YNc(4,Xw,4,3,"ng-container",2),t.qZA(),t.TgZ(5,"div",3)(6,"div",4),t.YNc(7,tT,4,4,"ng-template",null,5,t.W1O),t.YNc(9,nT,6,5,"div",6),t.TgZ(10,"button",7),t.NdJ("click",function(){return n.handleClickChon()}),t._uU(11),t.ALo(12,"mytranslate"),t.qZA()()()),2&e){const i=t.MAs(8);t.s9C("matTooltip",t.lcZ(1,7,"lang_auto_dong")),t.xp6(3),t.Q6J("ngClass",t.VKq(11,iT,n.state.loading)),t.xp6(1),t.Q6J("ngIf",n.state.dataLevels.length>0),t.xp6(5),t.Q6J("ngIf",0==n.calSelectings)("ngIfElse",i),t.xp6(1),t.Q6J("disabled",0==n.state.itemSelecteds.length||n.state.loading),t.xp6(1),t.Oqu(t.lcZ(12,9,"lang_auto_chon"))}},dependencies:[O.mk,O.sg,O.O5,ge.Hw,Qi.Ou,Wt.gM,h.Fj,h.JJ,h.On,jw,un.Y,Rw,at.bT],styles:['.close-button[_ngcontent-%COMP%]{position:absolute;right:5px;top:5px;color:#9c9c9c;z-index:10}.close-button[_ngcontent-%COMP%]:hover{color:#747474;cursor:pointer}.grid-parent[_ngcontent-%COMP%]{min-width:300;width:100%;min-height:150px;height:100%;display:flex;flex-wrap:nowrap;overflow-y:auto;position:relative}.grid-parent[_ngcontent-%COMP%]   .doc-item[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;align-items:center}.grid-parent[_ngcontent-%COMP%]   .doc-item.doc-item-cate[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:orange;margin-right:5px;width:40px;height:40px;min-width:40px;font-size:40px}.grid-parent[_ngcontent-%COMP%]   .doc-item.doc-item-cate[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{margin-left:5px;padding:5px}.grid-parent[_ngcontent-%COMP%]   .doc-item.doc-item-file[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]{width:40px;min-width:40px;margin-right:5px;position:relative}.grid-parent[_ngcontent-%COMP%]   .doc-item.doc-item-file[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .examTableIconObj[_ngcontent-%COMP%]{position:absolute;top:3px;left:5px;width:20px;background-image:url(https://cdn.jsdelivr.net/gh/azota889/storage_public/azota_assets/images/titlePublishExam.png);background-position:top;background-size:cover;overflow:hidden;height:20px}.grid-parent[_ngcontent-%COMP%]   .doc-item.selected[_ngcontent-%COMP%]{background-color:#7497c2}.grid-parent[_ngcontent-%COMP%]   .doc-item.selected[_ngcontent-%COMP%]   .cat-name[_ngcontent-%COMP%]{color:#fff}.grid-parent[_ngcontent-%COMP%]   .doc-item.selected.last[_ngcontent-%COMP%]{background-color:#2361ae}.grid-parent[_ngcontent-%COMP%]   .doc-item[_ngcontent-%COMP%]   .cat-name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.grid-parent[_ngcontent-%COMP%]   .preview-pane[_ngcontent-%COMP%]{flex:1;min-width:800px;padding:15px;overflow-y:auto}.grid-parent[_ngcontent-%COMP%]   .preview-pane[_ngcontent-%COMP%]   .preview-content[_ngcontent-%COMP%]{width:100%;max-width:700px;height:100%;margin:0 auto}.grid-parent[_ngcontent-%COMP%]   .preview-pane[_ngcontent-%COMP%]   .preview-content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]{border:1px solid rgb(231,231,231)}#examSaveBtns[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;height:50px}#examSaveBtns[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{padding-left:15px}#examSaveBtns[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{flex:auto;display:flex;justify-content:right;align-items:center;padding-right:15px}#examSaveBtns[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:35px;border:1px solid #eeeeee;margin-left:5px;padding:5px;width:100px}#examSaveBtns[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .random[_ngcontent-%COMP%]{display:flex;align-items:center}#examSaveBtns[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .random[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:#18a2b8;margin-right:.25rem}#examSaveBtns[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]{padding-left:50px;padding-right:50px;background-color:#2361ae}#examSaveBtns[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]:hover{background-color:#1e5395}#examSaveBtns[_ngcontent-%COMP%]   .btn-save.mat-button-disabled[_ngcontent-%COMP%]{background-color:#0000001f}mat-spinner[_ngcontent-%COMP%]{display:none}@media screen and (max-width: 570px){#examSaveBtns[_ngcontent-%COMP%]{padding-left:12px}#examSaveBtns[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .random[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{flex:none}#examSaveBtns[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:80px!important}#examSaveBtns[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]{padding-right:30px;padding-left:30px}}.qv_tooltip[_ngcontent-%COMP%]{bottom:47px;right:110px;display:flex;font-size:11px;justify-content:space-between;position:absolute;z-index:999;background:#faebd7;padding:5px 10px;border-radius:5px;font-weight:500;color:#000;box-shadow:#091e4240 0 4px 8px -2px,#091e4214 0 0 0 1px}.qv_tooltip[_ngcontent-%COMP%]:before{content:"";position:absolute;top:29px;left:298px;border-left:10px solid transparent;border-right:10px solid transparent;border-top:10px solid #faebd7}']}),o})();var aT=b(63064),sT=b(79036),rT=b(96442),to=b(86642),lT=b(99050),cT=b(25721),_T=b(58349),dT=b(61896),uT=b(23753);const mT=["editorContainer"];let hT=(()=>{class o{constructor(e,n,i,a,r){this.cdnService=e,this.documentService=n,this.examService=i,this.infoService=a,this.commonService=r,this.loaderScript=document.createElement("script"),this.config="",this.onInit=new t.vpe,this.returnImageMap=new t.vpe}initMonacoAction(){return new Promise(e=>{const n="assets/monaco-editor/min/vs";"object"!=typeof window.monaco?(this.loaderScript.type="text/javascript",this.loaderScript.setAttribute("async","false"),this.loaderScript.src=`${n}/loader.js`,this.loaderScript.addEventListener("load",()=>{window.require.config({paths:{vs:`${n}`}}),window.require(["vs/editor/editor.main"],()=>{e()})}),document.body.appendChild(this.loaderScript)):e()})}ngAfterViewInit(){this.initMonacoAction().then(()=>{this.initMonaco()})}ngOnDestroy(){this._windowResizeSubscription&&this._windowResizeSubscription.unsubscribe(),this._editor&&(this._editor.dispose(),this._editor=void 0),this.loaderScript.parentNode&&this.loaderScript.parentNode.removeChild(this.loaderScript)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Ke.U),t.Y36(Ot.Zg),t.Y36(Ot.Oe),t.Y36(Ot.CM),t.Y36(vt.v))},o.\u0275cmp=t.Xpm({type:o,selectors:[["ng-component"]],viewQuery:function(e,n){if(1&e&&t.Gf(mT,7),2&e){let i;t.iGM(i=t.CRH())&&(n._editorContainer=i.first)}},inputs:{config:"config"},outputs:{onInit:"onInit",returnImageMap:"returnImageMap"},decls:0,vars:0,template:function(e,n){},encapsulation:2}),o})();class yi{constructor(s){this.name=s}}class pT extends yi{run(s){let e=s.getPosition(),i="________";s.executeEdits("",[{range:{startLineNumber:e.lineNumber,endLineNumber:e.lineNumber,startColumn:e.column,endColumn:e.column},text:i}]),s.setPosition({lineNumber:e.lineNumber,column:e.column+i.length})}}class gT extends yi{run(s){let e=s.getModel(),n=s.getSelection(),i={startLineNumber:n.startLineNumber,endLineNumber:n.endLineNumber,startColumn:n.startColumn,endColumn:n.endColumn},a=e.getValueInRange(i);s.executeEdits("",[{range:i,text:`\\( ${a} \\)`}]),s.setPosition({lineNumber:n.endLineNumber,column:n.startColumn+3+a.length})}}class eo extends yi{constructor(s,e){super(s),this.tag=e}run(s){let e=s.getModel(),n=s.getSelection(),i={startLineNumber:n.startLineNumber,endLineNumber:n.endLineNumber,startColumn:n.startColumn,endColumn:n.endColumn},a=e.getValueInRange(i),r=a;a.indexOf(`!${this.tag}`)>=0?(r=r.replaceAll(`!${this.tag}`,""),r=r.replaceAll(/\[:\$(([^\$]|\$[^\]])+)\$\]/g,"$1")):r=a.startsWith("[!")?`[!${this.tag}`+a.substring(1):`[!${this.tag}:$${a}$]`,s.executeEdits("",[{range:i,text:r}])}}class fT extends yi{run(s){let e=s.getSelection(),n=s.getModel(),i={startLineNumber:e.startLineNumber,endLineNumber:e.endLineNumber,startColumn:e.startColumn,endColumn:e.endColumn},a=n.getValueInRange(i);/^\[\*?[A-H]:[^\]]+\]$/.test(a)?(a=a.substring(a.indexOf(":")+1,a.length-2),s.executeEdits("",[{range:i,text:a}])):s.executeEdits("",[{range:i,text:`[A:${a}]`}])}}class xT{constructor(){this.placeHolderRemoved=!1,this.decorations=[],this.parseChange=!0,this.hasError=!1}setIntellisense(s){this.azotaIntel=s}setSingleMode(s){var e;null===(e=this.azotaIntel)||void 0===e||e.setSingleMode(s)}setLang(s){var e;this.lang=s,null===(e=this.azotaIntel)||void 0===e||e.setLang(s)}registerPlugin(s,e){this._editor&&this._editor.addAction({id:s.name,label:s.name,keybindings:[this.monaco.KeyMod.CtrlCmd|e],contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(n){s.run(n)}})}getCurLine(){return this._editor.getPosition().lineNumber}getCurLineText(){let s=this._editor.getPosition().lineNumber;return this._editor.getModel().getLineContent(s)}getLineText(s){return this._editor.getModel().getLineContent(s)}getCurQuest(){if(this.azotaIntel){let s=this.getCurLine()-1;return this.azotaIntel.getCurPos(s,50)[0]}}goToLine(s){this._editor.focus(),this._editor.setPosition({lineNumber:s,column:0}),this._editor.revealLineNearTop(s+1)}setPosition(s,e){let n={lineNumber:s,column:e};this._editor.focus(),this._editor.setPosition(n),this._editor.revealPositionNearTop(n)}insertDetails(s,e){let n=this.getLineText(s),a=[],r=n.replaceAll(/\s+/g," ").split("].[");r.splice(r.length-1);let l=r.join("].[")+"]";for(const c of e)a.push(l+`.[@Q${c}]`);if(a.length>0){let c=a.join("\n");this._editor.executeEdits("",[{range:{startLineNumber:s,endLineNumber:s,startColumn:0,endColumn:n.length+2},text:c}]),this._editor.setSelection({startLineNumber:s,endLineNumber:s,startColumn:0,endColumn:0})}}setError(s){this.hasError=s.length>0;let e=[],n=this._editor.getModel();for(const i of s){let a=i.split("|"),r=+a[0],l=a[1],c=n.getLineContent(r);e.push({startLineNumber:r,endLineNumber:r,startColumn:0,endColumn:c.length+1,message:l})}this.monaco.editor.setModelMarkers(n,"",e)}init(s,e,n){var i,a,r,l,c,_,d,m,p,w,C,A;n&&this.setLang(n);let M=this;this.monaco=s;let D="azota",q=s.languages.getLanguages().filter(V=>V.id==D),U=q&&q.length>0;U||(s.languages.register({id:D}),s.languages.setMonarchTokensProvider(D,{operators:["=",">","<","!","~","?",":","==","<=",">=","!=","&&","||","++","--","+","-","*","/","&","|","^","%","<<",">>",">>>","+=","-=","*=","/=","&=","|=","^=","%=","<<=",">>=",">>>="],symbols:/[=><!~?:&|+\-*\/\^%]+/,tokenizer:{root:[[/^\s*C\xe2u\s*\d+/,"question-label"],[/^\s*Question\s*\d+/,"question-label"],[/\s+\*?[A-Ha-h][\.\)]/,"answer-label"],[/^\s*\*?[A-Ha-h][\.\)]/,"answer-label"],[/\[[^\]]+\]/,"expression"],[/^\s*L\u1eddi gi\u1ea3i\s*$/,"token"],[/^\s*GLOSSARY\s*$/,"token"],[/^\s*B\u1ea2NG \u0110\xc1P \xc1N\s*$/,"token"],[/^\s*B\u1ea3ng \u0111\xe1p \xe1n\s*$/,"token"],[/^\s*\-+H\u1ebeT\-+\s*$/,"token"],[/^\s*H\u01b0\u1edbng d\u1eabn gi\u1ea3i\s*$/,"token"],[/^\s*H\u01af\u1edaNG D\u1eaaN GI\u1ea2I\s*$/,"token"],[/^\s*Ch\u1ecdn\s*[A-Ha-h]\s*$/,"choose"],[/^\s*Answer keys\s*$/,"token"],[/^\s*ANSWER KEYS\s*$/,"token"],[/^\s*Answer key\s*$/,"token"],[/^\s*ANSWER KEY\s*$/,"token"],[/^\s*Answer Section\s*$/,"token"],[/^\s*\-+THE END\-+\s*$/,"token"],[/^\s*\-+END\-+\s*$/,"token"],[/^\s*Instructions\s*$/,"token"],[/^\s*INSTRUCTIONS\s*$/,"token"],[/^\s*Choose\s*[A-Ha-h]\s*$/,"choose"],[/^[IVX]+\s*[\.:].*$/,"section"],[/^Section+\s*[\dA-K]+[\.:].*$/,"section"],[/^Part+\s*[\dA-KVX]+[\.:].*$/,"section"],[/^Ph\u1ea7n+\s*[\dA-KVX]+[\.:].*$/,"section"],[/\\[a-z][a-z0-9]+/,"latex"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],{include:"@whitespace"},["[{}()\\[\\]]","@brackets"],["#+\\d","number.arg"],["\\-?(?:\\d+(?:\\.\\d+)?|\\.\\d+)\\s*(?:em|ex|pt|pc|sp|cm|mm|in)","number.len"]],whitespace:[["[ \\t\\r\\n]+","white"],["%.*$","comment"]]}}));let F="dark"==localStorage.getItem("mode_ui");s.editor.defineTheme("azotaTheme",{base:F?"vs-dark":"vs",inherit:!0,rules:[{token:"question-label",foreground:F?"569cd6":"3437eb",fontStyle:"bold"},{token:"answer-label",foreground:F?"FF6464":"ff0000",fontStyle:"bold"},{token:"expression",foreground:"ab2428"},{token:"operator",foreground:"ab2428"},{token:"latex",foreground:"3437eb"},{token:"keyword",foreground:"2504da"},{token:"keyword.predefined",foreground:"2504da"},{token:"token",foreground:"8f4106",fontStyle:"bold"},{token:"choose",foreground:"000000",fontStyle:"bold"},{token:"section",foreground:"000000",fontStyle:"bold"}],colors:{"editor.foreground":F?"#d4d4d4":"#000000","editor.background":F?"#25304C":"#ffffff"}}),U||(s.languages.setLanguageConfiguration(D,{brackets:[["{","}"],["[","]"],["(",")"],["\\(","\\)"],["[*","*]"]]}),s.languages.registerCompletionItemProvider(D,{triggerCharacters:["@",".",","],provideCompletionItems:function(V,J){return(0,Oe.mG)(this,void 0,void 0,function*(){if(!M.azotaIntel)return{suggestions:[]};let et=V.getWordUntilPosition(J),ot=V.getLineContent(J.lineNumber);return{suggestions:(yield M.azotaIntel.getSuggestions(J.lineNumber-1,J.column-1,et.word,ot)).map(lt=>{let ht,dt,rt=lt.split("|"),xt=s.languages.CompletionItemKind.Text,gt=rt[0];if(rt.length>2){switch(rt[2]){case"file":xt=s.languages.CompletionItemKind.File,gt="2"+rt[0];break;case"folder":xt=s.languages.CompletionItemKind.Folder,gt="1"+rt[0];break;case"class":xt=s.languages.CompletionItemKind.Class,gt="3"+rt[3];break;case"function":xt=s.languages.CompletionItemKind.Function,gt="3"+rt[3];break;case"snippet":xt=s.languages.CompletionItemKind.Module,ht=s.languages.CompletionItemInsertTextRule.InsertAsSnippet,gt="0"}dt={id:"editor.action.triggerSuggest",title:""}}return{label:rt[0],kind:xt,insertText:rt[1],insertTextRules:ht,sortText:gt,command:dt,documentation:{supportHtml:!0,value:rt[4]}}})}})}}));let W=s.editor.create(e,{theme:"azotaTheme",language:D,wordBasedSuggestions:!1,minimap:{enabled:!1},overviewRulerLanes:0,wordWrap:"on",tabSize:4}),P=W.getModel();W.onMouseDown(function(V){M.onChangePosCalback&&V.target.position&&M.onChangePosCalback(V.target.position.lineNumber,V.target.position.column),W.focus()});let R={domNode:null,getId:function(){return"my.content.widget"},getDomNode:function(){var V,J;return this.domNode||this.domNode||(this.domNode=document.createElement("div"),this.domNode.innerHTML=null!==(J=null===(V=M.lang)||void 0===V?void 0:V.myTranslateIntance("azt_lang_enter_at_to_choose_from_bank"))&&void 0!==J?J:"Nh\u1eadp @ \u0111\u1ec3 ch\xe8n t\u1eeb ng\xe2n h\xe0ng",this.domNode.style.color="grey",this.domNode.style.width="250px"),this.domNode},getPosition:function(){return{position:{lineNumber:1,column:2},preference:[s.editor.ContentWidgetPositionPreference.BELOW]}}};W.addContentWidget(R),P.onDidChangeContent(V=>{this.placeHolderRemoved||(W.removeContentWidget(R),this.placeHolderRemoved=!0);let J=P.getLineContent(V.changes[0].range.startLineNumber);if(J.startsWith("@[@")&&this.runEditAction([V.changes[0].range.startLineNumber-1+"|0|3|[@"],W,!1),J.endsWith(".,")&&this.runEditAction([`${V.changes[0].range.startLineNumber-1}|${J.length-2}|${J.length}|,`],W,!1),this.azotaIntel&&this.parseChange)this.azotaIntel.onChange({startLineNumber:V.changes[0].range.startLineNumber,endLineNumber:V.changes[0].range.endLineNumber,startColumn:V.changes[0].range.startColumn,endColumn:V.changes[0].range.endColumn,text:V.changes[0].text},M,this.onChangeCalback);else if(this.parseChange&&this.onChangeCalback){let ot=P.getValue().split("\n");this.onChangeCalback(ot,null)}});let N=W.addCommand(0,function(V,J,et){if(M.onInsertDetailsCb){let ot=et.replaceAll(/\s+/g," ").trim();M.onInsertDetailsCb(ot,J)}},""),B=W.addCommand(0,function(V,J,et){if(M.onRefreshCalback){let ot=et.replaceAll(/\s+/g," ").trim();M.onRefreshCalback(ot,J)}},""),z=W.addCommand(0,function(V,J,et){if(M.onInsertQuestTextCb){let ot=et.replaceAll(/\s+/g," ").trim();M.onInsertQuestTextCb(ot,J)}},""),X=new Map;return X.set("insertDirectQuest",N),X.set("randomAgain",B),X.set("insertQuestText",z),U||s.languages.registerCodeLensProvider(D,{provideCodeLenses:function(V,J){let et=V.getValue().split("\n");return M.azotaIntel?{lenses:M.azotaIntel.getCodeLens(et).map(ut=>{let lt=ut.split("|"),rt=+lt[0]+1;return{range:{startLineNumber:rt,startColumn:1,endLineNumber:rt,endColumn:1},id:lt[1],command:{id:X.get(lt[1]),title:lt[2],arguments:[rt,lt[4]],tooltip:lt[3]}}}),dispose:()=>{}}:{lenses:[],dispose:()=>{}}}}),W.onKeyUp(V=>{if(V.keyCode==s.KeyCode.Enter&&M.runCommand("enter",W),V.keyCode==s.KeyCode.Tab){let J=W.getPosition(),et=P.getLineContent(J.lineNumber);J.column>et.length&&M.runCommand("tab",W)}}),W.onKeyDown(V=>{if(V.keyCode==s.KeyCode.Backspace){let J=W.getSelection();if(J.startLineNumber!=J.endLineNumber||J.startColumn!=J.endColumn)return;let et=W.getPosition(),ut=P.getValueInRange({startLineNumber:et.lineNumber,endLineNumber:et.lineNumber,startColumn:et.column-1,endColumn:et.column}),lt={startLineNumber:et.lineNumber,endLineNumber:et.lineNumber,startColumn:0,endColumn:et.column};if("]"==ut){let gt=P.getValueInRange(lt).lastIndexOf("[")+2;return lt.startColumn=gt,void W.executeEdits("",[{range:lt,text:""}])}let rt=P.getLineContent(et.lineNumber).trim(),xt=[/^C\xe2u\s\d+[\.:]$/,/^Question\s\d+[\.:]$/,/^[A-H]\.$/];if(et.column>rt.length){let ht=!1;for(const gt of xt)if(gt.test(rt)){ht=!0;break}if(ht)return void W.executeEdits("",[{range:lt,text:"\n"}])}}}),W.onDidPaste(V=>{this.pastePosition=V}),s.languages.registerHoverProvider("azota",{provideHover:function(V,J){if(M.onHoverCalback){let et=M.onHoverCalback(J.lineNumber,J.column,V.getLineContent(J.lineNumber));return et?{range:new s.Range(et.lineIdx,et.s,et.lineIdx,et.e),contents:[{supportHtml:!0,value:et.text}]}:void 0}}}),this._editor=W,W.addCommand(s.KeyMod.CtrlCmd|s.KeyCode.Enter,function(){}),this.registerPlugin(new pT(null!==(a=null===(i=this.lang)||void 0===i?void 0:i.myTranslateIntance("azt_lang_menu_fill_blank"))&&void 0!==a?a:"\u0110i\u1ec1n v\xe0o ch\u1ed7 tr\u1ed1ng"),s.KeyCode.Period),this.registerPlugin(new fT(null!==(l=null===(r=this.lang)||void 0===r?void 0:r.myTranslateIntance("azt_lang_menu_find_mistake"))&&void 0!==l?l:"\u0110\xe1p \xe1n t\xecm l\u1ed7i sai"),s.KeyCode.KeyD),this.registerPlugin(new gT(null!==(_=null===(c=this.lang)||void 0===c?void 0:c.myTranslateIntance("azt_lang_menu_enter_latex"))&&void 0!==_?_:"Nh\u1eadp latex"),s.KeyCode.KeyL),this.registerPlugin(new eo(null!==(m=null===(d=this.lang)||void 0===d?void 0:d.myTranslateIntance("azt_lang_menu_italic"))&&void 0!==m?m:"In nghi\xeang","i"),s.KeyCode.KeyI),this.registerPlugin(new eo(null!==(w=null===(p=this.lang)||void 0===p?void 0:p.myTranslateIntance("azt_lang_menu_bold"))&&void 0!==w?w:"In \u0111\u1eadm","b"),s.KeyCode.KeyB),this.registerPlugin(new eo(null!==(A=null===(C=this.lang)||void 0===C?void 0:C.myTranslateIntance("azt_lang_menu_underline"))&&void 0!==A?A:"G\u1ea1ch ch\xe2n","u"),s.KeyCode.KeyU),setTimeout(()=>{this._editor.focus()},200),W}setHoverCalback(s){this.onHoverCalback=s}onChange(s){this.onChangeCalback=s}onChangePosition(s){this.onChangePosCalback=s}onRefreshInclude(s){this.onRefreshCalback=s}onInsertDetails(s){this.onInsertDetailsCb=s}onInsertQuestText(s){this.onInsertQuestTextCb=s}updateLine(s,e,n,i){this._editor.executeEdits("",[{range:{startLineNumber:s,endLineNumber:s,startColumn:e,endColumn:n},text:i}])}insertLine(s){let e=this._editor.getPosition(),i=this._editor.getModel().getLineContent(e.lineNumber),a=i+"\n"+s;this._editor.executeEdits("",[{range:{startLineNumber:e.lineNumber,endLineNumber:e.lineNumber,startColumn:0,endColumn:i.length+1},text:a.trim()}]);let l=e.lineNumber+a.split("\n").length;this._editor.setSelection({startLineNumber:l,endLineNumber:l,startColumn:0,endColumn:0}),this._editor.focus()}removeLines(s,e){let n=this.parseChange;this.parseChange=!1;for(let i=s.length-1;i>=0;i--){let a=s[i],r={startLineNumber:a+1,endLineNumber:a+2,startColumn:0,endColumn:0};0==i&&e&&(this.parseChange=!0),this._editor.executeEdits("",[{range:r,text:""}])}this.parseChange=n}removeText(s,e,n,i){let a={startLineNumber:s,endLineNumber:s,startColumn:e,endColumn:n},r=this.parseChange;this.parseChange=i,this._editor.executeEdits("",[{range:a,text:""}]),this.parseChange=r}getCurPos(){return this._editor.getPosition()}insertAtCurPos(s){let e=this._editor.getPosition();this._editor.executeEdits("",[{range:{startLineNumber:e.lineNumber,endLineNumber:e.lineNumber,startColumn:e.column,endColumn:e.column},text:s.trim()}]);let i=e.lineNumber,a=e.column+s.length;return this._editor.setSelection({startLineNumber:i,endLineNumber:i,startColumn:a,endColumn:a}),this._editor.focus(),{lineIdx:i,startCol:e.column,endCol:a}}runEditAction(s,e,n,i){this.parseChange=!1;let a="",r=0;for(const l of s){let c=l.split("|"),_=+c[0]+1,p=c[3],w={startLineNumber:_,endLineNumber:_,startColumn:+c[1]+1,endColumn:+c[2]+1};if(r==s.length-1&&n&&!i&&(this.parseChange=!0),r==s.length-1&&i&&(p+="|"),e.executeEdits("",[{range:w,text:p}]),r==s.length-1&&i){this.parseChange=null!=n&&n,w.startColumn=w.startColumn+p.length-1,w.endColumn=w.startColumn+1;let C=p.split("\n");C.length>1&&(w.startLineNumber=_+C.length-1,w.endLineNumber=w.startLineNumber,w.startColumn=C[C.length-1].length,w.endColumn=w.startColumn+1),e.executeEdits("",[{range:w,text:""}])}a=p,r++}return this.parseChange=!0,a}runCommand(s,e){var n;let i=e.getPosition(),a=null===(n=this.azotaIntel)||void 0===n?void 0:n.getAutofillValue(i.lineNumber-1,i.column-1,s);if(!a||0==a.length)return;let r=this.runEditAction(a,e,!0,!0),c=e.getModel().getLineCount(),_=r.split("\n").length,m={lineNumber:i.lineNumber+(i.lineNumber+_-1==c&&"enter"==s?_:0),column:("enter"==s?0:i.column)+r.length};e.setPosition(m),this.onChangePosCalback&&this.onChangePosCalback(m.lineNumber,m.column)}zeroPad(s,e){return s=s||2,(new Array(s).join("0")+e).slice(-1*s)}}class vT{constructor(s,e){this.examIntel=new zt.ExamIntellisense(s),this.examIntel.setApiService(e),this.apiService=e}setSingleMode(s){this.examIntel.setSingleMode(s)}setLang(s){this.lang=s}getSuggestions(s,e,n,i){return new Promise(a=>{this.examIntel.getSuggestions(s,e,n,i).then(r=>{a(this.translate(r))})})}getAutofillValue(s,e,n){return this.translate(this.examIntel.getAutofillValue(s,e,n))}getCurPos(s,e){return this.examIntel.getCurPos(s,e)}getCodeLens(s){let e=[],n=0;for(const d of s)/^\[@[CTG]\d+:[^\]]+\]([\.,]\[[^\]]+\])*\.\[[^@:\]]+\d+[^@:\]]+\]$/.test(d.trim())?(e.push(`${n}|insertDirectQuest|azt_lang_editor_insert_direct|azt_lang_editor_insert_direct_desc|${d.trim()}`),e.push(`${n}|randomAgain|azt_lang_editor_random_again|azt_lang_editor_random_again_desc|${d.trim()}`)):/^\[@[CTG]\d+:[^\]]+\]([\.,]\[[^\]]+\])*\.\[@Q\d+:[^\]]*\]$/.test(d.trim())&&e.push(`${n}|insertQuestText|azt_lang_editor_insert_quest_text|azt_lang_editor_insert_quest_text_desc|${d.trim()}`),n++;return this.translate(e)}getApiService(){return this.apiService}onChange(s,e,n){if(1!=s.text.length||"\n"==s.text)this.notiChange(e,n);else{let i=e._editor.getValue(),a=i.split("\n"),r=200;i.length>1e5&&(r=200*i.length/1e5),this.examIntel.setLines(a),clearTimeout(this.waitId),this.waitId=setTimeout(()=>{this.notiChange(e,n)},r)}}onMobileChange(s,e){let n=s.split("\n"),i=400;s.length>1e5&&(i=400*s.length/1e5),this.examIntel.setLines(n),clearTimeout(this.waitId),this.waitId=setTimeout(()=>{let a=this.examIntel.parse();e&&e(n,a)},i)}translate(s){var e,n;let i=[];for(let a of s)i.push(null!==(n=null===(e=this.lang)||void 0===e?void 0:e.translateString(a))&&void 0!==n?n:a);return i}notiChange(s,e){let n=s._editor.getValue(),i=n.split("\n");this.examIntel.setLines(i);let a=this.examIntel.parse(),r=this.examIntel.getEditHint();r&&s.runEditAction(r,s._editor),s.parseChange=!0,r.length>0&&(n=s._editor.getValue(),i=n.split("\n"),this.examIntel.setLines(i),a=this.examIntel.parse()),e&&e(i,a)}}let bT=(()=>{class o extends hT{constructor(){super(...arguments),this.onStartProcessFile=new t.vpe,this.onSwitchFilePdf=new t.vpe}setupDropFile(){const e=jQuery("#frame_monaco_editor");e&&e.on("drag dragstart dragend dragover dragenter dragleave drop",function(n){n.preventDefault(),n.stopPropagation()}).on("dragover dragenter",function(){e.addClass("is-dragover")}).on("dragleave dragend drop",function(){e.removeClass("is-dragover")}).on("drop",n=>{this.onStartProcessFile.emit(n.originalEvent.dataTransfer.files[0])})}initMonaco(){let e=new xT;this.editorApiService&&(e.setIntellisense(new vT(this.config,this.editorApiService)),this._editor=e.init(monaco,this._editorContainer.nativeElement,this.commonService),this._windowResizeSubscription&&this._windowResizeSubscription.unsubscribe(),this._windowResizeSubscription=(0,uT.R)(window,"resize").subscribe(()=>this._editor.layout()),this.setupDropFile(),this.onInit.emit({azotaEditor:e}))}}return o.\u0275fac=function(){let s;return function(n){return(s||(s=t.n5z(o)))(n||o)}}(),o.\u0275cmp=t.Xpm({type:o,selectors:[["azt-monaco-editor"]],inputs:{editorApiService:"editorApiService"},outputs:{onStartProcessFile:"onStartProcessFile",onSwitchFilePdf:"onSwitchFilePdf"},features:[t._Bn([{provide:h.JU,useExisting:(0,t.Gpc)(()=>o),multi:!0}]),t.qOj],decls:4,vars:0,consts:[["id","frame_monaco_editor"],[1,"editor-container"],["editorContainer",""],[1,"file-drop-background"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"div",1,2)(3,"div",3),t.qZA())},styles:["[_nghost-%COMP%]{display:block}.editor-container[_ngcontent-%COMP%]{width:100%;height:100%}#frame_monaco_editor[_ngcontent-%COMP%]{height:100%;position:relative}.file-drop-background[_ngcontent-%COMP%]{display:none;position:absolute;top:0;left:0;width:100%;height:100%;background-color:#00000029;justify-content:center;align-items:center;color:#fff}"]}),o})();function wT(o,s){1&o&&(t.TgZ(0,"div",14),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_dan_tai_thu_vien")," "))}let TT=(()=>{class o extends mt.Q{constructor(e){super(e),this.commonService=e,this.onClose=new t.vpe,this.onInsertLatex=new t.vpe,this.type="math",this.isLoadLibs=!1,this.isMobile=!1}ngOnInit(){this.isLoadLibs=!1,this.isMobile=this.commonService.isMobileOrTable(),this.commonService.loadScriptPromises([{source:"https://www.wiris.net/demo/editor/editor",name:"math2.min.js"}]).then(()=>{this.isLoadLibs=!0,this.mathEditor=com.wiris.jsEditor.JsEditor.newInstance({language:"en"}),this.mathEditor.insertInto(document.getElementById("math_control")),this.chemEditor=com.wiris.jsEditor.JsEditor.newInstance({language:"en",toolbar:'<toolbar ref="chemistry"/>'}),this.chemEditor.insertInto(document.getElementById("chem_control")),this.inp&&(this.mathEditor.setMathML(this.inp.str),this.chemEditor.setMathML(this.inp.str),this.focus())})}actionClose(){this.onClose.emit()}actionInsert(){this.inp&&(this.inp.str="math"==this.type?this.mathEditor.getMathML():this.chemEditor.getMathML(),this.mathEditor.setMathML('<math xmlns="http://www.w3.org/1998/Math/MathML"/>'),this.onInsertLatex.emit(this.inp))}changeType(e){this.type!=e&&("math"==this.type?this.chemEditor.setMathML(this.mathEditor.getMathML()):this.mathEditor.setMathML(this.chemEditor.getMathML()),this.type=e)}focus(){"math"==this.type?this.mathEditor.focus():this.chemEditor.focus()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(vt.v))},o.\u0275cmp=t.Xpm({type:o,selectors:[["mathtype-editor"]],inputs:{inp:"inp"},outputs:{onClose:"onClose",onInsertLatex:"onInsertLatex"},features:[t.qOj],decls:27,vars:18,consts:[[1,"box-dialog"],[1,"dialog-overlay",3,"click"],[1,"dialog-header"],[1,"dialog-title"],[1,"dialog-close",3,"click"],[1,"dialog-body"],[1,"btn-text-primary",3,"click"],["class","dialog-loading",4,"ngIf"],["id","math_control",1,"dialog-content",2,"height","300px",3,"hidden"],["id","chem_control",1,"dialog-content",2,"height","300px",3,"hidden"],[1,"dialog-footer"],[1,"dialog-noti"],[1,"dialog-ok"],[1,"btn","btn-primary","w-24",3,"click"],[1,"dialog-loading"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return n.actionClose()}),t.qZA(),t.TgZ(2,"div")(3,"div",2)(4,"div",3),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"div",4),t.NdJ("click",function(){return n.actionClose()}),t.TgZ(8,"mat-icon"),t._uU(9,"close"),t.qZA()()(),t.TgZ(10,"div",5)(11,"a",6),t.NdJ("click",function(){return n.changeType("math")}),t._uU(12),t.ALo(13,"mytranslate"),t.qZA(),t._uU(14," | "),t.TgZ(15,"a",6),t.NdJ("click",function(){return n.changeType("chem")}),t._uU(16),t.ALo(17,"mytranslate"),t.qZA(),t.YNc(18,wT,3,3,"div",7),t._UZ(19,"div",8)(20,"div",9),t.qZA(),t.TgZ(21,"div",10),t._UZ(22,"div",11),t.TgZ(23,"div",12)(24,"button",13),t.NdJ("click",function(){return n.actionInsert()}),t._uU(25),t.ALo(26,"mytranslate"),t.qZA()()()()()),2&e&&(t.xp6(2),t.Gre("box dialog",n.isMobile?"-mobile":"",""),t.xp6(3),t.hij(" ",t.lcZ(6,10,"lang_auto_soan_thao_cong_thuc")," "),t.xp6(7),t.hij(" ",t.lcZ(13,12,"lang_auto_toan")," "),t.xp6(4),t.hij(" ",t.lcZ(17,14,"lang_auto_hoa")," "),t.xp6(2),t.Q6J("ngIf",!n.isLoadLibs),t.xp6(1),t.Q6J("hidden","math"!=n.type),t.xp6(1),t.Q6J("hidden","chem"!=n.type),t.xp6(5),t.hij(" ",t.lcZ(26,16,"lang_auto_chen")," "))},dependencies:[O.O5,ge.Hw,at.bT],styles:[".box-dialog[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;top:0;left:0;width:100vw;height:100vh;position:fixed;z-index:9999}.box-dialog[_ngcontent-%COMP%]   .dialog-overlay[_ngcontent-%COMP%]{top:0;left:0;width:100vw;height:100vh;position:fixed;background-color:#0000004d}.dialog[_ngcontent-%COMP%]{position:absolute;margin-top:7vh;width:650px;box-shadow:#0000003d 0 3px 8px}.dialog-mobile[_ngcontent-%COMP%]{position:absolute;margin-top:7vh;width:95%;box-shadow:#0000003d 0 3px 8px}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #d0d0d0;padding:10px}.dialog-title[_ngcontent-%COMP%]{font-weight:700}.dialog-close[_ngcontent-%COMP%]{display:flex;align-items:center;border-radius:50%}.dialog-close[_ngcontent-%COMP%]:hover{background-color:#d0d0d04a;cursor:pointer}.dialog-footer[_ngcontent-%COMP%]{display:flex;padding:10px;border-top:1px solid #d0d0d0;justify-content:space-between;align-items:center}.dialog-body[_ngcontent-%COMP%]{padding:10px}.for-type[_ngcontent-%COMP%]{color:#292980;cursor:pointer}"]}),o})(),CT=(()=>{class o extends mt.Q{constructor(){super(...arguments),this.id_content="",this.onDropFile=new t.vpe}onFileSelected(e){let a=e.target.files,r=!!a&&a[0];0!=r&&this.onDropFile.emit(r)}setupDropFile(){const e=jQuery("#frame_inp_editor_"+this.id_content);e&&e.on("drag dragstart dragend dragover dragenter dragleave drop",function(n){n.preventDefault(),n.stopPropagation()}).on("dragover dragenter",function(){e.addClass("is-dragover")}).on("dragleave dragend drop",function(){e.removeClass("is-dragover")}).on("drop",n=>{this.onDropFile.emit(n.originalEvent.dataTransfer.files[0])})}ngAfterViewInit(){this.setupDropFile()}}return o.\u0275fac=function(){let s;return function(n){return(s||(s=t.n5z(o)))(n||o)}}(),o.\u0275cmp=t.Xpm({type:o,selectors:[["question-dropper"]],inputs:{id_content:"id_content"},outputs:{onDropFile:"onDropFile"},features:[t.qOj],decls:13,vars:7,consts:[[1,"editor-drop-file",3,"id","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-6","h-6","text-pending","mx-auto"],["d","M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"],["d","M12 12v9"],["d","m16 16-4-4-4 4"],[1,"link"],["type","file","name","fileHomework",1,"azt-hidden",3,"change"],["formChoseFile",""]],template:function(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"div",0),t.NdJ("click",function(){t.CHM(i);const r=t.MAs(12);return t.KtG(r.click())}),t.O4$(),t.TgZ(1,"svg",1),t._UZ(2,"path",2)(3,"path",3)(4,"path",4),t.qZA(),t.kcU(),t.TgZ(5,"p"),t._uU(6),t.ALo(7,"mytranslate"),t.TgZ(8,"span",5),t._uU(9),t.ALo(10,"mytranslate"),t.qZA()()(),t.TgZ(11,"input",6,7),t.NdJ("change",function(r){return n.onFileSelected(r)}),t.qZA()}2&e&&(t.MGl("id","frame_inp_editor_",n.id_content,""),t.xp6(6),t.hij("",t.lcZ(7,3,"lang_auto_keo_tha_fiel_vao_day_hoc_bam_vao")," "),t.xp6(3),t.Oqu(t.lcZ(10,5,"lang_auto_chon_file")+" ..."))},dependencies:[at.bT],styles:[".editor-drop-file[_ngcontent-%COMP%]{cursor:pointer;text-align:center;border:1px dotted #2462ae;padding:20px;border-radius:5px;-webkit-user-select:none;user-select:none}.editor-drop-file[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:0;margin:0}.editor-drop-file[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:#2462ae}.is-dragover[_ngcontent-%COMP%]{background-color:#2462ae6a}"]}),o})(),AT=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[O.JJ],imports:[x.Bz,O.ez,ce.j,Lt.Xd,Dt.Z_,Sw,h.u5,h.UX,j.Is,Ht.Z,jt.xC,It.QG,Tt.SD,Ct.forRoot(),wt.h,Mt.W,hs,$e.d]}),o})();t.B6R(po.Vn,function(){return[O.sg,O.O5,he.VK,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,te.Q,Hi.L,oe.M,Di,de._,jl,zs]},function(){return[O.JJ,at.bT]}),t.B6R(sT.A,function(){return[O.O5,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,oe.M]},function(){return[at.bT]}),t.B6R(aT.b,function(){return[O.O5,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,oe.M]},function(){return[at.bT]}),t.B6R($i.h,function(){return[O.O5]},function(){return[at.bT]}),t.B6R(Ii.Y,function(){return[O.O5,Lt.Vv,h._Y,h.Fj,h._,h.JJ,h.JL,h.sg,h.u,h.CE,oe.M,ri.o,li.g]},function(){return[at.bT]}),t.B6R(rT.L,function(){return[ge.Hw]},function(){return[at.bT]}),t.B6R(_i.D,function(){return[j.ZT]},function(){return[at.bT]}),t.B6R(to.o,function(){return[O.O5]},function(){return[at.bT]}),t.B6R(lT.b,function(){return[O.O5,ge.Hw,to.o]},function(){return[at.bT]}),t.B6R(cT.h,function(){return[O.mk,O.sg,O.O5,tn.lW,ge.Hw,to.o,_T._]},function(){return[at.bT]}),t.B6R(xo.P,function(){return[O.sg,O.O5,ke.qn,ke.HS,ke.oH,ke.qH,j.ZT,ge.Hw,De.KE,De.hX]},function(){return[at.bT]}),t.B6R(Si,function(){return[O.mk,O.sg,O.O5,O.PC,ge.Hw,he.VK,he.p6,Wt.gM,dT.C,bT,TT,CT,_o.X,Ei,co,Ui,Rl,ho,oT]},function(){return[at.bT,at.QA,at.Ev]}),t.B6R(ql.J,function(){return[O.O5,tn.lW,j.xY,j.H8,sa.pW]},function(){return[at.bT]})}}]);