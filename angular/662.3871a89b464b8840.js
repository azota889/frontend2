"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[662],{86294:(F,A,n)=>{n.d(A,{P:()=>M});var e=n(37398),t=n(39621),i=n(65879),O=n(32839),m=n(87384),S=n(69862),c=n(96814),g=n(75203);function Z(w,Q){if(1&w){const x=i.EpF();i.ynx(0),i.TgZ(1,"a",2),i.NdJ("click",function(){i.CHM(x);const v=i.oxw();return i.KtG(v.shareFileToFlutter())}),i.TgZ(2,"span"),i._uU(3),i.ALo(4,"mytranslate"),i.qZA(),i.Hsn(5),i.qZA(),i.BQk()}if(2&w){const x=i.oxw();i.xp6(1),i.Akn(x.style),i.Tol(x.classStyle),i.s9C("target",x.target),i.xp6(2),i.Oqu(i.lcZ(4,7,x.fileDescription))}}function T(w,Q){if(1&w&&(i.TgZ(0,"a",3)(1,"span"),i._uU(2),i.ALo(3,"mytranslate"),i.qZA(),i.Hsn(4,1),i.qZA()),2&w){const x=i.oxw();i.Akn(x.style),i.Tol(x.classStyle),i.s9C("href",x.dataUrl,i.LSH),i.s9C("target",x.target),i.s9C("download",x.fileName),i.xp6(2),i.Oqu(i.lcZ(3,9,x.fileDescription))}}const P=["*","*"];let M=(()=>{class w extends t.Q{downloadFile(){return this.http.get(this.dataUrl,{responseType:"blob"}).pipe((0,e.U)(x=>x))}shareFileToFlutter(){this.downloadFile().subscribe(x=>{this.shareFileFlutterService.shareFileWithBlob(x,this.fileName)})}ngOnInit(){super.ngOnInit()}constructor(x,j,v){super(),this.shareFileFlutterService=x,this.commonService=j,this.http=v,this.dataUrl="",this.target="",this.fileName="",this.fileDescription="",this.classStyle="",this.style=""}}return w.\u0275fac=function(x){return new(x||w)(i.Y36(O.g),i.Y36(m.z),i.Y36(S.eN))},w.\u0275cmp=i.Xpm({type:w,selectors:[["azt-download-link-item"]],inputs:{dataUrl:"dataUrl",target:"target",fileName:"fileName",fileDescription:"fileDescription",classStyle:"classStyle",style:"style"},features:[i.qOj],ngContentSelectors:P,decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["NormalWeb",""],[3,"target","click"],[3,"href","target","download"]],template:function(x,j){if(1&x&&(i.F$t(P),i.YNc(0,Z,6,9,"ng-container",0),i.YNc(1,T,5,11,"ng-template",null,1,i.W1O)),2&x){const v=i.MAs(2);i.Q6J("ngIf",j.isMobileWebView)("ngIfElse",v)}},dependencies:[c.O5,g.JV],encapsulation:2}),w})()},50006:(F,A,n)=>{n.d(A,{M:()=>S});var e=n(39621),t=n(65879),i=n(96814);function O(c,g){1&c&&(t.O4$(),t.TgZ(0,"svg",2),t._UZ(1,"polyline",3)(2,"polyline",4),t.qZA())}function m(c,g){1&c&&(t.O4$(),t.TgZ(0,"svg",2),t._UZ(1,"polyline",5)(2,"polyline",6),t.qZA())}let S=(()=>{class c extends e.Q{constructor(){super(...arguments),this.isScrollToTop=!1}scrollTo(){this.isScrollToTop?window.scrollTo(0,0):window.scrollTo(0,document.body.scrollHeight)}ngOnInit(){super.ngOnInit()}}return c.\u0275fac=function(){let g;return function(T){return(g||(g=t.n5z(c)))(T||c)}}(),c.\u0275cmp=t.Xpm({type:c,selectors:[["azt-scroll-to-top-bottom"]],inputs:{isScrollToTop:"isScrollToTop"},features:[t.qOj],decls:3,vars:2,consts:[["azt-track-service","azt-scroll-to-top-bottom-DbRV8ySsXT1",1,"toolBarMobile","clickable",3,"click"],["style","color: white","xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",2,"color","white"],["points","17 11 12 6 7 11"],["points","17 18 12 13 7 18"],["points","7 13 12 18 17 13"],["points","7 6 12 11 17 6"]],template:function(Z,T){1&Z&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return T.scrollTo()}),t.YNc(1,O,3,0,"svg",1),t.YNc(2,m,3,0,"svg",1),t.qZA()),2&Z&&(t.xp6(1),t.Q6J("ngIf",T.isScrollToTop),t.xp6(1),t.Q6J("ngIf",!T.isScrollToTop))},dependencies:[i.O5],styles:[".toolBarMobile[_ngcontent-%COMP%]{position:fixed;bottom:0;right:0;z-index:100;margin:0 40px 25px;padding:5px;background:rgba(181,181,181,.5294117647);border-radius:3px}"]}),c})()},79566:(F,A,n)=>{n.d(A,{v:()=>ie});var e=n(65879),t=n(56223),i=n(39621),O=n(5961),m=n(49691),S=n(32457),c=n(21266),g=n(14819),Z=n(69862),T=n(3760),P=n(10548),M=n(87384),w=n(50503);let Q=(()=>{class d{constructor(o,s){this.commonService=o,this.apiUploadService=s,this.sizeDefaultCanvas=1100,this.actionRunAfterConvert=[],this.imageMaps=[],this.pattern_base64=/data:image[^"'\\]+/i,this.pattern_image=/<img[^>]+data:image[^>]+>/g,this.taskConvertBase64ToCanvas=new T.Q(50,{function:(l,a)=>{this.callbackBase64ToCanvas&&this.callbackBase64ToCanvas(l,a)}}),this.taskUploadImage=new T.Q(3,{function:(l,a)=>{this.callbackUploadImage&&this.callbackUploadImage(l,a)}})}convertQuestions(o,s,l){return new Promise(a=>{this.reset(),o.forEach(h=>{const f=this.commonService.willDeleteParseJson(h.answerConfig||"[]");h.questionContent?.includes("<img ")&&this.replaceImageCdnInContent(h,"questionContent"),h.questionText?.includes("<img ")&&this.replaceImageCdnInContent(h,"questionText"),h.answerMedia?.includes("<img ")&&this.replaceImageCdnInContent(h,"answerMedia"),h.mediaMeta?.includes("<img ")&&this.replaceImageCdnInContent(h,"mediaMeta"),f.forEach(C=>{C.content.includes("<img ")&&this.replaceImageCdnInContent(C,"content")}),this.actionRunAfterConvert.push(()=>{h.answerConfig=JSON.stringify(f)})}),this.imageMaps.forEach(h=>{this.taskConvertBase64ToCanvas.addTask(this,this.startConvertCanvas,[h])}),this.taskConvertBase64ToCanvas.start().then(h=>{if(h.errs.length>0)l(h.errs,void 0);else{let C=0;const p=[],z=()=>{const y=document.createElement("canvas");y.width=this.sizeDefaultCanvas,y.height=this.sizeDefaultCanvas;const U=y.getContext("2d");U&&(U.fillStyle="white",U.fillRect(0,0,this.sizeDefaultCanvas,this.sizeDefaultCanvas)),p.push({cdn:"",cX:0,cY:0,canvas:y,imgs:[]})};z(),h.datas.forEach((y,U)=>{var I=p[p.length-1];I.cX+y.canvas.width+4>this.sizeDefaultCanvas?(I.cX=4,I.cY+=C+4,C=0):I.cX+=4,I.cY+y.canvas.height>this.sizeDefaultCanvas&&(z(),I=p[p.length-1]);var B=I.canvas.getContext("2d");I.imgs.push({x:I.cX,y:I.cY,width:y.canvas.width,height:y.canvas.height,index:U}),B?.drawImage(y.canvas,0,0,y.canvas.width,y.canvas.height,I.cX,I.cY,y.canvas.width,y.canvas.height),I.cX+=y.canvas.width,C=C<y.canvas.height?y.canvas.height:C}),p[0].imgs.length>0&&p.forEach(y=>{this.taskUploadImage.addTask(this,this.startUploadFile,[y])}),this.taskUploadImage.start().then(y=>{if(y.errs.length>0)l(h.errs,void 0);else{let U=!0;y.datas.forEach(I=>{I.imgs.forEach(B=>{const D=h.datas[B.index];if(D){const J={link:I.cdn,data:{x:B.x,y:B.y,width:B.width,height:B.height}};D.objs.forEach(N=>{if(N[D.path])if(this.commonService.isJson(N[D.path])){const W=this.commonService.willDeleteParseJson(N[D.path]);Object.prototype.hasOwnProperty.call(W,"renderedStr")?(W.renderedStr=W.renderedStr.replace(D.base,`@[]${JSON.stringify(J)}@[]`),N[D.path]=JSON.stringify(W)):N[D.path]=N[D.path].replace(D.base,`@[]${JSON.stringify(J)}@[]`)}else N[D.path]=N[D.path].replace(D.base,`@[]${JSON.stringify(J)}@[]`);else U=!1})}})}),U?(this.actionRunAfterConvert.forEach(I=>{I()}),o.forEach((I,B)=>{let D=this.commonService.willDeleteParseJson(I.mediaMeta||"{}"),J=s[B];const N={id:0,name:I.name,extension:"text",content:I.questionContent,groupContent:D.renderedStr,metaData:{isFixAns:Number(I.isFixAns),forcedFixAns:!1,groupType:I.groupType?Number(I.groupType):void 0}};J&&(N.vMetaEditor=J.meta),I.questionContent=JSON.stringify([N])}),a()):l(h.errs,void 0,!0)}})}})})}reset(){this.imageMaps=[],this.actionRunAfterConvert=[]}replaceImageCdnInContent(o,s){var l=o[s];if(this.commonService.isJson(o[s])){const f=this.commonService.willDeleteParseJson(o[s]);Object.prototype.hasOwnProperty.call(f,"renderedStr")&&(l=f.renderedStr)}let a=l.matchAll(this.pattern_image);for(;;){let f=a.next();if(f.done)break;let C=f.value[0];var h=this.imageMaps.findIndex(p=>p.base===C&&p.path===s);-1===h?this.imageMaps.push({base:C,cdn:"",data:null,objs:[o],path:s,canvas:document.createElement("canvas")}):this.imageMaps[h].objs.push(o)}}startConvertCanvas(o){return new Promise((s,l)=>{const a=new Image;a.crossOrigin="anonymous",a.onload=()=>{let f=1;if(a.width>this.sizeDefaultCanvas&&(f=this.sizeDefaultCanvas/a.width),a.height>this.sizeDefaultCanvas){let p=this.sizeDefaultCanvas/a.height;p<f&&(f=p)}o.canvas.width=a.width*f,o.canvas.height=a.height*f,o.canvas.getContext("2d")?.drawImage(a,0,0,a.width,a.height,0,0,o.canvas.width,o.canvas.height),s(o)},a.onerror=()=>{o.canvas.width=1,o.canvas.height=1;const f=o.canvas.getContext("2d");f&&(f.fillStyle="white",f.fillRect(0,0,1,1)),s(o)};let h=this.pattern_base64.exec(o.base);null!=h?a.src=h[0]:l(new Error("l\u1ed7i regex"))})}startUploadFile(o){return new Promise((s,l)=>{const a=this.dataURLtoFile(o.canvas.toDataURL("image/png",1));(0,P.hv)(a).then(h=>{this.apiUploadService.uploadToCdnProgressForExamQuestionContent(h).subscribe(f=>{f.type!=Z.dt.UploadProgress&&(1==f.success&&f.data?s({...o,cdn:f.data.url||""}):l(new Error(this.commonService.translateToKeyParam("lang_auto_khong_upload_duoc_anh_vui_long_thu_lai_sau_loi",f.message??"none"))))})})})}dataURLtoFile(o){let s=this.getFileName(o);for(var l=o.split(","),a=l[0].match(/:(.*?);/),h=atob(l[1]),f=h.length,C=new Uint8Array(f);f--;)C[f]=h.charCodeAt(f);return new File([C],s,{type:a&&a.length>0?a[1]:"png"})}getFileName(o){var s=o.split("").reverse().join(""),l=s.indexOf(";"),a=s.indexOf("/",l);return s.substring(l,a).split("").reverse().join("")}}return d.\u0275fac=function(o){return new(o||d)(e.LFG(M.z),e.LFG(w.W))},d.\u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();var x=n(59694),j=n(32955),v=n(46025),_=n(25679);let r=(()=>{class d{constructor(o,s){this.questionService=o,this.dataAztMathRawHelper=s,this.commonService=(0,e.f3M)(M.z)}convertSaveQuestion(o){return new Promise((s,l)=>{const a=new T.Q(3);o.forEach(h=>{a.addTask(this.dataAztMathRawHelper,this.dataAztMathRawHelper.encodeQuestion,[h])}),a.start().then(h=>{0===h.errs.length?s(h.datas):l(h.errs[0])})})}saveQuestionObjsFromEditor(o,s,l){return new Promise(a=>{this.convertSaveQuestion(s).then(h=>{let f=[];for(let C=0;C<h.length;C++){let p=h[C];p.expandInfo=this.commonService.serializeJson(o.exam?.examObj.expandInfoObj),f.push(p)}this.questionService.docBankApiV1QuestionsPost({listQuestions:f}).subscribe(C=>{a(C.list?{indexSaved:C.list.length+l,listQuestionId:C.list}:{indexSaved:l,listQuestionId:[]})})}).catch(()=>{a({indexSaved:l,listQuestionId:[]})})})}}return d.\u0275fac=function(o){return new(o||d)(e.LFG(v.aE),e.LFG(_.n))},d.\u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();var u=n(31518),b=n(96814),E=n(5647),k=n(775),G=n(53903),R=n(10766),K=n(75203);function V(d,L){1&d&&(e.TgZ(0,"div",14)(1,"div",19)(2,"div",16),e._UZ(3,"input",21),e.ALo(4,"mytranslate"),e.qZA(),e.TgZ(5,"div",22),e._UZ(6,"input",21),e.ALo(7,"mytranslate"),e.qZA(),e.TgZ(8,"div",22),e._UZ(9,"input",21),e.ALo(10,"mytranslate"),e.qZA()()()),2&d&&(e.xp6(3),e.s9C("placeholder",e.lcZ(4,3,"lang_auto_nhap_ho_va_ten")),e.xp6(3),e.s9C("placeholder",e.lcZ(7,5,"lang_auto_nhap_so_dien_thoai")),e.xp6(3),e.s9C("placeholder",e.lcZ(10,7,"lang_document_workplace")))}function q(d,L){if(1&d&&(e.TgZ(0,"div",25)(1,"div",26),e._UZ(2,"input",27),e.TgZ(3,"label",28)(4,"span"),e._uU(5),e.qZA()()()()),2&d){const o=L.index,s=e.oxw(2);e.xp6(2),e.s9C("id","knowledge-"+s.listKnowledge[o].id),e.Q6J("formControlName",o),e.xp6(1),e.s9C("for","knowledge-"+s.listKnowledge[o].id),e.xp6(2),e.Oqu(s.listKnowledge[o].name)}}function H(d,L){if(1&d&&(e.TgZ(0,"div",14)(1,"div",3)(2,"div",16)(3,"span",17),e._uU(4),e.ALo(5,"mytranslate"),e.qZA()(),e.TgZ(6,"div",23)(7,"div",19),e.YNc(8,q,6,4,"div",24),e.qZA()()()()),2&d){const o=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,2,"lang_document_the_knowledge_units_present_in_the_exam")," "),e.xp6(4),e.Q6J("ngForOf",o.formArrayListKnowledge.controls)}}function X(d,L){if(1&d&&(e.TgZ(0,"div",29)(1,"div",26),e._UZ(2,"input",27),e.TgZ(3,"label",28)(4,"span"),e._uU(5),e.ALo(6,"mytranslate"),e.qZA()()()()),2&d){const o=L.index,s=e.oxw();e.xp6(2),e.s9C("id","week-"+s.listWeek[o]),e.Q6J("formControlName",o),e.xp6(1),e.s9C("for","week-"+s.listWeek[o]),e.xp6(2),e.Oqu(e.lcZ(6,4,"lang_document_week")+" "+s.listWeek[o])}}let $=(()=>{class d extends i.Q{constructor(){super(),this.listKnowledge=[],this.listWeek=[],this.formArrayListKnowledge=new t.Oe([]),this.formArrayListWeed=new t.Oe([])}ngOnInit(){super.ngOnInit(),this.initWeedCheckbox(this.listWeek)}ngOnChanges(){this.initForm(),this.initKnowledgeCheckbox(this.listKnowledge)}initKnowledgeCheckbox(o){this.formArrayListKnowledge.clear();for(let s=0;s<o.length;s++){const a=new t.NI(!1,{nonNullable:!0});this.formArrayListKnowledge.push(a)}}initWeedCheckbox(o){this.formArrayListWeed.clear();for(let s=0;s<o.length;s++){const a=new t.NI(!1,{nonNullable:!0});this.formArrayListWeed.push(a)}}initForm(){this.formArrayListWeed=this.form.controls.weeks,this.formArrayListKnowledge=this.form.controls.knowledgeIds}}return d.\u0275fac=function(o){return new(o||d)},d.\u0275cmp=e.Xpm({type:d,selectors:[["azt-config-document-market"]],inputs:{form:"form",listKnowledge:"listKnowledge",listWeek:"listWeek"},features:[e.qOj,e.TTD],decls:31,vars:16,consts:[[1,"mt-5"],[3,"formGroup"],[1,"box","p-3"],[1,"grid","grid-cols-12"],[1,"col-span-12","lg:col-span-5"],["for","general-name",1,"form-label","mb-0","font-medium","flex","items-center"],[1,"col-span-12","lg:col-span-7"],[1,"flex","flex-col","sm:flex-row"],[1,"form-check","mr-8"],["type","radio","id","creator-by-me","formControlName","creatorId","value","1",1,"form-check-input"],["for","creator-by-me",1,"form-check-label"],["type","radio","id","creator-by-user-other","formControlName","creatorId","value","0",1,"form-check-input"],["for","creator-by-user-other",1,"form-check-label"],["class","mt-3",4,"ngIf"],[1,"mt-3"],["formArrayName","weeks",1,"list-week","grid","grid-cols-12"],[1,"col-span-12"],[1,"form-label","mb-0","font-medium","flex","items-center"],[1,"list-week","col-span-12"],[1,"grid","grid-cols-12","gap-3"],["class","col-span-6 md:col-span-3 lg:col-span-2",4,"ngFor","ngForOf"],["type","text",1,"form-control",3,"placeholder"],[1,"cols-span-12","md:col-span-6"],["formArrayName","knowledgeIds",1,"list-knowledge","col-span-12"],["class","col-span-12 md:col-span-6",4,"ngFor","ngForOf"],[1,"col-span-12","md:col-span-6"],[1,"azt-form-check"],["type","checkbox","value","41556",1,"form-check-input",3,"formControlName","id"],[1,"form-check-label",2,"vertical-align","middle",3,"for"],[1,"col-span-6","md:col-span-3","lg:col-span-2"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),e._uU(6),e.ALo(7,"mytranslate"),e.qZA()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8),e._UZ(11,"input",9),e.TgZ(12,"label",10),e._uU(13),e.ALo(14,"mytranslate"),e.qZA()(),e.TgZ(15,"div",8),e._UZ(16,"input",11),e.TgZ(17,"label",12),e._uU(18),e.ALo(19,"mytranslate"),e.qZA()()()()(),e.YNc(20,V,11,9,"div",13),e.YNc(21,H,9,4,"div",13),e.TgZ(22,"div",14)(23,"div",15)(24,"div",16)(25,"span",17),e._uU(26),e.ALo(27,"mytranslate"),e.qZA()(),e.TgZ(28,"div",18)(29,"div",19),e.YNc(30,X,7,6,"div",20),e.qZA()()()()()()()),2&o&&(e.xp6(1),e.Q6J("formGroup",s.form),e.xp6(5),e.hij(" ",e.lcZ(7,8,"lang_document_author")," "),e.xp6(7),e.hij(" ",e.lcZ(14,10,"lang_document_me")," "),e.xp6(5),e.hij(" ",e.lcZ(19,12,"lang_document_others")," "),e.xp6(2),e.Q6J("ngIf","0"==s.form.controls.creatorId.value),e.xp6(1),e.Q6J("ngIf",s.formArrayListKnowledge.controls.length),e.xp6(5),e.hij(" ",e.lcZ(27,14,"lang_document_time_of_use")," "),e.xp6(4),e.Q6J("ngForOf",s.formArrayListWeed.controls))},dependencies:[b.sg,b.O5,t._Y,t.Fj,t.Wl,t._,t.JJ,t.JL,t.sg,t.u,t.CE,k.M,K.JV],encapsulation:2}),d})();function ee(d,L){1&d&&e._UZ(0,"azt-loading-effect")}function te(d,L){1&d&&(e.TgZ(0,"div",27),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&d&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"lang_auto_vui_long_nhap_ten_de_thi")," "))}function oe(d,L){if(1&d){const o=e.EpF();e.TgZ(0,"div",3)(1,"form",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"div",8)(6,"div",9)(7,"label",10),e._uU(8),e.ALo(9,"mytranslate"),e.qZA()(),e.TgZ(10,"div",9)(11,"div",11),e._UZ(12,"input",12),e.ALo(13,"mytranslate"),e.qZA(),e.YNc(14,te,3,3,"div",13),e.qZA()(),e.TgZ(15,"div",14)(16,"config-level-subject",15),e.NdJ("idSubjectInLevel",function(l){e.CHM(o);const a=e.oxw();return e.KtG(a.checkSubjectIdInList(l))}),e.qZA()(),e.TgZ(17,"div",16),e._UZ(18,"config-purpose-exam",17),e.qZA(),e.TgZ(19,"div",18)(20,"div",9)(21,"label",19),e._uU(22),e.ALo(23,"mytranslate"),e.qZA()(),e.TgZ(24,"div",9)(25,"div",11),e._UZ(26,"textarea",20),e.ALo(27,"mytranslate"),e.qZA()()()(),e.TgZ(28,"div",21),e._UZ(29,"azt-config-document-market",22),e.qZA(),e.TgZ(30,"div",23)(31,"div",24)(32,"button",25),e.NdJ("click",function(){e.CHM(o);const l=e.oxw();return e.KtG(l.handleDestroy())}),e._uU(33),e.ALo(34,"mytranslate"),e.qZA(),e.TgZ(35,"button",26),e.NdJ("click",function(){e.CHM(o);const l=e.oxw();return e.KtG(l.handleSaveDocument())}),e._uU(36),e.ALo(37,"mytranslate"),e.qZA()()()()()()()}if(2&d){const o=e.oxw();e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(7),e.hij(" ",e.lcZ(9,18,"lang_auto_ten")," "),e.xp6(4),e.s9C("placeholder",e.lcZ(13,20,"lang_auto_nhap_ten")+" ..."),e.xp6(2),e.Q6J("ngIf",o.form.controls.name.errors),e.xp6(2),e.Q6J("form",o.form)("schoolLevelObjs",o.schoolLevelObjs)("schoolSubjectObjs",o.schoolSubjectObjs)("examSchoolLogObj",o.examSchoolLogObj)("isSetValueByLog",!1),e.xp6(2),e.Q6J("purposeList",o.listPurposeObjs)("form",o.form),e.xp6(4),e.hij(" ",e.lcZ(23,22,"lang_auto_mo_ta")," "),e.xp6(4),e.s9C("placeholder",e.lcZ(27,24,"lang_auto_nhap_ten")+" ..."),e.xp6(3),e.Q6J("form",o.form)("listWeek",o.listWeek)("listKnowledge",o.listKnowledge),e.xp6(4),e.hij(" ",e.lcZ(34,26,"lang_auto_huy")," "),e.xp6(3),e.hij(" ",e.lcZ(37,28,"lang_auto_luu")," ")}}function se(d,L){if(1&d&&(e.TgZ(0,"div",28)(1,"div",29)(2,"div",30)(3,"span"),e._UZ(4,"span",31),e._uU(5," \xa0 "),e.qZA(),e.TgZ(6,"div",32),e._uU(7),e.qZA()()()()),2&d){const o=e.oxw();e.xp6(7),e.Oqu(o.logConfig.msg)}}let ie=(()=>{class d extends i.Q{constructor(o,s,l,a,h,f,C,p,z,y){super(),this.documentConfigService=o,this.activeRoute=s,this.examService=l,this.documentService=a,this.knowledgeService=h,this.questionShareSaveService=f,this.editorOutputDataService=C,this.partQuestionSearchTextService=p,this.sAztSaveProcessService=z,this.browserStorageService=y,this.type=m.e.exam,this.isCreateQuestionToEditor=!1,this.onBack=new e.vpe,this.schoolLevelObjs=[],this.schoolSubjectObjs=[],this.listPurposeObjs=[],this.listKnowledge=[],this.listWeek=[],this.isSubjectIdInList=!1,this.logConfig={},this.dataSave={},this.saveParts=[],this.questionContent=[],this.countProcess=0,this.form=new t.cw({name:new t.NI("",{nonNullable:!0,validators:[t.kI.required,O._.noWhiteSpace]}),description:new t.NI("",{nonNullable:!0}),schoolLevel:new t.NI(0,{nonNullable:!0,validators:[t.kI.required]}),schoolSubject:new t.NI(0,{nonNullable:!0,validators:[t.kI.required]}),purposeExam:new t.NI(0,{nonNullable:!0,validators:[t.kI.required,t.kI.min(1)]}),purposeNote:new t.NI("",{nonNullable:!0}),knowledgeIds:new t.Oe([]),weeks:new t.Oe([]),creatorId:new t.NI("1",{nonNullable:!0}),creatorFullName:new t.NI("",{nonNullable:!0}),creatorPhone:new t.NI("",{nonNullable:!0}),creatorWorkingAddress:new t.NI("",{nonNullable:!0})}),this.type===m.e.exam&&this.isCreateQuestionToEditor&&this.initQuestionShare()}ngOnInit(){super.ngOnInit(),this.GetSubjectAndLevel(),this.createListWeek();const o=Number(this.commonService.getMyParam(this.activeRoute,"levelId")),s=Number(this.commonService.getMyParam(this.activeRoute,"subjectId"));if(this.form.controls.schoolLevel.setValue(o),this.form.controls.schoolSubject.setValue(s),this.getKnowledgeData(),this.form.controls.schoolSubject.valueChanges.subscribe(l=>{this.getKnowledgeData()}),this.form.controls.schoolLevel.valueChanges.subscribe(l=>{this.getKnowledgeData()}),this.type===m.e.exam&&this.isCreateQuestionToEditor){this.dataSave=this.editorOutputDataService.getOutputData();const l=25;this.questionContent=[],this.dataSave.exam?.questionObj.listQuestions?.forEach((h,f)=>{f<l&&this.questionContent.push(this.partQuestionSearchTextService.partQuestionSearchTextByQuestionForm(h))}),this.GetSubjectAndLevel(),this.form.controls.name.setValue(this.dataSave.exam?.examObj.name??this.dataSave.homework?.name??"")}}getLogPredictSubject(o){this.predictLogRequestObj=o}checkSubjectIdInList(o){this.isSubjectIdInList=o}handleDestroy(){this.onBack.emit(!0)}handleSaveDocument(){if(this.type===m.e.exam&&this.isCreateQuestionToEditor&&(this.logConfig.status=!0,this.logConfig.msg=this.commonService.myTranslateInstant("lang_auto_dang_luu_du_lieu_de_thi")??"",this.countProcess=0,this.dataSave.exam&&this.dataSave.exam.questionObj.listQuestions)){const o=this.dataSave.exam.questionObj.listQuestions;let s=this.commonService.myTranslateInstant("lang_auto_xay_ra_loi_trong_qua_trinh_xu_ly_hinh_anh_cua_de_thi")??"";this.questionShareSaveService.convertQuestions(o,this.dataSave.exam.rootQuests,(l,a=s,h)=>{this.logConfig.status=!1,this.logConfig.msg="",this.showErrorSnack(a),h&&this.stopStatusObj()}).then(()=>{this.startMainProcessSaveEditor()})}this.type===m.e.exam&&!this.isCreateQuestionToEditor&&(this.logConfig.status=!0,this.logConfig.msg=this.commonService.myTranslateInstant("lang_auto_dang_luu_du_lieu_de_thi")??"",this.examId&&this.shareDocument()),this.type!==m.e.exam&&(this.logConfig.status=!0,this.logConfig.msg=this.commonService.myTranslateInstant("lang_auto_dang_luu_du_lieu_de_thi")??"",this.shareDocument())}initQuestionShare(){this.questionShareSaveService.callbackBase64ToCanvas=(o,s)=>{let l=this.commonService.myTranslateInstant("lang_auto_dang_xu_ly_hinh_anh_cho_de_thi");this.logConfig.msg=`${l} ${Math.floor(o/s*100*.7)}%`},this.questionShareSaveService.callbackUploadImage=(o,s)=>{let l=this.commonService.myTranslateInstant("lang_auto_dang_xu_ly_hinh_anh_cho_de_thi");this.logConfig.msg=`${l} ${Math.floor(o/s*100*.3)+70}%`}}processSaveQuestionsFromEditor(o,s,l){if(this.dataSave.exam?.questionObj&&this.dataSave.exam?.questionObj.listQuestions){var a=this.dataSave.exam?.questionObj.listQuestions.length;let h=o+100>a?a:o+100,f=this.dataSave.exam?.questionObj.listQuestions.slice(o,h)??[],C=[];for(const p of f)C.push({categoryId:p.categoryId,groupId:p.groupId,name:p.name??"none",metadata:p.metadata,isImage:p.isImage,questionContent:p.questionContent,answerMedia:p.answerMedia,questionText:p.questionText,answerType:p.answerType,answerConfig:p.answerConfig,coordinates:p.coordinates,answerResult:p.answerResult,totalQuestion:p.totalQuestion,tags:p.tags??[],mediaId:p.mediaId,mediaMeta:p.mediaMeta,attachments:p.attachments,version:p.version,isFixAns:p.isFixAns,groupType:p.groupType,__path:p.__path});C.length>0?this.sAztSaveProcessService.saveQuestionObjsFromEditor(this.dataSave,C,s).then(p=>{if(p&&p.listQuestionId.length>0){let z=l.concat(p);this.processSaveQuestionsFromEditor(h,p.indexSaved,z)}else this.countProcess=0,this.logConfig.status=!1,this.logConfig.msg="",this.showErrorSnack("lang_auto_khong_luu_duoc_noi_dung_cau_hoi_trong_de_vui_long_kiem_tra_lai")}):this.shareDocument(l)}}startMainProcessSaveEditor(){this.dataSave.exam&&this.dataSave.exam.questionObj&&this.processSaveQuestionsFromEditor(0,0,[])}GetSubjectAndLevel(){this.initStatusObj(),this.subscriptions.add(this.documentConfigService.apiDocumentConfigGetSubjectAndLevelObjsGet().subscribe(o=>{if(1==o.success){this.examSchoolLogObj=o.data?.examSchoolLogObj,this.schoolLevelObjs=o.data?.schoolLevelObjs??[],this.schoolSubjectObjs=o.data?.schoolSubjectObjs??[];const s=Number(this.browserStorageService.getSimpleStorage("levelId")??0),l=Number(this.browserStorageService.getSimpleStorage("subjectId")??0);this.form.controls.schoolLevel.setValue(s),this.form.controls.schoolSubject.setValue(l),this.getListPurposeExam()}else this.errorStatusObj(o.message??"")}))}shareDocument(o){const s=this.getWeeksChecked(this.listWeek,this.form.controls.weeks.value),l=this.getKnowledgeIdsChecked(this.listKnowledge,this.form.controls.knowledgeIds.value);if(this.checkErrorValidateSave(s,l))return void this.showErrorSnack("lang_cms_utils_folder_name_validate_space");let a={name:this.form.controls.name.value,type:this.type,schoolLevelId:this.form.controls.schoolLevel.value,schoolSubjectId:this.form.controls.schoolSubject.value,purposeId:this.form.controls.purposeExam.value,purposeNote:this.form.controls.purposeNote.value,description:this.form.controls.description.value,creatorId:Number(this.form.controls.creatorId.value),creatorFullName:this.form.controls.creatorFullName.value,creatorPhone:this.form.controls.creatorPhone.value,creatorWorkingAddress:this.form.controls.creatorWorkingAddress.value,knowledgeIds:l,weeks:s};switch(this.type){case m.e.exam:if(o&&this.isCreateQuestionToEditor){let h=[];h=o[0].listQuestionId.map(f=>f??0)??[],a.questionIds=h}this.examId&&!this.isCreateQuestionToEditor&&(a.examId=this.examId,a.questionIds=[]);break;case m.e.lecture:a.link=this.link;break;case m.e.ref:a.link=this.link,a.fileType=this.fileType}this.subscriptions.add(this.documentService.docBankApiV1DocumentsPost(a).subscribe(h=>{h.id?(this.successStatusObj("lang_document_successful_sharing",!0),this.myNavigation("/document-market/home")):this.errorStatusObj("")}))}getListPurposeExam(){this.initStatusObj(),this.subscriptions.add(this.examService.apiExamListExamPurposesGet().subscribe(o=>{1===o.success?(this.listPurposeObjs=o.data?.objs??[],this.successStatusObj()):this.errorStatusObj(o.message??"",!0)}))}createListWeek(){for(let s=0;s<35;s++)this.listWeek.push(s+1)}getKnowledgeData(){const o=this.form.controls.schoolLevel.value,s=this.form.controls.schoolSubject.value;o&&s&&this.subscriptions.add(this.knowledgeService.docBankApiV1KnowledgeGet(o,s).subscribe(l=>{l.list&&(this.listKnowledge=l.list)}))}checkErrorValidateSave(o,s){return!(!this.form.invalid&&("0"!=this.form.controls.creatorId.value||this.form.controls.creatorFullName.value&&this.form.controls.creatorFullName.value&&this.form.controls.creatorPhone.value&&this.form.controls.creatorWorkingAddress.value)&&o.length&&s.length)}getKnowledgeIdsChecked(o,s){let l=[];for(let a=0;a<s.length;a++)s[a]&&o[a]&&l.push(o[a].id);return l}getWeeksChecked(o,s){let l=[];for(let a=0;a<s.length;a++)s[a]&&o[a]&&l.push(o[a]);return l}}return d.\u0275fac=function(o){return new(o||d)(e.Y36(S.Cq),e.Y36(c.gz),e.Y36(S.Oe),e.Y36(g.Zg),e.Y36(g.zH),e.Y36(Q),e.Y36(x.O),e.Y36(j.r),e.Y36(r),e.Y36(u.n))},d.\u0275cmp=e.Xpm({type:d,selectors:[["azt-config-share-document"]],inputs:{type:"type",isCreateQuestionToEditor:"isCreateQuestionToEditor",fileType:"fileType",link:"link",examId:"examId"},outputs:{onBack:"onBack"},features:[e.qOj],decls:4,vars:3,consts:[[4,"ngIf","ngIfElse"],["doneLoading",""],["style","width: 100vw; height: 100vh; position: fixed; z-index: 9999; top: 0; left: 0; display: flex; justify-content: center; align-items: center; background-color: rgba(0, 0, 0, 0.4)",4,"ngIf"],[1,"intro-y","mt-8","p-3"],[3,"formGroup"],[1,"mx-auto",2,"max-width","1100px"],[1,"setting-block"],[1,"box","mt-2","p-3"],["id","azt-config-name",1,"grid","grid-cols-12"],[1,"col-span-12","lg:col-span-12"],["for","general-name",1,"form-label","mb-0","font-medium","flex","items-center"],[1,"setting-input"],["id","general-name","formControlName","name","type","text",1,"form-control",3,"placeholder"],["class","mt-2 text-danger text-xs fade",4,"ngIf"],[1,"mt-4"],[3,"form","schoolLevelObjs","schoolSubjectObjs","examSchoolLogObj","isSetValueByLog","idSubjectInLevel"],[1,"mt-2"],[3,"purposeList","form"],["id","azt-config-desc",1,"grid","grid-cols-12","mt-4"],["for","general-desc",1,"form-label","mb-0","font-medium","flex","items-center"],["id","general-desc","formControlName","description",1,"form-control","w-full",2,"height","150px",3,"placeholder"],[1,"config-document-market"],[3,"form","listWeek","listKnowledge"],[1,"mt-5"],[1,"text-right"],[1,"btn","btn-secondary","w-24","mr-2",3,"click"],[1,"btn","w-24","btn-primary",3,"click"],[1,"mt-2","text-danger","text-xs","fade"],[2,"width","100vw","height","100vh","position","fixed","z-index","9999","top","0","left","0","display","flex","justify-content","center","align-items","center","background-color","rgba(0, 0, 0, 0.4)"],[2,"text-align","center","color","#000000"],[2,"margin-bottom","10px"],["role","status",1,"spinner-border","spinner-border-sm"],[2,"font-size","20px","margin-top","10px","background-color","#f0f8ffa3","padding","10px","border-radius","5px"]],template:function(o,s){if(1&o&&(e.YNc(0,ee,1,0,"azt-loading-effect",0),e.YNc(1,oe,38,30,"ng-template",null,1,e.W1O),e.YNc(3,se,8,1,"div",2)),2&o){const l=e.MAs(2);e.Q6J("ngIf",s.statusObj.loading)("ngIfElse",l),e.xp6(3),e.Q6J("ngIf",s.logConfig.status)}},dependencies:[b.O5,t._Y,t.Fj,t.JJ,t.JL,t.sg,t.u,E.l,k.M,G.Z,R.u,$,K.JV],encapsulation:2}),d})()},53903:(F,A,n)=>{n.d(A,{Z:()=>j});var e=n(65879),t=n(39621),i=n(77848),O=n(96814),m=n(23680),S=n(64170),c=n(98525),g=n(56223),Z=n(775),T=n(75203);let P=(()=>{class v{transform(r,u){if(!r)return"";const b=r.find(k=>k.id==u);return b?b.key??"":""}}return v.\u0275fac=function(r){return new(r||v)},v.\u0275pipe=e.Yjl({name:"aztFindSchoolSubjectById",type:v,pure:!0}),v})();function M(v,_){if(1&v&&(e.TgZ(0,"mat-option",15),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&v){const r=_.$implicit;e.Q6J("value",r.id),e.xp6(1),e.hij(" ",e.lcZ(2,2,r.key)," ")}}function w(v,_){if(1&v&&(e.TgZ(0,"mat-option",15),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&v){const r=_.$implicit;e.Q6J("value",r.id),e.xp6(1),e.hij(" ",e.lcZ(2,2,r.key)," ")}}function Q(v,_){1&v&&(e.TgZ(0,"div",16),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&v&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"lang_auto_vui_long_chon_khoi_hoc_va_mon_hoc")," "))}function x(v,_){if(1&v){const r=e.EpF();e.TgZ(0,"div",17)(1,"div",18)(2,"span"),e._uU(3),e.ALo(4,"mytranslate"),e.ALo(5,"mytranslate"),e.ALo(6,"mytranslate"),e.ALo(7,"aztFindSchoolSubjectById"),e.ALo(8,"mytranslate"),e.ALo(9,"mytranslate"),e.ALo(10,"aztFindSchoolSubjectById"),e.qZA(),e.TgZ(11,"a",19),e.NdJ("click",function(){e.CHM(r);const b=e.oxw();return e.KtG(b.changeSubjectIdByPredict())}),e._uU(12),e.ALo(13,"mytranslate"),e.qZA()()()}if(2&v){const r=e.oxw();e.xp6(3),e.hij("",e.lcZ(4,2,"lang_testbank_please_double_check_the_subject_for_accuracy")+". "+e.lcZ(5,4,"lang_testbank_the_system_recognizes_your_subject_as_a_subject")+" "+e.lcZ(6,6,e.xi3(7,8,r.schoolSubjectObjs,r.predictSchoolSubjectId))+", "+e.lcZ(8,11,"lang_testbank_you_are_choosing_subject")+" "+e.lcZ(9,13,e.xi3(10,15,r.schoolSubjectObjs,r.form.controls.schoolSubject.value))+". "," "),e.xp6(9),e.hij(" ",e.lcZ(13,18,"lang_testbank_click_here_to_change_it_to_the_correct_one")+"."," ")}}let j=(()=>{class v extends t.Q{filterSchoolSubject(r){this.filterSubject(r??1)}changeSubjectIdByPredict(){const r=this.schoolSubjectObjs.find(E=>E.id==this.predictSchoolSubjectId),u=this.form?.controls.schoolLevel.value??0;let b=0;r&&r.from&&r.to&&(Number(u)>=r.from||Number(u)<=r.to?(b=this.getSubjectIdFilter(this.subjectSelectedList),this.form?.controls.schoolSubject.setValue(b)):(this.form?.controls.schoolLevel.setValue(r.from),this.filterSchoolSubject(this.form?.controls.schoolLevel.value),b=this.getSubjectIdFilter(this.subjectSelectedList),this.form?.controls.schoolSubject.setValue(b)),this.predictLogRequestObj.acceptPredictStatus=1,this.sendLogPredictSubject.emit(this.predictLogRequestObj))}predictSchoolSubjectByQuestionContent(){this.initStatusObj(),this.subscriptions.add(this.aiService.apiAiPredictSubjectPost({questionContents:this.questionContents}).subscribe(u=>{1===u.success?(this.predictSchoolSubjectId=u.data?.schoolSubjectId??0,this.predictSchoolSubjectId&&(this.checkPredictSchoolSubject=this.checkPredictSubject(),this.predictLogRequestObj={predictSchoolSubjectId:this.predictSchoolSubjectId,acceptPredictStatus:-1!=this.predictSchoolSubjectId&&this.showPredictSchoolSubject&&!this.checkPredictSchoolSubject?0:2,predictByTotalQuestion:this.questionContents.length},this.sendLogPredictSubject.emit(this.predictLogRequestObj)),this.successStatusObj()):this.errorStatusObj(u.message??"",!0)}))}getArrayIdSubject(){const r=this.getKeySubjectById(this.predictSchoolSubjectId,this.schoolSubjectObjs);return this.convertSubjectList(this.schoolSubjectObjs)[r]}getSubjectIdFilter(r){const u=this.getArrayIdSubject();let b=0;for(let E=0;E<r.length;E++){const k=r[E];if(k.id&&u.includes(k.id)){b=k.id;break}}return b}filterSubject(r){let u=this.commonService.myClone(this.schoolSubjectObjs);this.subjectSelectedList=u.filter(k=>!(k.from&&k.to&&r)||r>=k.from&&r<=k.to);let b=this.form?.controls.schoolSubject.value,E=this.subjectSelectedList.filter(k=>k.id==b);(!E||!E.length)&&this.form?.controls.schoolSubject.setValue(0)}checkPredictSubject(){const r=this.getArrayIdSubject(),u=Number(this.form?.controls.schoolSubject.value)??0;return r?.includes(u)}convertSubjectList(r){const u={};return r.forEach(b=>{b.key&&(u[b.key]||(u[b.key]=[]),u[b.key].push(b.id))}),u}getKeySubjectById(r,u){const b=u.find(k=>k.id==r);return b?b.key??"":""}renderData(){0==this.typeView?this.examSchoolLogObj?.id?(this.filterSchoolSubject(this.examSchoolLogObj?.lastSchoolLevelId??0??this.schoolLevelObjs[0].id),this.isSetValueByLog&&(this.form?.controls.schoolLevel.setValue(this.examSchoolLogObj?.lastSchoolLevelId??0),this.form?.controls.schoolSubject.setValue(this.examSchoolLogObj?.lastSchoolSubjectId??0))):this.filterSchoolSubject(0):this.filterSchoolSubject(this.form?.controls.schoolLevel.value)}checkSubjectIdInLevel(){const r=this.form.controls.schoolSubject.value;for(let u=0;u<this.subjectSelectedList.length;u++)if(this.subjectSelectedList[u].id==r)return!0;return!1}ngOnChanges(){(this.schoolLevelObjs||this.subjectSelectedList)&&this.renderData()}ngOnInit(){this.renderData(),this.showPredictSchoolSubject&&this.predictSchoolSubjectByQuestionContent(),this.isSubjectIdInList=this.checkSubjectIdInLevel(),this.idSubjectInLevel.emit(this.isSubjectIdInList),this.form?.controls.schoolSubject?.valueChanges.subscribe(()=>{this.predictSchoolSubjectId&&(this.checkPredictSchoolSubject=this.checkPredictSubject(),this.predictLogRequestObj.acceptPredictStatus=-1!=this.predictSchoolSubjectId&&this.showPredictSchoolSubject&&!this.checkPredictSchoolSubject?0:2,this.sendLogPredictSubject.emit(this.predictLogRequestObj)),this.isSubjectIdInList=this.checkSubjectIdInLevel(),this.idSubjectInLevel.emit(this.isSubjectIdInList)})}constructor(r){super(),this.aiService=r,this.schoolLevelObjs=[],this.schoolSubjectObjs=[],this.formControlName="",this.typeView=0,this.questionContents=[],this.showPredictSchoolSubject=!1,this.isSetValueByLog=!0,this.sendLogPredictSubject=new e.vpe,this.idSubjectInLevel=new e.vpe,this.subjectSelectedList=[],this.targetExamGroupObjs=[],this.checkPredictSchoolSubject=!1,this.predictSchoolSubjectId=-1,this.predictLogRequestObj={predictSchoolSubjectId:0,acceptPredictStatus:0,predictByTotalQuestion:0},this.isSubjectIdInList=!0}}return v.\u0275fac=function(r){return new(r||v)(e.Y36(i.p))},v.\u0275cmp=e.Xpm({type:v,selectors:[["config-level-subject"]],inputs:{form:"form",schoolLevelObjs:"schoolLevelObjs",schoolSubjectObjs:"schoolSubjectObjs",examSchoolLogObj:"examSchoolLogObj",formControlName:"formControlName",typeView:"typeView",questionContents:"questionContents",showPredictSchoolSubject:"showPredictSchoolSubject",isSetValueByLog:"isSetValueByLog"},outputs:{sendLogPredictSubject:"sendLogPredictSubject",idSubjectInLevel:"idSubjectInLevel"},features:[e.qOj,e.TTD],decls:28,vars:19,consts:[[1,"config-level-subject"],[3,"formGroup"],["id","azt-config-level-subject",1,"grid","grid-cols-12","gap-5"],[1,"col-span-12","lg:col-span-6"],[1,"font-medium"],["for","schoolLevel",1,"form-label","flex","items-center"],["appearance","outline"],["formControlName","schoolLevel","name","schoolLevel",3,"selectionChange"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["for","schoolSubject",1,"form-label","flex","items-center"],["id","schoolSubject","formControlName","schoolSubject","name","schoolSubject"],[1,"col-span-12",2,"margin-top","-20px"],["class","text-xs mt-2 text-danger",4,"ngIf"],["class","col-span-12","style","margin-top: -32px;",4,"ngIf"],[3,"value"],[1,"text-xs","mt-2","text-danger"],[1,"col-span-12",2,"margin-top","-32px"],[1,"text-xs","text-pending","font-medium"],[1,"btn-text-primary","font-medium",3,"click"]],template:function(r,u){1&r&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),e._uU(6),e.ALo(7,"mytranslate"),e.qZA()(),e.TgZ(8,"mat-form-field",6)(9,"mat-select",7),e.NdJ("selectionChange",function(){return u.filterSchoolSubject(u.form.controls.schoolLevel.value)}),e.TgZ(10,"mat-option",8),e._uU(11),e.ALo(12,"mytranslate"),e.qZA(),e.YNc(13,M,3,4,"mat-option",9),e.qZA()()(),e.TgZ(14,"div",3)(15,"div",4)(16,"label",10),e._uU(17),e.ALo(18,"mytranslate"),e.qZA()(),e.TgZ(19,"mat-form-field",6)(20,"mat-select",11)(21,"mat-option",8),e._uU(22),e.ALo(23,"mytranslate"),e.qZA(),e.YNc(24,w,3,4,"mat-option",9),e.qZA()()(),e.TgZ(25,"div",12),e.YNc(26,Q,3,3,"div",13),e.qZA(),e.YNc(27,x,14,20,"div",14),e.qZA()()()),2&r&&(e.xp6(1),e.Q6J("formGroup",u.form),e.xp6(5),e.hij(" ",e.lcZ(7,11,"lang_auto_khoi_hoc")," "),e.xp6(4),e.Q6J("value",0),e.xp6(1),e.hij("",e.lcZ(12,13,"lang_auto_---chon_khoi"),"---"),e.xp6(2),e.Q6J("ngForOf",u.schoolLevelObjs),e.xp6(4),e.hij(" ",e.lcZ(18,15,"lang_auto_mon_hoc")," "),e.xp6(4),e.Q6J("value",0),e.xp6(1),e.hij("",e.lcZ(23,17,"lang_auto_---chon_mon"),"---"),e.xp6(2),e.Q6J("ngForOf",u.subjectSelectedList),e.xp6(2),e.Q6J("ngIf",0==(null==u.form||null==u.form.controls||null==u.form.controls.schoolLevel?null:u.form.controls.schoolLevel.value)||0==(null==u.form||null==u.form.controls||null==u.form.controls.schoolSubject?null:u.form.controls.schoolSubject.value)||!u.isSubjectIdInList),e.xp6(1),e.Q6J("ngIf",-1!=u.predictSchoolSubjectId&&u.showPredictSchoolSubject&&!u.checkPredictSchoolSubject&&0!=(null==u.form||null==u.form.controls||null==u.form.controls.schoolSubject?null:u.form.controls.schoolSubject.value)&&!u.statusObj.loading))},dependencies:[O.sg,O.O5,m.ey,S.KE,c.gD,g._Y,g.JJ,g.JL,g.sg,g.u,Z.M,T.JV,P],encapsulation:2}),v})()},10766:(F,A,n)=>{n.d(A,{u:()=>x});var e=n(39621),t=n(65879),i=n(96814),O=n(23680),m=n(64170),S=n(98525),c=n(56223),g=n(775),Z=n(75203);function T(j,v){if(1&j&&(t.TgZ(0,"mat-option",14),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&j){const _=v.$implicit;t.Q6J("value",_.id),t.xp6(1),t.hij(" ",t.lcZ(2,2,_.code)," ")}}function P(j,v){if(1&j&&(t.TgZ(0,"mat-optgroup",12),t.ALo(1,"mytranslate"),t.YNc(2,T,3,4,"mat-option",13),t.qZA()),2&j){const _=v.$implicit;t.s9C("label",t.lcZ(1,2,_.groupName)),t.xp6(2),t.Q6J("ngForOf",_.purposeListInGroup)}}function M(j,v){1&j&&(t.TgZ(0,"div",15),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&j&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_please_choose_purpose_exam")," "))}function w(j,v){1&j&&(t.TgZ(0,"div",15),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&j&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_please_enter_purpose_create_exam")," "))}function Q(j,v){if(1&j&&(t.TgZ(0,"div",3)(1,"div",4)(2,"label",16),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.TgZ(5,"div",17),t._UZ(6,"input",18),t.ALo(7,"mytranslate"),t.qZA(),t.YNc(8,w,3,3,"div",10),t.qZA()),2&j){const _=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,3,"lang_testbank_enter_create_exam_target")," "),t.xp6(3),t.s9C("placeholder",t.lcZ(7,5,"lang_testbank_enter_create_exam_target")+" ..."),t.xp6(2),t.Q6J("ngIf",(4==(null==_.form.controls.purposeExam?null:_.form.controls.purposeExam.value)||8==(null==_.form.controls.purposeExam?null:_.form.controls.purposeExam.value)||12==(null==_.form.controls.purposeExam?null:_.form.controls.purposeExam.value))&&""===(null==_.form.controls.purposeNote||null==_.form.controls.purposeNote.value?null:_.form.controls.purposeNote.value.trim()))}}let x=(()=>{class j extends e.Q{convertPurposeList(){this.targetExamGroupObjs=[],this.purposeList.forEach(_=>{const{semester:r}=_;let u=this.targetExamGroupObjs.find(b=>b.semester===r);u||(u={semester:r,groupName:this.getGroupNamePurpose(_.semester??1),purposeListInGroup:[]},this.targetExamGroupObjs.push(u)),u.purposeListInGroup?.push(_)})}getGroupNamePurpose(_){switch(_){case 1:default:return"lang_testbank_semester_one";case 2:return"lang_testbank_semester_two";case 3:return"lang_testbank_another_purpose"}}ngOnInit(){this.convertPurposeList()}constructor(){super(),this.purposeList=[],this.targetExamGroupObjs=[]}}return j.\u0275fac=function(_){return new(_||j)},j.\u0275cmp=t.Xpm({type:j,selectors:[["config-purpose-exam"]],inputs:{form:"form",purposeList:"purposeList"},features:[t.qOj],decls:16,vars:11,consts:[[1,"config-purpose-exan"],[3,"formGroup"],["id","azt-config-purpose-exam",1,"grid","grid-cols-12","gap-5"],[1,"col-span-12"],[1,"font-medium"],[1,"form-label","flex","items-center"],["appearance","outline"],["formControlName","purposeExam","name","purposeExam"],["disabled","",3,"value"],[3,"label",4,"ngFor","ngForOf"],["class","mt-2 text-danger text-xs",4,"ngIf"],["class","col-span-12",4,"ngIf"],[3,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mt-2","text-danger","text-xs"],["for","enter_target_create_exam",1,"form-label","flex","items-center"],[1,"setting-input"],["id","enter_target_create_exam","formControlName","purposeNote","type","text",1,"form-control",3,"placeholder"]],template:function(_,r){1&_&&(t.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()(),t.TgZ(8,"mat-form-field",6)(9,"mat-select",7)(10,"mat-option",8),t._uU(11),t.ALo(12,"mytranslate"),t.qZA(),t.YNc(13,P,3,4,"mat-optgroup",9),t.qZA()(),t.YNc(14,M,3,3,"div",10),t.qZA(),t.YNc(15,Q,9,7,"div",11),t.qZA()()()),2&_&&(t.xp6(1),t.Q6J("formGroup",r.form),t.xp6(5),t.hij(" ",t.lcZ(7,7,"lang_testbank_target_exam")," "),t.xp6(4),t.Q6J("value",0),t.xp6(1),t.hij("---",t.lcZ(12,9,"lang_testbank_choose_purpose"),"---"),t.xp6(2),t.Q6J("ngForOf",r.targetExamGroupObjs),t.xp6(1),t.Q6J("ngIf",0==r.form.controls.purposeExam.value),t.xp6(1),t.Q6J("ngIf",4==(null==r.form.controls.purposeExam?null:r.form.controls.purposeExam.value)||8==(null==r.form.controls.purposeExam?null:r.form.controls.purposeExam.value)||12==(null==r.form.controls.purposeExam?null:r.form.controls.purposeExam.value)))},dependencies:[i.sg,i.O5,O.ey,O.Nv,m.KE,S.gD,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,g.M,Z.JV],encapsulation:2}),j})()},24052:(F,A,n)=>{n.d(A,{i:()=>t});var e=n(65879);let t=(()=>{class i{constructor(){this.fileDrop=new e.vpe,this.preventBodyDrop=!0,this.active=!1}onDrop(m){m.preventDefault(),this.active=!1;const{dataTransfer:S}=m;if(S?.items){const c=[];for(let g=0;g<S.items.length;g++)"file"===S.items[g].kind&&S.items[g].getAsFile()&&c.push(S.items[g].getAsFile());S.items.clear(),Array.isArray(c)&&this.fileDrop.emit(this.removeNullFile(c))}else{const c=S?.files;S?.clearData(),c&&this.fileDrop.emit(Array.from(c))}}removeNullFile(m){for(var S=[],c=0;c<m.length;c++)m[c]&&S.push(m[c]);return S}onDragOver(m){m.stopPropagation(),m.preventDefault(),this.active=!0}onDragLeave(m){this.active=!1}onBodyDragOver(m){this.preventBodyDrop&&(m.preventDefault(),m.stopPropagation())}onBodyDrop(m){this.preventBodyDrop&&m.preventDefault()}}return i.\u0275fac=function(m){return new(m||i)},i.\u0275dir=e.lG2({type:i,selectors:[["","appDropZone",""]],hostVars:2,hostBindings:function(m,S){1&m&&e.NdJ("drop",function(g){return S.onDrop(g)})("dragover",function(g){return S.onDragOver(g)})("dragleave",function(g){return S.onDragLeave(g)})("dragover",function(g){return S.onBodyDragOver(g)},!1,e.pYS)("drop",function(g){return S.onBodyDrop(g)},!1,e.pYS),2&m&&e.ekj("drop-zone-active",S.active)},inputs:{preventBodyDrop:"preventBodyDrop"},outputs:{fileDrop:"appDropZone"}}),i})()},49691:(F,A,n)=>{n.d(A,{a:()=>t,e:()=>e});var e=function(i){return i.exam="exam",i.ref="ref",i.lecture="lecture",i}(e||{}),t=function(i){return i.video="video",i.powerpoint="ppt",i.docx="docx",i.pdf=" pdf",i}(t||{})},42047:(F,A,n)=>{n.d(A,{Z:()=>e});class e{constructor(i,O,m,S,c,g=1,Z=!1,T=!1,P,M){this.id=i,this.pr=O,this.type=m,this.shareType=S,this.item=c,this.level=g,this.expandable=Z,this.isLoading=T,this.prNode=P,this.isLeaf=M}}},59694:(F,A,n)=>{n.d(A,{O:()=>O});var e=n(65879),t=n(31518),i=n(87384);let O=(()=>{class m{constructor(c,g){this.browserStorageService=c,this.commonService=g,this.data={}}setMode(c){this.browserStorageService.saveSimpleStorage("__editor:mode_open",c)}getMode(){var c=this.browserStorageService.getSimpleStorage("__editor:mode_open")||"editor";return this.browserStorageService.removeSimpleStorage("__editor:mode_open"),c}setFileProcess(c){this.file=c}getFirstFile(){let c=this.file;return this.file=void 0,c}setOutputData(c){this.data=c}getOutputData(){return this.data}redirectToConfig(c){this.data.homework&&c.showHomework(),(this.data.exam||this.data.examOffline)&&c.showExam()}setMatrixData(c,g){g?this.matrix=c:this.browserStorageService.saveSimpleStorage("__editor:matrix-data",JSON.stringify(c))}getMatrixData(){var c=this.browserStorageService.getSimpleStorage("__editor:matrix-data");return this.browserStorageService.removeSimpleStorage("__editor:matrix-data"),c?this.commonService.castJsonToObj(c):this.matrix}}return m.\u0275fac=function(c){return new(c||m)(e.LFG(t.n),e.LFG(i.z))},m.\u0275prov=e.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()}}]);